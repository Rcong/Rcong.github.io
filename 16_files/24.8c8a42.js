webpackJsonp([24],{"9KX3":function(t,e){},QHSM:function(t,e){},SfNb:function(t,e){},Xt6H:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Xxa5"),s=i.n(a),n=i("mvHQ"),o=i.n(n),r=i("exGp"),l=i.n(r),c=i("tZdG"),d=i("VNRf"),_=i("90oV"),p=i("wuci"),u={props:{percent:{type:Number,default:0}},created:function(){this.touch={}},methods:{progressTouchStart:function(t){this.touch.initiated=!0,this.touch.startX=t.touches[0].pageX,this.touch.left=this.$refs.progress.clientWidth},progressTouchMove:function(t){if(this.touch.initiated){var e=t.touches[0].pageX-this.touch.startX,i=Math.min(this.$refs.progressBar.clientWidth-7,Math.max(0,this.touch.left+e));this._offset(i),this.$emit("percentChanging",this._getPercent())}},progressTouchEnd:function(){this.touch.initiated=!1,this._triggerPercent()},progressClick:function(t){var e=this.$refs.progressBar.getBoundingClientRect(),i=t.pageX-e.left;this._offset(i),this._triggerPercent()},setProgressOffset:function(t){if(t>=0&&!this.touch.initiated){var e=t*(this.$refs.progressBar.clientWidth-7);this._offset(e)}},_triggerPercent:function(){this.$emit("percentChange",this._getPercent())},_offset:function(t){this.$refs.progress.style.width=t+"px",this.$refs.progressBtn.style.transform="translate3d("+t+"px,0,0)"},_getPercent:function(){var t=this.$refs.progressBar.clientWidth-7;return this.$refs.progress.clientWidth/t}},watch:{percent:function(t){this.setProgressOffset(t)}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"progressBar",staticClass:"progress-bar",on:{click:t.progressClick}},[i("div",{staticClass:"bar-inner"},[i("div",{ref:"progress",staticClass:"progress"}),t._v(" "),i("div",{ref:"progressBtn",staticClass:"progress-btn-wrapper",on:{touchstart:function(e){return e.preventDefault(),t.progressTouchStart(e)},touchmove:function(e){return e.preventDefault(),t.progressTouchMove(e)},touchend:t.progressTouchEnd}},[i("div",{staticClass:"progress-btn"})])])])},staticRenderFns:[]};var v=i("VU/8")(u,h,!1,function(t){i("heIp")},"data-v-b665d74e",null).exports,m=i("eZn/"),g={name:"the_v_article",props:{islogin:{type:Boolean,default:!1},full_play_token:{type:String,default:""},full_vid:{type:String,default:""},nickname:{type:String,default:""}},data:function(){return{showmodule:!1,alertModalData:null,isShow:!1,video_list:[],page_data:{},page_content:{},show_data:!1,data_note:"",data_ref:"",dialog_show:!1,login_dialog_show:!1,active:0,tiny_mark:!0,tiny_mark2:!1,show_comments:!1,default_avatar:"../../../static/img/defaultAvatar.png",the_user:!1,trueCommentsInfo:{},finalArr:[],the_key:!1,_source:"",currentTime:0,playing:!1,openPlan:!1,openVip:!1,isPurchased:!1,limited:!1,success:!0,isvipfree:"0",isVip:!1,vip_dialog_show:!1,video_show:!0,play_token:""}},components:{ProgressBar:v,baseAlertModal:_.a,Loading:d.a},computed:{duration:function(){return this.page_content.duration},playIcon:function(){return this.playing?"icon-pause":"icon-play"},percent:function(){return this.currentTime/this.duration},isapp:function(){return window.isApp},isphone:function(){return console.log("navigator.platform",navigator.platform),/(iPhone|iPad|iPod|iOS|Android|Linux armv8l|Linux armv7l|Linux aarch64)/i.test(navigator.platform)}},watch:{show_comments:function(t){}},created:function(){var t=this;return l()(s.a.mark(function e(){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.getConfigs(),sessionStorage.getItem("isss")&&(t.the_user=!0),e.next=4,p.a.getToken(t);case 4:t.getVideoInfo(),i=t.$route.query.source||"",sessionStorage.setItem("ar-s",i),t._source=i||sessionStorage.getItem("d-s")||sessionStorage.getItem("a-s");case 8:case"end":return e.stop()}},e,t)}))()},beforeMount:function(){this.getComments()},mounted:function(){var t=this,e=this.$route.query.index;if(this.$refs.longest_list.scrollLeft=146*e,this.active=e,document.querySelector(".note"))for(var i=document.querySelectorAll(".note"),a=function(e){var a=i[e].getAttribute("data-ref"),s=i[e].getAttribute("data-note");i[e].addEventListener("click",function(){t.data_ref=a,t.data_note=s,t.show_data=!0})},s=0;s<=i.length-1;s++)a(s);this.$route.meta.title=this.page_content.title},beforeUpdate:function(){this.$route.meta.title=this.page_content.title},updated:function(){this.$route.meta.title=this.page_content.title},methods:{getVideoInfo:function(){var t=this,e=this;this.page_data=JSON.parse(sessionStorage.getItem("article_data")),"1"==this.page_data.is_limited_free&&(this.limited=!0),this.isvipfree=this.page_data.is_vip_free,"lixiangjia"==this.page_data.vip_type&&(this.isVip=!0),"1"==this.page_data.is_purchased&&(this.isPurchased=!0),this.page_content=this.page_data.part[0],this.video_list=this.page_data.video_list,this.$route.meta.title=this.page_content.title,this.success=!0,this.$nextTick(function(){document.getElementById("video_volcano").style.background="url("+t.page_content.video_poster+") no-repeat center center",document.getElementById("video_volcano").style.backgroundSize="100% 100%",e.initVideoSdk()})},initVideoSdk:function(){var t=this,e=this;this.play_token=this.full_play_token,console.log(this.play_token),this.playerSdk=new VePlayer({id:"video_volcano",sdkErrorPlugin:{errorTips:!0,errorTipsText:"播放发生错误，点击刷新试试吧",isNeedRefreshButton:!0,errorImg:!0},lang:"zh",autoplayMuted:!1,autoplay:!1,streamType:"mp4",DanmuPlugin:{active:!1,usePanel:!1},fullscreen:{position:"controlsLeft",rotateFullscreen:!1,useCssFullscreen:!1,needBackIcon:!0},getVideoByToken:{playAuthToken:this.play_token,reqParams:{PlayScene:"preview"}},vodLogOpts:{vtype:"MP4",tag:"普通视频",codec_type:"h264",drm_type:0,line_app_id:403298,line_user_id:this.nickname}}),this.playerSdk.on("player_create_finish",function(){e.video_player=e.playerSdk.getPlayerInstance(),e.video_player.poster=e.page_content.video_poster,console.log("创建完成"),console.log(e.video_player)}),this.playerSdk.on("play",function(){console.log("play"),t.tiny_mark2=!1,t.tiny_mark=!1}),this.playerSdk.on("loadeddata",function(){console.log("loadeddata"),t.isphone&&(document.getElementsByClassName("xgplayer-fullscreen")[0].style.left=parseInt(document.getElementsByClassName("xg-center-grid")[0].offsetWidth)+28+"px")}),this.playerSdk.on("error",function(){console.log("error"),t.getPlayToken("expired")})},jtbh:function(){var t=this,e=JSON.parse(sessionStorage.getItem("article_id"));_hmt.push(["_trackEvent","文稿详情页播放按钮的点击-视频","节目id:"+this.page_data.content_id,"小节id:"+e,1]),this.tiny_mark=!1,this.video_player.play(),this.playerSdk.on("ended",function(){t.tiny_mark2=!0})},goContent:function(){var t=this.page_data.content_id;this.$router.push({path:"../detail",query:{id:t}})},_jumpAlertBtn:function(t){"function"==typeof t?t():location.href=t},_jumpH5:function(){this.$router.push({path:"/member",query:{spm:"article",tm:"h5"}}),this.isShow=!1},_jumpPlan:function(){this.$router.push({path:"/member",query:{spm:"article",tm:"h5"}})},beforeClose:function(t,e){"confirm"===t?e():this.$router.push("../pay")},beforeClose2:function(t,e){e()},playIt:function(t,e){var i=this;this.the_key=!1,_hmt.push(["_trackEvent","文稿详情页其他集的点击-视频","节目id:"+this.page_data.content_id,"小节id:"+t,1]);var a=this.$refs.audio;a&&(a.pause(),this.playing=!1),this.$nextTick(function(){i.$refs.longest_list.scrollLeft=146*e});var s=t;sessionStorage.setItem("article_id",o()(s)),sessionStorage.setItem("theTrueId",o()(s)),this.updateData(s),this.active=e,this.tiny_mark2=!1,this.tiny_mark=!0,this.getComments()},updateData:function(t){var e=this,i=this;this.$http(m._7,{api_token:this.token,article_id:t}).then(function(t){"success"==t.data.status&&("1"==t.data.data.is_limited_free&&(e.limited=!0),e.isvipfree=t.data.data.is_vip_free,"lixiangjia"==t.data.data.vip_type&&(e.isVip=!0),"1"==t.data.data.is_purchased&&(e.isPurchased=!0),i.page_data=t.data.data,i.success=!0,i.page_content=t.data.data.part[0],i.full_vid=e.page_content.vid,i.$route.meta.title=i.page_content.title,i.getPlayToken())},function(t){console.log("error",t)})},getPlayToken:function(t){var e,i=this;e=this.full_vid,this.$http(m._101,{api_token:this.token,vid:e}).then(function(e){"success"==e.data.status&&(i.play_token=e.data.data.play_token,i.handleUpdateData(t))},function(t){console.log("error",t)})},handleUpdateData:function(t){var e=this,i=this;i.$nextTick(function(){if("expired"==t){var a=i.video_player.currentTime;return document.getElementsByClassName("xgplayer-error")[0].style.display="none",i.video_player.playNext({getVideoByToken:{playAuthToken:i.play_token,reqParams:{PlayScene:"preview"}},poster:i.page_content.video_poster,startTime:i.video_player.currentTime}),void(i.video_player.currentTime=a)}i.playerSdk.destroy(),i.playerSdk=new VePlayer({id:"video_volcano",sdkErrorPlugin:{errorTips:!0,errorTipsText:"播放发生错误，点击刷新试试吧。",isNeedRefreshButton:!0,errorImg:!0},autoplayMuted:!1,autoplay:!1,DanmuPlugin:{active:!1,usePanel:!1},fullscreen:{position:"controlsLeft",rotateFullscreen:!1,useCssFullscreen:!1,needBackIcon:!0},getVideoByToken:{playAuthToken:e.play_token,reqParams:{PlayScene:"preview"}}}),i.playerSdk.on("player_create_finish",function(){i.video_player=i.playerSdk.getPlayerInstance(),i.video_player.poster=i.page_content.video_poster,console.log("创建完成"),console.log(i.video_player)}),i.playerSdk.on("play",function(){console.log("play"),i.tiny_mark2=!1,i.tiny_mark=!1}),i.playerSdk.on("loadeddata",function(){console.log("loadeddata"),console.log("offsetWidth",document.getElementsByClassName("xg-center-grid")[0].offsetWidth),document.getElementsByClassName("xgplayer-fullscreen")[0].style.left=parseInt(document.getElementsByClassName("xg-center-grid")[0].offsetWidth)+28+"px"})})},onClickConfirm:function(t){if("1"!=this.page_data.is_vip_only||"lixiangjia"==this.page_data.vip_type||"lixiangjia_trial"==this.page_data.vip_type){var e=JSON.parse(sessionStorage.getItem("lastVisitedGoods"));if(0==e.is_purchased||""==e.is_purchased){if(("lixiangjia"==e.vip_type||"lixiangjia_trial"==e.vip_type)&&"1"==e.is_vip_free)return this.alertModalData={text1:"您可以享受会员权益免费畅听本节目",text2:"请登录看理想App欣赏精彩内容",btnText:"确定",btnJump:this.closeModule},void(this.showmodule=!0);"1"==e.is_vip_only||(this.alertModalData={text1:"抱歉，该节目为付费内容",text2:"购买后可继续观看",btnText:"确定",btnJump:this.closeModule},this.showmodule=!0)}else this.login_dialog_show=!0}else this.isShow=!0},closeModule:function(){this.showmodule=!1},goCommentsValue:function(){var t=JSON.parse(sessionStorage.getItem("article_id"));_hmt.push(["_trackEvent","文稿详情页评论的点击-视频","节目id:"+this.page_data.content_id,"小节id:"+t,1]),this.show_comments=!0},goBuy:function(){if(!this.islogin)return p.a.goLogin.call(this);this.$router.push("/pay")},goDol:function(){var t=JSON.parse(sessionStorage.getItem("article_id"));_hmt.push(["_trackEvent","文稿详情页下载button的点击-视频","节目id:"+this.page_data.content_id,"小节id:"+t,1]),window.location.href="https://app.vistopia.com.cn/download/?source="+this._source},getComments:function(){var t=this;JSON.parse(sessionStorage.getItem("article_id"));this.axios.get("https://api.vistopia.com.cn/api/v1/comment/article-comment?article_id="+JSON.parse(sessionStorage.getItem("theTrueId"))+"&page=1",{}).then(function(e){t.trueCommentsInfo=e.data.data,t.finalArr=t.trueCommentsInfo.data,t.finalArr.length>9&&(t.the_key=!0),t.finalArr=t.finalArr.slice(0,10)}).catch(function(t){console.log(t)})},getConfigs:function(){var t=this;this.$http(m._4).then(function(e){"success"==e.data.status&&("on"==e.data.data.vip_config.online&&(t.openVip=!0),"on"==e.data.data.friend_config.online&&(t.openPlan=!0))},function(t){console.log("error",t)})},end:function(){this.$refs.audio.currentTime=0,this.$refs.audio.play()},onProgressBarChange:function(t){var e=this.duration*t;this.currentTime=this.$refs.audio.currentTime=e,this.playing||this.togglePlay()},togglePlay:function(){var t=this.$refs.audio;this.playing=!this.playing,this.playing?t.play():t.pause()},updateTime:function(t){this.currentTime=t.target.currentTime},format:function(t){return((t|=0)/60|0)+":"+this._pad(t%60)},_pad:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=t.toString().length;i<e;)t="0"+t,i++;return t}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.success?i("div",{staticClass:"the-video-article"},[i("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.$route.meta.title,expression:"$route.meta.title"}]}),t._v(" "),"audio"==t.page_content.media_type_en?i("div",{staticClass:"course-audio"},[i("div",{staticClass:"img"},[i("div",{staticClass:"mc"}),t._v(" "),t.playing?i("div",{staticClass:"title"},[t._v(t._s(t.page_content.title))]):t._e(),t._v(" "),i("div",{staticClass:"c_icon"},[t.playing?i("i",{staticClass:"icon-pause"}):t._e(),t._v(" "),t.playing?t._e():i("i",{staticClass:"icon-play",on:{click:t.togglePlay}}),t._v(" "),t.playing?i("p",[t._v("在锁屏和切换到后台时也能播放音频")]):t._e()]),t._v(" "),i("img",{attrs:{src:t.page_content.video_poster,alt:""}})]),t._v(" "),i("audio",{ref:"audio",attrs:{src:t.page_content.sample_media_full_url},on:{timeupdate:t.updateTime,ended:t.end}}),t._v(" "),t.playing?i("div",{staticClass:"progress-wrapper"},[i("span",{staticClass:"play",class:t.playIcon,on:{click:function(e){return e.stopPropagation(),t.togglePlay(e)}}}),t._v(" "),i("span",{staticClass:"time time-l"},[t._v(t._s(t.format(t.currentTime)))]),t._v(" "),i("div",{staticClass:"progress-bar-wrapper"},[i("progress-bar",{ref:"progressBar",attrs:{percent:t.percent},on:{percentChange:t.onProgressBarChange}})],1),t._v(" "),i("span",{staticClass:"time time-r"},[t._v(t._s(t.format(t.duration)))])]):t._e()]):t._e(),t._v(" "),"video"==t.page_content.media_type_en?i("div",{ref:"course_video",staticClass:"course-video",attrs:{"data-showenv":"1"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.video_show,expression:"video_show"}],ref:"video_volcano",class:{isphone:t.isphone},attrs:{id:"video_volcano"}}),t._v(" "),"0"==t.page_data.is_vip_only||"1"==t.page_data.is_vip_only&&("lixiangjia"==t.page_data.vip_type||"lixiangjia_trial"==t.page_data.vip_type)?i("div",{directives:[{name:"show",rawName:"v-show",value:t.tiny_mark,expression:"tiny_mark"}],staticClass:"videoplayer-layer"},[i("div",{staticClass:"center-info"},[i("div",{staticClass:"close-layer",on:{click:function(e){t.tiny_mark=!1,t.jtbh()}}},[t._v("\n            试看5分钟\n          ")]),t._v(" "),i("div",{staticClass:"dol-sign",on:{click:t.goDol}},[t._v("完整版请下载App")])])]):t._e(),t._v(" "),"1"==t.page_data.is_vip_only&&"0"==t.page_data.part[0].is_trial&&"lixiangjia"!=t.page_data.vip_type&&"lixiangjia_trial"!=t.page_data.vip_type&&"0"==t.page_data.is_limited_free?i("div",{directives:[{name:"show",rawName:"v-show",value:t.tiny_mark,expression:"tiny_mark"}],staticClass:"videoplayer-layer"},[i("div",{staticClass:"center-info"},[i("div",{staticClass:"close-layer3",on:{click:t._jumpPlan}},[t._v("\n            开通会员，解锁视频\n          ")]),t._v(" "),i("div",{staticClass:"dol-sign3"},[t._v("会员专享")])])]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.tiny_mark2,expression:"tiny_mark2"}],staticClass:"videoplayer-layer"},[i("div",{staticClass:"center-info"},[i("div",{staticClass:"close-layer2",on:{click:t.goDol}},[t._v("完整版请下载App")]),t._v(" "),i("div",{staticClass:"dol-sign",on:{click:function(e){t.tiny_mark2=!1}}},[t._v("试看结束")])])])]):t._e(),t._v(" "),i("div",{ref:"content_sign",staticClass:"content-sign",on:{click:t.goContent}},[i("div",{staticClass:"left-img"},[i("img",{attrs:{src:t.page_data.background_img,alt:""}})]),t._v(" "),i("div",{staticClass:"right-desc"},[i("div",{staticClass:"the-bolder"},[t._v(t._s(t.page_data.title))]),t._v(" "),i("div",{staticClass:"the-lighter"},[t._v(t._s(t.page_data.subtitle))])])]),t._v(" "),i("div",{staticClass:"info-title"},[t._v("选集")]),t._v(" "),i("div",{staticClass:"lateral-list"},[i("div",{staticClass:"video-list"},[i("ul",{ref:"longest_list",staticClass:"list-ul"},t._l(t.video_list,function(e,a){return i("li",{key:a,ref:"posi",refInFor:!0,staticClass:"the-video-sections"},["1"==e.is_trial||"lixiangjia"==t.page_data.vip_type&&"lixiangjia_trial"==t.page_data.vip_type&&1==t.page_data.is_vip_free||"free"==t.page_data.type||t.limited?i("div",[i("div",{staticClass:"img-sign",on:{click:function(i){t.playIt(e.article_id,a)}}},[i("img",{attrs:{src:e.video_poster,alt:""}}),t._v(" "),i("div",{staticClass:"tiny-sign"},[t._v(t._s(e.duration_str))]),t._v(" "),"audio"==e.media_type_en?i("div",{staticClass:"tiny-audio"}):t._e()]),t._v(" "),i("div",{staticClass:"bottom-title",class:{aaaa:t.active==a}},[t._v("\n                "+t._s(e.title)+"\n              ")])]):i("div",[i("div",{staticClass:"img-sign",on:{click:function(i){t.onClickConfirm(e)}}},[i("img",{attrs:{src:e.video_poster,alt:""}}),t._v(" "),i("div",{staticClass:"tiny-sign"},[t._v(t._s(e.duration_str))]),t._v(" "),"audio"==e.media_type_en?i("div",{staticClass:"tiny-audio"}):t._e(),t._v(" "),i("div",{staticClass:"locked-layer"}),t._v(" "),i("div",{staticClass:"locked"})]),t._v(" "),i("div",{staticClass:"bottom-title"},[t._v(t._s(e.title))])])])})),t._v(" "),i("van-dialog",{attrs:{"show-cancel-button":"","cancel-button-text":"购买","confirm-button-text":"取消","before-close":t.beforeClose},model:{value:t.dialog_show,callback:function(e){t.dialog_show=e},expression:"dialog_show"}},[i("span",{staticClass:"dialog"},[t._v("该节目为付费内容，购买后可使用App完整收看")])]),t._v(" "),i("van-dialog",{attrs:{"confirm-button-text":"确定","before-close":t.beforeClose2},model:{value:t.login_dialog_show,callback:function(e){t.login_dialog_show=e},expression:"login_dialog_show"}},[i("span",{staticClass:"dialog"},[t._v("您已购买该内容，登录看理想App收看完整视频")])]),t._v(" "),i("van-dialog",{attrs:{"confirm-button-text":"确定","before-close":t.beforeClose2},model:{value:t.vip_dialog_show,callback:function(e){t.vip_dialog_show=e},expression:"vip_dialog_show"}},[i("span",{staticClass:"dialog"},[t._v("您可以享受会员权益免费畅听本节目，请登录看理想App欣赏精彩内容。")])])],1)]),t._v(" "),i("div",{staticClass:"info-title"},[t._v("文稿")]),t._v(" "),i("div",{staticClass:"the-line"}),t._v(" "),i("div",{staticClass:"article"},[i("div",{domProps:{innerHTML:t._s(t.page_content.content)}}),t._v(" "),i("van-dialog",{attrs:{"before-close":t.beforeClose},model:{value:t.show_data,callback:function(e){t.show_data=e},expression:"show_data"}},[i("span",{staticClass:"dialog"},[t._v("\n          "+t._s(t.data_ref+":")+"\n          "),i("br"),t._v("\n          "+t._s(t.data_note)+"\n        ")])])],1),t._v(" "),"0"==t.page_data.is_vip_only?i("div",{staticClass:"bottom-view no-show",attrs:{id:"buyBtn"}},["lixiangjia"!=t.page_data.vip_type&&"lixiangjia_trial"!=t.page_data.vip_type&&1==t.page_data.is_vip_free&&"0"==t.page_data.is_vip_only&&t.openVip&&"charge"==t.page_data.type&&0==t.the_user&&!t.isPurchased?i("div",{staticClass:"plan_tips",on:{click:t._jumpPlan}},[t._v("\n        会员免费\n      ")]):t._e(),t._v(" "),i("div",{staticClass:"bottom-index"},[0==t.page_content.comment_count?i("div",{staticClass:"bottom-tips",on:{click:t.goCommentsValue}},[i("i"),t._v("\n          暂无评论\n        ")]):i("div",{staticClass:"bottom-tips",on:{click:t.goCommentsValue}},[i("i"),t._v("\n          全部评论"+t._s("("+t.page_content.comment_count+")")+"\n        ")]),t._v(" "),i("div",["free"==t.page_data.type||1==t.the_user||t.isPurchased||("lixiangjia_trial"==t.page_data.vip_type||t.isVip)&&"1"==t.isvipfree?i("div",{staticClass:"bottom-btn",on:{click:t.goDol}},[t._v("\n            下载看理想App\n          ")]):i("div",[t.page_data.is_friend_vip&&1==t.page_data.is_friend_vip?i("div",{staticClass:"bottom-btn",on:{click:t.goBuy}},[t._v("\n              购买\n              "),i("span",{staticClass:"b_s1"},[t._v("¥"+t._s(t.page_data.friend_vip_price))]),t._v(" "),i("span",{staticClass:"b_s2"},[t._v(t._s(t.page_data.complete_class_price))])]):i("div",{staticClass:"bottom-btn",on:{click:t.goBuy}},[t._v("\n              购买¥"+t._s(t.page_data.complete_class_price)+"\n            ")])])])])]):t._e(),t._v(" "),i("van-popup",{staticClass:"ddd",attrs:{position:"right"},model:{value:t.show_comments,callback:function(e){t.show_comments=e},expression:"show_comments"}},[i("ul",{staticClass:"liaobuqi"},[i("div",{staticClass:"comments"},[i("div",{staticClass:"top"},[i("span",{on:{click:function(e){t.show_comments=!1}}},[t._v("    ")])]),t._v(" "),i("div",{staticClass:"comments-list"},[i("div",{directives:[{name:"show",rawName:"v-show",value:0==t.trueCommentsInfo.total,expression:"trueCommentsInfo.total == 0"}],staticClass:"bgimg"}),t._v(" "),i("ul",t._l(t.finalArr,function(e){return i("li",{staticClass:"comment"},[i("div",{staticClass:"avatar fl-left"},[null!==e.user&&e.user.avatar_url?i("img",{attrs:{src:e.user.avatar_url||t.default_avatar,alt:""}}):i("img",{attrs:{src:t.default_avatar,alt:""}})]),t._v(" "),i("div",{staticClass:"comment-content"},[null!==e.user?i("div",{staticClass:"comment-info"},[i("span",{staticClass:"nick-name"},[t._v("\n                      "+t._s(e.user.nickname)+"\n                      "),i("span",{directives:[{name:"show",rawName:"v-show",value:"编辑推荐"==e.mark_str,expression:"item.mark_str == '编辑推荐'"}],staticClass:"upup"},[t._v(t._s(" "+e.mark_str+" "))])])]):t._e(),t._v(" "),i("span",{staticClass:"update-time"},[t._v(t._s(e.created_at_trans))]),t._v(" "),i("div",{staticClass:"comment-data"},[i("div",[t._v(t._s(e.comment))]),t._v(" "),e.children_count>=1?i("span",{staticClass:"trigle"}):t._e(),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:e.children_count>=1,expression:"item.children_count >= 1"}],staticClass:"children-talks"},[t._l(e.children_comment,function(e,a){return i("li",{key:a,staticClass:"child-talk"},[i("div",[i("p",[i("span",{staticClass:"talker-name"},[t._v(t._s(e.user.nickname))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.user_desc,expression:"item1.user_desc"}],staticClass:"talker-desc"},[t._v(t._s("("+e.user_desc+")"))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:3==e.type,expression:"item1.type == 3"}]},[t._v("回复")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:3==e.type,expression:"item1.type == 3"}],staticClass:"talker-replied"},[t._v(t._s(e.replied_username))]),t._v(" "),i("span",{staticClass:"talker-desc"},[t._v("：")]),t._v("\n                            "+t._s(e.comment)+"\n                          ")])])])}),t._v(" "),e.children_count>2?i("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ask_all_children",on:{click:function(i){t.askAllChildren(e.id)}}},[t._v("前往看理想App查看全部"+t._s(e.children_count+"条评论→"))]):t._e()],2)])])])}))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.the_key,expression:"the_key"}],staticClass:"bottom dpflex",on:{click:t.goDol}},[i("span",[t._v("前往看理想App 查看更多评论")])])])])]),t._v(" "),i("div",{staticStyle:{width:"1px",height:"60px",position:"relative",bottom:"0"}})],1):i("div",{staticStyle:{margintop:"90px"}},[i("loading")],1),t._v(" "),i("base-alert-modal",{staticClass:"mask1",attrs:{value:t.isShow},on:{"update:value":function(e){t.isShow=e}}},[i("div",{attrs:{slot:"modal-close"},slot:"modal-close"}),t._v(" "),i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"m_p1"},[t._v("抱歉，该节目为会员专享节目，开通会员可享")]),t._v(" "),i("div",{staticClass:"m_btn",on:{click:t._jumpH5}},[t._v("开通会员")])])]),t._v(" "),i("base-alert-modal",{staticClass:"mask1",attrs:{value:t.showmodule},on:{"update:value":function(e){t.showmodule=e}}},[i("div",{attrs:{slot:"modal-close"},slot:"modal-close"}),t._v(" "),t.alertModalData?i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"m_p1"},[t._v(t._s(t.alertModalData.text1))]),t._v(" "),i("div",{staticClass:"m_p1 p2"},[t._v(t._s(t.alertModalData.text2))]),t._v(" "),i("div",{staticClass:"m_btn",on:{click:function(e){t._jumpAlertBtn(t.alertModalData.btnJump)}}},[t._v("\n        "+t._s(t.alertModalData.btnText)+"\n      ")])]):t._e()])],1)},staticRenderFns:[]};var y=i("VU/8")(g,f,!1,function(t){i("bL/P"),i("b3GO"),i("QHSM"),i("sovK")},"data-v-552ae414",null).exports,C=i("xwQO"),w={components:{openApp:c.a,Va:y,baseAlertModal:_.a,Loading:d.a},data:function(){return{scheme:"",opensource:"",ad:{},ad_mini:{},audio_already:"00:00",audio_length:"00:00",play:!1,status:"pause",comments_num:"",current_page_num:1,the_type:"charge",show_comments:!1,default_avatar:"../../static/img/defaultAvatar.png",article_id:"",trueCommentsInfo:{},finalArr:[],the_key:!1,the_user:!1,_id:"",data_note:"",data_ref:"",show_data:!1,is_article:!0,pay_source:"",islogin:!1,is_coupon:null,openPlan:!1,openVip:!1,isTrial:!1,catalog_id:"",catalog_title:null,ispurchased:!1,showModel:!1,showModelType:"",limited:!1,success:!1,goodss:{},contentId:"",audioUrl:"",guideImg:"",isvip:!1,isvipfree:0,is_exper:"",exper_num:"",exper_use_num:"",experShow:0,isShareGiftType:0,shareGiftText:"",alert_text:"",countdown:3,new_trial:"",new_trial_popup:"",trailCounter:0,popup:"",trial_vip_day:"",trial_vip_day_tip:"",prohibitSlide:"",ad_data:null,full_vid:"",full_play_token:""}},computed:{canShow:function(){var t=this.contentId;return!["156"].includes(t)},isphone:function(){return/(iPhone|iPad|iPod|iOS|Android|Linux armv8l|Linux armv7l|Linux aarch64)/i.test(navigator.platform)}},created:function(){var t=this;return l()(s.a.mark(function e(){var i,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return sessionStorage.removeItem("canplay"),t.share_uid=t.$route.query.share_uid||"",t.getGlobalconf(),t.getConfigs(),e.next=6,p.a.hasLogins(t);case 6:sessionStorage.getItem("isss")&&(t.the_user=!0,sessionStorage.removeItem("isss")),console.log(t.the_user),i=t.$route.query.article_id,sessionStorage.setItem("article_id",o()(i)),t.initData(),a=t.$route.query.source||"",sessionStorage.setItem("ar-s",a),t.pay_source=a||sessionStorage.getItem("d-s")||sessionStorage.getItem("a-s");case 14:case"end":return e.stop()}},e,t)}))()},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){var t=this;if(document.querySelector(".note"))for(var e=document.querySelectorAll(".note"),i=function(i){var a=e[i].getAttribute("data-ref"),s=e[i].getAttribute("data-note");e[i].addEventListener("click",function(){t.data_ref=a,t.data_note=s,t.show_data=!0})},a=0;a<=e.length-1;a++)i(a)},methods:{initData:function(){var t=this;this.$http(m._7,{api_token:this.token,article_id:this.$route.query.article_id,share_uid:this.share_uid}).then(function(e){if("success"==e.data.status){t.ad=e.data.data,"1"==t.ad.is_limited_free&&(t.limited=!0),t.contentId=t.ad.content_id||"",t.ad_mini=e.data.data.part[0],"1"==t.ad.is_purchased&&(t.ispurchased=!0),"1"==t.ad_mini.is_trial?t.the_user=!0:t.the_user=!1,"audio"!=t.ad_mini.content_media_type_en&&(t.is_article=!1),t.catalog_id=t.ad_mini.catalog_id,t.the_type=e.data.data.type,t.article_id=t.ad_mini.article_id,t.scheme="vistopia://article?article_id="+t.article_id,t.opensource="节目ID:"+t.contentId+",小节ID:"+t.article_id,t.isvipfree=t.ad.is_vip_free,t.ad_data=t.ad_mini.ad_data?t.ad_mini.ad_data:null,t.full_vid=t.ad_mini.vid,"0"==t.ad_mini.is_trial&&(t.isTrial=!0),1==t.ad_mini.is_lock?t.audioUrl=t.ad_mini.sample_media_full_url:t.audioUrl=t.ad_mini.media_key_full_url;var i=t.GetRequest().source||"";_hmt.push(["_trackEvent","文稿页面的展示","DocID:"+t.article_id+",ConID:"+t.ad.content_id,"source:"+i,1]),sessionStorage.setItem("article_data",o()(e.data.data)),t.getPlayToken()}},function(t){console.log("error",t)})},getPlayToken:function(){var t,e=this;t=this.full_vid,this.$http(m._101,{api_token:this.token,vid:t}).then(function(t){"success"==t.data.status&&(e.full_play_token=t.data.data.play_token,e.handleInitData())},function(t){console.log("error",t)})},handleInitData:function(){var t=this;this.success=!0,this.$nextTick(function(){var e=t.$refs.article_content;e&&e.offsetHeight>1175&&!t.islogin?e.classList.add("artnologin"):t.$refs.login_btn&&(t.$refs.login_btn.style.display="none"),!(e&&e.offsetHeight>1175&&t.isTrial&&1==t.ad_mini.is_lock&&"charge"==t.the_type)||t.ispurchased||t.limited||1==t.is_exper||t.ad_mini&&1==t.ad_mini.is_receive||"lixiangjia_trial"==t.ad.vip_type&&("lixiangjia_trial"!=t.ad.vip_type||"0"!=t.isvipfree)||"lixiangjia"==t.ad.vip_type&&("lixiangjia"!=t.ad.vip_type||"0"!=t.isvipfree)||e.classList.add("artnologin"),t.is_article&&t.initVideoSdk()}),this.weixinShare(),this._id=this.ad.content_id,this.getDetail(),this.replaceStr(),sessionStorage.setItem("theTrueId",o()(this.ad_mini.article_id)),this.$route.meta.title=this.ad_mini.title,this.audio_length=this.ad_mini.duration_str,this.article_id=JSON.parse(sessionStorage.getItem("theTrueId")),this.getComments(),this.initShareLink(),this.initNewUser(),this.initBanner()},initVideoSdk:function(){var t=this;this.playerSdk=new VePlayer({id:"audio_volcano",url:this.audioUrl,autoplayMuted:!1,autoplay:!1,DanmuPlugin:{active:!1,usePanel:!1}}),this.playerSdk.on("player_create_finish",function(){t.video_player=t.playerSdk.getPlayerInstance(),console.log("创建完成"),console.log(t.video_player)}),this.playerSdk.on("complete",function(){console.log("complete"),t._canPlay02()}),this.playerSdk.on("canplay",function(){console.log("canplay"),t._canPlay()}),this.playerSdk.on("loadeddata",function(){console.log("loadeddata")})},initBanner:function(){this.is_exper=this.ad_mini.is_exper,this.exper_num=this.ad_mini.exper_num,this.exper_use_num=this.ad_mini.exper_use_num,this.experShow=0,this.ad_mini.trial_vip_day&&this.ad_mini.trial_vip_day.length,!this.isTrial||"charge"!=this.the_type||1!=this.ad_mini.is_lock||this.ispurchased||this.limited||"lixiangjia_trial"==this.ad.vip_type&&("lixiangjia_trial"!=this.ad.vip_type||"0"!=this.isvipfree)||"lixiangjia"==this.ad.vip_type&&("lixiangjia"!=this.ad.vip_type||"0"!=this.isvipfree)||(this.exper_num&&0!=this.exper_num&&this.exper_num>0&&!(this.exper_use_num>=this.exper_num&&0==this.is_exper)?0==this.is_exper?this.experShow=0:this.experShow=1:this.exper_num&&0!=this.exper_num&&this.exper_num>0&&this.exper_use_num>=this.exper_num&&0==this.is_exper&&0==this.ad_mini.is_trial?this.experShow=2:this.experShow=0),console.log("this.is_exper:"+this.is_exper)},jumpLink:function(t){-1!=t.indexOf("member")&&this.$router.push({path:"/member_new",query:{spm:"article",tm:"h5"}})},goBack:function(){this.$router.push({path:"/index"})},_jumpShow:function(t){location.href=t},_jump:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&_hmt.push(["_trackEvent","付费小节试听结束后弹窗去节目的点击","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]),setTimeout(function(){e.$router.push({path:"/detail",query:{id:t}})},300)},_jumpPlan:function(){window.isApp,this.$router.push({path:"/member_new",query:{spm:"article",tm:"h5"}})},checkToken:function(){var t=this;return l()(s.a.mark(function e(){var i,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.parse(localStorage.getItem("api_token"))||"",e.next=3,t.$http(m._103,{api_token:i});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,t)}))()},audioState:function(){if(!this.islogin)return p.a.goLogin.call(this);this.play=!this.play;this.video_player.video;this.play?(this.video_player.play(),this.status="play",this.isTrial&&"charge"==this.the_type?_hmt.push(["_trackEvent","付费小节播放按钮的点击","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]):_hmt.push(["_trackEvent","文稿详情页播放按钮的点击-音频","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1])):(this.video_player.pause(),this.status="pause")},playMusic:function(t){var e=parseInt(document.getElementsByClassName("klxAudio")[0].offsetLeft)+8,i=(t.pageX-e)/this.$refs.runfatbar.offsetWidth;if(this.$refs.runbar.style.width=100*i+"%",1!=sessionStorage.getItem("canplay"))sessionStorage.setItem("barWidth",i);else{var a=this.video_player.video;a.currentTime=a.duration*i}this.video_player.play(),this.play=!0,this.status="play"},_canPlay:function(){var t=this;sessionStorage.setItem("canplay",1);var e=this.video_player.video,i=this.$refs.runbar,a=this.$refs.runfatbar,s=this.$refs.runfatbar?this.$refs.runfatbar.offsetWidth:"",n=this.$refs.main_content,o=parseInt(document.getElementsByClassName("klxAudio")[0].offsetLeft)+8,r=!1;if(sessionStorage.getItem("barWidth")&&sessionStorage.getItem("barWidth")>0){var l=parseFloat(sessionStorage.getItem("barWidth"));e.currentTime=e.duration*l,console.log("barwidth",sessionStorage.getItem("barWidth")),sessionStorage.removeItem("barWidth")}if(e.addEventListener("canplay",function(){if(!t.isTrial||"charge"!=t.the_type){var i=e.duration,a=Math.floor(i/3600),s=Math.floor(i/60),n=Math.ceil(i%60),o=s-60*a;t.audio_length=a>9&&o>9&&n>9?a+":"+o+":"+n:a>0&&a<10&&o>9&&n>9?"0"+a+":"+o+":"+n:a>0&&a<10&&o<10&&n>9?"0"+a+":0"+o+":"+n:a>0&&a<10&&o<10&&n<10?"0"+a+":0"+o+":0"+n:a>9&&o>9&&n<10?a+":"+o+":0"+n:a>9&&o<10&&n<10?a+":0"+o+":0"+n:a>9&&o<10&&n>9?a+":0"+o+":"+n:a>0&&a<10&&o>9&&n<10?"0"+a+":0"+o+":0"+n:0==a&&s<10&&n<10?"0"+s+":0"+n:0==a&&s<10?"0"+s+":"+n:0==a&&n<10?s+":0"+n:s+":"+n}}),e.addEventListener("timeupdate",function(){var a=e.duration,s=e.currentTime;i.style.width=s/a*100+"%";var n=Math.floor(s/60),o=Math.floor(s%60);t.audio_already=n<10&&o<10?"0"+n+":0"+o:n<10?"0"+n+":"+o:o<10?n+":0"+o:n+":"+o}),e.addEventListener("ended",function(){console.log("播放结束"),!t.isTrial||t.ispurchased||"charge"!=t.the_type||1==t.is_exper||t.ad_mini&&1==t.ad_mini.is_receive||"1"==t.ad.is_vip_free&&"lixiangjia"!=t.ad.vip_type&&"lixiangjia_trial"!=t.ad.vip_type&&(t.showModel=!0,t.showModelType="trialend")}),a.addEventListener("touchmove",function(e){var a=parseFloat(e.targetTouches[0].pageX)-parseFloat(o),n=a/s*100>100?100:a/s*100;i.style.width=n+"%",t.video_player.pause(),t.play=!0}),a.addEventListener("touchend",function(){var a=i.offsetWidth/s;e.currentTime=e.duration*a,t.video_player.play(),t.play=!0,t.status="play"}),a.addEventListener("mousedown",function(e){var a=parseFloat(e.pageX)-parseFloat(o),n=a/s*100>100?100:a/s*100;i.style.width=n+"%",t.video_player.pause(),t.play=!0,r=!0}),a.addEventListener("mousemove",function(e){if(r){var a=parseFloat(e.pageX)-parseFloat(o),n=a/s*100>100?100:a/s*100;i.style.width=n+"%",t.video_player.pause(),t.play=!0}}),n.addEventListener("mousemove",function(e){if(r){var a=parseFloat(e.pageX)-parseFloat(o),n=a/s*100>100?100:a/s*100;i.style.width=n+"%",t.video_player.pause(),t.play=!0}}),a.addEventListener("mouseup",function(){if(r){r=!1;var a=i.offsetWidth/s;e.currentTime=e.duration*a,t.video_player.play(),t.play=!0,t.status="play"}}),n.addEventListener("mouseup",function(){if(r){r=!1;var a=i.offsetWidth/s;e.currentTime=e.duration*a,t.video_player.play(),t.play=!0,t.status="play"}}),document.querySelector(".note"))for(var c=document.querySelectorAll(".note"),d=function(e){var i=c[e].getAttribute("data-ref"),a=c[e].getAttribute("data-note");c[e].addEventListener("click",function(){t.data_ref=i,t.data_note=a,t.show_data=!0})},_=0;_<=c.length-1;_++)d(_)},_canPlay02:function(){},goBuy:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isTrial&&"charge"==this.the_type&&(e?_hmt.push(["_trackEvent","付费小节固底购买按钮的点击","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]):_hmt.push(["_trackEvent","付费小节底部购买文字链的点击\t","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1])),setTimeout(function(){t.$router.push("/pay?id="+t.ad.content_id+"&_t="+Math.random())},300)},goCommentsValue:function(){this.isTrial&&"charge"==this.the_type?_hmt.push(["_trackEvent","付费小节固底评论按钮的点击","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]):_hmt.push(["_trackEvent","文稿详情页评论的点击-音频","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]),this.show_comments=!0},goContent:function(){var t=this._id;this.$router.push({path:"detail",query:{id:t}})},goDolApp:function(){"video"==this.ad_mini.content_media_type_en?_hmt.push(["_trackEvent","文稿详情页头部下载按钮的点击-视频","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]):"audio"==this.ad_mini.content_media_type_en&&(this.isTrial&&"charge"==this.the_type?_hmt.push(["_trackEvent","付费小节下载按钮的点击","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]):_hmt.push(["_trackEvent","文稿详情页头部下载按钮的点击-音频","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1])),window.location.href="https://app.vistopia.com.cn/download/?source="+this.pay_source},goDol:function(){_hmt.push(["_trackEvent","文稿详情页下载button的点击-音频","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]),window.location.href="https://app.vistopia.com.cn/download/?source="+this.pay_source},goArticle:function(){this.$router.push("article")},beforeClose:function(t,e){e()},getDetail:function(){var t=this;if(null==JSON.parse(localStorage.getItem("userinfo")))var e="";else e=JSON.parse(localStorage.getItem("userinfo")).api_token;this.axios.get("https://api.vistopia.com.cn/api/v1/content/content-show/"+this._id+"?api_token="+e,{}).then(function(e){t.goodss=e.data.data||{},(e.data.data.catalog||[]).forEach(function(e){e.catalog_id==t.catalog_id&&(t.catalog_title=e.catalog_title||null)}),t.is_coupon=e.data.data.is_coupon,sessionStorage.setItem("lastVisitedGoods",o()(e.data.data))}).catch(function(t){console.log(t)})},replaceStr:function(){this.ad_mini.content=p.b.replaceStr(this.ad_mini.content)},getComments:function(){var t=this;this.axios.get("https://api.vistopia.com.cn/api/v1/comment/article-comment?article_id="+this.article_id+"&page=1",{}).then(function(e){t.trueCommentsInfo=e.data.data,t.finalArr=t.trueCommentsInfo.data,t.finalArr.slice(0,7),t.finalArr.length>=7&&(t.the_key=!0)}).catch(function(t){console.log(t)})},weixinShare:function(){var t={title:this.ad_mini.title,desc:this.ad_mini.share_desc,link:window.location.href,imgUrl:this.ad.background_img};C.a.wxRegister(t)},goLogin:function(){sessionStorage.setItem("callbackUrl",location.href),this.$router.push({path:"/login",query:{_t:Math.random()}})},jumpLogins:function(){_hmt.push(["_trackEvent","文稿详情页注册浮窗按钮的点击\t","节目id:"+this.ad.content_id,"小节id:"+this.article_id,1]),p.a.jumpLogin(this)},skipTo:function(t,e){window.location.href=e},getGlobalconf:function(){var t=this;return l()(s.a.mark(function e(){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http(m._71);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0="";case 5:(i=e.t0)&&(t.guideImg=i.data.data.app_config.pop_coupon_img);case 7:case"end":return e.stop()}},e,t)}))()},getConfigs:function(){var t=this;this.$http(m._4).then(function(e){"success"==e.data.status&&("on"==e.data.data.vip_config.online&&(t.openVip=!0),"on"==e.data.data.friend_config.online&&(t.openPlan=!0))},function(t){console.log("error",t)})},GetRequest:function(){var t=window.location.search,e=new Object;if(-1!=t.indexOf("?"))for(var i=t.substr(1).split("&"),a=0;a<i.length;a++)e[i[a].split("=")[0]]=unescape(i[a].split("=")[1]);return e},initShareLink:function(){if(console.log("分享赠礼打印数据"),console.log(this.ad_mini),this.ad_mini.is_share_receive&&0!=this.ad_mini.is_share_receive){if(this.isShareGiftType=0,this.shareGiftText="",!this.islogin)return this.isShareGiftType=1,void(this.shareGiftText="好友送你一集限免收听福利，登录领取哦 >>");if(this.ad_mini&&1==this.ad_mini.is_self)1==this.ad_mini.is_self_receive?(this.isShareGiftType=1,this.shareGiftText="🎉 已有好友领取试听体验，看看谁抢到了 >>>"):(this.isShareGiftType=1,this.shareGiftText="还没有好友领取本集畅听福利，继续送免费听 >>");else if(this.ad_mini)if(this.ad_mini.is_receive)switch(this.ad_mini.is_receive.toString()){case"0":this.isShareGiftType=0;break;case"1":if(this.isShareGiftType=2,this.shareGiftText="🎉 恭喜成功领取好友赠送的本集限免福利<br/>购买可解锁全部单集",1==this.ad_mini.is_now_receive){this.showModel=!0,this.showModelType="giftRecieve",this.alert_text="🎉<br/>恭喜成功领取好友赠送的本集限免福利",this.countdown=5;var t=this,e=setInterval(function(){console.log(t.countdown),t.countdown>0?t.countdown--:(window.clearInterval(e),t.showModel=!1)},1e3)}break;case"2":this.isShareGiftType=1,this.shareGiftText="😥 本集限免福利已被领完，购买即可解锁全部单集",console.log(2);break;case"3":this.isShareGiftType=2,this.shareGiftText="😥 你已经领过本节目的 "+this.ad_mini.receive_count+" 集限免福利，无法继续领取。<br/>喜欢就购买解锁全部吧～";break;default:this.isShareGiftType=0}else this.isShareGiftType=0}},shareGiftClick:function(){var t=this,e=this,i=JSON.parse(localStorage.getItem("userinfo"))?JSON.parse(localStorage.getItem("userinfo")).api_token:"";this.islogin?1==this.ad_mini.is_self&&1==this.ad_mini.is_self_receive?this.$http(m._208,{api_token:i,content_id:this.ad.content_id,article_id:this.article_id}).then(function(i){"success"==i.data.status?(t.shareUserData=i.data.data,t.shareUserData.users&&t.shareUserData.users.length>0&&(t.shareUserData.users.forEach(function(e){if(e.time&&-1!=e.time.indexOf(" ")){var i=e.time.split(" ")[0],a=e.time.split(" ")[1].split(":");a=a[0]+":"+a[1];var s=(i=i.split("-"))[0],n=i[1];n.length>1&&0==n.split("")[0]&&(n=n.split("")[1]);var o=i[2];o.length>1&&0==o.split("")[0]&&(o=o.split("")[1]),console.log((new Date).getFullYear()),console.log((new Date).getMonth()+1),console.log((new Date).getDate()),i=(new Date).getFullYear()==s&&(new Date).getMonth()+1==n&&(new Date).getDate()==o?"今天":n+"月"+o+"日",t.$set(e,"time",i+" "+a+"领取")}}),e.showModel=!0,e.showModelType="sharelist")):e.$toast(i.data.message)},function(t){console.log("error",t)}):1==this.ad_mini.is_self&&0==this.ad_mini.is_self_receive&&this.$toast("点击右上角,分享给好友"):this.goLogin()},sharelistClick:function(){this.prohibitSlide=!1},giftShare:function(){this.$toast("点击右上角,分享给好友"),this.showModel=!1,this.showModelType=""},initNewUser:function(){this.ad_mini.new_trial&&(this.new_trial=this.ad_mini.new_trial),this.ad.popup&&(this.popup=this.ad.popup),this.trialShow(),console.log(this.new_trial),console.log(this.popup)},_jumpTrial:function(){if(this.new_trial.link_url&&this.new_trial.link_url.indexOf("?")){var t=this.new_trial.link_url.split("?")[1],e="",i="";if(t.indexOf("&"))for(var a=t.split("&"),s=0;s<a.length;s++)a[s].indexOf("=")&&"goods_type"==a[s].split("=")[0]?e=a[s].split("=")[1]:a[s].indexOf("=")&&"content_id"==a[s].split("=")[0]&&(i=a[s].split("=")[1]);console.log(e),console.log(i),e&&i&&this.$router.push({path:"/pay",query:{goods_type:e,content_id:i,id:i,type:"new"}})}},trialShow:function(){if(this.new_trial){var t=this;if(this.new_trial.counter||0==this.new_trial.counter){this.new_trial.counter=parseInt(this.new_trial.counter);var e=parseInt(this.new_trial.counter);console.log(e),console.log(this.new_trial.counter);var i=setInterval(function(){e>0?e--:(clearInterval(i),t.new_trial.counter=0),t.trailCounter=t.formateSeconds(e)},1e3)}}},formateSeconds:function(t){var e=parseInt(t),i=0,a=0;return e>60&&(i=parseInt(e/60),e=parseInt(e%60),i>60&&(a=parseInt(i/60),i=parseInt(i%60))),a.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.success?i("div",{staticClass:"course",class:{slideFlag:t.prohibitSlide}},[i("div",{staticClass:"toper-unlogin"},[i("div",{staticClass:"toper-logo"}),t._v(" "),i("div",{staticClass:"toper-right"},[i("div",{staticClass:"toper_bt"},[i("open-app",{attrs:{source:t.opensource,scheme:t.scheme}})],1),t._v(" "),i("div",{staticClass:"toper_back",on:{click:t.goBack}},[t._v("回首页")]),t._v(" "),i("div",{staticClass:"toper_icon"})])]),t._v(" "),1==t.experShow&&0==t.isShareGiftType?i("div",{staticClass:"toper-alerts"},[i("div",{staticClass:"alert-nums"},[t._v(t._s(t.exper_use_num)+"/"+t._s(t.exper_num))]),t._v(" "),i("div",{staticClass:"alert-text"},[t._v("\n        你可以免费体验 "),i("b",[t._v(t._s(t.exper_num)+"集")]),t._v(" 本节目，已体验\n        "),i("b",[t._v(t._s(t.exper_use_num)+"集")]),t._v("，购买后解锁全部内容\n      ")])]):t._e(),t._v(" "),2==t.experShow&&0==t.isShareGiftType?i("div",{staticClass:"toper-alerts02"},[t._v("\n      免费体验机会已用完，可试听2分钟\n    ")]):t._e(),t._v(" "),1==t.isShareGiftType?i("div",{staticClass:"toper-alerts02 toper-alerts03",domProps:{innerHTML:t._s(t.shareGiftText)},on:{click:t.shareGiftClick}}):t._e(),t._v(" "),2==t.isShareGiftType?i("div",{staticClass:"toper-alerts02 toper-alerts04",domProps:{innerHTML:t._s(t.shareGiftText)}}):t._e(),t._v(" "),t.ad.notify&&t.ad.notify.msg?i("div",{staticClass:"toper-alerts02",on:{click:function(e){t.jumpLink(t.ad.notify.url)}}},[t._v("\n      "+t._s(t.ad.notify.msg)+"\n    ")]):t._e(),t._v(" "),t.is_article?i("div",{ref:"main_content"},[i("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.$route.meta.title,expression:"$route.meta.title"}]}),t._v(" "),i("div",{staticClass:"bottom-view no-show",attrs:{id:"buyBtn"}},[t.popup&&t.popup.label_text&&"charge"==t.the_type&&!t.ispurchased?i("div",{staticClass:"plan_tips tips_trial",class:{plan_tips_long:t.popup.label_text&&t.popup.label_text.length>10},on:{click:t._jumpTrial}},[t._v("\n          "+t._s(t.popup.label_text)+"\n          "),i("img",{attrs:{src:"http://cdn.vistopia.com.cn/1635400506982.png",alt:""}})]):t._e(),t._v(" "),i("div",{staticClass:"bottom-index"},[0==t.ad_mini.comment_count?i("div",{staticClass:"bottom-tips",on:{click:t.goCommentsValue}},[i("i"),t._v("\n            暂无评论\n          ")]):i("div",{staticClass:"bottom-tips",on:{click:t.goCommentsValue}},[i("i"),t._v("\n            全部评论"+t._s("("+t.ad_mini.comment_count+")")+"\n          ")]),t._v(" "),t.ad.is_friend_vip&&1==t.ad.is_friend_vip?i("div",{staticClass:"bottom-btn"},["free"==t.the_type&&!t.limited||1==t.the_user&&!t.limited||t.ispurchased?i("div",{on:{click:t.goDol}},[t._v("\n              下载看理想App\n            ")]):i("div",{on:{click:t.goBuy}},[t._v("\n              购买\n              "),i("span",{staticClass:"b_s1"},[t._v("¥"+t._s(t.ad.friend_vip_price))]),t._v(" "),i("span",{staticClass:"b_s2"},[t._v("¥"+t._s(t.ad.complete_class_price))]),t._v(" "),"1"==t.is_coupon?i("i",{staticClass:"coupon"}):t._e()])]):i("div",{staticStyle:{flex:"1"}},["free"==t.the_type&&!t.limited||1==t.the_user&&!t.limited||t.ispurchased?i("div",{staticClass:"bottom-btn",on:{click:t.goDol}},[t._v("\n              下载看理想App\n            ")]):i("div",{staticClass:"bottom-btn",on:{click:t.goBuy}},[0==t.ad.is_promotion?i("div",[t._v("\n                购买¥"+t._s(t.ad.complete_class_price)+"\n                "),"1"==t.is_coupon?i("i",{staticClass:"coupon"}):t._e()]):t._e(),t._v(" "),1==t.ad.is_promotion?i("div",[t._v("\n                购买¥"+t._s(t.ad.promotion_price)+"\n                "),1==t.ad.is_promotion?i("span",{staticClass:"rabbish-price"},[t._v(" ¥"+t._s(t.ad.complete_class_price))]):t._e(),t._v(" "),"1"==t.ad.is_coupon?i("i",{staticClass:"coupon"}):t._e()]):t._e()])])])]),t._v(" "),i("div",{staticClass:"course-content first",class:[1==t.experShow||2==t.isShareGiftType||t.trial_vip_day_tip?"height120":2==t.experShow||t.ad.notify&&t.ad.notify.msg?"height98":1==t.isShareGiftType?"height105":""]},[i("div",{staticClass:"author-head article-margin"}),t._v(" "),t.canShow?i("div",{staticClass:"dol-sign"},[t.catalog_title?i("div",{staticClass:"dol_tit"},[t._v(t._s(t.catalog_title))]):t._e(),t._v(" "),i("div",{staticClass:"cent",on:{click:function(e){t._jump(t.ad.nice_id)}}},[i("div",{staticClass:"dol-img"},[i("img",{attrs:{src:t.ad.small_background_img,alt:""}})]),t._v(" "),i("div",{staticClass:"dol-top"},[i("div",{staticClass:"jiange"},[i("div",{staticClass:"dol-title"},[t._v(t._s(t.ad.author))])]),t._v(" "),i("div",{staticClass:"dol_t_tit"},[t._v(t._s(t.ad.title))])])])]):t._e(),t._v(" "),i("div",{staticClass:"course-head article-margin"},[i("div",{staticClass:"course-head-title-view"},[i("p",{staticClass:"course-head-title"},[t._v(t._s(t.ad_mini.title))])])]),t._v(" "),i("div",{staticClass:"klxAudio"},[i("div",{attrs:{id:"audio_volcano"}}),t._v(" "),i("div",{staticStyle:{width:"100%"}},[i("span",{ref:"audioArea",staticClass:"db audio-area",attrs:{id:"audio-area"}},[i("div",{staticClass:"audio-desc db",attrs:{id:"audio-desc"}},[i("div",{staticClass:"audio-tips db"},[t._v(t._s(t.ad_mini.title))]),t._v(" "),i("div",{staticClass:"bar"},[i("div",{ref:"runfatbar",staticClass:"progressbar",on:{click:t.playMusic}},[i("div",{ref:"runbar",staticClass:"yellowbar"},[t.isphone?i("span",{staticClass:"ball",attrs:{draggable:"true"}}):i("span",{staticClass:"ball"})])])]),t._v(" "),i("div",{staticClass:"audio-info"},[i("span",{staticClass:"audio-begin"},[t._v(t._s(t.audio_already))]),t._v(" "),i("span",{staticClass:"audio-length"},[t._v(t._s(t.audio_length))])])]),t._v(" "),i("span",{staticClass:"audio_play_area",on:{click:t.audioState}},[i("i",{directives:[{name:"show",rawName:"v-show",value:"pause"==t.status,expression:"status == 'pause'"}],staticClass:"tocPlay"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:"play"==t.status,expression:"status == 'play'"}],staticClass:"tocPlaying"})])]),t._v(" "),t.ad_mini&&1==t.ad_mini.is_lock?i("div",{staticClass:"try_text"},[t._v("\n              当前音频可试听120s，点击收听\n            ")]):t._e()])])]),t._v(" "),i("div",{ref:"article",staticClass:"article",attrs:{id:"article-self"}},[i("div",{ref:"article_content",staticClass:"article_content",domProps:{innerHTML:t._s(t.ad_mini.content)}}),t._v(" "),i("van-dialog",{attrs:{"before-close":t.beforeClose},model:{value:t.show_data,callback:function(e){t.show_data=e},expression:"show_data"}},[i("span",{staticClass:"dialog"},[t._v("\n            "+t._s(t.data_ref+":")+"\n            "),i("br"),t._v("\n            "+t._s(t.data_note)+"\n          ")])]),t._v(" "),t.islogin||t.isTrial&&(!t.isTrial||"free"!=t.the_type)?t._e():i("div",{ref:"login_btn",staticClass:"login_btn",on:{click:t.goLogin}},[t._v("\n          请登录后查看\n        ")]),t._v(" "),t.ad_mini&&1==t.ad_mini.is_lock?i("div",{staticClass:"trySee"},[i("div",{staticClass:"trysee_bg_t"}),t._v(" "),t.islogin?t._e():i("div",{staticClass:"try_login",on:{click:t.goLogin}}),t._v(" "),t.islogin&&!t.new_trial?i("div",{staticClass:"try_see",on:{click:function(e){t.goBuy(!0)}}}):t._e(),t._v(" "),t.islogin&&t.new_trial?i("div",{staticClass:"try_see02",on:{click:t._jumpTrial}},[t._m(0),t._v(" "),i("div",{staticClass:"tips"},[t._v(t._s(t.new_trial.info_txt))])]):t._e()]):t._e(),t._v(" "),!t.isTrial||"charge"!=t.the_type||t.ispurchased||1!=t.ad_mini.is_lock||t.limited||1==t.is_exper||t.ad_mini&&1==t.ad_mini.is_receive||"lixiangjia_trial"==t.ad.vip_type&&("lixiangjia_trial"!=t.ad.vip_type||"0"!=t.isvipfree)||"lixiangjia"==t.ad.vip_type&&("lixiangjia"!=t.ad.vip_type||"0"!=t.isvipfree)||!t.new_trial?t._e():i("div",{staticClass:"guideImg new_trial_img",on:{click:t._jumpTrial}},[i("img",{attrs:{src:t.new_trial.background_image,alt:""}}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.trailCounter))])]),t._v(" "),!t.islogin||t.new_trial||!t.ad_data||!t.isTrial||"charge"!=t.the_type||t.ispurchased||1!=t.ad_mini.is_lock||t.limited||1==t.is_exper||t.ad_mini&&1==t.ad_mini.is_receive||"lixiangjia_trial"==t.ad.vip_type&&("lixiangjia_trial"!=t.ad.vip_type||"0"!=t.isvipfree)||"lixiangjia"==t.ad.vip_type&&("lixiangjia"!=t.ad.vip_type||"0"!=t.isvipfree)?t._e():i("div",{staticClass:"ad_data",on:{click:function(e){t.skipTo("ad",t.ad_data.link_url)}}},[t.ad_data.background_image?i("img",{attrs:{src:t.ad_data.background_image,alt:""}}):t._e()])],1)]):i("Va",{attrs:{islogin:t.islogin,full_play_token:t.full_play_token,full_vid:t.full_vid,nickname:t.nickname}}),t._v(" "),t.is_article?i("van-popup",{staticClass:"ddd",attrs:{position:"right"},model:{value:t.show_comments,callback:function(e){t.show_comments=e},expression:"show_comments"}},[i("ul",{staticClass:"liaobuqi"},[i("div",{staticClass:"comments"},[i("div",{staticClass:"top"},[i("span",{on:{click:function(e){t.show_comments=!1}}},[t._v("    ")])]),t._v(" "),i("div",{staticClass:"comments-list"},[i("div",{directives:[{name:"show",rawName:"v-show",value:0==t.trueCommentsInfo.total,expression:"trueCommentsInfo.total == 0"}],staticClass:"bgimg"}),t._v(" "),i("ul",t._l(t.finalArr,function(e){return i("li",{staticClass:"comment"},[i("div",{staticClass:"avatar fl-left"},[null!==e.user&&e.user.avatar_url?i("img",{attrs:{src:e.user.avatar_url||t.default_avatar,alt:""}}):i("img",{attrs:{src:t.default_avatar,alt:""}})]),t._v(" "),i("div",{staticClass:"comment-content"},[null!==e.user?i("div",{staticClass:"comment-info"},[i("span",{staticClass:"nick-name"},[t._v("\n                      "+t._s(e.user.nickname)+"\n                      "),i("span",{directives:[{name:"show",rawName:"v-show",value:"编辑推荐"==e.mark_str,expression:"item.mark_str == '编辑推荐'"}],staticClass:"upup"},[t._v(t._s(" "+e.mark_str+" "))])])]):t._e(),t._v(" "),i("span",{staticClass:"update-time"},[t._v(t._s(e.created_at_trans))]),t._v(" "),i("div",{staticClass:"comment-data"},[i("div",[t._v(t._s(e.comment))]),t._v(" "),e.children_count>=1?i("span",{staticClass:"trigle"}):t._e(),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:e.children_count>=1,expression:"item.children_count >= 1"}],staticClass:"children-talks"},[t._l(e.children_comment,function(e){return i("li",{staticClass:"child-talk"},[i("div",[i("p",[null!==e.user?i("span",{staticClass:"talker-name"},[t._v(t._s(e.user.nickname))]):t._e(),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.user_desc,expression:"item1.user_desc"}],staticClass:"talker-desc"},[t._v(t._s("("+e.user_desc+")"))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:3==e.type,expression:"item1.type == 3"}]},[t._v("回复")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:3==e.type,expression:"item1.type == 3"}],staticClass:"talker-replied"},[t._v(t._s(e.replied_username))]),t._v(" "),i("span",{staticClass:"talker-desc"},[t._v("：")]),t._v("\n                            "+t._s(e.comment)+"\n                          ")])])])}),t._v(" "),e.children_count>2?i("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ask_all_children",on:{click:function(i){t.askAllChildren(e.id)}}},[t._v("前往看理想App查看全部"+t._s(e.children_count+"条评论→"))]):t._e()],2)])])])}))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.the_key,expression:"the_key"}],staticClass:"bottom dpflex",on:{click:t.goDol}},[i("span",[t._v("前往看理想App 查看更多评论")])])])])]):t._e(),t._v(" "),t.islogin?t._e():i("div",{staticClass:"extension",on:{click:t.jumpLogins}},[i("img",{attrs:{src:t.guideImg,alt:""}})]),t._v(" "),"1"==t.goodss.is_show_view?i("div",{staticClass:"extension",on:{click:function(e){t._jumpShow(t.goodss.view_url)}}},[i("img",{attrs:{src:t.goodss.view_image_url,alt:""}})]):t._e(),t._v(" "),"trialend"==t.showModelType?i("base-alert-modal",{staticClass:"mask",attrs:{value:t.showModel},on:{"update:value":function(e){t.showModel=e}}},[i("div",{attrs:{slot:"modal-close"},slot:"modal-close"}),t._v(" "),i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"mask_course"},[i("div",{staticClass:"m_course_p1"},[t._v("试听结束")]),t._v(" "),i("div",{staticClass:"m_course_p2"},[t._v("购买节目收听完整内容")]),t._v(" "),i("div",{staticClass:"m_course_btn",on:{click:function(e){t._jump(t.ad.nice_id,!0)}}},[t._v("\n            查看节目\n          ")])])])]):t._e(),t._v(" "),"sharelist"==t.showModelType?i("base-alert-modal",{staticClass:"mask-share",class:[t.shareUserData.count&&0!=t.shareUserData.count?"":"mask-share02"],attrs:{value:t.showModel},on:{"update:value":function(e){t.showModel=e},click:t.sharelistClick}},[i("div",{attrs:{slot:"modal-close"},slot:"modal-close"}),t._v(" "),i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"sharelist-box"},[i("div",{staticClass:"title"},[t._v("已领取")]),t._v(" "),i("div",{class:[t.shareUserData.count&&t.shareUserData.count>0?"user-wrap01":"user-wrap02"]},[i("div",{staticClass:"user-wrap"},t._l(t.shareUserData.users,function(e,a){return i("div",{key:a,staticClass:"user-box"},[i("div",{staticClass:"icon"},[i("img",{attrs:{src:e.avatar_url&&"undefined"!=e.avatar_url?e.avatar_url:"http://cdn.vistopia.com.cn/1627232378498.png",alt:""}})]),t._v(" "),i("div",{staticClass:"text-wrap"},[i("div",{staticClass:"name"},[t._v(t._s(e.nickname))]),t._v(" "),i("div",{staticClass:"time"},[t._v(t._s(e.time))])])])}))]),t._v(" "),t.shareUserData.count&&t.shareUserData.count>0?i("div",{staticClass:"btn",on:{click:t.giftShare}},[t._v("\n            分享更多好友畅听\n          ")]):t._e(),t._v(" "),t.shareUserData.count&&t.shareUserData.count>0?i("div",{staticClass:"tip"},[t._v("\n            你可赠送的本集限免福利还有 "+t._s(t.shareUserData.count)+" 份\n          ")]):t._e(),t._v(" "),i("div",{staticClass:"shadow",class:[t.shareUserData.count&&0!=t.shareUserData.count?"":"shadow02"]})])])]):t._e(),t._v(" "),"giftRecieve"==t.showModelType?i("base-alert-modal",{staticClass:"giftRecieve",attrs:{value:t.showModel},on:{"update:value":function(e){t.showModel=e}}},[i("div",{attrs:{slot:"modal-close"},slot:"modal-close"}),t._v(" "),i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",[i("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.alert_text)}}),t._v(" "),i("div",{staticClass:"btn",on:{click:function(e){t.showModel=!1}}},[t._v("立即收听")]),t._v(" "),i("div",{staticClass:"countdown"},[t._v("关闭倒计时 "+t._s(t.countdown)+"s")])])])]):t._e()],1):i("div",[i("loading")],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"icon"},[e("img",{attrs:{src:"http://cdn.vistopia.com.cn/1630484493785.png",alt:""}})])}]};var x=i("VU/8")(w,k,!1,function(t){i("SfNb"),i("9KX3"),i("gqBv")},"data-v-4228c374",null);e.default=x.exports},b3GO:function(t,e){},"bL/P":function(t,e){},gqBv:function(t,e){},heIp:function(t,e){},sovK:function(t,e){}});