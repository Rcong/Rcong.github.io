!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).VePlayer=t()}(this,(function(){"use strict";function ownKeys$p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2$1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$p(Object(r),!0).forEach((function(t){_defineProperty$3(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i,o,a,s,u=t&&t.prototype instanceof d?t:d,f=Object.create(u.prototype),h=new S(n||[]);return f._invoke=(i=e,o=r,a=h,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return{value:void 0,done:!0}}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){var n=b(r,a);if(n){if(n===l)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";var u=c(i,o,a);if("normal"===u.type){if(s=a.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s="completed",a.method="throw",a.arg=u.arg)}}),f}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=u;var l={};function d(){}function f(){}function h(){}var p={};s(p,i,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(T([])));y&&y!==t&&r.call(y,i)&&(p=y);var v=h.prototype=d.prototype=Object.create(p);function m(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:$}}function $(){return{value:void 0,done:!0}}return f.prototype=h,s(v,"constructor",h),s(h,"constructor",f),f.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},m(_.prototype),s(_.prototype,o,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new _(u(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},m(v),s(v,a,"Generator"),s(v,i,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=T,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep$1(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$1(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){asyncGeneratorStep$1(o,n,i,a,s,"next",e)}function s(e){asyncGeneratorStep$1(o,n,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$3(e,t,r){return t&&_defineProperties$3(e.prototype,t),r&&_defineProperties$3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$3(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$2(e,t)}function _getPrototypeOf$2(e){return(_getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf$2(e,t){return(_setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct$s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function _objectWithoutProperties$1(e,t){if(null==e)return{};var r,n,i=_objectWithoutPropertiesLoose$1(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _assertThisInitialized$2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn$2(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(e)}function _createSuper$r(e){var t=_isNativeReflectConstruct$s();return function(){var r,n=_getPrototypeOf$2(e);if(t){var i=_getPrototypeOf$2(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn$2(this,r)}}function _superPropBase$2(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$2(e)););return e}function _get$2(){return _get$2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$2(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},_get$2.apply(this,arguments)}function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_unsupportedIterableToArray$3(e,t)||_nonIterableRest$1()}function _toConsumableArray$2(e){return _arrayWithoutHoles$2(e)||_iterableToArray$2(e)||_unsupportedIterableToArray$3(e)||_nonIterableSpread$2()}function _arrayWithoutHoles$2(e){if(Array.isArray(e))return _arrayLikeToArray$3(e)}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function _iterableToArray$2(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterableToArrayLimit$1(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}function _unsupportedIterableToArray$3(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$3(e,t):void 0}}function _arrayLikeToArray$3(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread$2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var commonjsGlobal$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}var lodash={exports:{}},module2,exports2;module2=lodash,exports2=lodash.exports,function(){var t,r="Expected a function",n="__lodash_hash_undefined__",i="__lodash_placeholder__",o=16,a=32,s=64,u=128,c=256,l=1/0,d=9007199254740991,f=NaN,h=4294967295,p=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",o],["flip",512],["partial",a],["partialRight",s],["rearg",c]],g="[object Arguments]",y="[object Array]",v="[object Boolean]",m="[object Date]",_="[object Error]",b="[object Function]",A="[object GeneratorFunction]",E="[object Map]",S="[object Number]",T="[object Object]",$="[object Promise]",w="[object RegExp]",C="[object Set]",I="[object String]",k="[object Symbol]",O="[object WeakMap]",P="[object ArrayBuffer]",R="[object DataView]",x="[object Float32Array]",D="[object Float64Array]",L="[object Int8Array]",N="[object Int16Array]",M="[object Int32Array]",B="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",F="[object Uint32Array]",V=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,H=/(__e\(.*?\)|\b__t\)) \+\n'';/g,K=/&(?:amp|lt|gt|quot|#39);/g,z=/[&<>"']/g,W=RegExp(K.source),Y=RegExp(z.source),X=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,q=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,re=RegExp(te.source),ne=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,se=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,le=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,he=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,ye=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,me=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_e=/($^)/,be=/['\n\r\u2028\u2029\\]/g,Ae="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ee="\\u2700-\\u27bf",Se="a-z\\xdf-\\xf6\\xf8-\\xff",Te="A-Z\\xc0-\\xd6\\xd8-\\xde",$e="\\ufe0e\\ufe0f",we="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ce="['’]",Ie="[\\ud800-\\udfff]",ke="["+we+"]",Oe="["+Ae+"]",Pe="\\d+",Re="[\\u2700-\\u27bf]",xe="["+Se+"]",De="[^\\ud800-\\udfff"+we+Pe+Ee+Se+Te+"]",Le="\\ud83c[\\udffb-\\udfff]",Ne="[^\\ud800-\\udfff]",Me="(?:\\ud83c[\\udde6-\\uddff]){2}",Be="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="["+Te+"]",je="(?:"+xe+"|"+De+")",Fe="(?:"+Ue+"|"+De+")",Ve="(?:['’](?:d|ll|m|re|s|t|ve))?",Ge="(?:['’](?:D|LL|M|RE|S|T|VE))?",He="(?:"+Oe+"|"+Le+")?",Ke="[\\ufe0e\\ufe0f]?",ze=Ke+He+"(?:\\u200d(?:"+[Ne,Me,Be].join("|")+")"+Ke+He+")*",We="(?:"+[Re,Me,Be].join("|")+")"+ze,Ye="(?:"+[Ne+Oe+"?",Oe,Me,Be,Ie].join("|")+")",Xe=RegExp(Ce,"g"),Ze=RegExp(Oe,"g"),qe=RegExp(Le+"(?="+Le+")|"+Ye+ze,"g"),Qe=RegExp([Ue+"?"+xe+"+"+Ve+"(?="+[ke,Ue,"$"].join("|")+")",Fe+"+"+Ge+"(?="+[ke,Ue+je,"$"].join("|")+")",Ue+"?"+je+"+"+Ve,Ue+"+"+Ge,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pe,We].join("|"),"g"),Je=RegExp("[\\u200d\\ud800-\\udfff"+Ae+$e+"]"),et=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,nt={};nt[x]=nt[D]=nt[L]=nt[N]=nt[M]=nt[B]=nt[U]=nt[j]=nt[F]=!0,nt[g]=nt[y]=nt[P]=nt[v]=nt[R]=nt[m]=nt[_]=nt[b]=nt[E]=nt[S]=nt[T]=nt[w]=nt[C]=nt[I]=nt[O]=!1;var it={};it[g]=it[y]=it[P]=it[R]=it[v]=it[m]=it[x]=it[D]=it[L]=it[N]=it[M]=it[E]=it[S]=it[T]=it[w]=it[C]=it[I]=it[k]=it[B]=it[U]=it[j]=it[F]=!0,it[_]=it[b]=it[O]=!1;var ot={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,st=parseInt,ut="object"==_typeof$3(commonjsGlobal$1)&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,ct="object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self&&self.Object===Object&&self,lt=ut||ct||Function("return this")(),dt=exports2&&!exports2.nodeType&&exports2,ft=dt&&module2&&!module2.nodeType&&module2,ht=ft&&ft.exports===dt,pt=ht&&ut.process,gt=function(){try{var t=ft&&ft.require&&ft.require("util").types;return t||pt&&pt.binding&&pt.binding("util")}catch(e){}}(),yt=gt&&gt.isArrayBuffer,vt=gt&&gt.isDate,mt=gt&&gt.isMap,_t=gt&&gt.isRegExp,bt=gt&&gt.isSet,At=gt&&gt.isTypedArray;function Et(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function St(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n}function Tt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function $t(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function wt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function Ct(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}function It(e,t){return!(null==e||!e.length)&&Bt(e,t,0)>-1}function kt(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function Ot(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function Pt(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function Rt(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function xt(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function Dt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Lt=Vt("length");function Nt(e,t,r){var n;return r(e,(function(e,r,i){if(t(e,r,i))return n=r,!1})),n}function Mt(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Bt(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):Mt(e,jt,r)}function Ut(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1}function jt(e){return e!=e}function Ft(e,t){var r=null==e?0:e.length;return r?Kt(e,t)/r:f}function Vt(e){return function(r){return null==r?t:r[e]}}function Gt(e){return function(r){return null==e?t:e[r]}}function Ht(e,t,r,n,i){return i(e,(function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)})),r}function Kt(e,r){for(var n,i=-1,o=e.length;++i<o;){var a=r(e[i]);a!==t&&(n=n===t?a:n+a)}return n}function zt(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Wt(e){return e?e.slice(0,lr(e)+1).replace(ne,""):e}function Yt(e){return function(t){return e(t)}}function Xt(e,t){return Ot(t,(function(t){return e[t]}))}function Zt(e,t){return e.has(t)}function qt(e,t){for(var r=-1,n=e.length;++r<n&&Bt(t,e[r],0)>-1;);return r}function Qt(e,t){for(var r=e.length;r--&&Bt(t,e[r],0)>-1;);return r}function Jt(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}var er=Gt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),tr=Gt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rr(e){return"\\"+ot[e]}function nr(e){return Je.test(e)}function ir(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function or(e,t){return function(r){return e(t(r))}}function ar(e,t){for(var r=-1,n=e.length,o=0,a=[];++r<n;){var s=e[r];s!==t&&s!==i||(e[r]=i,a[o++]=r)}return a}function sr(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function ur(e){return nr(e)?function(e){for(var t=qe.lastIndex=0;qe.test(e);)++t;return t}(e):Lt(e)}function cr(e){return nr(e)?function(e){return e.match(qe)||[]}(e):function(e){return e.split("")}(e)}function lr(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var dr=Gt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),fr=function ie(Ae){var Ee,Se=(Ae=null==Ae?lt:fr.defaults(lt.Object(),Ae,fr.pick(lt,tt))).Array,Te=Ae.Date,$e=Ae.Error,we=Ae.Function,Ce=Ae.Math,Ie=Ae.Object,ke=Ae.RegExp,Oe=Ae.String,Pe=Ae.TypeError,Re=Se.prototype,xe=we.prototype,De=Ie.prototype,Le=Ae["__core-js_shared__"],Ne=xe.toString,Me=De.hasOwnProperty,Be=0,Ue=(Ee=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||""))?"Symbol(src)_1."+Ee:"",je=De.toString,Fe=Ne.call(Ie),Ve=lt._,Ge=ke("^"+Ne.call(Me).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=ht?Ae.Buffer:t,Ke=Ae.Symbol,ze=Ae.Uint8Array,We=He?He.allocUnsafe:t,Ye=or(Ie.getPrototypeOf,Ie),qe=Ie.create,Je=De.propertyIsEnumerable,ot=Re.splice,ut=Ke?Ke.isConcatSpreadable:t,ct=Ke?Ke.iterator:t,dt=Ke?Ke.toStringTag:t,ft=function(){try{var t=po(Ie,"defineProperty");return t({},"",{}),t}catch(e){}}(),pt=Ae.clearTimeout!==lt.clearTimeout&&Ae.clearTimeout,gt=Te&&Te.now!==lt.Date.now&&Te.now,Lt=Ae.setTimeout!==lt.setTimeout&&Ae.setTimeout,Gt=Ce.ceil,hr=Ce.floor,pr=Ie.getOwnPropertySymbols,gr=He?He.isBuffer:t,yr=Ae.isFinite,vr=Re.join,mr=or(Ie.keys,Ie),_r=Ce.max,br=Ce.min,Ar=Te.now,Er=Ae.parseInt,Sr=Ce.random,Tr=Re.reverse,$r=po(Ae,"DataView"),wr=po(Ae,"Map"),Cr=po(Ae,"Promise"),Ir=po(Ae,"Set"),kr=po(Ae,"WeakMap"),Or=po(Ie,"create"),Pr=kr&&new kr,Rr={},xr=Ho($r),Dr=Ho(wr),Lr=Ho(Cr),Nr=Ho(Ir),Mr=Ho(kr),Br=Ke?Ke.prototype:t,Ur=Br?Br.valueOf:t,jr=Br?Br.toString:t;function Fr(e){if(ss(e)&&!Za(e)&&!(e instanceof Kr)){if(e instanceof Hr)return e;if(Me.call(e,"__wrapped__"))return Ko(e)}return new Hr(e)}var Vr=function(){function e(){}return function(r){if(!as(r))return{};if(qe)return qe(r);e.prototype=r;var n=new e;return e.prototype=t,n}}();function Gr(){}function Hr(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=t}function Kr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function zr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Wr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Yr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Xr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Yr;++t<r;)this.add(e[t])}function Zr(e){var t=this.__data__=new Wr(e);this.size=t.size}function qr(e,t){var r=Za(e),n=!r&&Xa(e),i=!r&&!n&&es(e),o=!r&&!n&&!i&&gs(e),a=r||n||i||o,s=a?zt(e.length,Oe):[],u=s.length;for(var c in e)!t&&!Me.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ao(c,u))||s.push(c);return s}function Qr(e){var r=e.length;return r?e[Zn(0,r-1)]:t}function Jr(e,t){return Bo(Pi(e),cn(t,0,e.length))}function en(e){return Bo(Pi(e))}function tn(e,r,n){(n!==t&&!za(e[r],n)||n===t&&!(r in e))&&sn(e,r,n)}function rn(e,r,n){var i=e[r];Me.call(e,r)&&za(i,n)&&(n!==t||r in e)||sn(e,r,n)}function nn(e,t){for(var r=e.length;r--;)if(za(e[r][0],t))return r;return-1}function on(e,t,r,n){return pn(e,(function(e,i,o){t(n,e,r(e),o)})),n}function an(e,t){return e&&Ri(t,Ms(t),e)}function sn(e,t,r){"__proto__"==t&&ft?ft(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function un(e,r){for(var n=-1,i=r.length,o=Se(i),a=null==e;++n<i;)o[n]=a?t:Rs(e,r[n]);return o}function cn(e,r,n){return e==e&&(n!==t&&(e=e<=n?e:n),r!==t&&(e=e>=r?e:r)),e}function ln(e,r,n,i,o,a){var s,u=1&r,c=2&r,l=4&r;if(n&&(s=o?n(e,i,o,a):n(e)),s!==t)return s;if(!as(e))return e;var d=Za(e);if(d){if(s=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Me.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!u)return Pi(e,s)}else{var f=vo(e),h=f==b||f==A;if(es(e))return $i(e,u);if(f==T||f==g||h&&!o){if(s=c||h?{}:_o(e),!u)return c?function(e,t){return Ri(e,yo(e),t)}(e,function(e,t){return e&&Ri(t,Bs(t),e)}(s,e)):function(e,t){return Ri(e,go(e),t)}(e,an(s,e))}else{if(!it[f])return o?e:{};s=function(e,t,r){var n,i=e.constructor;switch(t){case P:return wi(e);case v:case m:return new i(+e);case R:return function(e,t){var r=t?wi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case x:case D:case L:case N:case M:case B:case U:case j:case F:return Ci(e,r);case E:return new i;case S:case I:return new i(e);case w:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case C:return new i;case k:return n=e,Ur?Ie(Ur.call(n)):{}}}(e,f,u)}}a||(a=new Zr);var p=a.get(e);if(p)return p;a.set(e,s),fs(e)?e.forEach((function(t){s.add(ln(t,r,n,t,e,a))})):us(e)&&e.forEach((function(t,i){s.set(i,ln(t,r,n,i,e,a))}));var y=d?t:(l?c?ao:oo:c?Bs:Ms)(e);return Tt(y||e,(function(t,i){y&&(t=e[i=t]),rn(s,i,ln(t,r,n,i,e,a))})),s}function dn(e,r,n){var i=n.length;if(null==e)return!i;for(e=Ie(e);i--;){var o=n[i],a=r[o],s=e[o];if(s===t&&!(o in e)||!a(s))return!1}return!0}function fn(e,n,i){if("function"!=typeof e)throw new Pe(r);return Do((function(){e.apply(t,i)}),n)}function hn(e,t,r,n){var i=-1,o=It,a=!0,s=e.length,u=[],c=t.length;if(!s)return u;r&&(t=Ot(t,Yt(r))),n?(o=kt,a=!1):t.length>=200&&(o=Zt,a=!1,t=new Xr(t));e:for(;++i<s;){var l=e[i],d=null==r?l:r(l);if(l=n||0!==l?l:0,a&&d==d){for(var f=c;f--;)if(t[f]===d)continue e;u.push(l)}else o(t,d,n)||u.push(l)}return u}Fr.templateSettings={escape:X,evaluate:Z,interpolate:q,variable:"",imports:{_:Fr}},Fr.prototype=Gr.prototype,Fr.prototype.constructor=Fr,Hr.prototype=Vr(Gr.prototype),Hr.prototype.constructor=Hr,Kr.prototype=Vr(Gr.prototype),Kr.prototype.constructor=Kr,zr.prototype.clear=function(){this.__data__=Or?Or(null):{},this.size=0},zr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zr.prototype.get=function(e){var r=this.__data__;if(Or){var i=r[e];return i===n?t:i}return Me.call(r,e)?r[e]:t},zr.prototype.has=function(e){var r=this.__data__;return Or?r[e]!==t:Me.call(r,e)},zr.prototype.set=function(e,r){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Or&&r===t?n:r,this},Wr.prototype.clear=function(){this.__data__=[],this.size=0},Wr.prototype.delete=function(e){var t=this.__data__,r=nn(t,e);return!(r<0||(r==t.length-1?t.pop():ot.call(t,r,1),--this.size,0))},Wr.prototype.get=function(e){var r=this.__data__,n=nn(r,e);return n<0?t:r[n][1]},Wr.prototype.has=function(e){return nn(this.__data__,e)>-1},Wr.prototype.set=function(e,t){var r=this.__data__,n=nn(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Yr.prototype.clear=function(){this.size=0,this.__data__={hash:new zr,map:new(wr||Wr),string:new zr}},Yr.prototype.delete=function(e){var t=fo(this,e).delete(e);return this.size-=t?1:0,t},Yr.prototype.get=function(e){return fo(this,e).get(e)},Yr.prototype.has=function(e){return fo(this,e).has(e)},Yr.prototype.set=function(e,t){var r=fo(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Xr.prototype.add=Xr.prototype.push=function(e){return this.__data__.set(e,n),this},Xr.prototype.has=function(e){return this.__data__.has(e)},Zr.prototype.clear=function(){this.__data__=new Wr,this.size=0},Zr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Zr.prototype.get=function(e){return this.__data__.get(e)},Zr.prototype.has=function(e){return this.__data__.has(e)},Zr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Wr){var n=r.__data__;if(!wr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Yr(n)}return r.set(e,t),this.size=r.size,this};var pn=Li(En),gn=Li(Sn,!0);function yn(e,t){var r=!0;return pn(e,(function(e,n,i){return r=!!t(e,n,i)})),r}function vn(e,r,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=r(a);if(null!=s&&(u===t?s==s&&!ps(s):n(s,u)))var u=s,c=a}return c}function mn(e,t){var r=[];return pn(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function _n(e,t,r,n,i){var o=-1,a=e.length;for(r||(r=bo),i||(i=[]);++o<a;){var s=e[o];t>0&&r(s)?t>1?_n(s,t-1,r,n,i):Pt(i,s):n||(i[i.length]=s)}return i}var bn=Ni(),An=Ni(!0);function En(e,t){return e&&bn(e,t,Ms)}function Sn(e,t){return e&&An(e,t,Ms)}function Tn(e,t){return Ct(t,(function(t){return ns(e[t])}))}function $n(e,r){for(var n=0,i=(r=Ai(r,e)).length;null!=e&&n<i;)e=e[Go(r[n++])];return n&&n==i?e:t}function wn(e,t,r){var n=t(e);return Za(e)?n:Pt(n,r(e))}function Cn(r){return null==r?r===t?"[object Undefined]":"[object Null]":dt&&dt in Ie(r)?function(r){var n=Me.call(r,dt),i=r[dt];try{r[dt]=t;var o=!0}catch(e){}var a=je.call(r);return o&&(n?r[dt]=i:delete r[dt]),a}(r):function(e){return je.call(e)}(r)}function In(e,t){return e>t}function kn(e,t){return null!=e&&Me.call(e,t)}function On(e,t){return null!=e&&t in Ie(e)}function Pn(e,r,n){for(var i=n?kt:It,o=e[0].length,a=e.length,s=a,u=Se(a),c=1/0,l=[];s--;){var d=e[s];s&&r&&(d=Ot(d,Yt(r))),c=br(d.length,c),u[s]=!n&&(r||o>=120&&d.length>=120)?new Xr(s&&d):t}d=e[0];var f=-1,h=u[0];e:for(;++f<o&&l.length<c;){var p=d[f],g=r?r(p):p;if(p=n||0!==p?p:0,!(h?Zt(h,g):i(l,g,n))){for(s=a;--s;){var y=u[s];if(!(y?Zt(y,g):i(e[s],g,n)))continue e}h&&h.push(g),l.push(p)}}return l}function Rn(e,r,n){var i=null==(e=Oo(e,r=Ai(r,e)))?e:e[Go(ra(r))];return null==i?t:Et(i,e,n)}function xn(e){return ss(e)&&Cn(e)==g}function Dn(e,r,n,i,o){return e===r||(null==e||null==r||!ss(e)&&!ss(r)?e!=e&&r!=r:function(e,r,n,i,o,a){var s=Za(e),u=Za(r),c=s?y:vo(e),l=u?y:vo(r),d=(c=c==g?T:c)==T,f=(l=l==g?T:l)==T,h=c==l;if(h&&es(e)){if(!es(r))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new Zr),s||gs(e)?no(e,r,n,i,o,a):function(e,t,r,n,i,o,a){switch(r){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case P:return!(e.byteLength!=t.byteLength||!o(new ze(e),new ze(t)));case v:case m:case S:return za(+e,+t);case _:return e.name==t.name&&e.message==t.message;case w:case I:return e==t+"";case E:var s=ir;case C:var u=1&n;if(s||(s=sr),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var l=no(s(e),s(t),n,i,o,a);return a.delete(e),l;case k:if(Ur)return Ur.call(e)==Ur.call(t)}return!1}(e,r,c,n,i,o,a);if(!(1&n)){var p=d&&Me.call(e,"__wrapped__"),b=f&&Me.call(r,"__wrapped__");if(p||b){var A=p?e.value():e,$=b?r.value():r;return a||(a=new Zr),o(A,$,n,i,a)}}return!!h&&(a||(a=new Zr),function(e,r,n,i,o,a){var s=1&n,u=oo(e),c=u.length,l=oo(r).length;if(c!=l&&!s)return!1;for(var d=c;d--;){var f=u[d];if(!(s?f in r:Me.call(r,f)))return!1}var h=a.get(e),p=a.get(r);if(h&&p)return h==r&&p==e;var g=!0;a.set(e,r),a.set(r,e);for(var y=s;++d<c;){var v=e[f=u[d]],m=r[f];if(i)var _=s?i(m,v,f,r,e,a):i(v,m,f,e,r,a);if(!(_===t?v===m||o(v,m,n,i,a):_)){g=!1;break}y||(y="constructor"==f)}if(g&&!y){var b=e.constructor,A=r.constructor;b==A||!("constructor"in e)||!("constructor"in r)||"function"==typeof b&&b instanceof b&&"function"==typeof A&&A instanceof A||(g=!1)}return a.delete(e),a.delete(r),g}(e,r,n,i,o,a))}(e,r,n,i,Dn,o))}function Ln(e,r,n,i){var o=n.length,a=o,s=!i;if(null==e)return!a;for(e=Ie(e);o--;){var u=n[o];if(s&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){var c=(u=n[o])[0],l=e[c],d=u[1];if(s&&u[2]){if(l===t&&!(c in e))return!1}else{var f=new Zr;if(i)var h=i(l,d,c,e,r,f);if(!(h===t?Dn(d,l,3,i,f):h))return!1}}return!0}function Nn(e){return!(!as(e)||(t=e,Ue&&Ue in t))&&(ns(e)?Ge:ge).test(Ho(e));var t}function Mn(e){return"function"==typeof e?e:null==e?cu:"object"==_typeof$3(e)?Za(e)?Gn(e[0],e[1]):Vn(e):mu(e)}function Bn(e){if(!wo(e))return mr(e);var t=[];for(var r in Ie(e))Me.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Un(e){if(!as(e))return function(e){var t=[];if(null!=e)for(var r in Ie(e))t.push(r);return t}(e);var t=wo(e),r=[];for(var n in e)("constructor"!=n||!t&&Me.call(e,n))&&r.push(n);return r}function jn(e,t){return e<t}function Fn(e,t){var r=-1,n=Qa(e)?Se(e.length):[];return pn(e,(function(e,i,o){n[++r]=t(e,i,o)})),n}function Vn(e){var t=ho(e);return 1==t.length&&t[0][2]?Io(t[0][0],t[0][1]):function(r){return r===e||Ln(r,e,t)}}function Gn(e,r){return So(e)&&Co(r)?Io(Go(e),r):function(n){var i=Rs(n,e);return i===t&&i===r?xs(n,e):Dn(r,i,3)}}function Hn(e,r,n,i,o){e!==r&&bn(r,(function(a,s){if(o||(o=new Zr),as(a))!function(e,r,n,i,o,a,s){var u=Ro(e,n),c=Ro(r,n),l=s.get(c);if(l)tn(e,n,l);else{var d=a?a(u,c,n+"",e,r,s):t,f=d===t;if(f){var h=Za(c),p=!h&&es(c),g=!h&&!p&&gs(c);d=c,h||p||g?Za(u)?d=u:Ja(u)?d=Pi(u):p?(f=!1,d=$i(c,!0)):g?(f=!1,d=Ci(c,!0)):d=[]:ls(c)||Xa(c)?(d=u,Xa(u)?d=Ss(u):as(u)&&!ns(u)||(d=_o(c))):f=!1}f&&(s.set(c,d),o(d,c,i,a,s),s.delete(c)),tn(e,n,d)}}(e,r,s,n,Hn,i,o);else{var u=i?i(Ro(e,s),a,s+"",e,r,o):t;u===t&&(u=a),tn(e,s,u)}}),Bs)}function Kn(e,r){var n=e.length;if(n)return Ao(r+=r<0?n:0,n)?e[r]:t}function zn(e,t,r){t=t.length?Ot(t,(function(e){return Za(e)?function(t){return $n(t,1===e.length?e[0]:e)}:e})):[cu];var n=-1;return t=Ot(t,Yt(lo())),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(Fn(e,(function(e,r,i){return{criteria:Ot(t,(function(t){return t(e)})),index:++n,value:e}})),(function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var u=Ii(i[n],o[n]);if(u)return n>=s?u:u*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)}))}function Wn(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=$n(e,a);r(s,a)&&ti(o,Ai(a,e),s)}return o}function Yn(e,t,r,n){var i=n?Ut:Bt,o=-1,a=t.length,s=e;for(e===t&&(t=Pi(t)),r&&(s=Ot(e,Yt(r)));++o<a;)for(var u=0,c=t[o],l=r?r(c):c;(u=i(s,l,u,n))>-1;)s!==e&&ot.call(s,u,1),ot.call(e,u,1);return e}function Xn(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;Ao(i)?ot.call(e,i,1):hi(e,i)}}return e}function Zn(e,t){return e+hr(Sr()*(t-e+1))}function qn(e,t){var r="";if(!e||t<1||t>d)return r;do{t%2&&(r+=e),(t=hr(t/2))&&(e+=e)}while(t);return r}function Qn(e,t){return Lo(ko(e,t,cu),e+"")}function Jn(e){return Qr(zs(e))}function ei(e,t){var r=zs(e);return Bo(r,cn(t,0,r.length))}function ti(e,r,n,i){if(!as(e))return e;for(var o=-1,a=(r=Ai(r,e)).length,s=a-1,u=e;null!=u&&++o<a;){var c=Go(r[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=s){var d=u[c];(l=i?i(d,c,u):t)===t&&(l=as(d)?d:Ao(r[o+1])?[]:{})}rn(u,c,l),u=u[c]}return e}var ri=Pr?function(e,t){return Pr.set(e,t),e}:cu,ni=ft?function(e,t){return ft(e,"toString",{configurable:!0,enumerable:!1,value:au(t),writable:!0})}:cu;function ii(e){return Bo(zs(e))}function oi(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Se(i);++n<i;)o[n]=e[n+t];return o}function ai(e,t){var r;return pn(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r}function si(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;n<i;){var o=n+i>>>1,a=e[o];null!==a&&!ps(a)&&(r?a<=t:a<t)?n=o+1:i=o}return i}return ui(e,t,cu,r)}function ui(e,r,n,i){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(r=n(r))!=r,u=null===r,c=ps(r),l=r===t;o<a;){var d=hr((o+a)/2),f=n(e[d]),h=f!==t,p=null===f,g=f==f,y=ps(f);if(s)var v=i||g;else v=l?g&&(i||h):u?g&&h&&(i||!p):c?g&&h&&!p&&(i||!y):!p&&!y&&(i?f<=r:f<r);v?o=d+1:a=d}return br(a,4294967294)}function ci(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r],s=t?t(a):a;if(!r||!za(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function li(e){return"number"==typeof e?e:ps(e)?f:+e}function di(e){if("string"==typeof e)return e;if(Za(e))return Ot(e,di)+"";if(ps(e))return jr?jr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function fi(e,t,r){var n=-1,i=It,o=e.length,a=!0,s=[],u=s;if(r)a=!1,i=kt;else if(o>=200){var c=t?null:qi(e);if(c)return sr(c);a=!1,i=Zt,u=new Xr}else u=t?[]:s;e:for(;++n<o;){var l=e[n],d=t?t(l):l;if(l=r||0!==l?l:0,a&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue e;t&&u.push(d),s.push(l)}else i(u,d,r)||(u!==s&&u.push(d),s.push(l))}return s}function hi(e,t){return null==(e=Oo(e,t=Ai(t,e)))||delete e[Go(ra(t))]}function pi(e,t,r,n){return ti(e,t,r($n(e,t)),n)}function gi(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?oi(e,n?0:o,n?o+1:i):oi(e,n?o+1:0,n?i:o)}function yi(e,t){var r=e;return r instanceof Kr&&(r=r.value()),Rt(t,(function(e,t){return t.func.apply(t.thisArg,Pt([e],t.args))}),r)}function vi(e,t,r){var n=e.length;if(n<2)return n?fi(e[0]):[];for(var i=-1,o=Se(n);++i<n;)for(var a=e[i],s=-1;++s<n;)s!=i&&(o[i]=hn(o[i]||a,e[s],t,r));return fi(_n(o,1),t,r)}function mi(e,r,n){for(var i=-1,o=e.length,a=r.length,s={};++i<o;){var u=i<a?r[i]:t;n(s,e[i],u)}return s}function _i(e){return Ja(e)?e:[]}function bi(e){return"function"==typeof e?e:cu}function Ai(e,t){return Za(e)?e:So(e,t)?[e]:Vo(Ts(e))}var Ei=Qn;function Si(e,r,n){var i=e.length;return n=n===t?i:n,!r&&n>=i?e:oi(e,r,n)}var Ti=pt||function(e){return lt.clearTimeout(e)};function $i(e,t){if(t)return e.slice();var r=e.length,n=We?We(r):new e.constructor(r);return e.copy(n),n}function wi(e){var t=new e.constructor(e.byteLength);return new ze(t).set(new ze(e)),t}function Ci(e,t){var r=t?wi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Ii(e,r){if(e!==r){var n=e!==t,i=null===e,o=e==e,a=ps(e),s=r!==t,u=null===r,c=r==r,l=ps(r);if(!u&&!l&&!a&&e>r||a&&s&&c&&!u&&!l||i&&s&&c||!n&&c||!o)return 1;if(!i&&!a&&!l&&e<r||l&&n&&o&&!i&&!a||u&&n&&o||!s&&o||!c)return-1}return 0}function ki(e,t,r,n){for(var i=-1,o=e.length,a=r.length,s=-1,u=t.length,c=_r(o-a,0),l=Se(u+c),d=!n;++s<u;)l[s]=t[s];for(;++i<a;)(d||i<o)&&(l[r[i]]=e[i]);for(;c--;)l[s++]=e[i++];return l}function Oi(e,t,r,n){for(var i=-1,o=e.length,a=-1,s=r.length,u=-1,c=t.length,l=_r(o-s,0),d=Se(l+c),f=!n;++i<l;)d[i]=e[i];for(var h=i;++u<c;)d[h+u]=t[u];for(;++a<s;)(f||i<o)&&(d[h+r[a]]=e[i++]);return d}function Pi(e,t){var r=-1,n=e.length;for(t||(t=Se(n));++r<n;)t[r]=e[r];return t}function Ri(e,r,n,i){var o=!n;n||(n={});for(var a=-1,s=r.length;++a<s;){var u=r[a],c=i?i(n[u],e[u],u,n,e):t;c===t&&(c=e[u]),o?sn(n,u,c):rn(n,u,c)}return n}function xi(e,t){return function(r,n){var i=Za(r)?St:on,o=t?t():{};return i(r,e,lo(n,2),o)}}function Di(e){return Qn((function(r,n){var i=-1,o=n.length,a=o>1?n[o-1]:t,s=o>2?n[2]:t;for(a=e.length>3&&"function"==typeof a?(o--,a):t,s&&Eo(n[0],n[1],s)&&(a=o<3?t:a,o=1),r=Ie(r);++i<o;){var u=n[i];u&&e(r,u,i,a)}return r}))}function Li(e,t){return function(r,n){if(null==r)return r;if(!Qa(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Ie(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}}function Ni(e){return function(t,r,n){for(var i=-1,o=Ie(t),a=n(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===r(o[u],u,o))break}return t}}function Mi(e){return function(r){var n=nr(r=Ts(r))?cr(r):t,i=n?n[0]:r.charAt(0),o=n?Si(n,1).join(""):r.slice(1);return i[e]()+o}}function Bi(e){return function(t){return Rt(nu(Xs(t).replace(Xe,"")),e,"")}}function Ui(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Vr(e.prototype),n=e.apply(r,t);return as(n)?n:r}}function ji(e){return function(r,n,i){var o=Ie(r);if(!Qa(r)){var a=lo(n,3);r=Ms(r),n=function(e){return a(o[e],e,o)}}var s=e(r,n,i);return s>-1?o[a?r[s]:s]:t}}function Fi(e){return io((function(n){var i=n.length,o=i,a=Hr.prototype.thru;for(e&&n.reverse();o--;){var s=n[o];if("function"!=typeof s)throw new Pe(r);if(a&&!u&&"wrapper"==uo(s))var u=new Hr([],!0)}for(o=u?o:i;++o<i;){var c=uo(s=n[o]),l="wrapper"==c?so(s):t;u=l&&To(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[uo(l[0])].apply(u,l[3]):1==s.length&&To(s)?u[c]():u.thru(s)}return function(){var e=arguments,t=e[0];if(u&&1==e.length&&Za(t))return u.plant(t).value();for(var r=0,o=i?n[r].apply(this,e):t;++r<i;)o=n[r].call(this,o);return o}}))}function Vi(e,r,n,i,o,a,s,c,l,d){var f=r&u,h=1&r,p=2&r,g=24&r,y=512&r,v=p?t:Ui(e);return function t(){for(var u=arguments.length,m=Se(u),_=u;_--;)m[_]=arguments[_];if(g)var b=co(t),A=Jt(m,b);if(i&&(m=ki(m,i,o,g)),a&&(m=Oi(m,a,s,g)),u-=A,g&&u<d){var E=ar(m,b);return Xi(e,r,Vi,t.placeholder,n,m,E,c,l,d-u)}var S=h?n:this,T=p?S[e]:e;return u=m.length,c?m=Po(m,c):y&&u>1&&m.reverse(),f&&l<u&&(m.length=l),this&&this!==lt&&this instanceof t&&(T=v||Ui(T)),T.apply(S,m)}}function Gi(e,t){return function(r,n){return function(e,t,r,n){return En(e,(function(e,i,o){t(n,r(e),i,o)})),n}(r,e,t(n),{})}}function Hi(e,r){return function(n,i){var o;if(n===t&&i===t)return r;if(n!==t&&(o=n),i!==t){if(o===t)return i;"string"==typeof n||"string"==typeof i?(n=di(n),i=di(i)):(n=li(n),i=li(i)),o=e(n,i)}return o}}function Ki(e){return io((function(t){return t=Ot(t,Yt(lo())),Qn((function(r){var n=this;return e(t,(function(e){return Et(e,n,r)}))}))}))}function zi(e,r){var n=(r=r===t?" ":di(r)).length;if(n<2)return n?qn(r,e):r;var i=qn(r,Gt(e/ur(r)));return nr(r)?Si(cr(i),0,e).join(""):i.slice(0,e)}function Wi(e){return function(r,n,i){return i&&"number"!=typeof i&&Eo(r,n,i)&&(n=i=t),r=_s(r),n===t?(n=r,r=0):n=_s(n),function(e,t,r,n){for(var i=-1,o=_r(Gt((t-e)/(r||1)),0),a=Se(o);o--;)a[n?o:++i]=e,e+=r;return a}(r,n,i=i===t?r<n?1:-1:_s(i),e)}}function Yi(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=Es(t),r=Es(r)),e(t,r)}}function Xi(e,r,n,i,o,u,c,l,d,f){var h=8&r;r|=h?a:s,4&(r&=~(h?s:a))||(r&=-4);var p=[e,r,o,h?u:t,h?c:t,h?t:u,h?t:c,l,d,f],g=n.apply(t,p);return To(e)&&xo(g,p),g.placeholder=i,No(g,e,r)}function Zi(e){var t=Ce[e];return function(e,r){if(e=Es(e),(r=null==r?0:br(bs(r),292))&&yr(e)){var n=(Ts(e)+"e").split("e");return+((n=(Ts(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}var qi=Ir&&1/sr(new Ir([,-0]))[1]==l?function(e){return new Ir(e)}:pu;function Qi(e){return function(t){var r=vo(t);return r==E?ir(t):r==C?function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}(t):function(e,t){return Ot(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ji(e,n,l,d,f,h,p,g){var y=2&n;if(!y&&"function"!=typeof e)throw new Pe(r);var v=d?d.length:0;if(v||(n&=-97,d=f=t),p=p===t?p:_r(bs(p),0),g=g===t?g:bs(g),v-=f?f.length:0,n&s){var m=d,_=f;d=f=t}var b=y?t:so(e),A=[e,n,l,d,f,m,_,h,p,g];if(b&&function(e,t){var r=e[1],n=t[1],o=r|n,a=o<131,s=n==u&&8==r||n==u&&r==c&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!a&&!s)return e;1&n&&(e[2]=t[2],o|=1&r?0:4);var l=t[3];if(l){var d=e[3];e[3]=d?ki(d,l,t[4]):l,e[4]=d?ar(e[3],i):t[4]}(l=t[5])&&(d=e[5],e[5]=d?Oi(d,l,t[6]):l,e[6]=d?ar(e[5],i):t[6]),(l=t[7])&&(e[7]=l),n&u&&(e[8]=null==e[8]?t[8]:br(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(A,b),e=A[0],n=A[1],l=A[2],d=A[3],f=A[4],!(g=A[9]=A[9]===t?y?0:e.length:_r(A[9]-v,0))&&24&n&&(n&=-25),n&&1!=n)E=8==n||n==o?function(e,r,n){var i=Ui(e);return function o(){for(var a=arguments.length,s=Se(a),u=a,c=co(o);u--;)s[u]=arguments[u];var l=a<3&&s[0]!==c&&s[a-1]!==c?[]:ar(s,c);return(a-=l.length)<n?Xi(e,r,Vi,o.placeholder,t,s,l,t,t,n-a):Et(this&&this!==lt&&this instanceof o?i:e,this,s)}}(e,n,g):n!=a&&33!=n||f.length?Vi.apply(t,A):function(e,t,r,n){var i=1&t,o=Ui(e);return function t(){for(var a=-1,s=arguments.length,u=-1,c=n.length,l=Se(c+s),d=this&&this!==lt&&this instanceof t?o:e;++u<c;)l[u]=n[u];for(;s--;)l[u++]=arguments[++a];return Et(d,i?r:this,l)}}(e,n,l,d);else var E=function(e,t,r){var n=1&t,i=Ui(e);return function t(){return(this&&this!==lt&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,n,l);return No((b?ri:xo)(E,A),e,n)}function eo(e,r,n,i){return e===t||za(e,De[n])&&!Me.call(i,n)?r:e}function to(e,r,n,i,o,a){return as(e)&&as(r)&&(a.set(r,e),Hn(e,r,t,to,a),a.delete(r)),e}function ro(e){return ls(e)?t:e}function no(e,r,n,i,o,a){var s=1&n,u=e.length,c=r.length;if(u!=c&&!(s&&c>u))return!1;var l=a.get(e),d=a.get(r);if(l&&d)return l==r&&d==e;var f=-1,h=!0,p=2&n?new Xr:t;for(a.set(e,r),a.set(r,e);++f<u;){var g=e[f],y=r[f];if(i)var v=s?i(y,g,f,r,e,a):i(g,y,f,e,r,a);if(v!==t){if(v)continue;h=!1;break}if(p){if(!Dt(r,(function(e,t){if(!Zt(p,t)&&(g===e||o(g,e,n,i,a)))return p.push(t)}))){h=!1;break}}else if(g!==y&&!o(g,y,n,i,a)){h=!1;break}}return a.delete(e),a.delete(r),h}function io(e){return Lo(ko(e,t,qo),e+"")}function oo(e){return wn(e,Ms,go)}function ao(e){return wn(e,Bs,yo)}var so=Pr?function(e){return Pr.get(e)}:pu;function uo(e){for(var t=e.name+"",r=Rr[t],n=Me.call(Rr,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t}function co(e){return(Me.call(Fr,"placeholder")?Fr:e).placeholder}function lo(){var e=Fr.iteratee||lu;return e=e===lu?Mn:e,arguments.length?e(arguments[0],arguments[1]):e}function fo(e,t){var r,n,i=e.__data__;return("string"==(n=_typeof$3(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ho(e){for(var t=Ms(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Co(i)]}return t}function po(e,r){var n=function(e,r){return null==e?t:e[r]}(e,r);return Nn(n)?n:t}var go=pr?function(e){return null==e?[]:(e=Ie(e),Ct(pr(e),(function(t){return Je.call(e,t)})))}:Au,yo=pr?function(e){for(var t=[];e;)Pt(t,go(e)),e=Ye(e);return t}:Au,vo=Cn;function mo(e,t,r){for(var n=-1,i=(t=Ai(t,e)).length,o=!1;++n<i;){var a=Go(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&os(i)&&Ao(a,i)&&(Za(e)||Xa(e))}function _o(e){return"function"!=typeof e.constructor||wo(e)?{}:Vr(Ye(e))}function bo(e){return Za(e)||Xa(e)||!!(ut&&e&&e[ut])}function Ao(e,t){var r=_typeof$3(e);return!!(t=null==t?d:t)&&("number"==r||"symbol"!=r&&ve.test(e))&&e>-1&&e%1==0&&e<t}function Eo(e,t,r){if(!as(r))return!1;var n=_typeof$3(t);return!!("number"==n?Qa(r)&&Ao(t,r.length):"string"==n&&t in r)&&za(r[t],e)}function So(e,t){if(Za(e))return!1;var r=_typeof$3(e);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ps(e))||J.test(e)||!Q.test(e)||null!=t&&e in Ie(t)}function To(e){var t=uo(e),r=Fr[t];if("function"!=typeof r||!(t in Kr.prototype))return!1;if(e===r)return!0;var n=so(r);return!!n&&e===n[0]}($r&&vo(new $r(new ArrayBuffer(1)))!=R||wr&&vo(new wr)!=E||Cr&&vo(Cr.resolve())!=$||Ir&&vo(new Ir)!=C||kr&&vo(new kr)!=O)&&(vo=function(e){var r=Cn(e),n=r==T?e.constructor:t,i=n?Ho(n):"";if(i)switch(i){case xr:return R;case Dr:return E;case Lr:return $;case Nr:return C;case Mr:return O}return r});var $o=Le?ns:Eu;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||De)}function Co(e){return e==e&&!as(e)}function Io(e,r){return function(n){return null!=n&&n[e]===r&&(r!==t||e in Ie(n))}}function ko(e,r,n){return r=_r(r===t?e.length-1:r,0),function(){for(var t=arguments,i=-1,o=_r(t.length-r,0),a=Se(o);++i<o;)a[i]=t[r+i];i=-1;for(var s=Se(r+1);++i<r;)s[i]=t[i];return s[r]=n(a),Et(e,this,s)}}function Oo(e,t){return t.length<2?e:$n(e,oi(t,0,-1))}function Po(e,r){for(var n=e.length,i=br(r.length,n),o=Pi(e);i--;){var a=r[i];e[i]=Ao(a,n)?o[a]:t}return e}function Ro(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var xo=Mo(ri),Do=Lt||function(e,t){return lt.setTimeout(e,t)},Lo=Mo(ni);function No(e,t,r){var n=t+"";return Lo(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return Tt(p,(function(r){var n="_."+r[0];t&r[1]&&!It(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(se):[]}(n),r)))}function Mo(e){var r=0,n=0;return function(){var i=Ar(),o=16-(i-n);if(n=i,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(t,arguments)}}function Bo(e,r){var n=-1,i=e.length,o=i-1;for(r=r===t?i:r;++n<r;){var a=Zn(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=r,e}var Uo,jo,Fo,Vo=(Uo=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,r,n,i){t.push(n?i.replace(le,"$1"):r||e)})),t},jo=ja(Uo,(function(e){return 500===Fo.size&&Fo.clear(),e})),Fo=jo.cache,jo);function Go(e){if("string"==typeof e||ps(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ho(t){if(null!=t){try{return Ne.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Ko(e){if(e instanceof Kr)return e.clone();var t=new Hr(e.__wrapped__,e.__chain__);return t.__actions__=Pi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var zo=Qn((function(e,t){return Ja(e)?hn(e,_n(t,1,Ja,!0)):[]})),Wo=Qn((function(e,r){var n=ra(r);return Ja(n)&&(n=t),Ja(e)?hn(e,_n(r,1,Ja,!0),lo(n,2)):[]})),Yo=Qn((function(e,r){var n=ra(r);return Ja(n)&&(n=t),Ja(e)?hn(e,_n(r,1,Ja,!0),t,n):[]}));function Xo(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:bs(r);return i<0&&(i=_r(n+i,0)),Mt(e,lo(t,3),i)}function Zo(e,r,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return n!==t&&(o=bs(n),o=n<0?_r(i+o,0):br(o,i-1)),Mt(e,lo(r,3),o,!0)}function qo(e){return null!=e&&e.length?_n(e,1):[]}function Qo(e){return e&&e.length?e[0]:t}var Jo=Qn((function(e){var t=Ot(e,_i);return t.length&&t[0]===e[0]?Pn(t):[]})),ea=Qn((function(e){var r=ra(e),n=Ot(e,_i);return r===ra(n)?r=t:n.pop(),n.length&&n[0]===e[0]?Pn(n,lo(r,2)):[]})),ta=Qn((function(e){var r=ra(e),n=Ot(e,_i);return(r="function"==typeof r?r:t)&&n.pop(),n.length&&n[0]===e[0]?Pn(n,t,r):[]}));function ra(e){var r=null==e?0:e.length;return r?e[r-1]:t}var na=Qn(ia);function ia(e,t){return e&&e.length&&t&&t.length?Yn(e,t):e}var oa=io((function(e,t){var r=null==e?0:e.length,n=un(e,t);return Xn(e,Ot(t,(function(e){return Ao(e,r)?+e:e})).sort(Ii)),n}));function aa(e){return null==e?e:Tr.call(e)}var sa=Qn((function(e){return fi(_n(e,1,Ja,!0))})),ua=Qn((function(e){var r=ra(e);return Ja(r)&&(r=t),fi(_n(e,1,Ja,!0),lo(r,2))})),ca=Qn((function(e){var r=ra(e);return r="function"==typeof r?r:t,fi(_n(e,1,Ja,!0),t,r)}));function la(e){if(!e||!e.length)return[];var t=0;return e=Ct(e,(function(e){if(Ja(e))return t=_r(e.length,t),!0})),zt(t,(function(t){return Ot(e,Vt(t))}))}function da(e,r){if(!e||!e.length)return[];var n=la(e);return null==r?n:Ot(n,(function(e){return Et(r,t,e)}))}var fa=Qn((function(e,t){return Ja(e)?hn(e,t):[]})),ha=Qn((function(e){return vi(Ct(e,Ja))})),pa=Qn((function(e){var r=ra(e);return Ja(r)&&(r=t),vi(Ct(e,Ja),lo(r,2))})),ga=Qn((function(e){var r=ra(e);return r="function"==typeof r?r:t,vi(Ct(e,Ja),t,r)})),ya=Qn(la),va=Qn((function(e){var r=e.length,n=r>1?e[r-1]:t;return n="function"==typeof n?(e.pop(),n):t,da(e,n)}));function ma(e){var t=Fr(e);return t.__chain__=!0,t}function _a(e,t){return t(e)}var ba=io((function(e){var r=e.length,n=r?e[0]:0,i=this.__wrapped__,o=function(t){return un(t,e)};return!(r>1||this.__actions__.length)&&i instanceof Kr&&Ao(n)?((i=i.slice(n,+n+(r?1:0))).__actions__.push({func:_a,args:[o],thisArg:t}),new Hr(i,this.__chain__).thru((function(e){return r&&!e.length&&e.push(t),e}))):this.thru(o)})),Aa=xi((function(e,t,r){Me.call(e,r)?++e[r]:sn(e,r,1)})),Ea=ji(Xo),Sa=ji(Zo);function Ta(e,t){return(Za(e)?Tt:pn)(e,lo(t,3))}function $a(e,t){return(Za(e)?$t:gn)(e,lo(t,3))}var wa=xi((function(e,t,r){Me.call(e,r)?e[r].push(t):sn(e,r,[t])})),Ca=Qn((function(e,t,r){var n=-1,i="function"==typeof t,o=Qa(e)?Se(e.length):[];return pn(e,(function(e){o[++n]=i?Et(t,e,r):Rn(e,t,r)})),o})),Ia=xi((function(e,t,r){sn(e,r,t)}));function ka(e,t){return(Za(e)?Ot:Fn)(e,lo(t,3))}var Oa=xi((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]})),Pa=Qn((function(e,t){if(null==e)return[];var r=t.length;return r>1&&Eo(e,t[0],t[1])?t=[]:r>2&&Eo(t[0],t[1],t[2])&&(t=[t[0]]),zn(e,_n(t,1),[])})),Ra=gt||function(){return lt.Date.now()};function xa(e,r,n){return r=n?t:r,r=e&&null==r?e.length:r,Ji(e,u,t,t,t,t,r)}function Da(e,n){var i;if("function"!=typeof n)throw new Pe(r);return e=bs(e),function(){return--e>0&&(i=n.apply(this,arguments)),e<=1&&(n=t),i}}var La=Qn((function(e,t,r){var n=1;if(r.length){var i=ar(r,co(La));n|=a}return Ji(e,n,t,r,i)})),Na=Qn((function(e,t,r){var n=3;if(r.length){var i=ar(r,co(Na));n|=a}return Ji(t,n,e,r,i)}));function Ma(e,n,i){var o,a,s,u,c,l,d=0,f=!1,h=!1,p=!0;if("function"!=typeof e)throw new Pe(r);function g(r){var n=o,i=a;return o=a=t,d=r,u=e.apply(i,n)}function y(e){return d=e,c=Do(m,n),f?g(e):u}function v(e){var r=e-l;return l===t||r>=n||r<0||h&&e-d>=s}function m(){var e=Ra();if(v(e))return _(e);c=Do(m,function(e){var t=n-(e-l);return h?br(t,s-(e-d)):t}(e))}function _(e){return c=t,p&&o?g(e):(o=a=t,u)}function b(){var e=Ra(),r=v(e);if(o=arguments,a=this,l=e,r){if(c===t)return y(l);if(h)return Ti(c),c=Do(m,n),g(l)}return c===t&&(c=Do(m,n)),u}return n=Es(n)||0,as(i)&&(f=!!i.leading,s=(h="maxWait"in i)?_r(Es(i.maxWait)||0,n):s,p="trailing"in i?!!i.trailing:p),b.cancel=function(){c!==t&&Ti(c),d=0,o=l=a=c=t},b.flush=function(){return c===t?u:_(Ra())},b}var Ba=Qn((function(e,t){return fn(e,1,t)})),Ua=Qn((function(e,t,r){return fn(e,Es(t)||0,r)}));function ja(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Pe(r);var n=function r(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return n.cache=new(ja.Cache||Yr),n}function Fa(e){if("function"!=typeof e)throw new Pe(r);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ja.Cache=Yr;var Va=Ei((function(e,t){var r=(t=1==t.length&&Za(t[0])?Ot(t[0],Yt(lo())):Ot(_n(t,1),Yt(lo()))).length;return Qn((function(n){for(var i=-1,o=br(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return Et(e,this,n)}))})),Ga=Qn((function(e,r){var n=ar(r,co(Ga));return Ji(e,a,t,r,n)})),Ha=Qn((function(e,r){var n=ar(r,co(Ha));return Ji(e,s,t,r,n)})),Ka=io((function(e,r){return Ji(e,c,t,t,t,r)}));function za(e,t){return e===t||e!=e&&t!=t}var Wa=Yi(In),Ya=Yi((function(e,t){return e>=t})),Xa=xn(function(){return arguments}())?xn:function(e){return ss(e)&&Me.call(e,"callee")&&!Je.call(e,"callee")},Za=Se.isArray,qa=yt?Yt(yt):function(e){return ss(e)&&Cn(e)==P};function Qa(e){return null!=e&&os(e.length)&&!ns(e)}function Ja(e){return ss(e)&&Qa(e)}var es=gr||Eu,ts=vt?Yt(vt):function(e){return ss(e)&&Cn(e)==m};function rs(e){if(!ss(e))return!1;var t=Cn(e);return t==_||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ls(e)}function ns(e){if(!as(e))return!1;var t=Cn(e);return t==b||t==A||"[object AsyncFunction]"==t||"[object Proxy]"==t}function is(e){return"number"==typeof e&&e==bs(e)}function os(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function as(e){var t=_typeof$3(e);return null!=e&&("object"==t||"function"==t)}function ss(e){return null!=e&&"object"==_typeof$3(e)}var us=mt?Yt(mt):function(e){return ss(e)&&vo(e)==E};function cs(e){return"number"==typeof e||ss(e)&&Cn(e)==S}function ls(e){if(!ss(e)||Cn(e)!=T)return!1;var t=Ye(e);if(null===t)return!0;var r=Me.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ne.call(r)==Fe}var ds=_t?Yt(_t):function(e){return ss(e)&&Cn(e)==w},fs=bt?Yt(bt):function(e){return ss(e)&&vo(e)==C};function hs(e){return"string"==typeof e||!Za(e)&&ss(e)&&Cn(e)==I}function ps(e){return"symbol"==_typeof$3(e)||ss(e)&&Cn(e)==k}var gs=At?Yt(At):function(e){return ss(e)&&os(e.length)&&!!nt[Cn(e)]},ys=Yi(jn),vs=Yi((function(e,t){return e<=t}));function ms(e){if(!e)return[];if(Qa(e))return hs(e)?cr(e):Pi(e);if(ct&&e[ct])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[ct]());var t=vo(e);return(t==E?ir:t==C?sr:zs)(e)}function _s(e){return e?(e=Es(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function bs(e){var t=_s(e),r=t%1;return t==t?r?t-r:t:0}function As(e){return e?cn(bs(e),0,h):0}function Es(e){if("number"==typeof e)return e;if(ps(e))return f;if(as(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=as(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Wt(e);var r=pe.test(e);return r||ye.test(e)?st(e.slice(2),r?2:8):he.test(e)?f:+e}function Ss(e){return Ri(e,Bs(e))}function Ts(e){return null==e?"":di(e)}var $s=Di((function(e,t){if(wo(t)||Qa(t))Ri(t,Ms(t),e);else for(var r in t)Me.call(t,r)&&rn(e,r,t[r])})),ws=Di((function(e,t){Ri(t,Bs(t),e)})),Cs=Di((function(e,t,r,n){Ri(t,Bs(t),e,n)})),Is=Di((function(e,t,r,n){Ri(t,Ms(t),e,n)})),ks=io(un),Os=Qn((function(e,r){e=Ie(e);var n=-1,i=r.length,o=i>2?r[2]:t;for(o&&Eo(r[0],r[1],o)&&(i=1);++n<i;)for(var a=r[n],s=Bs(a),u=-1,c=s.length;++u<c;){var l=s[u],d=e[l];(d===t||za(d,De[l])&&!Me.call(e,l))&&(e[l]=a[l])}return e})),Ps=Qn((function(e){return e.push(t,to),Et(js,t,e)}));function Rs(e,r,n){var i=null==e?t:$n(e,r);return i===t?n:i}function xs(e,t){return null!=e&&mo(e,t,On)}var Ds=Gi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),e[t]=r}),au(cu)),Ls=Gi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),Me.call(e,t)?e[t].push(r):e[t]=[r]}),lo),Ns=Qn(Rn);function Ms(e){return Qa(e)?qr(e):Bn(e)}function Bs(e){return Qa(e)?qr(e,!0):Un(e)}var Us=Di((function(e,t,r){Hn(e,t,r)})),js=Di((function(e,t,r,n){Hn(e,t,r,n)})),Fs=io((function(e,t){var r={};if(null==e)return r;var n=!1;t=Ot(t,(function(t){return t=Ai(t,e),n||(n=t.length>1),t})),Ri(e,ao(e),r),n&&(r=ln(r,7,ro));for(var i=t.length;i--;)hi(r,t[i]);return r})),Vs=io((function(e,t){return null==e?{}:function(e,t){return Wn(e,t,(function(t,r){return xs(e,r)}))}(e,t)}));function Gs(e,t){if(null==e)return{};var r=Ot(ao(e),(function(e){return[e]}));return t=lo(t),Wn(e,r,(function(e,r){return t(e,r[0])}))}var Hs=Qi(Ms),Ks=Qi(Bs);function zs(e){return null==e?[]:Xt(e,Ms(e))}var Ws=Bi((function(e,t,r){return t=t.toLowerCase(),e+(r?Ys(t):t)}));function Ys(e){return ru(Ts(e).toLowerCase())}function Xs(e){return(e=Ts(e))&&e.replace(me,er).replace(Ze,"")}var Zs=Bi((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()})),qs=Bi((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()})),Qs=Mi("toLowerCase"),Js=Bi((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()})),eu=Bi((function(e,t,r){return e+(r?" ":"")+ru(t)})),tu=Bi((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()})),ru=Mi("toUpperCase");function nu(e,r,n){return e=Ts(e),(r=n?t:r)===t?function(e){return et.test(e)}(e)?function(e){return e.match(Qe)||[]}(e):function(e){return e.match(ue)||[]}(e):e.match(r)||[]}var iu=Qn((function(r,n){try{return Et(r,t,n)}catch(e){return rs(e)?e:new $e(e)}})),ou=io((function(e,t){return Tt(t,(function(t){t=Go(t),sn(e,t,La(e[t],e))})),e}));function au(e){return function(){return e}}var su=Fi(),uu=Fi(!0);function cu(e){return e}function lu(e){return Mn("function"==typeof e?e:ln(e,1))}var du=Qn((function(e,t){return function(r){return Rn(r,e,t)}})),fu=Qn((function(e,t){return function(r){return Rn(e,r,t)}}));function hu(e,t,r){var n=Ms(t),i=Tn(t,n);null!=r||as(t)&&(i.length||!n.length)||(r=t,t=e,e=this,i=Tn(t,Ms(t)));var o=!(as(r)&&"chain"in r&&!r.chain),a=ns(e);return Tt(i,(function(r){var n=t[r];e[r]=n,a&&(e.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=e(this.__wrapped__),i=r.__actions__=Pi(this.__actions__);return i.push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,Pt([this.value()],arguments))})})),e}function pu(){}var gu=Ki(Ot),yu=Ki(wt),vu=Ki(Dt);function mu(e){return So(e)?Vt(Go(e)):function(e){return function(t){return $n(t,e)}}(e)}var _u=Wi(),bu=Wi(!0);function Au(){return[]}function Eu(){return!1}var Su,Tu=Hi((function(e,t){return e+t}),0),$u=Zi("ceil"),wu=Hi((function(e,t){return e/t}),1),Cu=Zi("floor"),Iu=Hi((function(e,t){return e*t}),1),ku=Zi("round"),Ou=Hi((function(e,t){return e-t}),0);return Fr.after=function(e,t){if("function"!=typeof t)throw new Pe(r);return e=bs(e),function(){if(--e<1)return t.apply(this,arguments)}},Fr.ary=xa,Fr.assign=$s,Fr.assignIn=ws,Fr.assignInWith=Cs,Fr.assignWith=Is,Fr.at=ks,Fr.before=Da,Fr.bind=La,Fr.bindAll=ou,Fr.bindKey=Na,Fr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Za(e)?e:[e]},Fr.chain=ma,Fr.chunk=function(e,r,n){r=(n?Eo(e,r,n):r===t)?1:_r(bs(r),0);var i=null==e?0:e.length;if(!i||r<1)return[];for(var o=0,a=0,s=Se(Gt(i/r));o<i;)s[a++]=oi(e,o,o+=r);return s},Fr.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},Fr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Se(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return Pt(Za(r)?Pi(r):[r],_n(t,1))},Fr.cond=function(e){var t=null==e?0:e.length,n=lo();return e=t?Ot(e,(function(e){if("function"!=typeof e[1])throw new Pe(r);return[n(e[0]),e[1]]})):[],Qn((function(r){for(var n=-1;++n<t;){var i=e[n];if(Et(i[0],this,r))return Et(i[1],this,r)}}))},Fr.conforms=function(e){return function(e){var t=Ms(e);return function(r){return dn(r,e,t)}}(ln(e,1))},Fr.constant=au,Fr.countBy=Aa,Fr.create=function(e,t){var r=Vr(e);return null==t?r:an(r,t)},Fr.curry=function e(r,n,i){var o=Ji(r,8,t,t,t,t,t,n=i?t:n);return o.placeholder=e.placeholder,o},Fr.curryRight=function e(r,n,i){var a=Ji(r,o,t,t,t,t,t,n=i?t:n);return a.placeholder=e.placeholder,a},Fr.debounce=Ma,Fr.defaults=Os,Fr.defaultsDeep=Ps,Fr.defer=Ba,Fr.delay=Ua,Fr.difference=zo,Fr.differenceBy=Wo,Fr.differenceWith=Yo,Fr.drop=function(e,r,n){var i=null==e?0:e.length;return i?oi(e,(r=n||r===t?1:bs(r))<0?0:r,i):[]},Fr.dropRight=function(e,r,n){var i=null==e?0:e.length;return i?oi(e,0,(r=i-(r=n||r===t?1:bs(r)))<0?0:r):[]},Fr.dropRightWhile=function(e,t){return e&&e.length?gi(e,lo(t,3),!0,!0):[]},Fr.dropWhile=function(e,t){return e&&e.length?gi(e,lo(t,3),!0):[]},Fr.fill=function(e,r,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Eo(e,r,n)&&(n=0,i=o),function(e,r,n,i){var o=e.length;for((n=bs(n))<0&&(n=-n>o?0:o+n),(i=i===t||i>o?o:bs(i))<0&&(i+=o),i=n>i?0:As(i);n<i;)e[n++]=r;return e}(e,r,n,i)):[]},Fr.filter=function(e,t){return(Za(e)?Ct:mn)(e,lo(t,3))},Fr.flatMap=function(e,t){return _n(ka(e,t),1)},Fr.flatMapDeep=function(e,t){return _n(ka(e,t),l)},Fr.flatMapDepth=function(e,r,n){return n=n===t?1:bs(n),_n(ka(e,r),n)},Fr.flatten=qo,Fr.flattenDeep=function(e){return null!=e&&e.length?_n(e,l):[]},Fr.flattenDepth=function(e,r){return null!=e&&e.length?_n(e,r=r===t?1:bs(r)):[]},Fr.flip=function(e){return Ji(e,512)},Fr.flow=su,Fr.flowRight=uu,Fr.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},Fr.functions=function(e){return null==e?[]:Tn(e,Ms(e))},Fr.functionsIn=function(e){return null==e?[]:Tn(e,Bs(e))},Fr.groupBy=wa,Fr.initial=function(e){return null!=e&&e.length?oi(e,0,-1):[]},Fr.intersection=Jo,Fr.intersectionBy=ea,Fr.intersectionWith=ta,Fr.invert=Ds,Fr.invertBy=Ls,Fr.invokeMap=Ca,Fr.iteratee=lu,Fr.keyBy=Ia,Fr.keys=Ms,Fr.keysIn=Bs,Fr.map=ka,Fr.mapKeys=function(e,t){var r={};return t=lo(t,3),En(e,(function(e,n,i){sn(r,t(e,n,i),e)})),r},Fr.mapValues=function(e,t){var r={};return t=lo(t,3),En(e,(function(e,n,i){sn(r,n,t(e,n,i))})),r},Fr.matches=function(e){return Vn(ln(e,1))},Fr.matchesProperty=function(e,t){return Gn(e,ln(t,1))},Fr.memoize=ja,Fr.merge=Us,Fr.mergeWith=js,Fr.method=du,Fr.methodOf=fu,Fr.mixin=hu,Fr.negate=Fa,Fr.nthArg=function(e){return e=bs(e),Qn((function(t){return Kn(t,e)}))},Fr.omit=Fs,Fr.omitBy=function(e,t){return Gs(e,Fa(lo(t)))},Fr.once=function(e){return Da(2,e)},Fr.orderBy=function(e,r,n,i){return null==e?[]:(Za(r)||(r=null==r?[]:[r]),Za(n=i?t:n)||(n=null==n?[]:[n]),zn(e,r,n))},Fr.over=gu,Fr.overArgs=Va,Fr.overEvery=yu,Fr.overSome=vu,Fr.partial=Ga,Fr.partialRight=Ha,Fr.partition=Oa,Fr.pick=Vs,Fr.pickBy=Gs,Fr.property=mu,Fr.propertyOf=function(e){return function(r){return null==e?t:$n(e,r)}},Fr.pull=na,Fr.pullAll=ia,Fr.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Yn(e,t,lo(r,2)):e},Fr.pullAllWith=function(e,r,n){return e&&e.length&&r&&r.length?Yn(e,r,t,n):e},Fr.pullAt=oa,Fr.range=_u,Fr.rangeRight=bu,Fr.rearg=Ka,Fr.reject=function(e,t){return(Za(e)?Ct:mn)(e,Fa(lo(t,3)))},Fr.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=lo(t,3);++n<o;){var a=e[n];t(a,n,e)&&(r.push(a),i.push(n))}return Xn(e,i),r},Fr.rest=function(e,n){if("function"!=typeof e)throw new Pe(r);return Qn(e,n=n===t?n:bs(n))},Fr.reverse=aa,Fr.sampleSize=function(e,r,n){return r=(n?Eo(e,r,n):r===t)?1:bs(r),(Za(e)?Jr:ei)(e,r)},Fr.set=function(e,t,r){return null==e?e:ti(e,t,r)},Fr.setWith=function(e,r,n,i){return i="function"==typeof i?i:t,null==e?e:ti(e,r,n,i)},Fr.shuffle=function(e){return(Za(e)?en:ii)(e)},Fr.slice=function(e,r,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Eo(e,r,n)?(r=0,n=i):(r=null==r?0:bs(r),n=n===t?i:bs(n)),oi(e,r,n)):[]},Fr.sortBy=Pa,Fr.sortedUniq=function(e){return e&&e.length?ci(e):[]},Fr.sortedUniqBy=function(e,t){return e&&e.length?ci(e,lo(t,2)):[]},Fr.split=function(e,r,n){return n&&"number"!=typeof n&&Eo(e,r,n)&&(r=n=t),(n=n===t?h:n>>>0)?(e=Ts(e))&&("string"==typeof r||null!=r&&!ds(r))&&!(r=di(r))&&nr(e)?Si(cr(e),0,n):e.split(r,n):[]},Fr.spread=function(e,t){if("function"!=typeof e)throw new Pe(r);return t=null==t?0:_r(bs(t),0),Qn((function(r){var n=r[t],i=Si(r,0,t);return n&&Pt(i,n),Et(e,this,i)}))},Fr.tail=function(e){var t=null==e?0:e.length;return t?oi(e,1,t):[]},Fr.take=function(e,r,n){return e&&e.length?oi(e,0,(r=n||r===t?1:bs(r))<0?0:r):[]},Fr.takeRight=function(e,r,n){var i=null==e?0:e.length;return i?oi(e,(r=i-(r=n||r===t?1:bs(r)))<0?0:r,i):[]},Fr.takeRightWhile=function(e,t){return e&&e.length?gi(e,lo(t,3),!1,!0):[]},Fr.takeWhile=function(e,t){return e&&e.length?gi(e,lo(t,3)):[]},Fr.tap=function(e,t){return t(e),e},Fr.throttle=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new Pe(r);return as(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Ma(e,t,{leading:i,maxWait:t,trailing:o})},Fr.thru=_a,Fr.toArray=ms,Fr.toPairs=Hs,Fr.toPairsIn=Ks,Fr.toPath=function(e){return Za(e)?Ot(e,Go):ps(e)?[e]:Pi(Vo(Ts(e)))},Fr.toPlainObject=Ss,Fr.transform=function(e,t,r){var n=Za(e),i=n||es(e)||gs(e);if(t=lo(t,4),null==r){var o=e&&e.constructor;r=i?n?new o:[]:as(e)&&ns(o)?Vr(Ye(e)):{}}return(i?Tt:En)(e,(function(e,n,i){return t(r,e,n,i)})),r},Fr.unary=function(e){return xa(e,1)},Fr.union=sa,Fr.unionBy=ua,Fr.unionWith=ca,Fr.uniq=function(e){return e&&e.length?fi(e):[]},Fr.uniqBy=function(e,t){return e&&e.length?fi(e,lo(t,2)):[]},Fr.uniqWith=function(e,r){return r="function"==typeof r?r:t,e&&e.length?fi(e,t,r):[]},Fr.unset=function(e,t){return null==e||hi(e,t)},Fr.unzip=la,Fr.unzipWith=da,Fr.update=function(e,t,r){return null==e?e:pi(e,t,bi(r))},Fr.updateWith=function(e,r,n,i){return i="function"==typeof i?i:t,null==e?e:pi(e,r,bi(n),i)},Fr.values=zs,Fr.valuesIn=function(e){return null==e?[]:Xt(e,Bs(e))},Fr.without=fa,Fr.words=nu,Fr.wrap=function(e,t){return Ga(bi(t),e)},Fr.xor=ha,Fr.xorBy=pa,Fr.xorWith=ga,Fr.zip=ya,Fr.zipObject=function(e,t){return mi(e||[],t||[],rn)},Fr.zipObjectDeep=function(e,t){return mi(e||[],t||[],ti)},Fr.zipWith=va,Fr.entries=Hs,Fr.entriesIn=Ks,Fr.extend=ws,Fr.extendWith=Cs,hu(Fr,Fr),Fr.add=Tu,Fr.attempt=iu,Fr.camelCase=Ws,Fr.capitalize=Ys,Fr.ceil=$u,Fr.clamp=function(e,r,n){return n===t&&(n=r,r=t),n!==t&&(n=(n=Es(n))==n?n:0),r!==t&&(r=(r=Es(r))==r?r:0),cn(Es(e),r,n)},Fr.clone=function(e){return ln(e,4)},Fr.cloneDeep=function(e){return ln(e,5)},Fr.cloneDeepWith=function(e,r){return ln(e,5,r="function"==typeof r?r:t)},Fr.cloneWith=function(e,r){return ln(e,4,r="function"==typeof r?r:t)},Fr.conformsTo=function(e,t){return null==t||dn(e,t,Ms(t))},Fr.deburr=Xs,Fr.defaultTo=function(e,t){return null==e||e!=e?t:e},Fr.divide=wu,Fr.endsWith=function(e,r,n){e=Ts(e),r=di(r);var i=e.length,o=n=n===t?i:cn(bs(n),0,i);return(n-=r.length)>=0&&e.slice(n,o)==r},Fr.eq=za,Fr.escape=function(e){return(e=Ts(e))&&Y.test(e)?e.replace(z,tr):e},Fr.escapeRegExp=function(e){return(e=Ts(e))&&re.test(e)?e.replace(te,"\\$&"):e},Fr.every=function(e,r,n){var i=Za(e)?wt:yn;return n&&Eo(e,r,n)&&(r=t),i(e,lo(r,3))},Fr.find=Ea,Fr.findIndex=Xo,Fr.findKey=function(e,t){return Nt(e,lo(t,3),En)},Fr.findLast=Sa,Fr.findLastIndex=Zo,Fr.findLastKey=function(e,t){return Nt(e,lo(t,3),Sn)},Fr.floor=Cu,Fr.forEach=Ta,Fr.forEachRight=$a,Fr.forIn=function(e,t){return null==e?e:bn(e,lo(t,3),Bs)},Fr.forInRight=function(e,t){return null==e?e:An(e,lo(t,3),Bs)},Fr.forOwn=function(e,t){return e&&En(e,lo(t,3))},Fr.forOwnRight=function(e,t){return e&&Sn(e,lo(t,3))},Fr.get=Rs,Fr.gt=Wa,Fr.gte=Ya,Fr.has=function(e,t){return null!=e&&mo(e,t,kn)},Fr.hasIn=xs,Fr.head=Qo,Fr.identity=cu,Fr.includes=function(e,t,r,n){e=Qa(e)?e:zs(e),r=r&&!n?bs(r):0;var i=e.length;return r<0&&(r=_r(i+r,0)),hs(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Bt(e,t,r)>-1},Fr.indexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:bs(r);return i<0&&(i=_r(n+i,0)),Bt(e,t,i)},Fr.inRange=function(e,r,n){return r=_s(r),n===t?(n=r,r=0):n=_s(n),function(e,t,r){return e>=br(t,r)&&e<_r(t,r)}(e=Es(e),r,n)},Fr.invoke=Ns,Fr.isArguments=Xa,Fr.isArray=Za,Fr.isArrayBuffer=qa,Fr.isArrayLike=Qa,Fr.isArrayLikeObject=Ja,Fr.isBoolean=function(e){return!0===e||!1===e||ss(e)&&Cn(e)==v},Fr.isBuffer=es,Fr.isDate=ts,Fr.isElement=function(e){return ss(e)&&1===e.nodeType&&!ls(e)},Fr.isEmpty=function(e){if(null==e)return!0;if(Qa(e)&&(Za(e)||"string"==typeof e||"function"==typeof e.splice||es(e)||gs(e)||Xa(e)))return!e.length;var t=vo(e);if(t==E||t==C)return!e.size;if(wo(e))return!Bn(e).length;for(var r in e)if(Me.call(e,r))return!1;return!0},Fr.isEqual=function(e,t){return Dn(e,t)},Fr.isEqualWith=function(e,r,n){var i=(n="function"==typeof n?n:t)?n(e,r):t;return i===t?Dn(e,r,t,n):!!i},Fr.isError=rs,Fr.isFinite=function(e){return"number"==typeof e&&yr(e)},Fr.isFunction=ns,Fr.isInteger=is,Fr.isLength=os,Fr.isMap=us,Fr.isMatch=function(e,t){return e===t||Ln(e,t,ho(t))},Fr.isMatchWith=function(e,r,n){return n="function"==typeof n?n:t,Ln(e,r,ho(r),n)},Fr.isNaN=function(e){return cs(e)&&e!=+e},Fr.isNative=function(e){if($o(e))throw new $e("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Nn(e)},Fr.isNil=function(e){return null==e},Fr.isNull=function(e){return null===e},Fr.isNumber=cs,Fr.isObject=as,Fr.isObjectLike=ss,Fr.isPlainObject=ls,Fr.isRegExp=ds,Fr.isSafeInteger=function(e){return is(e)&&e>=-9007199254740991&&e<=d},Fr.isSet=fs,Fr.isString=hs,Fr.isSymbol=ps,Fr.isTypedArray=gs,Fr.isUndefined=function(e){return e===t},Fr.isWeakMap=function(e){return ss(e)&&vo(e)==O},Fr.isWeakSet=function(e){return ss(e)&&"[object WeakSet]"==Cn(e)},Fr.join=function(e,t){return null==e?"":vr.call(e,t)},Fr.kebabCase=Zs,Fr.last=ra,Fr.lastIndexOf=function(e,r,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return n!==t&&(o=(o=bs(n))<0?_r(i+o,0):br(o,i-1)),r==r?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,r,o):Mt(e,jt,o,!0)},Fr.lowerCase=qs,Fr.lowerFirst=Qs,Fr.lt=ys,Fr.lte=vs,Fr.max=function(e){return e&&e.length?vn(e,cu,In):t},Fr.maxBy=function(e,r){return e&&e.length?vn(e,lo(r,2),In):t},Fr.mean=function(e){return Ft(e,cu)},Fr.meanBy=function(e,t){return Ft(e,lo(t,2))},Fr.min=function(e){return e&&e.length?vn(e,cu,jn):t},Fr.minBy=function(e,r){return e&&e.length?vn(e,lo(r,2),jn):t},Fr.stubArray=Au,Fr.stubFalse=Eu,Fr.stubObject=function(){return{}},Fr.stubString=function(){return""},Fr.stubTrue=function(){return!0},Fr.multiply=Iu,Fr.nth=function(e,r){return e&&e.length?Kn(e,bs(r)):t},Fr.noConflict=function(){return lt._===this&&(lt._=Ve),this},Fr.noop=pu,Fr.now=Ra,Fr.pad=function(e,t,r){e=Ts(e);var n=(t=bs(t))?ur(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return zi(hr(i),r)+e+zi(Gt(i),r)},Fr.padEnd=function(e,t,r){e=Ts(e);var n=(t=bs(t))?ur(e):0;return t&&n<t?e+zi(t-n,r):e},Fr.padStart=function(e,t,r){e=Ts(e);var n=(t=bs(t))?ur(e):0;return t&&n<t?zi(t-n,r)+e:e},Fr.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),Er(Ts(e).replace(ne,""),t||0)},Fr.random=function(e,r,n){if(n&&"boolean"!=typeof n&&Eo(e,r,n)&&(r=n=t),n===t&&("boolean"==typeof r?(n=r,r=t):"boolean"==typeof e&&(n=e,e=t)),e===t&&r===t?(e=0,r=1):(e=_s(e),r===t?(r=e,e=0):r=_s(r)),e>r){var i=e;e=r,r=i}if(n||e%1||r%1){var o=Sr();return br(e+o*(r-e+at("1e-"+((o+"").length-1))),r)}return Zn(e,r)},Fr.reduce=function(e,t,r){var n=Za(e)?Rt:Ht,i=arguments.length<3;return n(e,lo(t,4),r,i,pn)},Fr.reduceRight=function(e,t,r){var n=Za(e)?xt:Ht,i=arguments.length<3;return n(e,lo(t,4),r,i,gn)},Fr.repeat=function(e,r,n){return r=(n?Eo(e,r,n):r===t)?1:bs(r),qn(Ts(e),r)},Fr.replace=function(){var e=arguments,t=Ts(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Fr.result=function(e,r,n){var i=-1,o=(r=Ai(r,e)).length;for(o||(o=1,e=t);++i<o;){var a=null==e?t:e[Go(r[i])];a===t&&(i=o,a=n),e=ns(a)?a.call(e):a}return e},Fr.round=ku,Fr.runInContext=ie,Fr.sample=function(e){return(Za(e)?Qr:Jn)(e)},Fr.size=function(e){if(null==e)return 0;if(Qa(e))return hs(e)?ur(e):e.length;var t=vo(e);return t==E||t==C?e.size:Bn(e).length},Fr.snakeCase=Js,Fr.some=function(e,r,n){var i=Za(e)?Dt:ai;return n&&Eo(e,r,n)&&(r=t),i(e,lo(r,3))},Fr.sortedIndex=function(e,t){return si(e,t)},Fr.sortedIndexBy=function(e,t,r){return ui(e,t,lo(r,2))},Fr.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=si(e,t);if(n<r&&za(e[n],t))return n}return-1},Fr.sortedLastIndex=function(e,t){return si(e,t,!0)},Fr.sortedLastIndexBy=function(e,t,r){return ui(e,t,lo(r,2),!0)},Fr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var r=si(e,t,!0)-1;if(za(e[r],t))return r}return-1},Fr.startCase=eu,Fr.startsWith=function(e,t,r){return e=Ts(e),r=null==r?0:cn(bs(r),0,e.length),t=di(t),e.slice(r,r+t.length)==t},Fr.subtract=Ou,Fr.sum=function(e){return e&&e.length?Kt(e,cu):0},Fr.sumBy=function(e,t){return e&&e.length?Kt(e,lo(t,2)):0},Fr.template=function(e,r,n){var i=Fr.templateSettings;n&&Eo(e,r,n)&&(r=t),e=Ts(e),r=Cs({},r,i,eo);var o,a,s=Cs({},r.imports,i.imports,eo),u=Ms(s),c=Xt(s,u),l=0,d=r.interpolate||_e,f="__p += '",h=ke((r.escape||_e).source+"|"+d.source+"|"+(d===q?de:_e).source+"|"+(r.evaluate||_e).source+"|$","g"),p="//# sourceURL="+(Me.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(h,(function(t,r,n,i,s,u){return n||(n=i),f+=e.slice(l,u).replace(be,rr),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=u+t.length,t})),f+="';\n";var g=Me.call(r,"variable")&&r.variable;if(g){if(ce.test(g))throw new $e("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(V,""):f).replace(G,"$1").replace(H,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=iu((function(){return we(u,p+"return "+f).apply(t,c)}));if(y.source=f,rs(y))throw y;return y},Fr.times=function(e,t){if((e=bs(e))<1||e>d)return[];var r=h,n=br(e,h);t=lo(t),e-=h;for(var i=zt(n,t);++r<e;)t(r);return i},Fr.toFinite=_s,Fr.toInteger=bs,Fr.toLength=As,Fr.toLower=function(e){return Ts(e).toLowerCase()},Fr.toNumber=Es,Fr.toSafeInteger=function(e){return e?cn(bs(e),-9007199254740991,d):0===e?e:0},Fr.toString=Ts,Fr.toUpper=function(e){return Ts(e).toUpperCase()},Fr.trim=function(e,r,n){if((e=Ts(e))&&(n||r===t))return Wt(e);if(!e||!(r=di(r)))return e;var i=cr(e),o=cr(r);return Si(i,qt(i,o),Qt(i,o)+1).join("")},Fr.trimEnd=function(e,r,n){if((e=Ts(e))&&(n||r===t))return e.slice(0,lr(e)+1);if(!e||!(r=di(r)))return e;var i=cr(e);return Si(i,0,Qt(i,cr(r))+1).join("")},Fr.trimStart=function(e,r,n){if((e=Ts(e))&&(n||r===t))return e.replace(ne,"");if(!e||!(r=di(r)))return e;var i=cr(e);return Si(i,qt(i,cr(r))).join("")},Fr.truncate=function(e,r){var n=30,i="...";if(as(r)){var o="separator"in r?r.separator:o;n="length"in r?bs(r.length):n,i="omission"in r?di(r.omission):i}var a=(e=Ts(e)).length;if(nr(e)){var s=cr(e);a=s.length}if(n>=a)return e;var u=n-ur(i);if(u<1)return i;var c=s?Si(s,0,u).join(""):e.slice(0,u);if(o===t)return c+i;if(s&&(u+=c.length-u),ds(o)){if(e.slice(u).search(o)){var l,d=c;for(o.global||(o=ke(o.source,Ts(fe.exec(o))+"g")),o.lastIndex=0;l=o.exec(d);)var f=l.index;c=c.slice(0,f===t?u:f)}}else if(e.indexOf(di(o),u)!=u){var h=c.lastIndexOf(o);h>-1&&(c=c.slice(0,h))}return c+i},Fr.unescape=function(e){return(e=Ts(e))&&W.test(e)?e.replace(K,dr):e},Fr.uniqueId=function(e){var t=++Be;return Ts(e)+t},Fr.upperCase=tu,Fr.upperFirst=ru,Fr.each=Ta,Fr.eachRight=$a,Fr.first=Qo,hu(Fr,(Su={},En(Fr,(function(e,t){Me.call(Fr.prototype,t)||(Su[t]=e)})),Su),{chain:!1}),Fr.VERSION="4.17.21",Tt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Fr[e].placeholder=Fr})),Tt(["drop","take"],(function(e,r){Kr.prototype[e]=function(n){n=n===t?1:_r(bs(n),0);var i=this.__filtered__&&!r?new Kr(this):this.clone();return i.__filtered__?i.__takeCount__=br(n,i.__takeCount__):i.__views__.push({size:br(n,h),type:e+(i.__dir__<0?"Right":"")}),i},Kr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Tt(["filter","map","takeWhile"],(function(e,t){var r=t+1,n=1==r||3==r;Kr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:lo(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}})),Tt(["head","last"],(function(e,t){var r="take"+(t?"Right":"");Kr.prototype[e]=function(){return this[r](1).value()[0]}})),Tt(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");Kr.prototype[e]=function(){return this.__filtered__?new Kr(this):this[r](1)}})),Kr.prototype.compact=function(){return this.filter(cu)},Kr.prototype.find=function(e){return this.filter(e).head()},Kr.prototype.findLast=function(e){return this.reverse().find(e)},Kr.prototype.invokeMap=Qn((function(e,t){return"function"==typeof e?new Kr(this):this.map((function(r){return Rn(r,e,t)}))})),Kr.prototype.reject=function(e){return this.filter(Fa(lo(e)))},Kr.prototype.slice=function(e,r){e=bs(e);var n=this;return n.__filtered__&&(e>0||r<0)?new Kr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),r!==t&&(n=(r=bs(r))<0?n.dropRight(-r):n.take(r-e)),n)},Kr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Kr.prototype.toArray=function(){return this.take(h)},En(Kr.prototype,(function(e,r){var n=/^(?:filter|find|map|reject)|While$/.test(r),i=/^(?:head|last)$/.test(r),o=Fr[i?"take"+("last"==r?"Right":""):r],a=i||/^find/.test(r);o&&(Fr.prototype[r]=function(){var r=this.__wrapped__,s=i?[1]:arguments,u=r instanceof Kr,c=s[0],l=u||Za(r),d=function(e){var t=o.apply(Fr,Pt([e],s));return i&&f?t[0]:t};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var f=this.__chain__,h=!!this.__actions__.length,p=a&&!f,g=u&&!h;if(!a&&l){r=g?r:new Kr(this);var y=e.apply(r,s);return y.__actions__.push({func:_a,args:[d],thisArg:t}),new Hr(y,f)}return p&&g?e.apply(this,s):(y=this.thru(d),p?i?y.value()[0]:y.value():y)})})),Tt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);Fr.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply(Za(i)?i:[],e)}return this[r]((function(r){return t.apply(Za(r)?r:[],e)}))}})),En(Kr.prototype,(function(e,t){var r=Fr[t];if(r){var n=r.name+"";Me.call(Rr,n)||(Rr[n]=[]),Rr[n].push({name:t,func:r})}})),Rr[Vi(t,2).name]=[{name:"wrapper",func:t}],Kr.prototype.clone=function(){var e=new Kr(this.__wrapped__);return e.__actions__=Pi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Pi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Pi(this.__views__),e},Kr.prototype.reverse=function(){if(this.__filtered__){var e=new Kr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Kr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=Za(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=br(t,e+a);break;case"takeRight":e=_r(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,c=n?s:a-1,l=this.__iteratees__,d=l.length,f=0,h=br(u,this.__takeCount__);if(!r||!n&&i==u&&h==u)return yi(e,this.__actions__);var p=[];e:for(;u--&&f<h;){for(var g=-1,y=e[c+=t];++g<d;){var v=l[g],m=v.iteratee,_=v.type,b=m(y);if(2==_)y=b;else if(!b){if(1==_)continue e;break e}}p[f++]=y}return p},Fr.prototype.at=ba,Fr.prototype.chain=function(){return ma(this)},Fr.prototype.commit=function(){return new Hr(this.value(),this.__chain__)},Fr.prototype.next=function(){this.__values__===t&&(this.__values__=ms(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},Fr.prototype.plant=function(e){for(var r,n=this;n instanceof Gr;){var i=Ko(n);i.__index__=0,i.__values__=t,r?o.__wrapped__=i:r=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,r},Fr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Kr){var r=e;return this.__actions__.length&&(r=new Kr(this)),(r=r.reverse()).__actions__.push({func:_a,args:[aa],thisArg:t}),new Hr(r,this.__chain__)}return this.thru(aa)},Fr.prototype.toJSON=Fr.prototype.valueOf=Fr.prototype.value=function(){return yi(this.__wrapped__,this.__actions__)},Fr.prototype.first=Fr.prototype.head,ct&&(Fr.prototype[ct]=function(){return this}),Fr}();ft?((ft.exports=fr)._=fr,dt._=fr):lt._=fr}.call(commonjsGlobal$1);var proxy$1=function(){var e,t=null;function r(e){return!!e&&("object"===_typeof$3(e)||"function"==typeof e)}function n(e){if(null!==e&&!r(e))throw new TypeError("Object prototype may only be an Object or null: "+e)}var i=Object,o=Boolean(i.create)||!({__proto__:null}instanceof i),a=i.create||(o?function(e){return n(e),{__proto__:e}}:function(e){if(n(e),null===e)throw new SyntaxError("Native Object.create is required to create objects with null prototype");var t=function(){};return t.prototype=e,new t}),s=function(){return null},u=i.getPrototypeOf||([].__proto__===Array.prototype?function(e){var t=e.__proto__;return r(t)?t:null}:s);return e=function(c,l){if(void 0===(this&&this instanceof e?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!r(c)||!r(l))throw new TypeError("Cannot create proxy with a non-object as target or handler");var d=function(){};t=function(){c=null,d=function(e){throw new TypeError("Cannot perform '".concat(e,"' on a proxy that has been revoked"))}},setTimeout((function(){t=null}),0);var f=l;for(var h in l={get:null,set:null,apply:null,construct:null},f){if(!(h in l))throw new TypeError("Proxy polyfill does not support trap '".concat(h,"'"));l[h]=f[h]}"function"==typeof f&&(l.apply=f.apply.bind(f));var p,g=u(c),y=!1,v=!1;"function"==typeof c?(p=function(){var e=this&&this.constructor===p,t=Array.prototype.slice.call(arguments);if(d(e?"construct":"apply"),e&&l.construct)return l.construct.call(this,c,t);if(!e&&l.apply)return l.apply(c,this,t);if(e){t.unshift(c);var r=c.bind.apply(c,t);return new r}return c.apply(this,t)},y=!0):c instanceof Array?(p=[],v=!0):p=o||null!==g?a(g):{};var m=l.get?function(e){return d("get"),l.get(this,e,p)}:function(e){return d("get"),this[e]},_=l.set?function(e,t){d("set"),l.set(this,e,t,p)}:function(e,t){d("set"),this[e]=t},b=i.getOwnPropertyNames(c),A={};b.forEach((function(e){if(!y&&!v||!(e in p)){var t=i.getOwnPropertyDescriptor(c,e),r={enumerable:Boolean(t.enumerable),get:m.bind(c,e),set:_.bind(c,e)};i.defineProperty(p,e,r),A[e]=!0}}));var E=!0;if(y||v){var S=i.setPrototypeOf||([].__proto__===Array.prototype?function(e,t){return n(t),e.__proto__=t,e}:s);g&&S(p,g)||(E=!1)}if(l.get||!E)for(var T in c)A[T]||i.defineProperty(p,T,{get:m.bind(c,T)});return i.seal(c),i.seal(p),p},e.revocable=function(r,n){return{proxy:new e(r,n),revoke:t}},e},Proxy$1=proxy$1(),MyProxy=function(){function e(){_classCallCheck$3(this,e),this.subscribeId=0,this.watcherMap=new Map}return _createClass$3(e,[{key:"observe",value:function(e){var t=this,r=new Proxy$1(e,{set:function(e,n,i){var o=Reflect.get(e,n);Reflect.set(e,n,i);var a=t.watcherMap.get(r);return a&&(t.flushCallback(a),t.flushPropertyCallback(a,n,o,i)),!0}});return this.watcherMap.set(r,{pending:!1,queue:[],property:{}}),r}},{key:"subscribe",value:function(e,t){var r=this.watcherMap.get(e);if(r)return this.subscribeId++,r.queue.push({id:this.subscribeId,callback:t}),this.subscribeId}},{key:"unsubscribe",value:function(e,t){var r=this.watcherMap.get(e);if(r){var n=r.queue,i=n.findIndex((function(e){return e.id===t}));void 0!==i&&i>-1&&n.splice(i,1)}}},{key:"subscribeProperty",value:function(e,t,r){var n=this.watcherMap.get(e);n&&(this.subscribeId++,n.property[t]||(n.property[t]={pending:!1,timer:0,pre:null,queue:[]}),n.property[t].queue.push({id:this.subscribeId,callback:r}))}},{key:"unsubscribeProperty",value:function(e,t,r){var n=this.watcherMap.get(e);if(n){var i=n.property[t];if(i){var o=i.queue,a=o.findIndex((function(e){return e.id===r}));void 0!==a&&a>-1&&o.splice(a,1)}}}},{key:"flushCallback",value:function(e){e.pending||(e.pending=!0,setTimeout((function(){e.queue.forEach((function(e){return e.callback()})),e.pending=!1}),0))}},{key:"flushPropertyCallback",value:function(e,t,r,n){var i=e.property[t];i&&(clearTimeout(i.timer),!1===i.pending&&(i.pending=!0,i.pre=r),i.timer=setTimeout((function(){i.queue.forEach((function(e){return e.callback(i.pre,n)})),i.pending=!1}),0))}}]),e}(),MyProxy$1=new MyProxy;function ownKeys$o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$o(Object(r),!0).forEach((function(t){_defineProperty$2(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2(e,t,r){return t&&_defineProperties$2(e.prototype,t),r&&_defineProperties$2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$2(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1(e,t)}function _getPrototypeOf$1(e){return(_getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf$1(e,t){return(_setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct$r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _assertThisInitialized$1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn$1(e,t){if(t&&("object"===_typeof$3(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(e)}function _createSuper$q(e){var t=_isNativeReflectConstruct$r();return function(){var r,n=_getPrototypeOf$1(e);if(t){var i=_getPrototypeOf$1(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1(this,r)}}function _superPropBase$1(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1(e)););return e}function _get$1(){return _get$1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$1(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},_get$1.apply(this,arguments)}function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$2(e)||_nonIterableSpread$1()}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$2(e)}function _iterableToArray$1(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray$2(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$2(e,t):void 0}}function _arrayLikeToArray$2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var check$1=function(e){return e&&e.Math==Math&&e},global$1T=check$1("object"==("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))&&globalThis)||check$1("object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window)||check$1("object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self)||check$1("object"==_typeof$3(commonjsGlobal$1)&&commonjsGlobal$1)||function(){return this}()||Function("return this")(),objectGetOwnPropertyDescriptor$1={},fails$1m=function(e){try{return!!e()}catch(t){return!0}},fails$1l=fails$1m,descriptors$1=!fails$1l((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),fails$1k=fails$1m,functionBindNative$1=!fails$1k((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),NATIVE_BIND$8=functionBindNative$1,call$L=Function.prototype.call,functionCall$1=NATIVE_BIND$8?call$L.bind(call$L):function(){return call$L.apply(call$L,arguments)},objectPropertyIsEnumerable$1={},$propertyIsEnumerable$4={}.propertyIsEnumerable,getOwnPropertyDescriptor$8=Object.getOwnPropertyDescriptor,NASHORN_BUG$1=getOwnPropertyDescriptor$8&&!$propertyIsEnumerable$4.call({1:2},1);objectPropertyIsEnumerable$1.f=NASHORN_BUG$1?function(e){var t=getOwnPropertyDescriptor$8(this,e);return!!t&&t.enumerable}:$propertyIsEnumerable$4;var createPropertyDescriptor$d=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},NATIVE_BIND$7=functionBindNative$1,FunctionPrototype$7=Function.prototype,bind$k=FunctionPrototype$7.bind,call$K=FunctionPrototype$7.call,uncurryThis$1s=NATIVE_BIND$7&&bind$k.bind(call$K,call$K),functionUncurryThis$1=NATIVE_BIND$7?function(e){return e&&uncurryThis$1s(e)}:function(e){return e&&function(){return call$K.apply(e,arguments)}},uncurryThis$1r=functionUncurryThis$1,toString$C=uncurryThis$1r({}.toString),stringSlice$l=uncurryThis$1r("".slice),classofRaw$3=function(e){return stringSlice$l(toString$C(e),8,-1)},global$1S=global$1T,uncurryThis$1q=functionUncurryThis$1,fails$1j=fails$1m,classof$r=classofRaw$3,Object$5=global$1S.Object,split$4=uncurryThis$1q("".split),indexedObject$1=fails$1j((function(){return!Object$5("z").propertyIsEnumerable(0)}))?function(e){return"String"==classof$r(e)?split$4(e,""):Object$5(e)}:Object$5,global$1R=global$1T,TypeError$u=global$1R.TypeError,requireObjectCoercible$l=function(e){if(null==e)throw TypeError$u("Can't call method on "+e);return e},IndexedObject$7=indexedObject$1,requireObjectCoercible$k=requireObjectCoercible$l,toIndexedObject$o=function(e){return IndexedObject$7(requireObjectCoercible$k(e))},isCallable$Q=function(e){return"function"==typeof e},isCallable$P=isCallable$Q,isObject$K=function(e){return"object"==_typeof$3(e)?null!==e:isCallable$P(e)},global$1Q=global$1T,isCallable$O=isCallable$Q,aFunction$1=function(e){return isCallable$O(e)?e:void 0},getBuiltIn$p=function(e,t){return arguments.length<2?aFunction$1(global$1Q[e]):global$1Q[e]&&global$1Q[e][t]},uncurryThis$1p=functionUncurryThis$1,objectIsPrototypeOf$1=uncurryThis$1p({}.isPrototypeOf),getBuiltIn$o=getBuiltIn$p,engineUserAgent$1=getBuiltIn$o("navigator","userAgent")||"",global$1P=global$1T,userAgent$c=engineUserAgent$1,process$9=global$1P.process,Deno$2=global$1P.Deno,versions$1=process$9&&process$9.versions||Deno$2&&Deno$2.version,v8$1=versions$1&&versions$1.v8,match$1,version$4;v8$1&&(match$1=v8$1.split("."),version$4=match$1[0]>0&&match$1[0]<4?1:+(match$1[0]+match$1[1])),!version$4&&userAgent$c&&(match$1=userAgent$c.match(/Edge\/(\d+)/),(!match$1||match$1[1]>=74)&&(match$1=userAgent$c.match(/Chrome\/(\d+)/),match$1&&(version$4=+match$1[1])));var engineV8Version$1=version$4,V8_VERSION$7=engineV8Version$1,fails$1i=fails$1m,nativeSymbol$1=!!Object.getOwnPropertySymbols&&!fails$1i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V8_VERSION$7&&V8_VERSION$7<41})),NATIVE_SYMBOL$a=nativeSymbol$1,useSymbolAsUid$1=NATIVE_SYMBOL$a&&!Symbol.sham&&"symbol"==_typeof$3(Symbol.iterator),global$1O=global$1T,getBuiltIn$n=getBuiltIn$p,isCallable$N=isCallable$Q,isPrototypeOf$i=objectIsPrototypeOf$1,USE_SYMBOL_AS_UID$3=useSymbolAsUid$1,Object$4=global$1O.Object,isSymbol$d=USE_SYMBOL_AS_UID$3?function(e){return"symbol"==_typeof$3(e)}:function(e){var t=getBuiltIn$n("Symbol");return isCallable$N(t)&&isPrototypeOf$i(t.prototype,Object$4(e))},global$1N=global$1T,String$7=global$1N.String,tryToString$c=function(e){try{return String$7(e)}catch(t){return"Object"}},global$1M=global$1T,isCallable$M=isCallable$Q,tryToString$b=tryToString$c,TypeError$t=global$1M.TypeError,aCallable$h=function(e){if(isCallable$M(e))return e;throw TypeError$t(tryToString$b(e)+" is not a function")},aCallable$g=aCallable$h,getMethod$e=function(e,t){var r=e[t];return null==r?void 0:aCallable$g(r)},global$1L=global$1T,call$J=functionCall$1,isCallable$L=isCallable$Q,isObject$J=isObject$K,TypeError$s=global$1L.TypeError,ordinaryToPrimitive$3=function(e,t){var r,n;if("string"===t&&isCallable$L(r=e.toString)&&!isObject$J(n=call$J(r,e)))return n;if(isCallable$L(r=e.valueOf)&&!isObject$J(n=call$J(r,e)))return n;if("string"!==t&&isCallable$L(r=e.toString)&&!isObject$J(n=call$J(r,e)))return n;throw TypeError$s("Can't convert object to primitive value")},shared$d={exports:{}},isPure=!1,global$1K=global$1T,defineProperty$o=Object.defineProperty,setGlobal$3=function(e,t){try{defineProperty$o(global$1K,e,{value:t,configurable:!0,writable:!0})}catch(r){global$1K[e]=t}return t},global$1J=global$1T,setGlobal$2=setGlobal$3,SHARED$1="__core-js_shared__",store$7=global$1J[SHARED$1]||setGlobal$2(SHARED$1,{}),sharedStore$1=store$7,store$6=sharedStore$1;(shared$d.exports=function(e,t){return store$6[e]||(store$6[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.1",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"});var global$1I=global$1T,requireObjectCoercible$j=requireObjectCoercible$l,Object$3=global$1I.Object,toObject$o=function(e){return Object$3(requireObjectCoercible$j(e))},uncurryThis$1o=functionUncurryThis$1,toObject$n=toObject$o,hasOwnProperty$4=uncurryThis$1o({}.hasOwnProperty),hasOwnProperty_1$1=Object.hasOwn||function(e,t){return hasOwnProperty$4(toObject$n(e),t)},uncurryThis$1n=functionUncurryThis$1,id$2=0,postfix$1=Math.random(),toString$B=uncurryThis$1n(1..toString),uid$9=function(e){return"Symbol("+(void 0===e?"":e)+")_"+toString$B(++id$2+postfix$1,36)},global$1H=global$1T,shared$c=shared$d.exports,hasOwn$C=hasOwnProperty_1$1,uid$8=uid$9,NATIVE_SYMBOL$9=nativeSymbol$1,USE_SYMBOL_AS_UID$2=useSymbolAsUid$1,WellKnownSymbolsStore$3=shared$c("wks"),_Symbol$8=global$1H.Symbol,symbolFor$1=_Symbol$8&&_Symbol$8.for,createWellKnownSymbol$1=USE_SYMBOL_AS_UID$2?_Symbol$8:_Symbol$8&&_Symbol$8.withoutSetter||uid$8,wellKnownSymbol$O=function(e){if(!hasOwn$C(WellKnownSymbolsStore$3,e)||!NATIVE_SYMBOL$9&&"string"!=typeof WellKnownSymbolsStore$3[e]){var t="Symbol."+e;NATIVE_SYMBOL$9&&hasOwn$C(_Symbol$8,e)?WellKnownSymbolsStore$3[e]=_Symbol$8[e]:WellKnownSymbolsStore$3[e]=USE_SYMBOL_AS_UID$2&&symbolFor$1?symbolFor$1(t):createWellKnownSymbol$1(t)}return WellKnownSymbolsStore$3[e]},global$1G=global$1T,call$I=functionCall$1,isObject$I=isObject$K,isSymbol$c=isSymbol$d,getMethod$d=getMethod$e,ordinaryToPrimitive$2=ordinaryToPrimitive$3,wellKnownSymbol$N=wellKnownSymbol$O,TypeError$r=global$1G.TypeError,TO_PRIMITIVE$2=wellKnownSymbol$N("toPrimitive"),toPrimitive$5=function(e,t){if(!isObject$I(e)||isSymbol$c(e))return e;var r,n=getMethod$d(e,TO_PRIMITIVE$2);if(n){if(void 0===t&&(t="default"),r=call$I(n,e,t),!isObject$I(r)||isSymbol$c(r))return r;throw TypeError$r("Can't convert object to primitive value")}return void 0===t&&(t="number"),ordinaryToPrimitive$2(e,t)},toPrimitive$4=toPrimitive$5,isSymbol$b=isSymbol$d,toPropertyKey$a=function(e){var t=toPrimitive$4(e,"string");return isSymbol$b(t)?t:t+""},global$1F=global$1T,isObject$H=isObject$K,document$6=global$1F.document,EXISTS$3=isObject$H(document$6)&&isObject$H(document$6.createElement),documentCreateElement$5=function(e){return EXISTS$3?document$6.createElement(e):{}},DESCRIPTORS$J=descriptors$1,fails$1h=fails$1m,createElement$3=documentCreateElement$5,ie8DomDefine$1=!DESCRIPTORS$J&&!fails$1h((function(){return 7!=Object.defineProperty(createElement$3("div"),"a",{get:function(){return 7}}).a})),DESCRIPTORS$I=descriptors$1,call$H=functionCall$1,propertyIsEnumerableModule$4=objectPropertyIsEnumerable$1,createPropertyDescriptor$c=createPropertyDescriptor$d,toIndexedObject$n=toIndexedObject$o,toPropertyKey$9=toPropertyKey$a,hasOwn$B=hasOwnProperty_1$1,IE8_DOM_DEFINE$3=ie8DomDefine$1,$getOwnPropertyDescriptor$5=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor$1.f=DESCRIPTORS$I?$getOwnPropertyDescriptor$5:function(e,t){if(e=toIndexedObject$n(e),t=toPropertyKey$9(t),IE8_DOM_DEFINE$3)try{return $getOwnPropertyDescriptor$5(e,t)}catch(r){}if(hasOwn$B(e,t))return createPropertyDescriptor$c(!call$H(propertyIsEnumerableModule$4.f,e,t),e[t])};var objectDefineProperty$1={},DESCRIPTORS$H=descriptors$1,fails$1g=fails$1m,v8PrototypeDefineBug$1=DESCRIPTORS$H&&fails$1g((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),global$1E=global$1T,isObject$G=isObject$K,String$6=global$1E.String,TypeError$q=global$1E.TypeError,anObject$E=function(e){if(isObject$G(e))return e;throw TypeError$q(String$6(e)+" is not an object")},global$1D=global$1T,DESCRIPTORS$G=descriptors$1,IE8_DOM_DEFINE$2=ie8DomDefine$1,V8_PROTOTYPE_DEFINE_BUG$3=v8PrototypeDefineBug$1,anObject$D=anObject$E,toPropertyKey$8=toPropertyKey$a,TypeError$p=global$1D.TypeError,$defineProperty$3=Object.defineProperty,$getOwnPropertyDescriptor$4=Object.getOwnPropertyDescriptor,ENUMERABLE$1="enumerable",CONFIGURABLE$3="configurable",WRITABLE$1="writable";objectDefineProperty$1.f=DESCRIPTORS$G?V8_PROTOTYPE_DEFINE_BUG$3?function(e,t,r){if(anObject$D(e),t=toPropertyKey$8(t),anObject$D(r),"function"==typeof e&&"prototype"===t&&"value"in r&&WRITABLE$1 in r&&!r[WRITABLE$1]){var n=$getOwnPropertyDescriptor$4(e,t);n&&n[WRITABLE$1]&&(e[t]=r.value,r={configurable:CONFIGURABLE$3 in r?r[CONFIGURABLE$3]:n[CONFIGURABLE$3],enumerable:ENUMERABLE$1 in r?r[ENUMERABLE$1]:n[ENUMERABLE$1],writable:!1})}return $defineProperty$3(e,t,r)}:$defineProperty$3:function(e,t,r){if(anObject$D(e),t=toPropertyKey$8(t),anObject$D(r),IE8_DOM_DEFINE$2)try{return $defineProperty$3(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError$p("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var DESCRIPTORS$F=descriptors$1,definePropertyModule$e=objectDefineProperty$1,createPropertyDescriptor$b=createPropertyDescriptor$d,createNonEnumerableProperty$j=DESCRIPTORS$F?function(e,t,r){return definePropertyModule$e.f(e,t,createPropertyDescriptor$b(1,r))}:function(e,t,r){return e[t]=r,e},redefine$h={exports:{}},uncurryThis$1m=functionUncurryThis$1,isCallable$K=isCallable$Q,store$5=sharedStore$1,functionToString$4=uncurryThis$1m(Function.toString);isCallable$K(store$5.inspectSource)||(store$5.inspectSource=function(e){return functionToString$4(e)});var inspectSource$9=store$5.inspectSource,global$1C=global$1T,isCallable$J=isCallable$Q,inspectSource$8=inspectSource$9,WeakMap$4=global$1C.WeakMap,nativeWeakMap$1=isCallable$J(WeakMap$4)&&/native code/.test(inspectSource$8(WeakMap$4)),shared$b=shared$d.exports,uid$7=uid$9,keys$a=shared$b("keys"),sharedKey$8=function(e){return keys$a[e]||(keys$a[e]=uid$7(e))},hiddenKeys$c={},NATIVE_WEAK_MAP$1=nativeWeakMap$1,global$1B=global$1T,uncurryThis$1l=functionUncurryThis$1,isObject$F=isObject$K,createNonEnumerableProperty$i=createNonEnumerableProperty$j,hasOwn$A=hasOwnProperty_1$1,shared$a=sharedStore$1,sharedKey$7=sharedKey$8,hiddenKeys$b=hiddenKeys$c,OBJECT_ALREADY_INITIALIZED$1="Object already initialized",TypeError$o=global$1B.TypeError,WeakMap$3=global$1B.WeakMap,set$4,get$2,has$1,enforce$1=function(e){return has$1(e)?get$2(e):set$4(e,{})},getterFor$1=function(e){return function(t){var r;if(!isObject$F(t)||(r=get$2(t)).type!==e)throw TypeError$o("Incompatible receiver, "+e+" required");return r}};if(NATIVE_WEAK_MAP$1||shared$a.state){var store$4=shared$a.state||(shared$a.state=new WeakMap$3),wmget$1=uncurryThis$1l(store$4.get),wmhas$1=uncurryThis$1l(store$4.has),wmset$1=uncurryThis$1l(store$4.set);set$4=function(e,t){if(wmhas$1(store$4,e))throw new TypeError$o(OBJECT_ALREADY_INITIALIZED$1);return t.facade=e,wmset$1(store$4,e,t),t},get$2=function(e){return wmget$1(store$4,e)||{}},has$1=function(e){return wmhas$1(store$4,e)}}else{var STATE$1=sharedKey$7("state");hiddenKeys$b[STATE$1]=!0,set$4=function(e,t){if(hasOwn$A(e,STATE$1))throw new TypeError$o(OBJECT_ALREADY_INITIALIZED$1);return t.facade=e,createNonEnumerableProperty$i(e,STATE$1,t),t},get$2=function(e){return hasOwn$A(e,STATE$1)?e[STATE$1]:{}},has$1=function(e){return hasOwn$A(e,STATE$1)}}var internalState$1={set:set$4,get:get$2,has:has$1,enforce:enforce$1,getterFor:getterFor$1},DESCRIPTORS$E=descriptors$1,hasOwn$z=hasOwnProperty_1$1,FunctionPrototype$6=Function.prototype,getDescriptor$1=DESCRIPTORS$E&&Object.getOwnPropertyDescriptor,EXISTS$2=hasOwn$z(FunctionPrototype$6,"name"),PROPER$1=EXISTS$2&&"something"===function(){}.name,CONFIGURABLE$2=EXISTS$2&&(!DESCRIPTORS$E||DESCRIPTORS$E&&getDescriptor$1(FunctionPrototype$6,"name").configurable),functionName$1={EXISTS:EXISTS$2,PROPER:PROPER$1,CONFIGURABLE:CONFIGURABLE$2},global$1A=global$1T,isCallable$I=isCallable$Q,hasOwn$y=hasOwnProperty_1$1,createNonEnumerableProperty$h=createNonEnumerableProperty$j,setGlobal$1=setGlobal$3,inspectSource$7=inspectSource$9,InternalStateModule$c=internalState$1,CONFIGURABLE_FUNCTION_NAME$3=functionName$1.CONFIGURABLE,getInternalState$c=InternalStateModule$c.get,enforceInternalState$3=InternalStateModule$c.enforce,TEMPLATE$1=String(String).split("String");(redefine$h.exports=function(e,t,r,n){var i,o=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,s=!!n&&!!n.noTargetGet,u=n&&void 0!==n.name?n.name:t;isCallable$I(r)&&("Symbol("===String(u).slice(0,7)&&(u="["+String(u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!hasOwn$y(r,"name")||CONFIGURABLE_FUNCTION_NAME$3&&r.name!==u)&&createNonEnumerableProperty$h(r,"name",u),(i=enforceInternalState$3(r)).source||(i.source=TEMPLATE$1.join("string"==typeof u?u:""))),e!==global$1A?(o?!s&&e[t]&&(a=!0):delete e[t],a?e[t]=r:createNonEnumerableProperty$h(e,t,r)):a?e[t]=r:setGlobal$1(t,r)})(Function.prototype,"toString",(function(){return isCallable$I(this)&&getInternalState$c(this).source||inspectSource$7(this)}));var objectGetOwnPropertyNames$1={},ceil$3=Math.ceil,floor$d=Math.floor,toIntegerOrInfinity$j=function(e){var t=+e;return t!=t||0===t?0:(t>0?floor$d:ceil$3)(t)},toIntegerOrInfinity$i=toIntegerOrInfinity$j,max$9=Math.max,min$c=Math.min,toAbsoluteIndex$c=function(e,t){var r=toIntegerOrInfinity$i(e);return r<0?max$9(r+t,0):min$c(r,t)},toIntegerOrInfinity$h=toIntegerOrInfinity$j,min$b=Math.min,toLength$g=function(e){return e>0?min$b(toIntegerOrInfinity$h(e),9007199254740991):0},toLength$f=toLength$g,lengthOfArrayLike$n=function(e){return toLength$f(e.length)},toIndexedObject$m=toIndexedObject$o,toAbsoluteIndex$b=toAbsoluteIndex$c,lengthOfArrayLike$m=lengthOfArrayLike$n,createMethod$a=function(e){return function(t,r,n){var i,o=toIndexedObject$m(t),a=lengthOfArrayLike$m(o),s=toAbsoluteIndex$b(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},arrayIncludes$1={includes:createMethod$a(!0),indexOf:createMethod$a(!1)},uncurryThis$1k=functionUncurryThis$1,hasOwn$x=hasOwnProperty_1$1,toIndexedObject$l=toIndexedObject$o,indexOf$4=arrayIncludes$1.indexOf,hiddenKeys$a=hiddenKeys$c,push$f=uncurryThis$1k([].push),objectKeysInternal$1=function(e,t){var r,n=toIndexedObject$l(e),i=0,o=[];for(r in n)!hasOwn$x(hiddenKeys$a,r)&&hasOwn$x(n,r)&&push$f(o,r);for(;t.length>i;)hasOwn$x(n,r=t[i++])&&(~indexOf$4(o,r)||push$f(o,r));return o},enumBugKeys$7=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$3=objectKeysInternal$1,enumBugKeys$6=enumBugKeys$7,hiddenKeys$9=enumBugKeys$6.concat("length","prototype");objectGetOwnPropertyNames$1.f=Object.getOwnPropertyNames||function(e){return internalObjectKeys$3(e,hiddenKeys$9)};var objectGetOwnPropertySymbols$1={};objectGetOwnPropertySymbols$1.f=Object.getOwnPropertySymbols;var getBuiltIn$m=getBuiltIn$p,uncurryThis$1j=functionUncurryThis$1,getOwnPropertyNamesModule$4=objectGetOwnPropertyNames$1,getOwnPropertySymbolsModule$5=objectGetOwnPropertySymbols$1,anObject$C=anObject$E,concat$6=uncurryThis$1j([].concat),ownKeys$n=getBuiltIn$m("Reflect","ownKeys")||function(e){var t=getOwnPropertyNamesModule$4.f(anObject$C(e)),r=getOwnPropertySymbolsModule$5.f;return r?concat$6(t,r(e)):t},hasOwn$w=hasOwnProperty_1$1,ownKeys$m=ownKeys$n,getOwnPropertyDescriptorModule$6=objectGetOwnPropertyDescriptor$1,definePropertyModule$d=objectDefineProperty$1,copyConstructorProperties$6=function(e,t,r){for(var n=ownKeys$m(t),i=definePropertyModule$d.f,o=getOwnPropertyDescriptorModule$6.f,a=0;a<n.length;a++){var s=n[a];hasOwn$w(e,s)||r&&hasOwn$w(r,s)||i(e,s,o(t,s))}},fails$1f=fails$1m,isCallable$H=isCallable$Q,replacement$1=/#|\.prototype\./,isForced$a=function(e,t){var r=data$1[normalize$1(e)];return r==POLYFILL$1||r!=NATIVE$1&&(isCallable$H(t)?fails$1f(t):!!t)},normalize$1=isForced$a.normalize=function(e){return String(e).replace(replacement$1,".").toLowerCase()},data$1=isForced$a.data={},NATIVE$1=isForced$a.NATIVE="N",POLYFILL$1=isForced$a.POLYFILL="P",isForced_1$1=isForced$a,global$1z=global$1T,getOwnPropertyDescriptor$7=objectGetOwnPropertyDescriptor$1.f,createNonEnumerableProperty$g=createNonEnumerableProperty$j,redefine$g=redefine$h.exports,setGlobal=setGlobal$3,copyConstructorProperties$5=copyConstructorProperties$6,isForced$9=isForced_1$1,_export$1=function(e,t){var r,n,i,o,a,s=e.target,u=e.global,c=e.stat;if(r=u?global$1z:c?global$1z[s]||setGlobal(s,{}):(global$1z[s]||{}).prototype)for(n in t){if(o=t[n],i=e.noTargetGet?(a=getOwnPropertyDescriptor$7(r,n))&&a.value:r[n],!isForced$9(u?n:s+(c?".":"#")+n,e.forced)&&void 0!==i){if(_typeof$3(o)==_typeof$3(i))continue;copyConstructorProperties$5(o,i)}(e.sham||i&&i.sham)&&createNonEnumerableProperty$g(o,"sham",!0),redefine$g(r,n,o,e)}},NATIVE_BIND$6=functionBindNative$1,FunctionPrototype$5=Function.prototype,apply$h=FunctionPrototype$5.apply,call$G=FunctionPrototype$5.call,functionApply$1="object"==("undefined"==typeof Reflect?"undefined":_typeof$3(Reflect))&&Reflect.apply||(NATIVE_BIND$6?call$G.bind(apply$h):function(){return call$G.apply(apply$h,arguments)}),global$1y=global$1T,isCallable$G=isCallable$Q,String$5=global$1y.String,TypeError$n=global$1y.TypeError,aPossiblePrototype$3=function(e){if("object"==_typeof$3(e)||isCallable$G(e))return e;throw TypeError$n("Can't set "+String$5(e)+" as a prototype")},uncurryThis$1i=functionUncurryThis$1,anObject$B=anObject$E,aPossiblePrototype$2=aPossiblePrototype$3,objectSetPrototypeOf$1=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=uncurryThis$1i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(n){}return function(r,n){return anObject$B(r),aPossiblePrototype$2(n),t?e(r,n):r.__proto__=n,r}}():void 0),isCallable$F=isCallable$Q,isObject$E=isObject$K,setPrototypeOf$8=objectSetPrototypeOf$1,inheritIfRequired$8=function(e,t,r){var n,i;return setPrototypeOf$8&&isCallable$F(n=t.constructor)&&n!==r&&isObject$E(i=n.prototype)&&i!==r.prototype&&setPrototypeOf$8(e,i),e},wellKnownSymbol$M=wellKnownSymbol$O,TO_STRING_TAG$7=wellKnownSymbol$M("toStringTag"),test$2={};test$2[TO_STRING_TAG$7]="z";var toStringTagSupport$1="[object z]"===String(test$2),global$1x=global$1T,TO_STRING_TAG_SUPPORT$5=toStringTagSupport$1,isCallable$E=isCallable$Q,classofRaw$2=classofRaw$3,wellKnownSymbol$L=wellKnownSymbol$O,TO_STRING_TAG$6=wellKnownSymbol$L("toStringTag"),Object$2=global$1x.Object,CORRECT_ARGUMENTS$1="Arguments"==classofRaw$2(function(){return arguments}()),tryGet$1=function(e,t){try{return e[t]}catch(r){}},classof$q=TO_STRING_TAG_SUPPORT$5?classofRaw$2:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=tryGet$1(t=Object$2(e),TO_STRING_TAG$6))?r:CORRECT_ARGUMENTS$1?classofRaw$2(t):"Object"==(n=classofRaw$2(t))&&isCallable$E(t.callee)?"Arguments":n},global$1w=global$1T,classof$p=classof$q,String$4=global$1w.String,toString$A=function(e){if("Symbol"===classof$p(e))throw TypeError("Cannot convert a Symbol value to a string");return String$4(e)},toString$z=toString$A,normalizeStringArgument$1=function(e,t){return void 0===e?arguments.length<2?"":t:toString$z(e)},isObject$D=isObject$K,createNonEnumerableProperty$f=createNonEnumerableProperty$j,installErrorCause$1=function(e,t){isObject$D(t)&&"cause"in t&&createNonEnumerableProperty$f(e,"cause",t.cause)},uncurryThis$1h=functionUncurryThis$1,replace$f=uncurryThis$1h("".replace),TEST=String(Error("zxcasd").stack),V8_OR_CHAKRA_STACK_ENTRY=/\n\s*at [^:]*:[^\n]*/,IS_V8_OR_CHAKRA_STACK=V8_OR_CHAKRA_STACK_ENTRY.test(TEST),clearErrorStack$1=function(e,t){if(IS_V8_OR_CHAKRA_STACK&&"string"==typeof e)for(;t--;)e=replace$f(e,V8_OR_CHAKRA_STACK_ENTRY,"");return e},fails$1e=fails$1m,createPropertyDescriptor$a=createPropertyDescriptor$d,errorStackInstallable=!fails$1e((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",createPropertyDescriptor$a(1,7)),7!==e.stack)})),getBuiltIn$l=getBuiltIn$p,hasOwn$v=hasOwnProperty_1$1,createNonEnumerableProperty$e=createNonEnumerableProperty$j,isPrototypeOf$h=objectIsPrototypeOf$1,setPrototypeOf$7=objectSetPrototypeOf$1,copyConstructorProperties$4=copyConstructorProperties$6,inheritIfRequired$7=inheritIfRequired$8,normalizeStringArgument=normalizeStringArgument$1,installErrorCause=installErrorCause$1,clearErrorStack=clearErrorStack$1,ERROR_STACK_INSTALLABLE=errorStackInstallable,wrapErrorConstructorWithCause$1=function(e,t,r,n){var i=n?2:1,o=e.split("."),a=o[o.length-1],s=getBuiltIn$l.apply(null,o);if(s){var u=s.prototype;if(hasOwn$v(u,"cause")&&delete u.cause,!r)return s;var c=getBuiltIn$l("Error"),l=t((function(e,t){var r=normalizeStringArgument(n?t:e,void 0),o=n?new s(e):new s;return void 0!==r&&createNonEnumerableProperty$e(o,"message",r),ERROR_STACK_INSTALLABLE&&createNonEnumerableProperty$e(o,"stack",clearErrorStack(o.stack,2)),this&&isPrototypeOf$h(u,this)&&inheritIfRequired$7(o,this,l),arguments.length>i&&installErrorCause(o,arguments[i]),o}));l.prototype=u,"Error"!==a&&(setPrototypeOf$7?setPrototypeOf$7(l,c):copyConstructorProperties$4(l,c,{name:!0})),copyConstructorProperties$4(l,s);try{u.name!==a&&createNonEnumerableProperty$e(u,"name",a),u.constructor=l}catch(d){}return l}},$$1t=_export$1,global$1v=global$1T,apply$g=functionApply$1,wrapErrorConstructorWithCause=wrapErrorConstructorWithCause$1,WEB_ASSEMBLY="WebAssembly",WebAssembly$1=global$1v[WEB_ASSEMBLY],FORCED$k=7!==Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(e,t){var r={};r[e]=wrapErrorConstructorWithCause(e,t,FORCED$k),$$1t({global:!0,forced:FORCED$k},r)},exportWebAssemblyErrorCauseWrapper=function(e,t){if(WebAssembly$1&&WebAssembly$1[e]){var r={};r[e]=wrapErrorConstructorWithCause(WEB_ASSEMBLY+"."+e,t,FORCED$k),$$1t({target:WEB_ASSEMBLY,stat:!0,forced:FORCED$k},r)}};exportGlobalErrorCauseWrapper("Error",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("EvalError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("RangeError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("ReferenceError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("SyntaxError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("TypeError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportGlobalErrorCauseWrapper("URIError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("CompileError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("LinkError",(function(e){return function(t){return apply$g(e,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("RuntimeError",(function(e){return function(t){return apply$g(e,this,arguments)}}));var uncurryThis$1g=functionUncurryThis$1,aCallable$f=aCallable$h,NATIVE_BIND$5=functionBindNative$1,bind$j=uncurryThis$1g(uncurryThis$1g.bind),functionBindContext$1=function(e,t){return aCallable$f(e),void 0===t?e:NATIVE_BIND$5?bind$j(e,t):function(){return e.apply(t,arguments)}},classof$o=classofRaw$3,isArray$9=Array.isArray||function(e){return"Array"==classof$o(e)},uncurryThis$1f=functionUncurryThis$1,fails$1d=fails$1m,isCallable$D=isCallable$Q,classof$n=classof$q,getBuiltIn$k=getBuiltIn$p,inspectSource$6=inspectSource$9,noop$2=function(){},empty$1=[],construct$2=getBuiltIn$k("Reflect","construct"),constructorRegExp$1=/^\s*(?:class|function)\b/,exec$d=uncurryThis$1f(constructorRegExp$1.exec),INCORRECT_TO_STRING$1=!constructorRegExp$1.exec(noop$2),isConstructorModern$1=function(e){if(!isCallable$D(e))return!1;try{return construct$2(noop$2,empty$1,e),!0}catch(t){return!1}},isConstructorLegacy$1=function(e){if(!isCallable$D(e))return!1;switch(classof$n(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING$1||!!exec$d(constructorRegExp$1,inspectSource$6(e))}catch(t){return!0}};isConstructorLegacy$1.sham=!0;var isConstructor$7=!construct$2||fails$1d((function(){var e;return isConstructorModern$1(isConstructorModern$1.call)||!isConstructorModern$1(Object)||!isConstructorModern$1((function(){e=!0}))||e}))?isConstructorLegacy$1:isConstructorModern$1,global$1u=global$1T,isArray$8=isArray$9,isConstructor$6=isConstructor$7,isObject$C=isObject$K,wellKnownSymbol$K=wellKnownSymbol$O,SPECIES$c=wellKnownSymbol$K("species"),Array$8=global$1u.Array,arraySpeciesConstructor$3=function(e){var t;return isArray$8(e)&&(t=e.constructor,(isConstructor$6(t)&&(t===Array$8||isArray$8(t.prototype))||isObject$C(t)&&null===(t=t[SPECIES$c]))&&(t=void 0)),void 0===t?Array$8:t},arraySpeciesConstructor$2=arraySpeciesConstructor$3,arraySpeciesCreate$7=function(e,t){return new(arraySpeciesConstructor$2(e))(0===t?0:t)},bind$i=functionBindContext$1,uncurryThis$1e=functionUncurryThis$1,IndexedObject$6=indexedObject$1,toObject$m=toObject$o,lengthOfArrayLike$l=lengthOfArrayLike$n,arraySpeciesCreate$6=arraySpeciesCreate$7,push$e=uncurryThis$1e([].push),createMethod$9=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(u,c,l,d){for(var f,h,p=toObject$m(u),g=IndexedObject$6(p),y=bind$i(c,l),v=lengthOfArrayLike$l(g),m=0,_=d||arraySpeciesCreate$6,b=t?_(u,v):r||a?_(u,0):void 0;v>m;m++)if((s||m in g)&&(h=y(f=g[m],m,p),e))if(t)b[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:push$e(b,f)}else switch(e){case 4:return!1;case 7:push$e(b,f)}return o?-1:n||i?i:b}},arrayIteration$1={forEach:createMethod$9(0),map:createMethod$9(1),filter:createMethod$9(2),some:createMethod$9(3),every:createMethod$9(4),find:createMethod$9(5),findIndex:createMethod$9(6),filterReject:createMethod$9(7)},objectDefineProperties$1={},internalObjectKeys$2=objectKeysInternal$1,enumBugKeys$5=enumBugKeys$7,objectKeys$7=Object.keys||function(e){return internalObjectKeys$2(e,enumBugKeys$5)},DESCRIPTORS$D=descriptors$1,V8_PROTOTYPE_DEFINE_BUG$2=v8PrototypeDefineBug$1,definePropertyModule$c=objectDefineProperty$1,anObject$A=anObject$E,toIndexedObject$k=toIndexedObject$o,objectKeys$6=objectKeys$7;objectDefineProperties$1.f=DESCRIPTORS$D&&!V8_PROTOTYPE_DEFINE_BUG$2?Object.defineProperties:function(e,t){anObject$A(e);for(var r,n=toIndexedObject$k(t),i=objectKeys$6(t),o=i.length,a=0;o>a;)definePropertyModule$c.f(e,r=i[a++],n[r]);return e};var getBuiltIn$j=getBuiltIn$p,html$5=getBuiltIn$j("document","documentElement"),anObject$z=anObject$E,definePropertiesModule$3=objectDefineProperties$1,enumBugKeys$4=enumBugKeys$7,hiddenKeys$8=hiddenKeys$c,html$4=html$5,documentCreateElement$4=documentCreateElement$5,sharedKey$6=sharedKey$8,GT$1=">",LT$1="<",PROTOTYPE$4="prototype",SCRIPT$1="script",IE_PROTO$2=sharedKey$6("IE_PROTO"),EmptyConstructor$1=function(){},scriptTag$1=function(e){return LT$1+SCRIPT$1+GT$1+e+LT$1+"/"+SCRIPT$1+GT$1},NullProtoObjectViaActiveX$1=function(e){e.write(scriptTag$1("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame$1=function(){var e,t=documentCreateElement$4("iframe"),r="java"+SCRIPT$1+":";return t.style.display="none",html$4.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(scriptTag$1("document.F=Object")),e.close(),e.F},activeXDocument$1,_NullProtoObject$1=function(){try{activeXDocument$1=new ActiveXObject("htmlfile")}catch(t){}_NullProtoObject$1="undefined"!=typeof document?document.domain&&activeXDocument$1?NullProtoObjectViaActiveX$1(activeXDocument$1):NullProtoObjectViaIFrame$1():NullProtoObjectViaActiveX$1(activeXDocument$1);for(var e=enumBugKeys$4.length;e--;)delete _NullProtoObject$1[PROTOTYPE$4][enumBugKeys$4[e]];return _NullProtoObject$1()};hiddenKeys$8[IE_PROTO$2]=!0;var objectCreate$1=Object.create||function(e,t){var r;return null!==e?(EmptyConstructor$1[PROTOTYPE$4]=anObject$z(e),r=new EmptyConstructor$1,EmptyConstructor$1[PROTOTYPE$4]=null,r[IE_PROTO$2]=e):r=_NullProtoObject$1(),void 0===t?r:definePropertiesModule$3.f(r,t)},wellKnownSymbol$J=wellKnownSymbol$O,create$8=objectCreate$1,definePropertyModule$b=objectDefineProperty$1,UNSCOPABLES=wellKnownSymbol$J("unscopables"),ArrayPrototype$2=Array.prototype;null==ArrayPrototype$2[UNSCOPABLES]&&definePropertyModule$b.f(ArrayPrototype$2,UNSCOPABLES,{configurable:!0,value:create$8(null)});var addToUnscopables$4=function(e){ArrayPrototype$2[UNSCOPABLES][e]=!0},$$1s=_export$1,$find$1=arrayIteration$1.find,addToUnscopables$3=addToUnscopables$4,FIND="find",SKIPS_HOLES$1=!0;FIND in[]&&Array(1)[FIND]((function(){SKIPS_HOLES$1=!1})),$$1s({target:"Array",proto:!0,forced:SKIPS_HOLES$1},{find:function(e){return $find$1(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables$3(FIND);var TO_STRING_TAG_SUPPORT$4=toStringTagSupport$1,classof$m=classof$q,objectToString$3=TO_STRING_TAG_SUPPORT$4?{}.toString:function(){return"[object "+classof$m(this)+"]"},TO_STRING_TAG_SUPPORT$3=toStringTagSupport$1,redefine$f=redefine$h.exports,toString$y=objectToString$3;TO_STRING_TAG_SUPPORT$3||redefine$f(Object.prototype,"toString",toString$y,{unsafe:!0});var toPropertyKey$7=toPropertyKey$a,definePropertyModule$a=objectDefineProperty$1,createPropertyDescriptor$9=createPropertyDescriptor$d,createProperty$b=function(e,t,r){var n=toPropertyKey$7(t);n in e?definePropertyModule$a.f(e,n,createPropertyDescriptor$9(0,r)):e[n]=r},fails$1c=fails$1m,wellKnownSymbol$I=wellKnownSymbol$O,V8_VERSION$6=engineV8Version$1,SPECIES$b=wellKnownSymbol$I("species"),arrayMethodHasSpeciesSupport$a=function(e){return V8_VERSION$6>=51||!fails$1c((function(){var t=[];return(t.constructor={})[SPECIES$b]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},$$1r=_export$1,global$1t=global$1T,fails$1b=fails$1m,isArray$7=isArray$9,isObject$B=isObject$K,toObject$l=toObject$o,lengthOfArrayLike$k=lengthOfArrayLike$n,createProperty$a=createProperty$b,arraySpeciesCreate$5=arraySpeciesCreate$7,arrayMethodHasSpeciesSupport$9=arrayMethodHasSpeciesSupport$a,wellKnownSymbol$H=wellKnownSymbol$O,V8_VERSION$5=engineV8Version$1,IS_CONCAT_SPREADABLE$1=wellKnownSymbol$H("isConcatSpreadable"),MAX_SAFE_INTEGER$4=9007199254740991,MAXIMUM_ALLOWED_INDEX_EXCEEDED="Maximum allowed index exceeded",TypeError$m=global$1t.TypeError,IS_CONCAT_SPREADABLE_SUPPORT$1=V8_VERSION$5>=51||!fails$1b((function(){var e=[];return e[IS_CONCAT_SPREADABLE$1]=!1,e.concat()[0]!==e})),SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport$9("concat"),isConcatSpreadable$1=function(e){if(!isObject$B(e))return!1;var t=e[IS_CONCAT_SPREADABLE$1];return void 0!==t?!!t:isArray$7(e)},FORCED$j=!IS_CONCAT_SPREADABLE_SUPPORT$1||!SPECIES_SUPPORT$1;$$1r({target:"Array",proto:!0,forced:FORCED$j},{concat:function(e){var t,r,n,i,o,a=toObject$l(this),s=arraySpeciesCreate$5(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(isConcatSpreadable$1(o=-1===t?a:arguments[t])){if(u+(i=lengthOfArrayLike$k(o))>MAX_SAFE_INTEGER$4)throw TypeError$m(MAXIMUM_ALLOWED_INDEX_EXCEEDED);for(r=0;r<i;r++,u++)r in o&&createProperty$a(s,u,o[r])}else{if(u>=MAX_SAFE_INTEGER$4)throw TypeError$m(MAXIMUM_ALLOWED_INDEX_EXCEEDED);createProperty$a(s,u++,o)}return s.length=u,s}});var domIterables$1={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},documentCreateElement$3=documentCreateElement$5,classList$1=documentCreateElement$3("span").classList,DOMTokenListPrototype$4=classList$1&&classList$1.constructor&&classList$1.constructor.prototype,domTokenListPrototype$1=DOMTokenListPrototype$4===Object.prototype?void 0:DOMTokenListPrototype$4,fails$1a=fails$1m,arrayMethodIsStrict$d=function(e,t){var r=[][e];return!!r&&fails$1a((function(){r.call(null,t||function(){return 1},1)}))},$forEach$4=arrayIteration$1.forEach,arrayMethodIsStrict$c=arrayMethodIsStrict$d,STRICT_METHOD$b=arrayMethodIsStrict$c("forEach"),arrayForEach$1=STRICT_METHOD$b?[].forEach:function(e){return $forEach$4(this,e,arguments.length>1?arguments[1]:void 0)},global$1s=global$1T,DOMIterables$2=domIterables$1,DOMTokenListPrototype$3=domTokenListPrototype$1,forEach$5=arrayForEach$1,createNonEnumerableProperty$d=createNonEnumerableProperty$j,handlePrototype$2=function(e){if(e&&e.forEach!==forEach$5)try{createNonEnumerableProperty$d(e,"forEach",forEach$5)}catch(t){e.forEach=forEach$5}};for(var COLLECTION_NAME$2 in DOMIterables$2)DOMIterables$2[COLLECTION_NAME$2]&&handlePrototype$2(global$1s[COLLECTION_NAME$2]&&global$1s[COLLECTION_NAME$2].prototype);handlePrototype$2(DOMTokenListPrototype$3);var $$1q=_export$1,toObject$k=toObject$o,nativeKeys$1=objectKeys$7,fails$19=fails$1m,FAILS_ON_PRIMITIVES$6=fails$19((function(){nativeKeys$1(1)}));$$1q({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$6},{keys:function(e){return nativeKeys$1(toObject$k(e))}});var uncurryThis$1d=functionUncurryThis$1,arraySlice$j=uncurryThis$1d([].slice),$$1p=_export$1,global$1r=global$1T,isArray$6=isArray$9,isConstructor$5=isConstructor$7,isObject$A=isObject$K,toAbsoluteIndex$a=toAbsoluteIndex$c,lengthOfArrayLike$j=lengthOfArrayLike$n,toIndexedObject$j=toIndexedObject$o,createProperty$9=createProperty$b,wellKnownSymbol$G=wellKnownSymbol$O,arrayMethodHasSpeciesSupport$8=arrayMethodHasSpeciesSupport$a,un$Slice=arraySlice$j,HAS_SPECIES_SUPPORT$6=arrayMethodHasSpeciesSupport$8("slice"),SPECIES$a=wellKnownSymbol$G("species"),Array$7=global$1r.Array,max$8=Math.max;$$1p({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$6},{slice:function(e,t){var r,n,i,o=toIndexedObject$j(this),a=lengthOfArrayLike$j(o),s=toAbsoluteIndex$a(e,a),u=toAbsoluteIndex$a(void 0===t?a:t,a);if(isArray$6(o)&&(r=o.constructor,(isConstructor$5(r)&&(r===Array$7||isArray$6(r.prototype))||isObject$A(r)&&null===(r=r[SPECIES$a]))&&(r=void 0),r===Array$7||void 0===r))return un$Slice(o,s,u);for(n=new(void 0===r?Array$7:r)(max$8(u-s,0)),i=0;s<u;s++,i++)s in o&&createProperty$9(n,i,o[s]);return n.length=i,n}});var anObject$y=anObject$E,regexpFlags$3=function(){var e=anObject$y(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},fails$18=fails$1m,global$1q=global$1T,$RegExp$5=global$1q.RegExp,UNSUPPORTED_Y$7=fails$18((function(){var e=$RegExp$5("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),MISSED_STICKY$4=UNSUPPORTED_Y$7||fails$18((function(){return!$RegExp$5("a","y").sticky})),BROKEN_CARET$1=UNSUPPORTED_Y$7||fails$18((function(){var e=$RegExp$5("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),regexpStickyHelpers$1={BROKEN_CARET:BROKEN_CARET$1,MISSED_STICKY:MISSED_STICKY$4,UNSUPPORTED_Y:UNSUPPORTED_Y$7},fails$17=fails$1m,global$1p=global$1T,$RegExp$4=global$1p.RegExp,regexpUnsupportedDotAll$1=fails$17((function(){var e=$RegExp$4(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),fails$16=fails$1m,global$1o=global$1T,$RegExp$3=global$1o.RegExp,regexpUnsupportedNcg$1=fails$16((function(){var e=$RegExp$3("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),call$F=functionCall$1,uncurryThis$1c=functionUncurryThis$1,toString$x=toString$A,regexpFlags$2=regexpFlags$3,stickyHelpers$5=regexpStickyHelpers$1,shared$9=shared$d.exports,create$7=objectCreate$1,getInternalState$b=internalState$1.get,UNSUPPORTED_DOT_ALL$4=regexpUnsupportedDotAll$1,UNSUPPORTED_NCG$3=regexpUnsupportedNcg$1,nativeReplace$1=shared$9("native-string-replace",String.prototype.replace),nativeExec$1=RegExp.prototype.exec,patchedExec$1=nativeExec$1,charAt$g=uncurryThis$1c("".charAt),indexOf$3=uncurryThis$1c("".indexOf),replace$e=uncurryThis$1c("".replace),stringSlice$k=uncurryThis$1c("".slice),UPDATES_LAST_INDEX_WRONG$1=(re12=/a/,re22=/b*/g,call$F(nativeExec$1,re12,"a"),call$F(nativeExec$1,re22,"a"),0!==re12.lastIndex||0!==re22.lastIndex),re12,re22,UNSUPPORTED_Y$6=stickyHelpers$5.BROKEN_CARET,NPCG_INCLUDED$1=void 0!==/()??/.exec("")[1],PATCH$1=UPDATES_LAST_INDEX_WRONG$1||NPCG_INCLUDED$1||UNSUPPORTED_Y$6||UNSUPPORTED_DOT_ALL$4||UNSUPPORTED_NCG$3;PATCH$1&&(patchedExec$1=function(e){var t,r,n,i,o,a,s,u=this,c=getInternalState$b(u),l=toString$x(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=call$F(patchedExec$1,d,l),u.lastIndex=d.lastIndex,t;var f=c.groups,h=UNSUPPORTED_Y$6&&u.sticky,p=call$F(regexpFlags$2,u),g=u.source,y=0,v=l;if(h&&(p=replace$e(p,"y",""),-1===indexOf$3(p,"g")&&(p+="g"),v=stringSlice$k(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==charAt$g(l,u.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",p)),NPCG_INCLUDED$1&&(r=new RegExp("^"+g+"$(?!\\s)",p)),UPDATES_LAST_INDEX_WRONG$1&&(n=u.lastIndex),i=call$F(nativeExec$1,h?r:u,v),h?i?(i.input=stringSlice$k(i.input,y),i[0]=stringSlice$k(i[0],y),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:UPDATES_LAST_INDEX_WRONG$1&&i&&(u.lastIndex=u.global?i.index+i[0].length:n),NPCG_INCLUDED$1&&i&&i.length>1&&call$F(nativeReplace$1,i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&f)for(i.groups=a=create$7(null),o=0;o<f.length;o++)a[(s=f[o])[0]]=i[s[1]];return i});var regexpExec$7=patchedExec$1,$$1o=_export$1,exec$c=regexpExec$7;$$1o({target:"RegExp",proto:!0,forced:/./.exec!==exec$c},{exec:exec$c});var $$1n=_export$1,global$1n=global$1T,call$E=functionCall$1,uncurryThis$1b=functionUncurryThis$1,isCallable$C=isCallable$Q,isObject$z=isObject$K,DELEGATES_TO_EXEC=(execCalled=!1,re3=/[ac]/,re3.exec=function(){return execCalled=!0,/./.exec.apply(this,arguments)},!0===re3.test("abc")&&execCalled),execCalled,re3,Error$1=global$1n.Error,un$Test=uncurryThis$1b(/./.test);$$1n({target:"RegExp",proto:!0,forced:!DELEGATES_TO_EXEC},{test:function(e){var t=this.exec;if(!isCallable$C(t))return un$Test(this,e);var r=call$E(t,this,e);if(null!==r&&!isObject$z(r))throw new Error$1("RegExp exec method returned something other than an Object or null");return!!r}});var uncurryThis$1a=functionUncurryThis$1,redefine$e=redefine$h.exports,regexpExec$6=regexpExec$7,fails$15=fails$1m,wellKnownSymbol$F=wellKnownSymbol$O,createNonEnumerableProperty$c=createNonEnumerableProperty$j,SPECIES$9=wellKnownSymbol$F("species"),RegExpPrototype$9=RegExp.prototype,fixRegexpWellKnownSymbolLogic$1=function(e,t,r,n){var i=wellKnownSymbol$F(e),o=!fails$15((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!fails$15((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[SPECIES$9]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return t=!0,null},r[i](""),!t}));if(!o||!a||r){var s=uncurryThis$1a(/./[i]),u=t(i,""[e],(function(e,t,r,n,i){var a=uncurryThis$1a(e),u=t.exec;return u===regexpExec$6||u===RegExpPrototype$9.exec?o&&!i?{done:!0,value:s(t,r,n)}:{done:!0,value:a(r,t,n)}:{done:!1}}));redefine$e(String.prototype,e,u[0]),redefine$e(RegExpPrototype$9,i,u[1])}n&&createNonEnumerableProperty$c(RegExpPrototype$9[i],"sham",!0)},isObject$y=isObject$K,classof$l=classofRaw$3,wellKnownSymbol$E=wellKnownSymbol$O,MATCH$4=wellKnownSymbol$E("match"),isRegexp$1=function(e){var t;return isObject$y(e)&&(void 0!==(t=e[MATCH$4])?!!t:"RegExp"==classof$l(e))},global$1m=global$1T,isConstructor$4=isConstructor$7,tryToString$a=tryToString$c,TypeError$l=global$1m.TypeError,aConstructor$5=function(e){if(isConstructor$4(e))return e;throw TypeError$l(tryToString$a(e)+" is not a constructor")},anObject$x=anObject$E,aConstructor$4=aConstructor$5,wellKnownSymbol$D=wellKnownSymbol$O,SPECIES$8=wellKnownSymbol$D("species"),speciesConstructor$8=function(e,t){var r,n=anObject$x(e).constructor;return void 0===n||null==(r=anObject$x(n)[SPECIES$8])?t:aConstructor$4(r)},uncurryThis$19=functionUncurryThis$1,toIntegerOrInfinity$g=toIntegerOrInfinity$j,toString$w=toString$A,requireObjectCoercible$i=requireObjectCoercible$l,charAt$f=uncurryThis$19("".charAt),charCodeAt$6=uncurryThis$19("".charCodeAt),stringSlice$j=uncurryThis$19("".slice),createMethod$8=function(e){return function(t,r){var n,i,o=toString$w(requireObjectCoercible$i(t)),a=toIntegerOrInfinity$g(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=charCodeAt$6(o,a))<55296||n>56319||a+1===s||(i=charCodeAt$6(o,a+1))<56320||i>57343?e?charAt$f(o,a):n:e?stringSlice$j(o,a,a+2):i-56320+(n-55296<<10)+65536}},stringMultibyte$1={codeAt:createMethod$8(!1),charAt:createMethod$8(!0)},charAt$e=stringMultibyte$1.charAt,advanceStringIndex$7=function(e,t,r){return t+(r?charAt$e(e,t).length:1)},global$1l=global$1T,toAbsoluteIndex$9=toAbsoluteIndex$c,lengthOfArrayLike$i=lengthOfArrayLike$n,createProperty$8=createProperty$b,Array$6=global$1l.Array,max$7=Math.max,arraySliceSimple$1=function(e,t,r){for(var n=lengthOfArrayLike$i(e),i=toAbsoluteIndex$9(t,n),o=toAbsoluteIndex$9(void 0===r?n:r,n),a=Array$6(max$7(o-i,0)),s=0;i<o;i++,s++)createProperty$8(a,s,e[i]);return a.length=s,a},global$1k=global$1T,call$D=functionCall$1,anObject$w=anObject$E,isCallable$B=isCallable$Q,classof$k=classofRaw$3,regexpExec$5=regexpExec$7,TypeError$k=global$1k.TypeError,regexpExecAbstract$1=function(e,t){var r=e.exec;if(isCallable$B(r)){var n=call$D(r,e,t);return null!==n&&anObject$w(n),n}if("RegExp"===classof$k(e))return call$D(regexpExec$5,e,t);throw TypeError$k("RegExp#exec called on incompatible receiver")},apply$f=functionApply$1,call$C=functionCall$1,uncurryThis$18=functionUncurryThis$1,fixRegExpWellKnownSymbolLogic$6=fixRegexpWellKnownSymbolLogic$1,isRegExp$4=isRegexp$1,anObject$v=anObject$E,requireObjectCoercible$h=requireObjectCoercible$l,speciesConstructor$7=speciesConstructor$8,advanceStringIndex$6=advanceStringIndex$7,toLength$e=toLength$g,toString$v=toString$A,getMethod$c=getMethod$e,arraySlice$i=arraySliceSimple$1,callRegExpExec$1=regexpExecAbstract$1,regexpExec$4=regexpExec$7,stickyHelpers$4=regexpStickyHelpers$1,fails$14=fails$1m,UNSUPPORTED_Y$5=stickyHelpers$4.UNSUPPORTED_Y,MAX_UINT32$1=4294967295,min$a=Math.min,$push$1=[].push,exec$b=uncurryThis$18(/./.exec),push$d=uncurryThis$18($push$1),stringSlice$i=uncurryThis$18("".slice),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC$1=!fails$14((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));fixRegExpWellKnownSymbolLogic$6("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=toString$v(requireObjectCoercible$h(this)),i=void 0===r?MAX_UINT32$1:r>>>0;if(0===i)return[];if(void 0===e)return[n];if(!isRegExp$4(e))return call$C(t,n,e,i);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(o=call$C(regexpExec$4,d,n))&&!((a=d.lastIndex)>l&&(push$d(u,stringSlice$i(n,l,o.index)),o.length>1&&o.index<n.length&&apply$f($push$1,u,arraySlice$i(o,1)),s=o[0].length,l=a,u.length>=i));)d.lastIndex===o.index&&d.lastIndex++;return l===n.length?!s&&exec$b(d,"")||push$d(u,""):push$d(u,stringSlice$i(n,l)),u.length>i?arraySlice$i(u,0,i):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:call$C(t,this,e,r)}:t,[function(t,r){var i=requireObjectCoercible$h(this),o=null==t?void 0:getMethod$c(t,e);return o?call$C(o,t,i,r):call$C(n,toString$v(i),t,r)},function(e,i){var o=anObject$v(this),a=toString$v(e),s=r(n,o,a,i,n!==t);if(s.done)return s.value;var u=speciesConstructor$7(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(UNSUPPORTED_Y$5?"g":"y"),d=new u(UNSUPPORTED_Y$5?"^(?:"+o.source+")":o,l),f=void 0===i?MAX_UINT32$1:i>>>0;if(0===f)return[];if(0===a.length)return null===callRegExpExec$1(d,a)?[a]:[];for(var h=0,p=0,g=[];p<a.length;){d.lastIndex=UNSUPPORTED_Y$5?0:p;var y,v=callRegExpExec$1(d,UNSUPPORTED_Y$5?stringSlice$i(a,p):a);if(null===v||(y=min$a(toLength$e(d.lastIndex+(UNSUPPORTED_Y$5?p:0)),a.length))===h)p=advanceStringIndex$6(a,p,c);else{if(push$d(g,stringSlice$i(a,h,p)),g.length===f)return g;for(var m=1;m<=v.length-1;m++)if(push$d(g,v[m]),g.length===f)return g;p=h=y}}return push$d(g,stringSlice$i(a,h)),g}]}),!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC$1,UNSUPPORTED_Y$5);var $$1m=_export$1,uncurryThis$17=functionUncurryThis$1,IndexedObject$5=indexedObject$1,toIndexedObject$i=toIndexedObject$o,arrayMethodIsStrict$b=arrayMethodIsStrict$d,un$Join$1=uncurryThis$17([].join),ES3_STRINGS$1=IndexedObject$5!=Object,STRICT_METHOD$a=arrayMethodIsStrict$b("join",",");$$1m({target:"Array",proto:!0,forced:ES3_STRINGS$1||!STRICT_METHOD$a},{join:function(e){return un$Join$1(toIndexedObject$i(this),void 0===e?",":e)}});var $$1l=_export$1,global$1j=global$1T,toAbsoluteIndex$8=toAbsoluteIndex$c,toIntegerOrInfinity$f=toIntegerOrInfinity$j,lengthOfArrayLike$h=lengthOfArrayLike$n,toObject$j=toObject$o,arraySpeciesCreate$4=arraySpeciesCreate$7,createProperty$7=createProperty$b,arrayMethodHasSpeciesSupport$7=arrayMethodHasSpeciesSupport$a,HAS_SPECIES_SUPPORT$5=arrayMethodHasSpeciesSupport$7("splice"),TypeError$j=global$1j.TypeError,max$6=Math.max,min$9=Math.min,MAX_SAFE_INTEGER$3=9007199254740991,MAXIMUM_ALLOWED_LENGTH_EXCEEDED="Maximum allowed length exceeded";$$1l({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$5},{splice:function(e,t){var r,n,i,o,a,s,u=toObject$j(this),c=lengthOfArrayLike$h(u),l=toAbsoluteIndex$8(e,c),d=arguments.length;if(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=min$9(max$6(toIntegerOrInfinity$f(t),0),c-l)),c+r-n>MAX_SAFE_INTEGER$3)throw TypeError$j(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);for(i=arraySpeciesCreate$4(u,n),o=0;o<n;o++)(a=l+o)in u&&createProperty$7(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:delete u[s];for(o=c;o>c-n+r;o--)delete u[o-1]}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:delete u[s];for(o=0;o<r;o++)u[o+l]=arguments[o+2];return u.length=c-n+r,i}});var global$1i=global$1T,nativePromiseConstructor=global$1i.Promise,redefine$d=redefine$h.exports,redefineAll$4=function(e,t,r){for(var n in t)redefine$d(e,n,t[n],r);return e},defineProperty$n=objectDefineProperty$1.f,hasOwn$u=hasOwnProperty_1$1,wellKnownSymbol$C=wellKnownSymbol$O,TO_STRING_TAG$5=wellKnownSymbol$C("toStringTag"),setToStringTag$b=function(e,t,r){e&&!r&&(e=e.prototype),e&&!hasOwn$u(e,TO_STRING_TAG$5)&&defineProperty$n(e,TO_STRING_TAG$5,{configurable:!0,value:t})},getBuiltIn$i=getBuiltIn$p,definePropertyModule$9=objectDefineProperty$1,wellKnownSymbol$B=wellKnownSymbol$O,DESCRIPTORS$C=descriptors$1,SPECIES$7=wellKnownSymbol$B("species"),setSpecies$8=function(e){var t=getBuiltIn$i(e),r=definePropertyModule$9.f;DESCRIPTORS$C&&t&&!t[SPECIES$7]&&r(t,SPECIES$7,{configurable:!0,get:function(){return this}})},global$1h=global$1T,isPrototypeOf$g=objectIsPrototypeOf$1,TypeError$i=global$1h.TypeError,anInstance$9=function(e,t){if(isPrototypeOf$g(t,e))return e;throw TypeError$i("Incorrect invocation")},iterators$1={},wellKnownSymbol$A=wellKnownSymbol$O,Iterators$6=iterators$1,ITERATOR$f=wellKnownSymbol$A("iterator"),ArrayPrototype$1=Array.prototype,isArrayIteratorMethod$5=function(e){return void 0!==e&&(Iterators$6.Array===e||ArrayPrototype$1[ITERATOR$f]===e)},classof$j=classof$q,getMethod$b=getMethod$e,Iterators$5=iterators$1,wellKnownSymbol$z=wellKnownSymbol$O,ITERATOR$e=wellKnownSymbol$z("iterator"),getIteratorMethod$8=function(e){if(null!=e)return getMethod$b(e,ITERATOR$e)||getMethod$b(e,"@@iterator")||Iterators$5[classof$j(e)]},global$1g=global$1T,call$B=functionCall$1,aCallable$e=aCallable$h,anObject$u=anObject$E,tryToString$9=tryToString$c,getIteratorMethod$7=getIteratorMethod$8,TypeError$h=global$1g.TypeError,getIterator$6=function(e,t){var r=arguments.length<2?getIteratorMethod$7(e):t;if(aCallable$e(r))return anObject$u(call$B(r,e));throw TypeError$h(tryToString$9(e)+" is not iterable")},call$A=functionCall$1,anObject$t=anObject$E,getMethod$a=getMethod$e,iteratorClose$4=function(e,t,r){var n,i;anObject$t(e);try{if(!(n=getMethod$a(e,"return"))){if("throw"===t)throw r;return r}n=call$A(n,e)}catch(o){i=!0,n=o}if("throw"===t)throw r;if(i)throw n;return anObject$t(n),r},global$1f=global$1T,bind$h=functionBindContext$1,call$z=functionCall$1,anObject$s=anObject$E,tryToString$8=tryToString$c,isArrayIteratorMethod$4=isArrayIteratorMethod$5,lengthOfArrayLike$g=lengthOfArrayLike$n,isPrototypeOf$f=objectIsPrototypeOf$1,getIterator$5=getIterator$6,getIteratorMethod$6=getIteratorMethod$8,iteratorClose$3=iteratorClose$4,TypeError$g=global$1f.TypeError,Result$1=function(e,t){this.stopped=e,this.result=t},ResultPrototype$1=Result$1.prototype,iterate$6=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),p=bind$h(t,l),g=function(e){return n&&iteratorClose$3(n,"normal",e),new Result$1(!0,e)},y=function(e){return d?(anObject$s(e),h?p(e[0],e[1],g):p(e[0],e[1])):h?p(e,g):p(e)};if(f)n=e;else{if(!(i=getIteratorMethod$6(e)))throw TypeError$g(tryToString$8(e)+" is not iterable");if(isArrayIteratorMethod$4(i)){for(o=0,a=lengthOfArrayLike$g(e);a>o;o++)if((s=y(e[o]))&&isPrototypeOf$f(ResultPrototype$1,s))return s;return new Result$1(!1)}n=getIterator$5(e,i)}for(u=n.next;!(c=call$z(u,n)).done;){try{s=y(c.value)}catch(v){iteratorClose$3(n,"throw",v)}if("object"==_typeof$3(s)&&s&&isPrototypeOf$f(ResultPrototype$1,s))return s}return new Result$1(!1)},wellKnownSymbol$y=wellKnownSymbol$O,ITERATOR$d=wellKnownSymbol$y("iterator"),SAFE_CLOSING$1=!1;try{var called$1=0,iteratorWithReturn$1={next:function(){return{done:!!called$1++}},return:function(){SAFE_CLOSING$1=!0}};iteratorWithReturn$1[ITERATOR$d]=function(){return this},Array.from(iteratorWithReturn$1,(function(){throw 2}))}catch(error){}var checkCorrectnessOfIteration$6=function(e,t){if(!t&&!SAFE_CLOSING$1)return!1;var r=!1;try{var n={};n[ITERATOR$d]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(error){}return r},global$1e=global$1T,TypeError$f=global$1e.TypeError,validateArgumentsLength$7=function(e,t){if(e<t)throw TypeError$f("Not enough arguments");return e},userAgent$b=engineUserAgent$1,engineIsIos$1=/(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent$b),classof$i=classofRaw$3,global$1d=global$1T,engineIsNode$1="process"==classof$i(global$1d.process),global$1c=global$1T,apply$e=functionApply$1,bind$g=functionBindContext$1,isCallable$A=isCallable$Q,hasOwn$t=hasOwnProperty_1$1,fails$13=fails$1m,html$3=html$5,arraySlice$h=arraySlice$j,createElement$2=documentCreateElement$5,validateArgumentsLength$6=validateArgumentsLength$7,IS_IOS$3=engineIsIos$1,IS_NODE$6=engineIsNode$1,set$3=global$1c.setImmediate,clear$2=global$1c.clearImmediate,process$8=global$1c.process,Dispatch$1=global$1c.Dispatch,Function$5=global$1c.Function,MessageChannel$1=global$1c.MessageChannel,String$3=global$1c.String,counter$1=0,queue$3={},ONREADYSTATECHANGE$1="onreadystatechange",location$2,defer$1,channel$1,port$1;try{location$2=global$1c.location}catch(error){}var run$1=function(e){if(hasOwn$t(queue$3,e)){var t=queue$3[e];delete queue$3[e],t()}},runner$1=function(e){return function(){run$1(e)}},listener$2=function(e){run$1(e.data)},post$1=function(e){global$1c.postMessage(String$3(e),location$2.protocol+"//"+location$2.host)};set$3&&clear$2||(set$3=function(e){validateArgumentsLength$6(arguments.length,1);var t=isCallable$A(e)?e:Function$5(e),r=arraySlice$h(arguments,1);return queue$3[++counter$1]=function(){apply$e(t,void 0,r)},defer$1(counter$1),counter$1},clear$2=function(e){delete queue$3[e]},IS_NODE$6?defer$1=function(e){process$8.nextTick(runner$1(e))}:Dispatch$1&&Dispatch$1.now?defer$1=function(e){Dispatch$1.now(runner$1(e))}:MessageChannel$1&&!IS_IOS$3?(channel$1=new MessageChannel$1,port$1=channel$1.port2,channel$1.port1.onmessage=listener$2,defer$1=bind$g(port$1.postMessage,port$1)):global$1c.addEventListener&&isCallable$A(global$1c.postMessage)&&!global$1c.importScripts&&location$2&&"file:"!==location$2.protocol&&!fails$13(post$1)?(defer$1=post$1,global$1c.addEventListener("message",listener$2,!1)):defer$1=ONREADYSTATECHANGE$1 in createElement$2("script")?function(e){html$3.appendChild(createElement$2("script"))[ONREADYSTATECHANGE$1]=function(){html$3.removeChild(this),run$1(e)}}:function(e){setTimeout(runner$1(e),0)});var task$3={set:set$3,clear:clear$2},userAgent$a=engineUserAgent$1,global$1b=global$1T,engineIsIosPebble$1=/ipad|iphone|ipod/i.test(userAgent$a)&&void 0!==global$1b.Pebble,userAgent$9=engineUserAgent$1,engineIsWebosWebkit$1=/web0s(?!.*chrome)/i.test(userAgent$9),global$1a=global$1T,bind$f=functionBindContext$1,getOwnPropertyDescriptor$6=objectGetOwnPropertyDescriptor$1.f,macrotask$1=task$3.set,IS_IOS$2=engineIsIos$1,IS_IOS_PEBBLE$1=engineIsIosPebble$1,IS_WEBOS_WEBKIT$1=engineIsWebosWebkit$1,IS_NODE$5=engineIsNode$1,MutationObserver$2=global$1a.MutationObserver||global$1a.WebKitMutationObserver,document$5=global$1a.document,process$7=global$1a.process,Promise$2=global$1a.Promise,queueMicrotaskDescriptor$1=getOwnPropertyDescriptor$6(global$1a,"queueMicrotask"),queueMicrotask$1=queueMicrotaskDescriptor$1&&queueMicrotaskDescriptor$1.value,flush$1,head$1,last$1,notify$3,toggle$1,node$1,promise$1,then$1;queueMicrotask$1||(flush$1=function(){var e,t;for(IS_NODE$5&&(e=process$7.domain)&&e.exit();head$1;){t=head$1.fn,head$1=head$1.next;try{t()}catch(error){throw head$1?notify$3():last$1=void 0,error}}last$1=void 0,e&&e.enter()},IS_IOS$2||IS_NODE$5||IS_WEBOS_WEBKIT$1||!MutationObserver$2||!document$5?!IS_IOS_PEBBLE$1&&Promise$2&&Promise$2.resolve?(promise$1=Promise$2.resolve(void 0),promise$1.constructor=Promise$2,then$1=bind$f(promise$1.then,promise$1),notify$3=function(){then$1(flush$1)}):IS_NODE$5?notify$3=function(){process$7.nextTick(flush$1)}:(macrotask$1=bind$f(macrotask$1,global$1a),notify$3=function(){macrotask$1(flush$1)}):(toggle$1=!0,node$1=document$5.createTextNode(""),new MutationObserver$2(flush$1).observe(node$1,{characterData:!0}),notify$3=function(){node$1.data=toggle$1=!toggle$1}));var microtask$3=queueMicrotask$1||function(e){var t={fn:e,next:void 0};last$1&&(last$1.next=t),head$1||(head$1=t,notify$3()),last$1=t},newPromiseCapability$5={},aCallable$d=aCallable$h,PromiseCapability$1=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=aCallable$d(t),this.reject=aCallable$d(r)};newPromiseCapability$5.f=function(e){return new PromiseCapability$1(e)};var anObject$r=anObject$E,isObject$x=isObject$K,newPromiseCapability$4=newPromiseCapability$5,promiseResolve$4=function(e,t){if(anObject$r(e),isObject$x(t)&&t.constructor===e)return t;var r=newPromiseCapability$4.f(e);return(0,r.resolve)(t),r.promise},global$19=global$1T,hostReportErrors$3=function(e,t){var r=global$19.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},perform$5=function(e){try{return{error:!1,value:e()}}catch(error){return{error:!0,value:error}}},Queue$3=function(){this.head=null,this.tail=null};Queue$3.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var queue$2=Queue$3,engineIsBrowser$1="object"==("undefined"==typeof window?"undefined":_typeof$3(window)),$$1k=_export$1,global$18=global$1T,getBuiltIn$h=getBuiltIn$p,call$y=functionCall$1,NativePromise$1=nativePromiseConstructor,redefine$c=redefine$h.exports,redefineAll$3=redefineAll$4,setPrototypeOf$6=objectSetPrototypeOf$1,setToStringTag$a=setToStringTag$b,setSpecies$7=setSpecies$8,aCallable$c=aCallable$h,isCallable$z=isCallable$Q,isObject$w=isObject$K,anInstance$8=anInstance$9,inspectSource$5=inspectSource$9,iterate$5=iterate$6,checkCorrectnessOfIteration$5=checkCorrectnessOfIteration$6,speciesConstructor$6=speciesConstructor$8,task$2=task$3.set,microtask$2=microtask$3,promiseResolve$3=promiseResolve$4,hostReportErrors$2=hostReportErrors$3,newPromiseCapabilityModule$4=newPromiseCapability$5,perform$4=perform$5,Queue$2=queue$2,InternalStateModule$b=internalState$1,isForced$8=isForced_1$1,wellKnownSymbol$x=wellKnownSymbol$O,IS_BROWSER$1=engineIsBrowser$1,IS_NODE$4=engineIsNode$1,V8_VERSION$4=engineV8Version$1,SPECIES$6=wellKnownSymbol$x("species"),PROMISE$1="Promise",getInternalState$a=InternalStateModule$b.getterFor(PROMISE$1),setInternalState$a=InternalStateModule$b.set,getInternalPromiseState$1=InternalStateModule$b.getterFor(PROMISE$1),NativePromisePrototype$2=NativePromise$1&&NativePromise$1.prototype,PromiseConstructor$1=NativePromise$1,PromisePrototype$1=NativePromisePrototype$2,TypeError$e=global$18.TypeError,document$4=global$18.document,process$6=global$18.process,newPromiseCapability$3=newPromiseCapabilityModule$4.f,newGenericPromiseCapability$1=newPromiseCapability$3,DISPATCH_EVENT$1=!!(document$4&&document$4.createEvent&&global$18.dispatchEvent),NATIVE_REJECTION_EVENT=isCallable$z(global$18.PromiseRejectionEvent),UNHANDLED_REJECTION$1="unhandledrejection",REJECTION_HANDLED$1="rejectionhandled",PENDING$1=0,FULFILLED$1=1,REJECTED$1=2,HANDLED$1=1,UNHANDLED$1=2,SUBCLASSING$1=!1,Internal$1,OwnPromiseCapability$1,PromiseWrapper$1,nativeThen$1,FORCED$i=isForced$8(PROMISE$1,(function(){var e=inspectSource$5(PromiseConstructor$1),t=e!==String(PromiseConstructor$1);if(!t&&66===V8_VERSION$4)return!0;if(V8_VERSION$4>=51&&/native code/.test(e))return!1;var r=new PromiseConstructor$1((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[SPECIES$6]=n,!(SUBCLASSING$1=r.then((function(){}))instanceof n)||!t&&IS_BROWSER$1&&!NATIVE_REJECTION_EVENT})),INCORRECT_ITERATION$1=FORCED$i||!checkCorrectnessOfIteration$5((function(e){PromiseConstructor$1.all(e).catch((function(){}))})),isThenable$1=function(e){var t;return!(!isObject$w(e)||!isCallable$z(t=e.then))&&t},callReaction$1=function(e,t){var r,n,i,o=t.value,a=t.state==FULFILLED$1,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(t.rejection===UNHANDLED$1&&onHandleUnhandled$1(t),t.rejection=HANDLED$1),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(TypeError$e("Promise-chain cycle")):(n=isThenable$1(r))?call$y(n,r,u,c):u(r)):c(o)}catch(error){l&&!i&&l.exit(),c(error)}},notify$2=function(e,t){e.notified||(e.notified=!0,microtask$2((function(){for(var r,n=e.reactions;r=n.get();)callReaction$1(r,e);e.notified=!1,t&&!e.rejection&&onUnhandled$1(e)})))},dispatchEvent$1=function(e,t,r){var n,i;DISPATCH_EVENT$1?((n=document$4.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),global$18.dispatchEvent(n)):n={promise:t,reason:r},!NATIVE_REJECTION_EVENT&&(i=global$18["on"+e])?i(n):e===UNHANDLED_REJECTION$1&&hostReportErrors$2("Unhandled promise rejection",r)},onUnhandled$1=function(e){call$y(task$2,global$18,(function(){var t,r=e.facade,n=e.value;if(isUnhandled$1(e)&&(t=perform$4((function(){IS_NODE$4?process$6.emit("unhandledRejection",n,r):dispatchEvent$1(UNHANDLED_REJECTION$1,r,n)})),e.rejection=IS_NODE$4||isUnhandled$1(e)?UNHANDLED$1:HANDLED$1,t.error))throw t.value}))},isUnhandled$1=function(e){return e.rejection!==HANDLED$1&&!e.parent},onHandleUnhandled$1=function(e){call$y(task$2,global$18,(function(){var t=e.facade;IS_NODE$4?process$6.emit("rejectionHandled",t):dispatchEvent$1(REJECTION_HANDLED$1,t,e.value)}))},bind$e=function(e,t,r){return function(n){e(t,n,r)}},internalReject$1=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=REJECTED$1,notify$2(e,!0))},internalResolve$1=function e(t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===r)throw TypeError$e("Promise can't be resolved itself");var i=isThenable$1(r);i?microtask$2((function(){var n={done:!1};try{call$y(i,r,bind$e(e,n,t),bind$e(internalReject$1,n,t))}catch(error){internalReject$1(n,error,t)}})):(t.value=r,t.state=FULFILLED$1,notify$2(t,!1))}catch(error){internalReject$1({done:!1},error,t)}}};if(FORCED$i&&(PromiseConstructor$1=function(e){anInstance$8(this,PromisePrototype$1),aCallable$c(e),call$y(Internal$1,this);var t=getInternalState$a(this);try{e(bind$e(internalResolve$1,t),bind$e(internalReject$1,t))}catch(error){internalReject$1(t,error)}},PromisePrototype$1=PromiseConstructor$1.prototype,Internal$1=function(e){setInternalState$a(this,{type:PROMISE$1,done:!1,notified:!1,parent:!1,reactions:new Queue$2,rejection:!1,state:PENDING$1,value:void 0})},Internal$1.prototype=redefineAll$3(PromisePrototype$1,{then:function(e,t){var r=getInternalPromiseState$1(this),n=newPromiseCapability$3(speciesConstructor$6(this,PromiseConstructor$1));return r.parent=!0,n.ok=!isCallable$z(e)||e,n.fail=isCallable$z(t)&&t,n.domain=IS_NODE$4?process$6.domain:void 0,r.state==PENDING$1?r.reactions.add(n):microtask$2((function(){callReaction$1(n,r)})),n.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability$1=function(){var e=new Internal$1,t=getInternalState$a(e);this.promise=e,this.resolve=bind$e(internalResolve$1,t),this.reject=bind$e(internalReject$1,t)},newPromiseCapabilityModule$4.f=newPromiseCapability$3=function(e){return e===PromiseConstructor$1||e===PromiseWrapper$1?new OwnPromiseCapability$1(e):newGenericPromiseCapability$1(e)},isCallable$z(NativePromise$1)&&NativePromisePrototype$2!==Object.prototype)){nativeThen$1=NativePromisePrototype$2.then,SUBCLASSING$1||(redefine$c(NativePromisePrototype$2,"then",(function(e,t){var r=this;return new PromiseConstructor$1((function(e,t){call$y(nativeThen$1,r,e,t)})).then(e,t)}),{unsafe:!0}),redefine$c(NativePromisePrototype$2,"catch",PromisePrototype$1.catch,{unsafe:!0}));try{delete NativePromisePrototype$2.constructor}catch(error){}setPrototypeOf$6&&setPrototypeOf$6(NativePromisePrototype$2,PromisePrototype$1)}$$1k({global:!0,wrap:!0,forced:FORCED$i},{Promise:PromiseConstructor$1}),setToStringTag$a(PromiseConstructor$1,PROMISE$1,!1),setSpecies$7(PROMISE$1),PromiseWrapper$1=getBuiltIn$h(PROMISE$1),$$1k({target:PROMISE$1,stat:!0,forced:FORCED$i},{reject:function(e){var t=newPromiseCapability$3(this);return call$y(t.reject,void 0,e),t.promise}}),$$1k({target:PROMISE$1,stat:!0,forced:FORCED$i},{resolve:function(e){return promiseResolve$3(this,e)}}),$$1k({target:PROMISE$1,stat:!0,forced:INCORRECT_ITERATION$1},{all:function(e){var t=this,r=newPromiseCapability$3(t),n=r.resolve,i=r.reject,o=perform$4((function(){var r=aCallable$c(t.resolve),o=[],a=0,s=1;iterate$5(e,(function(e){var u=a++,c=!1;s++,call$y(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise},race:function(e){var t=this,r=newPromiseCapability$3(t),n=r.reject,i=perform$4((function(){var i=aCallable$c(t.resolve);iterate$5(e,(function(e){call$y(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var DESCRIPTORS$B=descriptors$1,FUNCTION_NAME_EXISTS$1=functionName$1.EXISTS,uncurryThis$16=functionUncurryThis$1,defineProperty$m=objectDefineProperty$1.f,FunctionPrototype$4=Function.prototype,functionToString$3=uncurryThis$16(FunctionPrototype$4.toString),nameRE$1=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,regExpExec$6=uncurryThis$16(nameRE$1.exec),NAME$2="name";DESCRIPTORS$B&&!FUNCTION_NAME_EXISTS$1&&defineProperty$m(FunctionPrototype$4,NAME$2,{configurable:!0,get:function(){try{return regExpExec$6(nameRE$1,functionToString$3(this))[1]}catch(error){return""}}});var uncurryThis$15=functionUncurryThis$1,thisNumberValue$5=uncurryThis$15(1..valueOf),whitespaces$9="\t\n\v\f\r                　\u2028\u2029\ufeff",uncurryThis$14=functionUncurryThis$1,requireObjectCoercible$g=requireObjectCoercible$l,toString$u=toString$A,whitespaces$8=whitespaces$9,replace$d=uncurryThis$14("".replace),whitespace$1="["+whitespaces$8+"]",ltrim$1=RegExp("^"+whitespace$1+whitespace$1+"*"),rtrim$1=RegExp(whitespace$1+whitespace$1+"*$"),createMethod$7=function(e){return function(t){var r=toString$u(requireObjectCoercible$g(t));return 1&e&&(r=replace$d(r,ltrim$1,"")),2&e&&(r=replace$d(r,rtrim$1,"")),r}},stringTrim$1={start:createMethod$7(1),end:createMethod$7(2),trim:createMethod$7(3)},DESCRIPTORS$A=descriptors$1,global$17=global$1T,uncurryThis$13=functionUncurryThis$1,isForced$7=isForced_1$1,redefine$b=redefine$h.exports,hasOwn$s=hasOwnProperty_1$1,inheritIfRequired$6=inheritIfRequired$8,isPrototypeOf$e=objectIsPrototypeOf$1,isSymbol$a=isSymbol$d,toPrimitive$3=toPrimitive$5,fails$12=fails$1m,getOwnPropertyNames$6=objectGetOwnPropertyNames$1.f,getOwnPropertyDescriptor$5=objectGetOwnPropertyDescriptor$1.f,defineProperty$l=objectDefineProperty$1.f,thisNumberValue$4=thisNumberValue$5,trim$5=stringTrim$1.trim,NUMBER$1="Number",NativeNumber$1=global$17[NUMBER$1],NumberPrototype$1=NativeNumber$1.prototype,TypeError$d=global$17.TypeError,arraySlice$g=uncurryThis$13("".slice),charCodeAt$5=uncurryThis$13("".charCodeAt),toNumeric$1=function(e){var t=toPrimitive$3(e,"number");return"bigint"==typeof t?t:toNumber$3(t)},toNumber$3=function(e){var t,r,n,i,o,a,s,u,c=toPrimitive$3(e,"number");if(isSymbol$a(c))throw TypeError$d("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=trim$5(c),43===(t=charCodeAt$5(c,0))||45===t){if(88===(r=charCodeAt$5(c,2))||120===r)return NaN}else if(48===t){switch(charCodeAt$5(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(a=(o=arraySlice$g(c,2)).length,s=0;s<a;s++)if((u=charCodeAt$5(o,s))<48||u>i)return NaN;return parseInt(o,n)}return+c};if(isForced$7(NUMBER$1,!NativeNumber$1(" 0o1")||!NativeNumber$1("0b1")||NativeNumber$1("+0x1"))){for(var NumberWrapper$1=function(e){var t=arguments.length<1?0:NativeNumber$1(toNumeric$1(e)),r=this;return isPrototypeOf$e(NumberPrototype$1,r)&&fails$12((function(){thisNumberValue$4(r)}))?inheritIfRequired$6(Object(t),r,NumberWrapper$1):t},keys$9=DESCRIPTORS$A?getOwnPropertyNames$6(NativeNumber$1):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),j$2=0,key$2;keys$9.length>j$2;j$2++)hasOwn$s(NativeNumber$1,key$2=keys$9[j$2])&&!hasOwn$s(NumberWrapper$1,key$2)&&defineProperty$l(NumberWrapper$1,key$2,getOwnPropertyDescriptor$5(NativeNumber$1,key$2));NumberWrapper$1.prototype=NumberPrototype$1,NumberPrototype$1.constructor=NumberWrapper$1,redefine$b(global$17,NUMBER$1,NumberWrapper$1)}var $$1j=_export$1,$map$2=arrayIteration$1.map,arrayMethodHasSpeciesSupport$6=arrayMethodHasSpeciesSupport$a,HAS_SPECIES_SUPPORT$4=arrayMethodHasSpeciesSupport$6("map");$$1j({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$4},{map:function(e){return $map$2(this,e,arguments.length>1?arguments[1]:void 0)}});var $$1i=_export$1,$filter$2=arrayIteration$1.filter,arrayMethodHasSpeciesSupport$5=arrayMethodHasSpeciesSupport$a,HAS_SPECIES_SUPPORT$3=arrayMethodHasSpeciesSupport$5("filter");$$1i({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$3},{filter:function(e){return $filter$2(this,e,arguments.length>1?arguments[1]:void 0)}});var DESCRIPTORS$z=descriptors$1,uncurryThis$12=functionUncurryThis$1,call$x=functionCall$1,fails$11=fails$1m,objectKeys$5=objectKeys$7,getOwnPropertySymbolsModule$4=objectGetOwnPropertySymbols$1,propertyIsEnumerableModule$3=objectPropertyIsEnumerable$1,toObject$i=toObject$o,IndexedObject$4=indexedObject$1,$assign=Object.assign,defineProperty$k=Object.defineProperty,concat$5=uncurryThis$12([].concat),objectAssign=!$assign||fails$11((function(){if(DESCRIPTORS$z&&1!==$assign({b:1},$assign(defineProperty$k({},"a",{enumerable:!0,get:function(){defineProperty$k(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=$assign({},e)[r]||objectKeys$5($assign({},t)).join("")!=n}))?function(e,t){for(var r=toObject$i(e),n=arguments.length,i=1,o=getOwnPropertySymbolsModule$4.f,a=propertyIsEnumerableModule$3.f;n>i;)for(var s,u=IndexedObject$4(arguments[i++]),c=o?concat$5(objectKeys$5(u),o(u)):objectKeys$5(u),l=c.length,d=0;l>d;)s=c[d++],DESCRIPTORS$z&&!call$x(a,u,s)||(r[s]=u[s]);return r}:$assign,$$1h=_export$1,assign$3=objectAssign;$$1h({target:"Object",stat:!0,forced:Object.assign!==assign$3},{assign:assign$3});var eventemitter3={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(eventemitter3);var EventEmitter$1=eventemitter3.exports,call$w=functionCall$1,fixRegExpWellKnownSymbolLogic$5=fixRegexpWellKnownSymbolLogic$1,anObject$q=anObject$E,toLength$d=toLength$g,toString$t=toString$A,requireObjectCoercible$f=requireObjectCoercible$l,getMethod$9=getMethod$e,advanceStringIndex$5=advanceStringIndex$7,regExpExec$5=regexpExecAbstract$1;fixRegExpWellKnownSymbolLogic$5("match",(function(e,t,r){return[function(t){var r=requireObjectCoercible$f(this),n=null==t?void 0:getMethod$9(t,e);return n?call$w(n,t,r):new RegExp(t)[e](toString$t(r))},function(e){var n=anObject$q(this),i=toString$t(e),o=r(t,n,i);if(o.done)return o.value;if(!n.global)return regExpExec$5(n,i);var a=n.unicode;n.lastIndex=0;for(var s,u=[],c=0;null!==(s=regExpExec$5(n,i));){var l=toString$t(s[0]);u[c]=l,""===l&&(n.lastIndex=advanceStringIndex$5(i,toLength$d(n.lastIndex),a)),c++}return 0===c?null:u}]}));var DESCRIPTORS$y=descriptors$1,global$16=global$1T,uncurryThis$11=functionUncurryThis$1,isForced$6=isForced_1$1,inheritIfRequired$5=inheritIfRequired$8,createNonEnumerableProperty$b=createNonEnumerableProperty$j,defineProperty$j=objectDefineProperty$1.f,getOwnPropertyNames$5=objectGetOwnPropertyNames$1.f,isPrototypeOf$d=objectIsPrototypeOf$1,isRegExp$3=isRegexp$1,toString$s=toString$A,regExpFlags$3=regexpFlags$3,stickyHelpers$3=regexpStickyHelpers$1,redefine$a=redefine$h.exports,fails$10=fails$1m,hasOwn$r=hasOwnProperty_1$1,enforceInternalState$2=internalState$1.enforce,setSpecies$6=setSpecies$8,wellKnownSymbol$w=wellKnownSymbol$O,UNSUPPORTED_DOT_ALL$3=regexpUnsupportedDotAll$1,UNSUPPORTED_NCG$2=regexpUnsupportedNcg$1,MATCH$3=wellKnownSymbol$w("match"),NativeRegExp$1=global$16.RegExp,RegExpPrototype$8=NativeRegExp$1.prototype,SyntaxError$2=global$16.SyntaxError,getFlags$1=uncurryThis$11(regExpFlags$3),exec$a=uncurryThis$11(RegExpPrototype$8.exec),charAt$d=uncurryThis$11("".charAt),replace$c=uncurryThis$11("".replace),stringIndexOf$4=uncurryThis$11("".indexOf),stringSlice$h=uncurryThis$11("".slice),IS_NCG$1=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,re1$1=/a/g,re2$1=/a/g,CORRECT_NEW$1=new NativeRegExp$1(re1$1)!==re1$1,MISSED_STICKY$3=stickyHelpers$3.MISSED_STICKY,UNSUPPORTED_Y$4=stickyHelpers$3.UNSUPPORTED_Y,BASE_FORCED$1=DESCRIPTORS$y&&(!CORRECT_NEW$1||MISSED_STICKY$3||UNSUPPORTED_DOT_ALL$3||UNSUPPORTED_NCG$2||fails$10((function(){return re2$1[MATCH$3]=!1,NativeRegExp$1(re1$1)!=re1$1||NativeRegExp$1(re2$1)==re2$1||"/a/i"!=NativeRegExp$1(re1$1,"i")}))),handleDotAll$1=function(e){for(var t,r=e.length,n=0,i="",o=!1;n<=r;n++)"\\"!==(t=charAt$d(e,n))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+charAt$d(e,++n);return i},handleNCG$1=function(e){for(var t,r=e.length,n=0,i="",o=[],a={},s=!1,u=!1,c=0,l="";n<=r;n++){if("\\"===(t=charAt$d(e,n)))t+=charAt$d(e,++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:exec$a(IS_NCG$1,stringSlice$h(e,n+1))&&(n+=2,u=!0),i+=t,c++;continue;case">"===t&&u:if(""===l||hasOwn$r(a,l))throw new SyntaxError$2("Invalid capture group name");a[l]=!0,o[o.length]=[l,c],u=!1,l="";continue}u?l+=t:i+=t}return[i,o]};if(isForced$6("RegExp",BASE_FORCED$1)){for(var RegExpWrapper$1=function(e,t){var r,n,i,o,a,s,u=isPrototypeOf$d(RegExpPrototype$8,this),c=isRegExp$3(e),l=void 0===t,d=[],f=e;if(!u&&c&&l&&e.constructor===RegExpWrapper$1)return e;if((c||isPrototypeOf$d(RegExpPrototype$8,e))&&(e=e.source,l&&(t="flags"in f?f.flags:getFlags$1(f))),e=void 0===e?"":toString$s(e),t=void 0===t?"":toString$s(t),f=e,UNSUPPORTED_DOT_ALL$3&&"dotAll"in re1$1&&(n=!!t&&stringIndexOf$4(t,"s")>-1)&&(t=replace$c(t,/s/g,"")),r=t,MISSED_STICKY$3&&"sticky"in re1$1&&(i=!!t&&stringIndexOf$4(t,"y")>-1)&&UNSUPPORTED_Y$4&&(t=replace$c(t,/y/g,"")),UNSUPPORTED_NCG$2&&(e=(o=handleNCG$1(e))[0],d=o[1]),a=inheritIfRequired$5(NativeRegExp$1(e,t),u?this:RegExpPrototype$8,RegExpWrapper$1),(n||i||d.length)&&(s=enforceInternalState$2(a),n&&(s.dotAll=!0,s.raw=RegExpWrapper$1(handleDotAll$1(e),r)),i&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{createNonEnumerableProperty$b(a,"source",""===f?"(?:)":f)}catch(error){}return a},proxy=function(e){e in RegExpWrapper$1||defineProperty$j(RegExpWrapper$1,e,{configurable:!0,get:function(){return NativeRegExp$1[e]},set:function(t){NativeRegExp$1[e]=t}})},keys$8=getOwnPropertyNames$5(NativeRegExp$1),index$3=0;keys$8.length>index$3;)proxy(keys$8[index$3++]);RegExpPrototype$8.constructor=RegExpWrapper$1,RegExpWrapper$1.prototype=RegExpPrototype$8,redefine$a(global$16,"RegExp",RegExpWrapper$1)}setSpecies$6("RegExp");var global$15=global$1T,DESCRIPTORS$x=descriptors$1,UNSUPPORTED_DOT_ALL$2=regexpUnsupportedDotAll$1,classof$h=classofRaw$3,defineProperty$i=objectDefineProperty$1.f,getInternalState$9=internalState$1.get,RegExpPrototype$7=RegExp.prototype,TypeError$c=global$15.TypeError;DESCRIPTORS$x&&UNSUPPORTED_DOT_ALL$2&&defineProperty$i(RegExpPrototype$7,"dotAll",{configurable:!0,get:function(){if(this!==RegExpPrototype$7){if("RegExp"===classof$h(this))return!!getInternalState$9(this).dotAll;throw TypeError$c("Incompatible receiver, RegExp required")}}});var global$14=global$1T,DESCRIPTORS$w=descriptors$1,MISSED_STICKY$2=regexpStickyHelpers$1.MISSED_STICKY,classof$g=classofRaw$3,defineProperty$h=objectDefineProperty$1.f,getInternalState$8=internalState$1.get,RegExpPrototype$6=RegExp.prototype,TypeError$b=global$14.TypeError;DESCRIPTORS$w&&MISSED_STICKY$2&&defineProperty$h(RegExpPrototype$6,"sticky",{configurable:!0,get:function(){if(this!==RegExpPrototype$6){if("RegExp"===classof$g(this))return!!getInternalState$8(this).sticky;throw TypeError$b("Incompatible receiver, RegExp required")}}});var uncurryThis$10=functionUncurryThis$1,PROPER_FUNCTION_NAME$5=functionName$1.PROPER,redefine$9=redefine$h.exports,anObject$p=anObject$E,isPrototypeOf$c=objectIsPrototypeOf$1,$toString$5=toString$A,fails$$=fails$1m,regExpFlags$2=regexpFlags$3,TO_STRING$3="toString",RegExpPrototype$5=RegExp.prototype,n$ToString$1=RegExpPrototype$5[TO_STRING$3],getFlags=uncurryThis$10(regExpFlags$2),NOT_GENERIC$1=fails$$((function(){return"/a/b"!=n$ToString$1.call({source:"a",flags:"b"})})),INCORRECT_NAME$1=PROPER_FUNCTION_NAME$5&&n$ToString$1.name!=TO_STRING$3;(NOT_GENERIC$1||INCORRECT_NAME$1)&&redefine$9(RegExp.prototype,TO_STRING$3,(function(){var e=anObject$p(this),t=$toString$5(e.source),r=e.flags;return"/"+t+"/"+$toString$5(void 0===r&&isPrototypeOf$c(RegExpPrototype$5,e)&&!("flags"in RegExpPrototype$5)?getFlags(e):r)}),{unsafe:!0});var PROPER_FUNCTION_NAME$4=functionName$1.PROPER,fails$_=fails$1m,whitespaces$7=whitespaces$9,non$1="​᠎",stringTrimForced$1=function(e){return fails$_((function(){return!!whitespaces$7[e]()||non$1[e]()!==non$1||PROPER_FUNCTION_NAME$4&&whitespaces$7[e].name!==e}))},$$1g=_export$1,$trim$1=stringTrim$1.trim,forcedStringTrimMethod$1=stringTrimForced$1;$$1g({target:"String",proto:!0,forced:forcedStringTrimMethod$1("trim")},{trim:function(){return $trim$1(this)}});var uncurryThis$$=functionUncurryThis$1,toObject$h=toObject$o,floor$c=Math.floor,charAt$c=uncurryThis$$("".charAt),replace$b=uncurryThis$$("".replace),stringSlice$g=uncurryThis$$("".slice),SUBSTITUTION_SYMBOLS$1=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED$1=/\$([$&'`]|\d{1,2})/g,getSubstitution$3=function(e,t,r,n,i,o){var a=r+e.length,s=n.length,u=SUBSTITUTION_SYMBOLS_NO_NAMED$1;return void 0!==i&&(i=toObject$h(i),u=SUBSTITUTION_SYMBOLS$1),replace$b(o,u,(function(o,u){var c;switch(charAt$c(u,0)){case"$":return"$";case"&":return e;case"`":return stringSlice$g(t,0,r);case"'":return stringSlice$g(t,a);case"<":c=i[stringSlice$g(u,1,-1)];break;default:var l=+u;if(0===l)return o;if(l>s){var d=floor$c(l/10);return 0===d?o:d<=s?void 0===n[d-1]?charAt$c(u,1):n[d-1]+charAt$c(u,1):o}c=n[l-1]}return void 0===c?"":c}))},apply$d=functionApply$1,call$v=functionCall$1,uncurryThis$_=functionUncurryThis$1,fixRegExpWellKnownSymbolLogic$4=fixRegexpWellKnownSymbolLogic$1,fails$Z=fails$1m,anObject$o=anObject$E,isCallable$y=isCallable$Q,toIntegerOrInfinity$e=toIntegerOrInfinity$j,toLength$c=toLength$g,toString$r=toString$A,requireObjectCoercible$e=requireObjectCoercible$l,advanceStringIndex$4=advanceStringIndex$7,getMethod$8=getMethod$e,getSubstitution$2=getSubstitution$3,regExpExec$4=regexpExecAbstract$1,wellKnownSymbol$v=wellKnownSymbol$O,REPLACE$1=wellKnownSymbol$v("replace"),max$5=Math.max,min$8=Math.min,concat$4=uncurryThis$_([].concat),push$c=uncurryThis$_([].push),stringIndexOf$3=uncurryThis$_("".indexOf),stringSlice$f=uncurryThis$_("".slice),maybeToString$1=function(e){return void 0===e?e:String(e)},REPLACE_KEEPS_$0$1="$0"==="a".replace(/./,"$0"),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE$1=!!/./[REPLACE$1]&&""===/./[REPLACE$1]("a","$0"),REPLACE_SUPPORTS_NAMED_GROUPS$1=!fails$Z((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));fixRegExpWellKnownSymbolLogic$4("replace",(function(e,t,r){var n=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE$1?"$":"$0";return[function(e,r){var n=requireObjectCoercible$e(this),i=null==e?void 0:getMethod$8(e,REPLACE$1);return i?call$v(i,e,n,r):call$v(t,toString$r(n),e,r)},function(e,i){var o=anObject$o(this),a=toString$r(e);if("string"==typeof i&&-1===stringIndexOf$3(i,n)&&-1===stringIndexOf$3(i,"$<")){var s=r(t,o,a,i);if(s.done)return s.value}var u=isCallable$y(i);u||(i=toString$r(i));var c=o.global;if(c){var l=o.unicode;o.lastIndex=0}for(var d=[];;){var f=regExpExec$4(o,a);if(null===f)break;if(push$c(d,f),!c)break;""===toString$r(f[0])&&(o.lastIndex=advanceStringIndex$4(a,toLength$c(o.lastIndex),l))}for(var h="",p=0,g=0;g<d.length;g++){for(var y=toString$r((f=d[g])[0]),v=max$5(min$8(toIntegerOrInfinity$e(f.index),a.length),0),m=[],_=1;_<f.length;_++)push$c(m,maybeToString$1(f[_]));var b=f.groups;if(u){var A=concat$4([y],m,v,a);void 0!==b&&push$c(A,b);var E=toString$r(apply$d(i,void 0,A))}else E=getSubstitution$2(y,a,v,m,b,i);v>=p&&(h+=stringSlice$f(a,p,v)+E,p=v+y.length)}return h+stringSlice$f(a,p)}]}),!REPLACE_SUPPORTS_NAMED_GROUPS$1||!REPLACE_KEEPS_$0$1||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE$1);var arraySlice$f=arraySliceSimple$1,floor$b=Math.floor,mergeSort=function e(t,r){var n=t.length,i=floor$b(n/2);return n<8?insertionSort(t,r):merge(t,e(arraySlice$f(t,0,i),r),e(arraySlice$f(t,i),r),r)},insertionSort=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},merge=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e},arraySort$1=mergeSort,userAgent$8=engineUserAgent$1,firefox=userAgent$8.match(/firefox\/(\d+)/i),engineFfVersion=!!firefox&&+firefox[1],UA=engineUserAgent$1,engineIsIeOrEdge=/MSIE|Trident/.test(UA),userAgent$7=engineUserAgent$1,webkit=userAgent$7.match(/AppleWebKit\/(\d+)\./),engineWebkitVersion=!!webkit&&+webkit[1],$$1f=_export$1,uncurryThis$Z=functionUncurryThis$1,aCallable$b=aCallable$h,toObject$g=toObject$o,lengthOfArrayLike$f=lengthOfArrayLike$n,toString$q=toString$A,fails$Y=fails$1m,internalSort$1=arraySort$1,arrayMethodIsStrict$a=arrayMethodIsStrict$d,FF$1=engineFfVersion,IE_OR_EDGE$1=engineIsIeOrEdge,V8$1=engineV8Version$1,WEBKIT$1=engineWebkitVersion,test$1=[],un$Sort$1=uncurryThis$Z(test$1.sort),push$b=uncurryThis$Z(test$1.push),FAILS_ON_UNDEFINED=fails$Y((function(){test$1.sort(void 0)})),FAILS_ON_NULL=fails$Y((function(){test$1.sort(null)})),STRICT_METHOD$9=arrayMethodIsStrict$a("sort"),STABLE_SORT$1=!fails$Y((function(){if(V8$1)return V8$1<70;if(!(FF$1&&FF$1>3)){if(IE_OR_EDGE$1)return!0;if(WEBKIT$1)return WEBKIT$1<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)test$1.push({k:t+n,v:r})}for(test$1.sort((function(e,t){return t.v-e.v})),n=0;n<test$1.length;n++)t=test$1[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),FORCED$h=FAILS_ON_UNDEFINED||!FAILS_ON_NULL||!STRICT_METHOD$9||!STABLE_SORT$1,getSortCompare$1=function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:toString$q(t)>toString$q(r)?1:-1}};$$1f({target:"Array",proto:!0,forced:FORCED$h},{sort:function(e){void 0!==e&&aCallable$b(e);var t=toObject$g(this);if(STABLE_SORT$1)return void 0===e?un$Sort$1(t):un$Sort$1(t,e);var r,n,i=[],o=lengthOfArrayLike$f(t);for(n=0;n<o;n++)n in t&&push$b(i,t[n]);for(internalSort$1(i,getSortCompare$1(e)),r=i.length,n=0;n<r;)t[n]=i[n++];for(;n<o;)delete t[n++];return t}});var XG_DEBUG_OPEN="undefined"!=typeof window&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,STYLE={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},XGTAG="%c[xgplayer]",XG_DEBUG={config:{debug:XG_DEBUG_OPEN?3:1},logInfo:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=3&&(t=console).log.apply(t,[XGTAG,STYLE.info,e].concat(n))},logWarn:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=1&&(t=console).warn.apply(t,[XGTAG,STYLE.warn,e].concat(n))},logError:function(e){var t;if(!(this.config.debug<1)){for(var r=this.config.debug>=2?"trace":"error",n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console)[r].apply(t,[XGTAG,STYLE.error,e].concat(i))}}};function bindDebug(e){e.logInfo=XG_DEBUG.logInfo.bind(e),e.logWarn=XG_DEBUG.logWarn.bind(e),e.logError=XG_DEBUG.logError.bind(e)}var XgplayerTimeRange=function(){function e(t){_classCallCheck$2(this,e),this.bufferedList=t}return _createClass$2(e,[{key:"start",value:function(e){return this.bufferedList[e].start}},{key:"end",value:function(e){return this.bufferedList[e].end}},{key:"length",get:function(){return this.bufferedList.length}}]),e}(),util$2={};function checkIsIn(e,t){for(var r=0,n=t.length;r<n;r++)if(e.indexOf(t[r])>-1)return!0;return!1}util$2.createDom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach((function(t){var n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)})),i},util$2.createDomFromHtml=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var n=document.createElement("div");n.innerHTML=e;var i=n.children;return n=null,i.length>0?(i=i[0],r&&util$2.addClass(i,r),t&&Object.keys(t).forEach((function(e){i.setAttribute(e,t[e])})),i):null}catch(o){return XG_DEBUG.logError("util.createDomFromHtml",o),null}},util$2.hasClass=function(t,r){if(!t||!r)return!1;try{return Array.prototype.some.call(t.classList,(function(e){return e===r}))}catch(e){var n=t.className&&"object"===_typeof$2(t.className)?t.getAttribute("class"):t.className;return n&&!!n.match(new RegExp("(\\s|^)"+r+"(\\s|$)"))}},util$2.addClass=function(t,r){if(t&&r)try{r.trim().split(/\s+/g).forEach((function(e){e&&t.classList.add(e)}))}catch(e){util$2.hasClass(t,r)||(t.className&&"object"===_typeof$2(t.className)?t.setAttribute("class",t.getAttribute("class")+" "+r):t.className+=" "+r)}},util$2.removeClass=function(t,r){if(t&&r)try{r.trim().split(/\s+/g).forEach((function(e){e&&t.classList.remove(e)}))}catch(e){util$2.hasClass(t,r)&&r.split(/\s+/g).forEach((function(e){var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className&&"object"===_typeof$2(t.className)?t.setAttribute("class",t.getAttribute("class").replace(r," ")):t.className=t.className.replace(r," ")}))}},util$2.toggleClass=function(e,t){e&&t.split(/\s+/g).forEach((function(t){util$2.hasClass(e,t)?util$2.removeClass(e,t):util$2.addClass(e,t)}))},util$2.classNames=function(){for(var e=arguments,t=[],r=function(r){"String"===util$2.typeOf(e[r])?t.push(e[r]):"Object"===util$2.typeOf(e[r])&&Object.keys(e[r]).map((function(n){e[r][n]&&t.push(n)}))},n=0;n<arguments.length;n++)r(n);return t.join(" ")},util$2.findDom=function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1?arguments[1]:void 0;try{t=r.querySelector(n)}catch(e){XG_DEBUG.logError("util.findDom",e),0===n.indexOf("#")&&(t=r.getElementById(n.slice(1)))}return t},util$2.getCss=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,!1)[t]},util$2.padStart=function(e,t,r){for(var n=String(r),i=t>>0,o=Math.ceil(i/n.length),a=[],s=String(e);o--;)a.push(n);return a.join("").substring(0,i-s.length)+s},util$2.format=function(e){if(window.isNaN(e))return"";e=Math.round(e);var t=util$2.padStart(Math.floor(e/3600),2,0),r=util$2.padStart(Math.floor((e-3600*t)/60),2,0),n=util$2.padStart(Math.floor(e-3600*t-60*r),2,0);return("00"===t?[r,n]:[t,r,n]).join(":")},util$2.event=function(e){if(e.touches){var t=e.touches[0]||e.changedTouches[0];e.clientX=t.clientX||0,e.clientY=t.clientY||0,e.offsetX=t.pageX-t.target.offsetLeft,e.offsetY=t.pageY-t.target.offsetTop}e._target=e.target||e.srcElement},util$2.typeOf=function(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]},util$2.deepCopy=function(e,t){if("Object"===util$2.typeOf(t)&&"Object"===util$2.typeOf(e))return Object.keys(t).forEach((function(r){"Object"!==util$2.typeOf(t[r])||t[r]instanceof Node?"Array"===util$2.typeOf(t[r])?e[r]="Array"===util$2.typeOf(e[r])?e[r].concat(t[r]):t[r]:e[r]=t[r]:void 0===e[r]||void 0===e[r]?e[r]=t[r]:util$2.deepCopy(e[r],t[r])})),e},util$2.deepMerge=function(e,t){return Object.keys(t).map((function(r){var n;"Array"===util$2.typeOf(t[r])&&"Array"===util$2.typeOf(e[r])?"Array"===util$2.typeOf(e[r])&&(n=e[r]).push.apply(n,_toConsumableArray$1(t[r])):util$2.typeOf(e[r])!==util$2.typeOf(t[r])||null===e[r]||"Object"!==util$2.typeOf(e[r])||t[r]instanceof window.Node?null!==t[r]&&(e[r]=t[r]):util$2.deepMerge(e[r],t[r])})),e},util$2.getBgImage=function(e){var t=(e.currentStyle||window.getComputedStyle(e,null)).backgroundImage;if(!t||"none"===t)return"";var r=document.createElement("a");return r.href=t.replace(/url\("|"\)/g,""),r.href},util$2.copyDom=function(e){if(e&&1===e.nodeType){var t=document.createElement(e.tagName);return Array.prototype.forEach.call(e.attributes,(function(e){t.setAttribute(e.name,e.value)})),e.innerHTML&&(t.innerHTML=e.innerHTML),t}return""},util$2.setInterval=function(e,t,r,n){e._interval[t]||(e._interval[t]=setInterval(r.bind(e),n))},util$2.clearInterval=function(e,t){clearInterval(e._interval[t]),e._interval[t]=null},util$2.setTimeout=function(e,t,r){e._timers||(e._timers=[]);var n=setTimeout((function(){t(),util$2.clearTimeout(e,n)}),r);return e._timers.push(n),n},util$2.clearTimeout=function(e,t){var r=e._timers;if("Array"===util$2.typeOf(r)){for(var n=0;n<r.length;n++)if(r[n]===t){r.splice(n,1),clearTimeout(t);break}}else clearTimeout(t)},util$2.clearAllTimers=function(e){var t=e._timers;"Array"===util$2.typeOf(t)&&(t.map((function(e){clearTimeout(e)})),e._timerIds=[])},util$2.createImgBtn=function(e,t,r,n){var i,o,a,s=util$2.createDom("xg-".concat(e),"",{},"xgplayer-".concat(e,"-img"));(s.style.backgroundImage='url("'.concat(t,'")'),r&&n)&&(["px","rem","em","pt","dp","vw","vh","vm","%"].every((function(e){return!(r.indexOf(e)>-1&&n.indexOf(e)>-1)||(i=parseFloat(r.slice(0,r.indexOf(e)).trim()),o=parseFloat(n.slice(0,n.indexOf(e)).trim()),a=e,!1)})),s.style.width="".concat(i).concat(a),s.style.height="".concat(o).concat(a),s.style.backgroundSize="".concat(i).concat(a," ").concat(o).concat(a),s.style.margin="start"===e?"-".concat(o/2).concat(a," auto auto -").concat(i/2).concat(a):"auto 5px auto 5px");return s},util$2.Hex2RGBA=function(e,t){var r=[];if(/^\#[0-9A-F]{3}$/i.test(e)){var n="#";e.replace(/[0-9A-F]/gi,(function(e){n+=e+e})),e=n}return/^#[0-9A-F]{6}$/i.test(e)?(e.replace(/[0-9A-F]{2}/gi,(function(e){r.push(parseInt(e,16))})),"rgba(".concat(r.join(","),", ").concat(t,")")):"rgba(255, 255, 255, 0.1)"},util$2.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},util$2.checkIsFunction=function(e){return e&&"function"==typeof e},util$2.checkIsObject=function(e){return null!==e&&"object"===_typeof$2(e)},util$2.hide=function(e){e.style.display="none"},util$2.show=function(e,t){e.style.display=t||"block"},util$2.isUndefined=function(e){if(null==e)return!0},util$2.setStyleFromCsstext=function(e,t){t&&("String"===util$2.typeOf(t)?t.replace(/\s+/g,"").split(";").map((function(t){if(t){var r=t.split(":");r.length>1&&(e.style[r[0]]=r[1])}})):Object.keys(t).map((function(r){e.style[r]=t[r]})))},util$2.filterStyleFromText=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],r=e.style.cssText;if(!r)return{};var n=r.replace(/\s+/g,"").split(";"),i={},o={};return n.map((function(e){if(e){var r=e.split(":");r.length>1&&(checkIsIn(r[0],t)?i[r[0]]=r[1]:o[r[0]]=r[1])}})),e.setAttribute("style",""),Object.keys(o).map((function(t){e.style[t]=o[t]})),i},util$2.getStyleFromCsstext=function(e){var t=e.style.cssText;if(!t)return{};var r=t.replace(/\s+/g,"").split(";"),n={};return r.map((function(e){if(e){var t=e.split(":");t.length>1&&(n[t[0]]=t[1])}})),n},util$2.preloadImg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e){var n=new window.Image;n.complete?t&&t():(n.onload=function(e){n=null,t&&t(e)},n.onerror=function(e){n=null,r&&r(e)}),n.src=e}},util$2.stopPropagation=function(e){e&&(e.stopPropagation(),e.cancelable&&e.preventDefault())},util$2.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},util$2.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},util$2.checkTouchSupport=function(){return"ontouchstart"in window},util$2.getBuffered2=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=[],n=0;n<e.length;n++)r.push({start:e.start(n)<.5?0:e.start(n),end:e.end(n)});r.sort((function(e,t){var r=e.start-t.start;return r||t.end-e.end}));var i=[];if(t)for(var o=0;o<r.length;o++){var a=i.length;if(a){var s=i[a-1].end;r[o].start-s<t?r[o].end>s&&(i[a-1].end=r[o].end):i.push(r[o])}else i.push(r[o])}else i=r;return new XgplayerTimeRange(i)},util$2.getEventPos=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{x:e.x/t,y:e.y/t,clientX:e.clientX/t,clientY:e.clientY/t,offsetX:e.offsetX/t,offsetY:e.offsetY/t,pageX:e.pageX/t,pageY:e.pageY/t}},util$2.requestAnimationFrame=function(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(t)return t(e)},util$2.getHostFromUrl=function(e){if(null==e||""===e||"string"!=typeof e)return"";var t=e.split("/"),r="";return t.length>3&&t[2]&&(r=t[2]),r},util$2.cancelAnimationFrame=function(e){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;t&&t(e)};var VERSION_REG={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},H264_MIMETYPES=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],sniffer={get device(){return sniffer.os.isPc?"pc":"mobile"},get browser(){if("undefined"==typeof navigator)return"";var e=navigator.userAgent.toLowerCase(),t={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(t).filter((function(r){return t[r].test(e)})))[0]},get os(){if("undefined"==typeof navigator)return{};var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e),a=/(?:iPhone)/.test(e)&&!o,s=!(a||n||r||o),u=/(?:iPad|PlayBook)/.test(e);return{isTablet:o,isPhone:a,isIpad:u,isIos:a||u,isAndroid:n,isPc:s,isSymbian:r,isWindowsPhone:t,isFireFox:i}},get osVersion(){var e=navigator.userAgent,t="",r=(t=/(?:iPhone)|(?:iPad|PlayBook)/.test(e)?VERSION_REG.ios:VERSION_REG.android)?t.exec(e):[];if(r&&r.length>=3){var n=r[2].split(".");return n.length>0?parseInt(n[0]):0}return 0},get isWeixin(){if("undefined"==typeof navigator)return!1;return!!/(micromessenger)\/([\d.]+)/.exec(navigator.userAgent.toLocaleLowerCase())||void 0},isSupportMP4:function(){if(this.supportResult)return this.supportResult;var e=document.createElement("video"),t={isSupport:!1,mime:""};return"function"==typeof e.canPlayType&&H264_MIMETYPES.map((function(r){"probably"===e.canPlayType('video/mp4; codecs="'.concat(r,'"'))&&(t.isSupport=!0,t.mime+="||".concat(r))})),this.supportResult=t,e=null,t}},version$3="3.0.0-next.28",ERROR_TYPE_MAP={1:"network",2:"network",3:"decoder",4:"format"},Errors$2=_createClass$2((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};_classCallCheck$2(this,e);var n=t&&t.i18n?t.i18n.ERROR_TYPES:null;if(t.video){var i=r.mediaError?r.mediaError:t.video.error||{},o=t.duration,a=t.currentTime,s=t.ended,u=t.src,c=t.currentSrc,l=t.video,d=l.readyState,f=l.networkState,h={playerVersion:version$3,currentTime:a,duration:o,ended:s,readyState:d,networkState:f,src:u||c,errorType:r.errorType,errorCode:r.errorCode||i.code,message:r.errorMessage||i.message,mediaError:i,originError:r.originError?r.originError.stack:""};return r.ext&&Object.keys(r.ext).map((function(e){h[e]=r.ext[e]})),h}if(arguments.length>1){for(var p={playerVersion:version$3,domain:document.domain},g=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],y=0;y<arguments.length;y++)p[g[y]]=arguments[y];return p.ex=n?(n[arguments[0]]||{}).msg:"",p}})),PLAY="play",PLAYING="playing",ENDED="ended",PAUSE="pause",ERROR$2="error",SEEKING="seeking",SEEKED="seeked",TIME_UPDATE="timeupdate",WAITING="waiting",CANPLAY="canplay",CANPLAY_THROUGH="canplaythrough",DURATION_CHANGE="durationchange",VOLUME_CHANGE="volumechange",LOADED_DATA="loadeddata",RATE_CHANGE="ratechange",PROGRESS="progress",LOAD_START="loadstart",EMPTIED="emptied",STALLED="stalled",SUSPEND="suspend",ABORT="abort",BUFFER_CHANGE="bufferedChange",PLAYER_FOCUS="focus",PLAYER_BLUR="blur",READY="ready",URL_NULL="urlNull",AUTOPLAY_STARTED="autoplay_started",AUTOPLAY_PREVENTED="autoplay_was_prevented",COMPLETE="complete",REPLAY="replay",DESTROY="destroy",URL_CHANGE="urlchange",FULLSCREEN_CHANGE="fullscreen_change",CSS_FULLSCREEN_CHANGE="cssFullscreen_change",MINI_STATE_CHANGE="mini_state_change",DEFINITION_CHANGE="definition_change",BEFORE_DEFINITION_CHANGE="before_definition_change",AFTER_DEFINITION_CHANGE="after_definition_change",SEI_PARSED="SEI_PARSED",RETRY="retry",VIDEO_RESIZE="video_resize",PIP_CHANGE="pip_change",ROTATE="rotate",SCREEN_SHOT="screenShot",PLAYNEXT="playnext",SHORTCUT="shortcut",XGLOG="xglog",USER_ACTION="user_action",USER_ACTION1="user_action1",VIDEO_EVENTS=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","ratechange","progress","loadstart","emptied","stalled","suspend","abort"],STATS_EVENTS$2={STATS_INFO:"stats_info",STATS_DOWNLOAD:"stats_download",STATS_RESET:"stats_reset"},Events$1=Object.freeze(Object.defineProperty({__proto__:null,ABORT:ABORT,AFTER_DEFINITION_CHANGE:AFTER_DEFINITION_CHANGE,AUTOPLAY_PREVENTED:AUTOPLAY_PREVENTED,AUTOPLAY_STARTED:AUTOPLAY_STARTED,BEFORE_DEFINITION_CHANGE:BEFORE_DEFINITION_CHANGE,BUFFER_CHANGE:BUFFER_CHANGE,CANPLAY:CANPLAY,CANPLAY_THROUGH:CANPLAY_THROUGH,COMPLETE:COMPLETE,CSS_FULLSCREEN_CHANGE:CSS_FULLSCREEN_CHANGE,DEFINITION_CHANGE:DEFINITION_CHANGE,DESTROY:DESTROY,DURATION_CHANGE:DURATION_CHANGE,EMPTIED:EMPTIED,ENDED:ENDED,ERROR:ERROR$2,FULLSCREEN_CHANGE:FULLSCREEN_CHANGE,LOADED_DATA:LOADED_DATA,LOAD_START:LOAD_START,MINI_STATE_CHANGE:MINI_STATE_CHANGE,PAUSE:PAUSE,PIP_CHANGE:PIP_CHANGE,PLAY:PLAY,PLAYER_BLUR:PLAYER_BLUR,PLAYER_FOCUS:PLAYER_FOCUS,PLAYING:PLAYING,PLAYNEXT:PLAYNEXT,PROGRESS:PROGRESS,RATE_CHANGE:RATE_CHANGE,READY:READY,REPLAY:REPLAY,RETRY:RETRY,ROTATE:ROTATE,SCREEN_SHOT:SCREEN_SHOT,SEEKED:SEEKED,SEEKING:SEEKING,SEI_PARSED:SEI_PARSED,SHORTCUT:SHORTCUT,STALLED:STALLED,STATS_EVENTS:STATS_EVENTS$2,SUSPEND:SUSPEND,TIME_UPDATE:TIME_UPDATE,URL_CHANGE:URL_CHANGE,URL_NULL:URL_NULL,USER_ACTION:USER_ACTION,USER_ACTION1:USER_ACTION1,VIDEO_EVENTS:VIDEO_EVENTS,VIDEO_RESIZE:VIDEO_RESIZE,VOLUME_CHANGE:VOLUME_CHANGE,WAITING:WAITING,XGLOG:XGLOG},Symbol.toStringTag,{value:"Module"}));function emitVideoEvent(e,t){this&&this.emit&&("error"===e?this.errorHandler(e):this.emit(e,t))}function getVideoEventHandler(e,t){return function(r){var n={player:t,eventName:e,originalEvent:r,detail:r.detail||{},timeStamp:r.timeStamp,currentTime:t.currentTime,duration:t.duration,paused:t.paused,ended:t.ended,isInternalOp:!!t._internalOp[r.type],muted:t.muted,volume:t.volume,host:util$2.getHostFromUrl(t.currentSrc),vtype:t.vtype};if(t.removeInnerOP(r.type),"timeupdate"===e&&(t._currentTime=t.video&&t.video.currentTime),"durationchange"===e&&(t._duration=t.video.duration),"volumechange"===e&&(n.isMutedChange=t._lastMuted!==t.muted,t._lastMuted=t.muted),t.videoEventMiddleware[e])try{t.videoEventMiddleware[e].call(t,n,emitVideoEvent.bind(t))}catch(i){throw emitVideoEvent.call(t,e,n),i}else emitVideoEvent.call(t,e,n)}}var VideoProxy=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;_classCallCheck$2(this,r),(n=t.call(this,e))._hasStart=!1,n._currentTime=0,n._duration=0,n._internalOp={},n._lastMuted=!1,n.vtype="MP4",n.videoConfig=Object.assign({},{controls:!1,autoplay:e.autoplay,playsinline:e.playsinline,"x5-playsinline":e.playsinline,"webkit-playsinline":e.playsinline,"x5-video-player-fullscreen":e["x5-video-player-fullscreen"]||e.x5VideoPlayerFullscreen,"x5-video-orientation":e["x5-video-orientation"]||e.x5VideoOrientation,airplay:e.airplay,"webkit-airplay":e.airplay,tabindex:2,mediaType:e.mediaType||"video"},e.videoConfig,e.videoAttributes);var i=e["x5-video-player-type"]||e.x5VideoPlayerType;return sniffer.isWeixin&&sniffer.os.isAndroid&&i&&(n.videoConfig["x5-video-player-type"]=i,delete n.videoConfig.playsinline,delete n.videoConfig["webkit-playsinline"],delete n.videoConfig["x5-playsinline"]),e.loop&&(n.videoConfig.loop="loop"),n.video=util$2.createDom(n.videoConfig.mediaType,"",n.videoConfig,""),e.defaultPlaybackRate&&(n.video.defaultPlaybackRate=n.video.playbackRate=e.defaultPlaybackRate),"Number"===util$2.typeOf(e.volume)&&(n.volume=e.volume),e.autoplayMuted&&(n.video.muted=!0,n._lastMuted=!0),e.autoplay&&(n.video.autoplay=!0),n._interval={},n.videoEventMiddleware={},n.attachVideoEvents(),n}return _createClass$2(r,[{key:"setEventsMiddleware",value:function(e){var t=this;Object.keys(e).map((function(r){t.videoEventMiddleware[r]=e[r]}))}},{key:"removeEventsMiddleware",value:function(e){var t=this;Object.keys(e).map((function(e){delete t.videoEventMiddleware[e]}))}},{key:"attachVideoEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.video;this._evHandlers||(this._evHandlers=VIDEO_EVENTS.map((function(t){var r="on".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));return"function"==typeof e[r]&&e.on(t,e[r]),_defineProperty$2({},t,getVideoEventHandler(t,e))}))),this._evHandlers.forEach((function(e){var r=Object.keys(e)[0];t.addEventListener(r,e[r],!1)}))}},{key:"detachVideoEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.video;this._evHandlers.forEach((function(e){var r=Object.keys(e)[0];t.removeEventListener(r,e[r],!1)})),this._evHandlers.forEach((function(t){var r=Object.keys(t)[0],n="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));"function"==typeof e[n]&&e.off(r,e[n])})),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,t){var r=this;e.removeAttribute("src"),t.forEach((function(e){r.video.appendChild(util$2.createDom("source","",{src:"".concat(e.src),type:"".concat(e.type||"")}))}));var n=e.children;if(n){this._videoSourceCount=n.length,!this._sourceError&&(this._sourceError=function(e){r._videoSourceCount--,0===r._videoSourceCount&&(r.videoEventMiddleware.error?r.videoEventMiddleware.error.call(r,e,(function(){r.errorHandler("error")})):r.errorHandler("error",{code:4,message:"sources load error"}))});for(var i=0;i<n.length;i++)n[i].addEventListener("error",this._sourceError)}}},{key:"_detachSourceEvents",value:function(e){var t=e.children;if(t&&0!==t.length&&this._sourceError){for(var r=0;r<t.length;r++)t[r].removeEventListener("error",this._sourceError);for(;t.length>0;)e.removeChild(t[0])}}},{key:"errorHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.video&&(this.video.error||t)){var r=this.video.error||t,n=r.code?ERROR_TYPE_MAP[r.code]:"other";r.message;this.video.currentSrc||(r={code:6,message:"empty_src"}),this.emit(e,new Errors$2(this,{errorType:n,errorCode:r.code,errorMessage:r.message||"",mediaError:r}))}}},{key:"destroy",value:function(){for(var e in this.video&&(this.video.pause&&(this.video.pause(),this.video.muted=!0),this.video.removeAttribute("src"),this.video.load()),this._currentTime=0,this._duration=0,this.videoConfig=null,this._interval)clearInterval(this._interval[e]),this._interval[e]=null;this.detachVideoEvents(),this.video=null,this.videoEventMiddleware={},this.removeAllListeners()}},{key:"play",value:function(){return this.video?this.video.play():null}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"canPlayType",value:function(e){return!!this.video&&this.video.canPlayType(e)}},{key:"getBufferedRange",value:function(e){var t=[0,0];if(!this.video)return t;e||(e=this.video.buffered);var r=this.video.currentTime;if(e)for(var n=0,i=e.length;n<i&&(t[0]=e.start(n),t[1]=e.end(n),!(t[0]<=r&&r<=t[1]));n++);return t[0]-r<=0&&r-t[1]<=0?t:[0,0]}},{key:"autoplay",get:function(){return!!this.video&&this.video.autoplay},set:function(e){this.video&&(this.video.autoplay=e)}},{key:"buffered",get:function(){return this.video?this.video.buffered:null}},{key:"buffered2",get:function(){return this.video?util$2.getBuffered2(this.video.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.video)return e;var t=this.video.buffered;if(!t||0===t.length)return e;for(var r=0;r<t.length;r++)if((t.start(r)<=this.currentTime||t.start(r)<.1)&&t.end(r)>=this.currentTime)return{start:t.start(r),end:t.end(r)};return e}},{key:"crossOrigin",get:function(){return this.video?this.video.crossOrigin:""},set:function(e){this.video&&(this.video.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.video?this.video.currentSrc:""},set:function(e){this.video&&(this.video.currentSrc=e)}},{key:"currentTime",get:function(){return this.video?void 0!==this.video.currentTime?this.video.currentTime:this._currentTime:0},set:function(e){this.video&&(this.video.currentTime=e)}},{key:"defaultMuted",get:function(){return!!this.video&&this.video.defaultMuted},set:function(e){this.video&&(this.video.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return!!this.video&&this.video.ended}},{key:"error",get:function(){return this.video.error}},{key:"errorNote",get:function(){if(!this.video.error)return"";return["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"][this.video.error.code-1]}},{key:"loop",get:function(){return!!this.video&&this.video.loop},set:function(e){this.video&&(this.video.loop=e)}},{key:"muted",get:function(){return!!this.video&&this.video.muted},set:function(e){this.video&&this.video.muted!==e&&(this._lastMuted=this.video.muted,this.video.muted=e)}},{key:"networkState",get:function(){return this.video.networkState}},{key:"paused",get:function(){return!this.video||this.video.paused}},{key:"playbackRate",get:function(){return this.video?this.video.playbackRate:0},set:function(e){this.video&&e!==1/0&&(this.video.playbackRate=e)}},{key:"played",get:function(){return this.video?this.video.played:null}},{key:"preload",get:function(){return!!this.video&&this.video.preload},set:function(e){this.video&&(this.video.preload=e)}},{key:"readyState",get:function(){return this.video.readyState}},{key:"seekable",get:function(){return!!this.video&&this.video.seekable}},{key:"seeking",get:function(){return!!this.video&&this.video.seeking}},{key:"src",get:function(){return this.video?this.video.src:""},set:function(e){this.video&&(this.emit(URL_CHANGE,e),this.emit(WAITING),this._currentTime=0,this._duration=0,/^blob/.test(this.video.currentSrc)||/^blob/.test(this.video.src)?this.onWaiting():(this._detachSourceEvents(this.video),"Array"===util$2.typeOf(e)?this._attachSourceEvents(this.video,e):this.video.src=e,this.load()))}},{key:"volume",get:function(){return this.video?this.video.volume:0},set:function(e){e!==1/0&&this.video&&(this.video.volume=e)}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,t){for(var n,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];(n=_get$1(_getPrototypeOf$1(r.prototype),"emit",this)).call.apply(n,[this,e,t].concat(o))}},{key:"on",value:function(e,t){for(var n,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];(n=_get$1(_getPrototypeOf$1(r.prototype),"on",this)).call.apply(n,[this,e,t].concat(o))}},{key:"once",value:function(e,t){for(var n,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];(n=_get$1(_getPrototypeOf$1(r.prototype),"once",this)).call.apply(n,[this,e,t].concat(o))}},{key:"off",value:function(e,t){for(var n,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];(n=_get$1(_getPrototypeOf$1(r.prototype),"off",this)).call.apply(n,[this,e,t].concat(o))}},{key:"offAll",value:function(){_get$1(_getPrototypeOf$1(r.prototype),"removeAllListeners",this).call(this)}}]),r}(EventEmitter$1),INDEXDB=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};_classCallCheck$2(this,e),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=t}return _createClass$2(e,[{key:"openDB",value:function(e){var t=this,r=this,n=this.myDB.version||1,i=r.indexedDB.open(r.myDB.name,n);i.onerror=function(e){},i.onsuccess=function(n){t.myDB.db=n.target.result,e.call(r)},i.onupgradeneeded=function(e){var t=e.target.result;e.target.transaction,t.objectStoreNames.contains(r.myDB.ojstore.name)||t.createObjectStore(r.myDB.ojstore.name,{keyPath:r.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){this.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(e,t){for(var r,n=this.myDB.db.transaction(e,"readwrite").objectStore(e),i=0;i<t.length;i++)(r=n.add(t[i])).onerror=function(){},r.onsuccess=function(){}}},{key:"putData",value:function(e,t){for(var r,n=this.myDB.db.transaction(e,"readwrite").objectStore(e),i=0;i<t.length;i++)(r=n.put(t[i])).onerror=function(){},r.onsuccess=function(){}}},{key:"getDataByKey",value:function(e,t,r){var n=this,i=this.myDB.db.transaction(e,"readwrite").objectStore(e).get(t);i.onerror=function(){r.call(n,null)},i.onsuccess=function(e){var t=e.target.result;r.call(n,t)}}},{key:"deleteData",value:function(e,t){this.myDB.db.transaction(e,"readwrite").objectStore(e).delete(t)}},{key:"clearData",value:function(e){this.myDB.db.transaction(e,"readwrite").objectStore(e).clear()}}]),e}(),FULLSCREEN_EVENTS=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],GET_FULLSCREEN_API=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],EXIT_FULLSCREEN_API=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"];function callHandler(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var a=t.call.apply(t,[e].concat(i));r&&"function"==typeof r&&(a&&a.then?a.then((function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];r.call.apply(r,[e].concat(n))})):r.call.apply(r,[e].concat(i)))}function hook(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[t]&&(this.__hooks[t]=null),function(){var i=arguments,o=this;if(n.pre)try{var a;(a=n.pre).call.apply(a,[this].concat(Array.prototype.slice.call(arguments)))}catch(e){throw e.message="[pluginName: ".concat(this.pluginName,":").concat(t,":pre error] >> ").concat(e.message),e}if(this.__hooks&&this.__hooks[t])try{var s,u=(s=this.__hooks[t]).call.apply(s,[this,this].concat(Array.prototype.slice.call(arguments)));u?u.then?u.then((function(e){!1!==e&&callHandler.apply(void 0,[o,r,n.next].concat(_toConsumableArray$1(i)))})).catch((function(e){throw e})):callHandler.apply(void 0,[this,r,n.next].concat(Array.prototype.slice.call(arguments))):void 0===u&&callHandler.apply(void 0,[this,r,n.next].concat(Array.prototype.slice.call(arguments)))}catch(e){throw e.message="[pluginName: ".concat(this.pluginName,":").concat(t,"] >> ").concat(e.message),e}else callHandler.apply(void 0,[this,r,n.next].concat(Array.prototype.slice.call(arguments)))}.bind(this)}function useHooks(e,t){var r=this.__hooks;if(r)return r.hasOwnProperty(e)?(r&&(r[e]=t),!0):(console.warn("has no supported hook which name [".concat(e,"]")),!1)}function usePluginHooks(e){if(this.plugins&&this.plugins[e.toLowerCase()]){for(var t=this.plugins[e.toLowerCase()],r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.useHooks&&t.useHooks.apply(t,n)}}function hooksDescriptor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.__hooks={},t&&t.map((function(t){e.__hooks[t]=null})),Object.defineProperty(e,"hooks",{get:function(){return e.__hooks&&Object.keys(e.__hooks).map((function(t){if(e.__hooks[t])return t}))}})}function delHooksDescriptor(e){e.__hooks=null}function runHooks(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];if(!e.__hooks||!e.__hooks[t])return r.call.apply(r,[e,e].concat(i));var a,s=(a=e.__hooks[t]).call.apply(a,[e,e].concat(i));if(s&&s.then)s.then((function(t){return!1===t?null:r.call.apply(r,[e,e].concat(i))})).catch((function(e){console.warn("[runHooks]".concat(t," reject"),e.message)}));else if(!1!==s)return r.call.apply(r,[e,e].concat(i))}function showErrorMsg(e,t){XG_DEBUG.logError("[".concat(e,"] event or callback cant be undefined or null when call ").concat(t))}var BasePlugin=function(){function e(t){_classCallCheck$2(this,e),util$2.checkIsFunction(this.beforeCreate)&&this.beforeCreate(t),hooksDescriptor(this),this.__args=t,this.__events={},this.config=t.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(t)}return _createClass$2(e,[{key:"beforeCreate",value:function(e){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(e){this.player=e.player,this.playerConfig=e.player&&e.player.config,this.pluginName=e.pluginName?e.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=e.player&&e.player.logger}},{key:"updateLang",value:function(e){e||(e=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var e=util$2.checkTouchSupport()?"touch":"mouse";return!this.playerConfig||"touch"!==this.playerConfig.domEventType&&"mouse"!==this.playerConfig.domEventType||(e=this.playerConfig.domEventType),e}},{key:"on",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(this.__events[e]=t,this.player.on(e,t)):Array.isArray(e)&&e.forEach((function(e){r.__events[e]=t,r.player.on(e,t)})):showErrorMsg(this.pluginName,"plugin.on(event, callback)")}},{key:"once",value:function(e,t){e&&t&&this.player?this.player.once(e,t):showErrorMsg(this.pluginName,"plugin.once(event, callback)")}},{key:"off",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(delete this.__events[e],this.player.off(e,t)):Array.isArray(e)&&e.forEach((function(n){delete r.__events[e],r.player.off(n,t)})):showErrorMsg(this.pluginName,"plugin.off(event, callback)")}},{key:"offAll",value:function(){var e=this;Object.keys(this.__events).map((function(t){e.__events[t]&&e.off(t,e.__events[t]),t&&delete e.__events[t]})),this.__events={}}},{key:"emit",value:function(e){var t;if(this.player){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this.player).emit.apply(t,[e].concat(n))}}},{key:"emitUserAction",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=_objectSpread2(_objectSpread2({},r),{},{pluginName:this.pluginName});this.player.emitUserAction(e,t,n)}},{key:"hook",value:function(e,t){return hook.call.apply(hook,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return useHooks.call.apply(useHooks,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(this.player)return r&&(t.pluginName=r),this.player.registerPlugin({plugin:e,options:t})}},{key:"getPlugin",value:function(e){return this.player?this.player.getPlugin(e):null}},{key:"__destroy",value:function(){var e=this,t=this.player,r=this.pluginName;this.offAll(),util$2.clearAllTimers(this),util$2.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map((function(t){e[t]=null})),t.unRegisterPlugin(r),delHooksDescriptor(this)}}],[{key:"defineGetterOrSetter",value:function(e,t){for(var r in t)Object.defineProperty(e,r,t[r])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),e}(),DOCUMENT_NODE_TYPE=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector}function closest$2(e,t){for(;e&&e.nodeType!==DOCUMENT_NODE_TYPE;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}var closest_1=closest$2,closest$1=closest_1;function _delegate(e,t,r,n,i){var o=listener$1.apply(this,arguments);return e.addEventListener(r,o,i),{destroy:function(){e.removeEventListener(r,o,i)}}}function delegate(e,t,r,n,i){return"function"==typeof e.addEventListener?_delegate.apply(null,arguments):"function"==typeof r?_delegate.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return _delegate(e,t,r,n,i)})))}function listener$1(e,t,r,n){return function(r){r.delegateTarget=closest$1(r.target,t),r.delegateTarget&&n.call(e,r)}}var delegate_1=delegate,ROOT_TYPES={CONTROLS:"controls",ROOT:"root"},POSITIONS$8={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"};function isUrl(e){return!!e&&(e.indexOf&&/^(?:http|data:|\/)/.test(e))}function mergeIconClass(e,t){return"object"===_typeof$2(e)&&e.class&&"string"==typeof e.class?"".concat(t," ").concat(e.class):t}function mergeIconAttr(e,t){return"object"===_typeof$2(e)&&e.attr&&"object"===_typeof$2(e.attr)&&Object.keys(e.attr).map((function(r){t[r]=e.attr[r]})),t}function createIcon(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=null;if(t instanceof window.Element)return util$2.addClass(t,n),Object.keys(i).map((function(e){t.setAttribute(e,i[e])})),t;if(isUrl(t)||isUrl(t.url))return i.src=isUrl(t)?t:t.url||"",a=util$2.createDom(t.tag||"img","",i,"xg-img ".concat(n));if("function"==typeof t)try{return(a=t())instanceof window.Element?(util$2.addClass(a,n),Object.keys(i).map((function(e){a.setAttribute(e,i[e])})),a):(XG_DEBUG.logWarn("warn>>icons.".concat(r," in config of plugin named [").concat(o,"] is a function mast return an Element Object")),null)}catch(e){return XG_DEBUG.logError("Plugin named [".concat(o,"]:createIcon"),e),null}return"string"==typeof t?util$2.createDomFromHtml(t,i,n):(XG_DEBUG.logWarn("warn>>icons.".concat(r," in config of plugin named [").concat(o,"] is invalid")),null)}function registerIconsObj(e,t){var r=t.config.icons||t.playerConfig.icons;Object.keys(e).map((function(n){var i=e[n],o=i&&i.class?i.class:"",a=i&&i.attr?i.attr:{},s=null;r&&r[n]&&(o=mergeIconClass(r[n],o),a=mergeIconAttr(r[n],a),s=createIcon(r[n],n,o,a,t.pluginName)),!s&&i&&(s=createIcon(i.icon?i.icon:i,a,o,{},t.pluginName)),t.icons[n]=s}))}function registerTextObj(e,t){Object.keys(e).map((function(r){Object.defineProperty(t.langText,r,{get:function(){var n=t.lang,i=t.i18n;return i[r]?i[r]:e[r]&&e[r][n]||""}})}))}var Plugin=function(t){_inherits$1(n,t);var r=_createSuper$q(n);function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck$2(this,n),(e=r.call(this,t)).__delegates=[],e}return _createClass$2(n,[{key:"__init",value:function(t){if(_get$1(_getPrototypeOf$1(n.prototype),"__init",this).call(this,t),t.root){var r=t.root,i=null;this.icons={},this.root=null,this.parent=null,registerIconsObj(this.registerIcons()||{},this),this.langText={},registerTextObj(this.registerLanguageTexts()||{},this);var o="";try{o=this.render()}catch(e){throw XG_DEBUG.logError("Plugin:".concat(this.pluginName,":render"),e),new Error("Plugin:".concat(this.pluginName,":render:").concat(e.message))}if(o)(i=n.insert(o,r,t.index)).setAttribute("data-index",t.index);else{if(!t.tag)return;(i=util$2.createDom(t.tag,"",t.attr,t.name)).setAttribute("data-index",t.index),r.appendChild(i)}this.root=i,this.parent=r;var a=this.config.attr||{},s=this.config.style||{};this.setAttr(a),this.setStyle(s),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var t=this.children();t&&"object"===_typeof$2(t)&&Object.keys(t).length>0&&Object.keys(t).map((function(r){var n,i,o=r,a=t[o],s={root:e.root};"function"==typeof a?(n=e.config[o]||{},i=a):"object"===_typeof$2(a)&&"function"==typeof a.plugin&&(n=a.options?util$2.deepCopy(e.config[o]||{},a.options):e.config[o]||{},i=a.plugin),s.config=n,void 0!==n.index&&(s.index=n.index),n.root&&(s.root=n.root),e.registerPlugin(i,s,o)}))}}},{key:"updateLang",value:function(e){e||(e=this.lang);var t=this.root,r=this.i18n,n=this.langText;t&&function e(t,r){for(var n=0;n<t.children.length;n++)t.children[n].children.length>0?e(t.children[n],r):r(t.children[n])}(t,(function(t){var i=t.getAttribute&&t.getAttribute("lang-key");if(i){var o=r[i.toUpperCase()]||n[i];o&&(t.innerHTML="function"==typeof o?o(e):o)}}))}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.i18n||{},n=this.langText;e.setAttribute&&e.setAttribute("lang-key",t);var i=r[t]||n[t]||"";i&&(e.innerHTML=i)}},{key:"plugins",value:function(){return this._children}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.root=t.root||this.root;var i=_get$1(_getPrototypeOf$1(n.prototype),"registerPlugin",this).call(this,e,t,r);return this._children.push(i),i}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,t,r){var i=this;if(arguments.length<3&&"function"==typeof t)Array.isArray(e)?e.forEach((function(e){i.bindEL(e,t)})):this.bindEL(e,t);else{var o=n.delegate.call(this,this.root,e,t,r);this.__delegates=this.__delegates.concat(o)}}},{key:"unbind",value:function(e,t){var r=this;if(arguments.length<3&&"function"==typeof t)Array.isArray(e)?e.forEach((function(e){r.unbindEL(e,t)})):this.unbindEL(e,t);else for(var n="".concat(e,"_").concat(t),i=0;i<this.__delegates.length;i++)if(this.__delegates[i].key===n){this.__delegates[i].destroy(),this.__delegates.splice(i,1);break}}},{key:"setStyle",value:function(e,t){var r=this;if(this.root)return"String"===util$2.typeOf(e)?this.root.style[e]=t:void("Object"===util$2.typeOf(e)&&Object.keys(e).map((function(t){r.root.style[t]=e[t]})))}},{key:"setAttr",value:function(e,t){var r=this;if(this.root)return"String"===util$2.typeOf(e)?this.root.setAttribute(e,t):void("Object"===util$2.typeOf(e)&&Object.keys(e).map((function(t){r.root.setAttribute(t,e[t])})))}},{key:"setHtml",value:function(e,t){this.root&&(this.root.innerHTML=e,"function"==typeof t&&t())}},{key:"bindEL",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.root&&"on".concat(e)in this.root&&"function"==typeof t&&this.root.addEventListener(e,t,r)}},{key:"unbindEL",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.root&&"on".concat(e)in this.root&&"function"==typeof t&&this.root.removeEventListener(e,t,r)}},{key:"show",value:function(e){if(this.root)return this.root.style.display=void 0!==e?e:"block","none"===window.getComputedStyle(this.root,null).getPropertyValue("display")?this.root.style.display="block":void 0}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,t){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!(t&&t instanceof window.Element))return null;try{return"string"==typeof e?this.find(e).appendChild(t):e.appendChild(t)}catch(r){return XG_DEBUG.logError("Plugin:appendChild",r),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,t=this.player;this.__delegates.map((function(e){e.destroy()})),this.__delegates=[],this._children instanceof Array&&(this._children.map((function(e){t.unRegisterPlugin(e.pluginName)})),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),_get$1(_getPrototypeOf$1(n.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map((function(t){e[t]=null}))}}],[{key:"insert",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.children.length,i=Number(r),o=e instanceof window.Node;if(n){for(var a=0,s=null,u="";a<n;a++){s=t.children[a];var c=Number(s.getAttribute("data-index"));if(c>=i){u="beforebegin";break}c<i&&(u="afterend")}return o?"afterend"===u?t.appendChild(e):t.insertBefore(e,s):s.insertAdjacentHTML(u,e),"afterend"===u?t.children[t.children.length-1]:t.children[a]}return o?t.appendChild(e):t.insertAdjacentHTML("beforeend",e),t.children[t.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[];if(e instanceof window.Node&&"function"==typeof n)if(Array.isArray(r))r.forEach((function(r){var a=delegate_1(e,t,r,n,i);a.key="".concat(t,"_").concat(r),o.push(a)}));else{var a=delegate_1(e,t,r,n,i);a.key="".concat(t,"_").concat(r),o.push(a)}return o}},{key:"ROOT_TYPES",get:function(){return ROOT_TYPES}},{key:"POSITIONS",get:function(){return POSITIONS$8}}]),n}(BasePlugin),fails$X=fails$1m,correctPrototypeGetter=!fails$X((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),global$13=global$1T,hasOwn$q=hasOwnProperty_1$1,isCallable$x=isCallable$Q,toObject$f=toObject$o,sharedKey$5=sharedKey$8,CORRECT_PROTOTYPE_GETTER$1=correctPrototypeGetter,IE_PROTO$1=sharedKey$5("IE_PROTO"),Object$1=global$13.Object,ObjectPrototype$5=Object$1.prototype,objectGetPrototypeOf=CORRECT_PROTOTYPE_GETTER$1?Object$1.getPrototypeOf:function(e){var t=toObject$f(e);if(hasOwn$q(t,IE_PROTO$1))return t[IE_PROTO$1];var r=t.constructor;return isCallable$x(r)&&t instanceof r?r.prototype:t instanceof Object$1?ObjectPrototype$5:null},fails$W=fails$1m,isCallable$w=isCallable$Q,getPrototypeOf$3=objectGetPrototypeOf,redefine$8=redefine$h.exports,wellKnownSymbol$u=wellKnownSymbol$O,ITERATOR$c=wellKnownSymbol$u("iterator"),BUGGY_SAFARI_ITERATORS$1=!1,IteratorPrototype$2,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=getPrototypeOf$3(getPrototypeOf$3(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype$2=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS$1=!0);var NEW_ITERATOR_PROTOTYPE=null==IteratorPrototype$2||fails$W((function(){var e={};return IteratorPrototype$2[ITERATOR$c].call(e)!==e}));NEW_ITERATOR_PROTOTYPE&&(IteratorPrototype$2={}),isCallable$w(IteratorPrototype$2[ITERATOR$c])||redefine$8(IteratorPrototype$2,ITERATOR$c,(function(){return this}));var iteratorsCore={IteratorPrototype:IteratorPrototype$2,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS$1},IteratorPrototype$1=iteratorsCore.IteratorPrototype,create$6=objectCreate$1,createPropertyDescriptor$8=createPropertyDescriptor$d,setToStringTag$9=setToStringTag$b,Iterators$4=iterators$1,returnThis$1=function(){return this},createIteratorConstructor$2=function(e,t,r,n){var i=t+" Iterator";return e.prototype=create$6(IteratorPrototype$1,{next:createPropertyDescriptor$8(+!n,r)}),setToStringTag$9(e,i,!1),Iterators$4[i]=returnThis$1,e},$$1e=_export$1,call$u=functionCall$1,FunctionName$1=functionName$1,isCallable$v=isCallable$Q,createIteratorConstructor$1=createIteratorConstructor$2,getPrototypeOf$2=objectGetPrototypeOf,setPrototypeOf$5=objectSetPrototypeOf$1,setToStringTag$8=setToStringTag$b,createNonEnumerableProperty$a=createNonEnumerableProperty$j,redefine$7=redefine$h.exports,wellKnownSymbol$t=wellKnownSymbol$O,Iterators$3=iterators$1,IteratorsCore=iteratorsCore,PROPER_FUNCTION_NAME$3=FunctionName$1.PROPER,CONFIGURABLE_FUNCTION_NAME$2=FunctionName$1.CONFIGURABLE,IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$b=wellKnownSymbol$t("iterator"),KEYS="keys",VALUES="values",ENTRIES$1="entries",returnThis=function(){return this},defineIterator$3=function(e,t,r,n,i,o,a){createIteratorConstructor$1(r,t,n);var s,u,c,l=function(e){if(e===i&&g)return g;if(!BUGGY_SAFARI_ITERATORS&&e in h)return h[e];switch(e){case KEYS:case VALUES:case ENTRIES$1:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[ITERATOR$b]||h["@@iterator"]||i&&h[i],g=!BUGGY_SAFARI_ITERATORS&&p||l(i),y="Array"==t&&h.entries||p;if(y&&(s=getPrototypeOf$2(y.call(new e)))!==Object.prototype&&s.next&&(getPrototypeOf$2(s)!==IteratorPrototype&&(setPrototypeOf$5?setPrototypeOf$5(s,IteratorPrototype):isCallable$v(s[ITERATOR$b])||redefine$7(s,ITERATOR$b,returnThis)),setToStringTag$8(s,d,!0)),PROPER_FUNCTION_NAME$3&&i==VALUES&&p&&p.name!==VALUES&&(CONFIGURABLE_FUNCTION_NAME$2?createNonEnumerableProperty$a(h,"name",VALUES):(f=!0,g=function(){return call$u(p,this)})),i)if(u={values:l(VALUES),keys:o?g:l(KEYS),entries:l(ENTRIES$1)},a)for(c in u)(BUGGY_SAFARI_ITERATORS||f||!(c in h))&&redefine$7(h,c,u[c]);else $$1e({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS||f},u);return h[ITERATOR$b]!==g&&redefine$7(h,ITERATOR$b,g,{name:i}),Iterators$3[t]=g,u},toIndexedObject$h=toIndexedObject$o,addToUnscopables$2=addToUnscopables$4,Iterators$2=iterators$1,InternalStateModule$a=internalState$1,defineProperty$g=objectDefineProperty$1.f,defineIterator$2=defineIterator$3,DESCRIPTORS$v=descriptors$1,ARRAY_ITERATOR="Array Iterator",setInternalState$9=InternalStateModule$a.set,getInternalState$7=InternalStateModule$a.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator$2(Array,"Array",(function(e,t){setInternalState$9(this,{type:ARRAY_ITERATOR,target:toIndexedObject$h(e),index:0,kind:t})}),(function(){var e=getInternalState$7(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),values=Iterators$2.Arguments=Iterators$2.Array;if(addToUnscopables$2("keys"),addToUnscopables$2("values"),addToUnscopables$2("entries"),DESCRIPTORS$v&&"values"!==values.name)try{defineProperty$g(values,"name",{value:"values"})}catch(error){}var charAt$b=stringMultibyte$1.charAt,toString$p=toString$A,InternalStateModule$9=internalState$1,defineIterator$1=defineIterator$3,STRING_ITERATOR="String Iterator",setInternalState$8=InternalStateModule$9.set,getInternalState$6=InternalStateModule$9.getterFor(STRING_ITERATOR);defineIterator$1(String,"String",(function(e){setInternalState$8(this,{type:STRING_ITERATOR,string:toString$p(e),index:0})}),(function(){var e,t=getInternalState$6(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=charAt$b(r,n),t.index+=e.length,{value:e,done:!1})}));var global$12=global$1T,DOMIterables$1=domIterables$1,DOMTokenListPrototype$2=domTokenListPrototype$1,ArrayIteratorMethods=es_array_iterator,createNonEnumerableProperty$9=createNonEnumerableProperty$j,wellKnownSymbol$s=wellKnownSymbol$O,ITERATOR$a=wellKnownSymbol$s("iterator"),TO_STRING_TAG$4=wellKnownSymbol$s("toStringTag"),ArrayValues=ArrayIteratorMethods.values,handlePrototype$1=function(e,t){if(e){if(e[ITERATOR$a]!==ArrayValues)try{createNonEnumerableProperty$9(e,ITERATOR$a,ArrayValues)}catch(error){e[ITERATOR$a]=ArrayValues}if(e[TO_STRING_TAG$4]||createNonEnumerableProperty$9(e,TO_STRING_TAG$4,t),DOMIterables$1[t])for(var r in ArrayIteratorMethods)if(e[r]!==ArrayIteratorMethods[r])try{createNonEnumerableProperty$9(e,r,ArrayIteratorMethods[r])}catch(error){e[r]=ArrayIteratorMethods[r]}}};for(var COLLECTION_NAME$1 in DOMIterables$1)handlePrototype$1(global$12[COLLECTION_NAME$1]&&global$12[COLLECTION_NAME$1].prototype,COLLECTION_NAME$1);handlePrototype$1(DOMTokenListPrototype$2,"DOMTokenList");var ResizeObserver=function(){function t(){var r=this;if(_classCallCheck$2(this,t),this.__handlers=[],this.timeStamp=0,this.observer=null,window.ResizeObserver)try{this.observer=new window.ResizeObserver((function(e){var t=(new Date).getTime();t-r.timeStamp<100||(r.timeStamp=t,r.__trigger(e))})),this.timeStamp=(new Date).getTime()}catch(e){console.error(e)}}return _createClass$2(t,[{key:"addObserver",value:function(e,t){if(this.observer){this.observer&&this.observer.observe(e);for(var r=this.__handlers,n=-1,i=0;i<r.length;i++)r[i]&&e===r[i].target&&(n=i);n>-1?this.__handlers[n].handler=t:this.__handlers.push({target:e,handler:t})}}},{key:"unObserver",value:function(t){var r=-1;this.__handlers.map((function(e,n){t===e.target&&(r=n)}));try{this.observer&&this.observer.unobserve(t)}catch(e){}this.observer&&this.observer.unobserve(t),r>-1&&this.__handlers.splice(r,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(e){for(var t=this.__handlers,r=0;r<t.length;r++)if(t[r]&&e===t[r].target){try{t[r].handler(e)}catch(error){console.error(error)}return!0}return!1}},{key:"__trigger",value:function(e){for(var t=0;t<e.length;t++){if(this.__runHandler(e[t].target))break}}}]),t}(),resizeObserver=null;function addObserver(e,t){return resizeObserver||(resizeObserver=new ResizeObserver),resizeObserver.addObserver(e,t),resizeObserver}function unObserver(e,t){resizeObserver.unObserver(e,t)}var pluginsManager={init:function(e){var t=e._pluginInfoId;t||(t=(new Date).getTime(),e._pluginInfoId=t),this.pluginGroup||(this.pluginGroup={}),!e.config.closeResizeObserver&&addObserver(e.root,(function(){e.resize()})),0===Object.keys(this.pluginGroup).length&&(e.isUserActive=!0),this.pluginGroup[t]={_player:e,_originalOptions:e.config||{}}},checkPlayerRoot:function(e){if(this.pluginGroup){for(var t=Object.keys(this.pluginGroup),r=0;r<t.length;r++){var n=this.pluginGroup[t[r]]._player;if(n.root===e)return n}return null}return null},lazyRegister:function(e,t){var r=this,n=t.timeout||1500;return Promise.race([t.loader().then((function(t){var n;n=t&&t.__esModule?t.default:t,r.register(e,n,t.options)})),new Promise((function(e,t){setTimeout((function(){t(new Error("timeout"))}),n)}))])},register:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&t&&"function"==typeof t&&void 0!==t.prototype){var n=e._pluginInfoId;n&&this.pluginGroup&&this.pluginGroup[n]||(this.init(e),n=e._pluginInfoId),this.pluginGroup[n]._plugins||(this.pluginGroup[n]._plugins=[]);var i=this.pluginGroup[n]._plugins,o=this.pluginGroup[n]._originalOptions;r.player=this.pluginGroup[n]._player;var a=r.pluginName||t.pluginName;if(!a)throw new Error("The property pluginName is necessary");if(!t.isSupported||t.isSupported()){r.config||(r.config={});for(var s=Object.keys(o),u=0;u<s.length;u++)if(a.toLowerCase()===s[u].toLowerCase()){var c=o[s[u]];"Object"===util$2.typeOf(c)?r.config=Object.assign({},r.config,o[s[u]]):"Boolean"===util$2.typeOf(c)&&(r.config.disable=!c);break}t.defaultConfig&&Object.keys(t.defaultConfig).map((function(e){void 0===r.config[e]&&(r.config[e]=t.defaultConfig[e])})),r.root?"string"==typeof r.root&&(r.root=e[r.root]):r.root=e.root,r.index=r.config.index||0;try{i[a.toLowerCase()]&&(this.unRegister(n,a.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(a,"] exist, destroy the old instance")));var l=new t(r);return i[a.toLowerCase()]=l,i[a.toLowerCase()].func=t,l&&"function"==typeof l.afterCreate&&l.afterCreate(),l}catch(d){throw console.error(d),d}}else console.warn("not supported plugin [".concat(a,"]"))}},unRegister:function(t,r){t._pluginInfoId&&(t=t._pluginInfoId),r=r.toLowerCase();try{var n=this.pluginGroup[t]._plugins[r];n&&(n.pluginName&&n.__destroy(),delete this.pluginGroup[t]._plugins[r])}catch(e){console.error("[unRegister:".concat(r,"] cgid:[").concat(t,"] error"),e)}},deletePlugin:function(e,t){var r=e._pluginInfoId;r&&this.pluginGroup&&this.pluginGroup[r]&&this.pluginGroup[r]._plugins&&delete this.pluginGroup[r]._plugins[t]},getPlugins:function(e){var t=e._pluginInfoId;return t&&this.pluginGroup[t]?this.pluginGroup[t]._plugins:{}},findPlugin:function(e,t){var r=e._pluginInfoId;if(!this.pluginGroup||!r)return null;var n=t.toLowerCase();return this.pluginGroup[r]._plugins[n]},beforeInit:function(t){var r=this;function n(e){return e&&e.then?e:new Promise((function(e){e()}))}return new Promise((function(i){if(r.pluginGroup)return(t._loadingPlugins&&t._loadingPlugins.length?Promise.all(t._loadingPlugins):Promise.resolve()).then((function(){var o=t._pluginInfoId;if(r.pluginGroup[o]){for(var a=r.pluginGroup[o]._plugins,s=[],u=0,c=Object.keys(a);u<c.length;u++){var l=c[u];if(a[l]&&a[l].beforePlayerInit)try{var d=a[l].beforePlayerInit();s.push(n(d))}catch(e){throw s.push(n(null)),e}}Promise.all([].concat(s)).then((function(){i()})).catch((function(e){console.error(e),i()}))}else i()}))}))},afterInit:function(e){var t=e._pluginInfoId;if(this.pluginGroup&&t)for(var r=this.pluginGroup[t]._plugins,n=0,i=Object.keys(r);n<i.length;n++){var o=i[n];r[o]&&r[o].afterPlayerInit&&r[o].afterPlayerInit()}},setLang:function(e,t){var r=t._pluginInfoId;if(this.pluginGroup&&r){var n=this.pluginGroup[r]._plugins;Object.keys(n).map((function(t){if(n[t].updateLang)n[t].updateLang(e);else try{n[t].lang=e}catch(error){console.warn("".concat(t," setLang"))}}))}},reRender:function(e){var t=e._pluginInfoId;if(t){for(var r={},n=this.pluginGroup[t]._plugins,i=0,o=Object.keys(n);i<o.length;i++){var a=o[i];r[a]={plugin:n[a].func,options:n[a]._args},this.unRegister(t,a)}for(var s=0,u=Object.keys(r);s<u.length;s++){var c=u[s];this.register(t,c,r[c].plugin,r[c].options)}}},onPluginsReady:function(e){var t=e._pluginInfoId,r=this.pluginGroup[t]._plugins;t&&r&&Object.keys(r).map((function(e){r[e].onPluginsReady&&"function"==typeof r[e].onPluginsReady&&r[e].onPluginsReady()}))},setCurrentUserActive:function(e,t){if(this.pluginGroup&&this.pluginGroup[e]){if(!t)return this.pluginGroup[e]._player.isUserActive=t,e;for(var r=Object.keys(this.pluginGroup),n=0;n<r.length;n++){var i=this.pluginGroup[r[n]];if(i&&i._player){this.pluginGroup[r[n]]._player.isUserActive=!1;break}}return this.pluginGroup[e]._player.isUserActive=t,e}},getCurrentUseActiveId:function(){if(this.pluginGroup){for(var e=Object.keys(this.pluginGroup),t=0;t<e.length;t++){var r=this.pluginGroup[e[t]];if(r&&r._player&&r._player.isUserActive)return e[t]}return null}},destroy:function(e){var t=e._pluginInfoId;if(this.pluginGroup[t]){unObserver(e.root);for(var r=this.pluginGroup[t]._plugins,n=0,i=Object.keys(r);n<i.length;n++){var o=i[n];this.unRegister(t,o)}var a=e.isUseActive;if(delete this.pluginGroup[t],delete e._pluginInfoId,a){var s=Object.keys(this.pluginGroup);s.length>0&&this.setCurrentUserActive(s[s.length-1],!0)}}}},STATE_CLASS={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function getDefaultConfig$1(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!1,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!1,closeControlsBlur:!1,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},ignores:[],whitelist:[],inactive:3e3,lang:(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),controls:!0,marginControls:!1,fullscreenTarget:null,controlsList:[],screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],thumbnail:null,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var usePreset=function(e,t){var r,n,i,o=t.preset&&t.options?new t.preset(t.options,e.config):new t({},e.config),a=o.plugins,s=void 0===a?[]:a,u=o.ignores,c=void 0===u?[]:u,l=o.icons,d=void 0===l?{}:l,f=o.i18n,h=void 0===f?[]:f;e.config.plugins||(e.config.plugins=[]),e.config.ignores||(e.config.ignores=[]),(r=e.config.plugins).push.apply(r,_toConsumableArray$1(s)),(n=e.config.ignores).push.apply(n,_toConsumableArray$1(c)),Object.keys(d).map((function(t){e.config.icons[t]||(e.config.icons[t]=d[t])})),(i=e.config.i18n).push.apply(i,_toConsumableArray$1(h))},Controls=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"onMouseEnter",(function(t){var r=_assertThisInitialized$1(e).player;r.userTimer&&(util$2.clearTimeout(r,r.userTimer),clearTimeout(r.userTimer))})),_defineProperty$2(_assertThisInitialized$1(e),"onMouseLeave",(function(){_assertThisInitialized$1(e).player.focus()})),e}return _createClass$2(r,[{key:"beforeCreate",value:function(e){e.config.mode||"mobile"!==sniffer.device||(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,t=this.config,r=t.disable,n=t.height,i=t.mode;if(!r){"flex"===i&&this.player.addClass(STATE_CLASS.FLEX_CONTROLS);var o={height:"".concat(n,"px")};Object.keys(o).map((function(t){e.root.style[t]=o[t]})),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(MINI_STATE_CHANGE,(function(t){t?util$2.addClass(e.root,"mini-controls"):util$2.removeClass(e.root,"mini-controls")})),"mobile"!==sniffer.device&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&util$2.addClass(this.root,STATE_CLASS.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){util$2.removeClass(this.root,STATE_CLASS.CONTROLS_AUTOHIDE)}},{key:"show",value:function(){util$2.addClass(this.root,"show")}},{key:"hide",value:function(){util$2.removeClass(this.root,"show")}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.root){var i=e.defaultConfig||{};if(!t.root){var o=t.position?t.position:t.config&&t.config.position?t.config.position:i.position;switch(o){case POSITIONS$8.CONTROLS_LEFT:t.root=this.left;break;case POSITIONS$8.CONTROLS_RIGHT:t.root=this.right;break;case POSITIONS$8.CONTROLS_CENTER:t.root=this.center;break;case POSITIONS$8.CONTROLS:t.root=this.root;break;default:t.root=this.left}return _get$1(_getPrototypeOf$1(r.prototype),"registerPlugin",this).call(this,e,t,n)}}}},{key:"destroy",value:function(){"mobile"!==sniffer.device&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,t=e.mode,r=e.autoHide,n=e.initShow;if(!e.disable){var i=util$2.classNames({"xgplayer-controls":!0},{"flex-controls":"flex"===t},{"bottom-controls":"bottom"===t},_defineProperty$2({},STATE_CLASS.CONTROLS_AUTOHIDE,r),{"xgplayer-controls-initshow":n||!r});return'<xg-controls class="'.concat(i,'" unselectable="on" onselectstart="return false">\n    <xg-inner-controls class="xg-inner-controls xg-pos">\n      <xg-left-grid class="xg-left-grid">\n      </xg-left-grid>\n      <xg-center-grid class="xg-center-grid"></xg-center-grid>\n      <xg-right-grid class="xg-right-grid">\n      </xg-right-grid>\n    </xg-inner-controls>\n    </xg-controls>')}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),r}(Plugin),EN={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},XGI18nLang={},XGI18nTextKeys={},XGI18nLangKeys=[],XGI18nLangPreExtends={};function updateKeys(){Object.keys(XGI18nLang.en).map((function(e){XGI18nTextKeys[e]=e}))}function extend(e){("Array"!==util$2.typeOf(e)?Object.keys(e).map((function(t){return{LANG:"zh"===t?"zh-cn":t,TEXT:e[t]}})):e).map((function(e){XGI18nLang[e.LANG]?util$2.deepMerge(XGI18nLang[e.LANG]||{},e.TEXT||{}):XGI18nLangPreExtends[e.LANG]=e.TEXT})),updateKeys()}function use(e){var t=e.LANG,r=e.TEXT||{};XGI18nLang[t]||XGI18nLangKeys.push(t),XGI18nLang[t]?util$2.deepMerge(r,XGI18nLang[t]):XGI18nLang[t]=r,XGI18nLangPreExtends[t]&&(extend([{LANG:t,TEXT:XGI18nLangPreExtends[t]}]),delete XGI18nLangPreExtends[t]),"zh-cn"===t&&(XGI18nLang.zh=XGI18nLang["zh-cn"]),updateKeys()}use(EN);var I18N={get textKeys(){return XGI18nTextKeys},get langKeys(){return XGI18nLangKeys},get lang(){var e={};return XGI18nLangKeys.map((function(t){e[t]=XGI18nLang[t]})),e.zh=XGI18nLang["zh-cn"],e},extend:extend,use:use},STATES$1={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},STATE_ARRAY=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],PlAYER_HOOKS=["play","pause","replay","retry"],Player=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;_classCallCheck$2(this,r);var i=util$2.deepMerge(getDefaultConfig$1(),e);hooksDescriptor(_assertThisInitialized$1(n=t.call(this,i)),PlAYER_HOOKS),n.config=i,bindDebug(_assertThisInitialized$1(n));var o=n.constructor.defaultPreset;if(n.config.presets.length){var a=n.config.presets.indexOf("default");a>=0&&o&&(n.config.presets[a]=o)}else o&&n.config.presets.push(o);if(n.userTimer=null,n.waitTimer=null,n._state=STATES$1.INITIAL,n._isError=!1,n._hasStart=!1,n.isSeeking=!1,n.isCanplay=!1,n._runPending=!1,n.rotateDeg=0,n.isActive=!1,n.fullscreen=!1,n.cssfullscreen=!1,n.isRotateFullscreen=!1,n._fullscreenEl=null,n._cssfullscreenEl=null,n.curDefinition=null,n._orgCss="",n._fullScreenOffset=null,n._videoHeight=0,n._videoWidth=0,n._accPlayed={t:0,acc:0,loopAcc:0},n.innerContainer=null,n.controls=null,n.topBar=null,n.root=null,sniffer.os.isAndroid&&sniffer.osVersion>0&&sniffer.osVersion<6&&(n.config.autoplay=!1),n.database=new INDEXDB,n.isUserActive=!1,!n._initDOM())return console.error(new Error("can't find the dom which id is ".concat(n.config.id," or this.config.el does not exist"))),_possibleConstructorReturn$1(n);var s=n.config,u=s.definition,c=void 0===u?{}:u;if(!s.url&&c.list&&c.list.length>0){var l=c.list.find((function(e){return e.definition&&e.definition===c.defaultDefinition}));l||(c.defaultDefinition=c.list[0].definition,l=c.list[0]),n.config.url=l.url,n.curDefinition=l.definition}return n._bindEvents(),n._registerPresets(),n._registerPlugins(),pluginsManager.onPluginsReady(_assertThisInitialized$1(n)),n.setState(STATES$1.READY),n.emit(READY),n.onReady&&n.onReady(),(n.config.videoInit||n.config.autoplay)&&(!n.hasStart||n.state<STATES$1.ATTACHED)&&n.start(),n}return _createClass$2(r,[{key:"_initDOM",value:function(){var e=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var t=this.config.el;if(!t||1!==t.nodeType)return this.emit(ERROR$2,new Errors$2("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1;this.root=t}var r=pluginsManager.checkPlayerRoot(this.root);r&&(XG_DEBUG.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),r.destroy()),this._initBaseDoms();var n=this.constructor.XgVideoProxy;if(n&&this.videoConfig.mediaType===n.mediaType){var i=this.innerContainer||this.root;this.detachVideoEvents(this.video);var o=new n(i,this.config,this.videoConfig);this.attachVideoEvents(o),this.video=o}if(this.config.controls){var a=pluginsManager.register(this,Controls);this.controls=a}var s=this.config.isMobileSimulateMode?"mobile":sniffer.device;if(this.addClass("".concat(STATE_CLASS.DEFAULT," ").concat(STATE_CLASS.INACTIVE," xgplayer-").concat(s," ").concat(this.config.controls?"":STATE_CLASS.NO_CONTROLS)),this.config.autoplay?this.addClass(STATE_CLASS.ENTER):this.addClass(STATE_CLASS.NO_START),this.config.fluid){var u=this.config,c=u.width,l=u.height;"number"==typeof c&&"number"==typeof l||(c=600,l=337.5);var d={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(100*l/c,"%")};Object.keys(d).forEach((function(t){e.root.style[t]=d[t]}))}else["width","height"].forEach((function(t){e.config[t]&&("number"!=typeof e.config[t]?e.root.style[t]=e.config[t]:e.root.style[t]="".concat(e.config[t],"px"))}));return!0}},{key:"_initBaseDoms",value:function(){this.topBar=util$2.createDom("xg-bar","",{"data-index":-1},"xg-top-bar"),this.leftBar=util$2.createDom("xg-bar","",{"data-index":-1},"xg-left-bar"),this.rightBar=util$2.createDom("xg-bar","",{"data-index":-1},"xg-right-bar"),this.config.marginControls&&(this.innerContainer=util$2.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer)),this.config.topBarAutoHide&&util$2.addClass(this.topBar,STATE_CLASS.TOP_BAR_AUTOHIDE),this.root.appendChild(this.topBar),this.root.appendChild(this.leftBar),this.root.appendChild(this.rightBar)}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach((function(t){e.on(t,e["on"+t.charAt(0).toUpperCase()+t.slice(1)])})),this.onFullscreenChange=function(t,r){var n=util$2.getFullScreenEl();if(e._fullActionFrom?e._fullActionFrom="":e.emit(USER_ACTION,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]}),r||n&&(n===e._fullscreenEl||"VIDEO"===n.tagName))util$2.setTimeout(e,(function(){e.resize()}),100),!e.config.closeFocusVideoFocus&&e.video.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,n,STATE_CLASS.FULLSCREEN),e.emit(FULLSCREEN_CHANGE,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){util$2.setTimeout(e,(function(){e.resize()}),100);var i=e._fullScreenOffset;e.config.needFullscreenScroll?(window.scrollTo(i.left,i.top),util$2.setTimeout(e,(function(){e.fullscreen=!1,e._fullScreenOffset=null}),100)):(!e.config.closeFocusVideoFocus&&e.video.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen?e.removeClass(STATE_CLASS.FULLSCREEN):e.recoverFullStyle(e.root,e._fullscreenEl,STATE_CLASS.FULLSCREEN),e._fullscreenEl=null,e.emit(FULLSCREEN_CHANGE,!1)}},FULLSCREEN_EVENTS.forEach((function(t){document&&document.addEventListener(t,e.onFullscreenChange)})),this.__webkitbeginfullscreen=function(t){e._fullscreenEl=e.video,e.onFullscreenChange(t,!0)},this.__webkitendfullscreen=function(t){e.onFullscreenChange(t,!1)},sniffer.os.isIos&&(this.video.addEventListener("webkitbeginfullscreen",this.__webkitbeginfullscreen),this.video.addEventListener("webkitendfullscreen",this.__webkitendfullscreen)),this.once(LOADED_DATA,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.video.focus()},this.once(PLAY,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),FULLSCREEN_EVENTS.forEach((function(t){document.removeEventListener(t,e.onFullscreenChange)})),this.playFunc&&this.off(PLAY,this.playFunc),this.canPlayFunc&&this.off(CANPLAY,this.canPlayFunc),this.video.removeEventListener("webkitbeginfullscreen",this.__webkitbeginfullscreen),this.video.removeEventListener("webkitendfullscreen",this.__webkitendfullscreen)}},{key:"_startInit",value:function(e){var t=this;if(this.video&&(e&&""!==e&&("Array"!==util$2.typeOf(e)||0!==e.length)||(e="",this.emit(URL_NULL),XG_DEBUG.logWarn("config.url is null, please get url and run player._startInit(url)"),!this.config.nullUrlStart))){this.canPlayFunc=function(){if(t.config){var e=t.config,r=e.autoplay,n=e.startTime,i=e.defaultPlaybackRate;XG_DEBUG.logInfo("player","canPlayFunc",n),n&&(t.currentTime=n>t.duration?t.duration:n,t.config.startTime=0),1!==i&&(t.playbackRate=i),r&&t.videoPlay(),t.off(CANPLAY,t.canPlayFunc),t.removeClass(STATE_CLASS.ENTER)}},this._detachSourceEvents(this.video),"Array"===util$2.typeOf(e)?this._attachSourceEvents(this.video,e):this.video.src=e,"Number"===util$2.typeOf(this.config.volume)&&(this.volume=this.config.volume),this.loadeddataFunc&&this.once(LOADED_DATA,this.loadeddataFunc);var r=this.innerContainer?this.innerContainer:this.root;this.video instanceof window.Element&&!r.contains(this.video)&&r.insertBefore(this.video,r.firstChild);var n=this.video.readyState;XG_DEBUG.logInfo("_startInit readyState",n),this.config.autoplay&&(!/^blob/.test(this.video.currentSrc)&&!/^blob/.test(this.video.src)&&this.load(),(sniffer.os.isIpad||sniffer.os.isPhone)&&this.videoPlay()),n>=2?this.canPlayFunc():this.once(CANPLAY,this.canPlayFunc),(!this.hasStart||this.state<STATES$1.ATTACHED)&&pluginsManager.afterInit(this),this.hasStart=!0,this.setState(STATES$1.ATTACHED),util$2.setTimeout(this,(function(){t.emit(COMPLETE)}),0)}}},{key:"_registerPlugins",value:function(){var e=this;this._loadingPlugins=[];var t=this.config.ignores||[],r=this.config.plugins||[];(this.config.i18n||[]).forEach((function(e){I18N.use(e)}));var n=t.join("||").toLowerCase().split("||");r.forEach((function(t){try{var r=t.plugin?t.plugin.pluginName:t.pluginName;if(r&&n.indexOf(r.toLowerCase())>-1)return;if(t.lazy&&t.loader){var i=pluginsManager.lazyRegister(e,t);return void(t.forceBeforeInit&&(i.then((function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(i),1)})).catch((function(t){XG_DEBUG.logError("_registerPlugins:loadingPlugin",t),e._loadingPlugins.splice(e._loadingPlugins.indexOf(i),1)})),e._loadingPlugins.push(i)))}return e.registerPlugin(t)}catch(o){XG_DEBUG.logError("_registerPlugins:",o)}}))}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach((function(t){usePreset(e,t)}))}},{key:"registerPlugin",value:function(e,t){var r=null,n=null;e.plugin&&"function"==typeof e.plugin?(r=e.plugin,n=e.options):(r=e,n={}),t&&(n.config=t);for(var i=Object.keys(this.config),o=0;o<i.length;o++)if(r.pluginName.toLowerCase()===i[o].toLowerCase()){var a=this.config[i[o]];"Object"===util$2.typeOf(a)&&(a.root&&(n.root=a.root),a.position&&(n.position=a.position));break}var s=n.position?n.position:n.config&&n.config.position||r.defaultConfig&&r.defaultConfig.position,u=Plugin.POSITIONS;if(!n.root&&"string"==typeof s&&s.indexOf("controls")>-1)return this.controls&&this.controls.registerPlugin(r,n,r.pluginName);if(!n.root)switch(s){case u.ROOT_RIGHT:n.root=this.rightBar;break;case u.ROOT_LEFT:n.root=this.leftBar;break;case u.ROOT_TOP:n.root=this.topBar;break;default:n.root=this.innerContainer||this.root}return pluginsManager.register(this,r,n)}},{key:"deregister",value:function(e){"string"==typeof e?pluginsManager.unRegister(this,e):e instanceof BasePlugin&&pluginsManager.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){this.deregister(e)}},{key:"plugins",get:function(){return pluginsManager.getPlugins(this)}},{key:"getPlugin",value:function(e){var t=pluginsManager.findPlugin(this,e);return t&&t.pluginName?t:null}},{key:"addClass",value:function(e){this.root&&(util$2.hasClass(this.root,e)||util$2.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&util$2.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return util$2.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,t){this.root&&this.root.setAttribute(e,t)}},{key:"removeAttribute",value:function(e,t){this.root&&this.root.removeAttribute(e,t)}},{key:"start",value:function(e){var t=this;return this.hasStart||this.state>=STATES$1.ATTACHING?Promise.resolve():(this.hasStart=!0,this.setState(STATES$1.ATTACHING),pluginsManager.beforeInit(this).then((function(){if(t.config)return e||(e=t.url||t.config.url),t._startInit(e)})).catch((function(e){throw e.fileName="player",e.lineNumber="236",XG_DEBUG.logError("start:beforeInit:",e),e})))}},{key:"switchURL",value:function(e){var t=this,r=e;"Object"===util$2.typeOf(e)&&(r=e.url);var n=this.currentTime,i=this.paused;return this.src=r,new Promise((function(e){var r=function(){t.currentTime=n,i&&t.once("canplay",(function(){t.pause()})),e()};sniffer.os.isAndroid?t.once("timeupdate",(function(){r()})):t.once("canplay",(function(){r()})),t.play()}))}},{key:"load",value:function(){this.video&&this.video.load()}},{key:"videoPlay",value:function(){var e=this;if(this.hasStart||!(this.state<STATES$1.ATTACHED)){this.state<STATES$1.RUNNING&&(this.removeClass(STATE_CLASS.NO_START),!this.isCanplay&&this.addClass(STATE_CLASS.ENTER));var t=_get$1(_getPrototypeOf$1(r.prototype),"play",this).call(this);return void 0!==t&&t&&t.then?t.then((function(){e.removeClass(STATE_CLASS.NOT_ALLOW_AUTOPLAY),e.addClass(STATE_CLASS.PLAYING),e.state<STATES$1.RUNNING&&(XG_DEBUG.logInfo(">>>>playPromise.then"),e.setState(STATES$1.RUNNING),e.emit(AUTOPLAY_STARTED))})).catch((function(t){if(XG_DEBUG.logWarn(">>>>playPromise.catch",t.name),e.video&&e.video.error)return e.onError(),e.removeClass(STATE_CLASS.ENTER),void(e._isError=!0);"NotAllowedError"===t.name&&(e._errorTimer=util$2.setTimeout(e,(function(){e._errorTimer=null,e.emit(AUTOPLAY_PREVENTED),e.addClass(STATE_CLASS.NOT_ALLOW_AUTOPLAY),e.removeClass(STATE_CLASS.ENTER),e.pause(),e.setState(STATES$1.NOTALLOW)}),0))})):(XG_DEBUG.logWarn("video.play not return promise"),this.state<STATES$1.RUNNING&&(this.setState(STATES$1.RUNNING),this.removeClass(STATE_CLASS.NOT_ALLOW_AUTOPLAY),this.removeClass(STATE_CLASS.NO_START),this.removeClass(STATE_CLASS.ENTER),this.addClass(STATE_CLASS.PLAYING),this.emit(AUTOPLAY_STARTED))),t}this.removeClass(STATE_CLASS.NO_START),this.addClass(STATE_CLASS.ENTER);var n=this.start();n&&n.then((function(t){!e.config.autoplay&&e.videoPlay()}))}},{key:"videoPause",value:function(){_get$1(_getPrototypeOf$1(r.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;this.removeClass(STATE_CLASS.PAUSED),runHooks(this,"play",(function(){e.videoPlay()}))}},{key:"pause",value:function(){var e=this;runHooks(this,"pause",(function(){_get$1(_getPrototypeOf$1(r.prototype),"pause",e).call(e)}))}},{key:"seek",value:function(e,t){var r=this;if(this.video&&!isNaN(Number(e))){var n=this.config,i=n.isSeekedPlay,o=n.seekedStatus,a=t||(i?"play":o);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,this.once(CANPLAY,(function(){switch(r.removeClass(STATE_CLASS.ENTER),r.isSeeking=!1,a){case"play":r.play();break;case"pause":r.pause();break;default:!r.paused&&r.play()}})),this.state<STATES$1.RUNNING?(this.removeClass(STATE_CLASS.NO_START),this.addClass(STATE_CLASS.ENTER),this.currentTime=e,"play"===a&&this.play()):this.currentTime=e}}},{key:"changeDefinition",value:function(e,t){var r=this;if(this.emit(DEFINITION_CHANGE,{from:t,to:e}),this.curDefinition=e.definition,this.hasStart){var n=this.switchURL(e.url);n&&n.then?n.then((function(){r.emit(AFTER_DEFINITION_CHANGE,{from:t,to:e})})):this.emit(AFTER_DEFINITION_CHANGE,{from:t,to:e})}else this.config.url=e.url}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(LOADED_DATA,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,t=[STATE_CLASS.NOT_ALLOW_AUTOPLAY,STATE_CLASS.PLAYING,STATE_CLASS.NO_START,STATE_CLASS.PAUSED,STATE_CLASS.REPLAY,STATE_CLASS.ENTER,STATE_CLASS.ENDED,STATE_CLASS.ERROR,STATE_CLASS.LOADING];this.hasStart=!1,this.videoPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,t.forEach((function(t){e.removeClass(t)})),this.addClass(STATE_CLASS.ENTER),this.emit(EMPTIED)}},{key:"destroy",value:function(){var e=this,t=this.innerContainer,n=this.root,i=this.video;if(n&&i){if(this._hasStart=!1,this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.video),util$2.clearAllTimers(this),this.emit(DESTROY),pluginsManager.destroy(this),delHooksDescriptor(this),_get$1(_getPrototypeOf$1(r.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),t)for(var o=t.children,a=0;a<o.length;a++)t.removeChild(o[a]);!t&&i instanceof window.Node&&n.contains(i)&&n.removeChild(i),["topBar","leftBar","rightBar","innerContainer"].map((function(t){e[t]&&n.removeChild(e[t]),e[t]=null}));var s=n.className.split(" ");s.length>0?n.className=s.filter((function(e){return e.indexOf("xgplayer")<0})).join(" "):n.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach((function(t){e[t]=!1}))}}},{key:"replay",value:function(){var e=this;this.removeClass(STATE_CLASS.ENDED),this.currentTime=0,this.isSeeking=!1,runHooks(this,"replay",(function(){e.once(CANPLAY,(function(){var t=e.videoPlay();t&&t.catch&&t.catch((function(e){console.log(e)}))})),e.play(),e.emit(REPLAY),e.onPlay()}))}},{key:"retry",value:function(){var e=this;this.removeClass(STATE_CLASS.ERROR),this.addClass(STATE_CLASS.LOADING),runHooks(this,"retry",(function(){var t=e.currentTime;e.videoPause(),e.src=e.config.url,!e.config.isLive&&(e.currentTime=t),e.once(CANPLAY,(function(){e.videoPlay()}))}))}},{key:"changeFullStyle",value:function(e,t,r,n){e&&(n||(n=STATE_CLASS.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=util$2.filterStyleFromText(e)),util$2.addClass(e,r),t&&t!==e&&!this._orgPCss&&(this._orgPCss=util$2.filterStyleFromText(t),util$2.addClass(t,n)))}},{key:"recoverFullStyle",value:function(e,t,r,n){n||(n=STATE_CLASS.PARENT_FULLSCREEN),this._orgCss&&(util$2.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),util$2.removeClass(e,r),t&&t!==e&&this._orgPCss&&(util$2.setStyleFromCsstext(t,this._orgPCss),this._orgPCss="",util$2.removeClass(t,n))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget,t=this.root,r=this.video;e||(e=t),this._fullScreenOffset={top:util$2.scrollTop(),left:util$2.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var n=util$2.getFullScreenEl();if(n!==this._fullscreenEl)try{for(var i=0;i<GET_FULLSCREEN_API.length;i++){var o=GET_FULLSCREEN_API[i];if(e[o]){var a="webkitRequestFullscreen"===o?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[o]();return a&&a.then?a:Promise.resolve()}}return r.fullscreenEnabled||r.webkitSupportsFullscreen?(r.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch(s){return Promise.reject(new Error("call getFullscreen fail"))}else this.onFullscreenChange()}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),this._fullscreenEl||util$2.getFullScreenEl()){this.root;var t=this.video;this._fullActionFrom="exit";try{for(var r=0;r<EXIT_FULLSCREEN_API.length;r++){var n=EXIT_FULLSCREEN_API[r];if(document[n]){var i=document[n]();return i&&i.then?i:Promise.resolve()}}return t&&t.webkitSupportsFullscreen?(t.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch(o){return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var t=e?"".concat(STATE_CLASS.INNER_FULLSCREEN," ").concat(STATE_CLASS.CSS_FULLSCREEN):STATE_CLASS.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,t);var r=this.config.fullscreen,n=void 0===r?{}:r,i=!0===n.useCssFullscreen||"function"==typeof n.useCssFullscreen&&n.useCssFullscreen();i&&(this.fullscreen=!0,this.emit(FULLSCREEN_CHANGE,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(CSS_FULLSCREEN_CHANGE,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(STATE_CLASS.INNER_FULLSCREEN," ").concat(STATE_CLASS.CSS_FULLSCREEN):STATE_CLASS.CSS_FULLSCREEN;if(this.fullscreen){var t=this.config.fullscreen,r=void 0===t?{}:t;!0===r.useCssFullscreen||"function"==typeof r.useCssFullscreen&&r.useCssFullscreen()?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(FULLSCREEN_CHANGE,!1)):this.removeClass(e)}else this.recoverFullStyle(this.root,this._cssfullscreenEl,e);this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(CSS_FULLSCREEN_CHANGE,!1)}},{key:"getRotateFullscreen",value:function(e){this.cssfullscreen&&this.exitCssFullscreen(e);var t=e?"".concat(STATE_CLASS.INNER_FULLSCREEN," ").concat(STATE_CLASS.ROTATE_FULLSCREEN):STATE_CLASS.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,t,STATE_CLASS.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this.emit(FULLSCREEN_CHANGE,!0)}},{key:"exitRotateFullscreen",value:function(e){var t=this._fullscreenEl!==this.root?"".concat(STATE_CLASS.INNER_FULLSCREEN," ").concat(STATE_CLASS.ROTATE_FULLSCREEN):STATE_CLASS.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,t,STATE_CLASS.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(FULLSCREEN_CHANGE,!1)}},{key:"setRotateDeg",value:function(e){90===window.orientation||-90===window.orientation?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoHide:!this.config.closePlayerBlur,delay:this.config.inactive};this.isActive?this.onFocus(e):this.emit(PLAYER_FOCUS,_objectSpread2({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ignorePaused:!1};this.isActive?this.emit(PLAYER_BLUR,_objectSpread2({paused:this.paused,ended:this.ended},e)):this.onBlur(e)}},{key:"onFocus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.autoHide,n=void 0===r?!this.config.closePlayerBlur:r,i=t.delay,o=void 0===i?this.config.inactive:i;this.isActive=!0,this.removeClass(STATE_CLASS.INACTIVE),this.userTimer&&util$2.clearTimeout(this,this.userTimer),n&&(this.userTimer=util$2.setTimeout(this,(function(){e.blur()}),o))}},{key:"onBlur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ignorePaused,r=void 0!==t&&t;if(this.isActive){var n=this.config.closePauseVideoFocus;this.isActive=!1,(r||n||!this.paused&&!this.ended)&&this.addClass(STATE_CLASS.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.state>=STATES$1.RUNNING&&this.removeClass(STATE_CLASS.ENTER),this.removeClass(STATE_CLASS.LOADING),this.isCanplay=!0,this.waitTimer&&util$2.clearTimeout(this,this.waitTimer)}},{key:"onPlay",value:function(){this.state===STATES$1.ENDED&&this.setState(STATES$1.RUNNING),this.removeClass(STATE_CLASS.PAUSED),this.ended&&this.removeClass(STATE_CLASS.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(STATE_CLASS.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this.userTimer&&util$2.clearTimeout(this,this.userTimer),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(STATE_CLASS.ENDED),this.setState(STATES$1.ENDED)}},{key:"onError",value:function(){this._isError=!0,this.updateAcc("error"),this.removeClass(STATE_CLASS.NOT_ALLOW_AUTOPLAY),this.removeClass(STATE_CLASS.NO_START),this.removeClass(STATE_CLASS.ENTER),this.removeClass(STATE_CLASS.LOADING),this.addClass(STATE_CLASS.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(STATE_CLASS.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&util$2.clearTimeout(this,this.waitTimer),this.removeClass(STATE_CLASS.LOADING),this.removeClass(STATE_CLASS.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&util$2.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=util$2.setTimeout(this,(function(){e.addClass(STATE_CLASS.LOADING),util$2.clearTimeout(e,e.waitTimer),e.waitTimer=null}),200)}},{key:"onPlaying",value:function(){var e=this;[STATE_CLASS.NO_START,STATE_CLASS.PAUSED,STATE_CLASS.ENDED,STATE_CLASS.ERROR,STATE_CLASS.REPLAY,STATE_CLASS.LOADING].forEach((function(t){e.removeClass(t)}))}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.resize(),(this.waitTimer||this.hasClass(STATE_CLASS.LOADING))&&this.video.readyState>2&&(this.removeClass(STATE_CLASS.LOADING),util$2.clearTimeout(this,this.waitTimer),this.waitTimer=null),this._accPlayed.t||this.paused||this.ended||(this._accPlayed.t=(new Date).getTime())}},{key:"onVolumechange",value:function(){"Number"===util$2.typeOf(this.config.volume)&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,t,r){if(this.video&&t&&e){var n="String"===util$2.typeOf(e)?e:e.type||"";r.props&&"Array"!==util$2.typeOf(r.props)&&(r.props=[r.props]),this.emit(USER_ACTION,_objectSpread2({eventType:n,action:t,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},r))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var t=(new Date).getTime()-this._accPlayed.t;this._accPlayed.acc+=t,this._accPlayed.t=0,("ended"===e||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var t=this.video.buffered;if(!t||0===t.length||!this.duration)return!0;for(var r=e||this.video.currentTime||.2,n=t.length,i=0;i<n;i++)if(t.start(i)<=r&&t.end(i)>r)return!0;return!1}},{key:"position",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{h:0,y:0,x:0,w:0};if(this.video&&e&&e.h){var t=1/e.h,r=1!==t?"scale(".concat(t,")"):"",n=0,i=0;e.y&&(i=(100-100*e.h)/2-100*e.y),e.w&&e.x&&(n=(100-100*e.w)/2-100*e.x),r+=" translate(".concat(n,"%, ").concat(i,"%)"),this.video.style.transform=r,this.video.style.webkitTransform=r}}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.config[r]=e[r];var n=t.plugins[r.toLowerCase()];n&&"Function"===util$2.typeOf(n.setConfig)&&n.setConfig(e[r])}))}},{key:"playNext",value:function(e){this.resetState(),this.setConfig(e),this.play(),this.emit(PLAYNEXT,e)}},{key:"resize",value:function(){var e=this;if(this.video){var t=this.video,r=t.videoWidth,n=t.videoHeight,i=this.config,o=i.fitVideoSize,a=i.videoFillMode;if("fill"!==a&&"cover"!==a||this.setAttribute("data-xgfill",a),n&&r){this._videoHeight=n,this._videoWidth=r;var s=this.root.getBoundingClientRect(),u=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,c=s.width,l=s.height-u,d=parseInt(r/n*1e3,10),f=parseInt(c/l*1e3,10),h=c,p=l,g={};"auto"===o&&f>d||"fixWidth"===o?(p=c/d*1e3,this.config.fluid?g.paddingTop="".concat(100*p/h,"%"):g.height="".concat(p+u,"px")):("auto"===o&&f<d||"fixHeight"===o)&&(h=d*l/1e3,g.width="".concat(h,"px")),this.fullscreen||this.cssfullscreen||Object.keys(g).forEach((function(t){e.root.style[t]=g[t]})),("fillHeight"===a&&f<d||"fillWidth"===a&&f>d)&&this.setAttribute("data-xgfill","cover");var y={videoScale:d,vWidth:h,vHeight:p,cWidth:h,cHeight:p+u};this.emit(VIDEO_RESIZE,y)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.video.updateObjectPosition?this.video.updateObjectPosition(e,t):this.video.style.objectPosition="".concat(100*e,"% ").concat(100*t,"%")}},{key:"setState",value:function(e){XG_DEBUG.logInfo("setState","state from:".concat(STATE_ARRAY[this.state]," to:").concat(STATE_ARRAY[e])),this._state=e}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){"boolean"==typeof e&&(this._hasStart=e,!1===e&&(this._state=STATES$1.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===STATES$1.RUNNING||this._state===STATES$1.ENDED}},{key:"definitionList",get:function(){return this.config.definition.list||[]},set:function(e){var t=this,r=this.config.definition;r.list=e,this.emit("resourceReady",e);var n=null,i=null;e.forEach((function(e){t.curDefinition===e.definition&&(n=e),r.defaultDefinition===e.definition&&(i=e)})),!i&&e.length>0&&(i=e[0]),n?this.changeDefinition(n):i&&this.changeDefinition(i)}},{key:"lang",get:function(){return this.config.lang},set:function(e){0!==I18N.langKeys.filter((function(t){return t===e})).length||"zh"===e?(this.config.lang=e,pluginsManager.setLang(e,this)):console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(I18N.langKeys.join(),"] "))}},{key:"i18n",get:function(){var e=this.config.lang;return I18N.lang[e]||I18N.lang.en}},{key:"i18nKeys",get:function(){return I18N.textKeys||{}}},{key:"version",get:function(){return version$3}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){var e=_get$1(_getPrototypeOf$1(r.prototype),"readyState",this);return this.i18n[e]||e}},{key:"error",get:function(){var e=_get$1(_getPrototypeOf$1(r.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){var e=_get$1(_getPrototypeOf$1(r.prototype),"networkState",this);return this.i18n[e]||e}},{key:"fullscreenChanging",get:function(){return!(null===this._fullScreenOffset)}},{key:"cumulateTime",get:function(){var e=this._accPlayed;return this.updateAcc("get"),e.acc}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"hook",value:function(e,t){return hook.call.apply(hook,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){return useHooks.call.apply(useHooks,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return usePluginHooks.call.apply(usePluginHooks,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,t){"boolean"==typeof t&&t!==this.muted&&(this.addInnerOP("volumechange"),this.muted=t),pluginsManager.setCurrentUserActive(this.playerId,e)}}],[{key:"debugger",get:function(){return XG_DEBUG.config.debug},set:function(e){XG_DEBUG.config.debug=e}},{key:"getCurrentUserActivePlayerId",value:function(){return pluginsManager.getCurrentUseActiveId()}},{key:"setCurrentUserActive",value:function(e,t){pluginsManager.setCurrentUserActive(e,t)}},{key:"install",value:function(e,t){r.plugins||(r.plugins={}),r.plugins[e]||(r.plugins[e]=t)}},{key:"use",value:function(e,t){r.plugins||(r.plugins={}),r.plugins[e]=t}}]),r}(VideoProxy);function now$2(){return(new Date).getTime()}_defineProperty$2(Player,"defaultPreset",null),_defineProperty$2(Player,"XgVideoProxy",null);var Xglogger=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"_onTimeupdate",(function(){XG_DEBUG.logInfo("[xgLogger]Events._onTimeupdate"),e._state.isTimeUpdate=!0,e._sendFirstFrame()})),_defineProperty$2(_assertThisInitialized$1(e),"_onAutoplayStart",(function(){XG_DEBUG.logInfo("[xgLogger]Events._onAutoplayStart"),e._state.autoplayStart=!0,e._sendFirstFrame()})),_defineProperty$2(_assertThisInitialized$1(e),"_onReset",(function(){e.vt=0,e.pt=0,e.fvt=0,e._isSeeking=!1,e.seekingStart=0,e.waitingStart=0,e._isWaiting=!1,e._waitTimer&&util$2.clearTimeout(_assertThisInitialized$1(e),e._waitTimer),e._waittTimer&&util$2.clearTimeout(_assertThisInitialized$1(e),e._waittTimer),e._waitTimer=null,e._waittTimer=null,e._waitType=0})),_defineProperty$2(_assertThisInitialized$1(e),"_onSeeking",(function(){e.seekingStart||(e.suspendWaitingStatus("seek"),e.seekingStart=now$2(),e.emitLog("seekStart",{start:now$2()}))})),_defineProperty$2(_assertThisInitialized$1(e),"_onSeeked",(function(){e.suspendSeekingStatus("seeked")})),_defineProperty$2(_assertThisInitialized$1(e),"_onWaitingLoadStart",(function(){e._isWaiting||e.vt||(e._isWaiting=!0,e.waitingStart=now$2(),e._waitType=1,e.emitLog("waitingStart",{start:e.waitingStart,type:1,endType:"loadstart"}))})),_defineProperty$2(_assertThisInitialized$1(e),"_onWaiting",(function(){!e._isWaiting&&e.vt&&(e._isWaiting=!0,e._waitTimer=util$2.setTimeout(_assertThisInitialized$1(e),(function(){e._isWaiting&&(e.waitingStart=now$2(),util$2.clearTimeout(_assertThisInitialized$1(e),e._waitTimer),e._waitTimer=null,e.vt?e.seekingStart?e._waitType=2:e._waitType=0:e._waitType=1,e._startWaitTimeout(),e.emitLog("waitingStart",{start:e.waitingStart,type:e._waitType,endType:2===e._waitType?"seek":"playing"}))}),200))})),_defineProperty$2(_assertThisInitialized$1(e),"_onError",(function(){e.suspendSeekingStatus("error"),e.suspendWaitingStatus("error")})),_defineProperty$2(_assertThisInitialized$1(e),"_onPlaying",(function(){e._isWaiting&&e.suspendWaitingStatus("playing")})),e}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1},this._onReset(),this._waitType="firstFrame",this.on(LOAD_START,(function(){var t=e._state.autoplayStart;e._state.isTimeUpdate=!1,e._state.isFFLoading=!0,XG_DEBUG.logInfo("[xgLogger]Events.LOAD_START",t),e.pt=now$2(),e.vt=0,e.fvt=0,e.off(AUTOPLAY_STARTED,e._onAutoplayStart),e.off(TIME_UPDATE,e._onTimeupdate),e._onWaitingLoadStart(),t?e.once(TIME_UPDATE,e._onTimeupdate):e.once(AUTOPLAY_STARTED,e._onAutoplayStart)})),this.on(LOADED_DATA,(function(){e.vt=now$2(),e.fvt=e.vt-e.pt,XG_DEBUG.logInfo("[xgLogger]Events.LOADED_DATA",e.fvt,e._state.isTimeUpdate),e._state.isTimeUpdate&&e._sendFirstFrame(),e.suspendWaitingStatus("loadeddata")})),this.on(SEEKING,this._onSeeking),this.on(SEEKED,this._onSeeked),this.on(DESTROY,(function(){e.endState("destroy")})),this.on(URL_CHANGE,(function(){e.endState("urlChange"),e._onReset()})),this.on([PLAYING,CANPLAY],this._onPlaying),this.on(WAITING,this._onWaiting),this.on(ERROR$2,this._onError),this.on(EMPTIED,(function(){e.endState("emptied"),e._onReset()}))}},{key:"_sendFirstFrame",value:function(){this.s=now$2(),this.vt>0&&this._state.isFFLoading&&(XG_DEBUG.logInfo("[xgLogger]Events._sendFirstFrame",this.vt),this._state.isFFLoading=!1,this.emitLog("firstFrame",{fvt:this.fvt,costTime:this.fvt,vt:this.vt}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&util$2.clearTimeout(this,this._waittTimer),this._waittTimer=util$2.setTimeout(this,(function(){e.suspendWaitingStatus("timeout"),util$2.clearTimeout(e,e._waittTimer),e._waittTimer=null}),3e4)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var t=now$2(),r=t-this.seekingStart;this.seekingStart=0,this.emitLog("seekEnd",{end:t,costTime:r,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(util$2.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(util$2.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,this.waitingStart){var t=now$2()-this.waitingStart;this._isWaiting=!1,this.waitingStart=0,this.emitLog("waitingEnd",{costTime:t,type:this._waitType,endType:2===this._waitType?"seek":e})}}},{key:"emitLog",value:function(e,t){var r=this.player;this.emit(XGLOG,_objectSpread2({t:now$2(),host:util$2.getHostFromUrl(r.currentSrc),vtype:r.vtype,eventType:e,currentTime:this.player.currentTime,readyState:r.video.readyState,networkState:r.video.networkState},t))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{}}}]),r}(Plugin);function ReplaySvg(){return(new DOMParser).parseFromString('<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">\n  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Replay=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"registerIcons",value:function(){return{replay:ReplaySvg}}},{key:"afterCreate",value:function(){var e=this;Plugin.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",(function(){e.player.replay()}),{pre:function(e){e.preventDefault(),e.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(ENDED,(function(){if(e.playerConfig.loop||util$2.addClass(e.player.root,"replay"),!e.config.disable){e.show();var t=e.root.querySelector("path");if(t){var r=window.getComputedStyle(t).getPropertyValue("transform");if("string"==typeof r&&r.indexOf("none")>-1)return null;t.setAttribute("transform",r)}}})),this.on(PLAY,(function(){e.hide()}))}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),util$2.removeClass(this.player.root,"replay")}},{key:"show",value:function(){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return'<xg-replay class="xgplayer-replay">\n      <xg-replay-txt class="xgplayer-replay-txt" lang-key="'.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,"</xg-replay-txt>\n    </xg-replay>")}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),r}(Plugin),Poster=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(e){this.config.isEndedShow=e}},{key:"hide",value:function(){util$2.addClass(this.root,"hide")}},{key:"show",value:function(){util$2.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(e){"string"==typeof e.player.config.poster&&(e.config.poster=e.player.config.poster)}},{key:"afterCreate",value:function(){var e=this;this.on(ENDED,(function(){e.isEndedShow&&util$2.removeClass(e.root,"hide")})),this.config.hideCanplay?(this.once(TIME_UPDATE,(function(){e.onTimeUpdate()})),this.on(URL_CHANGE,(function(){util$2.removeClass(e.root,"hide"),util$2.addClass(e.root,"xg-showplay"),e.once(TIME_UPDATE,(function(){e.onTimeUpdate()}))}))):this.on(PLAY,(function(){util$2.addClass(e.root,"hide")}))}},{key:"onTimeUpdate",value:function(){var e=this;this.player.currentTime?util$2.removeClass(this.root,"xg-showplay"):this.once(TIME_UPDATE,(function(){e.onTimeUpdate()}))}},{key:"update",value:function(e){e&&(this.config.poster=e,this.root.style.backgroundImage="url(".concat(e,")"))}},{key:"render",value:function(){var e=this.config,t=e.poster,r=e.hideCanplay,n=t?"background-image:url(".concat(t,");"):"";return'<xg-poster class="xgplayer-poster '.concat(r?"xg-showplay":"",'" style="').concat(n,'">\n    </xg-poster>')}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,poster:""}}}]),r}(Plugin);function PlaySvg(){return(new DOMParser).parseFromString('<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>\n</svg>\n',"image/svg+xml").firstChild}function PauseSvg(){return(new DOMParser).parseFromString('<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>\n</svg>\n',"image/svg+xml").firstChild}var AnimateMap={};function addAnimate(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{start:null,end:null};AnimateMap[e]&&window.clearTimeout(AnimateMap[e].id),AnimateMap[e]={},r.start&&r.start(),AnimateMap[e].id=window.setTimeout((function(){r.end&&r.end(),window.clearTimeout(AnimateMap[e].id),delete AnimateMap[e]}),t)}function clearAnimation(){Object.keys(AnimateMap).map((function(e){window.clearTimeout(AnimateMap[e].id),delete AnimateMap[e]}))}var Start=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).autoPlayStart=!1,n}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this,t=this.player,r=this.playerConfig;this.initIcons(),this.once(READY,(function(){r&&(r.lang&&"en"===r.lang?util$2.addClass(t.root,"lang-is-en"):"jp"===r.lang&&util$2.addClass(t.root,"lang-is-jp"))})),this.on(AUTOPLAY_STARTED,(function(){var t="auto"===e.config.mode?"auto-hide":"hide";util$2.addClass(e.root,t),e.autoPlayStart=!0,e.onPlayPause("play")})),r.autoplay||this.show(),this.on(AUTOPLAY_PREVENTED,(function(){var t="auto"===e.config.mode?"auto-hide":"hide";e.setAttr("data-state","play"),util$2.removeClass(e.root,t),e.show()})),this.on(PLAY,(function(){e.onPlayPause("play")})),this.on(PAUSE,(function(){e.onPlayPause("pause")})),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(t){t.cancelable&&t.preventDefault(),t.stopPropagation();var r=e.player.paused;e.emitUserAction(t,"switch_play_pause",{props:"paused",from:r,to:!r})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"preventDefault",value:function(e){}},{key:"registerIcons",value:function(){return{startPlay:{icon:PlaySvg,class:"xg-icon-play"},startPause:{icon:PauseSvg,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){util$2.addClass(this.root,"hide")}},{key:"show",value:function(){util$2.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){util$2.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){util$2.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var t=this;addAnimate("pauseplay",400,{start:function(){util$2.addClass(t.root,"interact"),t.show(),t.switchStatus(!0)},end:function(){util$2.removeClass(t.root,"interact"),!e&&t.hide()}})}},{key:"switchPausePlay",value:function(e){var t=this.player;(e.cancelable&&e.preventDefault(),e.stopPropagation(),t.state<STATES$1.READY)||(this.player.paused||t.state!==STATES$1.RUNNING?t.play():t.pause())}},{key:"onPlayPause",value:function(e){var t=this.config,r=this.player;if(!(r.state<STATES$1.RUNNING)&&this.autoPlayStart){if("show"===t.mode)return this.switchStatus(),void this.show();if("auto"!==t.mode){if(t.isShowPause&&r.paused&&!r.ended||t.isShowEnd&&r.ended)return this.switchStatus(),void this.show();if(t.disableAnimate)return this.switchStatus(),void this.hide();if("play"===e)this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||r.ended)return;this.animate()}}else this.switchStatus()}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),clearAnimation()}},{key:"render",value:function(){var e=this.playerConfig.autoplay?"auto"===this.config.mode?"auto-hide":"hide":"";return'\n    <xg-start class="xgplayer-start '.concat(e,'">\n    <xg-start-inner></xg-start-inner>\n    </xg-start>')}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),r}(Plugin),Enter=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"render",value:function(){var e=this.config.innerHtml,t=util$2.createDom("xg-enter","",{},"xgplayer-enter");if(e&&e instanceof window.HTMLElement)t.appendChild(e);else if(e&&"string"==typeof e)t.innerHTML=e;else{for(var r="",n=1;n<=12;n++)r+='<div class="xgplayer-enter-bar'.concat(n,'"></div>');t.innerHTML='<div class="xgplayer-enter-spinner">'.concat(r,"</div>")}return t}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),r}(Plugin),MiniScreenIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return'\n      <xg-icon class="xgplayer-miniicon">\n      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="'.concat(this.i18nKeys[e],'">').concat(this.i18n[e],"</span></div>\n      </xg-icon>")}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:10}}}]),r}(Plugin);function getStyleSize(e){var t=parseFloat(e);return-1===e.indexOf("%")&&!isNaN(t)&&t}var measurements=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],measurementsLength=measurements.length;function getZeroSize(){for(var e={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},t=0;t<measurementsLength;t++){e[measurements[t]]=0}return e}function getStyle(e){return window.getComputedStyle(e)}function getSize(e){if("string"==typeof e&&(e=document.querySelector(e)),e&&"object"===_typeof$2(e)&&e.nodeType){var t=getStyle(e);if("none"===t.display)return getZeroSize();var r={};r.width=e.offsetWidth,r.height=e.offsetHeight;for(var n=r.isBorderBox="border-box"===t.boxSizing,i=0;i<measurementsLength;i++){var o=measurements[i],a=t[o],s=parseFloat(a);r[o]=isNaN(s)?0:s}var u=r.paddingLeft+r.paddingRight,c=r.paddingTop+r.paddingBottom,l=r.marginLeft+r.marginRight,d=r.marginTop+r.marginBottom,f=r.borderLeftWidth+r.borderRightWidth,h=r.borderTopWidth+r.borderBottomWidth,p=n,g=getStyleSize(t.width);!1!==g&&(r.width=g+(p?0:u+f));var y=getStyleSize(t.height);return!1!==y&&(r.height=y+(p?0:c+h)),r.innerWidth=r.width-(u+f),r.innerHeight=r.height-(c+h),r.outerWidth=r.width+l,r.outerHeight=r.height+d,r}}function getTouch$1(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.identifier===t)return n}}var EVENTS$1={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},POST_START_EVENTS={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},Draggabilly=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$2(this,r),(n=t.call(this)).isEnabled=!0,n.isDragging=!1,n.isDown=!1,n.position={},n.downPoint={},n.dragPoint={x:0,y:0},n.startPos={x:0,y:0},n._root=e instanceof Element?e:document.querySelector(e),n._handlerDom=i.handle instanceof Element?i.handle:document.querySelector(i.handle),n._root&&n._handlerDom?(n._bindStartEvent(),n):_possibleConstructorReturn$1(n)}return _createClass$2(r,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),POST_START_EVENTS[this._startKey].map((function(t){e["on".concat(t)]=e["on".concat(t)].bind(e)}))}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var t=this;if(e){var r=POST_START_EVENTS[this._startKey];r.map((function(e){window.addEventListener(e,t["on".concat(e)])})),this._boundPointerEvents=r}}},{key:"_unbindPostStartEvents",value:function(){var e=this;this._boundPointerEvents&&(this._boundPointerEvents.map((function(t){window.removeEventListener(t,e["on".concat(t)])})),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame((function(){e.animate()})))}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e,this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var t=e.changedTouches[0];this.dragStart(e,t),this.touchIdentifier=void 0!==t.pointerId?t.pointerId:t.identifier,e.preventDefault()}},{key:"ontouchmove",value:function(e){var t=getTouch$1(e.changedTouches,this.touchIdentifier);t&&this.dragMove(e,t)}},{key:"ontouchend",value:function(e){var t=getTouch$1(e.changedTouches,this.touchIdentifier);t&&this.dragEnd(e,t),e.preventDefault()}},{key:"ontouchcancel",value:function(e){var t=getTouch$1(e.changedTouches,this.touchIdentifier);t&&this.dragCancel(e,t)}},{key:"dragStart",value:function(e,t){if(this._root&&!this.isDown&&this.isEnabled){this.downPoint=t,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var r=getSize(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-r.height,this.startPos.maxX=window.innerWidth-r.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,t){this.isDragging=!0,this.animate(),this.emit(EVENTS$1.START,this.startPos)}},{key:"dragEnd",value:function(e,t){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(EVENTS$1.ENDED)),this.presetInfo())}},{key:"_dragPointerMove",value:function(e,t){var r={x:t.pageX-this.downPoint.pageX,y:t.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(r)&&this.dragRealStart(e,t),r}},{key:"dragMove",value:function(e,t){if(e=e||window.event,this.isDown){var r=this.startPos,n=r.x,i=r.y,o=this._dragPointerMove(e,t),a=o.x,s=o.y;a=this.checkContain("x",a,n),s=this.checkContain("y",s,i),this.position.x=n+a,this.position.y=i+s,this.dragPoint.x=a,this.dragPoint.y=s,this.emit(EVENTS$1.MOVE,this.position)}}},{key:"dragCancel",value:function(e,t){this.dragEnd(e,t)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,t,r){return t+r<0?0-r:"x"===e&&t+r>this.startPos.maxX?this.startPos.maxX-r:"y"===e&&t+r>this.startPos.maxY?this.startPos.maxY-r:t}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root),t=this._getPositionCoord(e.left,"width"),r=this._getPositionCoord(e.top,"height");this.position.x=isNaN(t)?0:t,this.position.y=isNaN(r)?0:r,this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var t=e.transform;if(0===t.indexOf("matrix")){var r=t.split(","),n=0===t.indexOf("matrix3d")?12:4,i=parseInt(r[n],10),o=parseInt(r[n+1],10);this.position.x+=i,this.position.y+=o}}},{key:"_getPositionCoord",value:function(e,t){if(-1!==e.indexOf("%")){var r=getSize(this._root.parentNode);return r?parseFloat(e)/100*r[t]:0}return parseInt(e,10)}}]),r}(EventEmitter$1),MiniScreen=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;_classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"onCancelClick",(function(e){n.exitMini(),n.isClose=!0})),_defineProperty$2(_assertThisInitialized$1(n),"onCenterClick",(function(e){var t=_assertThisInitialized$1(n).player;t.paused?t.play():t.pause()})),_defineProperty$2(_assertThisInitialized$1(n),"onScroll",(function(e){if(!(!window.scrollY&&0!==window.scrollY||Math.abs(window.scrollY-n.pos.scrollY)<50)){var t=parseInt(util$2.getCss(n.player.root,"height"));t+=n.config.scrollTop,n.pos.scrollY=window.scrollY,window.scrollY>t+5?!n.isMini&&!n.isClose&&n.getMini():window.scrollY<=t&&(n.isMini&&n.exitMini(),n.isClose=!1)}})),n.isMini=!1,n.isClose=!1;var i=_assertThisInitialized$1(n).config;return n.pos={left:i.left<0?window.innerWidth-i.width-20:i.left,top:i.top<0?window.innerHeight-i.height-20:i.top,height:n.config.height,width:n.config.width,scrollY:window.scrollY||0},n.lastStyle=null,n}return _createClass$2(r,[{key:"beforeCreate",value:function(e){"boolean"==typeof e.player.config.mini&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.on(PAUSE,(function(){e.setAttr("data-state","pause")})),this.on(PLAY,(function(){e.setAttr("data-state","play")}))}},{key:"onPluginsReady",value:function(){var e=this,t=this.player;if(!this.config.disable){if(this.config.isShowIcon){var r={config:{onClick:function(){e.getMini()}}};t.controls.registerPlugin(MiniScreenIcon,r,MiniScreenIcon.pluginName)}var n=util$2.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",n,this.onCancelClick),this.bind(".play-icon",n,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new Draggabilly(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:PlaySvg,class:"xg-icon-play"},pause:{icon:PauseSvg,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play),this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var t=this.player,r=this.playerConfig,n=this.config.target||this.player.root;this.lastStyle={},util$2.addClass(t.root,"xgplayer-mini"),["width","height","top","left"].map((function(t){e.lastStyle[t]=n.style[t],n.style[t]="".concat(e.pos[t],"px")})),r.fluid&&(n.style["padding-top"]=""),this.emit(MINI_STATE_CHANGE,!0),t.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return!1;var t=this.player,r=this.playerConfig,n=this.config.target||this.player.root;util$2.removeClass(t.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map((function(t){n.style[t]=e.lastStyle[t]})),this.lastStyle=null,r.fluid&&(t.root.style.width="100%",t.root.style.height="0",t.root.style["padding-top"]="".concat(100*r.height/r.width,"%")),this.emit(MINI_STATE_CHANGE,!1),this.isMini=t.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=util$2.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick),this.unbind(".play-icon",e,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return'\n      <xg-mini-layer class="xg-mini-layer">\n      <xg-mini-header class="xgplayer-mini-header">\n      <div lang-key="'.concat(this.i18nKeys.MINI_DRAG,'">').concat(this.i18n.MINI_DRAG,'</div>\n      </xg-mini-header>\n      <div class="mini-cancel-btn">\n        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>\n        </svg>\n      </div>\n      <div class="play-icon">\n      </div>\n      </xg-mini-layer>')}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),r}(Plugin),MOUSE_EVENTS={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},HOOKS=["videoClick","videoDbClick"],PCPlugin=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"onMouseMove",(function(t){var r=_assertThisInitialized$1(e),n=r.player,i=r.playerConfig;n.isActive||(n.focus({autoHide:!i.closeDelayBlur}),!i.closeFocusVideoFocus&&n.video.focus())})),_defineProperty$2(_assertThisInitialized$1(e),"onMouseEnter",(function(t){var r=_assertThisInitialized$1(e),n=r.playerConfig,i=r.player;i.focus({autoHide:!n.closeDelayBlur}),!n.closeFocusVideoFocus&&i.video.focus()})),_defineProperty$2(_assertThisInitialized$1(e),"onMouseLeave",(function(t){var r=e.playerConfig,n=r.closePlayerBlur,i=r.leavePlayerTime;n||(i?e.player.focus({autoHide:!0,delay:i}):e.player.blur())})),_defineProperty$2(_assertThisInitialized$1(e),"onVideoClick",(function(t){var r=_assertThisInitialized$1(e),n=r.player,i=r.playerConfig;t.target&&i.closeVideoClick||t.target!==n.video&&t.target!==n.innerContainer&&t.target!==n.video.__canvas||(t.preventDefault(),i.closeVideoStopPropagation||t.stopPropagation(),e._clickCount++,e.clickTimer&&(clearTimeout(e.clickTimer),e.clickTimer=null),e.clickTimer=setTimeout((function(){e._clickCount&&(e._clickCount--,runHooks(_assertThisInitialized$1(e),HOOKS[0],(function(t,r){e.switchPlayPause(r.e)}),{e:t,paused:n.paused}),clearTimeout(e.clickTimer),e.clickTimer=null)}),300))})),_defineProperty$2(_assertThisInitialized$1(e),"onVideoDblClick",(function(t){var r=_assertThisInitialized$1(e),n=r.player,i=r.playerConfig;!t.target||t.target!==n.video&&t.target!==n.video.__canvas||i.closeVideoDblclick||(e._clickCount<2?e._clickCount=0:(e._clickCount=0,e.clickTimer&&(clearTimeout(e.clickTimer),e.clickTimer=null),t.preventDefault(),t.stopPropagation(),runHooks(_assertThisInitialized$1(e),HOOKS[1],(function(t,r){e.emitUserAction(r.e,"switch_fullscreen",{props:"fullscreen",from:n.fullscreen,to:!n.fullscreen}),n.fullscreen?n.exitFullscreen():n.getFullscreen()}),{e:t,fullscreen:n.fullscreen})))})),e}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this._clickCount=0,HOOKS.map((function(t){e.__hooks[t]=null}));var t=this.playerConfig,r=t.enableContextmenu;t.isMobileSimulateMode||"mobile"===sniffer.device&&!sniffer.os.isIpad||(this.config.disableContextmenu=!r,this.initEvents())}},{key:"initEvents",value:function(){var e=this,t=this.player,r=t.video,n=t.root;r.addEventListener("click",this.onVideoClick,!1),r.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(MOUSE_EVENTS).map((function(t){n.addEventListener(t,e[MOUSE_EVENTS[t]],!1)})),this.config.disableContextmenu&&r.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(e){var t=this.player;this.emitUserAction(e,"switch_play_pause",{props:"paused",from:t.paused,to:!t.paused}),t.ended?t.duration!==1/0&&t.duration>0&&t.replay():t.paused?t.play():t.pause()}},{key:"onContextmenu",value:function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"destroy",value:function(){var e=this,t=this.player,r=t.video,n=t.root;this.clickTimer&&clearTimeout(this.clickTimer),n.removeEventListener("click",this.onVideoClick,!1),r.removeEventListener("dblclick",this.onVideoDblClick,!1),r.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(MOUSE_EVENTS).map((function(t){n.removeEventListener(t,e[MOUSE_EVENTS[t]],!1)}))}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{disableContextmenu:!0}}}]),r}(BasePlugin),global$11=global$1T,toIntegerOrInfinity$d=toIntegerOrInfinity$j,toString$o=toString$A,requireObjectCoercible$d=requireObjectCoercible$l,RangeError$9=global$11.RangeError,stringRepeat$1=function(e){var t=toString$o(requireObjectCoercible$d(this)),r="",n=toIntegerOrInfinity$d(e);if(n<0||n==1/0)throw RangeError$9("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},$$1d=_export$1,global$10=global$1T,uncurryThis$Y=functionUncurryThis$1,toIntegerOrInfinity$c=toIntegerOrInfinity$j,thisNumberValue$3=thisNumberValue$5,$repeat$2=stringRepeat$1,fails$V=fails$1m,RangeError$8=global$10.RangeError,String$2=global$10.String,floor$a=Math.floor,repeat$3=uncurryThis$Y($repeat$2),stringSlice$e=uncurryThis$Y("".slice),un$ToFixed$1=uncurryThis$Y(1..toFixed),pow$4=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)},log$4=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},multiply$1=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=floor$a(i/1e7)},divide$1=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=floor$a(n/t),n=n%t*1e7},dataToString$1=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=String$2(e[t]);r=""===r?n:r+repeat$3("0",7-n.length)+n}return r},FORCED$g=fails$V((function(){return"0.000"!==un$ToFixed$1(8e-5,3)||"1"!==un$ToFixed$1(.9,0)||"1.25"!==un$ToFixed$1(1.255,2)||"1000000000000000128"!==un$ToFixed$1(0xde0b6b3a7640080,0)}))||!fails$V((function(){un$ToFixed$1({})}));$$1d({target:"Number",proto:!0,forced:FORCED$g},{toFixed:function(e){var t,r,n,i,o=thisNumberValue$3(this),a=toIntegerOrInfinity$c(e),s=[0,0,0,0,0,0],u="",c="0";if(a<0||a>20)throw RangeError$8("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String$2(o);if(o<0&&(u="-",o=-o),o>1e-21)if(r=(t=log$4(o*pow$4(2,69,1))-69)<0?o*pow$4(2,-t,1):o/pow$4(2,t,1),r*=4503599627370496,(t=52-t)>0){for(multiply$1(s,0,r),n=a;n>=7;)multiply$1(s,1e7,0),n-=7;for(multiply$1(s,pow$4(10,n,1),0),n=t-1;n>=23;)divide$1(s,1<<23),n-=23;divide$1(s,1<<n),multiply$1(s,1,1),divide$1(s,2),c=dataToString$1(s)}else multiply$1(s,0,r),multiply$1(s,1<<-t,0),c=dataToString$1(s)+repeat$3("0",a);return c=a>0?u+((i=c.length)<=a?"0."+repeat$3("0",a-i)+c:stringSlice$e(c,0,i-a)+"."+stringSlice$e(c,i-a)):u+c}});var EVENTS={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},TOUCHS={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},MOUSES={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function getTouch(e){return e&&e.length>0?e[e.length-1]:null}function preventToucheDefault(e){var t=navigator.userAgent;/(?:iPhone|iPad)/.test(t)&&e.cancelable&&e.preventDefault()}function getDefaultConfig(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var Touche=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{eventType:"touch"};_classCallCheck$2(this,e),this._pos={moving:!1,start:!1,x:0,y:0},this.config=getDefaultConfig(),Object.keys(n).map((function(e){r.config[e]=n[e]})),this.root=t,this.events="mouse"===n.eventType?MOUSES:TOUCHS,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return _createClass$2(e,[{key:"_initEvent",value:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchCancel=this.onTouchCancel.bind(this),this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(e){var t=this,r=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout((function(){t.trigger(EVENTS.PRESS,e),t._pos.press=!0,t.__clearPress()}),r.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(e){var t=this,r=this.config;if(this.dbIntrvalId)return this.__clearDb(),void this.trigger(EVENTS.DOUBlE_CLICK,e);this.dbIntrvalId=setTimeout((function(){t.__clearDb(),t._pos.start||t._pos.press||t._pos.moving||t.trigger(EVENTS.CLICK,e)}),r.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(e,t){this.__handlers[e]||(this.__handlers[e]=[]),this.__handlers[e].push(t)}},{key:"off",value:function(e,t){if(this.__handlers[e]){for(var r=this.__handlers[e],n=-1,i=0;i<r.length;i++)if(r[i]===t){n=i;break}n>=0&&this.__handlers[e].splice(n,1)}}},{key:"trigger",value:function(e,t){this.__handlers[e]&&this.__handlers[e].map((function(r){try{r(t)}catch(error){console.error("trigger>>:".concat(e),error)}}))}},{key:"onTouchStart",value:function(e){var t=this._pos,r=this.root;this.config.needPreventDefault&&preventToucheDefault(e);var n=getTouch(e.touches);t.x=n?parseInt(n.pageX,10):e.pageX,t.y=n?parseInt(n.pageX,10):e.pageX,t.start=!0,this.__setPress(e),r.addEventListener(this.events.end,this.onTouchEnd),r.addEventListener(this.events.cancel,this.onTouchCancel),r.addEventListener(this.events.move,this.onTouchMove),this.trigger(EVENTS.TOUCH_START,e)}},{key:"onTouchCancel",value:function(e){this.onTouchEnd(e)}},{key:"onTouchEnd",value:function(e){var t=this._pos,r=this.root;this.config.needPreventDefault&&preventToucheDefault(e),this.__clearPress(),r.removeEventListener(this.events.cancel,this.onTouchCancel),r.removeEventListener(this.events.end,this.onTouchEnd),r.removeEventListener(this.events.move,this.onTouchMove),e.moving=t.moving,e.press=t.press,t.press&&this.trigger(EVENTS.PRESS_END,e),this.trigger(EVENTS.TOUCH_END,e),!t.press&&!t.moving&&this.__setDb(e),t.press=!1,t.start=!1,t.moving=!1}},{key:"onTouchMove",value:function(e){var t=this._pos,r=this.config,n=getTouch(e.touches),i=n?parseInt(n.pageX,10):e.pageX,o=n?parseInt(n.pageY,10):e.pageX,a=i-t.x,s=o-t.y;Math.abs(s)<r.miniStep&&Math.abs(a)<r.miniStep||(this.__clearPress(),t.press&&this.trigger(EVENTS.PRESS_END,e),t.press=!1,t.moving=!0,this.trigger(EVENTS.TOUCH_MOVE,e))}},{key:"destroy",value:function(){var e=this,t={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(t).map((function(r){e.root.removeEventListener("touchend",e[t[r]])}))}}]),e}();function SeekTipIcon(){return(new DOMParser).parseFromString('<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"\n  xmlns:xlink="http://www.w3.org/1999/xlink">\n  <path opacity="0.54"\n    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"\n    fill="white" />\n  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>\n</svg>',"image/svg+xml").firstChild}var ACTIONS={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},MobilePlugin=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"onTouchStart",(function(e){var t=_assertThisInitialized$1(n),r=t.player,i=t.config,o=t.pos,a=t.playerConfig,s=n.getTouche(e);if(s&&!i.disableGesture&&n.duration>0&&!r.ended){o.isStart=!0,util$2.checkIsFunction(a.disableSwipeHandler)&&a.disableSwipeHandler(),n.find(".xg-dur").innerHTML=util$2.format(n.duration);var u=n.root.getBoundingClientRect();90===r.rotateDeg?(o.top=u.left,o.left=u.top,o.width=u.height,o.height=u.width):(o.top=u.top,o.left=u.left,o.width=u.width,o.height=u.height);var c=parseInt(s.pageX-o.left,10),l=parseInt(s.pageY-o.top,10);o.x=90===r.rotateDeg?l:c,o.y=90===r.rotateDeg?c:l,o.scopeL=i.scopeL*o.width,o.scopeR=(1-i.scopeR)*o.width,o.scopeM1=o.width*(1-i.scopeM)/2,o.scopeM2=o.width-o.scopeM1}})),_defineProperty$2(_assertThisInitialized$1(n),"onTouchMove",(function(e){var t=n.getTouche(e),r=_assertThisInitialized$1(n),i=r.pos,o=r.config,a=r.player;if(t&&!o.disableGesture&&n.duration&&i.isStart){var s=o.miniMoveStep,u=o.hideControlsActive,c=parseInt(t.pageX-i.left,10),l=parseInt(t.pageY-i.top,10),d=90===a.rotateDeg?l:c,f=90===a.rotateDeg?c:l;if(Math.abs(d-i.x)>s||Math.abs(f-i.y)>s){var h=d-i.x,p=f-i.y,g=i.scope;if(-1===g&&(0===(g=n.checkScope(d,f,h,p,i))&&(u?a.blur():a.focus({autoHide:!1}),!i.time&&(i.time=parseInt(1e3*a.currentTime,10)+1e3*n.timeOffset)),i.scope=g),-1===g||g>0&&!o.gestureY||0===g&&!o.gestureX)return;e.cancelable&&e.preventDefault(),n.executeMove(h,p,g,i.width,i.height),i.x=d,i.y=f}}})),_defineProperty$2(_assertThisInitialized$1(n),"onTouchEnd",(function(e){var t=_assertThisInitialized$1(n),r=t.player,i=t.pos,o=t.playerConfig;i.isStart&&(i.scope>-1&&e.cancelable&&e.preventDefault(),n.endLastMove(i.scope),setTimeout((function(){r.getPlugin("progress")&&r.getPlugin("progress").resetSeekState()}),10),i.scope=-1,n.resetPos(),util$2.checkIsFunction(o.enableSwipeHandler)&&o.enableSwipeHandler(),n.changeAction(ACTIONS.AUTO))})),_defineProperty$2(_assertThisInitialized$1(n),"onRootTouchMove",(function(e){!n.config.disableGesture&&n.config.gestureX&&n.checkIsRootTarget(e)&&(e.stopPropagation(),n.pos.isStart?n.onTouchMove(e):n.onTouchStart(e))})),_defineProperty$2(_assertThisInitialized$1(n),"onRootTouchEnd",(function(e){n.pos.isStart&&n.checkIsRootTarget(e)&&(e.stopPropagation(),n.onTouchEnd(e))})),n.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},n.timer=null,n}return _createClass$2(r,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:SeekTipIcon,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this,t=this.playerConfig,r=this.config,n=this.player;!0===t.closeVideoDblclick&&(r.closedbClick=!0),this.resetPos(),util$2.isUndefined(t.disableGesture)||(r.disableGesture=!!t.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=util$2.createDom("xg-mask","",{},"xgmask"),n.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var i=this.domEventType;this.touch=new Touche(this.root,{eventType:i,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",(function(e){e.preventDefault()})),n.root.addEventListener("touchmove",this.onRootTouchMove,!0),n.root.addEventListener("touchend",this.onRootTouchEnd,!0),this.on(DURATION_CHANGE,(function(){var t=e.player,r=e.config;1e3*t.duration<r.moveDuration&&(r.moveDuration=1e3*t.duration)})),this.on([CANPLAY,ENDED],(function(){var t=e.pos,r=t.time;!t.isStart&&r>0&&(e.pos.time=0)}));var o={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(o).map((function(t){e.touch.on(t,(function(r){e[o[t]](r)}))})),!r.disableActive){var a=n.plugins.progress;a&&(a.addCallBack("dragmove",(function(t){e.activeSeekNote(t.currentTime,t.forward)})),a.addCallBack("dragend",(function(){e.changeAction(ACTIONS.AUTO)})))}}},{key:"registerThumbnail",value:function(){var e=this.player.plugins.thumbnail;if(e&&e.usable){this.thumbnail=e.createThumbnail(null,"mobile-thumbnail");var t=this.find(".time-preview");t.insertBefore(this.thumbnail,t.children[0])}}},{key:"initCustomStyle",value:function(){var e=(this.playerConfig||{}).commonStyle,t=e.playedColor,r=e.progressColor;t&&(this.find(".xg-curbar").style.backgroundColor=t,this.find(".xg-cur").style.color=t),r&&(this.find(".xg-bar").style.backgroundColor=r,this.find(".time-preview").style.color=r),this.config.disableTimeProgress&&util$2.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map((function(t){e.pos[t]=0}))):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var t=this.player;this.root.setAttribute("data-xg-action",e);var r=t.plugins.start;r&&r.recover()}},{key:"getTouche",value:function(e){this.player.rotateDeg;var t=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return{pageX:t.pageX,pageY:t.pageY}}},{key:"checkScope",value:function(e,t,r,n,i){var o=i.width,a=-1;if(e<0||e>o)return a;var s=0===n?Math.abs(r):Math.abs(r/n);return Math.abs(r)>0&&s>=1.73&&e>i.scopeM1&&e<i.scopeM2?a=0:(0===Math.abs(r)||s<=.57)&&(a=e<i.scopeL?1:e>i.scopeR?2:3),a}},{key:"executeMove",value:function(e,t,r,n,i){switch(r){case 0:this.updateTime(e/n*this.config.scopeM);break;case 1:this.updateBrightness(t/i);break;case 2:sniffer.os.isIos||this.updateVolume(t/i)}}},{key:"endLastMove",value:function(e){var t=this,r=this.pos,n=this.player,i=this.config,o=(r.time-this.timeOffset)/1e3;if(0===e)n.seek(Number(o).toFixed(1)),i.hideControlsEnd?n.blur():n.focus(),this.timer=setTimeout((function(){t.pos.time=0}),500);this.changeAction(ACTIONS.AUTO)}},{key:"checkIsRootTarget",value:function(e){var t=this.player.plugins||{};return(!t.progress||!t.progress.root.contains(e.target))&&(t.start&&t.start.root.contains(e.target)||t.controls&&t.controls.root.contains(e.target))}},{key:"sendUseAction",value:function(e){var t=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:t,to:!t})}},{key:"onClick",value:function(e){var t=this.player,r=this.config,n=this.playerConfig;t.state<STATES$1.RUNNING?n.closeVideoClick||(this.sendUseAction(new Event("click")),t.play()):!r.closedbClick||n.closeVideoClick?t.isActive?t.blur():t.focus():n.closeVideoClick||((t.isActive||r.focusVideoClick)&&(this.emitUserAction("click","switch_play_pause"),this.switchPlayPause()),t.focus())}},{key:"onDbClick",value:function(e){var t=this.config,r=this.player;!t.closedbClick&&r.state>=STATES$1.RUNNING&&(this.sendUseAction(new Event("dblclick")),this.switchPlayPause())}},{key:"onPress",value:function(e){var t=this.pos,r=this.config,n=this.player;r.disablePress||(t.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:n.playbackRate,to:r.pressRate}),n.playbackRate=r.pressRate,this.changeAction(ACTIONS.PLAYBACK))}},{key:"onPressEnd",value:function(e){var t=this.pos,r=this.config,n=this.player;r.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:n.playbackRate,to:t.rate}),n.playbackRate=t.rate,t.rate=1,this.changeAction(ACTIONS.AUTO))}},{key:"updateTime",value:function(e){var t=this.player,r=this.config,n=this.player.duration;e=Number(e.toFixed(4));var i=parseInt(e*r.moveDuration,10)+this.timeOffset;i=(i+=this.pos.time)<0?0:i>1e3*n?1e3*n-200:i,t.getPlugin("time")&&t.getPlugin("time").updateTime(i/1e3),t.getPlugin("progress")&&t.getPlugin("progress").updatePercent(i/1e3/this.duration,!0),this.activeSeekNote(i/1e3,e>0),r.isTouchingSeek&&t.seek(Number((i-this.timeOffset)/1e3).toFixed(1)),this.pos.time=i}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var t=this.player,r=this.pos;if(e=parseInt(100*e,10),r.volume+=e,!(Math.abs(r.volume)<10)){var n=parseInt(10*t.volume,10)-parseInt(r.volume/10,10);n=n>10?10:n<1?0:n,t.volume=n/10,r.volume=0}}},{key:"updateBrightness",value:function(e){this.player.rotateDeg&&(e=-e);var t=this.pos,r=this.config,n=this.xgMask,i=t.light+.8*e;i=i>r.maxDarkness?r.maxDarkness:i<0?0:i,n&&(n.style.backgroundColor="rgba(0,0,0,".concat(i,")")),t.light=i}},{key:"activeSeekNote",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.player,n=this.config,i=!(this.duration!==1/0&&this.duration>0);if(e&&"number"==typeof e&&!i&&!n.disableActive){e<0?e=0:e>r.duration&&(e=r.duration-.2),this.changeAction(ACTIONS.SEEKING);var o=r.plugins.start;o&&o.focusHide(),this.find(".xg-dur").innerHTML=util$2.format(this.duration),this.find(".xg-cur").innerHTML=util$2.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),t?util$2.removeClass(this.find(".xg-seek-show"),"xg-back"):util$2.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var t=this.player.plugins.thumbnail;t&&t.usable&&this.thumbnail&&t.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<STATES$1.ATTACHED)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0)}},{key:"render",value:function(){var e="normal"!==this.config.gradient?"gradient ".concat(this.config.gradient):"gradient";return'\n     <xg-trigger class="trigger">\n     <div class="'.concat(e,'"></div>\n        <div class="time-preview">\n            <div class="xg-seek-show ').concat(this.config.disableSeekIcon?" hide-seek-icon":"",'">\n              <i class="xg-seek-icon"></i>\n              <span class="xg-cur">00:00</span>\n              <span>/</span>\n              <span class="xg-dur">00:00</span>\n            </div>\n              <div class="xg-bar xg-timebar">\n                <div class="xg-curbar"></div>\n              </div>\n        </div>\n        <div class="xg-playbackrate xg-top-note">\n            <span><i>').concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,"</span>\n        </div>\n     </xg-trigger>\n    ")}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:36e4,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),r}(Plugin);function preventDefault(e){e.preventDefault(),e.returnValue=!1}function isDisableTag(e){var t=e.tagName;return!("INPUT"!==t&&"TEXTAREA"!==t&&!e.isContentEditable)}var Keyboard=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"onBodyKeyDown",(function(t){var r=t||window.event;if(e.player&&(e.player.isUserActive||e.config.isIgnoreUserActive)&&!(e.config.disable||e.config.disableBodyTrigger||!e.checkIsVisible()||r.metaKey||r.altKey||r.ctrlKey)){var n=r.keyCode;return!(r.target!==document.body&&(!e.config.isGlobalTrigger||isDisableTag(r.target))||!e.checkCode(n,!0))&&(preventDefault(r),e.handleKeyCode(n,t),!1)}})),_defineProperty$2(_assertThisInitialized$1(e),"onKeydown",(function(t){var r=t||window.event;if(!(e.config.disable||e.config.disableRootTrigger||r.metaKey||r.altKey||r.ctrlKey)&&(e.player.isUserActive||e.config.isIgnoreUserActive)&&(e.player.isUserActive||e.config.isIgnoreUserActive)){if(!r||37!==r.keyCode&&!e.checkCode(r.keyCode)||r.target!==e.player.root&&r.target!==e.player.video&&r.target!==e.player.controls.el)return!0;preventDefault(r),e.handleKeyCode(r.keyCode,t)}})),e}return _createClass$2(r,[{key:"mergekeyCodeMap",value:function(){var e=this,t=this.config.keyCodeMap;t&&Object.keys(t).map((function(r){e.keyCodeMap[r]?["keyCode","action","disable","isBodyTarget"].map((function(n){t[r][n]&&(e.keyCodeMap[r][n]=t[r][n])})):e.keyCodeMap[r]=t[r]}))}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var e="function"==typeof this.config.seekStep?this.config.seekStep(this.player):this.config.seekStep;e&&"number"==typeof e&&(this.seekStep=e),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disable:!1},right:{keyCode:39,action:"seek",disable:!1},esc:{keyCode:27,action:"exitFullscreen",disable:!1}},this.mergekeyCodeMap(),this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var e=this.player.root.getBoundingClientRect(),t=e.height,r=e.top,n=e.bottom,i=window.innerHeight;return!(r<0&&r<0-.9*t||n>0&&n-i>.9*t)}},{key:"checkCode",value:function(e,t){var r=this,n=!1;return Object.keys(this.keyCodeMap).map((function(i){r.keyCodeMap[i]&&e===r.keyCodeMap[i].keyCode&&!r.keyCodeMap[i].disable&&(n=!t||t&&!r.keyCodeMap[i].noBodyTarget)})),n}},{key:"downVolume",value:function(e){var t=this.player,r=parseFloat((t.volume-.1).toFixed(1)),n={volume:{from:t.volume,to:r}};this.emitUserAction(e,"change_volume",{props:n}),t.volume=r>=0?r:0}},{key:"upVolume",value:function(e){var t=this.player,r=parseFloat((t.volume+.1).toFixed(1)),n={volume:{from:t.volume,to:r}};this.emitUserAction(e,"change_volume",{props:n}),t.volume=r<=1?r:1}},{key:"seek",value:function(e){var t=this.player,r=t.currentTime,n=t.duration,i=r,o={currentTime:{from:r,to:i=r+this.seekStep<=n?r+this.seekStep:n-1}};this.emitUserAction(e,"seek",{props:o}),this.player.currentTime=i}},{key:"seekBack",value:function(e){var t=this.player.currentTime,r=0;t-this.seekStep>=0&&(r=t-this.seekStep);var n={currentTime:{from:t,to:r}};this.emitUserAction(e,"seek",{props:n}),this.player.currentTime=r}},{key:"playPause",value:function(e){var t=this.player;t&&(this.emitUserAction(e,"switch_play_pause"),t.paused?t.play():t.pause())}},{key:"exitFullscreen",value:function(e){var t=this.player,r=t.fullscreen,n=t.cssfullscreen;r&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:r,to:!r}),t.exitFullscreen()),n&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:n,to:!n}),t.exitCssFullscreen())}},{key:"handleKeyCode",value:function(e,t){var r=this;Object.keys(this.keyCodeMap).map((function(n){var i=r.keyCodeMap[n],o=i.action,a=i.keyCode,s=i.disable;a!==e||s||("function"==typeof o?o(t,r.player):"string"==typeof o&&"function"==typeof r[o]&&r[o](t,r.player),r.emit(SHORTCUT,_objectSpread2({key:n,target:t.target},r.keyCodeMap[n])))}))}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!0,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!1,keyCodeMap:{},disable:!1,isIgnoreUserActive:!1}}}]),r}(BasePlugin);function loadingIcon(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">\n  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>\n</svg>\n',"image/svg+xml").firstChild}var Loading=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"registerIcons",value:function(){return{loadingIcon:loadingIcon}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return'\n    <xg-loading class="xgplayer-loading">\n      <xg-loading-inner></xg-loading-inner>\n    </xg-loading>'}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.ROOT}}}]),r}(Plugin),$$1c=_export$1,$findIndex$1=arrayIteration$1.findIndex,addToUnscopables$1=addToUnscopables$4,FIND_INDEX="findIndex",SKIPS_HOLES=!0;FIND_INDEX in[]&&Array(1)[FIND_INDEX]((function(){SKIPS_HOLES=!1})),$$1c({target:"Array",proto:!0,forced:SKIPS_HOLES},{findIndex:function(e){return $findIndex$1(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables$1(FIND_INDEX);var TPL=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],InnerList=function(){function e(t){_classCallCheck$2(this,e),this.fragments=t.fragments||[],this.focusClass="inner-focus",this.style=t.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0}return _createClass$2(e,[{key:"updateDuration",value:function(e){var t=this;this.duration=parseInt(1e3*e);var r=0,n=this.fragments;this.fragments=n.map((function(e){return e.start=r,e.end=r+e.percent*t.duration,e.duration=e.percent*t.duration,r+=e.percent*t.duration,e}))}},{key:"updateProgress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"played",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},r=this.progressList,n=this.fragments,i=t.newIndex,o=t.curIndex,a=t.millisecond;i!==o&&r.map((function(t,r){r<i?t[e].style.width="100%":r>i&&(t[e].style.width=0)}));var s=n[i],u=0===a?0:(a-s.start)/s.duration;r[i][e].style.width=u<0?0:"".concat(100*u,"%")}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(1e3*t,10)!==this.duration){if(!t&&0!==t)return;this.updateDuration(t)}var r=this.playedIndex,n=this.cachedIndex;if("Undefined"!==util$2.typeOf(e.played)){var i=this.findIndex(1e3*e.played,r);this.updateProgress("played",{newIndex:i,curIndex:r,millisecond:parseInt(1e3*e.played,10)}),this.playedIndex=i}if("Undefined"!==util$2.typeOf(e.cached)){var o=this.findIndex(1e3*e.cached,n);this.updateProgress("cached",{newIndex:o,curIndex:n,millisecond:parseInt(1e3*e.cached,10)}),this.cachedIndex=o}}},{key:"findIndex",value:function(e,t){var r=this.fragments;return 1===r.length?0:(e>r[t].start&&e<r[t].end||this.fragments.map((function(r,n){e>r.start&&e<=r.end&&(t=n)})),t)}},{key:"findHightLight",value:function(){for(var e=this.root.children,t=0;t<e.length;t++)if(util$2.hasClass(e[t],this.focusClass))return{dom:e[t],pos:e[t].getBoundingClientRect()}}},{key:"findFragment",value:function(e){var t=this.root.children;return e<0||e>=t.length?null:{dom:t[e],pos:t[e].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var e=this.root.children,t=0;t<e.length;t++)util$2.removeClass(e[t],this.focusClass)}},{key:"setHightLight",value:function(e){var t=this.root.children;if(e<t.length)return util$2.addClass(t[e],this.focusClass),{dom:t[e],pos:t[e].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"render",value:function(){var e=this,t=this.style.progressColor;return this.root=util$2.createDom("xg-inners","",{},"progress-list"),this.fragments&&(this.progressList=this.fragments.map((function(r){var n=util$2.createDom("xg-inner","",{style:t?"background:".concat(t,"; flex: ").concat(r.percent):"flex: ".concat(r.percent)},"".concat(r.isFocus?"inner-focus":""," xgplayer-progress-inner"));return e.root.appendChild(n),TPL.map((function(t){n.appendChild(util$2.createDom(t.tag,"",{style:t.styleKey?"background: ".concat(e.style[t.styleKey],"; width:0;"):"width:0;"},t.className))})),{cached:n.children[0],played:n.children[1]}}))),this.root}}]),e}(),Progress=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"onMoveOnly",(function(e){var t=_assertThisInitialized$1(n),r=t.pos,i=t.config,o=t.player;util$2.event(e);var a=util$2.getEventPos(e,o.zoom),s=90===o.rotateDeg?a.clientY:a.clientX;if(!(r.moving&&Math.abs(r.x-s)<i.miniMoveStep)){r.moving=!0,r.x=s;var u=n.computeTime(e);n.triggerCallbacks("dragmove",u,e)}})),_defineProperty$2(_assertThisInitialized$1(n),"onBodyClick",(function(e){e.preventDefault(),e.stopPropagation()})),_defineProperty$2(_assertThisInitialized$1(n),"_mouseDownHandler",(function(e,t){n._state.time=t.currentTime,n.updateWidth(t.currentTime,t.percent,0)})),_defineProperty$2(_assertThisInitialized$1(n),"_mouseUpHandler",(function(e,t){_assertThisInitialized$1(n).pos.moving&&n.updateWidth(t.currentTime,t.percent,2)})),_defineProperty$2(_assertThisInitialized$1(n),"_mouseMoveHandler",(function(e,t){var r=_assertThisInitialized$1(n),i=r._state,o=r.pos,a=r.config,s=r.player;i.time<t.currentTime?t.forward=!0:t.forward=!1,i.time=t.currentTime,o.isDown&&!o.moving&&(o.moving=!0,a.isPauseMoving&&s.pause(),n.triggerCallbacks("dragstart",t,e)),n.updateWidth(t.currentTime,t.percent,1),n.triggerCallbacks("dragmove",t,e)})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseDown",(function(e){var t=_assertThisInitialized$1(n),r=t.player,i=t.pos,o=t.config,a=t.playerConfig,s=util$2.getEventPos(e,r.zoom),u=90===r.rotateDeg?s.clientY:s.clientX;if(!(r.isMini||o.closeMoveSeek||!a.allowSeekAfterEnded&&r.ended)){e.stopPropagation(),n.focus(),util$2.checkIsFunction(a.disableSwipeHandler)&&a.disableSwipeHandler(),util$2.checkIsFunction(o.onMoveStart)&&o.onMoveStart(),util$2.event(e),i.x=u,i.isDown=!0,i.moving=!1,r.focus({autoHide:!1}),n.isProgressMoving=!0,util$2.addClass(n.progressBtn,"active");var c=n.computeTime(e);return n._mouseDownHandlerHook(e,c),"touch"===n.domEventType?(n.root.addEventListener("touchmove",n.onMouseMove),n.root.addEventListener("touchend",n.onMouseUp)):(n.unbind("mousemove",n.onMoveOnly),document.addEventListener("mousemove",n.onMouseMove,!1),document.addEventListener("mouseup",n.onMouseUp,!1),r.root.addEventListener("click",n.onBodyClick,!1)),!0}})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseUp",(function(e){var t=_assertThisInitialized$1(n),r=t.player,i=t.config,o=t.pos,a=t.playerConfig,s=t._state;e.stopPropagation(),e.preventDefault(),util$2.checkIsFunction(a.enableSwipeHandler)&&a.enableSwipeHandler(),util$2.checkIsFunction(i.onMoveEnd)&&i.onMoveEnd(),util$2.event(e),util$2.removeClass(n.progressBtn,"active");var u=n.computeTime(e);o.moving?n.triggerCallbacks("dragend",u,e):n.triggerCallbacks("click",u,e),n._mouseUpHandlerHook(e,u),o.moving=!1,o.isDown=!1,o.x=0,o.y=0,s.time=0,"touch"===n.domEventType?(n.root.removeEventListener("touchmove",n.onMouseMove),n.root.removeEventListener("touchend",n.onMouseUp),n.blur()):(document.removeEventListener("mousemove",n.onMouseMove,!1),document.removeEventListener("mouseup",n.onMouseUp,!1),r.root.removeEventListener("click",n.onBodyClick,!1),o.isEnter?!a.isMobileSimulateMode&&n.bind("mousemove",n.onMoveOnly):n.onMouseLeave(e)),util$2.setTimeout(_assertThisInitialized$1(n),(function(){n.resetSeekState()}),10),r.focus()})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseMove",(function(e){var t=_assertThisInitialized$1(n),r=t.pos,i=t.player,o=t.config;util$2.checkTouchSupport()&&e.preventDefault(),util$2.event(e);var a=util$2.getEventPos(e,i.zoom),s=90===i.rotateDeg?a.clientY:a.clientX,u=Math.abs(r.x-s);if(!(r.moving&&u<o.miniMoveStep||!r.moving&&u<o.miniStartStep)){r.x=s;var c=n.computeTime(e);n._mouseMoveHandlerHook(e,c)}})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseOut",(function(e){n.triggerCallbacks("mouseout",null,e)})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseOver",(function(e){n.triggerCallbacks("mouseover",null,e)})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseEnter",(function(e){var t=_assertThisInitialized$1(n),r=t.player,i=t.pos;n.triggerCallbacks("mouseenter",null,e),i.isDown||i.isEnter||r.isMini||!r.config.allowSeekAfterEnded&&r.ended||(i.isEnter=!0,n.bind("mousemove",n.onMoveOnly),n.bind("mouseleave",n.onMouseLeave),n.focus())})),_defineProperty$2(_assertThisInitialized$1(n),"onMouseLeave",(function(e){n.triggerCallbacks("mouseleave",null,e);var t=_assertThisInitialized$1(n),r=t.player,i=t.pos;i.isEnter=!1,r.isMini||(n.unbind("mousemove",n.onMoveOnly),i.isDown?n.unbind("mouseleave",n.onMouseLeave):n.blur())})),n.useable=!1,n.isProgressMoving=!1,n.__dragCallBacks=[],n._state={now:-1,direc:0,time:0},n._disableBlur=!1,n}return _createClass$2(r,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"changeState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.useable=e}},{key:"createInner",value:function(){var e=this;this.innerList=new InnerList({fragments:this.config.fragments,style:this.playerConfig.commonStyle||{}}),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map((function(t){e[t]=e.innerList[t].bind(e.innerList)}))}},{key:"afterCreate",value:function(){var e=this;this.config.disable||this.playerConfig.isLive||(this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1},this.outer=this.find("xg-outer"),this.createInner(),"mobile"===sniffer.device&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(TIME_UPDATE,(function(){e.onTimeupdate()})),this.on(SEEKED,(function(){e.onTimeupdate(),e.onCacheUpdate()})),this.on(PROGRESS,(function(){e.onCacheUpdate()})),this.on(ENDED,(function(){e.onCacheUpdate(),e._state.now=0})),this.on(EMPTIED,(function(){e.onReset()})),this.bindDomEvents(),this.initCustomStyle())}},{key:"initCustomStyle",value:function(){var e=(this.playerConfig||{}).commonStyle.sliderBtnStyle,t=this.progressBtn;e&&("string"==typeof e?t.style.boxShadow=e:"object"===_typeof$2(e)&&Object.keys(e).map((function(r){t.style[r]=e[r]})))}},{key:"triggerCallbacks",value:function(e,t,r){this.__dragCallBacks.length>0&&this.__dragCallBacks.map((function(n){if(n&&n.handler&&n.type===e)try{n.handler(t,r)}catch(error){console.error("[XGPLAYER][triggerCallbacks] ".concat(n," error"),error)}}))}},{key:"addCallBack",value:function(e,t){t&&"function"==typeof t&&this.__dragCallBacks.push({type:e,handler:t})}},{key:"removeCallBack",value:function(e,t){var r=this.__dragCallBacks,n=-1;r.map((function(r,i){r&&r.type===e&&r.handler===t&&(n=i)})),n>-1&&r.splice(n,1)}},{key:"bindDomEvents",value:function(){var e=this.player,t=e.controls,r=e.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),"touch"===this.domEventType?(this.root.addEventListener("touchstart",this.onMouseDown),t&&(t.root&&t.root.addEventListener("touchmove",util$2.stopPropagation),t.center&&t.center.addEventListener("touchend",util$2.stopPropagation))):(this.bind("mousedown",this.onMouseDown),!r.isMobileSimulateMode&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut))}},{key:"focus",value:function(){util$2.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),util$2.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,t,r){var n=this.config,i=this.player;if(!n.isCloseClickSeek||0!==r){var o=e>i.duration?i.duration-.2:Number(e).toFixed(1);this.updatePercent(t),this.updateTime(e),(1!==r||n.isDragingSeek&&"audio"!==i.videoConfig.mediaType)&&(this._state.now=o,this._state.direc=o>i.currentTime?0:1,i.seek(o))}}},{key:"computeTime",value:function(e){var t,r,n,i=this.player,o=this.root.getBoundingClientRect(),a=o.width,s=o.height,u=o.top,c=o.left,l=util$2.getEventPos(e,i.zoom);90===i.rotateDeg?(t=s,r=u,n=l.clientY):(t=a,r=c,n=l.clientX);var d=n-r,f=(d=d>t?t:d<0?0:d)/t;return{percent:f=f<0?0:f>1?1:f,currentTime:parseInt(f*this.duration*1e3,10)/1e3,offset:d,width:t,left:r,e:e}}},{key:"updateTime",value:function(e){var t=this.player,r=this.duration;e>r?e=r:e<0&&(e=0);var n=t.plugins.time;n&&n.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,t){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(100*e,"%"),this.innerList.update({played:e*this.duration},this.duration);var r=this.player.plugins.miniprogress;r&&r.update({played:e*this.duration},this.duration)}}},{key:"onTimeupdate",value:function(){var e=this.player,t=this._state,r=this.duration;if(!(e.isSeeking||this.isProgressMoving||e.state<STATES$1.RUNNING)){if(t.now>-1){var n=parseInt(1e3*t.now,10)-parseInt(1e3*e.currentTime,10);if(0===t.direc&&n>300||1===t.direc&&n>-300)return void(t.now=-1);t.now=-1}var i=this.timeOffset+e.currentTime;this.innerList.update({played:i},r),this.progressBtn.style.left="".concat(i/r*100,"%");var o=this.player.plugins.miniprogress;o&&o.update({played:i},r)}}},{key:"onCacheUpdate",value:function(){var e=this.player,t=this.duration,r=e.bufferedPoint;this.innerList.update({cached:r.end},t);var n=this.player.plugins.miniprogress;n&&n.update({cached:r.end},t)}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0);var e=this.player.plugins.miniprogress;e&&e.update({cached:0,played:0},0)}},{key:"destroy",value:function(){var e=this.player,t=e.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null,"touch"===this.domEventType?(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),t&&(t.root&&t.root.removeEventListener("touchmove",util$2.stopPropagation),t.center&&t.center.removeEventListener("touchend",util$2.stopPropagation))):(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!1))}},{key:"render",value:function(){if(!this.config.disable&&!this.playerConfig.isLive){var e=this.player.controls?this.player.controls.config.mode:"";return'\n    <xg-progress class="xgplayer-progress '.concat("bottom"===e?"xgplayer-progress-bottom":"",'">\n      <xg-outer class="xgplayer-progress-outer">\n        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>\n      </xg-outer>\n    </xg-progress>\n    ')}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){}}}}]),r}(Plugin),Play=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this,t=this.player;this.config.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on(PAUSE,(function(){e.animate(t.paused)})),this.on(PLAY,(function(){e.animate(t.paused)})),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:PlaySvg,class:"xg-icon-play"},pause:{icon:PauseSvg,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.player;return this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:t.paused,to:!t.paused}),t.ended?t.replay():t.paused?(t.play(),this.animate(!1)):(t.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){var t=this.i18nKeys;e?(this.setAttr("data-state","pause"),this.changeLangTextKey(this.find(".xg-tips"),t.PLAY_TIPS)):(this.setAttr("data-state","play"),this.changeLangTextKey(this.find(".xg-tips"),t.PAUSE_TIPS))}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-play">\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys.PLAY_TIPS,'">').concat(this.i18n.PLAY_TIPS,"</div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_LEFT,index:0,disable:!1}}}]),r}(Plugin);function BackSVG(){return(new DOMParser).parseFromString('<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>\n    </g>\n</svg>',"image/svg+xml").firstChild}var TopBackIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(t){t.preventDefault(),t.stopPropagation(),e.config.onClick(t)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:BackSVG,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){util$2.addClass(this.root,"show")}},{key:"hide",value:function(){util$2.removeClass(this.root,"show")}},{key:"render",value:function(){return'<xg-icon class="xgplayer-back">\n    </xg-icon>'}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.ROOT_TOP,index:0}}}]),r}(Plugin);function FullScreenSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>\n</svg>\n',"image/svg+xml").firstChild}function ExitFullScreenSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Fullscreen=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"_onOrientationChange",(function(t){e.player.fullscreen&&e.config.rotateFullscreen&&(90===window.orientation||-90===window.orientation?e.player.setRotateDeg(0):e.player.setRotateDeg(90))})),e}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this,t=this.config,r=this.playerConfig;if(!t.disable){t.target&&(this.playerConfig.fullscreenTarget=this.config.target);var n=util$2.getFullScreenEl();r.fullscreenTarget===n&&this.player.getFullscreen(),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(t){var r=e.player.fullscreen;e.emitUserAction(t,"switch_fullscreen",{prop:"fullscreen",from:r,to:!r})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(FULLSCREEN_CHANGE,(function(t){e.changeLangTextKey(e.find(".xg-tips"),t?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(t)})),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:TopBackIcon,options:{config:{onClick:function(t){e.handleFullscreen(t)}}}})),"mobile"===sniffer.device&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:FullScreenSvg,class:"xg-get-fullscreen"},exitFullscreen:{icon:ExitFullScreenSvg,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){this.unbind(".xgplayer-icon","mobile"===sniffer.device?"touchend":"click",this.handleFullscreen),"mobile"===sniffer.device&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=this.player,r=this.config;!0===r.useCssFullscreen||"function"==typeof r.useCssFullscreen&&r.useCssFullscreen()?(t.fullscreen?t.exitCssFullscreen():t.getCssFullscreen(),this.animate(t.fullscreen)):r.rotateFullscreen?(t.fullscreen?t.exitRotateFullscreen():t.getRotateFullscreen(),this.animate(t.fullscreen)):r.switchCallback&&"function"==typeof r.switchCallback?r.switchCallback(t.fullscreen):t.fullscreen?t.exitFullscreen():t.getFullscreen()}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"show",value:function(){_get$1(_getPrototypeOf$1(r.prototype),"show",this).call(this)}},{key:"hide",value:function(){_get$1(_getPrototypeOf$1(r.prototype),"hide",this).call(this)}},{key:"render",value:function(){if(!this.config.disable){var e="FULLSCREEN_TIPS";return'<xg-icon class="xgplayer-fullscreen">\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys[e],'">').concat(this.i18n[e],"</div>\n    </xg-icon>")}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),r}(Plugin),Time=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).isActiving=!1,n}return _createClass$2(r,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"currentTime",get:function(){return this.player.currentTime||0}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this,t=this.player.controls.config.mode;this.mode="flex"===t?"flex":"normal",this.config.disable||("flex"===this.mode&&(this.createCenterTime(),this.hide()),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on(DURATION_CHANGE,(function(){e.onTimeUpdate()})),this.on(TIME_UPDATE,(function(){e.onTimeUpdate()})),this.on(EMPTIED,(function(){e.onReset()})))}},{key:"show",value:function(){"flex"!==this.mode&&_get$1(_getPrototypeOf$1(r.prototype),"show",this).call(this)}},{key:"onTimeUpdate",value:function(){var e=this.player;if(!(this.config.disable||this.isActiving||e.state<STATES$1.RUNNING&&e.state!==STATES$1.ATTACHED)){var t=this.currentTime+this.timeOffset;"flex"===this.mode?(this.centerCurDom.innerHTML=util$2.format(t),this.duration!==1/0&&this.duration>0&&(this.centerDurDom.innerHTML=util$2.format(this.duration))):(this.timeDom.innerHTML=util$2.format(t),this.duration!==1/0&&this.duration>0&&(this.durationDom.innerHTML=util$2.format(this.duration)))}}},{key:"onReset",value:function(){"flex"===this.mode?(this.centerCurDom.innerHTML=util$2.format(0),this.centerDurDom.innerHTML=util$2.format(0)):(this.timeDom.innerHTML=util$2.format(0),this.durationDom.innerHTML=util$2.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(e.controls&&e.controls.center){var t=e.controls.center;this.centerCurDom=util$2.createDom("xg-icon","00:00",{},"xgplayer-time left"),this.centerDurDom=util$2.createDom("xg-icon","00:00",{},"xgplayer-time right"),t.children.length>0?t.insertBefore(this.centerCurDom,t.children[0]):t.appendChild(this.centerCurDom),t.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var e=this.config;this.duration===1/0||this.playerConfig.isLive?(util$2.hide(this.durationDom),util$2.hide(this.timeDom),util$2.hide(this.find(".time-separator")),util$2.show(this.find(".time-live-tag"))):util$2.hide(this.find(".time-live-tag")),e.hide?this.hide():this.show()}},{key:"changeLiveState",value:function(e){e?(util$2.hide(this.durationDom),util$2.hide(this.timeDom),util$2.hide(this.find(".time-separator")),util$2.show(this.find(".time-live-tag"))):(util$2.hide(this.find(".time-live-tag")),util$2.show(this.find(".time-separator")),util$2.show(this.durationDom),util$2.show(this.timeDom))}},{key:"updateTime",value:function(e){this.isActiving=!0,!e&&0!==e||e>this.duration||("flex"!==this.mode?this.timeDom.innerHTML=util$2.format(e):this.centerCurDom.innerHTML=util$2.format(e))}},{key:"resetActive",value:function(){var e=this,t=this.player,r=function(){e.isActiving=!1};this.off(SEEKED,r),t.isSeeking?this.once(SEEKED,r):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-time">\n    <span class="time-current">00:00</span>\n    <span class="time-separator">/</span>\n    <span class="time-duration">00:00</span>\n    <span class="time-live-tag">'.concat(this.i18n.LIVE_TIP,"</span>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_LEFT,index:2,disable:!1}}}]),r}(Plugin);function volumeLargeSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>\n</svg>\n',"image/svg+xml").firstChild}function volumeSmallSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>\n</svg>\n',"image/svg+xml").firstChild}function volumeMutedSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>\n  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Volume=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"onBarMousedown",(function(t){var r=_assertThisInitialized$1(e).player,n=e.find(".xgplayer-slider"),i=e.find(".xgplayer-bar");n.focus(),util$2.event(t);var o=i.getBoundingClientRect(),a=util$2.getEventPos(t,r.zoom),s=o.height-(a.clientY-o.top);if(a.h=s,a.barH=o.height,e.pos=a,!(s<-2))return e.updateVolumePos(s,t),document.addEventListener("mouseup",e.onBarMouseUp),e.isStart=!0,!1})),_defineProperty$2(_assertThisInitialized$1(e),"onBarMouseMove",(function(t){if(e.isStart){var r=_assertThisInitialized$1(e),n=r.pos,i=r.player;t.preventDefault(),t.stopPropagation(),util$2.event(t);var o=util$2.getEventPos(t,i.zoom);e.isMoving=!0;var a=n.h-o.clientY+n.clientY;a>n.barH||e.updateVolumePos(a,t)}})),_defineProperty$2(_assertThisInitialized$1(e),"onBarMouseUp",(function(t){util$2.event(t),document.removeEventListener("mouseup",e.onBarMouseUp),e.isStart=!1,e.isMoving=!1})),_defineProperty$2(_assertThisInitialized$1(e),"onMouseenter",(function(t){e._timerId&&(util$2.clearTimeout(_assertThisInitialized$1(e),e._timerId),e._timerId=null),util$2.addClass(e.root,"slide-show")})),_defineProperty$2(_assertThisInitialized$1(e),"onMouseleave",(function(t){e._timerId&&(util$2.clearTimeout(_assertThisInitialized$1(e),e._timerId),e._timerId=null),e._timerId=util$2.setTimeout(_assertThisInitialized$1(e),(function(){util$2.removeClass(e.root,"slide-show"),e.isStart&&e.onBarMouseUp(t),e._timerId=null}),200)})),_defineProperty$2(_assertThisInitialized$1(e),"onVolumeChange",(function(t){if(e.player){var r=e.player,n=r.muted,i=r.volume;e.isMoving||(e.find(".xgplayer-drag").style.height=n||0===i?"4px":"".concat(100*i,"%"),e.config.showValueLabel&&e.updateVolumeValue()),e.animate(n,i)}})),e}return _createClass$2(r,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:volumeSmallSvg,class:"xg-volume-small"},volumeLarge:{icon:volumeLargeSvg,class:"xg-volume"},volumeMuted:{icon:volumeMutedSvg,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var e=this;if(this._timerId=null,!this.config.disable){this.initIcons();var t=this.playerConfig,r=t.commonStyle,n=t.volume;r.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=r.volumeColor),this.changeMutedHandler=this.hook("mutedChange",(function(t){e.changeMuted(t)}),{pre:function(e){e.preventDefault(),e.stopPropagation()}}),"mobile"===sniffer.device||this.playerConfig.isMobileSimulateMode||(this.bind("mouseenter",this.onMouseenter),this.bind(["blur","mouseleave"],this.onMouseleave),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(VOLUME_CHANGE,this.onVolumeChange),this.once(LOADED_DATA,this.onVolumeChange),"Number"!==util$2.typeOf(n)&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(e,t){var r=this.player,n=this.find(".xgplayer-drag"),i=this.find(".xgplayer-bar");if(i&&n){var o=parseInt(e/i.getBoundingClientRect().height*1e3,10);n.style.height="".concat(e,"px");var a=Math.max(Math.min(o/1e3,1),0),s={volume:{from:r.volume,to:a}};r.muted&&(s.muted={from:!0,to:!1}),this.emitUserAction(t,"change_volume",{muted:r.muted,volume:r.volume,props:s}),r.volume=Math.max(Math.min(o/1e3,1),0),r.muted&&(r.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var e=this.player,t=e.volume,r=e.muted,n=this.find(".xgplayer-value-label"),i=Math.max(Math.min(t,1),0);n.innerText=r?0:Math.ceil(100*i)}},{key:"changeMuted",value:function(e){e&&e.stopPropagation();var t=this.player;this.isStart&&this.onBarMouseUp(e),this.emitUserAction(e,"change_muted",{muted:t.muted,volume:t.volume,props:{muted:{from:t.muted,to:!t.muted}}}),t.volume>0&&(t.muted=!t.muted),t.volume<.01&&(t.volume=this.config.miniVolume)}},{key:"animate",value:function(e,t){e||0===t?this.setAttr("data-state","mute"):t<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.volumeSmall),this.appendChild(".xgplayer-icon",e.volumeLarge),this.appendChild(".xgplayer-icon",e.volumeMuted)}},{key:"destroy",value:function(){this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon","mobile"===sniffer.device?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var e=this.config.default||this.player.volume,t=this.config.showValueLabel;return'\n    <xg-icon class="xgplayer-volume" data-state="normal">\n      <div class="xgplayer-icon">\n      </div>\n      <xg-slider class="xgplayer-slider">\n        '.concat(t?'<div class="xgplayer-value-label">'.concat(100*e,"</div>"):"",'\n        <div class="xgplayer-bar">\n          <xg-drag class="xgplayer-drag" style="height: ').concat(100*e,'%"></xg-drag>\n        </div>\n      </xg-slider>\n    </xg-icon>')}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),r}(Plugin);function RotateSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">\n  <g clip-path="url(#clip0)">\n    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>\n    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>\n  </g>\n  <defs>\n    <clipPath id="clip0">\n      <rect width="40" height="40" fill="white"/>\n    </clipPath>\n  </defs>\n</svg>\n',"image/svg+xml").firstChild}var Rotate=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).rotateDeg=n.config.rotateDeg||0,n}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.config.disable||(this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(VIDEO_RESIZE,(function(){e.rotateDeg&&util$2.setTimeout(e,(function(){e.updateRotateDeg(e.rotateDeg,e.config.innerRotate)}),100)})),this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate))}},{key:"destroy",value:function(){this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(e,t){var r=this.player;e||(e=0);var n=this.player,i=n.root,o=n.innerContainer,a=n.video,s=i.offsetWidth,u=o&&t?o.offsetHeight:i.offsetHeight,c="100%",l="100%",d=0,f=0;.75!==e&&.25!==e||(c="".concat(u,"px"),l="".concat(s,"px"),d=-(u-s)/2,f=-(s-u)/2);var h="translate(".concat(d,"px,").concat(f,"px) rotate(").concat(e,"turn)"),p={transformOrigin:"center center",transform:h,webKitTransform:h,height:l,width:c},g=t?a:i,y=t?r.getPlugin("poster"):null;Object.keys(p).map((function(e){g.style[e]=p[e],y&&y.root&&(y.root.style[e]=p[e])}))}},{key:"rotate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.player;this.rotateDeg||(this.rotateDeg=0);var i=e?1:-1;this.rotateDeg=(this.rotateDeg+1+.25*i*r)%1,this.updateRotateDeg(this.rotateDeg,t),n.emit(ROTATE,360*this.rotateDeg)}},{key:"registerIcons",value:function(){return{rotate:RotateSvg}}},{key:"render",value:function(){if(!this.config.disable)return'\n    <xg-icon class="xgplayer-rotate">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="'.concat(this.i18nKeys.ROTATE_TIPS,'">\n      ').concat(this.i18n.ROTATE_TIPS,"\n      </div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),r}(Plugin);function PipIcon(){return(new DOMParser).parseFromString('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd"\n    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"\n    fill="white" />\n</svg>',"image/svg+xml").firstChild}function PipIconExit(){return(new DOMParser).parseFromString('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd"\n    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"\n    fill="white" />\n  <path fill-rule="evenodd" clip-rule="evenodd"\n    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"\n    fill="white" />\n</svg>',"image/svg+xml").firstChild}var PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},PIP=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"switchPIP",(function(t){if(!e.isPIPAvailable())return!1;t.stopPropagation(),e.isPip?(e.exitPIP(),e.emitUserAction(t,"change_pip",{props:"pip",from:!0,to:!1}),e.setAttr("data-state","normal")):4===e.player.video.readyState&&(e.requestPIP(),e.emitUserAction(t,"change_pip",{props:"pip",from:!1,to:!0}),e.setAttr("data-state","pip"))})),e}return _createClass$2(r,[{key:"beforeCreate",value:function(e){"boolean"==typeof e.player.config.pip&&(e.config.showIcon=e.player.config.pip)}},{key:"afterCreate",value:function(){var e=this;this.isPIPAvailable()&&(this.pMode=PresentationMode.INLINE,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(COMPLETE,(function(){e.config.showIcon&&(util$2.removeClass(e.find(".xgplayer-icon"),"xg-icon-disable"),e.bind("click",e.switchPIP))})))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:PipIcon,class:"xg-get-pip"},pipIconExit:{icon:PipIconExit,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.pipIcon),this.appendChild(".xgplayer-icon",e.pipIconExit)}},{key:"initPipEvents",value:function(){var e=this,t=this.player;this.leavePIPCallback=function(){var r=t.paused;util$2.setTimeout(e,(function(){!r&&t.videoPlay()}),0),!r&&t.videoPlay(),e.setAttr("data-state","normal"),t.emit(PIP_CHANGE,!1)},this.enterPIPCallback=function(r){t.emit(PIP_CHANGE,!0),e.pipWindow=r.pictureInPictureWindow,e.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(r){var n=t.video.webkitPresentationMode;e.pMode===PresentationMode.FULLSCREEN&&n!==PresentationMode.FULLSCREEN&&t.onFullscreenChange(null,!1),e.pMode=n,n===PresentationMode.PIP?e.enterPIPCallback(r):n===PresentationMode.INLINE&&e.leavePIPCallback(r)},t.video&&(t.video.addEventListener("enterpictureinpicture",this.enterPIPCallback),t.video.addEventListener("leavepictureinpicture",this.leavePIPCallback),r.checkWebkitSetPresentationMode(t.video)&&t.video.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"requestPIP",value:function(){var e=this.player,t=this.playerConfig;if(this.isPIPAvailable()&&!this.isPip)try{var n=t.poster;return n&&(e.video.poster="String"===util$2.typeOf(n)?n:n.poster),r.checkWebkitSetPresentationMode(e.video)?e.video.webkitSetPresentationMode("picture-in-picture"):e.video.requestPictureInPicture(),!0}catch(i){return console.error("requestPiP",i),!1}}},{key:"exitPIP",value:function(){var e=this.player;try{return this.isPIPAvailable()&&this.isPip&&(r.checkWebkitSetPresentationMode(e.video)?e.video.webkitSetPresentationMode("inline"):document.exitPictureInPicture()),!0}catch(t){return console.error("exitPIP",t),!1}}},{key:"isPip",get:function(){var e=this.player;return document.pictureInPictureElement&&document.pictureInPictureElement===e.video||e.video.webkitPresentationMode===PresentationMode.PIP}},{key:"isPIPAvailable",value:function(){var e=this.player.video;return("Boolean"!==util$2.typeOf(document.pictureInPictureEnabled)||document.pictureInPictureEnabled)&&("Boolean"===util$2.typeOf(e.disablePictureInPicture)&&!e.disablePictureInPicture||e.webkitSupportsPresentationMode&&"Function"===util$2.typeOf(e.webkitSetPresentationMode))}},{key:"destroy",value:function(){var e=this.player;e.video.removeEventListener("enterpictureinpicture",this.enterPIPCallback),e.video.removeEventListener("leavepictureinpicture",this.leavePIPCallback),r.checkWebkitSetPresentationMode(e.video)&&e.video.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(this.config.showIcon&&this.isPIPAvailable())return'<xg-icon class="xgplayer-pip">\n      <div class="xgplayer-icon xg-icon-disable">\n      </div>\n      <div class="xg-tips" lang-key="'.concat(this.i18nKeys.PIP,'">').concat(this.i18n.PIP,"</div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:6,showIcon:!1}}},{key:"checkWebkitSetPresentationMode",value:function(e){return"function"==typeof e.webkitSetPresentationMode}}]),r}(Plugin);function Next(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">\n  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>\n</svg>\n',"image/svg+xml").firstChild}var PlayNextIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"playNext",(function(e){var t=_assertThisInitialized$1(n).player;e.preventDefault(),e.stopPropagation(),n.idx+1<n.config.urlList.length?(n.idx++,n.nextHandler(n.config.urlList[n.idx],n.idx),t.emit(PLAYNEXT,n.idx+1)):(n.nextHandler(),t.emit(PLAYNEXT))})),n.idx=-1,n}return _createClass$2(r,[{key:"afterCreate",value:function(){this.config.urlList&&0!==this.config.urlList.length&&(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:Next}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e="mobile"===sniffer.device?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var t=this.player;e&&(t.pause(),t.currentTime=0,t.switchURL?t.switchURL(e):t.src=e,t.config.url=e,t.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(this.config.urlList&&0!==this.config.urlList.length)return'\n     <xg-icon class="xgplayer-playnext">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="PLAYNEXT_TIPS">'.concat(this.i18n.PLAYNEXT_TIPS,"</div>\n     </xg-icon>\n    ")}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),r}(Plugin),download={exports:{}};!function(e,t){e.exports=function e(t,r,n){var i,o,a=window,s="application/octet-stream",u=n||s,c=t,l=!r&&!n&&c,d=document.createElement("a"),f=function(e){return String(e)},h=a.Blob||a.MozBlob||a.WebKitBlob||f,p=r||"download";if(h=h.call?h.bind(a):Blob,"true"===String(this)&&(u=(c=[c,u])[0],c=c[1]),l&&l.length<2048&&(p=l.split("/").pop().split("?")[0],d.href=l,-1!==d.href.indexOf(l))){var g=new XMLHttpRequest;return g.open("GET",l,!0),g.responseType="blob",g.onload=function(t){e(t.target.response,p,s)},setTimeout((function(){g.send()}),0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&h!==f))return navigator.msSaveBlob?navigator.msSaveBlob(_(c),p):b(c);u=(c=_(c)).type||s}else if(/([\x80-\xff])/.test(c)){for(var y=0,v=new Uint8Array(c.length),m=v.length;y<m;++y)v[y]=c.charCodeAt(y);c=new h([v],{type:u})}function _(e){for(var t=e.split(/[:;,]/),r=t[1],n=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=n.length,o=0,a=new Uint8Array(i);o<i;++o)a[o]=n.charCodeAt(o);return new h([a],{type:r})}function b(e,t){if("download"in d)return d.href=e,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){a.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var r=document.createElement("iframe");document.body.appendChild(r),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),r.src=e,setTimeout((function(){document.body.removeChild(r)}),333)}if(i=c instanceof h?c:new h([c],{type:u}),navigator.msSaveBlob)return navigator.msSaveBlob(i,p);if(a.URL)b(a.URL.createObjectURL(i),!0);else{if("string"==typeof i||i.constructor===f)try{return b("data:"+u+";base64,"+a.btoa(i))}catch(A){return b("data:"+u+","+encodeURIComponent(i))}(o=new FileReader).onload=function(e){b(this.result)},o.readAsDataURL(i)}return!0}}(download);var downloadUtil=download.exports;function DownloadSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">\n  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">\n      <g id="Group-2">\n        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">\n          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>\n          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>\n          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>\n          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>\n        </g>\n      </g>\n    </g>\n  </g>\n</svg>\n',"image/svg+xml").firstChild}var Download=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"download",(function(e){if(!n.isLock){n.emitUserAction(e,"download");var t=n.getAbsoluteURL(n.player.src);downloadUtil(t),n.isLock=!0,n.timer=window.setTimeout((function(){n.isLock=!1,window.clearTimeout(n.timer),n.timer=null}),300)}})),n.timer=null,n.isLock=!1,n}return _createClass$2(r,[{key:"afterCreate",value:function(){this.config.disable||(this.appendChild(".xgplayer-icon",this.icons.download),this.bind(["click","touchend"],this.download))}},{key:"registerIcons",value:function(){return{download:DownloadSvg}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var t=document.createElement("div");t.innerHTML='<a href="'.concat(e,'">x</a>'),e=t.firstChild.href}return e}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-download">\n   <div class="xgplayer-icon">\n   </div>\n   <div class="xg-tips" lang-key="'.concat(this.i18nKeys.DOWNLOAD_TIPS,'">').concat(this.i18n.DOWNLOAD_TIPS,"</div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:3,disable:!0}}}]),r}(Plugin),ScreenShot=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"beforeCreate",value:function(e){"boolean"==typeof e.player.config.screenShot&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(t){e.fitVideo&&(e.width=t.vWidth,e.height=t.vHeight)},this.once(VIDEO_RESIZE,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,t){var r=document.createElement("a");r.href=e,r.download=t;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(n)}},{key:"createCanvans",value:function(e,t){var r=document.createElement("canvas");this.canvasCtx=r.getContext("2d"),this.canvas=r,r.width=e||this.config.width,r.height=t||this.config.height}},{key:"onClickBtn",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot"),this.shot().then((function(e){t.emit(SCREEN_SHOT,e),t.saveScreenShot(e,t.config.name+t.config.format)}))}},{key:"shot",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{quality:.92,type:"image/png"},i=this.config,o=this.player,a=n.quality||i.quality,s=n.type||i.type;return new Promise((function(n,u){var c=null;o.video.canvas?c=o.video.canvas:(r.canvas?(r.canvas.width=e||i.width,r.canvas.height=t||i.height):r.createCanvans(e,t),r.canvasCtx.drawImage(o.video,0,0,e||i.width,t||i.height),c=r.canvas);var l=c.toDataURL(s,a).replace(s,"image/octet-stream");n(l=l.replace(/^data:image\/[^;]+/,"data:application/octet-stream"))}))}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.onClickBtn),this.off(VIDEO_RESIZE,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",t="SCREENSHOT";return'\n      <xg-icon class="xgplayer-shot">\n      <div class="'.concat(e,'">\n      ').concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[t],'">').concat(this.i18n[t],"</span>")," \n      </div>\n    </xg-icon>")}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,fitVideo:!0,disable:!1,name:"screenshot"}}}]),r}(Plugin),OptionList=function(){function e(t){_classCallCheck$2(this,e),this.config=t.config,this.parent=t.root,this.root=util$2.createDom("ul","",{},"xg-options-list ".concat(this.config.className)),t.root.appendChild(this.root),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var r="mobile"===sniffer.device?"touchend":"click";this._delegates=Plugin.delegate.call(this,this.root,"li",r,this.onItemClick)}return _createClass$2(e,[{key:"renderItemList",value:function(e){var t=this,r=this.config,n=this.root;e?r.data=e:e=r.data,r.style&&Object.keys(r.style).map((function(e){n.style[e]=r[e]})),e.length>0&&(this.attrKeys=Object.keys(e[0])),this.root.innerHTML="",e.map((function(e,r){var n=e.selected?"option-item selected":"option-item";e["data-index"]=r,t.root.appendChild(util$2.createDom("li","<span>".concat(e.showText,"</span>"),e,n))}))}},{key:"onItemClick",value:function(e){e.delegateTarget||(e.delegateTarget=e.target);var t=e.delegateTarget;if(t&&util$2.hasClass(t,"selected"))return!1;var r="function"==typeof this.config.onItemClick?this.config.onItemClick:null,n=this.root.querySelector(".selected");util$2.addClass(t,"selected"),n&&util$2.removeClass(n,"selected"),r(e,{from:n?this.getAttrObj(n,this.attrKeys):null,to:this.getAttrObj(t,this.attrKeys)})}},{key:"getAttrObj",value:function(e,t){if(!e||!t)return{};var r={};t.map((function(t){r[t]=e.getAttribute(t)}));var n=e.getAttribute("data-index");return n&&(r.index=Number(n)),r}},{key:"show",value:function(){util$2.removeClass(this.root,"hide"),util$2.addClass(this.root,"active")}},{key:"hide",value:function(){util$2.removeClass(this.root,"active"),util$2.addClass(this.root,"hide")}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map((function(e){e.destroy&&e.destroy()})),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),e}(),IS_MOBILE="mobile"===sniffer.device,OptionsIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).isActive=!1,n.curValue=null,n.curIndex=0,n}return _createClass$2(r,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,t=this.config;IS_MOBILE&&"middle"!==t.listType&&(t.listType="rightSide"),t.hidePortrait&&util$2.addClass(this.root,"portrait"),this.once(CANPLAY,(function(){t.list&&t.list.length>0&&(e.renderItemList(t.list),e.show())})),IS_MOBILE&&this.on(PLAYER_FOCUS,(function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)})),this.activeEvent=IS_MOBILE?"touchend":"mouseenter",this.onEnter=this.onEnter.bind(this),this.onLeave=this.onLeave.bind(this),this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)}},{key:"show",value:function(){!this.config.list||this.config.list.length<2||util$2.addClass(this.root,"show")}},{key:"hide",value:function(){util$2.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,t,r){if(void 0===e)return"";var n=this.config.list;return!r&&(r=this.player.lang),t=!t||util$2.isUndefined(e[t])?"text":t,"number"==typeof e&&(e=n[e]),"object"===_typeof$2(e[t])?e[t][r]||e[t].zh:e[t]||""}},{key:"onEnter",value:function(e){e.preventDefault(),e.stopPropagation(),this.onToggle(!0)}},{key:"onLeave",value:function(e){e.preventDefault(),e.stopPropagation(),this.isActive&&this.onToggle(!1)}},{key:"onToggle",value:function(e){if(this.isActive!==e){var t=this.player.controls,r=this.config.listType;e?("rightSide"===r?t.blur():t.focus(),this.optionsList&&this.optionsList.show()):("rightSide"===r?t.focus():t.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,t){e.preventDefault(),e.stopPropagation();var r=this.config,n=r.listType,i=r.list;(IS_MOBILE||"rightSide"===n)&&this.onToggle(!1),this.curIndex=t.to.index,this.curItem=i[this.curIndex],this.changeCurrentText(),this.onToggle(!1)}},{key:"changeCurrentText",value:function(){var e=this.config.list,t=e[this.curIndex<e.length?this.curIndex:0];t&&(this.find(".icon-text").innerHTML=this.getTextByLang(t,"iconText"))}},{key:"renderItemList",value:function(e,t){var r=this,n=this.config,i=this.optionsList,o=this.player;if("number"==typeof t&&(this.curIndex=t,this.curItem=n.list[t]),i)return i.renderItemList(e),void this.changeCurrentText();var a={config:{data:e||[],className:"rightSide"===n.listType?"right-side":"",onItemClick:function(e,t){r.onItemClick(e,t)}},root:"rightSide"===n.listType?o.root:this.root};this.config.isShowIcon&&(this.optionsList=new OptionList(a),this.changeCurrentText(),this.show())}},{key:"destroy",value:function(){this.unbind(this.activeEvent,this.onToggle),this.unbind("mouseleave",this.onToggle),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",'">\n    <div class="xgplayer-icon btn-text">\n    <span class="icon-text"></span>\n    </div>\n   </xg-icon>')}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:100,list:[],listType:"middle",listStyle:{},hidePortrait:!0,isShowIcon:!1}}}]),r}(Plugin),DefinitionIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).curTime=0,n.isPaused=!0,n}return _createClass$2(r,[{key:"beforeCreate",value:function(e){var t=e.config.list;Array.isArray(t)&&t.length>0&&(e.config.list=t.map((function(e){return!e.text&&e.name&&(e.text=e.name),e.text||(e.text=e.definition),e})))}},{key:"afterCreate",value:function(){var e=this;_get$1(_getPrototypeOf$1(r.prototype),"afterCreate",this).call(this),this.on("resourceReady",(function(t){e.changeDefinitionList(t)})),this.on(DEFINITION_CHANGE,(function(t){e.renderItemList(e.config.list,t.to)})),this.player.definitionList.length<2&&this.hide()}},{key:"initDefinition",value:function(){var e=this.config,t=e.list,r=e.defaultDefinition;if(t.length>0){var n=null;t.map((function(e){e.definition===r&&(n=e)})),n||(n=t[0]),this.changeDefinition(n)}}},{key:"renderItemList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.list||[],n=arguments.length>1?arguments[1]:void 0,i=n&&n.definition?n.definition:this.config.defaultDefinition;n&&t.forEach((function(e){e.selected=!1}));var o=0,a=t.map((function(t,r){var n={url:t.url,definition:t.definition||"",showText:e.getTextByLang(t)||t.definition,selected:!1};return(t.selected||t.definition&&t.definition===i)&&(n.selected=!0,o=r),n}));_get$1(_getPrototypeOf$1(r.prototype),"renderItemList",this).call(this,a,o)}},{key:"changeDefinitionList",value:function(e){Array.isArray(e)&&(this.config.list=e.map((function(e){return!e.text&&e.name&&(e.text=e.name),e.text||(e.text=e.definition),e})),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(e,t){this.player.changeDefinition(e,t)}},{key:"onItemClick",value:function(e,t){_get$1(_getPrototypeOf$1(r.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(e,"change_definition",{from:t.from,to:t.to}),this.player.changeDefinition(t.to,t.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0}}}]),r}(OptionsIcon),PlaybackRate=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).curRate=1,n}return _createClass$2(r,[{key:"beforeCreate",value:function(e){var t=e.player.config.playbackRate,r=t?Array.isArray(t)?t:e.config.list:[];Array.isArray(r)&&(e.config.list=r.map((function(e){return"number"==typeof e?e={rate:e,text:"".concat(e,"x")}:!e.text&&e.rate&&(e.text="".concat(e.rate,"x")),e})))}},{key:"afterCreate",value:function(){var e=this;_get$1(_getPrototypeOf$1(r.prototype),"afterCreate",this).call(this),this.on(RATE_CHANGE,(function(){e.curValue!==e.player.playbackRate&&e.renderItemList()})),this.renderItemList()}},{key:"show",value:function(){this.config.list&&0!==this.config.list.length&&_get$1(_getPrototypeOf$1(r.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(e,t){_get$1(_getPrototypeOf$1(r.prototype),"onItemClick",this).apply(this,arguments);var n=e.delegateTarget,i=Number(n.getAttribute("rate"));if(!i||i===this.curValue)return!1;var o={playbackRate:{from:this.player.playbackRate,to:i}};this.emitUserAction(e,"change_rate",{props:o}),this.curValue=i,this.player.playbackRate=i}},{key:"renderItemList",value:function(){var e=this,t=this.player.playbackRate||1;this.curValue=t;var n=0,i=this.config.list.map((function(r,i){var o={rate:r.rate};return o.rate===t&&(o.selected=!0,n=i),o.showText=e.getTextByLang(r),o}));_get$1(_getPrototypeOf$1(r.prototype),"renderItemList",this).call(this,i,n)}},{key:"destroy",value:function(){_get$1(_getPrototypeOf$1(r.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1}}}]),r}(OptionsIcon);function CssFullSceenSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">\n  <path fill="#fff" transform="scale(1.3, 1.3)" class=\'path_full\' d="M9,10v1a.9.9,0,0,1-1,1,.9.9,0,0,1-1-1V9A.9.9,0,0,1,8,8h2a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1Zm6,4V13a1,1,0,0,1,2,0v2a.9.9,0,0,1-1,1H14a1,1,0,0,1,0-2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>\n</svg>\n',"image/svg+xml").firstChild}function ExitCssFullSceenSvg(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">\n  <path fill="#fff" transform="scale(1.3, 1.3)" d="M9,10V9a.9.9,0,0,1,1-1,.9.9,0,0,1,1,1v2a.9.9,0,0,1-1,1H8a.9.9,0,0,1-1-1,.9.9,0,0,1,1-1Zm6,4v1a1,1,0,0,1-2,0V13a.9.9,0,0,1,1-1h2a1,1,0,0,1,0,2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>\n</svg>\n',"image/svg+xml").firstChild}var CssFullScreen=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.config.disable||(this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(CSS_FULLSCREEN_CHANGE,(function(t){e.animate(t)})),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(e){e.preventDefault(),e.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen))}},{key:"initIcons",value:function(){var e=this.icons,t=this.find(".xgplayer-icon");t.appendChild(e.cssFullscreen),t.appendChild(e.exitCssFullscreen)}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.player.isCssfullScreen;this.emitUserAction(e,"switch_cssfullscreen",{cssfullscreen:t}),t?this.player.exitCssFullscreen():this.player.getCssFullscreen()}},{key:"animate",value:function(e){this.root&&(e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(e))}},{key:"switchTips",value:function(e){var t=this.i18nKeys;this.changeLangTextKey(this.find(".xg-tips"),e?t.EXITCSSFULLSCREEN_TIPS:t.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:CssFullSceenSvg,class:"xg-get-cssfull"},exitCssFullscreen:{icon:ExitCssFullSceenSvg,class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class=\'xgplayer-cssfullscreen\'>\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys.EXITCSSFULLSCREEN_TIPS,'">').concat(this.i18n.CSSFULLSCREEN_TIPS,"</div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}]),r}(Plugin),ErrorPlugin$1=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(e){e.preventDefault(),e.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(CANPLAY,(function(){e.handleCanPlay()})),this.on(ERROR$2,(function(t){e.onError(t)}))}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleCanPlay",value:function(){util$2.removeClass(this.player.root,"xgplayer-is-error")}},{key:"handleError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.player,r=e.errorType,n=t.errorNote?this.i18n[t.errorNote]:"";if(!n)switch(r){case"decoder":n=this.i18n.MEDIA_ERR_DECODE;break;case"network":n=this.i18n.MEDIA_ERR_NETWORK;break;default:n=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=n,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return'<xg-error class="xgplayer-error">\n      <div class="xgplayer-errornote">\n       <span class="xgplayer-error-text"></span>\n       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>\n      </div>\n    </xg-error>'}}],[{key:"pluginName",get:function(){return"error"}}]),r}(Plugin),Prompt=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],(function(t){(e.config.onClick||e.customOnClick)&&(t.preventDefault(),t.stopPropagation(),e.customOnClick?e.customOnClick(t):e.config.onClick(t))})),this.player.showPrompt=function(){e.show.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var t=this;Object.keys(e).map((function(r){t.root.style[r]=e[r]}))}},{key:"show",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e){this.customOnClick=n;var i=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),util$2.addClass(this.root,"show"),"arrow"===r.mode&&util$2.addClass(this.root,"arrow"),this.find(".xgplayer-prompt-detail").innerHTML="string"==typeof e?e:"".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),r.style&&this.setStyle(r.style);var o="boolean"==typeof r.autoHide?r.autoHide:this.config.autoHide;if(o){var a=r.interval||i;this.intervalId=setTimeout((function(){t.hide()}),a)}}}},{key:"hide",value:function(){util$2.removeClass(this.root,"show"),util$2.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(STATE_CLASS.CONTROLS_FOLLOW,'">\n    <span class="xgplayer-prompt-detail"></span>\n    </xg-prompt>')}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),r}(Plugin),ISPOT={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function mergeISPOT(e){Object.keys(ISPOT).map((function(t){void 0===e[t]&&(e[t]=ISPOT[t])}))}var APIS={initDots:function(){var e=this;this._ispots.map((function(t){e.createDot(t,!1)})),this._ispotsInit=!0},createDot:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.player.plugins.progress;if(r&&(t&&(mergeISPOT(e),this._ispots.push(e)),this._ispotsInit||!t)){var n=this.calcuPosition(e.time,e.duration),i=e.style||{};i.left="".concat(n.left,"%"),i.width="".concat(n.width,"%");var o="xgspot_".concat(e.id," xgplayer-spot");n.isMini&&(o+=" mini");var a=util$2.createDom("xg-spot",e.template||"",{"data-text":e.text,"data-time":e.time,"data-id":e.id},o);Object.keys(i).map((function(e){a.style[e]=i[e]})),r.outer&&r.outer.appendChild(a)}},findDot:function(e){if(this.player.plugins.progress){var t=this._ispots.filter((function(t,r){return t.id===e}));return t.length>0?t[0]:null}},updateDot:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.player.plugins.progress;if(r){var n=this.findDot(e.id);if(n&&Object.keys(e).map((function(t){n[t]=e[t]})),this._ispotsInit){var i=r.find('xg-spot[data-id="'.concat(e.id,'"]'));if(i){var o=this.calcuPosition(e.time,e.duration),a=e.style||{};a.left="".concat(o.left,"%"),a.width="".concat(o.width,"%"),i.setAttribute("data-text",e.text),i.setAttribute("data-time",e.time),o.isMini?util$2.addClass(i,"mini"):util$2.removeClass(i,"mini"),Object.keys(a).map((function(e){i.style[e]=a[e]})),t&&this.showDot(e.id)}}}},deleteDot:function(e){var t=this._ispots,r=this.player.plugins.progress;if(r){for(var n=[],i=0;i<t.length;i++)t[i].id===e&&n.push(i);for(var o=n.length-1;o>=0;o--)if(t.splice(n[o],1),this._ispotsInit){var a=r.find('xg-spot[data-id="'.concat(e,'"]'));a&&a.parentElement.removeChild(a)}}},deleteAllDots:function(){var e=this.player.plugins.progress;if(e)if(this._ispotsInit){for(var t=e.root.getElementsByTagName("xg-spot"),r=t.length-1;r>=0;r--)e.outer.removeChild(t[r]);this._ispots=[]}else this._ispots=[]},updateAllDots:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=this.player.plugins.progress;if(r)if(this._ispotsInit){this._ispots=[];var n=r.root.getElementsByTagName("xg-spot"),i=n.length;if(i>t.length)for(var o=i-1;o>t.length-1;o--)r.outer.removeChild(n[o]);t.map((function(t,r){r<i?(n[r].setAttribute("data-id","".concat(t.id)),e._ispots.push(t),e.updateDot(t)):e.createDot(t)}))}else this._ispots=t},getAllDotsDom:function(){var e=this.player.plugins.progress;return e?e.root.getElementsByTagName("xg-spot"):[]},getDotDom:function(e){var t=this.player.plugins.progress;if(t)return t.find('xg-spot[data-id="'.concat(e,'"]'))}};function initDotsAPI(e){var t=e.config,r=e.player;Object.keys(APIS).map((function(t){e[t]=APIS[t].bind(e)}));var n=r.config.progressDot||t.ispots||[];e._ispots=n.map((function(e){return mergeISPOT(e),e})),e._ispotsInit=!1,r.once(DURATION_CHANGE,(function(){e.initDots()}))}var CALLBACK_MAP={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver"},ProgressPreview=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),_defineProperty$2(_assertThisInitialized$1(n=t.call(this,e)),"onMousemove",(function(e){(n._state.f||util$2.hasClass(e.target,"xg-spot-content"))&&(util$2.event(e),e.stopPropagation())})),_defineProperty$2(_assertThisInitialized$1(n),"onMousedown",(function(e){(n._state.f||util$2.hasClass(e.target,"xg-spot-content"))&&(util$2.event(e),e.stopPropagation())})),_defineProperty$2(_assertThisInitialized$1(n),"onDotMouseLeave",(function(e){n._curDot.removeEventListener("mouseleave",n.onDotMouseLeave),n.blurDot(e.target),n._curDot=null;var t=n.player.plugins.progress;t&&t.enableBlur(),n.show()})),_defineProperty$2(_assertThisInitialized$1(n),"onProgressMouseOver",(function(e,t){if(util$2.hasClass(t.target,"xgplayer-spot")&&!n._curDot){n._curDot=t.target,n.focusDot(t.target),n._curDot.children.length>0&&n.hide();var r=n.player.plugins.progress;r&&r.disableBlur(),n._curDot.addEventListener("mouseleave",n.onDotMouseLeave)}})),n._ispots=[],n.videoPreview=null,n.videothumbnail=null,n.thumbnail=null,n._state={now:0,f:!1},n}return _createClass$2(r,[{key:"beforeCreate",value:function(e){var t=e.player.plugins.progress;t&&(e.root=t.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",(function(t,r){r.time&&e.player.seek(r.time)})),initDotsAPI(this)}},{key:"onPluginsReady",value:function(){this.player.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this,t=this.player.plugins.progress;if(t&&(Object.keys(CALLBACK_MAP).map((function(r){e[CALLBACK_MAP[r]]=e[CALLBACK_MAP[r]].bind(e),t.addCallBack(r,e[CALLBACK_MAP[r]])})),"mobile"!==sniffer.device)){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown);var r=this.hook("previewClick",(function(){}));this.handlerPreviewClick=function(t){t.stopPropagation(),r(parseInt(1e3*e._state.now,10)/1e3,t)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(e,t){this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){console.log("onProgressDragStart"),this.isDrag=!0,this.videoPreview&&util$2.addClass(this.videoPreview,"show")}},{key:"onProgressDragEnd",value:function(e){this.isDrag=!1,this.videoPreview&&util$2.removeClass(this.videoPreview,"show")}},{key:"onProgressClick",value:function(e,t){if(util$2.hasClass(t.target,"xgplayer-spot")){t.stopPropagation(),t.preventDefault();var r={};["time","id","text"].map((function(e){r[e]=t.target.getAttribute("data-".concat(e))})),r.time&&(r.time=Number(r.time)),this.handlerSpotClick(t,r)}}},{key:"updateLinePos",value:function(e,t){var r,n,i=this.root,o=this.previewLine,a=this.timePoint,s="flex"===this.player.controls.mode,u=i.getBoundingClientRect().width,c=a.getBoundingClientRect().width,l=e-u/2;l<0&&!s?(l=0,r=e-u/2,!this.thumbnail&&(n=e-u/2-c/2)):l>t-u&&!s?(r=l-(t-u),!this.thumbnail&&(n=l-(t-u)-c/2),l=t-u):!this.thumbnail&&(n=-c/2),o.style.transform=void 0!==r?"translateX(".concat(r,"px)"):"",a.style.transform=void 0!==n?"translateX(".concat(n,"px)"):"",i.style.transform="translateX(".concat(l,"px)")}},{key:"updateTimeText",value:function(e){var t=this.timeText,r=this.timePoint;t.textContent=e,!this.thumbnail&&(r.textContent=e)}},{key:"updatePosition",value:function(e,t,r,n){var i=this.root,o=this.config,a=this._state;if(i){this.updateLinePos(e,t),a.now=r;var s=util$2.format(r);n&&n.target&&util$2.hasClass(n.target,"xgplayer-spot")?(this.showTips(n.target.getAttribute("data-text"),!1,s),this.focusDot(n.target),a.f=!0,o.isFocusDots&&a.f&&(a.now=parseInt(n.target.getAttribute("data-time"),10))):o.defaultText?(a.f=!1,this.showTips(o.defaultText,!0,s)):(a.f=!1,this.hideTips("")),this.updateTimeText(s),this.updateThumbnails(a.now)}}},{key:"updateThumbnails",value:function(e){var t=this.player,r=this.videoPreview,n=t.plugins.thumbnail;if(n&&n.usable){this.thumbnail&&n.update(this.thumbnail,e,160,90);var i=r&&r.getBoundingClientRect();this.videothumbnail&&n.update(this.videothumbnail,e,i.width,i.height)}}},{key:"changeThumbnail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("mobile"!==sniffer.device){var t=this.player,r=this.config,n=t.getPlugin("thumbnail");if(n.changeConfig(e),n&&n.usable&&r.isShowThumbnail){util$2.removeClass(this.root,"short-line no-thumbnail"),this._hasThumnail=!0;var i=this.find(".xg-spot-thumbnail");this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.thumbnail&&i.removeChild(this.thumbnail),this.thumbnail=n.createThumbnail(i,"progress-thumbnail"),r.isShowCoverPreview&&(this.videoPreview=util$2.createDom("xg-video-preview","",{},"xgvideo-preview"),t.root.appendChild(this.videoPreview),this.videothumbnail=n.createThumbnail(this.videoPreview,"xgvideo-thumbnail"))}else{util$2.addClass(this.root,"short-line no-thumbnail");var o=this.find(".xg-spot-thumbnail");this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.thumbnail&&o.removeChild(this.thumbnail),this.videothumbnail=null,this.thumbnail=null,this._hasThumnail=!1}}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("mobile"!==sniffer.device){var t=this.player,r=this.config,n=t.getPlugin("thumbnail");if(n&&Object.keys(e).map((function(t){n.config[t]=e[t]})),n&&n.usable&&r.isShowThumbnail){util$2.removeClass(this.root,"short-line no-thumbnail"),this._hasThumnail=!0;var i=this.find(".xg-spot-thumbnail");this.thumbnail=n.createThumbnail(i,"progress-thumbnail"),r.isShowCoverPreview&&(this.videoPreview=util$2.createDom("xg-video-preview","",{},"xgvideo-preview"),t.root.appendChild(this.videoPreview),this.videothumbnail=n.createThumbnail(this.videoPreview,"xgvideo-thumbnail"))}else util$2.addClass(this.root,"short-line no-thumbnail")}}},{key:"calcuPosition",value:function(e,t){var r=this.player.plugins.progress,n=this.player,i=r.root.getBoundingClientRect().width,o=n.duration/i*6;return e+t>n.duration&&(t=n.duration-e),n.duration,n.duration,{left:e/n.duration*100,width:t/n.duration*100,isMini:t<o}}},{key:"showDot",value:function(e){var t=this.findDot(e);if(t){var r=this.root.getBoundingClientRect().width,n=t.time/this.player.duration*r;this.updatePosition(n,r,t.time)}}},{key:"focusDot",value:function(e,t){e&&(t||(t=e.getAttribute("data-id")),util$2.addClass(e,"active"),this._activeDotId=t)}},{key:"blurDot",value:function(e){if(!e){var t=this._activeDotId;e=this.getDotDom(t)}e&&(util$2.removeClass(e,"active"),this._activeDotId=null)}},{key:"showTips",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";util$2.addClass(this.root,"no-timepoint"),e&&(util$2.addClass(this.find(".xg-spot-content"),"show-text"),t&&"production"===this.config.mode?(util$2.addClass(this.root,"product"),this.tipText.textContent=e):(util$2.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?e:"".concat(r," ").concat(e)))}},{key:"hideTips",value:function(){util$2.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",util$2.removeClass(this.find(".xg-spot-content"),"show-text"),util$2.removeClass(this.root,"product")}},{key:"hide",value:function(){util$2.addClass(this.root,"hide")}},{key:"show",value:function(){util$2.removeClass(this.root,"hide")}},{key:"destroy",value:function(){var e=this,t=this.player.plugins.progress;t&&Object.keys(CALLBACK_MAP).map((function(r){t.removeCallBack(r,e[CALLBACK_MAP[r]])})),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return"mobile"===sniffer.device||this.playerConfig.isMobileSimulateMode?"":'<div class="xg-spot-info '.concat("short"===this.config.mode?"short-line":"",'">\n      <div class="xg-spot-content">\n        <div class="xg-spot-thumbnail">\n          <span class="xg-spot-time"></span>\n        </div>\n        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>\n      </div>\n      <div class="xgplayer-progress-point">00:00</div>\n      <div class="xg-spot-line"></div>\n    </div>')}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:""}}}]),r}(Plugin),Thumbnail=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).ratio=1,n.interval=-1,n.preloadMark={},n}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([DURATION_CHANGE],(function(){var t=e.config,r=t.pic_num,n=t.interval;e.usable&&(e.interval=n>0?n:Math.round(1e3*e.player.duration/r)/1e3)}))}},{key:"usable",get:function(){var e=this.config,t=e.urls,r=e.pic_num;return t&&t.length>0&&r>0}},{key:"initThumbnail",value:function(){var e=this.config,t=e.width,r=e.height,n=e.pic_num,i=e.interval;this.ratio=t/r*100,this.interval=i>0?i:Math.round(1e3*this.player.duration/n)/1e3,this.preload(0)}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var t=this,r=this.config.urls,n=r.length;[e-1,e,e+1,e+2].map((function(e){!t.preloadMark[e]&&e>=0&&e<n&&(util$2.preloadImg(r[e]),t.preloadMark[e]=!0)}))}},{key:"getPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.config,i=n.pic_num,o=n.row,a=n.col,s=n.width,u=n.height,c=Math.ceil(e/this.interval),l=(c=c>i?i:c)<o*a?0:Math.ceil(c/(o*a))-1,d=c-l*(a*o),f=d>0?Math.ceil(d/a)-1:0,h=d>0?d-f*a-1:0,p=0,g=0;if(t&&r){var y=t/r;y<s/u?g=(p=t)/(s/u):p=(g=r)*(s/u)}else g=(p=t||s)/(s/u);var v=this.getUrlByIndex(l);return{urlIndex:l,rowIndex:f,colIndex:h,url:v,height:g,width:p,style:{backgroundImage:"url(".concat(v,")"),backgroundSize:"".concat(p*a,"px auto"),backgroundPosition:"-".concat(h*p,"px -").concat(f*g,"px"),width:"".concat(p,"px"),height:"".concat(g,"px")}}}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this.config,a=o.pic_num,s=o.urls;if(!(a<1)&&s&&0!==s.length){var u=this.getPosition(t,r,n);this.preload(u.urlIndex),Object.keys(u.style).map((function(t){e.style[t]=u.style[t]})),Object.keys(i).map((function(t){e.style[t]=i[t]}))}}},{key:"changeConfig",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((function(r){void 0!==e.config[r]&&(e.config[r]=t[r])})),this.usable&&this.initThumbnail()}},{key:"createThumbnail",value:function(e,t){var r=util$2.createDom("xg-thumbnail","",{},"thumbnail ".concat(t));return e&&e.appendChild(r),r}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,width:160,height:90,scale:1,className:"",hidePortrait:!1}}}]),r}(Plugin),MiniProgress=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;t&&this.root&&(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/t*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/t*100,"%")))}},{key:"render",value:function(){if(this.playerConfig.progress&&this.playerConfig.miniprogress)return'<xg-mini-progress class="xg-mini-progress">\n    <xg-mini-progress-cache class="xg-mini-progress-cache"></xg-mini-progress-cache>\n    <xg-mini-progress-played class="xg-mini-progress-played"></xg-mini-progress-played>\n    </xg-mini-progress>'}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{}}}]),r}(Plugin),MODES={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate"};function nowTime$2(){try{return window.performance.now()}catch(e){return(new Date).getTime()}}function checkVideoIsSupport(e){return"safari"!==sniffer.browser||!/^blob/.test(e.currentSrc)&&!/^blob/.test(e.src)}function checkIsSupportCanvas(){try{return!!document.createElement("canvas").getContext}catch(e){return!1}}var isSupportCanvas=null,DynamicBg=function(t){_inherits$1(n,t);var r=_createSuper$q(n);function n(){var e;_classCallCheck$2(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=r.call.apply(r,[this].concat(i))),"onLoadedData",(function(){if(e.player){var t=e.player.video;e.videoPI=parseInt(t.videoWidth/t.videoHeight*100,10)}})),_defineProperty$2(_assertThisInitialized$1(e),"start",(function(){var t=e.player.video,r=nowTime$2();checkVideoIsSupport(t)&&e.canvasCtx&&(e.stop(),(e.config.mode===MODES.REAL_TIME||r-e.preTime>=e.interval)&&(t&&t.videoWidth&&e.update(t,t.videoWidth,t.videoHeight),e.preTime=r),e.frameId=window.setTimeout((function(){e.start()}),e.interval))})),_defineProperty$2(_assertThisInitialized$1(e),"stop",(function(){e.frameId&&(window.clearTimeout(e.frameId),e.frameId=null)})),e}return _createClass$2(n,[{key:"afterCreate",value:function(){var e=this;!0===this.playerConfig.dynamicBg&&(this.config.disable=!1),n.isSupport||(this.config.disable=!0);var t=this.config,r=t.disable,i=t.mode;r||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0},this.isStart=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/this.config.frameRate,10),this.canvas=null,this.canvasCtx=null,this.once(COMPLETE,(function(){e.player&&(e.init(),!e.player.paused&&e.start())})),this.once(LOADED_DATA,this.onLoadedData),this.on(URL_CHANGE,(function(){e.once(LOADED_DATA,e.onLoadedData)})),i!==MODES.FIRST_FRAME&&(this.on(PLAY,(function(){e.start()})),this.on(PAUSE,(function(){e.stop()}))),i===MODES.FIRST_FRAME&&this.once(TIME_UPDATE,(function(){var t=e.player.video;t&&checkVideoIsSupport(t)&&t.videoWidth&&e.update(t,t.videoWidth,t.videoHeight)})))}},{key:"init",value:function(){var t=this.player,r=this.config;this.canvasFilter=n.supportCanvasFilter();try{var i=this.config.isInnerRender&&t.innerContainer||t.root;i.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg"><canvas>\n        </canvas><xgmask></xgmask></div>'),this.root=i.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=r.filter,this.canvas.style.webkitFilter=r.filter),this.mask=this.find("xgmask"),r.addMask&&(this.mask.style.background=r.maskBg),this.canvasCtx=this.canvas.getContext("2d");var o=this.playerConfig.poster;if(o){var a="String"===util$2.typeOf(o)?o:"String"===util$2.typeOf(o.poster)?o.poster:null;this.updateImg(a)}}catch(e){XG_DEBUG.logError("plugin:DynamicBg",e)}}},{key:"updateImg",value:function(e){var t=this;if(e){var r=this.canvas.getBoundingClientRect(),n=r.width,i=r.height,o=new window.Image;o.onload=function(){t.canvas&&(t.canvas.height=i,t.canvas.width=n,o=null)},o.src=e}}},{key:"update",value:function(t,r,n){if(this.canvas&&this.canvasCtx&&this.videoPI)try{var i=this._pos,o=this.config,a=this.canvas.getBoundingClientRect(),s=a.width,u=a.height;if(this.videoPI=parseInt(r/n*100,10),s!==i.width||u!==i.height){var c=parseInt(s/u*100,10);i.width=this.canvas.width=s,i.height=this.canvas.height=u;var l=u,d=s;c<this.videoPI?d=parseInt(u*this.videoPI/100,10):c>this.videoPI&&(l=parseInt(100*s/this.videoPI,10)),c<this.videoPI?d=parseInt(u*this.videoPI/100,10):c>this.videoPI&&(l=parseInt(100*s/this.videoPI,10)),i.rwidth=1.2*d,i.rheight=1.2*l,i.x=(s-i.rwidth)/2,i.y=(u-i.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=o.filter),this.canvasCtx.drawImage(t,i.x,i.y,i.rwidth,i.rheight)}catch(e){XG_DEBUG.logError("plugin:DynamicBg",e)}}},{key:"destroy",value:function(){this.stop(),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,mode:"framerate",frameRate:10,filter:"blur(50px)",addMask:!0,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return"boolean"==typeof isSupportCanvas?isSupportCanvas:isSupportCanvas=checkIsSupportCanvas()}},{key:"supportCanvasFilter",value:function(){return!("safari"===sniffer.browser||"firefox"===sniffer.browser)}}]),n}(Plugin),ZH={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:"视频下载错误"},mse:{code:2,msg:"流追加错误"},parse:{code:3,msg:"解析错误"},format:{code:4,msg:"格式错误"},decoder:{code:5,msg:"解码错误"},runtime:{code:6,msg:"语法错误"},timeout:{code:7,msg:"播放超时"},other:{code:8,msg:"其他错误"}},HAVE_NOTHING:"没有关于音频/视频是否就绪的信息",HAVE_METADATA:"音频/视频的元数据已就绪",HAVE_CURRENT_DATA:"关于当前播放位置的数据是可用的，但没有足够的数据来播放下一帧/毫秒",HAVE_FUTURE_DATA:"当前及至少下一帧的数据是可用的",HAVE_ENOUGH_DATA:"可用数据足以开始播放",NETWORK_EMPTY:"音频/视频尚未初始化",NETWORK_IDLE:"音频/视频是活动的且已选取资源，但并未使用网络",NETWORK_LOADING:"浏览器正在下载数据",NETWORK_NO_SOURCE:"未找到音频/视频来源",MEDIA_ERR_ABORTED:"取回过程被用户中止",MEDIA_ERR_NETWORK:"网络错误",MEDIA_ERR_DECODE:"解码错误",MEDIA_ERR_SRC_NOT_SUPPORTED:"不支持的音频/视频格式",REPLAY:"重播",ERROR:"网络连接似乎出现了问题",PLAY_TIPS:"播放",PAUSE_TIPS:"暂停",PLAYNEXT_TIPS:"下一集",DOWNLOAD_TIPS:"下载",ROTATE_TIPS:"旋转",RELOAD_TIPS:"重新载入",FULLSCREEN_TIPS:"进入全屏",EXITFULLSCREEN_TIPS:"退出全屏",CSSFULLSCREEN_TIPS:"进入样式全屏",EXITCSSFULLSCREEN_TIPS:"退出样式全屏",TEXTTRACK:"字幕",PIP:"画中画",SCREENSHOT:"截图",LIVE:"正在直播",OFF:"关闭",OPEN:"开启",MINI_DRAG:"点击按住可拖动视频",MINISCREEN:"小屏幕",REFRESH_TIPS:"请试试",REFRESH:"刷新",FORWARD:"快进中",LIVE_TIP:"直播"}},$$1b=_export$1,global$$=global$1T,getBuiltIn$g=getBuiltIn$p,apply$c=functionApply$1,uncurryThis$X=functionUncurryThis$1,fails$U=fails$1m,Array$5=global$$.Array,$stringify$2=getBuiltIn$g("JSON","stringify"),exec$9=uncurryThis$X(/./.exec),charAt$a=uncurryThis$X("".charAt),charCodeAt$4=uncurryThis$X("".charCodeAt),replace$a=uncurryThis$X("".replace),numberToString$2=uncurryThis$X(1..toString),tester$1=/[\uD800-\uDFFF]/g,low$1=/^[\uD800-\uDBFF]$/,hi$1=/^[\uDC00-\uDFFF]$/,fix=function(e,t,r){var n=charAt$a(r,t-1),i=charAt$a(r,t+1);return exec$9(low$1,e)&&!exec$9(hi$1,i)||exec$9(hi$1,e)&&!exec$9(low$1,n)?"\\u"+numberToString$2(charCodeAt$4(e,0),16):e},FORCED$f=fails$U((function(){return'"\\udf06\\ud834"'!==$stringify$2("\udf06\ud834")||'"\\udead"'!==$stringify$2("\udead")}));$stringify$2&&$$1b({target:"JSON",stat:!0,forced:FORCED$f},{stringify:function(e,t,r){for(var n=0,i=arguments.length,o=Array$5(i);n<i;n++)o[n]=arguments[n];var a=apply$c($stringify$2,null,o);return"string"==typeof a?replace$a(a,tester$1,fix):a}});var fails$T=fails$1m,wellKnownSymbol$r=wellKnownSymbol$O,IS_PURE=isPure,ITERATOR$9=wellKnownSymbol$r("iterator"),nativeUrl=!fails$T((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),IS_PURE&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[ITERATOR$9]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),anObject$n=anObject$E,iteratorClose$2=iteratorClose$4,callWithSafeIterationClosing$1=function(e,t,r,n){try{return n?t(anObject$n(r)[0],r[1]):t(r)}catch(error){iteratorClose$2(e,"throw",error)}},global$_=global$1T,bind$d=functionBindContext$1,call$t=functionCall$1,toObject$e=toObject$o,callWithSafeIterationClosing=callWithSafeIterationClosing$1,isArrayIteratorMethod$3=isArrayIteratorMethod$5,isConstructor$3=isConstructor$7,lengthOfArrayLike$e=lengthOfArrayLike$n,createProperty$6=createProperty$b,getIterator$4=getIterator$6,getIteratorMethod$5=getIteratorMethod$8,Array$4=global$_.Array,arrayFrom$1=function(e){var t=toObject$e(e),r=isConstructor$3(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=bind$d(i,n>2?arguments[2]:void 0));var a,s,u,c,l,d,f=getIteratorMethod$5(t),h=0;if(!f||this==Array$4&&isArrayIteratorMethod$3(f))for(a=lengthOfArrayLike$e(t),s=r?new this(a):Array$4(a);a>h;h++)d=o?i(t[h],h):t[h],createProperty$6(s,h,d);else for(l=(c=getIterator$4(t,f)).next,s=r?new this:[];!(u=call$t(l,c)).done;h++)d=o?callWithSafeIterationClosing(c,i,[u.value,h],!0):u.value,createProperty$6(s,h,d);return s.length=h,s},global$Z=global$1T,uncurryThis$W=functionUncurryThis$1,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\0-\u007E]/,regexSeparators=/[.\u3002\uFF0E\uFF61]/g,OVERFLOW_ERROR="Overflow: input needs wider integers to process",baseMinusTMin=base-tMin,RangeError$7=global$Z.RangeError,exec$8=uncurryThis$W(regexSeparators.exec),floor$9=Math.floor,fromCharCode=String.fromCharCode,charCodeAt$3=uncurryThis$W("".charCodeAt),join$4=uncurryThis$W([].join),push$a=uncurryThis$W([].push),replace$9=uncurryThis$W("".replace),split$3=uncurryThis$W("".split),toLowerCase$1=uncurryThis$W("".toLowerCase),ucs2decode=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=charCodeAt$3(e,r++);if(i>=55296&&i<=56319&&r<n){var o=charCodeAt$3(e,r++);56320==(64512&o)?push$a(t,((1023&i)<<10)+(1023&o)+65536):(push$a(t,i),r--)}else push$a(t,i)}return t},digitToBasic=function(e){return e+22+75*(e<26)},adapt=function(e,t,r){var n=0;for(e=r?floor$9(e/damp):e>>1,e+=floor$9(e/t);e>baseMinusTMin*tMax>>1;)e=floor$9(e/baseMinusTMin),n+=base;return floor$9(n+(baseMinusTMin+1)*e/(e+skew))},encode$1=function(e){var t,r,n=[],i=(e=ucs2decode(e)).length,o=initialN,a=0,s=initialBias;for(t=0;t<e.length;t++)(r=e[t])<128&&push$a(n,fromCharCode(r));var u=n.length,c=u;for(u&&push$a(n,delimiter);c<i;){var l=maxInt;for(t=0;t<e.length;t++)(r=e[t])>=o&&r<l&&(l=r);var d=c+1;if(l-o>floor$9((maxInt-a)/d))throw RangeError$7(OVERFLOW_ERROR);for(a+=(l-o)*d,o=l,t=0;t<e.length;t++){if((r=e[t])<o&&++a>maxInt)throw RangeError$7(OVERFLOW_ERROR);if(r==o){for(var f=a,h=base;;){var p=h<=s?tMin:h>=s+tMax?tMax:h-s;if(f<p)break;var g=f-p,y=base-p;push$a(n,fromCharCode(digitToBasic(p+g%y))),f=floor$9(g/y),h+=base}push$a(n,fromCharCode(digitToBasic(f))),s=adapt(a,d,c==u),a=0,c++}}a++,o++}return join$4(n,"")},stringPunycodeToAscii=function(e){var t,r,n=[],i=split$3(replace$9(toLowerCase$1(e),regexSeparators,"."),".");for(t=0;t<i.length;t++)r=i[t],push$a(n,exec$8(regexNonASCII,r)?"xn--"+encode$1(r):r);return join$4(n,".")},$$1a=_export$1,global$Y=global$1T,getBuiltIn$f=getBuiltIn$p,call$s=functionCall$1,uncurryThis$V=functionUncurryThis$1,USE_NATIVE_URL$1=nativeUrl,redefine$6=redefine$h.exports,redefineAll$2=redefineAll$4,setToStringTag$7=setToStringTag$b,createIteratorConstructor=createIteratorConstructor$2,InternalStateModule$8=internalState$1,anInstance$7=anInstance$9,isCallable$u=isCallable$Q,hasOwn$p=hasOwnProperty_1$1,bind$c=functionBindContext$1,classof$f=classof$q,anObject$m=anObject$E,isObject$v=isObject$K,$toString$4=toString$A,create$5=objectCreate$1,createPropertyDescriptor$7=createPropertyDescriptor$d,getIterator$3=getIterator$6,getIteratorMethod$4=getIteratorMethod$8,validateArgumentsLength$5=validateArgumentsLength$7,wellKnownSymbol$q=wellKnownSymbol$O,arraySort=arraySort$1,ITERATOR$8=wellKnownSymbol$q("iterator"),URL_SEARCH_PARAMS="URLSearchParams",URL_SEARCH_PARAMS_ITERATOR=URL_SEARCH_PARAMS+"Iterator",setInternalState$7=InternalStateModule$8.set,getInternalParamsState=InternalStateModule$8.getterFor(URL_SEARCH_PARAMS),getInternalIteratorState=InternalStateModule$8.getterFor(URL_SEARCH_PARAMS_ITERATOR),n$Fetch=getBuiltIn$f("fetch"),N$Request=getBuiltIn$f("Request"),Headers$1=getBuiltIn$f("Headers"),RequestPrototype=N$Request&&N$Request.prototype,HeadersPrototype=Headers$1&&Headers$1.prototype,RegExp$1=global$Y.RegExp,TypeError$a=global$Y.TypeError,decodeURIComponent$1=global$Y.decodeURIComponent,encodeURIComponent$1=global$Y.encodeURIComponent,charAt$9=uncurryThis$V("".charAt),join$3=uncurryThis$V([].join),push$9=uncurryThis$V([].push),replace$8=uncurryThis$V("".replace),shift$1=uncurryThis$V([].shift),splice=uncurryThis$V([].splice),split$2=uncurryThis$V("".split),stringSlice$d=uncurryThis$V("".slice),plus=/\+/g,sequences=Array(4),percentSequence=function(e){return sequences[e-1]||(sequences[e-1]=RegExp$1("((?:%[\\da-f]{2}){"+e+"})","gi"))},percentDecode=function(e){try{return decodeURIComponent$1(e)}catch(error){return e}},deserialize=function(e){var t=replace$8(e,plus," "),r=4;try{return decodeURIComponent$1(t)}catch(error){for(;r;)t=replace$8(t,percentSequence(r--),percentDecode);return t}},find=/[!'()~]|%20/g,replacements={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(e){return replacements[e]},_serialize=function(e){return replace$8(encodeURIComponent$1(e),find,replacer)},URLSearchParamsIterator=createIteratorConstructor((function(e,t){setInternalState$7(this,{type:URL_SEARCH_PARAMS_ITERATOR,iterator:getIterator$3(getInternalParamsState(e).entries),kind:t})}),"Iterator",(function(){var e=getInternalIteratorState(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),URLSearchParamsState=function(e){this.entries=[],this.url=null,void 0!==e&&(isObject$v(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===charAt$9(e,0)?stringSlice$d(e,1):e:$toString$4(e)))};URLSearchParamsState.prototype={type:URL_SEARCH_PARAMS,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,a,s,u=getIteratorMethod$4(e);if(u)for(r=(t=getIterator$3(e,u)).next;!(n=call$s(r,t)).done;){if(o=(i=getIterator$3(anObject$m(n.value))).next,(a=call$s(o,i)).done||(s=call$s(o,i)).done||!call$s(o,i).done)throw TypeError$a("Expected sequence with length 2");push$9(this.entries,{key:$toString$4(a.value),value:$toString$4(s.value)})}else for(var c in e)hasOwn$p(e,c)&&push$9(this.entries,{key:c,value:$toString$4(e[c])})},parseQuery:function(e){if(e)for(var t,r,n=split$2(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=split$2(t,"="),push$9(this.entries,{key:deserialize(shift$1(r)),value:deserialize(join$3(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],push$9(r,_serialize(e.key)+"="+_serialize(e.value));return join$3(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var URLSearchParamsConstructor=function(){anInstance$7(this,URLSearchParamsPrototype);var e=arguments.length>0?arguments[0]:void 0;setInternalState$7(this,new URLSearchParamsState(e))},URLSearchParamsPrototype=URLSearchParamsConstructor.prototype;if(redefineAll$2(URLSearchParamsPrototype,{append:function(e,t){validateArgumentsLength$5(arguments.length,2);var r=getInternalParamsState(this);push$9(r.entries,{key:$toString$4(e),value:$toString$4(t)}),r.updateURL()},delete:function(e){validateArgumentsLength$5(arguments.length,1);for(var t=getInternalParamsState(this),r=t.entries,n=$toString$4(e),i=0;i<r.length;)r[i].key===n?splice(r,i,1):i++;t.updateURL()},get:function(e){validateArgumentsLength$5(arguments.length,1);for(var t=getInternalParamsState(this).entries,r=$toString$4(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){validateArgumentsLength$5(arguments.length,1);for(var t=getInternalParamsState(this).entries,r=$toString$4(e),n=[],i=0;i<t.length;i++)t[i].key===r&&push$9(n,t[i].value);return n},has:function(e){validateArgumentsLength$5(arguments.length,1);for(var t=getInternalParamsState(this).entries,r=$toString$4(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){validateArgumentsLength$5(arguments.length,1);for(var r,n=getInternalParamsState(this),i=n.entries,o=!1,a=$toString$4(e),s=$toString$4(t),u=0;u<i.length;u++)(r=i[u]).key===a&&(o?splice(i,u--,1):(o=!0,r.value=s));o||push$9(i,{key:a,value:s}),n.updateURL()},sort:function(){var e=getInternalParamsState(this);arraySort(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=getInternalParamsState(this).entries,n=bind$c(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new URLSearchParamsIterator(this,"keys")},values:function(){return new URLSearchParamsIterator(this,"values")},entries:function(){return new URLSearchParamsIterator(this,"entries")}},{enumerable:!0}),redefine$6(URLSearchParamsPrototype,ITERATOR$8,URLSearchParamsPrototype.entries,{name:"entries"}),redefine$6(URLSearchParamsPrototype,"toString",(function(){return getInternalParamsState(this).serialize()}),{enumerable:!0}),setToStringTag$7(URLSearchParamsConstructor,URL_SEARCH_PARAMS),$$1a({global:!0,forced:!USE_NATIVE_URL$1},{URLSearchParams:URLSearchParamsConstructor}),!USE_NATIVE_URL$1&&isCallable$u(Headers$1)){var headersHas=uncurryThis$V(HeadersPrototype.has),headersSet=uncurryThis$V(HeadersPrototype.set),wrapRequestOptions=function(e){if(isObject$v(e)){var t,r=e.body;if(classof$f(r)===URL_SEARCH_PARAMS)return t=e.headers?new Headers$1(e.headers):new Headers$1,headersHas(t,"content-type")||headersSet(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),create$5(e,{body:createPropertyDescriptor$7(0,$toString$4(r)),headers:createPropertyDescriptor$7(0,t)})}return e};if(isCallable$u(n$Fetch)&&$$1a({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return n$Fetch(e,arguments.length>1?wrapRequestOptions(arguments[1]):{})}}),isCallable$u(N$Request)){var RequestConstructor=function(e){return anInstance$7(this,RequestPrototype),new N$Request(e,arguments.length>1?wrapRequestOptions(arguments[1]):{})};RequestPrototype.constructor=RequestConstructor,RequestConstructor.prototype=RequestPrototype,$$1a({global:!0,forced:!0},{Request:RequestConstructor})}}var web_urlSearchParams={URLSearchParams:URLSearchParamsConstructor,getState:getInternalParamsState},$$19=_export$1,DESCRIPTORS$u=descriptors$1,USE_NATIVE_URL=nativeUrl,global$X=global$1T,bind$b=functionBindContext$1,uncurryThis$U=functionUncurryThis$1,defineProperties$2=objectDefineProperties$1.f,redefine$5=redefine$h.exports,anInstance$6=anInstance$9,hasOwn$o=hasOwnProperty_1$1,assign$2=objectAssign,arrayFrom=arrayFrom$1,arraySlice$e=arraySliceSimple$1,codeAt=stringMultibyte$1.codeAt,toASCII=stringPunycodeToAscii,$toString$3=toString$A,setToStringTag$6=setToStringTag$b,validateArgumentsLength$4=validateArgumentsLength$7,URLSearchParamsModule=web_urlSearchParams,InternalStateModule$7=internalState$1,setInternalState$6=InternalStateModule$7.set,getInternalURLState=InternalStateModule$7.getterFor("URL"),URLSearchParams$1=URLSearchParamsModule.URLSearchParams,getInternalSearchParamsState=URLSearchParamsModule.getState,NativeURL=global$X.URL,TypeError$9=global$X.TypeError,parseInt$1=global$X.parseInt,floor$8=Math.floor,pow$3=Math.pow,charAt$8=uncurryThis$U("".charAt),exec$7=uncurryThis$U(/./.exec),join$2=uncurryThis$U([].join),numberToString$1=uncurryThis$U(1..toString),pop=uncurryThis$U([].pop),push$8=uncurryThis$U([].push),replace$7=uncurryThis$U("".replace),shift=uncurryThis$U([].shift),split$1=uncurryThis$U("".split),stringSlice$c=uncurryThis$U("".slice),toLowerCase=uncurryThis$U("".toLowerCase),unshift=uncurryThis$U([].unshift),INVALID_AUTHORITY="Invalid authority",INVALID_SCHEME="Invalid scheme",INVALID_HOST="Invalid host",INVALID_PORT="Invalid port",ALPHA=/[a-z]/i,ALPHANUMERIC=/[\d+-.a-z]/i,DIGIT=/\d/,HEX_START=/^0x/i,OCT=/^[0-7]+$/,DEC=/^\d+$/,HEX=/^[\da-f]+$/i,FORBIDDEN_HOST_CODE_POINT=/[\0\t\n\r #%/:<>?@[\\\]^|]/,FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT=/[\0\t\n\r #/:<>?@[\\\]^|]/,LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,TAB_AND_NEW_LINE=/[\t\n\r]/g,EOF,parseIPv4=function(e){var t,r,n,i,o,a,s,u=split$1(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(i=u[n]))return e;if(o=10,i.length>1&&"0"==charAt$8(i,0)&&(o=exec$7(HEX_START,i)?16:8,i=stringSlice$c(i,8==o?1:2)),""===i)a=0;else{if(!exec$7(10==o?DEC:8==o?OCT:HEX,i))return e;a=parseInt$1(i,o)}push$8(r,a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=pow$3(256,5-t))return null}else if(a>255)return null;for(s=pop(r),n=0;n<r.length;n++)s+=r[n]*pow$3(256,3-n);return s},parseIPv6=function(e){var t,r,n,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return charAt$8(e,d)};if(":"==f()){if(":"!=charAt$8(e,1))return;d+=2,l=++c}for(;f();){if(8==c)return;if(":"!=f()){for(t=r=0;r<4&&exec$7(HEX,f());)t=16*t+parseInt$1(f(),16),d++,r++;if("."==f()){if(0==r)return;if(d-=r,c>6)return;for(n=0;f();){if(i=null,n>0){if(!("."==f()&&n<4))return;d++}if(!exec$7(DIGIT,f()))return;for(;exec$7(DIGIT,f());){if(o=parseInt$1(f(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++n&&4!=n||c++}if(4!=n)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u},findLongestZeroSequence=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t},serializeHost=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)unshift(t,e%256),e=floor$8(e/256);return join$2(t,".")}if("object"==_typeof$3(e)){for(t="",n=findLongestZeroSequence(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=numberToString$1(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},C0ControlPercentEncodeSet={},fragmentPercentEncodeSet=assign$2({},C0ControlPercentEncodeSet,{" ":1,'"':1,"<":1,">":1,"`":1}),pathPercentEncodeSet=assign$2({},fragmentPercentEncodeSet,{"#":1,"?":1,"{":1,"}":1}),userinfoPercentEncodeSet=assign$2({},pathPercentEncodeSet,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(e,t){var r=codeAt(e,0);return r>32&&r<127&&!hasOwn$o(t,e)?e:encodeURIComponent(e)},specialSchemes={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isWindowsDriveLetter=function(e,t){var r;return 2==e.length&&exec$7(ALPHA,charAt$8(e,0))&&(":"==(r=charAt$8(e,1))||!t&&"|"==r)},startsWithWindowsDriveLetter=function(e){var t;return e.length>1&&isWindowsDriveLetter(stringSlice$c(e,0,2))&&(2==e.length||"/"===(t=charAt$8(e,2))||"\\"===t||"?"===t||"#"===t)},isSingleDot=function(e){return"."===e||"%2e"===toLowerCase(e)},isDoubleDot=function(e){return".."===(e=toLowerCase(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},SCHEME_START={},SCHEME={},NO_SCHEME={},SPECIAL_RELATIVE_OR_AUTHORITY={},PATH_OR_AUTHORITY={},RELATIVE={},RELATIVE_SLASH={},SPECIAL_AUTHORITY_SLASHES={},SPECIAL_AUTHORITY_IGNORE_SLASHES={},AUTHORITY={},HOST={},HOSTNAME={},PORT={},FILE={},FILE_SLASH={},FILE_HOST={},PATH_START={},PATH={},CANNOT_BE_A_BASE_URL_PATH={},QUERY={},FRAGMENT={},URLState=function e(t,r,n){var i,o,a,s=$toString$3(t);if(r){if(o=this.parse(s))throw TypeError$9(o);this.searchParams=null}else{if(void 0!==n&&(i=new e(n,!0)),o=this.parse(s,null,i))throw TypeError$9(o);(a=getInternalSearchParamsState(new URLSearchParams$1)).bindURL(this),this.searchParams=a}};URLState.prototype={type:"URL",parse:function(e,t,r){var n,i,o,a,s=this,u=t||SCHEME_START,c=0,l="",d=!1,f=!1,h=!1;for(e=$toString$3(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=replace$7(e,LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE,"")),e=replace$7(e,TAB_AND_NEW_LINE,""),n=arrayFrom(e);c<=n.length;){switch(i=n[c],u){case SCHEME_START:if(!i||!exec$7(ALPHA,i)){if(t)return INVALID_SCHEME;u=NO_SCHEME;continue}l+=toLowerCase(i),u=SCHEME;break;case SCHEME:if(i&&(exec$7(ALPHANUMERIC,i)||"+"==i||"-"==i||"."==i))l+=toLowerCase(i);else{if(":"!=i){if(t)return INVALID_SCHEME;l="",u=NO_SCHEME,c=0;continue}if(t&&(s.isSpecial()!=hasOwn$o(specialSchemes,l)||"file"==l&&(s.includesCredentials()||null!==s.port)||"file"==s.scheme&&!s.host))return;if(s.scheme=l,t)return void(s.isSpecial()&&specialSchemes[s.scheme]==s.port&&(s.port=null));l="","file"==s.scheme?u=FILE:s.isSpecial()&&r&&r.scheme==s.scheme?u=SPECIAL_RELATIVE_OR_AUTHORITY:s.isSpecial()?u=SPECIAL_AUTHORITY_SLASHES:"/"==n[c+1]?(u=PATH_OR_AUTHORITY,c++):(s.cannotBeABaseURL=!0,push$8(s.path,""),u=CANNOT_BE_A_BASE_URL_PATH)}break;case NO_SCHEME:if(!r||r.cannotBeABaseURL&&"#"!=i)return INVALID_SCHEME;if(r.cannotBeABaseURL&&"#"==i){s.scheme=r.scheme,s.path=arraySlice$e(r.path),s.query=r.query,s.fragment="",s.cannotBeABaseURL=!0,u=FRAGMENT;break}u="file"==r.scheme?FILE:RELATIVE;continue;case SPECIAL_RELATIVE_OR_AUTHORITY:if("/"!=i||"/"!=n[c+1]){u=RELATIVE;continue}u=SPECIAL_AUTHORITY_IGNORE_SLASHES,c++;break;case PATH_OR_AUTHORITY:if("/"==i){u=AUTHORITY;break}u=PATH;continue;case RELATIVE:if(s.scheme=r.scheme,i==EOF)s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=arraySlice$e(r.path),s.query=r.query;else if("/"==i||"\\"==i&&s.isSpecial())u=RELATIVE_SLASH;else if("?"==i)s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=arraySlice$e(r.path),s.query="",u=QUERY;else{if("#"!=i){s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=arraySlice$e(r.path),s.path.length--,u=PATH;continue}s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=arraySlice$e(r.path),s.query=r.query,s.fragment="",u=FRAGMENT}break;case RELATIVE_SLASH:if(!s.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,u=PATH;continue}u=AUTHORITY}else u=SPECIAL_AUTHORITY_IGNORE_SLASHES;break;case SPECIAL_AUTHORITY_SLASHES:if(u=SPECIAL_AUTHORITY_IGNORE_SLASHES,"/"!=i||"/"!=charAt$8(l,c+1))continue;c++;break;case SPECIAL_AUTHORITY_IGNORE_SLASHES:if("/"!=i&&"\\"!=i){u=AUTHORITY;continue}break;case AUTHORITY:if("@"==i){d&&(l="%40"+l),d=!0,o=arrayFrom(l);for(var p=0;p<o.length;p++){var g=o[p];if(":"!=g||h){var y=percentEncode(g,userinfoPercentEncodeSet);h?s.password+=y:s.username+=y}else h=!0}l=""}else if(i==EOF||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()){if(d&&""==l)return INVALID_AUTHORITY;c-=arrayFrom(l).length+1,l="",u=HOST}else l+=i;break;case HOST:case HOSTNAME:if(t&&"file"==s.scheme){u=FILE_HOST;continue}if(":"!=i||f){if(i==EOF||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()){if(s.isSpecial()&&""==l)return INVALID_HOST;if(t&&""==l&&(s.includesCredentials()||null!==s.port))return;if(a=s.parseHost(l))return a;if(l="",u=PATH_START,t)return;continue}"["==i?f=!0:"]"==i&&(f=!1),l+=i}else{if(""==l)return INVALID_HOST;if(a=s.parseHost(l))return a;if(l="",u=PORT,t==HOSTNAME)return}break;case PORT:if(!exec$7(DIGIT,i)){if(i==EOF||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()||t){if(""!=l){var v=parseInt$1(l,10);if(v>65535)return INVALID_PORT;s.port=s.isSpecial()&&v===specialSchemes[s.scheme]?null:v,l=""}if(t)return;u=PATH_START;continue}return INVALID_PORT}l+=i;break;case FILE:if(s.scheme="file","/"==i||"\\"==i)u=FILE_SLASH;else{if(!r||"file"!=r.scheme){u=PATH;continue}if(i==EOF)s.host=r.host,s.path=arraySlice$e(r.path),s.query=r.query;else if("?"==i)s.host=r.host,s.path=arraySlice$e(r.path),s.query="",u=QUERY;else{if("#"!=i){startsWithWindowsDriveLetter(join$2(arraySlice$e(n,c),""))||(s.host=r.host,s.path=arraySlice$e(r.path),s.shortenPath()),u=PATH;continue}s.host=r.host,s.path=arraySlice$e(r.path),s.query=r.query,s.fragment="",u=FRAGMENT}}break;case FILE_SLASH:if("/"==i||"\\"==i){u=FILE_HOST;break}r&&"file"==r.scheme&&!startsWithWindowsDriveLetter(join$2(arraySlice$e(n,c),""))&&(isWindowsDriveLetter(r.path[0],!0)?push$8(s.path,r.path[0]):s.host=r.host),u=PATH;continue;case FILE_HOST:if(i==EOF||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&isWindowsDriveLetter(l))u=PATH;else if(""==l){if(s.host="",t)return;u=PATH_START}else{if(a=s.parseHost(l))return a;if("localhost"==s.host&&(s.host=""),t)return;l="",u=PATH_START}continue}l+=i;break;case PATH_START:if(s.isSpecial()){if(u=PATH,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=EOF&&(u=PATH,"/"!=i))continue}else s.fragment="",u=FRAGMENT;else s.query="",u=QUERY;break;case PATH:if(i==EOF||"/"==i||"\\"==i&&s.isSpecial()||!t&&("?"==i||"#"==i)){if(isDoubleDot(l)?(s.shortenPath(),"/"==i||"\\"==i&&s.isSpecial()||push$8(s.path,"")):isSingleDot(l)?"/"==i||"\\"==i&&s.isSpecial()||push$8(s.path,""):("file"==s.scheme&&!s.path.length&&isWindowsDriveLetter(l)&&(s.host&&(s.host=""),l=charAt$8(l,0)+":"),push$8(s.path,l)),l="","file"==s.scheme&&(i==EOF||"?"==i||"#"==i))for(;s.path.length>1&&""===s.path[0];)shift(s.path);"?"==i?(s.query="",u=QUERY):"#"==i&&(s.fragment="",u=FRAGMENT)}else l+=percentEncode(i,pathPercentEncodeSet);break;case CANNOT_BE_A_BASE_URL_PATH:"?"==i?(s.query="",u=QUERY):"#"==i?(s.fragment="",u=FRAGMENT):i!=EOF&&(s.path[0]+=percentEncode(i,C0ControlPercentEncodeSet));break;case QUERY:t||"#"!=i?i!=EOF&&("'"==i&&s.isSpecial()?s.query+="%27":s.query+="#"==i?"%23":percentEncode(i,C0ControlPercentEncodeSet)):(s.fragment="",u=FRAGMENT);break;case FRAGMENT:i!=EOF&&(s.fragment+=percentEncode(i,fragmentPercentEncodeSet))}c++}},parseHost:function(e){var t,r,n;if("["==charAt$8(e,0)){if("]"!=charAt$8(e,e.length-1))return INVALID_HOST;if(!(t=parseIPv6(stringSlice$c(e,1,-1))))return INVALID_HOST;this.host=t}else if(this.isSpecial()){if(e=toASCII(e),exec$7(FORBIDDEN_HOST_CODE_POINT,e))return INVALID_HOST;if(null===(t=parseIPv4(e)))return INVALID_HOST;this.host=t}else{if(exec$7(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT,e))return INVALID_HOST;for(t="",r=arrayFrom(e),n=0;n<r.length;n++)t+=percentEncode(r[n],C0ControlPercentEncodeSet);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return hasOwn$o(specialSchemes,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&isWindowsDriveLetter(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=serializeHost(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+join$2(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw TypeError$9(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new URLConstructor(e.path[0]).origin}catch(error){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+serializeHost(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse($toString$3(e)+":",SCHEME_START)},getUsername:function(){return this.username},setUsername:function(e){var t=arrayFrom($toString$3(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=percentEncode(t[r],userinfoPercentEncodeSet)}},getPassword:function(){return this.password},setPassword:function(e){var t=arrayFrom($toString$3(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=percentEncode(t[r],userinfoPercentEncodeSet)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?serializeHost(e):serializeHost(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,HOST)},getHostname:function(){var e=this.host;return null===e?"":serializeHost(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,HOSTNAME)},getPort:function(){var e=this.port;return null===e?"":$toString$3(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=$toString$3(e))?this.port=null:this.parse(e,PORT))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+join$2(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,PATH_START))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=$toString$3(e))?this.query=null:("?"==charAt$8(e,0)&&(e=stringSlice$c(e,1)),this.query="",this.parse(e,QUERY)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=$toString$3(e))?("#"==charAt$8(e,0)&&(e=stringSlice$c(e,1)),this.fragment="",this.parse(e,FRAGMENT)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var URLConstructor=function(e){var t=anInstance$6(this,URLPrototype),r=validateArgumentsLength$4(arguments.length,1)>1?arguments[1]:void 0,n=setInternalState$6(t,new URLState(e,!1,r));DESCRIPTORS$u||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},URLPrototype=URLConstructor.prototype,accessorDescriptor=function(e,t){return{get:function(){return getInternalURLState(this)[e]()},set:t&&function(e){return getInternalURLState(this)[t](e)},configurable:!0,enumerable:!0}};if(DESCRIPTORS$u&&defineProperties$2(URLPrototype,{href:accessorDescriptor("serialize","setHref"),origin:accessorDescriptor("getOrigin"),protocol:accessorDescriptor("getProtocol","setProtocol"),username:accessorDescriptor("getUsername","setUsername"),password:accessorDescriptor("getPassword","setPassword"),host:accessorDescriptor("getHost","setHost"),hostname:accessorDescriptor("getHostname","setHostname"),port:accessorDescriptor("getPort","setPort"),pathname:accessorDescriptor("getPathname","setPathname"),search:accessorDescriptor("getSearch","setSearch"),searchParams:accessorDescriptor("getSearchParams"),hash:accessorDescriptor("getHash","setHash")}),redefine$5(URLPrototype,"toJSON",(function(){return getInternalURLState(this).serialize()}),{enumerable:!0}),redefine$5(URLPrototype,"toString",(function(){return getInternalURLState(this).serialize()}),{enumerable:!0}),NativeURL){var nativeCreateObjectURL=NativeURL.createObjectURL,nativeRevokeObjectURL=NativeURL.revokeObjectURL;nativeCreateObjectURL&&redefine$5(URLConstructor,"createObjectURL",bind$b(nativeCreateObjectURL,NativeURL)),nativeRevokeObjectURL&&redefine$5(URLConstructor,"revokeObjectURL",bind$b(nativeRevokeObjectURL,NativeURL))}setToStringTag$6(URLConstructor,"URL"),$$19({global:!0,forced:!USE_NATIVE_URL,sham:!DESCRIPTORS$u},{URL:URLConstructor});var INFO="info",STATS_EVENTS$1=STATS_EVENTS$2,Stats=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"_recordUserActions",(function(t){var r=e._getTime(),n=Object.assign({},t,{msg:t.msg||t.action});e._stats[INFO].push(_objectSpread2(_objectSpread2({type:"userAction"},r),{},{payload:n}))})),_defineProperty$2(_assertThisInitialized$1(e),"_onReset",(function(){e.reset()})),_defineProperty$2(_assertThisInitialized$1(e),"_recordInfo",(function(t){e.info(t)})),_defineProperty$2(_assertThisInitialized$1(e),"_downloadStats",(function(){var t=e.getStats(),r=new Blob([JSON.stringify(t)],{type:"application/json"}),n=window.URL.createObjectURL(r),i=document.createElement("a");i.style.display="none",i.href=n,console.log("linkhref",n),i.download="player.txt",i.disabled=!1,i.click()})),e}return _createClass$2(r,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:(new Date).toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(USER_ACTION,this._recordUserActions),this.on(STATS_EVENTS$1.STATS_INFO,this._recordInfo),this.on(STATS_EVENTS$1.STATS_DOWNLOAD,this._downloadStats),this.on(STATS_EVENTS$1.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var t=this._getTime();this._stats[INFO].push(_objectSpread2(_objectSpread2({},t),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var t=_objectSpread2({cat:"function",dur:Date.now()-e.startMs,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:!0},e);this._info(t)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var e;this._stats=(_defineProperty$2(e={},INFO,[]),_defineProperty$2(e,"media",{}),e)}},{key:"getStats",value:function(){for(var e=this.player.video,t=[],r=0;r<e.buffered.length;r++)t.push({start:e.buffered.start(r),end:e.buffered.end(r)});var n={currentTime:e.currentTime,readyState:e.readyState,buffered:t,paused:e.paused,ended:e.ended};return this._stats.media=n,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){return this._stats[INFO].map((function(e){var t=e.payload.data,r="";try{t instanceof Error?r=t.msg:void 0!==t&&(r=JSON.stringify(t))}catch(error){console.log("err",error)}return"[".concat(e.timeFormat,"] : ").concat(e.payload.msg," ").concat(r," ")}))}},{key:"_getProfile",value:function(){var e={traceEvents:[]};return this._stats[INFO].forEach((function(t){t.payload.profile&&e.traceEvents.push(t.payload)})),e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),r}(BasePlugin),DefaultPreset$3=_createClass$2((function e(t,r){var n,i,o;_classCallCheck$2(this,e);var a=r&&r.isMobileSimulateMode,s=r.isLive,u=[].concat(s?[]:[Progress,MiniProgress,ProgressPreview,Time],[Play,Fullscreen,Rotate,PlayNextIcon,DefinitionIcon,PlaybackRate,Download,ScreenShot,Volume,PIP]),c=[Replay,Poster,Start,Loading,Enter,ErrorPlugin$1,Prompt,Thumbnail,MiniScreen];this.plugins=[Stats,Xglogger].concat(_toConsumableArray$1(u),c);var l=a?"mobile":sniffer.device;switch(l){case"pc":(n=this.plugins).push.apply(n,[Keyboard,PCPlugin,CssFullScreen]);break;case"mobile":(i=this.plugins).push.apply(i,[MobilePlugin]);break;default:(o=this.plugins).push.apply(o,[Keyboard,PCPlugin,CssFullScreen])}(sniffer.os.isIpad||"pc"===l)&&this.plugins.push(DynamicBg),sniffer.os.isIpad&&this.plugins.push(PCPlugin),this.ignores=[],this.i18n=[ZH]})),PresetPlayer=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r)}(Player);_defineProperty$2(PresetPlayer,"defaultPreset",DefaultPreset$3),_defineProperty$2(PresetPlayer,"Util",util$2),_defineProperty$2(PresetPlayer,"Sniffer",sniffer),_defineProperty$2(PresetPlayer,"Errors",Errors$2),_defineProperty$2(PresetPlayer,"Events",Events$1),_defineProperty$2(PresetPlayer,"Plugin",Plugin),_defineProperty$2(PresetPlayer,"BasePlugin",BasePlugin),_defineProperty$2(PresetPlayer,"I18N",I18N),_defineProperty$2(PresetPlayer,"STATE_CLASS",STATE_CLASS);var DefaultPreset$2=_createClass$2((function e(t,r){var n,i,o;_classCallCheck$2(this,e);var a=r&&r.isMobileSimulateMode,s=r.isLive,u=[].concat(s?[]:[Progress,MiniProgress,ProgressPreview,Time],[Play,Fullscreen,Rotate,PlayNextIcon,DefinitionIcon,PlaybackRate,Download,ScreenShot,Volume,PIP]),c=[Replay,Poster,Start,Loading,Enter,ErrorPlugin$1,Prompt,Thumbnail,MiniScreen];this.plugins=[Stats,Xglogger].concat(_toConsumableArray$1(u),c);var l=a?"mobile":sniffer.device;switch(l){case"pc":(n=this.plugins).push.apply(n,[Keyboard,PCPlugin,CssFullScreen]);break;case"mobile":(i=this.plugins).push.apply(i,[MobilePlugin]);break;default:(o=this.plugins).push.apply(o,[Keyboard,PCPlugin,CssFullScreen])}(sniffer.os.isIpad||"pc"===l)&&this.plugins.push(DynamicBg),this.ignores=[],this.i18n=[]})),DefaultPreset$1=_createClass$2((function e(){var t,r;_classCallCheck$2(this,e);var n=[Play,Fullscreen,Time,Volume,Rotate,DefinitionIcon,PlaybackRate,CssFullScreen,PIP];switch(this.plugins=[Poster,Start,Loading,Enter,ErrorPlugin$1].concat(n),sniffer.device){case"pc":(t=this.plugins).push.apply(t,[Keyboard,PCPlugin]);break;case"mobile":this.plugins.push(MobilePlugin);break;default:(r=this.plugins).push.apply(r,[Keyboard,PCPlugin])}this.ignores=[],this.i18n=[ZH]})),DefaultPreset=_createClass$2((function e(){_classCallCheck$2(this,e);var t=[MobilePlugin,Progress,Play,Fullscreen,Time,Rotate,PlayNextIcon,DefinitionIcon,PlaybackRate,Download,ScreenShot,Volume,PIP],r=[Replay,Poster,Start,Loading,Enter,ErrorPlugin$1,Prompt,Thumbnail,MiniProgress];this.plugins=[Xglogger].concat(t,r),this.ignores=[],this.i18n=[ZH]})),zhHk={LANG:"zh-hk",TEXT:{ERROR_TYPES:{network:{code:1,msg:"視頻下載錯誤"},mse:{code:2,msg:"劉追加錯誤"},parse:{code:3,msg:"解析錯誤"},format:{code:4,msg:"格式錯誤"},decoder:{code:5,msg:"解碼錯誤"},runtime:{code:6,msg:"語法錯誤"},timeout:{code:7,msg:"播放超時"},other:{code:8,msg:"其他錯誤"}},HAVE_NOTHING:"沒有關於音頻/視頻是否就緒的信息",HAVE_METADATA:"音頻/視頻的元數據已就緒",HAVE_CURRENT_DATA:"關於當前播放位置的數據是可用的，但沒有足夠的數據來播放下壹幀/毫秒",HAVE_FUTURE_DATA:"當前及至少下壹幀的數據是可用的",HAVE_ENOUGH_DATA:"可用數據足以開始播放",NETWORK_EMPTY:"音頻/視頻尚未初始化",NETWORK_IDLE:"音頻/視頻是活動的且已選取資源，但並未使用網絡",NETWORK_LOADING:"瀏覽器正在下載數據",NETWORK_NO_SOURCE:"未找到音頻/視頻來源",MEDIA_ERR_ABORTED:"取回過程被用戶中止",MEDIA_ERR_NETWORK:"下載錯誤",MEDIA_ERR_DECODE:"解碼錯誤",MEDIA_ERR_SRC_NOT_SUPPORTED:"不支持的音頻/視頻格式",REPLAY:"重播",ERROR:"網絡連接似乎出現了問題",PLAY_TIPS:"播放",PAUSE_TIPS:"暫停",PLAYNEXT_TIPS:"下壹集",DOWNLOAD_TIPS:"下載",ROTATE_TIPS:"旋轉",RELOAD_TIPS:"重新載入",FULLSCREEN_TIPS:"進入全屏",EXITFULLSCREEN_TIPS:"退出全屏",CSSFULLSCREEN_TIPS:"進入樣式全屏",EXITCSSFULLSCREEN_TIPS:"退出樣式全屏",TEXTTRACK:"字幕",PIP:"畫中畫",SCREENSHOT:"截圖",LIVE:"正在直播",OFF:"關閉",OPEN:"開啟",MINI_DRAG:"點擊按住可拖動視頻",MINISCREEN:"小屏幕",REFRESH_TIPS:"請試試",REFRESH:"刷新",FORWARD:"快进中",LIVE_TIP:"直播"}},jp$1={LANG:"jp",TEXT:{ERROR_TYPES:{network:{code:1,msg:"ビデオダウンロードエラー"},mse:{code:2,msg:"ストリーム追加エラー"},parse:{code:3,msg:"解析エラー"},format:{code:4,msg:"間違ったフォーマット"},decoder:{code:5,msg:"デコードエラー"},runtime:{code:6,msg:"文法エラー"},timeout:{code:7,msg:"再生タイムアウト"},other:{code:8,msg:"その他のエラー"}},HAVE_NOTHING:"オーディオ/ビデオが準備できているか情報がありません",HAVE_METADATA:"オーディオ/ビデオのメタデータは準備できています",HAVE_CURRENT_DATA:"現在の再生位置に関するデータは利用可能ですが、次のフレーム/ミリ秒を再生するのに十分なデータがありません",HAVE_FUTURE_DATA:"現在、少なくとも次のフレームのデータが利用可能です",HAVE_ENOUGH_DATA:"利用可能なデータは再生を開始するのに十分です",NETWORK_EMPTY:"オーディオ/ビデオが初期化されていません",NETWORK_IDLE:"オーディオ/ビデオはアクティブでリソースが選択されていますが、ネットワークが使用されていません",NETWORK_LOADING:"ブラウザーはデータをダウンロードしています",NETWORK_NO_SOURCE:"オーディオ/ビデオ のソースが見つかりません",MEDIA_ERR_ABORTED:"ユーザーによってフェッチプロセスが中止されました",MEDIA_ERR_NETWORK:"ダウンロード中にエラーが発生しました",MEDIA_ERR_DECODE:"デコード中にエラーが発生しました",MEDIA_ERR_SRC_NOT_SUPPORTED:"オーディオ/ビデオ の形式がサポートされていません",REPLAY:"リプレイ",ERROR:"ネットワークの接続に問題が発生しました",PLAY_TIPS:"プレイ",PAUSE_TIPS:"一時停止",PLAYNEXT_TIPS:"次をプレイ",DOWNLOAD_TIPS:"ダウンロード",ROTATE_TIPS:"回転",RELOAD_TIPS:"再読み込み",FULLSCREEN_TIPS:"フルスクリーン",EXITFULLSCREEN_TIPS:"フルスクリーンを終了",CSSFULLSCREEN_TIPS:"シアターモード",EXITCSSFULLSCREEN_TIPS:"シアターモードを終了",TEXTTRACK:"字幕",PIP:"ミニプレーヤー",SCREENSHOT:"スクリーンショット",LIVE:"生放送",OFF:"オフ",OPEN:"開いた",MINI_DRAG:"ボタンを押して働画をドラッグする",MINISCREEN:"小さな画面",REFRESH:"リフレッシュ",REFRESH_TIPS:"してみてください",FORWARD:"早送り",LIVE_TIP:"生放送"}},dist$3={exports:{}};!function(e,t){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof$3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){function n(e,t){return e.classList?Array.prototype.some.call(e.classList,(function(e){return e===t})):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function i(e,t){e.classList?t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach((function(t){t&&e.classList.add(t)})):n(e,t)||(e.className+=" "+t)}function o(e,t){e.classList?t.split(/\s+/g).forEach((function(t){e.classList.remove(t)})):n(e,t)&&t.split(/\s+/g).forEach((function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}))}function a(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.createDom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach((function(t){var n=t,o=r[t];"video"===e||"audio"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)})),i},t.hasClass=n,t.addClass=i,t.removeClass=o,t.toggleClass=function(e,t){t.split(/\s+/g).forEach((function(t){n(e,t)?o(e,t):i(e,t)}))},t.findDom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments[1],r=void 0;try{r=e.querySelector(t)}catch(n){t.startsWith("#")&&(r=e.getElementById(t.slice(1)))}return r},t.deepCopy=function e(t,r){if("Object"===a(r)&&"Object"===a(t))return Object.keys(r).forEach((function(n){"Object"!==a(r[n])||r[n]instanceof Node?"Array"===a(r[n])?t[n]="Array"===a(t[n])?t[n].concat(r[n]):r[n]:t[n]=r[n]:t[n]?e(t[n],r[n]):t[n]=r[n]})),t},t.typeOf=a,t.copyDom=function(e){if(e&&1===e.nodeType){var t=document.createElement(e.tagName);return Array.prototype.forEach.call(e.attributes,(function(e){t.setAttribute(e.name,e.value)})),e.innerHTML&&(t.innerHTML=e.innerHTML),t}return""},t.attachEventListener=function(e,t,r,n){var i,o,a,s;n?(e.on(t,r),o=t,a=r,s=n,(i=e).once(s,(function e(){i.off(o,a),i.off(s,e)}))):e.on(t,(function n(i){r(i),e.off(t,n)}))},t.styleUtil=function(e,t,r){var n=e.style;try{n[t]=r}catch(i){n.setProperty(t,r)}},t.isNumber=function(e){return"number"==typeof e&&!Number.isNaN(e)},t.throttle=function(e,t){var r=this,n=0;return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];clearTimeout(n),n=setTimeout((function(){return e.apply(r,o)}),t)}},t.hasOwnProperty=Object.prototype.hasOwnProperty},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(26))&&n.__esModule?n:{default:n},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"setLogger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.logger=new o.default(e+".js")}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){var n=r(18)();e.exports=function(e){return e!==n&&null!==e}},function(e,t,r){e.exports=function(e){return null!=e}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(5))&&n.__esModule?n:{default:n};r(34),t.default=i.default,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DanmuJs=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(6)),o=r(25),a=d(r(1)),s=d(r(27)),u=d(r(32)),c=r(33),l=r(0);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}var h=t.DanmuJs=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=r;n.setLogger("danmu"),n.logger&&n.logger.info("danmu.js version: "+o.version);var a=n.config={overlap:!1,area:{start:0,end:1,lines:void 0},live:!1,comments:[],direction:"r2l",needResizeObserver:!1,dropStaleComments:!1,channelSize:void 0,maxCommentsLength:void 0,bulletOffset:void 0,interval:2e3};if((0,l.deepCopy)(a,e),(0,i.default)(n),n.hideArr=[],n.domObj=new u.default,n.freezeId=null,a.comments.forEach((function(e){e.duration=e.duration?e.duration:5e3,e.mode||(e.mode="scroll")})),n.container=a.container&&1===a.container.nodeType?a.container:null,!n.container)return n.emit("error","container id can't be empty"),f(r,!1);if(a.containerStyle){var c=a.containerStyle;Object.keys(c).forEach((function(e){n.container.style[e]=c[e]}))}return n.live=a.live,n.player=a.player,n.direction=a.direction,(0,l.addClass)(n.container,"danmu"),n.bulletBtn=new s.default(n),n.main=n.bulletBtn.main,n.isReady=!0,n.emit("ready"),r.logger&&r.logger.info("ready"),r.addResizeObserver(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"addResizeObserver",value:function(){var e=this;this.config.needResizeObserver&&(0,c.addObserver)(this.container,(function(){e.logger&&e.logger.info("needResizeObserver"),e.resize()}))}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.main.clear()}},{key:"destroy",value:function(){for(var e in(0,c.unObserver)(this.container),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn.destroy(),this.domObj.destroy(),this)delete this[e];this.emit("destroy")}},{key:"sendComment",value:function(e){this.logger&&this.logger.info("sendComment: "+(e.txt||"[DOM Element]")),e.duration||(e.duration=15e3),e&&e.id&&e.duration&&(e.el||e.txt)&&(e.duration=e.duration?e.duration:5e3,e.style||(e.style={opacity:void 0,fontSize:void 0}),e.style&&(this.opacity&&this.opacity!==e.style.opacity&&(e.style.opacity=this.opacity),this.fontSize&&this.fontSize!==e.style.fontSize&&(e.style.fontSize=this.fontSize)),e.prior||e.realTime?(this.main.data.unshift(e),e.realTime&&(this.main.readData(),this.main.dataHandle())):this.main.data.push(e))}},{key:"setCommentID",value:function(e,t){var r=this;this.logger&&this.logger.info("setCommentID: oldID "+e+" newID "+t),e&&t&&(this.main.data.some((function(r){return r.id===e&&(r.id=t,!0)})),this.main.queue.some((function(n){return n.id===e&&(n.id=t,n.pauseMove(),"paused"!==r.main.status&&n.startMove(),!0)})))}},{key:"setCommentDuration",value:function(e,t){var r=this;this.logger&&this.logger.info("setCommentDuration: id "+e+" duration "+t),e&&t&&(t=t||5e3,this.main.data.some((function(r){return r.id===e&&(r.duration=t,!0)})),this.main.queue.some((function(n){return n.id===e&&(n.duration=t,n.pauseMove(),"paused"!==r.main.status&&n.startMove(),!0)})))}},{key:"setCommentLike",value:function(e,t){this.logger&&this.logger.info("setCommentLike: id "+e+" like "+t),e&&t&&(this.main.data.some((function(r){return r.id===e&&(r.like=t,!0)})),this.main.queue.some((function(r){return r.id===e&&(r.pauseMove(),r.setLikeDom(t.el,t.style),"paused"!==r.danmu.main.status&&r.startMove(),!0)})))}},{key:"restartComment",value:function(e){if(this.logger&&this.logger.info("restartComment: id "+e),e){var t=this.main;if(this._releaseCtrl(e),"closed"===t.status)return;t.queue.some((function(r){return r.id===e&&("paused"!==t.status?r.startMove(!0):r.status="paused",!0)}))}}},{key:"_releaseCtrl",value:function(e){this.freezeId&&e==this.freezeId&&(this.mouseControl=!1,this.freezeId=null)}},{key:"_freezeCtrl",value:function(e){this.mouseControl=!0,this.freezeId=e}},{key:"freezeComment",value:function(e){this.logger&&this.logger.info("freezeComment: id "+e),e&&(this._freezeCtrl(e),this.main.queue.some((function(t){return t.id===e&&(t.status="forcedPause",t.pauseMove(),t.el&&t.el.style&&(0,l.styleUtil)(t.el,"zIndex",10),!0)})))}},{key:"removeComment",value:function(e){this.logger&&this.logger.info("removeComment: id "+e),e&&(this._releaseCtrl(e),this.main.queue.some((function(t){return t.id===e&&(t.remove(),!0)})),this.main.data=this.main.data.filter((function(t){return t.id!==e})))}},{key:"updateComments",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.config,n=this.main,i=this.player,o=[],a=0;if(this.logger&&this.logger.info("updateComments: "+e.length+", isClear "+t),"boolean"==typeof t&&t&&(n.data=[]),n.data=n.data.concat(e),n.sortData(),"number"==typeof r.maxCommentsLength&&n.data.length>r.maxCommentsLength){a=n.data.length-r.maxCommentsLength;for(var s,u=0;u<a;u++)(s=n.data[u]).prior&&!s.attached_&&o.push(n.data[u])}else if(r.dropStaleComments&&i&&i.currentTime){var c=Math.floor(1e3*i.currentTime)-r.interval;if(c>0)for(var l,d=0;d<n.data.length;d++)if((l=n.data[d]).prior&&!l.attached_&&o.push(n.data[d]),l.start>c){a=d;break}a>0&&(n.data.splice(0,a),n.data=o.concat(n.data))}}},{key:"willChange",value:function(){var e=this.container,t=this.main;e.style.willChange="opacity",t.willChanges.push("contents"),t.queue.forEach((function(e){e.willChange()}))}},{key:"stopWillChange",value:function(){this.container.style.willChange="",this.main.willChanges.splice(0),this.main.queue.forEach((function(e){e.willChange()}))}},{key:"setAllDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll",t=this,r=arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.logger&&this.logger.info("setAllDuration: mode "+e+" duration "+r+" force "+n),r&&(r=r||5e3,n&&(this.main.forceDuration=r),this.main.data.forEach((function(t){e===t.mode&&(t.duration=r)})),this.main.queue.forEach((function(n){e===n.mode&&(n.duration=r,n.pauseMove(),"paused"!==t.main.status&&n.startMove())})))}},{key:"setPlayRate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll",r=arguments[1];this.logger&&this.logger.info("setPlayRate: "+r),(0,l.isNumber)(r)&&r>0&&(this.main.playRate=r,this.main.queue.forEach((function(r){t===r.mode&&(r.pauseMove(),"paused"!==e.main.status&&r.startMove())})))}},{key:"setOpacity",value:function(e){this.logger&&this.logger.info("setOpacity: opacity "+e),this.container.style.opacity=e}},{key:"setFontSize",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{reflow:!0};this.logger&&this.logger.info("setFontSize: size "+e+" channelSize "+t),this.fontSize=e+"px",e&&(this.main.data.forEach((function(e){e.style&&(e.style.fontSize=r.fontSize)})),this.main.queue.forEach((function(e){e.options.style||(e.options.style={}),e.options.style.fontSize=r.fontSize,e.setFontSize(r.fontSize),t&&(e.top=e.channel_id[0]*t,e.topInit())}))),t&&(this.config.channelSize=t,n.reflow&&this.main.channel.resizeSync())}},{key:"setArea",value:function(e){this.logger&&this.logger.info("setArea: area "+e),this.config.area=e,!1!==e.reflow&&this.main.channel.resizeSync()}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode "+e),this.hideArr.indexOf(e)<0&&this.hideArr.push(e),this.main.queue.filter((function(t){return e===t.mode||"color"===e&&t.color})).forEach((function(e){return e.remove()}))}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode "+e);var t=this.hideArr.indexOf(e);t>-1&&this.hideArr.splice(t,1)}},{key:"setDirection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction "+e),this.emit("changeDirection",e)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}},{key:"status",get:function(){return this.main.status}},{key:"state",get:function(){var e=this.main;return{status:e.status,comments:e.data,bullets:e.queue}}},{key:"containerPos",get:function(){return this.main.channel.containerPos}}]),t}(a.default);t.default=h},function(e,t,r){var n,i,o,a,s,u,c,l=r(7),d=r(24),f=Function.prototype.apply,h=Function.prototype.call,p=Object.create,g=Object.defineProperty,y=Object.defineProperties,v=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var r,i;return d(t),i=this,n.call(this,e,r=function(){o.call(i,e,r),f.call(t,this,arguments)}),r.__eeOnceListener__=t,this},s={on:n=function(e,t){var r;return d(t),v.call(this,"__ee__")?r=this.__ee__:(r=m.value=p(null),g(this,"__ee__",m),m.value=null),r[e]?"object"==_typeof$3(r[e])?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:i,off:o=function(e,t){var r,n,i,o;if(d(t),!v.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"==_typeof$3(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},emit:a=function(e){var t,r,n,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==_typeof$3(i)){for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;n=i[t];++t)f.call(n,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];f.call(i,this,o)}}},u={on:l(n),once:l(i),off:l(o),emit:l(a)},c=y({},u),e.exports=t=function(e){return null==e?p(c):y(Object(e),u)},t.methods=s},function(e,t,r){var n=r(3),i=r(8),o=r(12),a=r(20),s=r(21);(e.exports=function(e,t){var r,i,u,c,l;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],n(e)?(r=s.call(e,"c"),i=s.call(e,"e"),u=s.call(e,"w")):(r=u=!0,i=!1),l={value:t,configurable:r,enumerable:i,writable:u},c?o(a(c),l):l}).gs=function(e,t,r){var u,c,l,d;return"string"!=typeof e?(l=r,r=t,t=e,e=null):l=arguments[3],n(t)?i(t)?n(r)?i(r)||(l=r,r=void 0):r=void 0:(l=t,t=r=void 0):t=void 0,n(e)?(u=s.call(e,"c"),c=s.call(e,"e")):(u=!0,c=!1),d={get:t,set:r,configurable:u,enumerable:c},l?o(a(l),d):d}},function(e,t,r){var n=r(9),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!n(e)&&!i.test(o.call(e))}},function(e,t,r){var n=r(10);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(t){return!1}return!n(e)}},function(e,t,r){var n=r(11);e.exports=function(e){if(!n(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(t){return!1}}},function(e,t,r){var n=r(3),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!n(e)&&hasOwnProperty.call(i,_typeof$3(e))}},function(e,t,r){e.exports=r(13)()?Object.assign:r(14)},function(e,t,r){e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,r){var n=r(15),i=r(19),o=Math.max;e.exports=function(e,t){var r,a,s,u=o(arguments.length,2);for(e=Object(i(e)),s=function(n){try{e[n]=t[n]}catch(i){r||(r=i)}},a=1;a<u;++a)n(t=arguments[a]).forEach(s);if(void 0!==r)throw r;return e}},function(e,t,r){e.exports=r(16)()?Object.keys:r(17)},function(e,t,r){e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,r){var n=r(2),i=Object.keys;e.exports=function(e){return i(n(e)?Object(e):e)}},function(e,t,r){e.exports=function(){}},function(e,t,r){var n=r(2);e.exports=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,r){var n=r(2),i=Array.prototype.forEach,o=Object.create,a=function(e,t){var r;for(r in e)t[r]=e[r]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){n(e)&&a(Object(e),t)})),t}},function(e,t,r){e.exports=r(22)()?String.prototype.contains:r(23)},function(e,t,r){var n="razdwatrzy";e.exports=function(){return"function"==typeof n.contains&&!0===n.contains("dwa")&&!1===n.contains("foo")}},function(e,t,r){var n=String.prototype.indexOf;e.exports=function(e){return n.call(this,e,arguments[1])>-1}},function(e,t,r){e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e){e.exports=JSON.parse('{"version":"1.1.1"}')},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i="undefined"!=typeof window&&window.location.href.indexOf("danmu-debug")>-1,o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.constructorName=t||""}return n(e,[{key:"info",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];i&&(t=console).log.apply(t,["[Danmu Log]["+this.constructorName+"]",e].concat(n))}}]),e}();t.default=o,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(1)),o=s(r(28)),a=r(0);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.setLogger("control"),r.danmu=e,r.main=new o.default(e),e.config.defaultOff||r.main.start(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"createSwitch",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=(0,a.createDom)("dk-switch",'<span class="txt">弹</span>',{},"danmu-switch "+(e?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)a.hasOwnProperty.call(this,e)&&delete this[e]}}]),t}(i.default);t.default=u,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(1)),o=u(r(29)),a=u(r(30)),s=r(0);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.setLogger("main"),r.danmu=e,r.container=e.container,r.channel=new a.default(e),r.data=[].concat(e.config.comments),r.playedData=[],r.queue=[],r.timer=null,r.playRate=1,r.retryStatus="normal",r.interval=e.config.interval,r.willChanges=[],r._status="idle",(0,s.attachEventListener)(e,"bullet_remove",r.updateQueue.bind(r),"destroy"),(0,s.attachEventListener)(e,"changeDirection",(function(e){r.danmu.direction=e}),"destroy"),r.nums=0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"_cancelDataHandleTimer",value:function(){this.handleId&&(clearTimeout(this.handleId),this.handleId=null),this.handleTimer&&(clearTimeout(this.handleTimer),this.handleTimer=null)}},{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),this._cancelDataHandleTimer(),this.channel.destroy(),this.data=[],this)delete this[e]}},{key:"updateQueue",value:function(e){this.logger&&this.logger.info("updateQueue");var t=this;t.queue.some((function(r,n){return r.id===e.bullet.id&&(t.queue.splice(n,1),!0)})),t.data.some((function(t){return t.id===e.bullet.id&&(t.attached_=!1,!0)}))}},{key:"init",value:function(){var e=this;e.logger&&e.logger.info("init"),e.retryStatus="normal",e.sortData(),function t(){"closed"!==e._status||"stop"!==e.retryStatus?("playing"===e._status&&(e.readData(),e.dataHandle()),"stop"===e.retryStatus&&"paused"!==e._status||(e.handleTimer=setTimeout((function(){e.handleId=requestAnimationFrame((function(){t()}))}),250))):e._cancelDataHandleTimer()}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this._status="playing",this.queue=[],this.container.innerHTML="",this.channel.reset(),this.init()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this._status="closed",this.retryStatus="stop",this.queue=[],this.container.innerHTML="",this.channel.reset()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel.reset(),this.data=[],this.queue=[],this.container.innerHTML=""}},{key:"play",value:function(){var e=this;if("closed"!==this._status){this.logger&&this.logger.info("play"),this._status="playing";var t=this.channel.channels;t&&t.length>0&&["scroll","top","bottom"].forEach((function(r){e.queue.forEach((function(e){e.startMove(),e.resized=!0}));for(var n=0;n<t.length;n++)t[n].queue[r].forEach((function(e){e.resized=!1}))}))}else this.logger&&this.logger.info("play ignored")}},{key:"pause",value:function(){if("closed"!==this._status){this.logger&&this.logger.info("pause"),this._status="paused";var e=this.channel.channels;e&&e.length>0&&this.queue.forEach((function(e){e.pauseMove()}))}else this.logger&&this.logger.info("pause ignored")}},{key:"dataHandle",value:function(){"paused"!==this._status&&"closed"!==this._status&&this.queue.length&&this.queue.forEach((function(e){"waiting"===e.status&&e.startMove()}))}},{key:"readData",value:function(){if(this.danmu.isReady){var e=this,t=this.danmu,r=t.player,n=e.interval,i=e.channel,a=void 0,u=void 0;if(r){var c=r.currentTime?Math.floor(1e3*r.currentTime):0;u=e.data.filter((function(t){return!t.start&&e.danmu.hideArr.indexOf(t.mode)<0&&(!t.color||e.danmu.hideArr.indexOf("color")<0)&&(t.start=c),!t.attached_&&e.danmu.hideArr.indexOf(t.mode)<0&&(!t.color||e.danmu.hideArr.indexOf("color")<0)&&t.start-n<=c&&c<=t.start+n})),t.live&&(e.data=[])}else 0===(u=e.data.splice(0,1)).length&&(u=e.playedData.splice(0,1));if(u.length>0){i.updatePos();var l=2;e:for(var d,f=0;f<u.length;f++)if(d=u[f],e.forceDuration&&e.forceDuration!=d.duration&&(d.duration=e.forceDuration),(a=new o.default(t,d))&&!a.bulletCreateFail)if(a.attach(),d.attached_=!0,i.addBullet(a).result)e.queue.push(a),e.nums++,a.topInit(),l=2;else{for(var h in a.detach(),a)s.hasOwnProperty.call(a,h)&&delete a[h];if(a=null,d.attached_=!1,d.noDiscard&&(d.prior?e.data.unshift(d):e.data.push(d)),0===l)break e;l--}else{if(0===l)break e;l--}}}}},{key:"sortData",value:function(){this.data.sort((function(e,t){return(e.start||-1)-(t.start||-1)}))}},{key:"status",get:function(){return this._status}}]),t}(i.default);t.default=c,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Bullet=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(1))&&n.__esModule?n:{default:n},a=r(0);function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}var u=t.Bullet=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),i=n,o=void 0;if(n.setLogger("bullet"),n.danmu=e,n.options=r,n.duration=r.duration,n.id=r.id,n.container=e.container,n.start=r.start,n.prior=r.prior,n.realTime=r.realTime,n.color=r.color,n.bookChannelId=r.bookChannelId,n.direction=e.direction,n.reuseDOM=!0,n.willChanges=[],n.domObj=e.domObj,r.el&&1===r.el.nodeType){if(r.el.parentNode)return s(n,{bulletCreateFail:!0});if(e.config.disableCopyDOM)o=r.el,n.reuseDOM=!1;else{o=n.domObj.use();var u=(0,a.copyDom)(r.el);r.eventListeners&&r.eventListeners.length>0&&r.eventListeners.forEach((function(e){u.addEventListener(e.event,e.listener,e.useCapture||!1)})),o.appendChild(u)}}else(o=n.domObj.use()).textContent=r.txt;if(n.onChangeDirection=function(e){i.direction=e},n.danmu.on("changeDirection",n.onChangeDirection),r.style){var c=r.style;Object.keys(c).forEach((function(e){(0,a.styleUtil)(o,e,c[e])}))}"top"===r.mode||"bottom"===r.mode?n.mode=r.mode:n.mode="scroll",n.el=o,r.like&&r.like.el&&n.setLikeDom(r.like.el,r.like.style),n.status="waiting";var l=void 0;if((0,a.isNumber)(e.config.bulletOffset)&&e.config.bulletOffset>=0)l=e.config.bulletOffset;else{var d=e.containerPos;l=d.width/10>100?100:d.width/10}var f=r.realTime?0:Math.floor(Math.random()*l);return n.updateOffset(f),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"updateOffset",value:function(e){this.random=e,(0,a.styleUtil)(this.el,"left",this.danmu.containerPos.width+e+"px")}},{key:"attach",value:function(){var e=this.el;this.container.appendChild(e),this.elPos=e.getBoundingClientRect(),"b2t"===this.direction?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV&&(this.duration=(this.danmu.containerPos.width+this.random+this.width)/this.moveV*1e3),this.danmu.config&&(this.danmu.config.mouseControl&&(this.mouseoverFunWrapper=this.mouseoverFun.bind(this),e.addEventListener("mouseover",this.mouseoverFunWrapper,!1)),this.danmu.config.mouseEnterControl&&(this.mouseEnterFunWrapper=this.mouseoverFun.bind(this),e.addEventListener("mouseenter",this.mouseEnterFunWrapper,!1))),e.addEventListener("transitionend",this._onTransitionEnd,!1)}},{key:"detach",value:function(){var e=this.el;if(e){var t=this.danmu.config;t&&(t.mouseControl&&e.removeEventListener("mouseover",this.mouseoverFunWrapper,!1),t.mouseEnterControl&&e.removeEventListener("mouseenter",this.mouseEnterFunWrapper,!1)),e.removeEventListener("transitionend",this._onTransitionEnd,!1),e.parentNode&&e.parentNode.removeChild(e),this.reuseDOM&&this.domObj.unused(e),this.el=null}this.elPos=void 0,this.danmu.off("changeDirection",this.onChangeDirection)}},{key:"willChange",value:function(){var e=this.danmu.main.willChanges.concat(this.willChanges).join();(0,a.styleUtil)(this.el,"willChange",e)}},{key:"mouseoverFun",value:function(e){this.danmu&&this.danmu.mouseControl&&this.danmu.config.mouseControlPause||"waiting"===this.status||"end"===this.status||this.danmu&&this.danmu.emit("bullet_hover",{bullet:this,event:e})}},{key:"_onTransitionEnd",value:function(){this.status="end",this.remove()}},{key:"topInit",value:function(){this.logger&&this.logger.info("topInit #"+(this.options.txt||"[DOM Element]")+"#"),"b2t"===this.direction?((0,a.styleUtil)(this.el,"transformOrigin","left top"),(0,a.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+this.danmu.containerPos.height+"px) translateZ(0px) rotate(90deg)"),(0,a.styleUtil)(this.el,"transition","transform 0s linear 0s")):(0,a.styleUtil)(this.el,"top",this.top+"px")}},{key:"pauseMove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if("paused"!==t.status&&("forcedPause"!==t.status&&(this.status="paused"),t._moveV=void 0,this.el))if(this.willChange(),"scroll"===this.mode){var r=t.danmu.containerPos;if(e){var n=((new Date).getTime()-t.moveTime)/1e3*this.moveV,i=0;i=t.moveMoreS-n>=0?"b2t"===this.direction?(t.moveMoreS-n)/t.moveContainerHeight*r.height:(t.moveMoreS-n)/t.moveContainerWidth*r.width:t.moveMoreS-n,"b2t"===this.direction?(0,a.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+i+"px) translateZ(0px) rotate(90deg)"):(0,a.styleUtil)(this.el,"left",i+"px")}else"b2t"===this.direction?(0,a.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+(this.el.getBoundingClientRect().top-r.top)+"px) translateZ(0px) rotate(90deg)"):(0,a.styleUtil)(this.el,"left",this.el.getBoundingClientRect().left-r.left+"px");"b2t"===this.direction||(0,a.styleUtil)(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),(0,a.styleUtil)(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+(new Date).getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(e){if(this.hasMove||(this.danmu.emit("bullet_start",this),this.hasMove=!0),("forcedPause"!==this.status||e)&&this.el&&"start"!==this.status)if(this.status="start",this.willChanges=["transform","transition"],this.willChange(),(0,a.styleUtil)(this.el,"backface-visibility","hidden"),(0,a.styleUtil)(this.el,"perspective","500em"),"scroll"===this.mode){var t=this.danmu.containerPos;if("b2t"===this.direction){var r=(this.el.getBoundingClientRect().bottom-t.top)/this.moveV;(0,a.styleUtil)(this.el,"transition","transform "+r+"s linear 0s"),(0,a.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY(-"+this.height+"px) translateZ(0px) rotate(90deg)"),this.moveTime=(new Date).getTime(),this.moveMoreS=this.el.getBoundingClientRect().top-t.top,this.moveContainerHeight=t.height}else{if(!this.el)return;var n=this.el.getBoundingClientRect(),i=n.right-t.left,o=i/this.moveV;n.right>t.left?((0,a.styleUtil)(this.el,"transition","transform "+o+"s linear 0s"),(0,a.styleUtil)(this.el,"transform","translateX(-"+i+"px) translateY(0px) translateZ(0px)"),this.moveTime=(new Date).getTime(),this.moveMoreS=n.left-t.left,this.moveContainerWidth=t.width):(this.status="end",this.remove())}}else(0,a.styleUtil)(this.el,"left","50%"),(0,a.styleUtil)(this.el,"margin","0 0 0 -"+this.width/2+"px"),this.pastDuration||(this.pastDuration=1),this.startTime=(new Date).getTime()}},{key:"remove",value:function(){this.logger&&this.logger.info("remove #"+(this.options.txt||"[DOM Element]")+"#"),this.pauseMove(),this.el&&this.el.parentNode&&(this.willChanges=[],this.willChange(),this.detach(),this.options.el&&1===this.options.el.nodeType&&this.danmu.config.disableCopyDOM&&(0,a.styleUtil)(this.options.el,"transform","none"),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(e){this.el&&(this.el.style.fontSize=e)}},{key:"setLikeDom",value:function(e,t){if(e&&(Object.keys(t).forEach((function(r){e.style[r]=t[r]})),e.className="danmu-like",this.el)){var r=this.el.querySelector(".danmu-like");r&&this.el.removeChild(r),this.el.innerHTML=""+this.el.innerHTML+e.outerHTML}return e}},{key:"moveV",get:function(){var e=this._moveV;if(!e){if(this.options.moveV)e=this.options.moveV;else if(this.elPos){var t=this.danmu.containerPos;e=("b2t"===this.direction?t.height+this.height:t.width+this.width)/this.duration*1e3}e&&(e*=this.danmu.main.playRate,this._moveV=e)}return e}}]),t}(o.default);t.default=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(1))&&n.__esModule?n:{default:n},a=r(0),s=r(31),u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=r;return n.setLogger("channel"),n.danmu=e,n.reset(!0),n.direction=e.direction,n.channels=[],n.updatePos(),(0,a.attachEventListener)(r.danmu,"bullet_remove",(function(e){n.removeBullet(e.bullet)}),"destroy"),(0,a.attachEventListener)(r.danmu,"changeDirection",(function(e){n.direction=e}),"destroy"),(0,a.attachEventListener)(r.danmu,"channel_resize",(function(){n.resize()}),"destroy"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"updatePos",value:function(){var e=this.container.getBoundingClientRect();this.containerPos=e,this.containerWidth=e.width,this.containerHeight=e.height,this.containerTop=e.top,this.containerBottom=e.bottom,this.containerLeft=e.left,this.containerRight=e.right}},{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),this.channels.splice(0,this.channels.length),this._cancelResizeTimer(),this)a.hasOwnProperty.call(this,e)&&delete this[e]}},{key:"addBullet",value:function(e){var t=this,r=this.danmu,n=this.channels,i=void 0,o=void 0,a=void 0;if("b2t"===t.direction?(o=this.channelWidth,a=Math.ceil(e.width/o)):(i=this.channelHeight,a=Math.ceil(e.height/i)),a>n.length)return{result:!1,message:"exceed channels.length, occupy="+a+",channelsSize="+n.length};for(var s=!0,u=void 0,c=-1,l=0,d=n.length;l<d;l++)if(n[l].queue[e.mode].some((function(t){return t.id===e.id})))return{result:!1,message:"exited, channelOrder="+l+",danmu_id="+e.id};if("scroll"===e.mode)for(var f=0,h=n.length-a;f<=h;f++){s=!0;for(var p=f;p<f+a;p++){if((u=n[p]).operating.scroll){s=!1;break}if(u.bookId.scroll&&u.bookId.scroll!==e.id){s=!1;break}u.operating.scroll=!0;var g=u.queue.scroll[0];if(g){var y=g.el.getBoundingClientRect();if("b2t"===t.direction){if(y.bottom>=t.containerPos.bottom){s=!1,u.operating.scroll=!1;break}}else if(y.right>=t.containerPos.right){s=!1,u.operating.scroll=!1;break}var v=void 0,m=g.moveV,_=void 0,b=e.moveV,A=void 0;if("b2t"===t.direction?(_=(v=y.bottom-t.containerTop)/m,A=t.containerHeight+e.random-v):(_=(v=y.right-t.containerLeft)/m,A=t.containerWidth+e.random-v),b>m){var E=A/(b-m);if(r.config.bOffset||(r.config.bOffset=0),_+r.config.bOffset>=E){var S=_*b-t.containerPos.width;S>0&&e.updateOffset(S+(1+Math.ceil(5*Math.random())))}}}u.operating.scroll=!1}if(s){c=f;break}}else if("top"===e.mode)for(var T=0,$=n.length-a;T<=$;T++){s=!0;for(var w=T;w<T+a;w++){if(w>Math.floor(n.length/2)){s=!1;break}if((u=n[w]).operating[e.mode]){s=!1;break}if((u.bookId[e.mode]||e.prior)&&u.bookId[e.mode]!==e.id){s=!1;break}if(u.operating[e.mode]=!0,u.queue[e.mode].length>0){s=!1,u.operating[e.mode]=!1;break}u.operating[e.mode]=!1}if(s){c=T;break}}else if("bottom"===e.mode)for(var C=n.length-a;C>=0;C--){s=!0;for(var I=C;I<C+a;I++){if(I<=Math.floor(n.length/2)){s=!1;break}if((u=n[I]).operating[e.mode]){s=!1;break}if((u.bookId[e.mode]||e.prior)&&u.bookId[e.mode]!==e.id){s=!1;break}if(u.operating[e.mode]=!0,u.queue[e.mode].length>0){s=!1,u.operating[e.mode]=!1;break}u.operating[e.mode]=!1}if(s){c=C;break}}if(-1!==c){for(var k=c,O=c+a;k<O;k++)(u=n[k]).operating[e.mode]=!0,u.queue[e.mode].unshift(e),e.prior&&(delete u.bookId[e.mode],t.logger&&t.logger.info(k+"号轨道恢复正常使用")),u.operating[e.mode]=!1;return e.prior&&(t.logger&&t.logger.info(e.id+"号优先弹幕运行完毕"),delete e.bookChannelId,r.player&&r.bulletBtn.main.data.some((function(t){return t.id===e.id&&(delete t.bookChannelId,!0)}))),e.channel_id=[c,a],"b2t"===t.direction?(e.top=c*o,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerWidth*t.danmu.config.area.start)):(e.top=c*i,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerHeight*t.danmu.config.area.start)),{result:e,message:"success"}}if(e.options.realTime){var P=0,R=-1,x=null;if(t.danmu.bulletBtn.main.queue.forEach((function(e,r){!e.prior&&!e.options.realTime&&e.el&&e.el.getBoundingClientRect().left>t.containerPos.right&&e.start>=P&&(P=e.start,R=r,x=e)})),x){x.remove(),t.removeBullet(x),t.danmu.bulletBtn.main.queue.splice(R,1),e.channel_id=x.channel_id;for(var D=x.channel_id[0],L=x.channel_id[0]+x.channel_id[1];D<L;D++)(u=n[D]).operating[e.mode]=!0,u.queue[e.mode].unshift(e),e.prior&&delete u.bookId[e.mode],u.operating[e.mode]=!1;return e.top=x.top,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerHeight*t.danmu.config.area.start),{result:e,message:"success"}}}if(e.prior)if(e.bookChannelId||t.danmu.live)r.player&&r.bulletBtn.main.data.some((function(r){return r.id===e.id&&(t.logger&&t.logger.info(e.id+"号优先弹幕将于2秒后再次请求注册"),r.start+=2e3,!0)}));else{c=-1;for(var N=0,M=n.length-a;N<=M;N++){s=!0;for(var B=N;B<N+a;B++)if(n[B].bookId[e.mode]){s=!1;break}if(s){c=N;break}}if(-1!==c){for(var U=c;U<c+a;U++)n[U].bookId[e.mode]=e.id,t.logger&&t.logger.info(U+"号轨道被"+e.id+"号优先弹幕预定");r.player&&r.bulletBtn.main.data.some((function(r){return r.id===e.id&&(t.logger&&t.logger.info(e.id+"号优先弹幕将于2秒后再次请求注册"),r.start+=2e3,r.bookChannelId=[c,a],t.logger&&t.logger.info(e.id+"号优先弹幕预定了"+c+"~"+(c+a-1)+"号轨道"),!0)}))}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(e){this.logger&&this.logger.info("removeBullet "+(e.options.txt||"[DOM Element]"));for(var t=this.channels,r=e.channel_id,n=void 0,i=r[0],o=r[0]+r[1];i<o;i++)if(n=t[i]){n.operating[e.mode]=!0;var a=-1;n.queue[e.mode].some((function(t,r){return t.id===e.id&&(a=r,!0)})),a>-1&&n.queue[e.mode].splice(a,1),n.operating[e.mode]=!1}e.options.loop&&this.danmu.bulletBtn.main.playedData.push(e.options)}},{key:"resizeSync",value:function(){this.resize(!0)}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger&&this.logger.info("resize");var t=this;function r(){var e=t.danmu,r=e.container,n=e.config,i=e.bulletBtn,o=void 0;if(t.updatePos(),t._cancelResizeTimer(),i.main.data&&i.main.data.forEach((function(e){e.bookChannelId&&(delete e.bookChannelId,t.logger&&t.logger.info("resize导致"+e.id+"号优先弹幕预定取消"))})),t.logger&&t.logger.info("resize导致所有轨道恢复正常使用"),t.width=t.containerWidth,t.height=t.containerHeight,n.area){var u=n.area,c=u.lines,l=u.start,d=u.end;(0,s.validAreaLineRule)(c)?o=c:l>=0&&d>=l&&("b2t"===t.direction?t.width=t.width*(d-l):t.height=t.height*(d-l))}t.container=r;var f=n.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,a.isNumber)(o)||(o="b2t"===t.direction?Math.floor(t.width/f):Math.floor(t.height/f));for(var h=[],p=0;p<o;p++)h[p]={id:p,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(t.channels&&t.channels.length<=h.length){for(var g=function(e){h[e]={id:e,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach((function(r){t.channels[e].queue[r].forEach((function(t){t.el&&h[e].queue[r].push(t)}))})),t.channels[e].queue.bottom.forEach((function(r){if(r.el&&(h[e+h.length-t.channels.length].queue.bottom.push(r),r.channel_id[0]+r.channel_id[1]-1===e)){var n=[].concat(r.channel_id);r.channel_id=[n[0]-t.channels.length+h.length,n[1]],r.top=r.channel_id[0]*f,t.danmu.config.area&&t.danmu.config.area.start&&(r.top+=t.containerHeight*t.danmu.config.area.start),r.topInit()}}))},y=0;y<t.channels.length;y++)g(y);for(var v=function(e){["scroll","top","bottom"].forEach((function(t){h[e].queue[t].forEach((function(e){e.resized=!1}))}))},m=0;m<h.length;m++)v(m);t.channels=h,"b2t"===t.direction?t.channelWidth=f:t.channelHeight=f}else if(t.channels&&t.channels.length>h.length){for(var _=function(e){h[e]={id:e,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach((function(r){if("top"===r&&e>Math.floor(h.length/2));else if("bottom"===r&&e<=Math.floor(h.length/2));else{var n="bottom"===r?e-h.length+t.channels.length:e;t.channels[n].queue[r].forEach((function(i,o){if(i.el&&(h[e].queue[r].push(i),"bottom"===r&&i.channel_id[0]+i.channel_id[1]-1===n)){var a=[].concat(i.channel_id);i.channel_id=[a[0]-t.channels.length+h.length,a[1]],i.top=i.channel_id[0]*f,t.danmu.config.area&&t.danmu.config.area.start&&(i.top+=t.containerHeight*t.danmu.config.area.start),i.topInit()}t.channels[n].queue[r].splice(o,1)}))}}))},b=0;b<h.length;b++)_(b);for(var A=function(e){["scroll","top","bottom"].forEach((function(t){h[e].queue[t].forEach((function(e){e.resized=!1}))}))},E=0;E<h.length;E++)A(E);t.channels=h,"b2t"===t.direction?t.channelWidth=f:t.channelHeight=f}t.resizing=!1}t.resizing||(t.resizing=!0,e?r():(this._cancelResizeTimer(),this.resizeId=requestAnimationFrame(r)))}},{key:"_cancelResizeTimer",value:function(){this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=null)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger&&this.logger.info("reset");var t=this,r=t.danmu,n=r.container,i=r.bulletBtn,o=r.config;function u(){var e=void 0,r=n.getBoundingClientRect();if(t.width=r.width,t.height=r.height,t.resetId&&(cancelAnimationFrame(t.resetId),t.resetId=null),o.area){var i=o.area,u=i.lines,c=i.start,l=i.end;(0,s.validAreaLineRule)(u)?e=u:c>=0&&l>=c&&("b2t"===t.direction?t.width=t.width*(l-c):t.height=t.height*(l-c))}var d=o.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,a.isNumber)(e)||(e="b2t"===t.direction?Math.floor(t.width/d):Math.floor(t.height/d));for(var f=[],h=0;h<e;h++)f[h]={id:h,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};t.channels=f,"b2t"===t.direction?t.channelWidth=d:t.channelHeight=d}t.container=n,i&&i.main&&i.main.queue.forEach((function(e){e.remove()})),t.channels&&t.channels.length>0&&["scroll","top","bottom"].forEach((function(e){for(var r=0;r<t.channels.length;r++)t.channels[r].queue[e].forEach((function(e){e.remove()}))})),i&&i.main&&i.main.data&&i.main.data.forEach((function(e){e.attached_=!1})),e?this.resetId=requestAnimationFrame(u):u()}}]),t}(o.default);t.default=u,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.validAreaLineRule=function(e){return"number"==typeof e&&e>=0&&Number.isInteger(e)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t={initDOM:function(){return document.createElement("div")},initSize:10},this.init(t)}return n(e,[{key:"init",value:function(e){this.idleList=[],this.usingList=[],this._id=0,this.options=e,this._expand(e.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var e=this.idleList.shift();return this.usingList.push(e),e}},{key:"unused",value:function(e){var t=this.usingList.indexOf(e);t<0||(this.usingList.splice(t,1),e.innerHTML="",e.textcontent="",this.clearElementStyle(e),this.idleList.push(e))}},{key:"_expand",value:function(e){for(var t=0;t<e;t++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var e=0;e<this.idleList.length;e++)this.idleList[e].innerHTML="",this.idleList[e].textcontent="",this.clearElementStyle(this.idleList[e]);for(var t=0;t<this.usingList.length;t++)this.usingList[t].innerHTML="",this.usingList[t].textcontent="",this.clearElementStyle(this.usingList[t]);for(var r in this)i.hasOwnProperty.call(this,r)&&delete this[r]}},{key:"clearElementStyle",value:function(e){var t="undefined"!=typeof window?window.navigator.userAgent:null;t&&(t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1?(0,i.styleUtil)(e,"transform","none"):e.setAttribute("style",""))}}]),e}();t.default=o,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.destroyObserver=t.unObserver=t.addObserver=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=new(function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__handlers=[],window.ResizeObserver)try{this.observer=new window.ResizeObserver((0,i.throttle)((function(e){t.__trigger(e)}),100))}catch(r){}}return n(e,[{key:"addObserver",value:function(e,t){if(this.observer){this.observer&&this.observer.observe(e);for(var r=this.__handlers,n=-1,i=0;i<r.length;i++)r[i]&&e===r[i].target&&(n=i);n>-1?this.__handlers[n].handler.push(t):this.__handlers.push({target:e,handler:[t]})}}},{key:"unObserver",value:function(e){var t=-1;this.__handlers.map((function(r,n){e===r.target&&(t=n)})),this.observer&&this.observer.unobserve(e),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(e){for(var t=this.__handlers,r=0;r<t.length;r++)if(t[r]&&e===t[r].target){t[r].handler&&t[r].handler.map((function(e){try{e()}catch(t){console.error(t)}}));break}}},{key:"__trigger",value:function(e){var t=this;e.map((function(e){t.__runHandler(e.target)}))}}]),e}());t.addObserver=function(e,t){o.addObserver(e,t)},t.unObserver=function(e,t){o.unObserver(e,t)},t.destroyObserver=function(e,t){o.destroyObserver(e,t)}},function(e,t,r){var n=r(35);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(37)(n,i),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(36)(!1)).push([e.i,".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(a).concat([o]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(e,t,r){var n,i,o,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),u=function(e){return document.querySelector(e)},c=(o={},function(e){if("function"==typeof e)return e();if(void 0===o[e]){var t=u.call(this,e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(r){t=null}o[e]=t}return o[e]}),l=null,d=0,f=[],h=r(38);function p(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=a[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(b(n.parts[o],t))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(b(n.parts[o],t));a[n.id]={id:n.id,refs:1,parts:s}}}}function g(e,t){for(var r=[],n={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};n[a]?n[a].parts.push(s):r.push(n[a]={id:a,parts:[s]})}return r}function y(e,t){var r=c(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=f[f.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),f.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=_typeof$3(e.insertAt)||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=c(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,i)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),_(t,e.attrs),y(e,t),t}function _(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function b(e,t){var r,n,i,o,a,s;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var u=d++;r=l||(l=m(t)),n=S.bind(null,r,u,!1),i=S.bind(null,r,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=t,s=document.createElement("link"),void 0===a.attrs.type&&(a.attrs.type="text/css"),a.attrs.rel="stylesheet",_(s,a.attrs),y(a,s),r=s,n=$.bind(null,r,t),i=function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),n=T.bind(null,r),i=function(){v(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=("undefined"==typeof document?"undefined":_typeof$3(document)))throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==_typeof$3(t.attrs)?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=g(e,t);return p(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var o=r[i];(s=a[o.id]).refs--,n.push(s)}for(e&&p(g(e,t),t),i=0;i<n.length;i++){var s;if(0===(s=n[i]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete a[s.id]}}}};var A,E=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function S(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=E(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function T(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function $(e,t,r){var n=r.css,i=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(n=h(n)),i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}}])}(dist$3);var DanmuJs$1=getDefaultExportFromCjs(dist$3.exports);function PanelIcon(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="-5 -11 40 40" width="40" height="40">\n  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>\n  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>\n</svg>\n',"image/svg+xml").firstChild}var DanmuPanel=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).set={speed:1,area:{},opacity:1,fonSize:"middle"},n}return _createClass$2(r,[{key:"afterCreate",value:function(){"mobile"===sniffer.device?this.activeEvent="click":this.activeEvent="mouseenter",this.onStateChange=this.onStateChange.bind(this),this.onToggle=this.onToggle.bind(this),this.bind(this.activeEvent,this.onToggle),this.bind("mouseleave",this.onToggle),this.appendChild(".xgplayer-panel-icon",PanelIcon())}},{key:"onStateChange",value:function(e){this.config.onChangeSet&&this.config.onChangeSet(this.set)}},{key:"onToggle",value:function(e){e.preventDefault(),e.stopPropagation(),util$2.hasClass(this.root,"slider-show")?util$2.removeClass(this.root,"slider-show"):util$2.addClass(this.root,"slider-show")}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.onStateChange)}},{key:"render",value:function(){return'\n      <xg-icon class="xgplayer-panel">\n          <xg-panel-icon class="xgplayer-panel-icon">\n          </xg-panel-icon>\n          <xg-panel-slider class="xgplayer-panel-slider">\n            <xg-hidemode class="xgplayer-hidemode">\n              <p class="xgplayer-hidemode-font">屏蔽类型</p>\n              <ul class="xgplayer-hidemode-radio">\n                <li class="xgplayer-hidemode-scroll" id="false">滚动</li><li class="xgplayer-hidemode-top" id="false">顶部</li><li class="xgplayer-hidemode-bottom" id="false">底部</li><li class="xgplayer-hidemode-color" id="false">色彩</li>\n              </ul>\n            </xg-hidemode>\n            <xg-transparency class="xgplayer-transparency">\n              <span>不透明度</span>\n              <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>\n            </xg-transparency>\n            <xg-showarea class="xgplayer-showarea">\n              <div class="xgplayer-showarea-name">显示区域</div>\n              <div class="xgplayer-showarea-control">\n                <div class="xgplayer-showarea-control-up">\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>\n                </div>\n                <div class="xgplayer-showarea-control-down">\n                  <div class="xgplayer-showarea-control-down-dots">\n                    <span class="xgplayer-showarea-onequarters-dot"></span>\n                    <span class="xgplayer-showarea-twoquarters-dot"></span>\n                    <span class="xgplayer-showarea-threequarters-dot"></span>\n                    <span class="xgplayer-showarea-full-dot"></span>\n                  </div>\n                  <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">\n                </div>\n              </div>\n            </xg-showarea>\n            <xg-danmuspeed class="xgplayer-danmuspeed">\n              <div class="xgplayer-danmuspeed-name">弹幕速度</div>\n              <div class="xgplayer-danmuspeed-control">\n                <div class="xgplayer-danmuspeed-control-up">\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small">慢</span>\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color">中</span>\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large">快</span>\n                </div>\n                <div class="xgplayer-danmuspeed-control-down">\n                  <div class="xgplayer-danmuspeed-control-down-dots">\n                    <span class="xgplayer-danmuspeed-small-dot"></span>\n                    <span class="xgplayer-danmuspeed-middle-dot"></span>\n                    <span class="xgplayer-danmuspeed-large-dot"></span>\n                  </div>\n                  <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">\n                </div>\n              </div>\n            </xg-danmuspeed>\n            <xg-danmufont class="xgplayer-danmufont">\n              <div class="xgplayer-danmufont-name">字体大小</div>\n              <div class="xgplayer-danmufont-control">\n                <div class="xgplayer-danmufont-control-up">\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small">小</span>\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle">中</span>\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color">大</span>\n                </div>\n                <div class="xgplayer-danmufont-control-down">\n                  <div class="xgplayer-danmufont-control-down-dots">\n                    <span class="xgplayer-danmufont-small-dot"></span>\n                    <span class="xgplayer-danmufont-middle-dot"></span>\n                    <span class="xgplayer-danmufont-large-dot"></span>\n                  </div>\n                  <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">\n                </div>\n              </div>\n            </xg-danmufont>\n          </xg-panel-slider>\n      </xg-icon>'}}],[{key:"pluginName",get:function(){return"danmuPanel"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:11,onChangeSet:function(e){console.log("DanmuPanel:".concat(e))},speed:1,area:{},opacity:1,fonSize:"middle"}}}]),r}(Plugin),DANMU_OPEN='<dk-switch class="danmu-switch">\n<span class="txt">弹</span>\n</dk-switch>',DanmuIcon=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$2(this,r),t.apply(this,arguments)}return _createClass$2(r,[{key:"afterCreate",value:function(){this.initIcons(),this.onStateChange=this.onStateChange.bind(this),this.bind(["click","touchend"],this.onStateChange)}},{key:"registerIcons",value:function(){return{openDanmu:{icon:DANMU_OPEN,class:"danmu-switch-open"},closeDanmu:{icon:DANMU_OPEN,class:"danmu-switch-closed"}}}},{key:"switchState",value:function(e){e?this.setAttr("data-state","active"):this.setAttr("data-state","normal"),this.switchTips(e)}},{key:"initIcons",value:function(){var e=this.icons,t=this.find(".xgplayer-icon");t.appendChild(e.openDanmu),t.appendChild(e.closeDanmu)}},{key:"switchTips",value:function(e){this.changeLangTextKey(this.find(".xg-tips"),e?"OFF":"OPEN")}},{key:"onStateChange",value:function(e){e.preventDefault(),e.stopPropagation();var t="active"===this.root.getAttribute("data-state");this.switchState(!t),this.config.onSwitch&&this.config.onSwitch(e,!t)}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){return'\n    <xg-icon class="danmu-icon">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="'.concat(this.i18nKeys.OPEN,'">').concat(this.i18n.OPEN,"</div>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"danmuIcon"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:11,onSwitch:function(e,t){}}}}]),r}(Plugin),MIN_INTERVAL$1=300,Danmu=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(e){var n;return _classCallCheck$2(this,r),(n=t.call(this,e)).danmujs=null,n.danmuPanel=null,n.isOpen=!1,n.seekCost=0,n.intervalId=0,n.isUseClose=!1,n}return _createClass$2(r,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.isLive&&(this.config.isLive=!0),this.initDanmu(),this.registerExtIcons(),this.once(TIME_UPDATE,(function(){e.config.defaultOpen&&!e.isUseClose&&e.start()})),this.on(PAUSE,(function(){e.isOpen&&e.danmujs&&e.danmujs.pause()})),this.on(PLAY,(function(){e.isOpen&&e.danmujs&&e.danmujs.play()})),this.on(SEEKING,(function(){e.seekCost=window.performance.now(),!e.config.isLive&&e.danmujs&&e.danmujs.stop()})),this.on(VIDEO_RESIZE,(function(){e.resize()})),this.on(SEEKED,(function(){e.danmujs&&e.isOpen&&(e.intervalId&&(util$2.clearTimeout(e,e.intervalId),e.intervalId=null),window.performance.now()-e.seekCost>MIN_INTERVAL$1?e.danmujs.start():e.intervalId=util$2.setTimeout(e,(function(){e.danmujs.start(),e.intervalId=null}),MIN_INTERVAL$1))}))}},{key:"onPluginsReady",value:function(){var e=this.player.plugins.pc;e&&(e.onVideoDblClick&&this.bind("dblclick",e.onVideoDblClick),e.onVideoClick&&this.bind("click",e.onVideoClick))}},{key:"initDanmu",value:function(){var e=this.player,t=this.config,r=this.config,n=r.channelSize,i=r.fontSize,o=r.opacity,a=r.mouseControl,s=r.mouseControlPause,u=r.area,c=r.defaultOff,l={container:this.root,player:e.video,comments:this.config.comments,live:t.isLive,defaultOff:c,area:u,mouseControl:a,mouseControlPause:s};t.ext&&Object.keys(t.ext).map((function(e){l[e]=t.ext[e]}));var d=new DanmuJs$1(l);this.danmujs=d,e.danmu=d,this.setFontSize(i,n),this.setArea(u),this.resize(),1!==o&&this.setOpacity(o)}},{key:"registerExtIcons",value:function(){var e=this,t=this.player,r=this.config;if(r.panel){var n={config:{onChangeset:function(t){e.changeSet(t)}}};this.danmuPanel=t.controls.registerPlugin(DanmuPanel,n,DanmuPanel.pluginName)}var i=r.switchConfig;if(!r.closeDefaultBtn){var o={config:{onSwitch:function(t,r){e.onSwitch(t,r)}}};Object.keys(i).map((function(e){o.config[e]=i[e]})),this.danmuButton=t.controls.registerPlugin(DanmuIcon,o,DanmuIcon.pluginName),this.config.defaultOpen&&this.danmuButton.switchState(!0)}}},{key:"changeSet",value:function(e){}},{key:"onSwitch",value:function(e,t){this.emitUserAction(e,"switch_danmu",{prop:"isOpen",from:!t,to:t}),t?this.start():this.stop()}},{key:"start",value:function(){var e=this;!this.isOpen&&this.danmujs&&(this.isUseClose=!1,this.show(),this.resize(),util$2.setTimeout(this,(function(){e.danmujs.start(),e.player.paused&&e.danmujs.pause(),e.isOpen=!0}),0))}},{key:"stop",value:function(){this.isUseClose=!0,this.isOpen&&this.danmujs&&(this.danmujs.stop(),this.config.isLive&&this.clear(),this.isOpen=!1,this.hide())}},{key:"clear",value:function(){this.danmujs&&this.danmujs.clear()}},{key:"setCommentLike",value:function(e,t){this.danmujs&&this.danmujs.setCommentLike(e,t)}},{key:"setCommentDuration",value:function(e,t){this.danmujs&&this.danmujs.setCommentDuration(e,t)}},{key:"setAllDuration",value:function(e,t){this.danmujs&&this.danmujs.setAllDuration(e,t)}},{key:"setCommentID",value:function(e,t){this.danmujs&&this.danmujs.setCommentID(e,t)}},{key:"hideMode",value:function(e){this.danmujs&&this.danmujs.hide(e)}},{key:"showMode",value:function(e){this.danmujs&&this.danmujs.show(e)}},{key:"setArea",value:function(e){this.danmujs&&this.danmujs.setArea(e)}},{key:"setOpacity",value:function(e){this.danmujs&&this.danmujs.setOpacity(e)}},{key:"setFontSize",value:function(e,t){this.danmujs&&this.danmujs.setFontSize(e,t)}},{key:"resize",value:function(){this.danmujs&&this.danmujs.resize()}},{key:"sendComment",value:function(e){this.danmujs&&this.danmujs.sendComment(e)}},{key:"hideIcon",value:function(){this.danmuButton&&this.danmuButton.hide()}},{key:"showIcon",value:function(){this.danmuButton&&this.danmuButton.show()}},{key:"destroy",value:function(){this.danmujs.stop(),this.danmujs.destroy(),this.danmujs=null,this.player.danmu=null;var e=this.danmuButton,t=this.danmuPanel;this.danmuButton&&this.danmuButton.root&&e.__destroy&&e.__destroy(),this.danmuPanel&&this.danmuPanel.root&&t.__destroy&&t.__destroy(),this.danmuButton=null,this.danmuPanel=null}},{key:"render",value:function(){return'<xg-danmu class="xgplayer-danmu">\n    </xg-danmu>'}}],[{key:"pluginName",get:function(){return"danmu"}},{key:"defaultConfig",get:function(){return{comments:[],area:{start:0,end:1},closeDefaultBtn:!1,defaultOff:!1,panel:!1,panelConfig:{},switchConfig:{},defaultOpen:!0,isLive:!1,channelSize:24,fontSize:14,opacity:1,mouseControl:!1,mouseControlPause:!1,ext:{},style:{}}}}]),r}(Plugin),index_min$2={exports:{}};!function(e,t){e.exports=function(){function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}function r(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=M(t),this.reject=M(r)}function n(e){var t=e.length;return 3===t?(60*(60*Number(e[0])+Number(e[1]))*1e3+1e3*Number(e[2]))/1e3:2===t?(60*Number(e[0])*1e3+1e3*Number(e[1]))/1e3:Number(e[0])}function i(e){return/^(\-|\+)?\d+(\.\d+)?$/.test(e)}function o(e){return e}function a(e,t){return e>=0&&e<t.length?t[e]:""}function s(e,t){if(!e)return!1;if(e.classList)return Array.prototype.some.call(e.classList,(function(e){return e===t}));var r=e.className&&"object"===Xt(e.className)?e.getAttribute("class"):e.className;return r&&!!r.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function u(e,t){e&&(e.classList?t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach((function(t){t&&e.classList.add(t)})):s(e,t)||(e.className&&"object"===Xt(e.className)?e.setAttribute("class",e.getAttribute("class")+" "+t):e.className+=" "+t))}function c(e,t){e&&(e.classList?t.split(/\s+/g).forEach((function(t){e.classList.remove(t)})):s(e,t)&&t.split(/\s+/g).forEach((function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className&&"object"===Xt(e.className)?e.setAttribute("class",e.getAttribute("class").replace(r," ")):e.className=e.className.replace(r," ")})))}function l(e,t,r){var n=t.length;if(n<1)return-1;if(t[r=r<0?0:r>=n?n-1:r].start<=e&&e<t[r].end)return r;for(var i=t[r].end<=e?r+1:0;i<n;i++){if(t[i].start<=e&&e<t[i].end)return i;if(e>t[i].end&&i+1<n&&e<t[i+1].start)return-1;if(e>t[i].end&&i+1>=n)return-1}return-1}function d(e,t,r){var n=t.length;if(n<1)return[];var i=[];if((r=r<0?0:r>=n?n-1:r)<n)for(var o=t[r].end<=e?r:0;o<n&&(t[o].start<=e&&e<t[o].end&&i.push(o),!(e<t[o].start));o++);return i}function f(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Sn(r).forEach((function(t){var n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)})),i}function p(){var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e);return/(?:iPhone)/.test(e)&&!o||n||r||o}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="";e.map((function(e){r+=" "+t+" "+e.key+" {"+e.style+"}"}));var n=document.createElement("style"),i=document.head||document.getElementsByTagName("head")[0];if(n.type="text/css",n.id="ssss",n.styleSheet){var o=function(){try{n.styleSheet.cssText=r}catch(e){}};n.styleSheet.disabled?setTimeout(o,10):o()}else{var a=document.createTextNode(r);n.appendChild(a)}i.appendChild(n)}function y(e,t){Mn||(Mn=new Nn),Mn.addObserver(e,t)}function v(e,t){Mn&&Mn.unObserver(e,t)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={code:Bn[e].code,msg:Bn[e].msg};return Sn(t).map((function(e){r[e]=t[e]})),r}function _(e,t,r,n,i){i?r(m(2,i),{format:n.format}):n.format?(e.list=n.list,e.format=n.format,e.styles=n.styles,t(e)):r(m(3))}function b(e){return new An((function(t,r){if(e.list)t(e);else{if(e.json){var n=Ln.parseJson(e.json);return e.list=n,e.format="json",void t(e)}if(e.stringContent&&!e.url)Ln.parse(e.stringContent,(function(n,i){_(e,t,r,n,i)}));else if(e.url)new $n({url:e.url,type:"text"}).then((function(n){Ln.parse(n.res.response,(function(n,i){_(e,t,r,n,i)}))})).catch((function(t){var n=m(1,{statusText:t.statusText,status:t.status,type:t.type,message:"http load error",url:e.url});r(n)}));else{var i=m(8);r(i)}}}))}function A(e,t){return!!(e.id&&e.id===t.id||e.language&&e.language===t.language)}var E=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},S=function(e){return Object(E(e))},T={}.hasOwnProperty,$=function(e,t){return T.call(e,t)},w=t((function(e){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)})),C=(w.version,t((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}))),I=t((function(e){var t=C["__core-js_shared__"]||(C["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:w.version,mode:"pure",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})})),k=0,O=Math.random(),P=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++k+O).toString(36))},R=I("keys"),x=function(e){return R[e]||(R[e]=P(e))},D=x("IE_PROTO"),L=Object.prototype,N=Object.getPrototypeOf||function(e){return e=S(e),$(e,D)?e[D]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?L:null},M=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},B=function(e,t,r){if(M(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},U=function(e){return"object"==_typeof$3(e)?null!==e:"function"==typeof e},j=function(e){if(!U(e))throw TypeError(e+" is not an object!");return e},F=function(e){try{return!!e()}catch(t){return!0}},V=!F((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),G=C.document,H=U(G)&&U(G.createElement),K=function(e){return H?G.createElement(e):{}},z=!V&&!F((function(){return 7!=Object.defineProperty(K("div"),"a",{get:function(){return 7}}).a})),W=function(e,t){if(!U(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!U(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!U(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!U(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},Y=Object.defineProperty,X={f:V?Object.defineProperty:function(e,t,r){if(j(e),t=W(t,!0),j(r),z)try{return Y(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},Z=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},q=V?function(e,t,r){return X.f(e,t,Z(1,r))}:function(e,t,r){return e[t]=r,e},Q=function e(t,r,n){var i,o,a,s=t&e.F,u=t&e.G,c=t&e.S,l=t&e.P,d=t&e.B,f=t&e.W,h=u?w:w[r]||(w[r]={}),p=h.prototype,g=u?C:c?C[r]:(C[r]||{}).prototype;for(i in u&&(n=r),n)(o=!s&&g&&void 0!==g[i])&&$(h,i)||(a=o?g[i]:n[i],h[i]=u&&"function"!=typeof g[i]?n[i]:d&&o?B(a,C):f&&g[i]==a?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(a):l&&"function"==typeof a?B(Function.call,a):a,l&&((h.virtual||(h.virtual={}))[i]=a,t&e.R&&p&&!p[i]&&q(p,i,a)))};Q.F=1,Q.G=2,Q.S=4,Q.P=8,Q.B=16,Q.W=32,Q.U=64,Q.R=128;var J=Q,ee=function(e,t){var r=(w.Object||{})[e]||Object[e],n={};n[e]=t(r),J(J.S+J.F*F((function(){r(1)})),"Object",n)};ee("getPrototypeOf",(function(){return function(e){return N(S(e))}}));var te,re=w.Object.getPrototypeOf,ne=e(t((function(e){e.exports={default:re,__esModule:!0}}))),ie=e(t((function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}))),oe=Math.ceil,ae=Math.floor,se=function(e){return isNaN(e=+e)?0:(e>0?ae:oe)(e)},ue=q,ce={},le={}.toString,de=function(e){return le.call(e).slice(8,-1)},fe=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==de(e)?e.split(""):Object(e)},he=function(e){return fe(E(e))},pe=Math.min,ge=function(e){return e>0?pe(se(e),9007199254740991):0},ye=Math.max,ve=Math.min,me=function(e,t){return(e=se(e))<0?ye(e+t,0):ve(e,t)},_e=(te=!1,function(e,t,r){var n,i=he(e),o=ge(i.length),a=me(r,o);if(te&&t!=t){for(;o>a;)if((n=i[a++])!=n)return!0}else for(;o>a;a++)if((te||a in i)&&i[a]===t)return te||a||0;return!te&&-1}),be=x("IE_PROTO"),Ae=function(e,t){var r,n=he(e),i=0,o=[];for(r in n)r!=be&&$(n,r)&&o.push(r);for(;t.length>i;)$(n,r=t[i++])&&(~_e(o,r)||o.push(r));return o},Ee="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Se=Object.keys||function(e){return Ae(e,Ee)},Te=V?Object.defineProperties:function(e,t){j(e);for(var r,n=Se(t),i=n.length,o=0;i>o;)X.f(e,r=n[o++],t[r]);return e},$e=C.document,we=$e&&$e.documentElement,Ce=x("IE_PROTO"),Ie=function(){},ke=function(){var e,t=K("iframe"),r=Ee.length;for(t.style.display="none",we.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),ke=e.F;r--;)delete ke.prototype[Ee[r]];return ke()},Oe=Object.create||function(e,t){var r;return null!==e?(Ie.prototype=j(e),r=new Ie,Ie.prototype=null,r[Ce]=e):r=ke(),void 0===t?r:Te(r,t)},Pe=t((function(e){var t=I("wks"),r=C.Symbol,n="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=n&&r[e]||(n?r:P)("Symbol."+e))}).store=t})),Re=X.f,xe=Pe("toStringTag"),De=function(e,t,r){e&&!$(e=r?e:e.prototype,xe)&&Re(e,xe,{configurable:!0,value:t})},Le={};q(Le,Pe("iterator"),(function(){return this}));var Ne=function(e,t,r){e.prototype=Oe(Le,{next:Z(1,r)}),De(e,t+" Iterator")},Me=Pe("iterator"),Be=!([].keys&&"next"in[].keys()),Ue=function(){return this},je=function(e,t,r,n,i,o,a){Ne(r,t,n);var s,u,c,l=function(e){if(!Be&&e in p)return p[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},d=t+" Iterator",f="values"==i,h=!1,p=e.prototype,g=p[Me]||p["@@iterator"]||i&&p[i],y=g||l(i),v=i?f?l("entries"):y:void 0,m="Array"==t&&p.entries||g;if(m&&(c=N(m.call(new e)))!==Object.prototype&&c.next&&De(c,d,!0),f&&g&&"values"!==g.name&&(h=!0,y=function(){return g.call(this)}),a&&(Be||h||!p[Me])&&q(p,Me,y),ce[t]=y,ce[d]=Ue,i)if(s={values:f?y:l("values"),keys:o?y:l("keys"),entries:v},a)for(u in s)u in p||ue(p,u,s[u]);else J(J.P+J.F*(Be||h),t,s);return s},Fe=function(e){return function(t,r){var n,i,o=String(E(t)),a=se(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}}(!0);je(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Fe(t,r),this._i+=e.length,{value:e,done:!1})}));var Ve=function(e,t){return{value:t,done:!!e}};je(Array,"Array",(function(e,t){this._t=he(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,Ve(1)):Ve(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),ce.Arguments=ce.Array;for(var Ge=Pe("toStringTag"),He="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ke=0;Ke<He.length;Ke++){var ze=He[Ke],We=C[ze],Ye=We&&We.prototype;Ye&&!Ye[Ge]&&q(Ye,Ge,ze),ce[ze]=ce.Array}var Xe={f:Pe},Ze=Xe.f("iterator"),qe=t((function(e){e.exports={default:Ze,__esModule:!0}}));e(qe);var Qe=t((function(e){var t=P("meta"),r=X.f,n=0,i=Object.isExtensible||function(){return!0},o=!F((function(){return i(Object.preventExtensions({}))})),a=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},s=function(e,r){if(!U(e))return"symbol"==_typeof$3(e)?e:("string"==typeof e?"S":"P")+e;if(!$(e,t)){if(!i(e))return"F";if(!r)return"E";a(e)}return e[t].i},u=function(e,r){if(!$(e,t)){if(!i(e))return!0;if(!r)return!1;a(e)}return e[t].w},c=function(e){return o&&l.NEED&&i(e)&&!$(e,t)&&a(e),e},l=e.exports={KEY:t,NEED:!1,fastKey:s,getWeak:u,onFreeze:c}})),Je=(Qe.KEY,Qe.NEED,Qe.fastKey,Qe.getWeak,Qe.onFreeze,X.f),et=function(e){var t=w.Symbol||(w.Symbol={});"_"==e.charAt(0)||e in t||Je(t,e,{value:Xe.f(e)})},tt={f:Object.getOwnPropertySymbols},rt={f:{}.propertyIsEnumerable},nt=function(e){var t=Se(e),r=tt.f;if(r)for(var n,i=r(e),o=rt.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t},it=Array.isArray||function(e){return"Array"==de(e)},ot=Ee.concat("length","prototype"),at={f:Object.getOwnPropertyNames||function(e){return Ae(e,ot)}},st=at.f,ut={}.toString,ct="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],lt=function(e){try{return st(e)}catch(t){return ct.slice()}},dt={f:function(e){return ct&&"[object Window]"==ut.call(e)?lt(e):st(he(e))}},ft=Object.getOwnPropertyDescriptor,ht={f:V?ft:function(e,t){if(e=he(e),t=W(t,!0),z)try{return ft(e,t)}catch(r){}if($(e,t))return Z(!rt.f.call(e,t),e[t])}},pt=Qe.KEY,gt=ht.f,yt=X.f,vt=dt.f,mt=C.Symbol,_t=C.JSON,bt=_t&&_t.stringify,At=Pe("_hidden"),Et=Pe("toPrimitive"),St={}.propertyIsEnumerable,Tt=I("symbol-registry"),$t=I("symbols"),wt=I("op-symbols"),Ct=Object.prototype,It="function"==typeof mt&&!!tt.f,kt=C.QObject,Ot=!kt||!kt.prototype||!kt.prototype.findChild,Pt=V&&F((function(){return 7!=Oe(yt({},"a",{get:function(){return yt(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=gt(Ct,t);n&&delete Ct[t],yt(e,t,r),n&&e!==Ct&&yt(Ct,t,n)}:yt,Rt=function(e){var t=$t[e]=Oe(mt.prototype);return t._k=e,t},xt=It&&"symbol"==_typeof$3(mt.iterator)?function(e){return"symbol"==_typeof$3(e)}:function(e){return e instanceof mt},Dt=function e(t,r,n){return t===Ct&&e(wt,r,n),j(t),r=W(r,!0),j(n),$($t,r)?(n.enumerable?($(t,At)&&t[At][r]&&(t[At][r]=!1),n=Oe(n,{enumerable:Z(0,!1)})):($(t,At)||yt(t,At,Z(1,{})),t[At][r]=!0),Pt(t,r,n)):yt(t,r,n)},Lt=function(e,t){j(e);for(var r,n=nt(t=he(t)),i=0,o=n.length;o>i;)Dt(e,r=n[i++],t[r]);return e},Nt=function(e,t){return void 0===t?Oe(e):Lt(Oe(e),t)},Mt=function(e){var t=St.call(this,e=W(e,!0));return!(this===Ct&&$($t,e)&&!$(wt,e))&&(!(t||!$(this,e)||!$($t,e)||$(this,At)&&this[At][e])||t)},Bt=function(e,t){if(e=he(e),t=W(t,!0),e!==Ct||!$($t,t)||$(wt,t)){var r=gt(e,t);return!r||!$($t,t)||$(e,At)&&e[At][t]||(r.enumerable=!0),r}},Ut=function(e){for(var t,r=vt(he(e)),n=[],i=0;r.length>i;)$($t,t=r[i++])||t==At||t==pt||n.push(t);return n},jt=function(e){for(var t,r=e===Ct,n=vt(r?wt:he(e)),i=[],o=0;n.length>o;)!$($t,t=n[o++])||r&&!$(Ct,t)||i.push($t[t]);return i};It||(ue((mt=function(){if(this instanceof mt)throw TypeError("Symbol is not a constructor!");var e=P(arguments.length>0?arguments[0]:void 0),t=function t(r){this===Ct&&t.call(wt,r),$(this,At)&&$(this[At],e)&&(this[At][e]=!1),Pt(this,e,Z(1,r))};return V&&Ot&&Pt(Ct,e,{configurable:!0,set:t}),Rt(e)}).prototype,"toString",(function(){return this._k})),ht.f=Bt,X.f=Dt,at.f=dt.f=Ut,rt.f=Mt,tt.f=jt,Xe.f=function(e){return Rt(Pe(e))}),J(J.G+J.W+J.F*!It,{Symbol:mt});for(var Ft="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Vt=0;Ft.length>Vt;)Pe(Ft[Vt++]);for(var Gt=Se(Pe.store),Ht=0;Gt.length>Ht;)et(Gt[Ht++]);J(J.S+J.F*!It,"Symbol",{for:function(e){return $(Tt,e+="")?Tt[e]:Tt[e]=mt(e)},keyFor:function(e){if(!xt(e))throw TypeError(e+" is not a symbol!");for(var t in Tt)if(Tt[t]===e)return t},useSetter:function(){Ot=!0},useSimple:function(){Ot=!1}}),J(J.S+J.F*!It,"Object",{create:Nt,defineProperty:Dt,defineProperties:Lt,getOwnPropertyDescriptor:Bt,getOwnPropertyNames:Ut,getOwnPropertySymbols:jt});var Kt=F((function(){tt.f(1)}));J(J.S+J.F*Kt,"Object",{getOwnPropertySymbols:function(e){return tt.f(S(e))}}),_t&&J(J.S+J.F*(!It||F((function(){var e=mt();return"[null]"!=bt([e])||"{}"!=bt({a:e})||"{}"!=bt(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(U(t)||void 0!==e)&&!xt(e))return it(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!xt(t))return t}),n[1]=t,bt.apply(_t,n)}}),mt.prototype[Et]||q(mt.prototype,Et,mt.prototype.valueOf),De(mt,"Symbol"),De(Math,"Math",!0),De(C.JSON,"JSON",!0),et("asyncIterator"),et("observable");var zt=w.Symbol,Wt=t((function(e){e.exports={default:zt,__esModule:!0}}));e(Wt);var Yt=t((function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(qe),i=r(Wt),o="function"==typeof i.default&&"symbol"==_typeof$3(n.default)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":_typeof$3(e)};t.default="function"==typeof i.default&&"symbol"===o(n.default)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":o(e)}})),Xt=e(Yt),Zt=e(t((function(e,t){t.__esModule=!0;var r,n=(r=Yt)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}})));J(J.S+J.F*!V,"Object",{defineProperty:X.f});var qt=w.Object,Qt=function(e,t,r){return qt.defineProperty(e,t,r)},Jt=t((function(e){e.exports={default:Qt,__esModule:!0}}));e(Jt);var er=e(t((function(e,t){t.__esModule=!0;var r,n=(r=Jt)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()}))),tr=function(e,t){if(j(e),!U(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},rr={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=B(Function.call,ht.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(n){t=!0}return function(e,n){return tr(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:tr};J(J.S,"Object",{setPrototypeOf:rr.set});var nr=w.Object.setPrototypeOf,ir=t((function(e){e.exports={default:nr,__esModule:!0}}));e(ir),J(J.S,"Object",{create:Oe});var or=w.Object,ar=function(e,t){return or.create(e,t)},sr=t((function(e){e.exports={default:ar,__esModule:!0}}));e(sr);var ur,cr,lr,dr=e(t((function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(ir),i=r(sr),o=r(Yt);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}}))),fr=Pe("toStringTag"),hr="Arguments"==de(function(){return arguments}()),pr=function(e,t){try{return e[t]}catch(r){}},gr=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=pr(t=Object(e),fr))?r:hr?de(t):"Object"==(n=de(t))&&"function"==typeof t.callee?"Arguments":n},yr=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},vr=function(e,t,r,n){try{return n?t(j(r)[0],r[1]):t(r)}catch(o){var i=e.return;throw void 0!==i&&j(i.call(e)),o}},mr=Pe("iterator"),_r=Array.prototype,br=function(e){return void 0!==e&&(ce.Array===e||_r[mr]===e)},Ar=Pe("iterator"),Er=w.getIteratorMethod=function(e){if(null!=e)return e[Ar]||e["@@iterator"]||ce[gr(e)]},Sr=t((function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var s,u,c,l,d=a?function(){return e}:Er(e),f=B(i,o,n?2:1),h=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(br(d)){for(s=ge(e.length);s>h;h++)if((l=n?f(j(u=e[h])[0],u[1]):f(e[h]))===t||l===r)return l}else for(c=d.call(e);!(u=c.next()).done;)if((l=vr(c,f,u.value,n))===t||l===r)return l};n.BREAK=t,n.RETURN=r})),Tr=Pe("species"),$r=function(e,t){var r,n=j(e).constructor;return void 0===n||null==(r=j(n)[Tr])?t:M(r)},wr=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},Cr=C.process,Ir=C.setImmediate,kr=C.clearImmediate,Or=C.MessageChannel,Pr=C.Dispatch,Rr=0,xr={},Dr=function(){var e=+this;if(xr.hasOwnProperty(e)){var t=xr[e];delete xr[e],t()}},Lr=function(e){Dr.call(e.data)};Ir&&kr||(Ir=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return xr[++Rr]=function(){wr("function"==typeof e?e:Function(e),t)},ur(Rr),Rr},kr=function(e){delete xr[e]},"process"==de(Cr)?ur=function(e){Cr.nextTick(B(Dr,e,1))}:Pr&&Pr.now?ur=function(e){Pr.now(B(Dr,e,1))}:Or?(lr=(cr=new Or).port2,cr.port1.onmessage=Lr,ur=B(lr.postMessage,lr,1)):C.addEventListener&&"function"==typeof postMessage&&!C.importScripts?(ur=function(e){C.postMessage(e+"","*")},C.addEventListener("message",Lr,!1)):ur="onreadystatechange"in K("script")?function(e){we.appendChild(K("script")).onreadystatechange=function(){we.removeChild(this),Dr.call(e)}}:function(e){setTimeout(B(Dr,e,1),0)});var Nr={set:Ir,clear:kr},Mr=Nr.set,Br=C.MutationObserver||C.WebKitMutationObserver,Ur=C.process,jr=C.Promise,Fr="process"==de(Ur),Vr={f:function(e){return new r(e)}},Gr=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}},Hr=C.navigator,Kr=Hr&&Hr.userAgent||"",zr=function(e,t){if(j(e),U(t)&&t.constructor===e)return t;var r=Vr.f(e);return(0,r.resolve)(t),r.promise},Wr=Pe("species"),Yr=Pe("iterator"),Xr=!1;try{var Zr=[7][Yr]();Zr.return=function(){Xr=!0},Array.from(Zr,(function(){throw 2}))}catch(te){}var qr,Qr,Jr,en,tn=Nr.set,rn=function(){var e,t,r,n=function(){var n,i;for(Fr&&(n=Ur.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(o){throw e?r():t=void 0,o}}t=void 0,n&&n.enter()};if(Fr)r=function(){Ur.nextTick(n)};else if(!Br||C.navigator&&C.navigator.standalone)if(jr&&jr.resolve){var i=jr.resolve(void 0);r=function(){i.then(n)}}else r=function(){Mr.call(C,n)};else{var o=!0,a=document.createTextNode("");new Br(n).observe(a,{characterData:!0}),r=function(){a.data=o=!o}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}(),nn=C.TypeError,on=C.process,an=on&&on.versions,sn=an&&an.v8||"",un=C.Promise,cn="process"==gr(on),ln=function(){},dn=Qr=Vr.f,fn=!!function(){try{var e=un.resolve(1),t=(e.constructor={})[Pe("species")]=function(e){e(ln,ln)};return(cn||"function"==typeof PromiseRejectionEvent)&&e.then(ln)instanceof t&&0!==sn.indexOf("6.6")&&-1===Kr.indexOf("Chrome/66")}catch(r){}}(),hn=function(e){var t;return!(!U(e)||"function"!=typeof(t=e.then))&&t},pn=function(e,t){if(!e._n){e._n=!0;var r=e._c;rn((function(){for(var n=e._v,i=1==e._s,o=0;r.length>o;)!function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&vn(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(nn("Promise-chain cycle")):(o=hn(r))?o.call(r,u,c):u(r)):c(n)}catch(d){l&&!a&&l.exit(),c(d)}}(r[o++]);e._c=[],e._n=!1,t&&!e._h&&gn(e)}))}},gn=function(e){tn.call(C,(function(){var t,r,n,i=e._v,o=yn(e);if(o&&(t=Gr((function(){cn?on.emit("unhandledRejection",i,e):(r=C.onunhandledrejection)?r({promise:e,reason:i}):(n=C.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=cn||yn(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},yn=function(e){return 1!==e._h&&0===(e._a||e._c).length},vn=function(e){tn.call(C,(function(){var t;cn?on.emit("rejectionHandled",e):(t=C.onrejectionhandled)&&t({promise:e,reason:e._v})}))},mn=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),pn(t,!0))},_n=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw nn("Promise can't be resolved itself");(r=hn(t))?rn((function(){var i={_w:n,_d:!1};try{r.call(t,B(e,i,1),B(mn,i,1))}catch(o){mn.call(i,o)}})):(n._v=t,n._s=1,pn(n,!1))}catch(i){mn.call({_w:n,_d:!1},i)}}};fn||(un=function(e){yr(this,un,"Promise","_h"),M(e),qr.call(this);try{e(B(_n,this,1),B(mn,this,1))}catch(t){mn.call(this,t)}},(qr=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(e,t,r){for(var n in t)r&&e[n]?e[n]=t[n]:q(e,n,t[n]);return e}(un.prototype,{then:function(e,t){var r=dn($r(this,un));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=cn?on.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&pn(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Jr=function(){var e=new qr;this.promise=e,this.resolve=B(_n,e,1),this.reject=B(mn,e,1)},Vr.f=dn=function(e){return e===un||e===en?new Jr(e):Qr(e)}),J(J.G+J.W+J.F*!fn,{Promise:un}),De(un,"Promise"),function(e){var t="function"==typeof w[e]?w[e]:C[e];V&&t&&!t[Wr]&&X.f(t,Wr,{configurable:!0,get:function(){return this}})}("Promise"),en=w.Promise,J(J.S+J.F*!fn,"Promise",{reject:function(e){var t=dn(this);return(0,t.reject)(e),t.promise}}),J(J.S+!0*J.F,"Promise",{resolve:function(e){return zr(this===en?un:this,e)}}),J(J.S+J.F*!(fn&&function(e,t){if(!Xr)return!1;var r=!1;try{var n=[7],i=n[Yr]();i.next=function(){return{done:r=!0}},n[Yr]=function(){return i},e(n)}catch(o){}return r}((function(e){un.all(e).catch(ln)}))),"Promise",{all:function(e){var t=this,r=dn(t),n=r.resolve,i=r.reject,o=Gr((function(){var r=[],o=0,a=1;Sr(e,!1,(function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,r[s]=e,--a||n(r))}),i)})),--a||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=dn(t),n=r.reject,i=Gr((function(){Sr(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}}),J(J.P+J.R,"Promise",{finally:function(e){var t=$r(this,w.Promise||C.Promise),r="function"==typeof e;return this.then(r?function(r){return zr(t,e()).then((function(){return r}))}:e,r?function(r){return zr(t,e()).then((function(){throw r}))}:e)}}),J(J.S,"Promise",{try:function(e){var t=Vr.f(this),r=Gr(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var bn=w.Promise,An=e(t((function(e){e.exports={default:bn,__esModule:!0}})));ee("keys",(function(){return function(e){return Se(S(e))}}));var En=w.Object.keys,Sn=e(t((function(e){e.exports={default:En,__esModule:!0}}))),Tn=t((function(e){function t(){}function r(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function n(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new r(n,i||e,o),u=s?s+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function i(e,r){0==--e._eventsCount?e._events=new t:delete e._events[r]}function o(){this._events=new t,this._eventsCount=0}var a=Object.prototype.hasOwnProperty,s="~";Object.create&&(t.prototype=Object.create(null),(new t).__proto__||(s=!1)),o.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)a.call(e,t)&&r.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=s?s+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,o=new Array(i);n<i;n++)o[n]=r[n].fn;return o},o.prototype.listenerCount=function(e){var t=s?s+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,n,i,o){var a=s?s+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,o),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,n);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},o.prototype.on=function(e,t,r){return n(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return n(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,r,n){var o=s?s+e:e;if(!this._events[o])return this;if(!t)return i(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||i(this,o);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||n&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:i(this,o)}return this},o.prototype.removeAllListeners=function(e){var r;return e?(r=s?s+e:e,this._events[r]&&i(this,r)):(this._events=new t,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=s,o.EventEmitter=o,e.exports=o})),$n=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,n=t.method,i=void 0===n?"GET":n,o=t.type,a=void 0===o?"arraybuffer":o,s=t.timeout,u=void 0===s?1e4:s,c=t.data,l=void 0===c?{}:c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ie(this,e),new An((function(e,t){var n=new window.XMLHttpRequest,o=i.toUpperCase(),s=[];for(var c in a&&(n.responseType=a),u&&(n.timeout=u),l)s.push("k="+l[c]);if(n.onload=function(){200===n.status||206===n.status?e({context:d,res:n}):t(new Error({context:d,res:n,type:"error"}))},n.onerror=function(e){t(new Error({context:d,res:n,type:"error"}))},n.ontimeout=function(e){t(new Error({context:d,res:n,type:"error"}))},n.onabort=function(){t(new Error({context:d,res:n,type:"error"}))},"GET"===o)n.open(o,""+r),n.send();else{if("post"!==o)throw new Error("xhr "+o+" is not supported");n.open(o,r),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(s.join("&"))}}))},wn=/^WEBVTT/,Cn=/^STYLE+$/,In=/^\:\:cue/,kn=/^}+$/,On=/^\[Script Info\].*/,Pn=[/[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}\.[0-9]{1,3}-->[0-9]{1,2}\.[0-9]{1,3}/],Rn=/^Format:\s/,xn=/^Style:\s/,Dn=/^Dialogue:\s/,Ln=function(){function e(){ie(this,e)}return er(e,null,[{key:"parseJson",value:function(e){for(var t=[],r=0,n=0;n<e.length;n++){if(r>=50&&(r=0),0===r){var i={start:e[n].start,list:[e[n]],end:e[n].end};t.push(i)}else t[t.length-1].list.push(e[n]),t[t.length-1].end=e[n].end;r++}return t}},{key:"parse",value:function(t,r){var n=e.checkFormat(t);n||r({format:n});try{var i=[];"ass"===n?i=e.parseASS(t):"vtt"===n&&(i=e.parseVTT(t)),r({format:n,list:i.list,styles:i.styles})}catch(o){console.error(o),r({format:n},o)}}},{key:"parseASSItem",value:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(","),r={},i="";try{var a=t.length-e.length;return i=o(i=(i=a>0?t.splice(e.length-1,a+1).join(",")+"":t[t.length-1]+"").replace(/\\n+/g,"")),t[e.length-1]=i,e.map((function(e,i){"end"===e||"start"===e?r[e]=n(t[i].split(":")):"text"===e?r[e]=[t[i]]:"layer"===e?(r[e]=[t[i]],r.textTag=[t[i]]):r[e]="style"===e?[t[i]]:Number(t[i])?Number(t[i]):t[i]})),r}catch(s){return console.error(s),{}}}},{key:"parseASS",value:function(t){for(var r=t.split("\n"),n=[],i=0,o=0,a=[],s=[],u=null;i<r.length;){if(Rn.test(r[i]))s=(s=r[i].replace(Rn,"").replace(/\s+/g,"").split(",")).map((function(e){return e.toLocaleLowerCase()}));else if(xn.test(r[i]))a.push(r[i].replace(xn,"").replace(/\s+/g,""));else if(Dn.test(r[i])){var c=e.parseASSItem(r[i].replace(Dn,""),s);if(u&&c.start===u.start&&c.end===u.end)try{var l=u,d=l.text,f=l.textTag,h=l.style;d.push(c.text[0]),f.push(c.textTag[0]),h.push(c.style[0])}catch(g){console.error(g)}else{u=c;var p=null;o%50==0?((p={start:u.start,end:u.end,list:[]}).list.push(u),n.push(p)):((p=n[n.length-1]).end=u.end,p.list.push(u)),o++}}i++}return{list:n,style:{}}}},{key:"parseVTTStyle",value:function(e,t){var r=e.split(":");if(r.length>1){var n=r[0].trim().split("-"),i="";n.length>1?n.map((function(e,t){i+=0===t?e:e.charAt(0).toUpperCase()+e.slice(1)})):i=n[0],t[i]=r[1].trim().replace(/;$/,"")}return t}},{key:"parseVTT",value:function(e){for(var t=(e=e.replace(wn,"")).split("\n"),r=[],n=0,o=0,s=null,u=!1,c=!1,l=null,d=null,f=[];n<t.length;){var h=a(n,t).trim();if(!h||u&&i(h))u=!h;else if(In.test(h)&&Cn.test(a(n-1,t).trim())){c=!0;var p=/\((.+?)\)/g.exec(h);d=p?p[1]:"",l=""}else if(c)kn.test(h)?(f.push({key:d,style:l}),l=null,d=null,c=!1):l+=h;else if(h){u=!1;var g=this.checkIsTime(t[n]);if(g){var y=this.parseVttTime(g);if(!s||y.start!==s.start||y.end!==s.end){(s=y).text=[],s.textTag=[];var v=null;o%50==0?((v={start:s.start,end:s.end,list:[]}).list.push(s),r.push(v)):((v=r[r.length-1]).end=s.end,v.list.push(s)),o++}}else if(s){var m=s,_=m.text,b=m.textTag,A=this.parseVttText(t[n]);_.push(A.text),b.push(A.tag)}u=!1}n++}return{list:r,styles:f}}},{key:"checkIsTime",value:function(e){e=e.replace(/\s+/g,"");for(var t=0,r=null;t<Pn.length&&!(r=Pn[t].exec(e));)t++;return r?r[0]:null}},{key:"parseVttText",value:function(e){var t=/^(<?.+?>)/g.exec(e),r="",n="default";if(t){n=t[0].replace(/\<|\>|\&/g,"");var i=RegExp("^<"+n+">(([\\s\\S])*?)</"+n+">$").exec(e);i?r=i[1]:(r=e,n="")}else r=e;for(var a=/<(\w+).(\w+)>/g,s=a.exec(r);s&&s.length>2;)r=r.replace(s[0],"<"+s[1]+' class="'+s[2]+'">'),s=a.exec(r);return{tag:n,text:o(r.replace(/\\n+/g,"<br/>"))}}},{key:"parseVttTime",value:function(e){var t=e.split("--\x3e"),r=void 0,i=0;if(2===t.length){var o=t[0].split(":"),a=t[1].split(":");r=n(o),i=n(a)}return{start:r,end:i,time:e}}},{key:"isVTT",value:function(e){return wn.test(e)}},{key:"isASS",value:function(e){return On.test(e)}},{key:"checkFormat",value:function(e){return e?wn.test(e)?"vtt":On.test(e)?"ass":null:null}}]),e}(),Nn=function(){function e(){var t=this;ie(this,e),this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver((function(e){t.__trigger(e)})))}return er(e,[{key:"addObserver",value:function(e,t){if(this.observer){this.observer&&this.observer.observe(e);for(var r=this.__handlers,n=-1,i=0;i<r.length;i++)r[i]&&e===r[i].target&&(n=i);n>-1?this.__handlers[n].handler.push(t):this.__handlers.push({target:e,handler:[t]})}}},{key:"unObserver",value:function(e){var t=-1;this.__handlers.map((function(r,n){e===r.target&&(t=n)})),this.observer&&this.observer.unobserve(e),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(e,t){for(var r=this.__handlers,n=0;n<r.length;n++)if(r[n]&&e===r[n].target){r[n].handler&&r[n].handler.map((function(r){try{r(e,t)}catch(n){console.error(n)}}));break}}},{key:"__trigger",value:function(e){var t=this;e.map((function(e){var r=e.contentRect;t.__runHandler(e.target,r)}))}}]),e}(),Mn=null;!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===r&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}('xg-text-track.xg-text-track {\n  font-family: "PingFang SC","SF Pro SC","SF Pro Text","SF Pro Icons","Helvetica Neue","Helvetica","Arial",sans-serif;\n  -webkit-font-smoothing: antialiased;\n  position: absolute;\n  bottom: 0;\n  color: #fff;\n  left: 0;\n  right: 0;\n  pointer-events: none;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center; }\n  xg-text-track.xg-text-track.text-track-no-fitvideo {\n    margin-bottom: 2%; }\n  xg-text-track.xg-text-track.text-track-hide {\n    opacity: 0;\n    visibility: hidden; }\n  xg-text-track.xg-text-track.text-track-show {\n    opacity: 1;\n    visibility: visible; }\n  xg-text-track.xg-text-track xg-text-track-inner {\n    display: block;\n    max-width: 92%; }\n  xg-text-track.xg-text-track xg-text-track-span {\n    display: -webkit-box;\n    text-align: center;\n    text-overflow: ellipsis;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    padding: 1px 4px;\n    -webkit-line-clamp: 1;\n    line-height: 120%;\n    word-break: break-word; }\n    xg-text-track.xg-text-track xg-text-track-span.text-track-deputy {\n      font-size: 75%; }\n    xg-text-track.xg-text-track xg-text-track-span.text-track-single {\n      -webkit-line-clamp: 1; }\n    xg-text-track.xg-text-track xg-text-track-span.text-track-double {\n      -webkit-line-clamp: 2; }\n    xg-text-track.xg-text-track xg-text-track-span.text-track-three {\n      -webkit-line-clamp: 3; }\n  xg-text-track.xg-text-track.text-track-bg xg-text-track-inner {\n    background-color: rgba(0, 0, 0, .54);\n    border-radius: 2px; }\n  xg-text-track.xg-text-track.text-track-stroke xg-text-track-inner {\n    background-color: none;\n    border-radius: 0;\n    text-shadow: -1px 1px 0 rgba(0, 0, 0, .7), 1px 1px 0 rgba(0, 0, 0, .7), 1px -1px 0 rgba(0, 0, 0, .7), -1px -1px 0 rgba(0, 0, 0, .7); }\n');var Bn=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR"},{code:6,msg:"ABORT"},{code:7,msg:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null"}],Un={RESIZE:"resize"},jn=!1;return function(e){function t(e){ie(this,t);var r=Zt(this,(t.__proto__||ne(t)).call(this));return jn=p(),r.currentText=null,r.textTrack=[],r._cid=-1,r._gid=-1,r._cids=[],r._iId=null,r._iC=0,r.player=null,r.root=null,r.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff"},r._ctime=0,r._loadingTrack={},Sn(r.config).map((function(t){void 0!==e[t]&&null!==e[t]&&(r.config[t]=e[t])})),r._isOpen=!1,r._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},e.subTitles&&"Array"===f(e.subTitles)?(e.player&&r.attachPlayer(e.player),r.setSubTitles(e.subTitles,r.config.defaultOpen),r):Zt(r)}return dr(t,e),er(t,[{key:"version",get:function(){return"1.0.12"}}]),er(t,[{key:"setSubTitles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._isOpen||r;n&&this.innerRoot&&this.switchOff(),this.currentText=null,this.textTrack=[],e.map((function(e){var r={};Sn(e).map((function(t){r[t]=e[t]})),r.isDefault&&(t.currentText=r),t.textTrack.push(r)})),this.currentText&&b(this.currentText).then((function(e){t.addStyles(e),i&&t.switch()}))}},{key:"addStyles",value:function(e){var t=e.styles,r=e.format;t&&"vtt"===r&&(t.map((function(e){e.key||(e.key="xg-text-track-span")})),g(t,"xg-text-track"))}},{key:"attachPlayer",value:function(e){var t=this;if(e){this.player&&this.detachPlayer();var r=this.config,n=r.fontColor,i=r.mode,o=r.fitVideo;this.player=e,this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&u(this.root,"text-track-hide"),!o&&u(this.root,"text-track-no-fitvideo"),i&&u(this.root,"text-track-"+i),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),n&&(this.root.style.color=n),this.currentText&&["language","id","label"].map((function(e){t.root.setAttribute("data-"+e,t.currentText[e]||"")})),this.player.root.appendChild(this.root),["destroy","__onTimeupdate","_onResize"].map((function(e){t[e]=t[e].bind(t)})),this.player.on("destroy",this.destroy),this.player.on("timeupdate",this.__onTimeupdate),this._isOpen&&this.switch(),y(e.root,this._onResize)}}},{key:"detachPlayer",value:function(){var e=this.player;e&&(e.off("destroy",this.destroy),e.off("timeupdate",this.__onTimeupdate),e.root&&(v(e.root,this._onResize),e.root.removeChild(this.root)),this.innerRoot=null,this.root=null,this.player=null)}},{key:"switch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",language:""};return this._loadingTrack=t,new An((function(r,n){if(t.id||t.language)if(e.currentText&&A(t,e.currentText))e._loadingTrack={},e._updateCurrent(e.currentText),e._isOpen=!0,e.show(),r(m(0));else{for(var i=null,o=0;o<e.textTrack.length;o++)if(A(t,e.textTrack[o])){i=e.textTrack[o];break}if(i)i.list?(e._loadingTrack={},e._updateCurrent(i),e._isOpen=!0,e.show(),r(m(0))):b(i).then((function(t){if(e.addStyles(t),e._loadingTrack.id===i.id||e._loadingTrack.language===t.language)e._loadingTrack={},e._updateCurrent(t),e._isOpen=!0,e.show(),r(m(0));else{var o=m(6,{message:"check _loadingTrack fail id: "+e._loadingTrack.id+"  nextSubtitle:"+t.id});console.trace(o),n(o)}})).catch((function(e){n(e)}));else{var a=m(4,new Error("The is no subtitle with id:[{"+t.id+"}] or language:["+t.language+"]"));console.trace(a),n(a)}}else{if(e.currentText){e._loadingTrack={},e._updateCurrent(e.currentText),e._isOpen=!0,e.show();var s=m(0,{message:"switch default subtitle success"});return void r(s)}var u=m(5,{message:"no default subtitle"});n(u)}}))}},{key:"switchOff",value:function(){this._isOpen=!1,this.hide()}},{key:"_updateCurrent",value:function(e){var t=this;if(this.root){this.currentText=e,["language","id","label"].map((function(e){t.root.setAttribute("data-"+e,t.currentText[e]||"")})),this.__remove(this._cids);var r=this.player.currentTime;this._cids=[],this._gid=-1,this._cid=-1,this._update(r)}}},{key:"__loadAll",value:function(){this.textTrack.map((function(e){b(e)}))}},{key:"getDelCid",value:function(e,t){for(var r=[],n=0;n<e.length;n++)t.includes(e[n])||r.push(e[n]);return r}},{key:"getNewCid",value:function(e,t){for(var r=[],n=0;n<t.length;n++)e.includes(t[n])||r.push(t[n]);return r}},{key:"_update",value:function(e){var t=this,r=l(e,this.currentText.list,this._gid),n=[];if(r>-1&&(n=d(e,this.currentText.list[r].list,this._cid)),n.length<1)return this._cids.length>0&&this.__remove(this._cids),void(this._cids=[]);if(this._cids!==n||r!==this._gid){this._gid=r,this._cid=n[0];var i=this.getDelCid(this._cids,n),o=this.getNewCid(this._cids,n);this._cids=n,this.__remove(i);var a=[];o.map((function(e){var n=t.currentText.list[r].list[e];n.index=e,a.push(n)})),this.__render(a,e)}}},{key:"__onTimeupdate",value:function(){if(this._isOpen){var e=this.player.video,t=e.videoWidth,r=e.videoHeight;!this._videoMeta.scale&&t&&r&&this._onResize(this.player.root);var n=this.player.currentTime;Math.round(Math.abs(1e3*n-this._ctime))<200||(this._ctime=1e3*n,this.currentText&&this.currentText.list&&this._update(n))}}},{key:"_onResize",value:function(e){var t=this._videoMeta;if(e&&e instanceof window.Element||(e=this.player.root),this._iId&&(clearTimeout(this._iId),this._iId=null),!t.scale){if(!this.player.video)return;var r=this.player.video,n=r.videoWidth,i=r.videoHeight;if(!n||!i)return;t.videoWidth=n,t.videoHeight=i,t.scale=parseInt(i/n*100,10)}this.__startResize(e)}},{key:"resize",value:function(e,t){var r=this,n=this.config,i=n.baseSizeX,o=n.baseSizeY,a=n.minMobileSize,s=n.minSize,u=n.fitVideo,c=n.offsetBottom,l=this._videoMeta.scale;this._videoMeta.lwidth=e,this._videoMeta.lheight=t;var d=void 0,f=0;t/e*100>=l?(f=parseInt(l*e,10)/100,d=e):(f=t,d=parseInt(t/l*100,10)),this._videoMeta.vWidth=d,this._videoMeta.vHeight=f;var h=0,p=0;l>120?(h=o,p=parseInt(h*f/1080,10)):(h=i,p=parseInt(h*d/1920,10));var g=jn?a:s,y={fontSize:p=p<g?g:p>h?h:p},v=parseInt((t-f)/2,10),m=parseInt((e-d)/2,10),_=parseInt(f*c,10)/100;this._videoMeta.vBottom=v,this._videoMeta.vLeft=m,this._videoMeta.marginBottom=_,u&&(y.bottom=v+_,y.left=y.right=m),Sn(y).map((function(e){r.root.style[e]=y[e]+"px"})),this.emit(Un.RESIZE,{vLeft:m,vBottom:v,marginBottom:_,vWidth:d,vHeight:f,fontSize:p,scale:l})}},{key:"__startResize",value:function(e){var t=this,r=e.getBoundingClientRect(),n=this._videoMeta,i=r.width,o=r.height;if(this._iId&&(clearTimeout(this._iId),this._iId=null),i>0&&o>0&&(i!==n.lwidth||o!==n.lheight))this._iC=0,this.resize(i,o);else{if(this._iC>=5)return void(this._iC=0);this._iC++,this._iId=setTimeout((function(){t.__startResize(e)}),50)}}},{key:"__remove",value:function(e){var t=this;if(e&&!(e.length<1)){for(var r=this.innerRoot.children,n=[],i=0;i<r.length;i++){var o=Number(r[i].getAttribute("data-index"));e.includes(o)&&n.push(r[i])}n.map((function(e){t.innerRoot.removeChild(e)}))}}},{key:"__render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length>0&&t.map((function(t){var r="text-track-"+e.config.line;t.text.map((function(n,i){i>0&&(r+=" text-track-deputy");var o={"data-start":t.start,"data-end":t.end,"data-index":t.index};e.innerRoot.appendChild(h("xg-text-track-span",n,o,r))}))}))}},{key:"show",value:function(){c(this.root,"text-track-hide")}},{key:"hide",value:function(){u(this.root,"text-track-hide"),this.innerRoot.innerHTML=""}},{key:"destroy",value:function(){this.detachPlayer(),this.removeAllListeners(),this.player=null,this.textTrack=null}},{key:"marginBottom",get:function(){var e=this._videoMeta,t=e.bottom,r=e.marginBottom;return this.config.fitVideo?t+r:r}}]),t}(Tn)}()}(index_min$2);var SubTitles=getDefaultExportFromCjs(index_min$2.exports),DEFAULT_CLOSE_TYPE="text-close";function formatList(e){var t=-1;return e.map((function(e,r){e.id||e.language||(e.id=r),!e.url&&(e.url=e.src),!e.text&&(e.text=e.label),!e.language&&(e.language=e.srclang),void 0===e.isDefault&&(e.isDefault=e.default),(e.isDefault||e.default)&&(t<0?t=r:e.isDefault=e.default=!1)})),t}var TextTrack=function(e){_inherits$1(r,e);var t=_createSuper$q(r);function r(){var e;_classCallCheck$2(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$2(_assertThisInitialized$1(e=t.call.apply(t,[this].concat(i))),"clickSwitch",(function(t,r){e.subTitles&&(r.type===DEFAULT_CLOSE_TYPE?e.switchOffSubtile():e.switchSubTitle({language:r.language,id:r.id}))})),_defineProperty$2(_assertThisInitialized$1(e),"onPlayerFocus",(function(t){e.subTitles&&e.config.style.follow&&e.rePosition()})),_defineProperty$2(_assertThisInitialized$1(e),"onPlayerBlur",(function(t){e.subTitles&&e.config.style.follow&&!e.playerConfig.marginControls&&e.subTitles.root&&(e.subTitles.root.style.transform="translate(0, 0)")})),e}return _createClass$2(r,[{key:"beforeCreate",value:function(e){var t=e.player.config.texttrack||e.player.config.textTrack;"Array"===util$2.typeOf(t)&&(e.config.list=t)}},{key:"afterCreate",value:function(){var e=this.config,t=e.list,n=e.style,i=e.isDefaultOpen;this.curIndex=-1,this.curItem=null;var o=formatList(t);_get$1(_getPrototypeOf$1(r.prototype),"afterCreate",this).call(this);var a={subTitles:t,defaultOpen:i};this.handlerClickSwitch=this.hook("subtitle_change",this.clickSwitch),Object.keys(n).map((function(e){a[e]=n[e]})),!this.playerConfig.marginControls&&this.player.controls.root&&(this.on(PLAYER_FOCUS,this.onPlayerFocus),this.on(PLAYER_BLUR,this.onPlayerBlur)),this.subTitles=new SubTitles(a),this.subTitles.attachPlayer(this.player),n.follow&&this.subTitles.root&&util$2.addClass(this.subTitles.root,"follow-control"),t&&0!==t.length&&(i&&o<0?(t[0].isDefault=!0,this.curIndex=0,this.curItem=t[0]):(this.curIndex=o,this.curItem=t[o]))}},{key:"show",value:function(){this.config.list&&0!==this.config.list.length&&_get$1(_getPrototypeOf$1(r.prototype),"show",this).call(this)}},{key:"updateSubtitles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e){var r=[];e.map((function(e){r.push(e)}));var n=formatList(r);this.curIndex=n,this.curItem=n>-1?r[n]:null;var i=n>-1;this.config.list=r,this.subTitles&&this.subTitles.setSubTitles(r,i,t),r.length>0?this.show():(this.switchOffSubtile(),this.hide()),this.renderItemList()}}},{key:"switchSubTitle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",language:""},r=-1;t&&(t.id||t.language)&&(this.config.list.map((function(e,n){e.id!==t.id&&e.language!==t.language||(r=n)})),r===this.curIndex||r<0||this.subTitles.switch(t).then((function(n){0===n.code&&(t.off=!1,t.isListUpdate=!1,t.list=[],e.curIndex=r,e.curItem=e.config.list[r-1],e.renderItemList(),e.emit("subtitle_change",t))})))}},{key:"switchOffSubtile",value:function(){this.subTitles.switchOff(),this.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]}),this.curIndex=0,this.curItem=null,this.renderItemList()}},{key:"onItemClick",value:function(e,t){_get$1(_getPrototypeOf$1(r.prototype),"onItemClick",this).apply(this,arguments);var n=e.delegateTarget,i=n.getAttribute("language"),o=n.getAttribute("data-id"),a=n.getAttribute("data-type");this.handlerClickSwitch(e,{language:i,id:o,type:a})}},{key:"changeCurrentText",value:function(){var e=this.config,t=e.list,r=e.closeText,n=this.curIndex;if(n-1<0)this.find(".icon-text").innerHTML=this.getTextByLang(r,"iconText");else if(n-1<t.length){var i=t[n-1];if(!i)return;this.find(".icon-text").innerHTML=this.getTextByLang(i,"iconText")}}},{key:"renderItemList",value:function(){var e=this,t=this.config,n=t.list,i=t.closeText,o=[];o.push({showText:this.getTextByLang(i),"data-type":DEFAULT_CLOSE_TYPE,selected:-1===this.curIndex}),n.map((function(t,r){var n={language:t.language||t.srclang,"data-id":t.id};n.selected=e.curIndex===r,n.showText=e.getTextByLang(t),o.push(n)})),_get$1(_getPrototypeOf$1(r.prototype),"renderItemList",this).call(this,o,this.curIndex+1)}},{key:"rePosition",value:function(){var e=this.config.style.fitVideo,t=0-this.player.controls.root.getBoundingClientRect().height;if(e){var r=this.player,n=r.video,i=r.root.getBoundingClientRect(),o=i.height,a=i.width,s=n.videoHeight,u=n.videoWidth,c=parseInt(s/u*100,10)*a/100;c>o&&(c=o);var l=(o-c)/2-t;l<0&&(this.subTitles.root.style.transform="translate(0, ".concat(l,"px)"))}else this.subTitles.root.style.transform="translate(0, ".concat(t,"px)")}},{key:"destroy",value:function(){this.subTitles&&(this.subTitles.destroy(),this.subTitles=null),_get$1(_getPrototypeOf$1(r.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"texttrack"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$8.CONTROLS_RIGHT,index:6,list:[],isDefaultOpen:!0,style:{follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},closeText:{text:"不开启",iconText:"字幕"},className:"xgplayer-texttrack",hidePortrait:!1,isShowIcon:!0}}}]),r}(OptionsIcon),es=Object.freeze(Object.defineProperty({__proto__:null,Events:Events$1,SimplePlayer:Player,Plugin:Plugin,BasePlugin:BasePlugin,STATE_CLASS:STATE_CLASS,I18N:I18N,Errors:Errors$2,Sniffer:sniffer,Util:util$2,default:PresetPlayer,STATES:STATES$1,DefaultPresetEn:DefaultPreset$2,DefaultPreset:DefaultPreset$3,LivePreset:DefaultPreset$1,MobilePreset:DefaultPreset,langZhHk:zhHk,langJp:jp$1,langZhCn:ZH,Danmu:Danmu,TextTrack:TextTrack,DanmuIcon:DanmuIcon,DanmuPanel:DanmuPanel},Symbol.toStringTag,{value:"Module"})),DefinitionLinked={origin:{index:1,next:"uhd",prev:null},uhd:{index:2,next:"hd",prev:"origin"},hd:{index:3,next:"sd",prev:"uhd"},sd:{index:4,next:"ld",prev:"hd"},ld:{index:5,next:"ao",prev:"sd"},ao:{index:6,next:null,prev:"ld"}},PLAYER_LANGS=["zh","en","jp","zh-hk"],PLAYER_MODE={NORMAL:0,INNER:1,FULLSCREEN:2},VIDEO_STATUS_TYPE=function(e){return e[e.VALID=10]="VALID",e[e.TRANSCODING=30]="TRANSCODING",e[e.NO_SET_AUDIT=1e3]="NO_SET_AUDIT",e[e.OFFLINE=1002]="OFFLINE",e[e.NO_AUTH=2001]="NO_AUTH",e[e.UN_AUTH=2002]="UN_AUTH",e}(VIDEO_STATUS_TYPE||{}),isHls=function(e){return e&&0<e.toLowerCase().indexOf(".m3u8")},isMp4=function(e){return e&&0<e.toLowerCase().indexOf(".mp4")},isFlv=function(e){return e&&0<e.toLowerCase().indexOf(".flv")},isRtm=function(e){return e&&0<e.toLowerCase().indexOf(".sdp")},isDash=function(e){return e&&0<e.toLowerCase().indexOf(".mpd")},getStreamType=function(e){return isHls(e)?"hls":isFlv(e)?"flv":isRtm(e)?"rtm":isMp4(e)?"mp4":isDash(e)?"dash":"mp4"},getDefinitionInfo=function(e,t){if(!e||!e.Definition)return{definition:""};if(t){var r=t[e.Definition];return r?"string"==typeof r?{definition:r}:_objectSpread2$1({},r||{}):{definition:e.Definition}}return{definition:e.Definition}},retPromise=function(e){return e&&e.then?e:new Promise((function(e){e(null)}))},formatDemotePriority=function(e){var t=(null==e?void 0:e.length)&&e.reduce((function(t,r,n){return t[r]={next:n+1>=e.length?null:e[n+1],pre:0===n?null:e[n-1]},t}),{});return console.log(t),t},matchHtmlRegExp=/["'&<>]/;function escapeHtml(e){var t,r=""+e,n=matchHtmlRegExp.exec(r);if(!n)return r;var i,o="",a=0;for(i=n.index;i<r.length;i++){switch(r.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==i&&(o+=r.substring(a,i)),a=i+1,o+=t}return a!==i?o+r.substring(a,i):o}var _excluded$1=["options","type","isLive","id","root","plugins","defaultConfig","languages","url","playList","streamType","isMobile","useSoftDecoding"],PlayerData=function(){function e(t){_classCallCheck$3(this,e),this.id="",this.type="",this.isLive=!1,this.options=null,this.isMobile=!1,this.playList=[],this.plugins=[],this.openSoftDecoding=!1,this.current={lineId:0,language:"",definition:"",streamType:""};var r=t.options,n=t.type,i=t.isLive,o=t.id,a=t.root,s=t.plugins,u=void 0===s?[]:s,c=t.defaultConfig,l=t.languages;t.url,t.playList,t.streamType;var d=t.isMobile,f=void 0!==d&&d,h=t.useSoftDecoding,p=void 0!==h&&h,g=_objectWithoutProperties$1(t,_excluded$1);this.configs=t,this.options=Object.assign({},r,g),this.options.poster=escapeHtml(this.options.poster),this.id=o,this.root=a,this.type=n,this.isLive=!!(null!=i?i:"live"===n),this.defaultConfig=c,this.languageData=this.initI18nData(l),this.isMobile=f||"mobile"===sniffer.device,this.openSoftDecoding=p,this.initPlayData(t),this.current=MyProxy$1.observe(this.current),this.playList=MyProxy$1.observe(this.playList),this.plugins=_toConsumableArray$2(u)}return _createClass$3(e,[{key:"initPlayData",value:function(e){var t=this.initPlaylistAndGetCurrent(e);this.initCurrent(t)}},{key:"initPlaylistAndGetCurrent",value:function(e){var t,r=e.url,n=e.playList,i=e.streamType,o=void 0===i?"":i,a=null;if(n&&(this.playList=_toConsumableArray$2(n)),r)if(0===this.playList.length)this.playList=[_objectSpread2$1(_objectSpread2$1({},this.current),{},{url:r,streamType:o})];else{var s=this.getUrlList({url:r});s.length>0?a=s[0]:console.log("默认url不在Playlist中")}var u=this.getCurrentByDefaultConfig();return u&&(a=u),null!==(t=a)&&void 0!==t?t:this.playList[0]}},{key:"getCurrentByDefaultConfig",value:function(){if(this.defaultConfig){var e=this.defaultConfig,t=e.type,r=e.isLive,n=e.lineId,i=void 0===n?"":n,o=e.definition,a=void 0===o?"":o;if((null!=r?r:"live"===t)===this.isLive){if(!i&&!a)return console.log("默认配置未设置默认线路或默认清晰度"),void(this.isHitDefault=!1);var s=this.getUrlList({lineId:i,definition:a});return s.length>0?(this.isHitDefault=!0,s[0]):(console.log("playlist中没有满足默认配置的流"),void(this.isHitDefault=!1))}}}},{key:"initCurrent",value:function(e){var t=this;Object.keys(this.current).forEach((function(r){t.current[r]=null==e?void 0:e[r]}))}},{key:"initI18nData",value:function(e){var t=[jp$1,zhHk],r=e&&Object.entries(e).reduce((function(e,r){var n=_slicedToArray$1(r,2),i=n[0],o=n[1];return PLAYER_LANGS.includes(i)?e.push({LANG:"zh"===i?"zh-cn":i,TEXT:o}):t.push({LANG:i,TEXT:o}),e}),[]);return{extraLangList:t,extendLangList:r}}},{key:"getCurrentUrl",value:function(){var e;return null===(e=this.getCurrentStreams()[0])||void 0===e?void 0:e.url}},{key:"getCurrentStreamType",value:function(){var e,t=(null===(e=this.getCurrentStreams())||void 0===e?void 0:e[0])||{},r=t.url;return t.streamType||getStreamType(r)}},{key:"getCurrentStreams",value:function(){var e=this.current;return this.getUrlList(e)}},{key:"getLineList",value:function(){return lodash.exports.cloneDeep(lodash.exports.uniqBy(this.playList,"lineId"))}},{key:"getLineListByLineId",value:function(e){return this.playList.filter((function(t){var r;return(null==e?void 0:e.toString())===(null===(r=t.lineId)||void 0===r?void 0:r.toString())}))}},{key:"getDefinitionListByLineId",value:function(e){var t=this.getLineListByLineId(e),r=lodash.exports.uniqBy(t,"definition");return lodash.exports.cloneDeep(r)}},{key:"getUrlList",value:function(e){return this.playList.filter((function(t){return Object.keys(e).every((function(r){var n,i,o=(null===(n=e[r])||void 0===n?void 0:n.toString())===(null===(i=t[r])||void 0===i?void 0:i.toString()),a=!e[r];return o||a}))}))}},{key:"getNextDefinition",value:function(){var e,t,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0,i=r?"next":"prev",o=this.current,a=o.definition,s=o.lineId;if(a){var u=null===(e=this.getCurrentStreams())||void 0===e?void 0:e[0],c="auto"===a?u.mapDefinition:a,l=formatDemotePriority(n)||DefinitionLinked,d=Object.keys(l);if(d.includes(c)){for(var f=null===(t=l[c])||void 0===t?void 0:t[i],h=this.getDefinitionListByLineId(s);0===h.filter((function(e){return e.definition===f})).length&&f;){var p;f=null===(p=l[f])||void 0===p?void 0:p[i]}if(f)return"auto"===a&&f&&(u.mapDefinition=f),this.getUrlList({lineId:s,definition:f});console.log("已经降至最低级")}}}}]),e}(),global$W=global$1T,uncurryThis$T=functionUncurryThis$1,aCallable$a=aCallable$h,isObject$u=isObject$K,hasOwn$n=hasOwnProperty_1$1,arraySlice$d=arraySlice$j,NATIVE_BIND$4=functionBindNative$1,Function$4=global$W.Function,concat$3=uncurryThis$T([].concat),join$1=uncurryThis$T([].join),factories={},construct$1=function(e,t,r){if(!hasOwn$n(factories,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";factories[t]=Function$4("C,a","return new C("+join$1(n,",")+")")}return factories[t](e,r)},functionBind=NATIVE_BIND$4?Function$4.bind:function(e){var t=aCallable$a(this),r=t.prototype,n=arraySlice$d(arguments,1),i=function(){var r=concat$3(n,arraySlice$d(arguments));return this instanceof i?construct$1(t,r.length,r):t.apply(e,r)};return isObject$u(r)&&(i.prototype=r),i},$$18=_export$1,getBuiltIn$e=getBuiltIn$p,apply$b=functionApply$1,bind$a=functionBind,aConstructor$3=aConstructor$5,anObject$l=anObject$E,isObject$t=isObject$K,create$4=objectCreate$1,fails$S=fails$1m,nativeConstruct=getBuiltIn$e("Reflect","construct"),ObjectPrototype$4=Object.prototype,push$7=[].push,NEW_TARGET_BUG=fails$S((function(){function e(){}return!(nativeConstruct((function(){}),[],e)instanceof e)})),ARGS_BUG=!fails$S((function(){nativeConstruct((function(){}))})),FORCED$e=NEW_TARGET_BUG||ARGS_BUG;$$18({target:"Reflect",stat:!0,forced:FORCED$e,sham:FORCED$e},{construct:function(e,t){aConstructor$3(e),anObject$l(t);var r=arguments.length<3?e:aConstructor$3(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return apply$b(push$7,n,t),new(apply$b(bind$a,e,n))}var i=r.prototype,o=create$4(isObject$t(i)?i:ObjectPrototype$4),a=apply$b(e,o,t);return isObject$t(a)?a:o}});var objectGetOwnPropertyNamesExternal$1={},classof$e=classofRaw$3,toIndexedObject$g=toIndexedObject$o,$getOwnPropertyNames$3=objectGetOwnPropertyNames$1.f,arraySlice$c=arraySliceSimple$1,windowNames$1="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames$1=function(e){try{return $getOwnPropertyNames$3(e)}catch(error){return arraySlice$c(windowNames$1)}};objectGetOwnPropertyNamesExternal$1.f=function(e){return windowNames$1&&"Window"==classof$e(e)?getWindowNames$1(e):$getOwnPropertyNames$3(toIndexedObject$g(e))};var wellKnownSymbolWrapped$1={},wellKnownSymbol$p=wellKnownSymbol$O;wellKnownSymbolWrapped$1.f=wellKnownSymbol$p;var global$V=global$1T,path$3=global$V,path$2=path$3,hasOwn$m=hasOwnProperty_1$1,wrappedWellKnownSymbolModule$3=wellKnownSymbolWrapped$1,defineProperty$f=objectDefineProperty$1.f,defineWellKnownSymbol$4=function(e){var t=path$2.Symbol||(path$2.Symbol={});hasOwn$m(t,e)||defineProperty$f(t,e,{value:wrappedWellKnownSymbolModule$3.f(e)})},$$17=_export$1,global$U=global$1T,getBuiltIn$d=getBuiltIn$p,apply$a=functionApply$1,call$r=functionCall$1,uncurryThis$S=functionUncurryThis$1,DESCRIPTORS$t=descriptors$1,NATIVE_SYMBOL$8=nativeSymbol$1,fails$R=fails$1m,hasOwn$l=hasOwnProperty_1$1,isArray$5=isArray$9,isCallable$t=isCallable$Q,isObject$s=isObject$K,isPrototypeOf$b=objectIsPrototypeOf$1,isSymbol$9=isSymbol$d,anObject$k=anObject$E,toObject$d=toObject$o,toIndexedObject$f=toIndexedObject$o,toPropertyKey$6=toPropertyKey$a,$toString$2=toString$A,createPropertyDescriptor$6=createPropertyDescriptor$d,nativeObjectCreate$1=objectCreate$1,objectKeys$4=objectKeys$7,getOwnPropertyNamesModule$3=objectGetOwnPropertyNames$1,getOwnPropertyNamesExternal$1=objectGetOwnPropertyNamesExternal$1,getOwnPropertySymbolsModule$3=objectGetOwnPropertySymbols$1,getOwnPropertyDescriptorModule$5=objectGetOwnPropertyDescriptor$1,definePropertyModule$8=objectDefineProperty$1,definePropertiesModule$2=objectDefineProperties$1,propertyIsEnumerableModule$2=objectPropertyIsEnumerable$1,arraySlice$b=arraySlice$j,redefine$4=redefine$h.exports,shared$8=shared$d.exports,sharedKey$4=sharedKey$8,hiddenKeys$7=hiddenKeys$c,uid$6=uid$9,wellKnownSymbol$o=wellKnownSymbol$O,wrappedWellKnownSymbolModule$2=wellKnownSymbolWrapped$1,defineWellKnownSymbol$3=defineWellKnownSymbol$4,setToStringTag$5=setToStringTag$b,InternalStateModule$6=internalState$1,$forEach$3=arrayIteration$1.forEach,HIDDEN$1=sharedKey$4("hidden"),SYMBOL$1="Symbol",PROTOTYPE$3="prototype",TO_PRIMITIVE$1=wellKnownSymbol$o("toPrimitive"),setInternalState$5=InternalStateModule$6.set,getInternalState$5=InternalStateModule$6.getterFor(SYMBOL$1),ObjectPrototype$3=Object[PROTOTYPE$3],$Symbol$1=global$U.Symbol,SymbolPrototype$3=$Symbol$1&&$Symbol$1[PROTOTYPE$3],TypeError$8=global$U.TypeError,QObject$1=global$U.QObject,$stringify$1=getBuiltIn$d("JSON","stringify"),nativeGetOwnPropertyDescriptor$4=getOwnPropertyDescriptorModule$5.f,nativeDefineProperty$2=definePropertyModule$8.f,nativeGetOwnPropertyNames$1=getOwnPropertyNamesExternal$1.f,nativePropertyIsEnumerable$1=propertyIsEnumerableModule$2.f,push$6=uncurryThis$S([].push),AllSymbols$1=shared$8("symbols"),ObjectPrototypeSymbols$1=shared$8("op-symbols"),StringToSymbolRegistry$1=shared$8("string-to-symbol-registry"),SymbolToStringRegistry$2=shared$8("symbol-to-string-registry"),WellKnownSymbolsStore$2=shared$8("wks"),USE_SETTER$1=!QObject$1||!QObject$1[PROTOTYPE$3]||!QObject$1[PROTOTYPE$3].findChild,setSymbolDescriptor$1=DESCRIPTORS$t&&fails$R((function(){return 7!=nativeObjectCreate$1(nativeDefineProperty$2({},"a",{get:function(){return nativeDefineProperty$2(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=nativeGetOwnPropertyDescriptor$4(ObjectPrototype$3,t);n&&delete ObjectPrototype$3[t],nativeDefineProperty$2(e,t,r),n&&e!==ObjectPrototype$3&&nativeDefineProperty$2(ObjectPrototype$3,t,n)}:nativeDefineProperty$2,wrap$3=function(e,t){var r=AllSymbols$1[e]=nativeObjectCreate$1(SymbolPrototype$3);return setInternalState$5(r,{type:SYMBOL$1,tag:e,description:t}),DESCRIPTORS$t||(r.description=t),r},$defineProperty$2=function(e,t,r){e===ObjectPrototype$3&&$defineProperty$2(ObjectPrototypeSymbols$1,t,r),anObject$k(e);var n=toPropertyKey$6(t);return anObject$k(r),hasOwn$l(AllSymbols$1,n)?(r.enumerable?(hasOwn$l(e,HIDDEN$1)&&e[HIDDEN$1][n]&&(e[HIDDEN$1][n]=!1),r=nativeObjectCreate$1(r,{enumerable:createPropertyDescriptor$6(0,!1)})):(hasOwn$l(e,HIDDEN$1)||nativeDefineProperty$2(e,HIDDEN$1,createPropertyDescriptor$6(1,{})),e[HIDDEN$1][n]=!0),setSymbolDescriptor$1(e,n,r)):nativeDefineProperty$2(e,n,r)},$defineProperties$1=function(e,t){anObject$k(e);var r=toIndexedObject$f(t),n=objectKeys$4(r).concat($getOwnPropertySymbols$1(r));return $forEach$3(n,(function(t){DESCRIPTORS$t&&!call$r($propertyIsEnumerable$3,r,t)||$defineProperty$2(e,t,r[t])})),e},$create$1=function(e,t){return void 0===t?nativeObjectCreate$1(e):$defineProperties$1(nativeObjectCreate$1(e),t)},$propertyIsEnumerable$3=function(e){var t=toPropertyKey$6(e),r=call$r(nativePropertyIsEnumerable$1,this,t);return!(this===ObjectPrototype$3&&hasOwn$l(AllSymbols$1,t)&&!hasOwn$l(ObjectPrototypeSymbols$1,t))&&(!(r||!hasOwn$l(this,t)||!hasOwn$l(AllSymbols$1,t)||hasOwn$l(this,HIDDEN$1)&&this[HIDDEN$1][t])||r)},$getOwnPropertyDescriptor$3=function(e,t){var r=toIndexedObject$f(e),n=toPropertyKey$6(t);if(r!==ObjectPrototype$3||!hasOwn$l(AllSymbols$1,n)||hasOwn$l(ObjectPrototypeSymbols$1,n)){var i=nativeGetOwnPropertyDescriptor$4(r,n);return!i||!hasOwn$l(AllSymbols$1,n)||hasOwn$l(r,HIDDEN$1)&&r[HIDDEN$1][n]||(i.enumerable=!0),i}},$getOwnPropertyNames$2=function(e){var t=nativeGetOwnPropertyNames$1(toIndexedObject$f(e)),r=[];return $forEach$3(t,(function(e){hasOwn$l(AllSymbols$1,e)||hasOwn$l(hiddenKeys$7,e)||push$6(r,e)})),r},$getOwnPropertySymbols$1=function(e){var t=e===ObjectPrototype$3,r=nativeGetOwnPropertyNames$1(t?ObjectPrototypeSymbols$1:toIndexedObject$f(e)),n=[];return $forEach$3(r,(function(e){!hasOwn$l(AllSymbols$1,e)||t&&!hasOwn$l(ObjectPrototype$3,e)||push$6(n,AllSymbols$1[e])})),n};if(NATIVE_SYMBOL$8||($Symbol$1=function(){if(isPrototypeOf$b(SymbolPrototype$3,this))throw TypeError$8("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?$toString$2(arguments[0]):void 0,t=uid$6(e),r=function e(r){this===ObjectPrototype$3&&call$r(e,ObjectPrototypeSymbols$1,r),hasOwn$l(this,HIDDEN$1)&&hasOwn$l(this[HIDDEN$1],t)&&(this[HIDDEN$1][t]=!1),setSymbolDescriptor$1(this,t,createPropertyDescriptor$6(1,r))};return DESCRIPTORS$t&&USE_SETTER$1&&setSymbolDescriptor$1(ObjectPrototype$3,t,{configurable:!0,set:r}),wrap$3(t,e)},SymbolPrototype$3=$Symbol$1[PROTOTYPE$3],redefine$4(SymbolPrototype$3,"toString",(function(){return getInternalState$5(this).tag})),redefine$4($Symbol$1,"withoutSetter",(function(e){return wrap$3(uid$6(e),e)})),propertyIsEnumerableModule$2.f=$propertyIsEnumerable$3,definePropertyModule$8.f=$defineProperty$2,definePropertiesModule$2.f=$defineProperties$1,getOwnPropertyDescriptorModule$5.f=$getOwnPropertyDescriptor$3,getOwnPropertyNamesModule$3.f=getOwnPropertyNamesExternal$1.f=$getOwnPropertyNames$2,getOwnPropertySymbolsModule$3.f=$getOwnPropertySymbols$1,wrappedWellKnownSymbolModule$2.f=function(e){return wrap$3(wellKnownSymbol$o(e),e)},DESCRIPTORS$t&&(nativeDefineProperty$2(SymbolPrototype$3,"description",{configurable:!0,get:function(){return getInternalState$5(this).description}}),redefine$4(ObjectPrototype$3,"propertyIsEnumerable",$propertyIsEnumerable$3,{unsafe:!0}))),$$17({global:!0,wrap:!0,forced:!NATIVE_SYMBOL$8,sham:!NATIVE_SYMBOL$8},{Symbol:$Symbol$1}),$forEach$3(objectKeys$4(WellKnownSymbolsStore$2),(function(e){defineWellKnownSymbol$3(e)})),$$17({target:SYMBOL$1,stat:!0,forced:!NATIVE_SYMBOL$8},{for:function(e){var t=$toString$2(e);if(hasOwn$l(StringToSymbolRegistry$1,t))return StringToSymbolRegistry$1[t];var r=$Symbol$1(t);return StringToSymbolRegistry$1[t]=r,SymbolToStringRegistry$2[r]=t,r},keyFor:function(e){if(!isSymbol$9(e))throw TypeError$8(e+" is not a symbol");if(hasOwn$l(SymbolToStringRegistry$2,e))return SymbolToStringRegistry$2[e]},useSetter:function(){USE_SETTER$1=!0},useSimple:function(){USE_SETTER$1=!1}}),$$17({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$8,sham:!DESCRIPTORS$t},{create:$create$1,defineProperty:$defineProperty$2,defineProperties:$defineProperties$1,getOwnPropertyDescriptor:$getOwnPropertyDescriptor$3}),$$17({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$8},{getOwnPropertyNames:$getOwnPropertyNames$2,getOwnPropertySymbols:$getOwnPropertySymbols$1}),$$17({target:"Object",stat:!0,forced:fails$R((function(){getOwnPropertySymbolsModule$3.f(1)}))},{getOwnPropertySymbols:function(e){return getOwnPropertySymbolsModule$3.f(toObject$d(e))}}),$stringify$1){var FORCED_JSON_STRINGIFY=!NATIVE_SYMBOL$8||fails$R((function(){var e=$Symbol$1();return"[null]"!=$stringify$1([e])||"{}"!=$stringify$1({a:e})||"{}"!=$stringify$1(Object(e))}));$$17({target:"JSON",stat:!0,forced:FORCED_JSON_STRINGIFY},{stringify:function(e,t,r){var n=arraySlice$b(arguments),i=t;if((isObject$s(t)||void 0!==e)&&!isSymbol$9(e))return isArray$5(t)||(t=function(e,t){if(isCallable$t(i)&&(t=call$r(i,this,e,t)),!isSymbol$9(t))return t}),n[1]=t,apply$a($stringify$1,null,n)}})}if(!SymbolPrototype$3[TO_PRIMITIVE$1]){var valueOf=SymbolPrototype$3.valueOf;redefine$4(SymbolPrototype$3,TO_PRIMITIVE$1,(function(e){return call$r(valueOf,this)}))}setToStringTag$5($Symbol$1,SYMBOL$1),hiddenKeys$7[HIDDEN$1]=!0;var $$16=_export$1,fails$Q=fails$1m,toIndexedObject$e=toIndexedObject$o,nativeGetOwnPropertyDescriptor$3=objectGetOwnPropertyDescriptor$1.f,DESCRIPTORS$s=descriptors$1,FAILS_ON_PRIMITIVES$5=fails$Q((function(){nativeGetOwnPropertyDescriptor$3(1)})),FORCED$d=!DESCRIPTORS$s||FAILS_ON_PRIMITIVES$5;$$16({target:"Object",stat:!0,forced:FORCED$d,sham:!DESCRIPTORS$s},{getOwnPropertyDescriptor:function(e,t){return nativeGetOwnPropertyDescriptor$3(toIndexedObject$e(e),t)}});var $$15=_export$1,DESCRIPTORS$r=descriptors$1,ownKeys$l=ownKeys$n,toIndexedObject$d=toIndexedObject$o,getOwnPropertyDescriptorModule$4=objectGetOwnPropertyDescriptor$1,createProperty$5=createProperty$b;function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1(e,t,r){return t&&_defineProperties$1(e.prototype,t),r&&_defineProperties$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof$1(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty$1(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(error){return void r(error)}s.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){asyncGeneratorStep(o,n,i,a,s,"next",e)}function s(e){asyncGeneratorStep(o,n,i,a,s,"throw",e)}a(void 0)}))}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _isNativeReflectConstruct$q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct$q()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i}).apply(null,arguments)}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)},_wrapNativeSuper(e)}$$15({target:"Object",stat:!0,sham:!DESCRIPTORS$r},{getOwnPropertyDescriptors:function(e){for(var t,r,n=toIndexedObject$d(e),i=getOwnPropertyDescriptorModule$4.f,o=ownKeys$l(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&createProperty$5(a,t,r);return a}});var runtime={exports:{}};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(P){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new I(n||[]);return o._invoke=function(e,t,r){var n=d;return function(i,o){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=$(a,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var u=l(e,t,r);if("normal"===u.type){if(n=r.done?p:f,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",g={};function y(){}function v(){}function m(){}var _={};u(_,o,(function(){return this}));var b=Object.getPrototypeOf,A=b&&b(b(k([])));A&&A!==r&&n.call(A,o)&&(_=A);var E=m.prototype=y.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(i,o,a,s){var u=l(e[i],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"===_typeof$3(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function $(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,$(e,r),"throw"===r.method))return g;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=l(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function k(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:O}}function O(){return{value:t,done:!0}}return v.prototype=m,u(E,"constructor",m),u(m,"constructor",v),v.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},S(T.prototype),u(T.prototype,a,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new T(c(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,o,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(r){"object"===("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(runtime);var regenerator=runtime.exports;function createPublicPromise(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.used=!1,r.resolve=function(){return r.used=!0,e.apply(void 0,arguments)},r.reject=function(){return r.used=!0,t.apply(void 0,arguments)},r}var Buffer=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"start",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&e.start(0)<0?0:e.start(0):0}},{key:"end",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1):0}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(error){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var o=r.length;if(o&&t){var a=r[o-1],s=a[1];if(e.start(n)-s<=t){var u=e.end(n);u>s&&(a[1]=u)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"length",value:function(e){return e&&e.length?e.reduce((function(e,t){return e+(t[1]-t[0])}),0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,o=0,a=0,s=0,u=0,c=0,l=0,d=e.buffers(t,n),f=0,h=d.length;f<h;f++){var p=d[f];if(r+n>=p[0]&&r<p[1])i=p[0],o=p[1],a=f;else{if(r+n<p[0]){s=p[0],u=p[1];break}r+n>p[1]&&(c=p[0],l=p[1])}}return{start:i,end:o,index:a,buffers:d,nextStart:s,nextEnd:u,prevStart:c,prevEnd:l,currentTime:r,behind:r-i,remaining:o?o-r:0,length:e.length&&e.length(d)}}}]),e}(),_ERR_CODE;function _createSuper$p(e){var t=_isNativeReflectConstruct$p();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var ERR={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",OPTION:"OPTION"}},ERR_CODE=(_ERR_CODE={},_defineProperty$1(_ERR_CODE,ERR.MANIFEST,{HLS:1100}),_defineProperty$1(_ERR_CODE,ERR.NETWORK,2100),_defineProperty$1(_ERR_CODE,ERR.NETWORK_TIMEOUT,2101),_defineProperty$1(_ERR_CODE,ERR.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400}),_defineProperty$1(_ERR_CODE,ERR.REMUX,{FMP4:4100,MP4:4200}),_defineProperty$1(_ERR_CODE,ERR.MEDIA,{MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202}),_defineProperty$1(_ERR_CODE,ERR.OTHER,8e3),_ERR_CODE),StreamingError=function(e){_inherits(r,e);var t=_createSuper$p(r);function r(e,n,i,o,a){var s;return _classCallCheck$1(this,r),(s=t.call(this,a||(null==i?void 0:i.message))).errorType=e===ERR.NETWORK_TIMEOUT?ERR.NETWORK:e,s.originError=i,s.ext=o,s.errorCode=ERR_CODE[e][n]||ERR_CODE[e],s.errorMessage=s.message,s.errorCode||(s.errorType=ERR.OTHER,s.errorCode=ERR_CODE[s.errorType]),s}return _createClass$1(r,null,[{key:"create",value:function(e,t,n,i,o){return e instanceof r?e:(e instanceof Error&&(n=e,e=""),e||(e=ERR.OTHER),new r(e,t,n,i,o))}},{key:"network",value:function(e){var t;return new r(null!=e&&e.isTimeout?ERR.NETWORK_TIMEOUT:ERR.NETWORK,e,null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e||null===(t=e.response)||void 0===t?void 0:t.status})}}]),r}(_wrapNativeSuper(Error)),isBrowser$1="undefined"!=typeof window,MediaSource$1=isBrowser$1?window.MediaSource||window.WebKitMediaSource:null,MSE$2=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"media",null),_defineProperty$1(this,"mediaSource",null),_defineProperty$1(this,"_openPromise",createPublicPromise()),_defineProperty$1(this,"_queue",Object.create(null)),_defineProperty$1(this,"_sourceBuffer",Object.create(null)),_defineProperty$1(this,"_onSBUpdateEnd",(function(e){var t=r._queue[e];if(t){var n=t.shift();n&&(n.promise.resolve(),r._startQueue(e))}})),_defineProperty$1(this,"_onSBUpdateError",(function(e,t){var n=r._queue[e];if(n){var i=n[0];i&&i.promise.reject(new StreamingError(ERR.MEDIA,ERR.SUB_TYPES.MSE_APPEND_BUFFER,t))}})),t&&this.bindMedia(t)}var t,r,n;return _createClass$1(e,[{key:"isOpened",get:function(){var e;return"open"===(null===(e=this.mediaSource)||void 0===e?void 0:e.readyState)}},{key:"duration",get:function(){var e;return(null===(e=this.mediaSource)||void 0===e?void 0:e.duration)||-1}},{key:"updateDuration",value:function(e){var t=this;return this._enqueueBlockingOp((function(){t.mediaSource&&(t.mediaSource.duration=e)}))}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource;t.addEventListener("sourceopen",(function r(){t.removeEventListener("sourceopen",r),e._openPromise.resolve()})),this._openPromise=createPublicPromise()}return this._openPromise}},{key:"bindMedia",value:(n=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mediaSource&&!this.media){e.next=3;break}return e.next=3,this.unbindMedia();case 3:if(t&&MediaSource$1){e.next=5;break}throw new Error("Param media or MediaSource does not exist");case 5:return this.media=t,r=this.mediaSource=new MediaSource$1,t.src=URL.createObjectURL(r),n=function e(){r.removeEventListener("sourceopen",e),URL.revokeObjectURL(t.src),i._openPromise.resolve()},r.addEventListener("sourceopen",n),e.abrupt("return",this._openPromise);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unbindMedia",value:(r=_asyncToGenerator(regenerator.mark((function e(){var t,r=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),t=this.mediaSource){if(Object.keys(this._queue).forEach((function(e){var t=r._queue[e];t&&t.forEach((function(e){return e.promise.resolve}))})),"open"===t.readyState)try{t.endOfStream()}catch(error){}Object.keys(this._sourceBuffer).forEach((function(e){try{t.removeSourceBuffer(r._sourceBuffer[e])}catch(error){}}))}if(this.media){this.media.removeAttribute("src");try{this.media.load()}catch(error){}this.media=null}this.mediaSource=null,this._openPromise=createPublicPromise(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"createSource",value:function(e,t){if(!this._sourceBuffer[e]&&this.mediaSource){var r;try{r=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(error){throw new StreamingError(ERR.MEDIA,ERR.SUB_TYPES.MSE_ADD_SB,error)}r.mimeType=t,r.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),r.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var r=this._sourceBuffer[e];return this.mediaSource&&r&&r.mimeType!==t&&"function"==typeof r.changeType?this._enqueueOp((function(){r.changeType(t)})):Promise.resolve()}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t){var r=this;return t&&t.byteLength&&this._sourceBuffer[e]?this._enqueueOp(e,(function(){r.mediaSource&&r._sourceBuffer[e].appendBuffer(t)})):Promise.resolve()}},{key:"remove",value:function(e,t,r){var n=this;if(1!==Object.keys(this._sourceBuffer).length)return this._enqueueOp(e,(function(){if(n.mediaSource){var i=n._sourceBuffer[e];t>=r||!i?n._onSBUpdateEnd(e):i.remove(t,r)}}))}},{key:"clearBuffer",value:function(e,t){var r,n=this;return Object.keys(this._sourceBuffer).forEach((function(i){r=n._enqueueOp(i,(function(){n.mediaSource&&n._sourceBuffer[i].remove(e,t)}))})),r}},{key:"clearAllBuffer",value:function(){var e,t=this;return Object.keys(this._sourceBuffer).forEach((function(r){e=t._enqueueOp(r,(function(){if(t.mediaSource){var e=t._sourceBuffer[r];e.remove(0,Buffer.end(Buffer.get(e)))}}))})),e}},{key:"endOfStream",value:function(e){var t=this;return this.mediaSource&&"open"===this.mediaSource.readyState?this._enqueueBlockingOp((function(){var r=t.mediaSource;r&&"open"===r.readyState&&(e?r.endOfStream(e):r.endOfStream())})):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(e,t){var r=this.mediaSource;e<0||t<e||null==r||!r.setLiveSeekableRange||"open"!==r.readyState||r.setLiveSeekableRange(e,t)}},{key:"buffered",value:function(e){return Buffer.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return Buffer.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return Buffer.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t){if(!this.mediaSource)return Promise.resolve();var r=this._queue[e]=this._queue[e]||[],n={exec:t,promise:createPublicPromise()};return r.push(n),1===r.length&&this._startQueue(e),n.promise}},{key:"_enqueueBlockingOp",value:(t=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaSource){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if((r=Object.keys(this._sourceBuffer)).length){e.next=5;break}return e.abrupt("return",t());case 5:return n=[],r.forEach((function(e){var t=i._queue[e],r=createPublicPromise();n.push(r),t.push({exec:function(){return r.resolve()},promise:r}),1===t.length&&i._startQueue(e)})),e.abrupt("return",Promise.all(n).then((function(){try{return t()}finally{r.forEach((function(e){var t=i._queue[e],r=i._sourceBuffer[e];null==t||t.shift(),r&&r.updating||i._startQueue(e)}))}})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var r=t[0];if(r)try{r.exec()}catch(error){r.promise.reject(new StreamingError(ERR.MEDIA,ERR.SUB_TYPES.MSE_OTHER,error)),t.shift(),this._startQueue(e)}}}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(!MediaSource$1)return!1;try{return MediaSource$1.isTypeSupported(e)}catch(error){return!1}}}]),e}();_defineProperty$1(MSE$2,"VIDEO","video"),_defineProperty$1(MSE$2,"AUDIO","audio");var $$14=_export$1,NativePromise=nativePromiseConstructor,fails$P=fails$1m,getBuiltIn$c=getBuiltIn$p,isCallable$s=isCallable$Q,speciesConstructor$5=speciesConstructor$8,promiseResolve$2=promiseResolve$4,redefine$3=redefine$h.exports,NON_GENERIC=!!NativePromise&&fails$P((function(){NativePromise.prototype.finally.call({then:function(){}},(function(){}))}));if($$14({target:"Promise",proto:!0,real:!0,forced:NON_GENERIC},{finally:function(e){var t=speciesConstructor$5(this,getBuiltIn$c("Promise")),r=isCallable$s(e);return this.then(r?function(r){return promiseResolve$2(t,e()).then((function(){return r}))}:e,r?function(r){return promiseResolve$2(t,e()).then((function(){throw r}))}:e)}}),isCallable$s(NativePromise)){var method$1=getBuiltIn$c("Promise").prototype.finally;NativePromise.prototype.finally!==method$1&&redefine$3(NativePromise.prototype,"finally",method$1,{unsafe:!0})}var typedArrayConstructor={exports:{}},arrayBufferNative="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,NATIVE_ARRAY_BUFFER$2=arrayBufferNative,DESCRIPTORS$q=descriptors$1,global$T=global$1T,isCallable$r=isCallable$Q,isObject$r=isObject$K,hasOwn$k=hasOwnProperty_1$1,classof$d=classof$q,tryToString$7=tryToString$c,createNonEnumerableProperty$8=createNonEnumerableProperty$j,redefine$2=redefine$h.exports,defineProperty$e=objectDefineProperty$1.f,isPrototypeOf$a=objectIsPrototypeOf$1,getPrototypeOf$1=objectGetPrototypeOf,setPrototypeOf$4=objectSetPrototypeOf$1,wellKnownSymbol$n=wellKnownSymbol$O,uid$5=uid$9,Int8Array$4=global$T.Int8Array,Int8ArrayPrototype$1=Int8Array$4&&Int8Array$4.prototype,Uint8ClampedArray$1=global$T.Uint8ClampedArray,Uint8ClampedArrayPrototype=Uint8ClampedArray$1&&Uint8ClampedArray$1.prototype,TypedArray$1=Int8Array$4&&getPrototypeOf$1(Int8Array$4),TypedArrayPrototype$2=Int8ArrayPrototype$1&&getPrototypeOf$1(Int8ArrayPrototype$1),ObjectPrototype$2=Object.prototype,TypeError$7=global$T.TypeError,TO_STRING_TAG$3=wellKnownSymbol$n("toStringTag"),TYPED_ARRAY_TAG$1=uid$5("TYPED_ARRAY_TAG"),TYPED_ARRAY_CONSTRUCTOR$2=uid$5("TYPED_ARRAY_CONSTRUCTOR"),NATIVE_ARRAY_BUFFER_VIEWS$2=NATIVE_ARRAY_BUFFER$2&&!!setPrototypeOf$4&&"Opera"!==classof$d(global$T.opera),TYPED_ARRAY_TAG_REQUIRED=!1,NAME$1,Constructor,Prototype,TypedArrayConstructorsList={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},BigIntArrayConstructorsList={BigInt64Array:8,BigUint64Array:8},isView=function(e){if(!isObject$r(e))return!1;var t=classof$d(e);return"DataView"===t||hasOwn$k(TypedArrayConstructorsList,t)||hasOwn$k(BigIntArrayConstructorsList,t)},isTypedArray$1=function(e){if(!isObject$r(e))return!1;var t=classof$d(e);return hasOwn$k(TypedArrayConstructorsList,t)||hasOwn$k(BigIntArrayConstructorsList,t)},aTypedArray$m=function(e){if(isTypedArray$1(e))return e;throw TypeError$7("Target is not a typed array")},aTypedArrayConstructor$4=function(e){if(isCallable$r(e)&&(!setPrototypeOf$4||isPrototypeOf$a(TypedArray$1,e)))return e;throw TypeError$7(tryToString$7(e)+" is not a typed array constructor")},exportTypedArrayMethod$n=function(e,t,r,n){if(DESCRIPTORS$q){if(r)for(var i in TypedArrayConstructorsList){var o=global$T[i];if(o&&hasOwn$k(o.prototype,e))try{delete o.prototype[e]}catch(error){try{o.prototype[e]=t}catch(a){}}}TypedArrayPrototype$2[e]&&!r||redefine$2(TypedArrayPrototype$2,e,r?t:NATIVE_ARRAY_BUFFER_VIEWS$2&&Int8ArrayPrototype$1[e]||t,n)}},exportTypedArrayStaticMethod$1=function(e,t,r){var n,i;if(DESCRIPTORS$q){if(setPrototypeOf$4){if(r)for(n in TypedArrayConstructorsList)if((i=global$T[n])&&hasOwn$k(i,e))try{delete i[e]}catch(error){}if(TypedArray$1[e]&&!r)return;try{return redefine$2(TypedArray$1,e,r?t:NATIVE_ARRAY_BUFFER_VIEWS$2&&TypedArray$1[e]||t)}catch(error){}}for(n in TypedArrayConstructorsList)!(i=global$T[n])||i[e]&&!r||redefine$2(i,e,t)}};for(NAME$1 in TypedArrayConstructorsList)Constructor=global$T[NAME$1],Prototype=Constructor&&Constructor.prototype,Prototype?createNonEnumerableProperty$8(Prototype,TYPED_ARRAY_CONSTRUCTOR$2,Constructor):NATIVE_ARRAY_BUFFER_VIEWS$2=!1;for(NAME$1 in BigIntArrayConstructorsList)Constructor=global$T[NAME$1],Prototype=Constructor&&Constructor.prototype,Prototype&&createNonEnumerableProperty$8(Prototype,TYPED_ARRAY_CONSTRUCTOR$2,Constructor);if((!NATIVE_ARRAY_BUFFER_VIEWS$2||!isCallable$r(TypedArray$1)||TypedArray$1===Function.prototype)&&(TypedArray$1=function(){throw TypeError$7("Incorrect invocation")},NATIVE_ARRAY_BUFFER_VIEWS$2))for(NAME$1 in TypedArrayConstructorsList)global$T[NAME$1]&&setPrototypeOf$4(global$T[NAME$1],TypedArray$1);if((!NATIVE_ARRAY_BUFFER_VIEWS$2||!TypedArrayPrototype$2||TypedArrayPrototype$2===ObjectPrototype$2)&&(TypedArrayPrototype$2=TypedArray$1.prototype,NATIVE_ARRAY_BUFFER_VIEWS$2))for(NAME$1 in TypedArrayConstructorsList)global$T[NAME$1]&&setPrototypeOf$4(global$T[NAME$1].prototype,TypedArrayPrototype$2);if(NATIVE_ARRAY_BUFFER_VIEWS$2&&getPrototypeOf$1(Uint8ClampedArrayPrototype)!==TypedArrayPrototype$2&&setPrototypeOf$4(Uint8ClampedArrayPrototype,TypedArrayPrototype$2),DESCRIPTORS$q&&!hasOwn$k(TypedArrayPrototype$2,TO_STRING_TAG$3))for(NAME$1 in TYPED_ARRAY_TAG_REQUIRED=!0,defineProperty$e(TypedArrayPrototype$2,TO_STRING_TAG$3,{get:function(){return isObject$r(this)?this[TYPED_ARRAY_TAG$1]:void 0}}),TypedArrayConstructorsList)global$T[NAME$1]&&createNonEnumerableProperty$8(global$T[NAME$1],TYPED_ARRAY_TAG$1,NAME$1);var arrayBufferViewCore={NATIVE_ARRAY_BUFFER_VIEWS:NATIVE_ARRAY_BUFFER_VIEWS$2,TYPED_ARRAY_CONSTRUCTOR:TYPED_ARRAY_CONSTRUCTOR$2,TYPED_ARRAY_TAG:TYPED_ARRAY_TAG_REQUIRED&&TYPED_ARRAY_TAG$1,aTypedArray:aTypedArray$m,aTypedArrayConstructor:aTypedArrayConstructor$4,exportTypedArrayMethod:exportTypedArrayMethod$n,exportTypedArrayStaticMethod:exportTypedArrayStaticMethod$1,isView:isView,isTypedArray:isTypedArray$1,TypedArray:TypedArray$1,TypedArrayPrototype:TypedArrayPrototype$2},global$S=global$1T,fails$O=fails$1m,checkCorrectnessOfIteration$4=checkCorrectnessOfIteration$6,NATIVE_ARRAY_BUFFER_VIEWS$1=arrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS,ArrayBuffer$4=global$S.ArrayBuffer,Int8Array$3=global$S.Int8Array,typedArrayConstructorsRequireWrappers=!NATIVE_ARRAY_BUFFER_VIEWS$1||!fails$O((function(){Int8Array$3(1)}))||!fails$O((function(){new Int8Array$3(-1)}))||!checkCorrectnessOfIteration$4((function(e){new Int8Array$3,new Int8Array$3(null),new Int8Array$3(1.5),new Int8Array$3(e)}),!0)||fails$O((function(){return 1!==new Int8Array$3(new ArrayBuffer$4(2),1,void 0).length})),global$R=global$1T,toIntegerOrInfinity$b=toIntegerOrInfinity$j,toLength$b=toLength$g,RangeError$6=global$R.RangeError,toIndex$2=function(e){if(void 0===e)return 0;var t=toIntegerOrInfinity$b(e),r=toLength$b(t);if(t!==r)throw RangeError$6("Wrong length or index");return r},global$Q=global$1T,Array$3=global$Q.Array,abs$1=Math.abs,pow$2=Math.pow,floor$7=Math.floor,log$3=Math.log,LN2=Math.LN2,pack=function(e,t,r){var n,i,o,a=Array$3(r),s=8*r-t-1,u=(1<<s)-1,c=u>>1,l=23===t?pow$2(2,-24)-pow$2(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=abs$1(e))!=e||e===1/0?(i=e!=e?1:0,n=u):(n=floor$7(log$3(e)/LN2),e*(o=pow$2(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*pow$2(2,1-c))*o>=2&&(n++,o/=2),n+c>=u?(i=0,n=u):n+c>=1?(i=(e*o-1)*pow$2(2,t),n+=c):(i=e*pow$2(2,c-1)*pow$2(2,t),n=0));t>=8;)a[f++]=255&i,i/=256,t-=8;for(n=n<<t|i,s+=t;s>0;)a[f++]=255&n,n/=256,s-=8;return a[--f]|=128*d,a},unpack=function(e,t){var r,n=e.length,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=e[u--],l=127&c;for(c>>=7;s>0;)l=256*l+e[u--],s-=8;for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)r=256*r+e[u--],s-=8;if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-1/0:1/0;r+=pow$2(2,t),l-=a}return(c?-1:1)*r*pow$2(2,l-t)},ieee754={pack:pack,unpack:unpack},toObject$c=toObject$o,toAbsoluteIndex$7=toAbsoluteIndex$c,lengthOfArrayLike$d=lengthOfArrayLike$n,arrayFill$1=function(e){for(var t=toObject$c(this),r=lengthOfArrayLike$d(t),n=arguments.length,i=toAbsoluteIndex$7(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:toAbsoluteIndex$7(o,r);a>i;)t[i++]=e;return t},global$P=global$1T,uncurryThis$R=functionUncurryThis$1,DESCRIPTORS$p=descriptors$1,NATIVE_ARRAY_BUFFER$1=arrayBufferNative,FunctionName=functionName$1,createNonEnumerableProperty$7=createNonEnumerableProperty$j,redefineAll$1=redefineAll$4,fails$N=fails$1m,anInstance$5=anInstance$9,toIntegerOrInfinity$a=toIntegerOrInfinity$j,toLength$a=toLength$g,toIndex$1=toIndex$2,IEEE754=ieee754,getPrototypeOf=objectGetPrototypeOf,setPrototypeOf$3=objectSetPrototypeOf$1,getOwnPropertyNames$4=objectGetOwnPropertyNames$1.f,defineProperty$d=objectDefineProperty$1.f,arrayFill=arrayFill$1,arraySlice$a=arraySliceSimple$1,setToStringTag$4=setToStringTag$b,InternalStateModule$5=internalState$1,PROPER_FUNCTION_NAME$2=FunctionName.PROPER,CONFIGURABLE_FUNCTION_NAME$1=FunctionName.CONFIGURABLE,getInternalState$4=InternalStateModule$5.get,setInternalState$4=InternalStateModule$5.set,ARRAY_BUFFER$1="ArrayBuffer",DATA_VIEW="DataView",PROTOTYPE$2="prototype",WRONG_LENGTH$1="Wrong length",WRONG_INDEX="Wrong index",NativeArrayBuffer$1=global$P[ARRAY_BUFFER$1],$ArrayBuffer=NativeArrayBuffer$1,ArrayBufferPrototype$1=$ArrayBuffer&&$ArrayBuffer[PROTOTYPE$2],$DataView=global$P[DATA_VIEW],DataViewPrototype$1=$DataView&&$DataView[PROTOTYPE$2],ObjectPrototype$1=Object.prototype,Array$2=global$P.Array,RangeError$5=global$P.RangeError,fill=uncurryThis$R(arrayFill),reverse=uncurryThis$R([].reverse),packIEEE754=IEEE754.pack,unpackIEEE754=IEEE754.unpack,packInt8=function(e){return[255&e]},packInt16=function(e){return[255&e,e>>8&255]},packInt32=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},unpackInt32=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},packFloat32=function(e){return packIEEE754(e,23,4)},packFloat64=function(e){return packIEEE754(e,52,8)},addGetter$1=function(e,t){defineProperty$d(e[PROTOTYPE$2],t,{get:function(){return getInternalState$4(this)[t]}})},get$1=function(e,t,r,n){var i=toIndex$1(r),o=getInternalState$4(e);if(i+t>o.byteLength)throw RangeError$5(WRONG_INDEX);var a=getInternalState$4(o.buffer).bytes,s=i+o.byteOffset,u=arraySlice$a(a,s,s+t);return n?u:reverse(u)},set$2=function(e,t,r,n,i,o){var a=toIndex$1(r),s=getInternalState$4(e);if(a+t>s.byteLength)throw RangeError$5(WRONG_INDEX);for(var u=getInternalState$4(s.buffer).bytes,c=a+s.byteOffset,l=n(+i),d=0;d<t;d++)u[c+d]=l[o?d:t-d-1]};if(NATIVE_ARRAY_BUFFER$1){var INCORRECT_ARRAY_BUFFER_NAME=PROPER_FUNCTION_NAME$2&&NativeArrayBuffer$1.name!==ARRAY_BUFFER$1;if(fails$N((function(){NativeArrayBuffer$1(1)}))&&fails$N((function(){new NativeArrayBuffer$1(-1)}))&&!fails$N((function(){return new NativeArrayBuffer$1,new NativeArrayBuffer$1(1.5),new NativeArrayBuffer$1(NaN),INCORRECT_ARRAY_BUFFER_NAME&&!CONFIGURABLE_FUNCTION_NAME$1})))INCORRECT_ARRAY_BUFFER_NAME&&CONFIGURABLE_FUNCTION_NAME$1&&createNonEnumerableProperty$7(NativeArrayBuffer$1,"name",ARRAY_BUFFER$1);else{$ArrayBuffer=function(e){return anInstance$5(this,ArrayBufferPrototype$1),new NativeArrayBuffer$1(toIndex$1(e))},$ArrayBuffer[PROTOTYPE$2]=ArrayBufferPrototype$1;for(var keys$7=getOwnPropertyNames$4(NativeArrayBuffer$1),j$1=0,key$1;keys$7.length>j$1;)(key$1=keys$7[j$1++])in $ArrayBuffer||createNonEnumerableProperty$7($ArrayBuffer,key$1,NativeArrayBuffer$1[key$1]);ArrayBufferPrototype$1.constructor=$ArrayBuffer}setPrototypeOf$3&&getPrototypeOf(DataViewPrototype$1)!==ObjectPrototype$1&&setPrototypeOf$3(DataViewPrototype$1,ObjectPrototype$1);var testView=new $DataView(new $ArrayBuffer(2)),$setInt8=uncurryThis$R(DataViewPrototype$1.setInt8);testView.setInt8(0,2147483648),testView.setInt8(1,2147483649),!testView.getInt8(0)&&testView.getInt8(1)||redefineAll$1(DataViewPrototype$1,{setInt8:function(e,t){$setInt8(this,e,t<<24>>24)},setUint8:function(e,t){$setInt8(this,e,t<<24>>24)}},{unsafe:!0})}else $ArrayBuffer=function(e){anInstance$5(this,ArrayBufferPrototype$1);var t=toIndex$1(e);setInternalState$4(this,{bytes:fill(Array$2(t),0),byteLength:t}),DESCRIPTORS$p||(this.byteLength=t)},ArrayBufferPrototype$1=$ArrayBuffer[PROTOTYPE$2],$DataView=function(e,t,r){anInstance$5(this,DataViewPrototype$1),anInstance$5(e,ArrayBufferPrototype$1);var n=getInternalState$4(e).byteLength,i=toIntegerOrInfinity$a(t);if(i<0||i>n)throw RangeError$5("Wrong offset");if(i+(r=void 0===r?n-i:toLength$a(r))>n)throw RangeError$5(WRONG_LENGTH$1);setInternalState$4(this,{buffer:e,byteLength:r,byteOffset:i}),DESCRIPTORS$p||(this.buffer=e,this.byteLength=r,this.byteOffset=i)},DataViewPrototype$1=$DataView[PROTOTYPE$2],DESCRIPTORS$p&&(addGetter$1($ArrayBuffer,"byteLength"),addGetter$1($DataView,"buffer"),addGetter$1($DataView,"byteLength"),addGetter$1($DataView,"byteOffset")),redefineAll$1(DataViewPrototype$1,{getInt8:function(e){return get$1(this,1,e)[0]<<24>>24},getUint8:function(e){return get$1(this,1,e)[0]},getInt16:function(e){var t=get$1(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=get$1(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return unpackInt32(get$1(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return unpackInt32(get$1(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return unpackIEEE754(get$1(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return unpackIEEE754(get$1(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){set$2(this,1,e,packInt8,t)},setUint8:function(e,t){set$2(this,1,e,packInt8,t)},setInt16:function(e,t){set$2(this,2,e,packInt16,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){set$2(this,2,e,packInt16,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){set$2(this,4,e,packInt32,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){set$2(this,4,e,packInt32,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){set$2(this,4,e,packFloat32,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){set$2(this,8,e,packFloat64,t,arguments.length>2?arguments[2]:void 0)}});setToStringTag$4($ArrayBuffer,ARRAY_BUFFER$1),setToStringTag$4($DataView,DATA_VIEW);var arrayBuffer={ArrayBuffer:$ArrayBuffer,DataView:$DataView},isObject$q=isObject$K,floor$6=Math.floor,isIntegralNumber$1=Number.isInteger||function(e){return!isObject$q(e)&&isFinite(e)&&floor$6(e)===e},global$O=global$1T,toIntegerOrInfinity$9=toIntegerOrInfinity$j,RangeError$4=global$O.RangeError,toPositiveInteger$1=function(e){var t=toIntegerOrInfinity$9(e);if(t<0)throw RangeError$4("The argument can't be less than 0");return t},global$N=global$1T,toPositiveInteger=toPositiveInteger$1,RangeError$3=global$N.RangeError,toOffset$2=function(e,t){var r=toPositiveInteger(e);if(r%t)throw RangeError$3("Wrong offset");return r},bind$9=functionBindContext$1,call$q=functionCall$1,aConstructor$2=aConstructor$5,toObject$b=toObject$o,lengthOfArrayLike$c=lengthOfArrayLike$n,getIterator$2=getIterator$6,getIteratorMethod$3=getIteratorMethod$8,isArrayIteratorMethod$2=isArrayIteratorMethod$5,aTypedArrayConstructor$3=arrayBufferViewCore.aTypedArrayConstructor,typedArrayFrom$1=function(e){var t,r,n,i,o,a,s=aConstructor$2(this),u=toObject$b(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,f=getIteratorMethod$3(u);if(f&&!isArrayIteratorMethod$2(f))for(a=(o=getIterator$2(u,f)).next,u=[];!(i=call$q(a,o)).done;)u.push(i.value);for(d&&c>2&&(l=bind$9(l,arguments[2])),r=lengthOfArrayLike$c(u),n=new(aTypedArrayConstructor$3(s))(r),t=0;r>t;t++)n[t]=d?l(u[t],t):u[t];return n},$$13=_export$1,global$M=global$1T,call$p=functionCall$1,DESCRIPTORS$o=descriptors$1,TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS$1=typedArrayConstructorsRequireWrappers,ArrayBufferViewCore$o=arrayBufferViewCore,ArrayBufferModule$2=arrayBuffer,anInstance$4=anInstance$9,createPropertyDescriptor$5=createPropertyDescriptor$d,createNonEnumerableProperty$6=createNonEnumerableProperty$j,isIntegralNumber=isIntegralNumber$1,toLength$9=toLength$g,toIndex=toIndex$2,toOffset$1=toOffset$2,toPropertyKey$5=toPropertyKey$a,hasOwn$j=hasOwnProperty_1$1,classof$c=classof$q,isObject$p=isObject$K,isSymbol$8=isSymbol$d,create$3=objectCreate$1,isPrototypeOf$9=objectIsPrototypeOf$1,setPrototypeOf$2=objectSetPrototypeOf$1,getOwnPropertyNames$3=objectGetOwnPropertyNames$1.f,typedArrayFrom=typedArrayFrom$1,forEach$4=arrayIteration$1.forEach,setSpecies$5=setSpecies$8,definePropertyModule$7=objectDefineProperty$1,getOwnPropertyDescriptorModule$3=objectGetOwnPropertyDescriptor$1,InternalStateModule$4=internalState$1,inheritIfRequired$4=inheritIfRequired$8,getInternalState$3=InternalStateModule$4.get,setInternalState$3=InternalStateModule$4.set,nativeDefineProperty$1=definePropertyModule$7.f,nativeGetOwnPropertyDescriptor$2=getOwnPropertyDescriptorModule$3.f,round=Math.round,RangeError$2=global$M.RangeError,ArrayBuffer$3=ArrayBufferModule$2.ArrayBuffer,ArrayBufferPrototype=ArrayBuffer$3.prototype,DataView$2=ArrayBufferModule$2.DataView,NATIVE_ARRAY_BUFFER_VIEWS=ArrayBufferViewCore$o.NATIVE_ARRAY_BUFFER_VIEWS,TYPED_ARRAY_CONSTRUCTOR$1=ArrayBufferViewCore$o.TYPED_ARRAY_CONSTRUCTOR,TYPED_ARRAY_TAG=ArrayBufferViewCore$o.TYPED_ARRAY_TAG,TypedArray=ArrayBufferViewCore$o.TypedArray,TypedArrayPrototype$1=ArrayBufferViewCore$o.TypedArrayPrototype,aTypedArrayConstructor$2=ArrayBufferViewCore$o.aTypedArrayConstructor,isTypedArray=ArrayBufferViewCore$o.isTypedArray,BYTES_PER_ELEMENT="BYTES_PER_ELEMENT",WRONG_LENGTH="Wrong length",fromList=function(e,t){aTypedArrayConstructor$2(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},addGetter=function(e,t){nativeDefineProperty$1(e,t,{get:function(){return getInternalState$3(this)[t]}})},isArrayBuffer=function(e){var t;return isPrototypeOf$9(ArrayBufferPrototype,e)||"ArrayBuffer"==(t=classof$c(e))||"SharedArrayBuffer"==t},isTypedArrayIndex=function(e,t){return isTypedArray(e)&&!isSymbol$8(t)&&t in e&&isIntegralNumber(+t)&&t>=0},wrappedGetOwnPropertyDescriptor=function(e,t){return t=toPropertyKey$5(t),isTypedArrayIndex(e,t)?createPropertyDescriptor$5(2,e[t]):nativeGetOwnPropertyDescriptor$2(e,t)},wrappedDefineProperty=function(e,t,r){return t=toPropertyKey$5(t),!(isTypedArrayIndex(e,t)&&isObject$p(r)&&hasOwn$j(r,"value"))||hasOwn$j(r,"get")||hasOwn$j(r,"set")||r.configurable||hasOwn$j(r,"writable")&&!r.writable||hasOwn$j(r,"enumerable")&&!r.enumerable?nativeDefineProperty$1(e,t,r):(e[t]=r.value,e)};DESCRIPTORS$o?(NATIVE_ARRAY_BUFFER_VIEWS||(getOwnPropertyDescriptorModule$3.f=wrappedGetOwnPropertyDescriptor,definePropertyModule$7.f=wrappedDefineProperty,addGetter(TypedArrayPrototype$1,"buffer"),addGetter(TypedArrayPrototype$1,"byteOffset"),addGetter(TypedArrayPrototype$1,"byteLength"),addGetter(TypedArrayPrototype$1,"length")),$$13({target:"Object",stat:!0,forced:!NATIVE_ARRAY_BUFFER_VIEWS},{getOwnPropertyDescriptor:wrappedGetOwnPropertyDescriptor,defineProperty:wrappedDefineProperty}),typedArrayConstructor.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",o="get"+e,a="set"+e,s=global$M[i],u=s,c=u&&u.prototype,l={},d=function(e,t){nativeDefineProperty$1(e,t,{get:function(){return function(e,t){var r=getInternalState$3(e);return r.view[o](t*n+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var o=getInternalState$3(e);r&&(i=(i=round(i))<0?0:i>255?255:255&i),o.view[a](t*n+o.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};NATIVE_ARRAY_BUFFER_VIEWS?TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS$1&&(u=t((function(e,t,r,i){return anInstance$4(e,c),inheritIfRequired$4(isObject$p(t)?isArrayBuffer(t)?void 0!==i?new s(t,toOffset$1(r,n),i):void 0!==r?new s(t,toOffset$1(r,n)):new s(t):isTypedArray(t)?fromList(u,t):call$p(typedArrayFrom,u,t):new s(toIndex(t)),e,u)})),setPrototypeOf$2&&setPrototypeOf$2(u,TypedArray),forEach$4(getOwnPropertyNames$3(s),(function(e){e in u||createNonEnumerableProperty$6(u,e,s[e])})),u.prototype=c):(u=t((function(e,t,r,i){anInstance$4(e,c);var o,a,s,l=0,f=0;if(isObject$p(t)){if(!isArrayBuffer(t))return isTypedArray(t)?fromList(u,t):call$p(typedArrayFrom,u,t);o=t,f=toOffset$1(r,n);var h=t.byteLength;if(void 0===i){if(h%n)throw RangeError$2(WRONG_LENGTH);if((a=h-f)<0)throw RangeError$2(WRONG_LENGTH)}else if((a=toLength$9(i)*n)+f>h)throw RangeError$2(WRONG_LENGTH);s=a/n}else s=toIndex(t),o=new ArrayBuffer$3(a=s*n);for(setInternalState$3(e,{buffer:o,byteOffset:f,byteLength:a,length:s,view:new DataView$2(o)});l<s;)d(e,l++)})),setPrototypeOf$2&&setPrototypeOf$2(u,TypedArray),c=u.prototype=create$3(TypedArrayPrototype$1)),c.constructor!==u&&createNonEnumerableProperty$6(c,"constructor",u),createNonEnumerableProperty$6(c,TYPED_ARRAY_CONSTRUCTOR$1,u),TYPED_ARRAY_TAG&&createNonEnumerableProperty$6(c,TYPED_ARRAY_TAG,i),l[i]=u,$$13({global:!0,forced:u!=s,sham:!NATIVE_ARRAY_BUFFER_VIEWS},l),BYTES_PER_ELEMENT in u||createNonEnumerableProperty$6(u,BYTES_PER_ELEMENT,n),BYTES_PER_ELEMENT in c||createNonEnumerableProperty$6(c,BYTES_PER_ELEMENT,n),setSpecies$5(i)}):typedArrayConstructor.exports=function(){};var createTypedArrayConstructor$7=typedArrayConstructor.exports;createTypedArrayConstructor$7("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var toObject$a=toObject$o,toAbsoluteIndex$6=toAbsoluteIndex$c,lengthOfArrayLike$b=lengthOfArrayLike$n,min$7=Math.min,arrayCopyWithin=[].copyWithin||function(e,t){var r=toObject$a(this),n=lengthOfArrayLike$b(r),i=toAbsoluteIndex$6(e,n),o=toAbsoluteIndex$6(t,n),a=arguments.length>2?arguments[2]:void 0,s=min$7((void 0===a?n:toAbsoluteIndex$6(a,n))-o,n-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in r?r[i]=r[o]:delete r[i],i+=u,o+=u;return r},uncurryThis$Q=functionUncurryThis$1,ArrayBufferViewCore$n=arrayBufferViewCore,$ArrayCopyWithin=arrayCopyWithin,u$ArrayCopyWithin=uncurryThis$Q($ArrayCopyWithin),aTypedArray$l=ArrayBufferViewCore$n.aTypedArray,exportTypedArrayMethod$m=ArrayBufferViewCore$n.exportTypedArrayMethod;exportTypedArrayMethod$m("copyWithin",(function(e,t){return u$ArrayCopyWithin(aTypedArray$l(this),e,t,arguments.length>2?arguments[2]:void 0)}));var ArrayBufferViewCore$m=arrayBufferViewCore,$every$1=arrayIteration$1.every,aTypedArray$k=ArrayBufferViewCore$m.aTypedArray,exportTypedArrayMethod$l=ArrayBufferViewCore$m.exportTypedArrayMethod;exportTypedArrayMethod$l("every",(function(e){return $every$1(aTypedArray$k(this),e,arguments.length>1?arguments[1]:void 0)}));var ArrayBufferViewCore$l=arrayBufferViewCore,call$o=functionCall$1,$fill=arrayFill$1,aTypedArray$j=ArrayBufferViewCore$l.aTypedArray,exportTypedArrayMethod$k=ArrayBufferViewCore$l.exportTypedArrayMethod;exportTypedArrayMethod$k("fill",(function(e){var t=arguments.length;return call$o($fill,aTypedArray$j(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var lengthOfArrayLike$a=lengthOfArrayLike$n,arrayFromConstructorAndList$1=function(e,t){for(var r=0,n=lengthOfArrayLike$a(t),i=new e(n);n>r;)i[r]=t[r++];return i},ArrayBufferViewCore$k=arrayBufferViewCore,speciesConstructor$4=speciesConstructor$8,TYPED_ARRAY_CONSTRUCTOR=ArrayBufferViewCore$k.TYPED_ARRAY_CONSTRUCTOR,aTypedArrayConstructor$1=ArrayBufferViewCore$k.aTypedArrayConstructor,typedArraySpeciesConstructor$4=function(e){return aTypedArrayConstructor$1(speciesConstructor$4(e,e[TYPED_ARRAY_CONSTRUCTOR]))},arrayFromConstructorAndList=arrayFromConstructorAndList$1,typedArraySpeciesConstructor$3=typedArraySpeciesConstructor$4,typedArrayFromSpeciesAndList=function(e,t){return arrayFromConstructorAndList(typedArraySpeciesConstructor$3(e),t)},ArrayBufferViewCore$j=arrayBufferViewCore,$filter$1=arrayIteration$1.filter,fromSpeciesAndList=typedArrayFromSpeciesAndList,aTypedArray$i=ArrayBufferViewCore$j.aTypedArray,exportTypedArrayMethod$j=ArrayBufferViewCore$j.exportTypedArrayMethod;exportTypedArrayMethod$j("filter",(function(e){var t=$filter$1(aTypedArray$i(this),e,arguments.length>1?arguments[1]:void 0);return fromSpeciesAndList(this,t)}));var ArrayBufferViewCore$i=arrayBufferViewCore,$find=arrayIteration$1.find,aTypedArray$h=ArrayBufferViewCore$i.aTypedArray,exportTypedArrayMethod$i=ArrayBufferViewCore$i.exportTypedArrayMethod;exportTypedArrayMethod$i("find",(function(e){return $find(aTypedArray$h(this),e,arguments.length>1?arguments[1]:void 0)}));var ArrayBufferViewCore$h=arrayBufferViewCore,$findIndex=arrayIteration$1.findIndex,aTypedArray$g=ArrayBufferViewCore$h.aTypedArray,exportTypedArrayMethod$h=ArrayBufferViewCore$h.exportTypedArrayMethod;exportTypedArrayMethod$h("findIndex",(function(e){return $findIndex(aTypedArray$g(this),e,arguments.length>1?arguments[1]:void 0)}));var ArrayBufferViewCore$g=arrayBufferViewCore,$forEach$2=arrayIteration$1.forEach,aTypedArray$f=ArrayBufferViewCore$g.aTypedArray,exportTypedArrayMethod$g=ArrayBufferViewCore$g.exportTypedArrayMethod;exportTypedArrayMethod$g("forEach",(function(e){$forEach$2(aTypedArray$f(this),e,arguments.length>1?arguments[1]:void 0)}));var ArrayBufferViewCore$f=arrayBufferViewCore,$includes$1=arrayIncludes$1.includes,aTypedArray$e=ArrayBufferViewCore$f.aTypedArray,exportTypedArrayMethod$f=ArrayBufferViewCore$f.exportTypedArrayMethod;exportTypedArrayMethod$f("includes",(function(e){return $includes$1(aTypedArray$e(this),e,arguments.length>1?arguments[1]:void 0)}));var ArrayBufferViewCore$e=arrayBufferViewCore,$indexOf=arrayIncludes$1.indexOf,aTypedArray$d=ArrayBufferViewCore$e.aTypedArray,exportTypedArrayMethod$e=ArrayBufferViewCore$e.exportTypedArrayMethod;exportTypedArrayMethod$e("indexOf",(function(e){return $indexOf(aTypedArray$d(this),e,arguments.length>1?arguments[1]:void 0)}));var global$L=global$1T,fails$M=fails$1m,uncurryThis$P=functionUncurryThis$1,ArrayBufferViewCore$d=arrayBufferViewCore,ArrayIterators=es_array_iterator,wellKnownSymbol$m=wellKnownSymbol$O,ITERATOR$7=wellKnownSymbol$m("iterator"),Uint8Array$2=global$L.Uint8Array,arrayValues=uncurryThis$P(ArrayIterators.values),arrayKeys=uncurryThis$P(ArrayIterators.keys),arrayEntries=uncurryThis$P(ArrayIterators.entries),aTypedArray$c=ArrayBufferViewCore$d.aTypedArray,exportTypedArrayMethod$d=ArrayBufferViewCore$d.exportTypedArrayMethod,TypedArrayPrototype=Uint8Array$2&&Uint8Array$2.prototype,GENERIC=!fails$M((function(){TypedArrayPrototype[ITERATOR$7].call([1])})),ITERATOR_IS_VALUES=!!TypedArrayPrototype&&TypedArrayPrototype.values&&TypedArrayPrototype[ITERATOR$7]===TypedArrayPrototype.values&&"values"===TypedArrayPrototype.values.name,typedArrayValues=function(){return arrayValues(aTypedArray$c(this))};exportTypedArrayMethod$d("entries",(function(){return arrayEntries(aTypedArray$c(this))}),GENERIC),exportTypedArrayMethod$d("keys",(function(){return arrayKeys(aTypedArray$c(this))}),GENERIC),exportTypedArrayMethod$d("values",typedArrayValues,GENERIC||!ITERATOR_IS_VALUES,{name:"values"}),exportTypedArrayMethod$d(ITERATOR$7,typedArrayValues,GENERIC||!ITERATOR_IS_VALUES,{name:"values"});var ArrayBufferViewCore$c=arrayBufferViewCore,uncurryThis$O=functionUncurryThis$1,aTypedArray$b=ArrayBufferViewCore$c.aTypedArray,exportTypedArrayMethod$c=ArrayBufferViewCore$c.exportTypedArrayMethod,$join=uncurryThis$O([].join);exportTypedArrayMethod$c("join",(function(e){return $join(aTypedArray$b(this),e)}));var apply$9=functionApply$1,toIndexedObject$c=toIndexedObject$o,toIntegerOrInfinity$8=toIntegerOrInfinity$j,lengthOfArrayLike$9=lengthOfArrayLike$n,arrayMethodIsStrict$9=arrayMethodIsStrict$d,min$6=Math.min,$lastIndexOf$1=[].lastIndexOf,NEGATIVE_ZERO$2=!!$lastIndexOf$1&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD$8=arrayMethodIsStrict$9("lastIndexOf"),FORCED$c=NEGATIVE_ZERO$2||!STRICT_METHOD$8,arrayLastIndexOf=FORCED$c?function(e){if(NEGATIVE_ZERO$2)return apply$9($lastIndexOf$1,this,arguments)||0;var t=toIndexedObject$c(this),r=lengthOfArrayLike$9(t),n=r-1;for(arguments.length>1&&(n=min$6(n,toIntegerOrInfinity$8(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:$lastIndexOf$1,ArrayBufferViewCore$b=arrayBufferViewCore,apply$8=functionApply$1,$lastIndexOf=arrayLastIndexOf,aTypedArray$a=ArrayBufferViewCore$b.aTypedArray,exportTypedArrayMethod$b=ArrayBufferViewCore$b.exportTypedArrayMethod;exportTypedArrayMethod$b("lastIndexOf",(function(e){var t=arguments.length;return apply$8($lastIndexOf,aTypedArray$a(this),t>1?[e,arguments[1]]:[e])}));var ArrayBufferViewCore$a=arrayBufferViewCore,$map$1=arrayIteration$1.map,typedArraySpeciesConstructor$2=typedArraySpeciesConstructor$4,aTypedArray$9=ArrayBufferViewCore$a.aTypedArray,exportTypedArrayMethod$a=ArrayBufferViewCore$a.exportTypedArrayMethod;exportTypedArrayMethod$a("map",(function(e){return $map$1(aTypedArray$9(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(typedArraySpeciesConstructor$2(e))(t)}))}));var global$K=global$1T,aCallable$9=aCallable$h,toObject$9=toObject$o,IndexedObject$3=indexedObject$1,lengthOfArrayLike$8=lengthOfArrayLike$n,TypeError$6=global$K.TypeError,createMethod$6=function(e){return function(t,r,n,i){aCallable$9(r);var o=toObject$9(t),a=IndexedObject$3(o),s=lengthOfArrayLike$8(o),u=e?s-1:0,c=e?-1:1;if(n<2)for(;;){if(u in a){i=a[u],u+=c;break}if(u+=c,e?u<0:s<=u)throw TypeError$6("Reduce of empty array with no initial value")}for(;e?u>=0:s>u;u+=c)u in a&&(i=r(i,a[u],u,o));return i}},arrayReduce={left:createMethod$6(!1),right:createMethod$6(!0)},ArrayBufferViewCore$9=arrayBufferViewCore,$reduce$1=arrayReduce.left,aTypedArray$8=ArrayBufferViewCore$9.aTypedArray,exportTypedArrayMethod$9=ArrayBufferViewCore$9.exportTypedArrayMethod;exportTypedArrayMethod$9("reduce",(function(e){var t=arguments.length;return $reduce$1(aTypedArray$8(this),e,t,t>1?arguments[1]:void 0)}));var ArrayBufferViewCore$8=arrayBufferViewCore,$reduceRight=arrayReduce.right,aTypedArray$7=ArrayBufferViewCore$8.aTypedArray,exportTypedArrayMethod$8=ArrayBufferViewCore$8.exportTypedArrayMethod;exportTypedArrayMethod$8("reduceRight",(function(e){var t=arguments.length;return $reduceRight(aTypedArray$7(this),e,t,t>1?arguments[1]:void 0)}));var ArrayBufferViewCore$7=arrayBufferViewCore,aTypedArray$6=ArrayBufferViewCore$7.aTypedArray,exportTypedArrayMethod$7=ArrayBufferViewCore$7.exportTypedArrayMethod,floor$5=Math.floor;exportTypedArrayMethod$7("reverse",(function(){for(var e,t=this,r=aTypedArray$6(t).length,n=floor$5(r/2),i=0;i<n;)e=t[i],t[i++]=t[--r],t[r]=e;return t}));var global$J=global$1T,call$n=functionCall$1,ArrayBufferViewCore$6=arrayBufferViewCore,lengthOfArrayLike$7=lengthOfArrayLike$n,toOffset=toOffset$2,toIndexedObject$b=toObject$o,fails$L=fails$1m,RangeError$1=global$J.RangeError,Int8Array$2=global$J.Int8Array,Int8ArrayPrototype=Int8Array$2&&Int8Array$2.prototype,$set=Int8ArrayPrototype&&Int8ArrayPrototype.set,aTypedArray$5=ArrayBufferViewCore$6.aTypedArray,exportTypedArrayMethod$6=ArrayBufferViewCore$6.exportTypedArrayMethod,WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS=!fails$L((function(){var e=new Uint8ClampedArray(2);return call$n($set,e,{length:1,0:3},1),3!==e[1]})),TO_OBJECT_BUG=WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS&&ArrayBufferViewCore$6.NATIVE_ARRAY_BUFFER_VIEWS&&fails$L((function(){var e=new Int8Array$2(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));exportTypedArrayMethod$6("set",(function(e){aTypedArray$5(this);var t=toOffset(arguments.length>1?arguments[1]:void 0,1),r=toIndexedObject$b(e);if(WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS)return call$n($set,this,r,t);var n=this.length,i=lengthOfArrayLike$7(r),o=0;if(i+t>n)throw RangeError$1("Wrong length");for(;o<i;)this[t+o]=r[o++]}),!WORKS_WITH_OBJECTS_AND_GEERIC_ON_TYPED_ARRAYS||TO_OBJECT_BUG);var ArrayBufferViewCore$5=arrayBufferViewCore,typedArraySpeciesConstructor$1=typedArraySpeciesConstructor$4,fails$K=fails$1m,arraySlice$9=arraySlice$j,aTypedArray$4=ArrayBufferViewCore$5.aTypedArray,exportTypedArrayMethod$5=ArrayBufferViewCore$5.exportTypedArrayMethod,FORCED$b=fails$K((function(){new Int8Array(1).slice()}));exportTypedArrayMethod$5("slice",(function(e,t){for(var r=arraySlice$9(aTypedArray$4(this),e,t),n=typedArraySpeciesConstructor$1(this),i=0,o=r.length,a=new n(o);o>i;)a[i]=r[i++];return a}),FORCED$b);var ArrayBufferViewCore$4=arrayBufferViewCore,$some$2=arrayIteration$1.some,aTypedArray$3=ArrayBufferViewCore$4.aTypedArray,exportTypedArrayMethod$4=ArrayBufferViewCore$4.exportTypedArrayMethod;exportTypedArrayMethod$4("some",(function(e){return $some$2(aTypedArray$3(this),e,arguments.length>1?arguments[1]:void 0)}));var global$I=global$1T,uncurryThis$N=functionUncurryThis$1,fails$J=fails$1m,aCallable$8=aCallable$h,internalSort=arraySort$1,ArrayBufferViewCore$3=arrayBufferViewCore,FF=engineFfVersion,IE_OR_EDGE=engineIsIeOrEdge,V8=engineV8Version$1,WEBKIT=engineWebkitVersion,Array$1=global$I.Array,aTypedArray$2=ArrayBufferViewCore$3.aTypedArray,exportTypedArrayMethod$3=ArrayBufferViewCore$3.exportTypedArrayMethod,Uint16Array$1=global$I.Uint16Array,un$Sort=Uint16Array$1&&uncurryThis$N(Uint16Array$1.prototype.sort),ACCEPT_INCORRECT_ARGUMENTS=!(!un$Sort||fails$J((function(){un$Sort(new Uint16Array$1(2),null)}))&&fails$J((function(){un$Sort(new Uint16Array$1(2),{})}))),STABLE_SORT=!!un$Sort&&!fails$J((function(){if(V8)return V8<74;if(FF)return FF<67;if(IE_OR_EDGE)return!0;if(WEBKIT)return WEBKIT<602;var e,t,r=new Uint16Array$1(516),n=Array$1(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(un$Sort(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0})),getSortCompare=function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}};exportTypedArrayMethod$3("sort",(function(e){return void 0!==e&&aCallable$8(e),STABLE_SORT?un$Sort(this,e):internalSort(aTypedArray$2(this),getSortCompare(e))}),!STABLE_SORT||ACCEPT_INCORRECT_ARGUMENTS);var ArrayBufferViewCore$2=arrayBufferViewCore,toLength$8=toLength$g,toAbsoluteIndex$5=toAbsoluteIndex$c,typedArraySpeciesConstructor=typedArraySpeciesConstructor$4,aTypedArray$1=ArrayBufferViewCore$2.aTypedArray,exportTypedArrayMethod$2=ArrayBufferViewCore$2.exportTypedArrayMethod;exportTypedArrayMethod$2("subarray",(function(e,t){var r=aTypedArray$1(this),n=r.length,i=toAbsoluteIndex$5(e,n);return new(typedArraySpeciesConstructor(r))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,toLength$8((void 0===t?n:toAbsoluteIndex$5(t,n))-i))}));var global$H=global$1T,apply$7=functionApply$1,ArrayBufferViewCore$1=arrayBufferViewCore,fails$I=fails$1m,arraySlice$8=arraySlice$j,Int8Array$1=global$H.Int8Array,aTypedArray=ArrayBufferViewCore$1.aTypedArray,exportTypedArrayMethod$1=ArrayBufferViewCore$1.exportTypedArrayMethod,$toLocaleString=[].toLocaleString,TO_LOCALE_STRING_BUG=!!Int8Array$1&&fails$I((function(){$toLocaleString.call(new Int8Array$1(1))})),FORCED$a=fails$I((function(){return[1,2].toLocaleString()!=new Int8Array$1([1,2]).toLocaleString()}))||!fails$I((function(){Int8Array$1.prototype.toLocaleString.call([1,2])}));exportTypedArrayMethod$1("toLocaleString",(function(){return apply$7($toLocaleString,TO_LOCALE_STRING_BUG?arraySlice$8(aTypedArray(this)):aTypedArray(this),arraySlice$8(arguments))}),FORCED$a);var exportTypedArrayMethod=arrayBufferViewCore.exportTypedArrayMethod,fails$H=fails$1m,global$G=global$1T,uncurryThis$M=functionUncurryThis$1,Uint8Array$1=global$G.Uint8Array,Uint8ArrayPrototype=Uint8Array$1&&Uint8Array$1.prototype||{},arrayToString=[].toString,join=uncurryThis$M([].join);fails$H((function(){arrayToString.call({})}))&&(arrayToString=function(){return join(this)});var IS_NOT_ARRAY_METHOD=Uint8ArrayPrototype.toString!=arrayToString;exportTypedArrayMethod("toString",arrayToString,IS_NOT_ARRAY_METHOD);var LoaderType={FETCH:"fetch",XHR:"xhr"},ResponseType={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"};function _createSuper$o(e){var t=_isNativeReflectConstruct$o();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var NetError=function(e){_inherits(r,e);var t=_createSuper$o(r);function r(e,n,i,o){var a;return _classCallCheck$1(this,r),_defineProperty$1(_assertThisInitialized(a=t.call(this,o)),"retryCount",0),_defineProperty$1(_assertThisInitialized(a),"isTimeout",!1),_defineProperty$1(_assertThisInitialized(a),"loaderType",LoaderType.FETCH),_defineProperty$1(_assertThisInitialized(a),"startTime",0),_defineProperty$1(_assertThisInitialized(a),"endTime",0),a.url=e,a.request=n,a.response=i,a}return r}(_wrapNativeSuper(Error)),$$12=_export$1,fails$G=fails$1m,toObject$8=toObject$o,nativeGetPrototypeOf=objectGetPrototypeOf,CORRECT_PROTOTYPE_GETTER=correctPrototypeGetter,FAILS_ON_PRIMITIVES$4=fails$G((function(){nativeGetPrototypeOf(1)}));$$12({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$4,sham:!CORRECT_PROTOTYPE_GETTER},{getPrototypeOf:function(e){return nativeGetPrototypeOf(toObject$8(e))}});var toString$n=Object.prototype.toString;function isObject$o(e){return null!==e&&"object"===_typeof$1(e)}function isPlainObject(e){if("[object Object]"!==toString$n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isDate(e){return"[object Date]"===toString$n.call(e)}function getRangeValue(e){if(e&&null!=e[0]&&(0!==e[0]||null!=e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function setUrlParams(e,t){if(e){if(!t)return e;var r,n=Object.keys(t).map((function(e){if(null!=(r=t[e]))return Array.isArray(r)?e+="[]":r=[r],r.map((function(t){return isDate(t)?t=t.toISOString():isObject$o(t)&&(t=JSON.stringify(t)),"".concat(encode(e),"=").concat(encode(t))})).join("&")})).filter(Boolean).join("&");if(n){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}}function createResponse(e,t,r,n,i,o){return n=null!=n?parseFloat(n):null,r=parseInt(r||"0",10),isNaN(r)&&(r=0),{data:e,response:t,contentLength:r,age:n,startTime:i,firstByteTime:o,endTime:Date.now()}}var FetchLoader=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"_abortController",null),_defineProperty$1(this,"_timeoutTimer",null),_defineProperty$1(this,"_reader",null),_defineProperty$1(this,"_response",null),_defineProperty$1(this,"_aborted",!1)}var t;return _createClass$1(e,[{key:"load",value:function(e){var t,r=this,n=e.url,i=e.timeout,o=e.responseType,a=e.onProgress,s=e.onTimeout,u=e.range,c=e.transformResponse,l=e.request,d=e.params,f=e.method,h=e.headers,p=e.body,g=e.mode,y=e.credentials,v=e.cache,m=e.redirect,_=e.referrer,b=e.referrerPolicy;this._aborted=!1,this._abortController="undefined"!=typeof AbortController&&new AbortController;var A={method:f,headers:h,body:p,mode:g,credentials:y,cache:v,redirect:m,referrer:_,referrerPolicy:b,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal},E=!1;clearTimeout(this._timeoutTimer),n=setUrlParams(n,d);var S=getRangeValue(u);S&&((h=l?l.headers:A.headers=A.headers||new Headers)instanceof Headers?h.append("Range",S):h.Range=S),i&&(this._timeoutTimer=setTimeout((function(){if(E=!0,r.cancel(),s){var e=new NetError(n,A);e.isTimeout=!0,s(e)}}),i));var T=Date.now();return fetch(l||n,l?void 0:A).then(function(){var e=_asyncToGenerator(regenerator.mark((function e(t){var i,s;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(r._timeoutTimer),r._response=t,!r._aborted){e.next=4;break}return e.abrupt("return");case 4:if(c&&(t=c(t,n)||t),t.ok){e.next=7;break}throw new NetError(n,A,t,"bad network response");case 7:if(i=Date.now(),o!==ResponseType.TEXT){e.next=14;break}return e.next=11,t.text();case 11:s=e.sent,e.next=28;break;case 14:if(o!==ResponseType.JSON){e.next=20;break}return e.next=17,t.json();case 17:s=e.sent,e.next=28;break;case 20:if(!a){e.next=24;break}r._loadChunk(t,a),e.next=28;break;case 24:return e.next=26,t.arrayBuffer();case 26:s=e.sent,s=new Uint8Array(s);case 28:return e.abrupt("return",createResponse(s,t,t.headers.get("Content-Length"),t.headers.get("age"),T,i));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){if(clearTimeout(r._timeoutTimer),!r._aborted||E)throw(e=e instanceof NetError?e:new NetError(n,A)).startTime=T,e.endTime=Date.now(),e.isTimeout=E,e}))}},{key:"cancel",value:(t=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._aborted){e.next=2;break}return e.abrupt("return");case 2:if(this._aborted=!0,!this._response){e.next=13;break}if(e.prev=4,!this._reader){e.next=8;break}return e.next=8,this._reader.cancel();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:this._response=this._reader=null;case 13:if(this._abortController){try{this._abortController.abort()}catch(error){}this._abortController=null}case 14:case"end":return e.stop()}}),e,this,[[4,10]])}))),function(){return t.apply(this,arguments)})},{key:"_loadChunk",value:function(e,t){var r,n,i,o=this,a=this._reader=e.body.getReader(),s=function(){var u=_asyncToGenerator(regenerator.mark((function u(){return regenerator.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return n=Date.now(),u.prev=1,u.next=4,a.read();case 4:r=u.sent,i=Date.now(),u.next=13;break;case 8:return u.prev=8,u.t0=u.catch(1),i=Date.now(),t(void 0,!0,{startTime:n,endTime:i},e),u.abrupt("return");case 13:if(!o._aborted){u.next=16;break}return t(void 0,!0,{startTime:n,endTime:i},e),u.abrupt("return");case 16:t(r.value,r.done,{startTime:n,endTime:i},e),r.done||s();case 18:case"end":return u.stop()}}),u,null,[[1,8]])})));return function(){return u.apply(this,arguments)}}();s()}}],[{key:"isSupported",value:function(){return!("undefined"==typeof fetch)}}]),e}();function ownKeys$k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$k(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function getConfig$1(e){return _objectSpread$h({loaderType:LoaderType.FETCH,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:ResponseType.TEXT,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0},e)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var $$11=_export$1,from=arrayFrom$1,checkCorrectnessOfIteration$3=checkCorrectnessOfIteration$6,INCORRECT_ITERATION=!checkCorrectnessOfIteration$3((function(e){Array.from(e)}));$$11({target:"Array",stat:!0,forced:INCORRECT_ITERATION},{from:from});var $$10=_export$1,DESCRIPTORS$n=descriptors$1,global$F=global$1T,uncurryThis$L=functionUncurryThis$1,hasOwn$i=hasOwnProperty_1$1,isCallable$q=isCallable$Q,isPrototypeOf$8=objectIsPrototypeOf$1,toString$m=toString$A,defineProperty$c=objectDefineProperty$1.f,copyConstructorProperties$3=copyConstructorProperties$6,NativeSymbol$1=global$F.Symbol,SymbolPrototype$2=NativeSymbol$1&&NativeSymbol$1.prototype;if(DESCRIPTORS$n&&isCallable$q(NativeSymbol$1)&&(!("description"in SymbolPrototype$2)||void 0!==NativeSymbol$1().description)){var EmptyStringDescriptionStore$1={},SymbolWrapper$1=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:toString$m(arguments[0]),t=isPrototypeOf$8(SymbolPrototype$2,this)?new NativeSymbol$1(e):void 0===e?NativeSymbol$1():NativeSymbol$1(e);return""===e&&(EmptyStringDescriptionStore$1[t]=!0),t};copyConstructorProperties$3(SymbolWrapper$1,NativeSymbol$1),SymbolWrapper$1.prototype=SymbolPrototype$2,SymbolPrototype$2.constructor=SymbolWrapper$1;var NATIVE_SYMBOL$7="Symbol(test)"==String(NativeSymbol$1("test")),symbolToString$1=uncurryThis$L(SymbolPrototype$2.toString),symbolValueOf$1=uncurryThis$L(SymbolPrototype$2.valueOf),regexp$1=/^Symbol\((.*)\)[^)]+$/,replace$6=uncurryThis$L("".replace),stringSlice$b=uncurryThis$L("".slice);defineProperty$c(SymbolPrototype$2,"description",{configurable:!0,get:function(){var e=symbolValueOf$1(this),t=symbolToString$1(e);if(hasOwn$i(EmptyStringDescriptionStore$1,e))return"";var r=NATIVE_SYMBOL$7?stringSlice$b(t,7,-1):replace$6(t,regexp$1,"$1");return""===r?void 0:r}}),$$10({global:!0,forced:!0},{Symbol:SymbolWrapper$1})}var defineWellKnownSymbol$2=defineWellKnownSymbol$4;function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray$1(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray$1(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$1(e,t):void 0}}function _arrayLikeToArray$1(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}defineWellKnownSymbol$2("iterator");var XhrLoader=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"_xhr",null),_defineProperty$1(this,"_aborted",!1),_defineProperty$1(this,"_timeoutTimer",null)}return _createClass$1(e,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer);var r=e.url,n=e.params,i=e.timeout,o=e.responseType,a=e.onTimeout,s=e.transformResponse,u=e.onProgress,c=e.method,l=e.credentials,d=e.body,f=e.headers,h=e.range,p=e.request,g=!1;r=setUrlParams(r,n);var y=Date.now();return new Promise((function(e,n){var v=t._xhr=new XMLHttpRequest;v.open(c||"GET",r,!0),v.responseType=o,v.withCredentials="include"===l||"same-origin"===l;var m=getRangeValue(h);m&&((f=f||{}).Range=m),f&&Object.keys(f).forEach((function(e){v.setRequestHeader(e,f[e])})),i&&(t._timeoutTimer=setTimeout((function(){if(g=!0,t.cancel(),a){var e=new NetError(r,p);e.isTimeout=!0,a(e)}}),i)),v.onerror=function(e){return n(e)},v.onreadystatechange=function(){if(v.readyState>=2){clearTimeout(t._timeoutTimer);var i=Date.now();if(4===v.readyState){if(v.onreadystatechange=null,t._aborted)return;var o=v.status,a={ok:o>=200&&o<300,status:o,statusText:v.statusText,url:v.responseURL,headers:t._getHeaders(v),body:v.response};if(s&&(a=s(a,r)||a),!a.ok)return n(new NetError(r,p,a,"bad network response"));var c=v.responseType===ResponseType.ARRAY_BUFFER,l=c?new Uint8Array(v.response):v.response;u&&u(c?l:void 0,!0,{startTime:y,endTime:Date.now()},a),e(createResponse(l,a,a.headers["content-length"],a.headers.age,y,i))}}},v.send(d)})).catch((function(e){if(clearTimeout(t._timeoutTimer),!t._aborted||g)throw(e=e instanceof NetError?e:new NetError(r,p)).startTime=y,e.endTime=Date.now(),e.isTimeout=g,e}))}},{key:"cancel",value:function(){if(!this._aborted)return this._aborted=!0,this._xhr?this._xhr.cancel():void 0}},{key:"_getHeaders",value:function(e){var t,r={},n=_createForOfIteratorHelper(e.getAllResponseHeaders().trim().split("\r\n"));try{for(n.s();!(t=n.n()).done;){var i=t.value.split(": ");r[i[0].toLowerCase()]=i.slice(1).join(": ")}}catch(o){n.e(o)}finally{n.f()}return r}}],[{key:"isSupported",value:function(){return"undefined"!=typeof XMLHttpRequest}}]),e}(),_excluded=["retry","retryDelay","onRetryError","transformError"],Task$2=function(){function e(t,r){_classCallCheck$1(this,e),this.promise=createPublicPromise(),this.alive=!!r.onProgress,this._loaderType=t,this._loader=t===LoaderType.FETCH?new FetchLoader:new XhrLoader,this._config=r,this._retryCount=0,this._retryTimer=null,this._canceled=!1}var t;return _createClass$1(e,[{key:"exec",value:function(){var e=this,t=this._config,r=t.retry,n=t.retryDelay,i=t.onRetryError,o=t.transformError,a=_objectWithoutProperties(t,_excluded),s=function(){var t=_asyncToGenerator(regenerator.mark((function t(){var u,c;return regenerator.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._loader.load(a);case 3:u=t.sent,e.promise.resolve(u),t.next=22;break;case 7:if(t.prev=7,t.t0=t.catch(0),!e._canceled){t.next=11;break}return t.abrupt("return");case 11:if(t.t0.loaderType=e._loaderType,t.t0.retryCount=e._retryCount,c=t.t0,o&&(c=o(c)||c),i&&e._retryCount>0&&i(c,e._retryCount,r),e._retryCount++,!(e._retryCount<=r)){t.next=21;break}return clearTimeout(e._retryTimer),e._retryTimer=setTimeout(s,n),t.abrupt("return");case 21:e.promise.reject(c);case 22:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return s(),this.promise}},{key:"cancel",value:(t=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,e.abrupt("return",this._loader.cancel());case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function isMediaPlaying(e){return e&&!e.paused&&!e.ended&&0!==e.playbackRate&&0!==e.readyState}function getVideoPlaybackQuality(e){if(!e)return{};if("function"==typeof e.getVideoPlaybackQuality){var t=e.getVideoPlaybackQuality();return{droppedVideoFrames:t.droppedVideoFrames||t.corruptedVideoFrames,totalVideoFrames:t.totalVideoFrames,creationTime:t.creationTime}}return{droppedVideoFrames:e.webkitDroppedFrameCount,totalVideoFrames:e.webkitDecodedFrameCount,creationTime:performance.now()}}function concatUint8Array$1(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if((t=t.filter(Boolean)).length<2)return t[0];var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),i=0;return t.forEach((function(e){n.set(e,i),i+=e.byteLength})),n}function softDecodeProbe(){var t,r=!1,n=!1;try{var i=new(window.AudioContext||window.webkitAudioContext);i.close(),i=null,r=!0}catch(e){}try{for(var o=document.createElement("canvas"),a=["webgl","experimental-webgl","moz-webgl","webkit-3d"],s=0;s<a.length;s++){var u=o.getContext(a[s]);if(u){u=null,o=null,n=!0;break}}}catch(e){}if("customElements"in window&&window.customElements.define){var c=window.customElements.get("live-video");t=c&&c.isSupported()}return r&&n&&t}function sleep(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}var NetLoader=function(){function e(t){_classCallCheck$1(this,e),_defineProperty$1(this,"type",LoaderType.FETCH),_defineProperty$1(this,"_queue",[]),_defineProperty$1(this,"_alive",[]),_defineProperty$1(this,"_currentTask",null),this._config=getConfig$1(t),this._config.loaderType!==LoaderType.XHR&&FetchLoader.isSupported()||(this.type=LoaderType.XHR)}var t;return _createClass$1(e,[{key:"isFetch",value:function(){return this.type===LoaderType.FETCH}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?t=e:t.url=e||t.url||this._config.url,(t=Object.assign({},this._config,t)).params&&(t.params=Object.assign({},t.params)),t.headers&&isPlainObject(t.headers)&&(t.headers=Object.assign({},t.headers)),t.body&&isPlainObject(t.body)&&(t.body=Object.assign({},t.body)),t.transformRequest&&(t=t.transformRequest(t)||t);var r=new Task$2(this.type,t);return this._queue.push(r),1===this._queue.length&&this._processTask(),r.promise}},{key:"cancel",value:(t=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map((function(e){return e.cancel()})).concat(this._alive.map((function(e){return e.cancel()}))),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,sleep();case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;this._currentTask=this._queue.shift(),this._currentTask&&(this._currentTask.alive&&this._alive.push(this._currentTask),this._currentTask.exec().catch((function(){})).finally((function(){e._processTask()})))}}],[{key:"isFetchSupport",value:function(){return FetchLoader.isSupported()}}]),e}(),EVENT={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT"},Logger$2=function(){function e(t){_classCallCheck$1(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]")}return _createClass$1(e,[{key:"debug",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).debug.apply(t,[this._prefix].concat(n))}}},{key:"log",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).log.apply(t,[this._prefix].concat(n))}}},{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}},{key:"error",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).error.apply(t,[this._prefix].concat(n))}}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();_defineProperty$1(Logger$2,"disabled",!0);var GapService=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"_prevCurrentTime",0)}return _createClass$1(e,[{key:"do",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(e){var i=e.currentTime,o=0;if(this._prevCurrentTime===i){var a=Buffer.info(Buffer.get(e),i);if(!a.buffers.length)return;r&&a.nextStart||a.nextStart&&a.nextStart-i<t?o=a.nextStart+.1:a.end&&a.end-i>n&&!e.seeking&&(o=i+.1)}this._prevCurrentTime=i,o&&i!==o&&(e.currentTime=o)}}}]),e}(),internalMetadata={exports:{}},fails$F=fails$1m,arrayBufferNonExtensible=fails$F((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),fails$E=fails$1m,isObject$n=isObject$K,classof$b=classofRaw$3,ARRAY_BUFFER_NON_EXTENSIBLE=arrayBufferNonExtensible,$isExtensible=Object.isExtensible,FAILS_ON_PRIMITIVES$3=fails$E((function(){$isExtensible(1)})),objectIsExtensible=FAILS_ON_PRIMITIVES$3||ARRAY_BUFFER_NON_EXTENSIBLE?function(e){return!!isObject$n(e)&&((!ARRAY_BUFFER_NON_EXTENSIBLE||"ArrayBuffer"!=classof$b(e))&&(!$isExtensible||$isExtensible(e)))}:$isExtensible,fails$D=fails$1m,freezing=!fails$D((function(){return Object.isExtensible(Object.preventExtensions({}))})),$$$=_export$1,uncurryThis$K=functionUncurryThis$1,hiddenKeys$6=hiddenKeys$c,isObject$m=isObject$K,hasOwn$h=hasOwnProperty_1$1,defineProperty$b=objectDefineProperty$1.f,getOwnPropertyNamesModule$2=objectGetOwnPropertyNames$1,getOwnPropertyNamesExternalModule=objectGetOwnPropertyNamesExternal$1,isExtensible=objectIsExtensible,uid$4=uid$9,FREEZING=freezing,REQUIRED=!1,METADATA=uid$4("meta"),id$1=0,setMetadata=function(e){defineProperty$b(e,METADATA,{value:{objectID:"O"+id$1++,weakData:{}}})},fastKey$1=function(e,t){if(!isObject$m(e))return"symbol"==_typeof$3(e)?e:("string"==typeof e?"S":"P")+e;if(!hasOwn$h(e,METADATA)){if(!isExtensible(e))return"F";if(!t)return"E";setMetadata(e)}return e[METADATA].objectID},getWeakData=function(e,t){if(!hasOwn$h(e,METADATA)){if(!isExtensible(e))return!0;if(!t)return!1;setMetadata(e)}return e[METADATA].weakData},onFreeze=function(e){return FREEZING&&REQUIRED&&isExtensible(e)&&!hasOwn$h(e,METADATA)&&setMetadata(e),e},enable=function(){meta$1.enable=function(){},REQUIRED=!0;var e=getOwnPropertyNamesModule$2.f,t=uncurryThis$K([].splice),r={};r[METADATA]=1,e(r).length&&(getOwnPropertyNamesModule$2.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===METADATA){t(n,i,1);break}return n},$$$({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:getOwnPropertyNamesExternalModule.f}))},meta$1=internalMetadata.exports={enable:enable,fastKey:fastKey$1,getWeakData:getWeakData,onFreeze:onFreeze};hiddenKeys$6[METADATA]=!0;var $$_=_export$1,global$E=global$1T,uncurryThis$J=functionUncurryThis$1,isForced$5=isForced_1$1,redefine$1=redefine$h.exports,InternalMetadataModule=internalMetadata.exports,iterate$4=iterate$6,anInstance$3=anInstance$9,isCallable$p=isCallable$Q,isObject$l=isObject$K,fails$C=fails$1m,checkCorrectnessOfIteration$2=checkCorrectnessOfIteration$6,setToStringTag$3=setToStringTag$b,inheritIfRequired$3=inheritIfRequired$8,collection$2=function(e,t,r){var n=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),o=n?"set":"add",a=global$E[e],s=a&&a.prototype,u=a,c={},l=function(e){var t=uncurryThis$J(s[e]);redefine$1(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!isObject$l(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return i&&!isObject$l(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!isObject$l(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(isForced$5(e,!isCallable$p(a)||!(i||s.forEach&&!fails$C((function(){(new a).entries().next()})))))u=r.getConstructor(t,e,n,o),InternalMetadataModule.enable();else if(isForced$5(e,!0)){var d=new u,f=d[o](i?{}:-0,1)!=d,h=fails$C((function(){d.has(1)})),p=checkCorrectnessOfIteration$2((function(e){new a(e)})),g=!i&&fails$C((function(){for(var e=new a,t=5;t--;)e[o](t,t);return!e.has(-0)}));p||((u=t((function(e,t){anInstance$3(e,s);var r=inheritIfRequired$3(new a,e,u);return null!=t&&iterate$4(t,r[o],{that:r,AS_ENTRIES:n}),r}))).prototype=s,s.constructor=u),(h||g)&&(l("delete"),l("has"),n&&l("get")),(g||f)&&l(o),i&&s.clear&&delete s.clear}return c[e]=u,$$_({global:!0,forced:u!=a},c),setToStringTag$3(u,e),i||r.setStrong(u,e,n),u},defineProperty$a=objectDefineProperty$1.f,create$2=objectCreate$1,redefineAll=redefineAll$4,bind$8=functionBindContext$1,anInstance$2=anInstance$9,iterate$3=iterate$6,defineIterator=defineIterator$3,setSpecies$4=setSpecies$8,DESCRIPTORS$m=descriptors$1,fastKey=internalMetadata.exports.fastKey,InternalStateModule$3=internalState$1,setInternalState$2=InternalStateModule$3.set,internalStateGetterFor=InternalStateModule$3.getterFor,collectionStrong$2={getConstructor:function(e,t,r,n){var i=e((function(e,i){anInstance$2(e,o),setInternalState$2(e,{type:t,index:create$2(null),first:void 0,last:void 0,size:0}),DESCRIPTORS$m||(e.size=0),null!=i&&iterate$3(i,e[n],{that:e,AS_ENTRIES:r})})),o=i.prototype,a=internalStateGetterFor(t),s=function(e,t,r){var n,i,o=a(e),s=u(e,t);return s?s.value=r:(o.last=s={index:i=fastKey(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=s),n&&(n.next=s),DESCRIPTORS$m?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},u=function(e,t){var r,n=a(e),i=fastKey(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return redefineAll(o,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,DESCRIPTORS$m?e.size=0:this.size=0},delete:function(e){var t=this,r=a(t),n=u(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),DESCRIPTORS$m?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=a(this),n=bind$8(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),redefineAll(o,r?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),DESCRIPTORS$m&&defineProperty$a(o,"size",{get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=internalStateGetterFor(t),o=internalStateGetterFor(n);defineIterator(e,t,(function(e,t){setInternalState$2(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),setSpecies$4(t)}},collection$1=collection$2,collectionStrong$1=collectionStrong$2;collection$1("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),collectionStrong$1);var SeiService=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_seiSet",new Set),this.emitter=t,t.on(EVENT.SEI,(function(e){e&&r._seiSet.add(e)}))}return _createClass$1(e,[{key:"throw",value:function(e){var t=this;if(null!=e&&this._seiSet.size){var r=e-.2,n=e+.2,i=[];this._seiSet.forEach((function(e){e.time>=r&&e.time<=n&&i.push(e)})),i.forEach((function(e){t._seiSet.delete(e),t.emitter.emit(EVENT.SEI_IN_TIME,e)}))}}},{key:"reset",value:function(){this._seiSet.clear()}}]),e}(),BandwidthService=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"_chunkSpeeds",[]),_defineProperty$1(this,"_speeds",[])}return _createClass$1(e,[{key:"addRecord",value:function(e,t){e&&t&&(this._speeds.push(8e3*e/t),this._speeds=this._speeds.slice(-3))}},{key:"addChunkRecord",value:function(e,t){e&&t&&(this._chunkSpeeds.push(8e3*e/t),this._chunkSpeeds=this._chunkSpeeds.slice(-10))}},{key:"getAvgSpeed",value:function(){return this._chunkSpeeds.length||this._speeds.length?this._speeds.length?this._speeds.reduce((function(e,t){return e+t}))/this._speeds.length:this._chunkSpeeds.reduce((function(e,t){return e+t}))/this._chunkSpeeds.length:0}},{key:"getLatestSpeed",value:function(){return this._chunkSpeeds.length||this._speeds.length?this._speeds.length?this._speeds[this._speeds.length-1]:this._chunkSpeeds[this._chunkSpeeds.length-1]:0}},{key:"reset",value:function(){this._chunkSpeeds=[],this._speeds=[]}}]),e}(),$$Z=_export$1,$includes=arrayIncludes$1.includes,addToUnscopables=addToUnscopables$4;$$Z({target:"Array",proto:!0},{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var global$D=global$1T,isRegExp$2=isRegexp$1,TypeError$5=global$D.TypeError,notARegexp=function(e){if(isRegExp$2(e))throw TypeError$5("The method doesn't accept regular expressions");return e},wellKnownSymbol$l=wellKnownSymbol$O,MATCH$2=wellKnownSymbol$l("match"),correctIsRegexpLogic=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[MATCH$2]=!1,"/./"[e](t)}catch(n){}}return!1},$$Y=_export$1,uncurryThis$I=functionUncurryThis$1,notARegExp$1=notARegexp,requireObjectCoercible$c=requireObjectCoercible$l,toString$l=toString$A,correctIsRegExpLogic$1=correctIsRegexpLogic,stringIndexOf$2=uncurryThis$I("".indexOf);$$Y({target:"String",proto:!0,forced:!correctIsRegExpLogic$1("includes")},{includes:function(e){return!!~stringIndexOf$2(toString$l(requireObjectCoercible$c(this)),toString$l(notARegExp$1(e)),arguments.length>1?arguments[1]:void 0)}});var global$C=global$1T,globalIsFinite=global$C.isFinite,numberIsFinite$1=Number.isFinite||function(e){return"number"==typeof e&&globalIsFinite(e)},$$X=_export$1,numberIsFinite=numberIsFinite$1;$$X({target:"Number",stat:!0},{isFinite:numberIsFinite});var TrackType={VIDEO:"video",AUDIO:"audio",METADATA:"metadata"},VideoCodecType={AVC:"avc",HEVC:"hevc"},AudioCodecType={AAC:"aac",G711PCMA:"g7110a",G711PCMU:"g7110m"},WarningType={LARGE_AV_SHIFT:"LARGE_AV_SHIFT",LARGE_VIDEO_GAP:"LARGE_VIDEO_GAP",LARGE_VIDEO_GAP_BETWEEN_CHUNK:"LARGE_VIDEO_GAP_BETWEEN_CHUNK",LARGE_AUDIO_GAP:"LARGE_AUDIO_GAP",AUDIO_FILLED:"AUDIO_FILLED",AUDIO_DROPPED:"AUDIO_DROPPED"},isBrowser="undefined"!=typeof window,ua=isBrowser&&navigator.userAgent.toLocaleLowerCase(),isSafari=isBrowser&&/^((?!chrome|android).)*safari/.test(ua),isFirefox=isBrowser&&ua.includes("firefox"),isAndroid=isBrowser&&ua.includes("android"),AAC=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"getRateIndexByRate",value:function(t){return e.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,r){for(var n=t.length,i=0;i+2<n&&(255!==t[i]||240!=(246&t[i+1]));)i++;if(!(i>=n)){var o=i,a=[],s=(60&t[i+2])>>>2,u=e.FREQ[s];if(!u)throw new Error("Invalid sampling index: ".concat(s));for(var c,l,d=1+((192&t[i+2])>>>6),f=(1&t[i+2])<<2|(192&t[i+3])>>>6,h=e._getConfig(s,f,d),p=h.config,g=h.codec,y=0,v=e.getFrameDuration(u);i+7<n;)if(255===t[i]&&240==(246&t[i+1])){if(n-i<(l=(3&t[i+3])<<11|t[i+4]<<3|(224&t[i+5])>>5))break;c=2*(1&~t[i+1]),a.push({pts:r+y*v,data:t.subarray(i+7+c,i+l)}),y++,i+=l}else i++;return{skip:o,remaining:i>=n?void 0:t.subarray(i),frames:a,samplingFrequencyIndex:s,sampleRate:u,objectType:d,channelCount:f,codec:g,config:p,originCodec:"mp4a.40.".concat(d)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var r=t[0]>>>3,n=(7&t[0])<<1|t[1]>>>7,i=(120&t[1])>>>3,o=e.FREQ[n];if(!o)throw new Error("Invalid sampling index: ".concat(n));var a=e._getConfig(n,i,r);return{samplingFrequencyIndex:n,sampleRate:o,objectType:r,channelCount:i,config:a.config,codec:a.codec,originCodec:"mp4a.40.".concat(r)}}}},{key:"getFrameDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return 1024*t/e}},{key:"_getConfig",value:function(e,t,r){var n,i,o=[];return isFirefox?e>=6?(n=5,i=e-3):(n=2,i=e):isAndroid?(n=2,i=e):(n=2===r||5===r?r:5,i=e,e>=6?i=e-3:1===t&&(n=2,i=e)),o[0]=n<<3,o[0]|=(14&e)>>1,o[1]=(1&e)<<7,o[1]|=t<<3,5===n&&(o[1]|=(14&i)>>1,o[2]=(1&i)<<7,o[2]|=8,o[3]=0),{config:o,codec:"mp4a.40.".concat(n)}}},{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}();_defineProperty$1(AAC,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var AudioSample=function e(t,r,n){_classCallCheck$1(this,e),_defineProperty$1(this,"duration",1024),_defineProperty$1(this,"flag",{dependsOn:2,isNonSyncSample:0}),this.originPts=this.pts=this.dts=t,this.data=r,this.size=r.byteLength,n&&(this.duration=n)},LARGE_AV_FIRST_FRAME_GAP$1=500,AUDIO_GAP_OVERLAP_THRESHOLD_COUNT$1=3,MAX_SILENT_FRAME_DURATION$1=1e3,AUDIO_EXCETION_LOG_EMIT_DURATION$1=5e3,MAX_VIDEO_FRAME_DURATION$1=1e3,MAX_DTS_DELTA_WITH_NEXT_CHUNK$1=200,VIDEO_EXCETION_LOG_EMIT_DURATION=5e3,TRACK_BREACKED_CHECK_TIME=5,FlvFixer=function(){function e(t,r,n){_classCallCheck$1(this,e),this.videoTrack=t,this.audioTrack=r,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0}return _createClass$1(e,[{key:"fix",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Math.round(1e3*t);var i=this.videoTrack,o=this.audioTrack;if(!r&&n||(this._videoLastSample=null,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0),r&&!n&&(this._baseDtsInited=!1),this._baseDtsInited||this._calculateBaseDts(o,i),this._baseDtsInited){if(!n&&t&&(this._audioNextPts=this._videoNextDts=t),this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(o),this._fixVideo(i),this.metadataTrack.exist()){var a=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/a})),this.metadataTrack.flvScriptSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/a}))}i.samples.length&&(i.baseMediaDecodeTime=i.samples[0].dts),o.samples.length&&(o.baseMediaDecodeTime=o.samples[0].pts*o.timescale/1e3)}}},{key:"_fixVideo",value:function(e){var t=this,r=e.samples;if(r.length){var n;if(r.forEach((function(e){e.dts-=t._baseDts,e.pts-=t._baseDts})),e.fpsNum&&e.fpsDen)n=e.timescale*(e.fpsDen/e.fpsNum);else{var i=e.samples[0],o=e.samples[r.length-1];n=Math.floor((o.dts-i.dts)/(r.length-1))}var a=r.pop();if(this._videoLastSample&&r.unshift(this._videoLastSample),this._videoLastSample=a,r.length){if(void 0===this._videoNextDts){var s=r[0];this._videoNextDts=s.dts}var u=r.length,c=0,l=r[0],d=this._videoNextDts-l.dts;if(Math.abs(d)>MAX_DTS_DELTA_WITH_NEXT_CHUNK$1){var f;if(Math.abs(l.dts-this._lastVideoExceptionChunkFirstDtsDot)>VIDEO_EXCETION_LOG_EMIT_DURATION)this._lastVideoExceptionChunkFirstDtsDot=l.dts,e.warnings.push({type:WarningType.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts,firstSampleDts:l.dts,nextSampleDts:null===(f=r[1])||void 0===f?void 0:f.dts,sampleDuration:d});this._videoTimestampBreak>=TRACK_BREACKED_CHECK_TIME?(this._videoNextDts=l.dts,this._videoTimestampBreak=0):(l.dts+=d,l.pts+=d)}for(var h=0;h<u;h++){var p=r[h].dts,g=r[h+1];((c=h<u-1?g.dts-p:a?a.dts-p:n)>MAX_VIDEO_FRAME_DURATION$1||c<0)&&(this._videoTimestampBreak++,Math.abs(p-this._lastVideoExceptionLargeGapDot)>VIDEO_EXCETION_LOG_EMIT_DURATION&&(this._lastVideoExceptionLargeGapDot=p,e.warnings.push({type:WarningType.LARGE_VIDEO_GAP,time:p/e.timescale,dts:p,originDts:r[h].originDts,nextDts:this._videoNextDts,sampleDuration:c,refSampleDuration:n})),c=n),r[h].duration=c,this._videoNextDts+=c}}}}},{key:"_fixAudio",value:function(e){var t=this,r=e.samples;r.length&&(r.forEach((function(e){e.dts=e.pts-=t._baseDts})),this._doFixAudioInternal(e,r,1e3))}},{key:"_calculateBaseDts",value:function(e,t){var r=e.samples,n=t.samples;if(!r.length&&!n.length)return!1;var i=1/0,o=1/0;r.length&&(e.baseDts=i=r[0].pts),n.length&&(t.baseDts=o=n[0].dts),this._baseDts=Math.min(i,o);var a=o-i;return Number.isFinite(a)&&Math.abs(a)>LARGE_AV_FIRST_FRAME_GAP$1&&t.warnings.push({type:WarningType.LARGE_AV_SHIFT,videoBaseDts:o,audioBasePts:i,baseDts:this._baseDts,delta:a}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){if(this._baseDtsInited&&this._videoTimestampBreak&&this._audioTimestampBreak){if(!this._calculateBaseDts(this.audioTrack,this.videoTrack))return;this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts),this._videoLastSample=null,this._videoTimestampBreak=0,this._audioTimestampBreak=0}}},{key:"_doFixAudioInternal",value:function(e,t,r){e.sampleDuration||(e.sampleDuration=e.codecType===AudioCodecType.AAC?AAC.getFrameDuration(e.timescale,r):this._getG711Duration(e));var n=e.sampleDuration,i=e.codecType===AudioCodecType.AAC?1024:n*e.timescale/1e3;if(void 0===this._audioNextPts){var o=t[0];this._audioNextPts=o.pts}for(var a=0;a<t.length;a++){var s=this._audioNextPts,u=t[a],c=u.pts-s;if(0===a&&this._audioTimestampBreak>=TRACK_BREACKED_CHECK_TIME&&(s=this._audioNextPts=u.dts,c=0,this._audioTimestampBreak=0),!this._audioTimestampBreak&&c>=AUDIO_GAP_OVERLAP_THRESHOLD_COUNT$1*n&&c<=MAX_SILENT_FRAME_DURATION$1&&!isSafari){var l=this._getSilentFrame(e)||t[0].data.subarray(),d=Math.floor(c/n);Math.abs(u.pts-this._lastAudioExceptionGapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION$1&&(this._lastAudioExceptionGapDot=u.pts,e.warnings.push({type:WarningType.AUDIO_FILLED,pts:u.pts,originPts:u.originPts,count:d,nextPts:s,refSampleDuration:n}));for(var f=0;f<d;f++){var h=new AudioSample(Math.floor(this._audioNextPts+n)-Math.floor(this._audioNextPts),l,i);h.originPts=Math.floor(this._baseDts+s),t.splice(a,0,h),this._audioNextPts+=n,a++}a--}else c<=-AUDIO_GAP_OVERLAP_THRESHOLD_COUNT$1*n&&c>=-1*MAX_SILENT_FRAME_DURATION$1?(Math.abs(u.pts-this._lastAudioExceptionOverlapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION$1&&(this._lastAudioExceptionOverlapDot=u.pts,e.warnings.push({type:WarningType.AUDIO_DROPPED,pts:u.pts,originPts:u.originPts,nextPts:s,refSampleDuration:n})),t.splice(a,1),a--):(Math.abs(c)>MAX_SILENT_FRAME_DURATION$1&&(this._audioTimestampBreak++,Math.abs(u.pts-this._lastAudioExceptionLargeGapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION$1&&(this._lastAudioExceptionLargeGapDot=u.pts,e.warnings.push({type:WarningType.LARGE_AUDIO_GAP,time:u.pts/1e3,pts:u.pts,originPts:u.originPts,nextPts:s,sampleDuration:c,refSampleDuration:n}))),u.dts=u.pts=s,u.duration=i,this._audioNextPts+=n)}}},{key:"_getG711Duration",value:function(e){var t=e.sampleSize,r=e.channelCount,n=e.sampleRate,i=e.samples[0];if(i)return 2*i.data.byteLength/r/(t/8)/n*1e3}},{key:"_getSilentFrame",value:function(e){return e.codecType===AudioCodecType.AAC?AAC.getSilentFrame(e.codec,e.channelCount):new Uint8Array(8*e.sampleDuration*e.channelCount)}}]),e}();function concatUint8Array(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t.filter(Boolean);var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),i=0;return t.forEach((function(e){n.set(e,i),i+=e.byteLength})),n}var MAX_SIZE=Math.pow(2,32);function readBig16(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<8)+(e[t+1]||0)}function readBig24(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<16)+(e[t+1]<<8)+(e[t+2]||0)}function readBig32(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]||0)}function readBig64(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return readBig32(e,t)*MAX_SIZE+readBig32(e,t+4)}function getAvcCodec(e){for(var t,r="avc1.",n=0;n<3;n++)(t=e[n].toString(16)).length<2&&(t="0".concat(t)),r+=t;return r}var UTF8=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"decode",value:function(t){for(var r=[],n=t,i=0,o=t.length;i<o;)if(n[i]<128)r.push(String.fromCharCode(n[i])),++i;else{if(n[i]<192);else if(n[i]<224){if(e._checkContinuation(n,i,1)){var a=(31&n[i])<<6|63&n[i+1];if(a>=128){r.push(String.fromCharCode(65535&a)),i+=2;continue}}}else if(n[i]<240){if(e._checkContinuation(n,i,2)){var s=(15&n[i])<<12|(63&n[i+1])<<6|63&n[i+2];if(s>=2048&&55296!=(63488&s)){r.push(String.fromCharCode(65535&s)),i+=3;continue}}}else if(n[i]<248&&e._checkContinuation(n,i,3)){var u=(7&n[i])<<18|(63&n[i+1])<<12|(63&n[i+2])<<6|63&n[i+3];if(u>65536&&u<1114112){u-=65536,r.push(String.fromCharCode(u>>>10|55296)),r.push(String.fromCharCode(1023&u|56320)),i+=4;continue}}r.push(String.fromCharCode(65533)),++i}return r.join("")}},{key:"_checkContinuation",value:function(e,t,r){var n=e;if(t+r<n.length){for(;r--;)if(128!=(192&n[++t]))return!1;return!0}return!1}}]),e}(),AMF=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parse",value:function(t){if(!(t.length<3)){var r={},n=e._parseValue(new DataView(t.buffer,t.byteOffset,t.byteLength)),i=e._parseValue(new DataView(t.buffer,t.byteOffset+n.size,t.byteLength-n.size));return r[n.data]=i.data,r}}},{key:"_parseValue",value:function(t){var r,n=t.byteLength,i=1,o=!1;switch(t.getUint8(0)){case 0:r=t.getFloat64(1),i+=8;break;case 1:r=!!t.getUint8(1),i+=1;break;case 2:var a=e._parseString(new DataView(t.buffer,t.byteOffset+i,t.byteLength-i));r=a.data,i+=a.size;break;case 3:r={};var s=0;for(9==(16777215&t.getUint32(n-4))&&(s=3);i<n-4;){var u=e._parseObject(new DataView(t.buffer,t.byteOffset+i,t.byteLength-i-s)),c=u.size,l=u.data;if(u.isEnd)break;r[l.name]=l.value,i+=c}if(i<=n-3)9===(16777215&t.getUint32(i-1))&&(i+=3);break;case 8:r={},i+=4;var d=0;for(9==(16777215&t.getUint32(n-4))&&(d=3);i<n-8;){var f=e._parseObject(new DataView(t.buffer,t.byteOffset+i,t.byteLength-i-d)),h=f.size,p=f.data;if(f.isEnd)break;r[p.name]=p.value,i+=h}if(i<=n-3)9===(16777215&t.getUint32(i-1))&&(i+=3);break;case 9:r=void 0,i=1,o=!0;break;case 10:r=[];var g=t.getUint32(1);i+=4;for(var y=0;y<g;y++){var v=e._parseValue(new DataView(t.buffer,t.byteOffset+i,t.byteLength-i)),m=v.data,_=v.size;r.push(m),i+=_}break;case 11:var b=t.getFloat64(i)+6e4*t.getInt16(i+8);r=new Date(b),i+=10;break;case 12:var A=t.getUint32(1);i+=4,r="",A>0&&(r=UTF8.decode(new Uint8Array(t.buffer,t.byteOffset+i,A))),i+=A;break;default:i=n}return{data:r,size:i,isEnd:o}}},{key:"_parseString",value:function(e){var t=e.getUint16(0),r="";return t>0&&(r=UTF8.decode(new Uint8Array(e.buffer,e.byteOffset+2,t))),{data:r,size:2+t}}},{key:"_parseObject",value:function(t){if(!(t.byteLength<3)){var r=e._parseString(t),n=e._parseValue(new DataView(t.buffer,t.byteOffset+r.size,t.byteLength-r.size));return{data:{name:r.data,value:n.data},size:r.size+n.size,isEnd:n.isEnd}}}}]),e}(),Logger$1=function(){function e(t){_classCallCheck$1(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]")}return _createClass$1(e,[{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();_defineProperty$1(Logger$1,"disabled",!0);var NALu=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parseAnnexB",value:function(e){for(var t=e.length,r=2,n=0;null!=e[r]&&1!==e[r];)r++;if((n=++r+2)>=t)return[];for(var i=[];n<t;)switch(e[n]){case 0:if(0!==e[n-1]){n+=2;break}if(0!==e[n-2]){n++;break}r!==n-2&&i.push(e.subarray(r,n-2));do{n++}while(1!==e[n]&&n<t);n=(r=n+1)+2;break;case 1:if(0!==e[n-1]||0!==e[n-2]){n+=3;break}r!==n-2&&i.push(e.subarray(r,n-2)),n=(r=n+1)+2;break;default:n+=3}return r<t&&i.push(e.subarray(r)),i}},{key:"parseAvcC",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!(e.length<4)){for(var r,n=e.length,i=[],o=0;o+t<n;)if(r=readBig32(e,o),3===t&&(r>>>=8),o+=t,r){if(o+r>n)break;i.push(e.subarray(o,o+r)),o+=r}return i}}},{key:"parseSEI",value:function(e){for(var t=e.length,r=1,n=0,i=0,o="";255===e[r];)n+=255,r++;for(n+=e[r++];255===e[r];)i+=255,r++;if(i+=e[r++],5===n&&t>r+16)for(var a=0;a<16;a++)o+=e[r].toString(16),r++;return{payload:e.subarray(r),type:n,size:i,uuid:o}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(!r.length)return e;var i=t-r.length,o=new Uint8Array(i),a=0;for(n=0;n<i;a++,n++)a===r[0]&&(a++,r.shift()),o[n]=e[a];return o}}]),e}(),ExpGolomb=function(){function e(t){if(_classCallCheck$1(this,e),_defineProperty$1(this,"_bytesAvailable",void 0),_defineProperty$1(this,"_bitsAvailable",0),_defineProperty$1(this,"_word",0),!t)throw new Error("ExpGolomb data params is required");this._data=t,this._bytesAvailable=t.byteLength,this._bytesAvailable&&this._loadWord()}return _createClass$1(e,[{key:"_loadWord",value:function(){var e=this._data.byteLength-this._bytesAvailable,t=Math.min(4,this._bytesAvailable);if(0===t)throw new Error("No bytes available");var r=new Uint8Array(4);r.set(this._data.subarray(e,e+t)),this._word=new DataView(r.buffer).getUint32(0),this._bitsAvailable=8*t,this._bytesAvailable-=t}},{key:"skipBits",value:function(e){if(this._bitsAvailable>e)this._word<<=e,this._bitsAvailable-=e;else{e-=this._bitsAvailable;var t=Math.floor(e/8);e-=8*t,this._bytesAvailable-=t,this._loadWord(),this._word<<=e,this._bitsAvailable-=e}}},{key:"readBits",value:function(e){if(e>32)throw new Error("Cannot read more than 32 bits");var t=Math.min(this._bitsAvailable,e),r=this._word>>>32-t;return this._bitsAvailable-=t,this._bitsAvailable>0?this._word<<=t:this._bytesAvailable>0&&this._loadWord(),(t=e-t)>0&&this._bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this._bitsAvailable;++e)if(0!=(this._word&2147483648>>>e))return this._word<<=e,this._bitsAvailable-=e,e;return this._loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r}}]),e}(),HEVC=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parseHEVCDecoderConfigurationRecord",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t.length<23)){r=r||{};for(var n,i,o,a,s,u=1+(3&t[21]),c=[],l=[],d=[],f=23,h=t[22],p=0;p<h;p++){o=63&t[f],a=t[f+1]<<8|t[f+2],f+=3;for(var g=0;g<a;g++)if(s=t[f]<<8|t[f+1],f+=2,s){switch(o){case 32:var y=t.subarray(f,f+s);n||(n=e.parseVPS(NALu.removeEPB(y),r)),d.push(y);break;case 33:var v=t.subarray(f,f+s);i||(i=e.parseSPS(NALu.removeEPB(v),r)),c.push(v);break;case 34:l.push(t.subarray(f,f+s))}f+=s}}return{hvcC:r,sps:i,spsArr:c,ppsArr:l,vpsArr:d,nalUnitSize:u}}}},{key:"parseVPS",value:function(t,r){r=r||{};var n=new ExpGolomb(t);n.readUByte(),n.readUByte(),n.readBits(12);var i=n.readBits(3);return r.numTemporalLayers=Math.max(r.numTemporalLayers||0,i+1),n.readBits(17),e._parseProfileTierLevel(n,i,r),r}},{key:"parseSPS",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=r||{};var n=new ExpGolomb(t);n.readUByte(),n.readUByte(),n.readBits(4);var i=n.readBits(3);r.numTemporalLayers=Math.max(i+1,r.numTemporalLayers||0),r.temporalIdNested=n.readBits(1),e._parseProfileTierLevel(n,i,r),n.readUEG();var o=r.chromaFormatIdc=n.readUEG(),a=420;o<=3&&(a=[0,420,422,444][o]);var s=0;3===o&&(s=n.readBits(1));var u,c,l,d,f=n.readUEG(),h=n.readUEG(),p=n.readBits(1);if(1===p&&(u=n.readUEG(),c=n.readUEG(),l=n.readUEG(),d=n.readUEG()),r.bitDepthLumaMinus8=n.readUEG(),r.bitDepthChromaMinus8=n.readUEG(),1===p){var g=1!==o&&2!==o||0!==s?1:2,y=1===o&&0===s?2:1;f-=g*(c+u),h-=y*(d+l)}return{codec:"hev1.1.6.L93.B0",width:f,height:h,chromaFormat:a,hvcC:r}}},{key:"_parseProfileTierLevel",value:function(e,t,r){var n=r.generalTierFlag||0;r.generalProfileSpace=e.readBits(2),r.generalTierFlag=Math.max(e.readBits(1),n),r.generalProfileIdc=Math.max(e.readBits(5),r.generalProfileIdc||0),r.generalProfileCompatibilityFlags=e.readBits(32),r.generalConstraintIndicatorFlags=[e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8)];var i=e.readBits(8);n<r.generalTierFlag?r.generalLevelIdc=i:r.generalLevelIdc=Math.max(i,r.generalLevelIdc||0);for(var o=[],a=[],s=0;s<t;s++)o[s]=e.readBits(1),a[s]=e.readBits(1);t>0&&e.readBits(2*(8-t));for(var u=0;u<t;u++)0!==o[u]&&(e.readBits(2),e.readBits(1),e.readBits(5),e.readBits(16),e.readBits(16),e.readBits(4),e.readBits(16),e.readBits(16),e.readBits(12)),0!==a[u]&&e.readBits(8)}}]),e}(),AVC=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parseAVCDecoderConfigurationRecord",value:function(t){if(!(t.length<7)){for(var r,n,i=1+(3&t[4]),o=[],a=[],s=6,u=31&t[5],c=0;c<u;c++)if(n=t[s]<<8|t[s+1],s+=2,n){var l=t.subarray(s,s+n);s+=n,o.push(l),r||(r=e.parseSPS(NALu.removeEPB(l)))}var d,f=t[s];s++;for(var h=0;h<f;h++)d=t[s]<<8|t[s+1],s+=2,d&&(a.push(t.subarray(s,s+d)),s+=d);return{sps:r,spsArr:o,ppsArr:a,nalUnitSize:i}}}},{key:"parseSPS",value:function(e){var t=new ExpGolomb(e);t.readUByte();var r=t.readUByte(),n=t.readUByte(),i=t.readUByte();t.skipUEG();var o=420;if(100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||144===r){var a=t.readUEG();if(a<=3&&(o=[0,420,422,444][a]),3===a&&t.skipBits(1),t.skipUEG(),t.skipUEG(),t.skipBits(1),t.readBool())for(var s=3!==a?8:12,u=0;u<s;u++)t.readBool()&&(u<6?t.skipScalingList(16):t.skipScalingList(64))}t.skipUEG();var c=t.readUEG();if(0===c)t.readUEG();else if(1===c){t.skipBits(1),t.skipUEG(),t.skipUEG();for(var l=t.readUEG(),d=0;d<l;d++)t.skipUEG()}t.skipUEG(),t.skipBits(1);var f=t.readUEG(),h=t.readUEG(),p=t.readBits(1);0===p&&t.skipBits(1),t.skipBits(1);var g,y,v,m,_,b=0,A=0,E=0,S=0;if(t.readBool()&&(b=t.readUEG(),A=t.readUEG(),E=t.readUEG(),S=t.readUEG()),t.readBool()){if(t.readBool())switch(t.readUByte()){case 1:g=[1,1];break;case 2:g=[12,11];break;case 3:g=[10,11];break;case 4:g=[16,11];break;case 5:g=[40,33];break;case 6:g=[24,11];break;case 7:g=[20,11];break;case 8:g=[32,11];break;case 9:g=[80,33];break;case 10:g=[18,11];break;case 11:g=[15,11];break;case 12:g=[64,33];break;case 13:g=[160,99];break;case 14:g=[4,3];break;case 15:g=[3,2];break;case 16:g=[2,1];break;case 255:g=[t.readUByte()<<8|t.readUByte(),t.readUByte()<<8|t.readUByte()]}if(t.readBool()&&t.readBool(),t.readBool()&&(t.readBits(4),t.readBool()&&t.readBits(24)),t.readBool()&&(t.readUEG(),t.readUEG()),t.readBool()){var T=t.readBits(32),$=t.readBits(32);y=t.readBool(),_=(v=$)/(m=2*T)}}return{codec:getAvcCodec(e.subarray(1,4)),profileIdc:r,profileCompatibility:n,levelIdc:i,chromaFormat:o,width:Math.ceil(16*(f+1)-2*(b+A)),height:(2-p)*(h+1)*16-(p?2:4)*(E+S),sarRatio:g,fpsNum:v,fpsDen:m,fps:_,fixedFrame:y}}}]),e}(),VideoSample=function(){function e(t,r,n){_classCallCheck$1(this,e),_defineProperty$1(this,"flag",{}),_defineProperty$1(this,"keyframe",!1),_defineProperty$1(this,"gopId",0),_defineProperty$1(this,"duration",0),_defineProperty$1(this,"size",0),_defineProperty$1(this,"units",[]),_defineProperty$1(this,"chromaFormat",420),this.originPts=this.pts=t,this.originDts=this.dts=r,n&&(this.units=n)}return _createClass$1(e,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),e}();function _createSuper$n(e){var t=_isNativeReflectConstruct$n();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Sample=function e(t,r){_classCallCheck$1(this,e),_defineProperty$1(this,"time",0),this.data=t,this.originPts=this.pts=r},FlvScriptSample=function(e){_inherits(r,e);var t=_createSuper$n(r);function r(){return _classCallCheck$1(this,r),t.apply(this,arguments)}return r}(Sample),SeiSample=function(e){_inherits(r,e);var t=_createSuper$n(r);function r(){return _classCallCheck$1(this,r),t.apply(this,arguments)}return r}(Sample),MetadataTrack=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"id",3),_defineProperty$1(this,"type",TrackType.METADATA),_defineProperty$1(this,"timescale",0),_defineProperty$1(this,"flvScriptSamples",[]),_defineProperty$1(this,"seiSamples",[])}return _createClass$1(e,[{key:"exist",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length||!this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length)}}]),e}(),VideoTrack=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"id",1),_defineProperty$1(this,"type",TrackType.VIDEO),_defineProperty$1(this,"codecType",VideoCodecType.AVC),_defineProperty$1(this,"pid",-1),_defineProperty$1(this,"hvcC",void 0),_defineProperty$1(this,"codec",""),_defineProperty$1(this,"timescale",0),_defineProperty$1(this,"formatTimescale",0),_defineProperty$1(this,"sequenceNumber",0),_defineProperty$1(this,"baseMediaDecodeTime",0),_defineProperty$1(this,"baseDts",0),_defineProperty$1(this,"duration",0),_defineProperty$1(this,"warnings",[]),_defineProperty$1(this,"samples",[]),_defineProperty$1(this,"pps",[]),_defineProperty$1(this,"sps",[]),_defineProperty$1(this,"vps",[]),_defineProperty$1(this,"fpsNum",0),_defineProperty$1(this,"fpsDen",0),_defineProperty$1(this,"sarRatio",[]),_defineProperty$1(this,"width",0),_defineProperty$1(this,"height",0),_defineProperty$1(this,"nalUnitSize",4),_defineProperty$1(this,"present",!1),_defineProperty$1(this,"ext",void 0)}return _createClass$1(e,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"exist",value:function(){return!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}}]),e}(),AudioTrack=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"id",2),_defineProperty$1(this,"type",TrackType.AUDIO),_defineProperty$1(this,"codecType",AudioCodecType.AAC),_defineProperty$1(this,"pid",-1),_defineProperty$1(this,"codec",""),_defineProperty$1(this,"sequenceNumber",0),_defineProperty$1(this,"sampleDuration",0),_defineProperty$1(this,"timescale",0),_defineProperty$1(this,"formatTimescale",0),_defineProperty$1(this,"baseMediaDecodeTime",0),_defineProperty$1(this,"duration",0),_defineProperty$1(this,"warnings",[]),_defineProperty$1(this,"samples",[]),_defineProperty$1(this,"baseDts",0),_defineProperty$1(this,"sampleSize",16),_defineProperty$1(this,"sampleRate",0),_defineProperty$1(this,"channelCount",0),_defineProperty$1(this,"objectType",0),_defineProperty$1(this,"sampleRateIndex",0),_defineProperty$1(this,"config",[]),_defineProperty$1(this,"present",!1),_defineProperty$1(this,"ext",void 0)}return _createClass$1(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}}]),e}(),logger$8=new Logger$1("FlvDemuxer"),FlvDemuxer=function(){function e(t,r,n){_classCallCheck$1(this,e),_defineProperty$1(this,"_headerParsed",!1),_defineProperty$1(this,"_remainingData",null),_defineProperty$1(this,"_gopId",0),_defineProperty$1(this,"_needAddMetaBeforeKeyFrameNal",!0),this.videoTrack=t||new VideoTrack,this.audioTrack=r||new AudioTrack,this.metadataTrack=n||new MetadataTrack,this._fixer=new FlvFixer(this.videoTrack,this.audioTrack,this.metadataTrack)}return _createClass$1(e,[{key:"demux",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.audioTrack,o=this.videoTrack,a=this.metadataTrack;if(!r&&n||(this._remainingData=null,this._headerParsed=!1),r?(o.reset(),i.reset(),a.reset()):(o.samples=[],i.samples=[],a.seiSamples=[],a.flvScriptSamples=[],o.warnings=[],i.warnings=[],this._remainingData&&(t=concatUint8Array(this._remainingData,t),this._remainingData=null)),!t.length)return{videoTrack:o,audioTrack:i,metadataTrack:a};var s=0;if(!this._headerParsed){if(!e.probe(t))throw new Error("Invalid flv file");i.present=(4&t[4])>>>2!=0,o.present=0!=(1&t[4]),this._headerParsed=!0,s=readBig32(t,5)+4}for(var u,c,l,d,f,h=t.length;s+15<h&&(u=t[s],!(s+15+(c=t[s+1]<<16|t[s+2]<<8|t[s+3])>h));)l=(t[s+7]<<24>>>0)+(t[s+4]<<16)+(t[s+5]<<8)+t[s+6],s+=11,d=t.subarray(s,s+c),8===u?this._parseAudio(d,l):9===u?this._parseVideo(d,l):18===u?this._parseScript(d,l):logger$8.warn("Invalid tag type: ".concat(u)),(f=readBig32(t,s+=c))!==11+c&&logger$8.warn("Invalid PrevTagSize ".concat(f," (").concat(11+c,")")),s+=4;return s<h&&(this._remainingData=t.subarray(s)),i.formatTimescale=o.formatTimescale=o.timescale=a.timescale=1e3,i.timescale=i.sampleRate||0,!i.exist()&&i.hasSample()&&i.reset(),!o.exist()&&o.hasSample()&&o.reset(),{videoTrack:o,audioTrack:i,metadataTrack:a}}},{key:"fix",value:function(e,t,r){return this._fixer.fix(e,t,r),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(e,t,r,n){return this.demux(e,t,r),this.fix(n,t,r)}},{key:"_parseAudio",value:function(t,r){if(t.length){var n=(240&t[0])>>>4,i=this.audioTrack;if(10!==n&&7!==n&&8!==n)return logger$8.warn("Unsupported sound format: ".concat(n)),void i.reset();if(10!==n){var o=(12&t[0])>>2,a=(2&t[0])>>1,s=1&t[0];i.sampleRate=e.AUDIO_RATE[o],i.sampleSize=a?16:8,i.channelCount=s+1}10===n?this._parseAac(t,r):this._parseG711(t,r,n)}}},{key:"_parseG711",value:function(e,t,r){var n=this.audioTrack;n.codecType=7===r?AudioCodecType.G711PCMA:AudioCodecType.G711PCMU,n.sampleRate=8e3,n.codec=n.codecType,n.samples.push(new AudioSample(t,e.subarray(1)))}},{key:"_parseAac",value:function(e,t){var r=this.audioTrack;if(r.codecType=AudioCodecType.AAC,0===e[1]){var n=AAC.parseAudioSpecificConfig(e.subarray(2));n?(r.codec=n.codec,r.channelCount=n.channelCount,r.sampleRate=n.sampleRate,r.config=n.config,r.objectType=n.objectType,r.sampleRateIndex=n.samplingFrequencyIndex):(r.reset(),logger$8.warn("Cannot parse AudioSpecificConfig",e))}else if(1===e[1]){if(null==t)return;r.samples.push(new AudioSample(t,e.subarray(2)))}else logger$8.warn("Unknown AACPacketType: ".concat(e[1]))}},{key:"_parseVideo",value:function(e,t){var r=this;if(!(e.length<6)){var n=(240&e[0])>>>4,i=15&e[0],o=this.videoTrack;if(7!==i&&12!==i)return o.reset(),void logger$8.warn("Unsupported codecId: ".concat(i));var a=12===i;o.codecType=a?VideoCodecType.HEVC:VideoCodecType.AVC;var s=e[1],u=(e[2]<<16|e[3]<<8|e[4])<<8>>8;if(0===s){var c=e.subarray(5),l=a?HEVC.parseHEVCDecoderConfigurationRecord(c):AVC.parseAVCDecoderConfigurationRecord(c);if(l){var d=l.hvcC,f=l.sps,h=l.ppsArr,p=l.spsArr,g=l.vpsArr,y=l.nalUnitSize;d&&(o.hvcC=o.hvcC||d),f&&(o.codec=f.codec,o.width=f.width,o.height=f.height,o.sarRatio=f.sarRatio,o.fpsNum=f.fpsNum,o.fpsDen=f.fpsDen),p.length&&(o.sps=p),h.length&&(o.pps=h),g&&g.length&&(o.vps=g),y&&(o.nalUnitSize=y)}else logger$8.warn("Cannot parse ".concat(a?"HEVC":"AVC","DecoderConfigurationRecord"),e)}else if(1===s){var v=NALu.parseAvcC(e.subarray(5),o.nalUnitSize);if((v=this._checkAddMetaNalToUnits(a,v,o))&&v.length){var m=new VideoSample(t+u,t,v);1===n&&m.setToKeyframe(),o.samples.push(m),v.forEach((function(e){var n=a?e[0]>>>1&63:31&e[0];switch(n){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!a&&5!==n||a&&5===n)break;m.setToKeyframe();break;case 6:case 39:case 40:if(!a&&6!==n||a&&6===n)break;r.metadataTrack.seiSamples.push(new SeiSample(NALu.parseSEI(NALu.removeEPB(e)),t+u))}})),m.keyframe&&this._gopId++,m.gopId=this._gopId}else logger$8.warn("Cannot parse NALUs",e)}else 2===s||logger$8.warn("Unknown AVCPacketType: ".concat(s))}}},{key:"_checkAddMetaNalToUnits",value:function(e,t,r){return e&&this._needAddMetaBeforeKeyFrameNal?t.map((function(e){return e[0]>>>1&63})).includes(32)?(this._needAddMetaBeforeKeyFrameNal=!1,t):(t.unshift(r.pps[0]),t.unshift(r.sps[0]),t.unshift(r.vps[0]),t.filter(Boolean)):(this._needAddMetaBeforeKeyFrameNal=!1,t)}},{key:"_parseScript",value:function(e,t){this.metadataTrack.flvScriptSamples.push(new FlvScriptSample(AMF.parse(e),t))}}],[{key:"probe",value:function(e){return 70===e[0]&&76===e[1]&&86===e[2]&&1===e[3]&&readBig32(e,5)>=9}}]),e}();function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}_defineProperty$1(FlvDemuxer,"AUDIO_RATE",[5500,11e3,22e3,44e3]);var LARGE_AV_FIRST_FRAME_GAP=45e3,AUDIO_GAP_OVERLAP_THRESHOLD_COUNT=3,MAX_SILENT_FRAME_DURATION=9e4,AUDIO_EXCETION_LOG_EMIT_DURATION=45e4,MAX_VIDEO_FRAME_DURATION=9e4,MAX_DTS_DELTA_WITH_NEXT_CHUNK=45e3,TsFixer=function(){function e(t,r,n){_classCallCheck$1(this,e),this.videoTrack=t,this.audioTrack=r,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=!1,this._videoTimestampBreak=!1,this._lastAudioExceptionGapDot=0,this._lastAudioExceptionOverlapDot=0,this._lastAudioExceptionLargeGapDot=0}return _createClass$1(e,[{key:"fix",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Math.round(9e4*t);var i=this.videoTrack,o=this.audioTrack,a=i.samples,s=o.samples;if(a.length||s.length){var u=a[0],c=s[0],l=0;if(a.length&&s.length&&(l=u.dts-c.pts),this._baseDtsInited||this._calculateBaseDts(this.audioTrack,this.videoTrack),r&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=t),!n){this._videoNextDts=l>0?t+l:t,this._audioNextPts=l>0?t:t-l;var d=u?u.dts-this._baseDts-this._videoNextDts:0,f=c?c.pts-this._baseDts-this._audioNextPts:0;Math.abs(d||f)>MAX_VIDEO_FRAME_DURATION&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=t)}if(this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(o),this._fixVideo(i),this.metadataTrack.exist()){var h=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/h}))}i.samples.length&&(i.baseMediaDecodeTime=i.samples[0].dts),o.samples.length&&(o.baseMediaDecodeTime=o.samples[0].pts*o.timescale/9e4)}}},{key:"_fixVideo",value:function(e){var t=this,r=e.samples;if(r.length){if(r.forEach((function(e){e.dts-=t._baseDts,e.pts-=t._baseDts})),void 0===this._videoNextDts){var n=r[0];this._videoNextDts=n.dts}var i,o,a=r.length,s=0,u=r[0],c=r[1],l=this._videoNextDts-u.dts;if(Math.abs(l)>MAX_DTS_DELTA_WITH_NEXT_CHUNK)u.dts+=l,u.pts+=l,this._videoNextDts-=l,e.warnings.push({type:WarningType.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts,firstSampleDts:u.dts,nextSampleDts:null===(i=r[1])||void 0===i?void 0:i.dts,sampleDuration:l}),c&&Math.abs(c.dts-u.dts)>MAX_VIDEO_FRAME_DURATION&&(this._videoTimestampBreak=!0,r.forEach((function(e,t){0!==t&&(e.dts+=l,e.pts+=l)})));if(e.fpsNum&&e.fpsDen)o=e.timescale*(e.fpsDen/e.fpsNum);else{var d=e.samples[0],f=e.samples[a-1];o=1===a?9e3:Math.floor((f.dts-d.dts)/(a-1))}for(var h=0;h<a;h++){var p=r[h].dts,g=r[h+1];if((s=h<a-1?g.dts-p:r[h-1]?p-r[h-1].dts:o)>MAX_VIDEO_FRAME_DURATION||s<0){this._videoTimestampBreak=!0,s=this._audioTimestampBreak?o:s;var y=this._audioNextPts||0;g&&g.dts>y&&(s=o),e.warnings.push({type:WarningType.LARGE_VIDEO_GAP,time:p/e.timescale,dts:p,originDts:r[h].originDts,nextDts:this._videoNextDts,sampleDuration:s,refSampleDuration:o})}r[h].duration=s,this._videoNextDts+=s}}}},{key:"_fixAudio",value:function(e){var t=this,r=e.samples;r.length&&(r.forEach((function(e){e.pts-=t._baseDts,e.dts=e.pts})),this._doFixAudioInternal(e,r,9e4))}},{key:"_calculateBaseDts",value:function(e,t){var r=e.samples,n=t.samples;if(!r.length&&!n.length)return!1;var i=1/0,o=1/0;r.length&&(e.baseDts=i=r[0].pts),n.length&&(t.baseDts=o=n[0].dts),this._baseDts=Math.min(i,o);var a=o-i;return Number.isFinite(a)&&Math.abs(a)>LARGE_AV_FIRST_FRAME_GAP&&t.warnings.push({type:WarningType.LARGE_AV_SHIFT,videoBaseDts:o,audioBasePts:i,baseDts:this._baseDts,delta:a}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){if(this._baseDtsInited&&this._videoTimestampBreak&&this._audioTimestampBreak){if(!this._calculateBaseDts(this.audioTrack,this.videoTrack))return;this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts),this._audioLastSample=null,this._videoLastSample=null,this._videoTimestampBreak=!1,this._audioTimestampBreak=!1}}},{key:"_doFixAudioInternal",value:function(e,t,r){e.sampleDuration||(e.sampleDuration=AAC.getFrameDuration(e.timescale,r));var n=e.sampleDuration;if(void 0===this._audioNextPts){var i=t[0];this._audioNextPts=i.pts}for(var o=0;o<t.length;o++){var a=this._audioNextPts,s=t[o],u=s.pts-a;if(!this._audioTimestampBreak&&u>=AUDIO_GAP_OVERLAP_THRESHOLD_COUNT*n&&u<=MAX_SILENT_FRAME_DURATION&&!isSafari){var c=AAC.getSilentFrame(e.codec,e.channelCount)||t[0].data.subarray(),l=Math.floor(u/n);Math.abs(s.pts-this._lastAudioExceptionGapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION&&(this._lastAudioExceptionGapDot=s.pts),e.warnings.push({type:WarningType.AUDIO_FILLED,pts:s.pts,originPts:s.originPts,count:l,nextPts:a,refSampleDuration:n});for(var d=0;d<l;d++){var f=new AudioSample(Math.floor(a),c);f.originPts=Math.floor(this._baseDts+a),t.splice(o,0,f),this._audioNextPts+=n,o++}o--}else u<=-AUDIO_GAP_OVERLAP_THRESHOLD_COUNT*n&&u>=-1*MAX_SILENT_FRAME_DURATION?(Math.abs(s.pts-this._lastAudioExceptionOverlapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION&&(this._lastAudioExceptionOverlapDot=s.pts,e.warnings.push({type:WarningType.AUDIO_DROPPED,pts:s.pts,originPts:s.originPts,nextPts:a,refSampleDuration:n})),t.splice(o,1),o--):(Math.abs(u)>=MAX_SILENT_FRAME_DURATION&&(this._audioTimestampBreak=!0,Math.abs(s.pts-this._lastAudioExceptionLargeGapDot)>AUDIO_EXCETION_LOG_EMIT_DURATION&&(this._lastAudioExceptionLargeGapDot=s.pts,e.warnings.push({type:WarningType.LARGE_AUDIO_GAP,time:s.pts/1e3,pts:s.pts,originPts:s.originPts,nextPts:a,sampleDuration:u,refSampleDuration:n}))),s.dts=s.pts=a,this._audioNextPts+=n)}}}]),e}(),logger$7=new Logger$1("TsDemuxer"),TsDemuxer=function(){function e(t,r,n){_classCallCheck$1(this,e),_defineProperty$1(this,"_pmtId",-1),_defineProperty$1(this,"_remainingPacketData",null),_defineProperty$1(this,"_videoPesData",[]),_defineProperty$1(this,"_audioPesData",[]),_defineProperty$1(this,"_gopId",0),this.videoTrack=t||new VideoTrack,this.audioTrack=r||new AudioTrack,this.metadataTrack=n||new MetadataTrack,this._fixer=new TsFixer(this.videoTrack,this.audioTrack,this.metadataTrack)}return _createClass$1(e,[{key:"demux",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.audioTrack,i=this.videoTrack,o=this.metadataTrack;t&&(this._pmtId=-1,i.reset(),n.reset(),o.reset()),!r||t?(this._remainingPacketData=null,this._videoPesData=[],this._audioPesData=[]):(i.samples=[],n.samples=[],o.seiSamples=[],i.warnings=[],n.warnings=[],this._remainingPacketData&&(e=concatUint8Array(this._remainingPacketData,e),this._remainingPacketData=null));var a=e.length,s=a%188;s&&(this._remainingPacketData=e.subarray(a-s),a-=s);for(var u=i.pid,c=n.pid,l=0;l<a;l+=188){if(71!==e[l])throw new Error("TS packet did not start with 0x47");var d=!!(64&e[l+1]),f=((31&e[l+1])<<8)+e[l+2],h=(48&e[l+3])>>4,p=void 0;if(h>1){if((p=l+5+e[l+4])===l+188)continue}else p=l+4;switch(f){case 0:d&&(p+=e[p]+1),this._pmtId=(31&e[p+10])<<8|e[p+11];break;case this._pmtId:d&&(p+=e[p]+1);var g=p+3+((15&e[p+1])<<8|e[p+2])-4,y=(15&e[p+10])<<8|e[p+11];for(p+=12+y;p<g;){var v=(31&e[p+1])<<8|e[p+2];switch(e[p]){case 15:n.pid=c=v;break;case 27:if(-1!==u)break;i.codecType=VideoCodecType.AVC,i.pid=u=v;break;case 36:if(-1!==u)break;i.codecType=VideoCodecType.HEVC,i.pid=u=v;break;default:logger$7.warn("Unsupported stream. type: ".concat(e[p],", pid: ").concat(v))}p+=5+((15&e[p+3])<<8|e[p+4])}break;case u:d&&this._videoPesData.length&&this._parseVideoData(),this._videoPesData.push(e.subarray(p,l+188));break;case c:d&&this._audioPesData.length&&this._parseAudioData(),this._audioPesData.push(e.subarray(p,l+188));break;case 17:case 8191:break;default:logger$7.warn("Unknown pid: ".concat(f))}}return this._parseVideoData(),this._parseAudioData(),n.formatTimescale=i.formatTimescale=i.timescale=o.timescale=9e4,n.timescale=n.sampleRate||0,{videoTrack:i,audioTrack:n,metadataTrack:o}}},{key:"fix",value:function(e,t,r){return this._fixer.fix(e,t,r),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(e,t,r,n){return this.demux(e,t,r),this.fix(n,t,r)}},{key:"_parseVideoData",value:function(){if(this._videoPesData.length){var t=e._parsePES(concatUint8Array.apply(void 0,_toConsumableArray(this._videoPesData)));if(t){var r=NALu.parseAnnexB(t.data);r?this._createVideoSample(r,t.pts,t.dts):logger$7.warn("Cannot parse avc units",t),this._videoPesData=[]}else logger$7.warn("Cannot parse video pes",this._videoPesData)}}},{key:"_createVideoSample",value:function(e,t,r){var n=this;if(e.length){var i=this.videoTrack,o=i.codecType===VideoCodecType.HEVC,a=new VideoSample(t,r);e.forEach((function(e){var s=o?e[0]>>>1&63:31&e[0];switch(s){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!o&&5!==s||o&&5===s)break;a.setToKeyframe(),n._gopId++;break;case 6:case 39:case 40:if(!o&&6!==s||o&&6===s)break;n.metadataTrack.seiSamples.push(new SeiSample(NALu.parseSEI(NALu.removeEPB(e)),t));break;case 32:if(!o)break;if(!i.vps.length){var u=HEVC.parseVPS(NALu.removeEPB(e),i.hvcC);i.hvcC=i.hvcC||u,i.vps=[e]}break;case 7:case 33:if(!o&&7!==s||o&&7===s)break;if(!i.sps.length){var c=NALu.removeEPB(e),l=o?HEVC.parseSPS(c,i.hvcC):AVC.parseSPS(c);i.sps=[e],i.hvcC=i.hvcC||l.hvcC,i.codec=l.codec,i.width=l.width,i.height=l.height,i.sarRatio=l.sarRatio,i.fpsNum=l.fpsNum,i.fpsDen=l.fpsDen}break;case 8:case 34:if(!o&&8!==s||o&&8===s)break;i.pps.length||(i.pps=[e]);break;case 9:case 35:if(!o&&9!==s||o&&9===s)break;a.gopId=n._gopId,a.units.length&&(n._pushVideoSample(i,a),a=n.prevAvcSample=new VideoSample(t,r))}a.units.push(e)})),a.gopId=this._gopId,this._pushVideoSample(i,a)}}},{key:"_pushVideoSample",value:function(e,t){if(t.units.length){if(null==t.pts){logger$7.warn("Video sample no pts",t);var r=e.samples[e.samples.length-1];r?(t.pts=r.pts,t.dts=r.dts):logger$7.warn("Drop video sample",t)}null!=t.pts&&e.samples.push(t)}}},{key:"_parseAudioData",value:function(){if(this._audioPesData.length){var t=e._parsePES(concatUint8Array.apply(void 0,_toConsumableArray(this._audioPesData)));t?(this._parseAacData(t),this._audioPesData=[]):logger$7.warn("Cannot parse audio pes",this._audioPesData)}}},{key:"_parseAacData",value:function(e){var t=this.audioTrack,r=e.pts;if(null==r){if(logger$7.warn("AAC pes not pts",t),!t.samples.length||!t.sampleRate)return;r=t.samples[t.samples.length-1].pts+AAC.getFrameDuration(t.sampleRate)}var n,i=AAC.parseADTS(e.data,r);i?(t.codec=i.codec,t.channelCount=i.channelCount,t.sampleRate=i.sampleRate,t.objectType=i.objectType,t.sampleRateIndex=i.samplingFrequencyIndex,t.config=i.config,(n=t.samples).push.apply(n,_toConsumableArray(i.frames.map((function(e){return new AudioSample(e.pts,e.data)})))),i.skip&&logger$7.warn("Skip aac adts ".concat(i.skip," bits")),i.remaining&&logger$7.warn("Remaining aac adts ".concat(i.remaining," bits"))):logger$7.warn("Cannot parse aac adts",e)}}],[{key:"probe",value:function(e){return!!e.length&&(71===e[0]&&71===e[188]&&71===e[376])}},{key:"_parsePES",value:function(e){var t=e[8];if(!(null==t||e.length<t+9)&&1===(e[0]<<16|e[1]<<8|e[2])){var r=(e[4]<<8)+e[5];if(!(r&&r>e.length-6)){var n,i,o=e[7];return 192&o&&(n=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&o?n-(i=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>54e5&&(n=i):i=n),{data:e.subarray(9+t),pts:n,dts:i}}}}}]),e}(),uncurryThis$H=functionUncurryThis$1,toLength$7=toLength$g,toString$k=toString$A,$repeat$1=stringRepeat$1,requireObjectCoercible$b=requireObjectCoercible$l,repeat$2=uncurryThis$H($repeat$1),stringSlice$a=uncurryThis$H("".slice),ceil$2=Math.ceil,createMethod$5=function(e){return function(t,r,n){var i,o,a=toString$k(requireObjectCoercible$b(t)),s=toLength$7(r),u=a.length,c=void 0===n?" ":toString$k(n);return s<=u||""==c?a:((o=repeat$2(c,ceil$2((i=s-u)/c.length))).length>i&&(o=stringSlice$a(o,0,i)),e?a+o:o+a)}},stringPad={start:createMethod$5(!1),end:createMethod$5(!0)},userAgent$6=engineUserAgent$1,stringPadWebkitBug=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(userAgent$6),$$W=_export$1,$padStart=stringPad.start,WEBKIT_BUG=stringPadWebkitBug;$$W({target:"String",proto:!0,forced:WEBKIT_BUG},{padStart:function(e){return $padStart(this,e,arguments.length>1?arguments[1]:void 0)}});var DESCRIPTORS$l=descriptors$1,objectDefinePropertyModule=objectDefineProperty$1,regExpFlags$1=regexpFlags$3,fails$B=fails$1m,RegExpPrototype$4=RegExp.prototype,FORCED$9=DESCRIPTORS$l&&fails$B((function(){return"sy"!==Object.getOwnPropertyDescriptor(RegExpPrototype$4,"flags").get.call({dotAll:!0,sticky:!0})}));FORCED$9&&objectDefinePropertyModule.f(RegExpPrototype$4,"flags",{configurable:!0,get:regExpFlags$1});var MP4Parser=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"findBox",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if(!t)return i;for(var o=0,a="",s=0;t.length>7;){if(o=readBig32(t),a=String.fromCharCode.apply(null,t.subarray(4,8)),s=8,1===o?(o=readBig64(t,8),s+=8):o||(o=t.length),!r[0]||a===r[0]){var u=t.subarray(0,o);if(!(r.length<2))return e.findBox(u.subarray(s),r.slice(1),n+s);i.push({start:n,size:o,headerSize:s,type:a,data:u})}n+=o,t=t.subarray(o)}return i}},{key:"moov",value:function(t){return parseBox(t,!1,(function(t,r,n){t.mvhd=e.mvhd(e.findBox(r,["mvhd"],n)[0]),t.trak=e.findBox(r,["trak"],n).map((function(t){return e.trak(t)}))}))}},{key:"mvhd",value:function(e){return parseBox(e,!0,(function(e,t){var r=0;1===e.version?(e.timescale=readBig32(t,16),e.duration=readBig64(t,20),r+=28):(e.timescale=readBig32(t,8),e.duration=readBig32(t,12),r+=16),e.nextTrackId=readBig32(t,r+76)}))}},{key:"trak",value:function(t){return parseBox(t,!1,(function(t,r,n){t.tkhd=e.tkhd(e.findBox(r,["tkhd"],n)[0]),t.mdia=e.mdia(e.findBox(r,["mdia"],n)[0])}))}},{key:"tkhd",value:function(e){return parseBox(e,!0,(function(e,t){var r=0;1===e.version?(e.trackId=readBig32(t,16),e.duration=readBig64(t,24),r+=32):(e.trackId=readBig32(t,8),e.duration=readBig32(t,16),r+=20),e.width=readBig32(t,r+52),e.height=readBig32(t,r+56)}))}},{key:"mdia",value:function(t){return parseBox(t,!1,(function(t,r,n){t.mdhd=e.mdhd(e.findBox(r,["mdhd"],n)[0]),t.hdlr=e.hdlr(e.findBox(r,["hdlr"],n)[0]),t.minf=e.minf(e.findBox(r,["minf"],n)[0])}))}},{key:"mdhd",value:function(e){return parseBox(e,!0,(function(e,t){var r=0;1===e.version?(e.timescale=readBig32(t,16),e.duration=readBig64(t,20),r+=28):(e.timescale=readBig32(t,8),e.duration=readBig32(t,12),r+=16);var n=readBig16(t,r);e.language=String.fromCharCode(96+(n>>10&31),96+(n>>5&31),96+(31&n))}))}},{key:"hdlr",value:function(e){return parseBox(e,!0,(function(e,t){0===e.version&&(e.handlerType=String.fromCharCode.apply(null,t.subarray(4,8)))}))}},{key:"minf",value:function(t){return parseBox(t,!1,(function(t,r,n){t.vmhd=e.vmhd(e.findBox(r,["vmhd"],n)[0]),t.smhd=e.smhd(e.findBox(r,["smhd"],n)[0]),t.stbl=e.stbl(e.findBox(r,["stbl"],n)[0])}))}},{key:"vmhd",value:function(e){return parseBox(e,!0,(function(e,t){e.graphicsmode=readBig16(t),e.opcolor=[readBig16(t,2),readBig16(t,4),readBig16(t,6)]}))}},{key:"smhd",value:function(e){return parseBox(e,!0,(function(e,t){e.balance=readBig16(t)}))}},{key:"stbl",value:function(t){return parseBox(t,!1,(function(t,r,n){t.stsd=e.stsd(e.findBox(r,["stsd"],n)[0]),t.stts=e.stts(e.findBox(r,["stts"],n)[0]),t.ctts=e.ctts(e.findBox(r,["ctts"],n)[0]),t.stsc=e.stsc(e.findBox(r,["stsc"],n)[0]),t.stsz=e.stsz(e.findBox(r,["stsz"],n)[0]),t.stco=e.stco(e.findBox(r,["stco"],n)[0]),t.stss=e.stss(e.findBox(r,["stss"],n)[0])}))}},{key:"stsd",value:function(t){return parseBox(t,!0,(function(t,r,n){t.entryCount=readBig32(r),t.entries=e.findBox(r.subarray(4),[],n+4).map((function(t){switch(t.type){case"avc1":case"avc2":case"avc3":case"avc4":return e.avc1(t);case"hvc1":case"hev1":return e.hvc1(t);case"mp4a":return e.mp4a(t);case"alaw":case"ulaw":return e.alaw(t)}})).filter(Boolean)}))}},{key:"avc1",value:function(t){return parseBox(t,!1,(function(t,r,n){var i=parseVisualSampleEntry(t,r),o=r.subarray(i);n+=i,t.avcC=e.avcC(e.findBox(o,["avcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])}))}},{key:"avcC",value:function(e){return parseBox(e,!1,(function(e,t){e.configurationVersion=t[0],e.AVCProfileIndication=t[1],e.profileCompatibility=t[2],e.AVCLevelIndication=t[3],e.codec=getAvcCodec([t[1],t[2],t[3]]),e.lengthSizeMinusOne=3&t[4],e.spsLength=31&t[5],e.sps=[];for(var r=6,n=0;n<e.spsLength;n++){var i=readBig16(t,r);r+=2,e.sps.push(t.subarray(r,r+i)),r+=i}e.ppsLength=t[r],r+=1,e.pps=[];for(var o=0;o<e.ppsLength;o++){var a=readBig16(t,r);r+=2,e.pps.push(t.subarray(r,r+=a)),r+=a}}))}},{key:"hvc1",value:function(t){return parseBox(t,!1,(function(t,r,n){var i=parseVisualSampleEntry(t,r),o=r.subarray(i);n+=i,t.hvcC=e.hvcC(e.findBox(o,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])}))}},{key:"hvcC",value:function(e){return parseBox(e,!1,(function(t,r){t.data=e.data,t.codec="hev1.1.6.L93.B0",t.configurationVersion=r[0];var n=r[1];t.generalProfileSpace=n>>6,t.generalTierFlag=(32&n)>>5,t.generalProfileIdc=31&n,t.generalProfileCompatibility=readBig32(r,2),t.generalConstraintIndicatorFlags=r.subarray(6,12),t.generalLevelIdc=r[12],t.avgFrameRate=readBig16(r,19),t.numOfArrays=r[22],t.vps=[],t.sps=[],t.pps=[];for(var i=23,o=0,a=0,s=0,u=0;u<t.numOfArrays;u++){o=63&r[i],a=readBig16(r,i+1),i+=3;for(var c,l=[],d=0;d<a;d++)s=readBig16(r,i),i+=2,l.push(r.subarray(i,i+s)),i+=s;if(32===o)(c=t.vps).push.apply(c,l);else if(33===o){var f;(f=t.sps).push.apply(f,l)}else if(34===o){var h;(h=t.pps).push.apply(h,l)}}}))}},{key:"pasp",value:function(e){return parseBox(e,!1,(function(e,t){e.hSpacing=readBig32(t),e.vSpacing=readBig32(t,4)}))}},{key:"mp4a",value:function(t){return parseBox(t,!1,(function(t,r,n){var i=parseAudioSampleEntry(t,r);t.esds=e.esds(e.findBox(r.subarray(i),["esds"],n+i)[0])}))}},{key:"esds",value:function(e){return parseBox(e,!0,(function(e,t){e.codec="mp4a.";for(var r=0,n=0,i=0,o=0;t.length;){for(o=t[r=0],n=t[r+1],r+=2;128&n;)i=(127&n)<<7,n=t[r],r+=1;if(i+=127&n,3===o)t=t.subarray(r+3);else{if(4!==o){if(5===o){var a=e.config=t.subarray(r,r+i),s=(248&a[0])>>3;return 31===s&&a.length>=2&&(s=32+((7&a[0])<<3)+((224&a[1])>>5)),e.objectType=s,void(e.codec+=s.toString(16))}return}e.codec+=(t[r].toString(16)+".").padStart(3,"0"),t=t.subarray(r+13)}}}))}},{key:"alaw",value:function(e){return parseBox(e,!1,(function(e,t){parseAudioSampleEntry(e,t)}))}},{key:"stts",value:function(e){return parseBox(e,!0,(function(e,t){for(var r=readBig32(t),n=[],i=4,o=0;o<r;o++)n.push({count:readBig32(t,i),delta:readBig32(t,i+4)}),i+=8;e.entryCount=r,e.entries=n}))}},{key:"ctts",value:function(e){return parseBox(e,!0,(function(e,t){var r=readBig32(t),n=[],i=4;if(1===e.version)for(var o=0;o<r;o++)n.push({count:readBig32(t,i),offset:readBig32(t,i+4)}),i+=8;else for(var a=0;a<r;a++)n.push({count:readBig32(t,i),offset:-(1+~readBig32(t,i+4))}),i+=8;e.entryCount=r,e.entries=n}))}},{key:"stsc",value:function(e){return parseBox(e,!0,(function(e,t){for(var r=readBig32(t),n=[],i=4,o=0;o<r;o++)n.push({firstChunk:readBig32(t,i),samplesPerChunk:readBig32(t,i+4),sampleDescriptionIndex:readBig32(t,i+8)}),i+=12;e.entryCount=r,e.entries=n}))}},{key:"stsz",value:function(e){return parseBox(e,!0,(function(e,t){var r=readBig32(t),n=readBig32(t,4),i=[];if(!r)for(var o=8,a=0;a<n;a++)i.push(readBig32(t,o)),o+=4;e.sampleSize=r,e.sampleCount=n,e.entrySizes=i}))}},{key:"stco",value:function(e){return parseBox(e,!0,(function(e,t){for(var r=readBig32(t),n=[],i=4,o=0;o<r;o++)n.push(readBig32(t,i)),i+=4;e.entryCount=r,e.entries=n}))}},{key:"stss",value:function(e){return parseBox(e,!0,(function(e,t){for(var r=readBig32(t),n=[],i=4,o=0;o<r;o++)n.push(readBig32(t,i)),i+=4;e.entryCount=r,e.entries=n}))}},{key:"moof",value:function(t){return parseBox(t,!1,(function(t,r,n){t.mfhd=e.mfhd(e.findBox(r,["mfhd"],n)[0]),t.traf=e.findBox(r,["traf"],n).map((function(t){return e.traf(t)}))}))}},{key:"mfhd",value:function(e){return parseBox(e,!0,(function(e,t){e.sequenceNumber=readBig32(t)}))}},{key:"traf",value:function(t){return parseBox(t,!1,(function(t,r,n){t.tfhd=e.tfhd(e.findBox(r,["tfhd"],n)[0]),t.tfdt=e.tfdt(e.findBox(r,["tfdt"],n)[0]),t.trun=e.trun(e.findBox(r,["trun"],n)[0])}))}},{key:"tfhd",value:function(e){return parseBox(e,!0,(function(e,t){var r=e.flags,n=t.length;e.trackId=readBig32(t);var i=4;n>i&&1&r&&(e.baseDataOffset=readBig64(t,i),i+=8),n>i&&2&r&&(e.sampleDescriptionIndex=readBig32(t,i),i+=4),n>i&&8&r&&(e.defaultSampleDuration=readBig32(t,i),i+=4),n>i&&10&r&&(e.defaultSampleSize=readBig32(t,i),i+=4),n>i&&32&r&&(e.defaultSampleFlags=readBig32(t,i),i+=4)}))}},{key:"trun",value:function(e){return parseBox(e,!0,(function(e,t){var r=e.version,n=e.flags,i=t.length,o=e.sampleCount=readBig32(t),a=4;if(i>a&&1&n&&(e.dataOffset=-(1+~readBig32(t,a)),a+=4),i>a&&4&n&&(e.firstSampleFlags=readBig32(t,a),a+=4),e.samples=[],i>a)for(var s,u=0;u<o;u++)s={},256&n&&(s.duration=readBig32(t,a),a+=4),512&n&&(s.size=readBig32(t,a),a+=4),1024&n&&(s.flags=readBig32(t,a),a+=4),2048&n&&(s.cts=r?-(1+~readBig32(t,a+4)):readBig32(t,a),a+=4),e.samples.push(s)}))}},{key:"tfdt",value:function(e){return parseBox(e,!0,(function(e,t){1===e.version?e.baseMediaDecodeTime=readBig64(t):e.baseMediaDecodeTime=readBig32(t)}))}},{key:"probe",value:function(t){return!!e.findBox(t,["ftyp"])}},{key:"moovToTrack",value:function(e,t,r){var n,i,o=e.trak;if(o&&o.length){var a=o.find((function(e){var t,r;return"vide"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)})),s=o.find((function(e){var t,r;return"soun"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)}));if(a&&t){var u,c=t;null!=(null===(u=a.tkhd)||void 0===u?void 0:u.trackId)&&(c.id=a.tkhd.trackId),c.timescale=c.formatTimescale=a.mdia.mdhd.timescale,c.duration=a.mdia.mdhd.duration;var l=a.mdia.minf.stbl.stsd.entries[0];if(c.width=l.width,c.height=l.height,l.pasp&&(c.sarRatio=[l.pasp.hSpacing,l.pasp.vSpacing]),l.hvcC)c.codecType=VideoCodecType.HEVC,c.codec=l.hvcC.codec,c.vps=l.hvcC.vps,c.sps=l.hvcC.sps,c.pps=l.hvcC.pps,c.hvcC=l.hvcC.data;else{if(!l.avcC)throw new Error("unknown video stsd entry");c.codec=l.avcC.codec,c.sps=l.avcC.sps,c.pps=l.avcC.pps}c.present=!0}if(s&&r){var d,f=r;null!=(null===(d=s.tkhd)||void 0===d?void 0:d.trackId)&&(f.id=s.tkhd.trackId),f.timescale=f.formatTimescale=s.mdia.mdhd.timescale,f.duration=s.mdia.mdhd.duration;var h=s.mdia.minf.stbl.stsd.entries[0];switch(f.sampleSize=h.sampleSize,f.sampleRate=h.sampleRate,f.channelCount=h.channelCount,f.present=!0,h.type){case"alaw":f.codecType=f.codec=AudioCodecType.G711PCMA,f.sampleRate=8e3;break;case"ulaw":f.codecType=f.codec=AudioCodecType.G711PCMU,f.sampleRate=8e3;break;default:f.sampleDuration=AAC.getFrameDuration(f.sampleRate,f.timescale),f.sampleRateIndex=AAC.getRateIndexByRate(f.sampleRate),f.objectType=(null===(n=h.esds)||void 0===n?void 0:n.objectType)||2,h.esds&&(f.config=Array.from(h.esds.config)),f.codec=(null===(i=h.esds)||void 0===i?void 0:i.codec)||"mp4a.40.2"}}return{videoTrack:t,audioTrack:r}}}},{key:"evaluateDefaultDuration",value:function(e,t,r){var n,i=null==t||null===(n=t.samples)||void 0===n?void 0:n.length;return i?1024*i/t.timescale*e.timescale/r:1024}},{key:"moofToSamples",value:function(t,r,n){var i={};return t.mfhd&&(r&&(r.sequenceNumber=t.mfhd.sequenceNumber),n&&(n.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach((function(t){var o=t.tfhd,a=t.tfdt,s=t.trun;if(o&&s){a&&(r&&r.id===o.trackId&&(r.baseMediaDecodeTime=a.baseMediaDecodeTime),n&&n.id===o.trackId&&(n.baseMediaDecodeTime=a.baseMediaDecodeTime));var u=o.defaultSampleSize||0,c=o.defaultSampleDuration||e.evaluateDefaultDuration(r,n,s.samples.length||s.sampleCount),l=s.dataOffset||0,d=0,f=-1;if(!s.samples.length&&s.sampleCount){i[o.trackId]=[];for(var h=0;h<s.sampleCount;h++)i[o.trackId].push({offset:l,dts:d,duration:c,size:u}),d+=c,l+=u}else i[o.trackId]=s.samples.map((function(e,t){return(e={offset:l,dts:d,pts:d+(e.cts||0),duration:e.duration||c,size:e.size||u,gopId:f,keyframe:0===t||null!=e.flags&&(65536&e.flags)>>>0!=65536}).keyframe&&(f++,e.gopId=f),d+=e.duration,l+=e.size,e}))}})),i}},{key:"moovToSamples",value:function(e){var t=e.trak;if(t&&t.length){var r=t.find((function(e){var t,r;return"vide"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)})),n=t.find((function(e){var t,r;return"soun"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)}));if(r||n){var i,o;if(r){var a,s,u=null===(a=r.mdia)||void 0===a||null===(s=a.minf)||void 0===s?void 0:s.stbl;if(!u)return;var c=u.stts,l=u.stsc,d=u.stsz,f=u.stco,h=u.stss,p=u.ctts;if(!(c&&l&&d&&f&&h))return;i=getSamples(c,l,d,f,p,h)}if(n){var g,y,v,m=null===(g=n.mdia)||void 0===g||null===(y=g.minf)||void 0===y?void 0:y.stbl;if(!m)return;var _=null===(v=n.mdia.mdhd)||void 0===v?void 0:v.timescale,b=m.stts,A=m.stsc,E=m.stsz,S=m.stco;if(!(_&&b&&A&&E&&S))return;o=getSamples(b,A,E,S)}return{videoSamples:i,audioSamples:o}}}}}]),e}();function getSamples(e,t,r,n,i,o){var a,s,u,c=[],l=null==i?void 0:i.entries,d=t.entries,f=n.entries,h=r.entrySizes,p=null==o?void 0:o.entries;p&&(a={},p.forEach((function(e){a[e-1]=!0}))),l&&(s=[],l.forEach((function(e){for(var t=e.count,r=e.offset,n=0;n<t;n++)s.push(r)})));var g=-1,y=0,v=0,m=0,_=0,b=0,A=d[0].samplesPerChunk,E=d[1]?d[1].firstChunk-1:1/0;return e.entries.forEach((function(e){for(var t=e.count,n=e.delta,i=0;i<t;i++)u={dts:y,duration:n,size:h[v]||r.sampleSize,offset:f[m]+b,index:v},p&&(u.keyframe=a[v],u.keyframe&&g++,u.gopId=g),s&&s[v]&&(u.pts=u.dts+s[v]),c.push(u),y+=n,++v<A?b+=u.size:(m++,b=0,m>=E&&(_++,E=d[_+1]?d[_+1].firstChunk-1:1/0),A+=d[_].samplesPerChunk)})),c}function parseVisualSampleEntry(e,t){return e.dataReferenceIndex=readBig16(t,6),e.width=readBig16(t,24),e.height=readBig16(t,26),e.horizresolution=readBig32(t,28),e.vertresolution=readBig32(t,32),e.frameCount=readBig16(t,40),e.depth=readBig16(t,74),78}function parseAudioSampleEntry(e,t){return e.dataReferenceIndex=readBig16(t,6),e.channelCount=readBig16(t,16),e.sampleSize=readBig16(t,18),e.sampleRate=readBig32(t,24)/65536,28}function parseBox(e,t,r){if(e){if(e.size!==e.data.length)throw new Error("box ".concat(e.type," size !== data.length"));var n={start:e.start,size:e.size,headerSize:e.headerSize,type:e.type};return t&&(n.version=e.data[e.headerSize],n.flags=readBig24(e.data,e.headerSize+1),n.headerSize+=4),r(n,e.data.subarray(n.headerSize),n.start+n.headerSize),n}}var FMP4Demuxer=function(){function e(t,r,n){_classCallCheck$1(this,e),this.videoTrack=t||new VideoTrack,this.audioTrack=r||new AudioTrack,this.metadataTrack=n||new MetadataTrack}return _createClass$1(e,[{key:"demux",value:function(e,t){var r=this.videoTrack,n=this.audioTrack,i=r.exist(),o=n.exist();if(r.samples=[],n.samples=[],t){if(!o){var a=MP4Parser.findBox(t,["moov"])[0];if(!a)throw new Error("cannot found moov box");MP4Parser.moovToTrack(MP4Parser.moov(a),null,n)}var s=MP4Parser.findBox(t,["moof"])[0];if(s){var u=MP4Parser.moofToSamples(MP4Parser.moof(s),null,n)[n.id],c=n.baseMediaDecodeTime;if(u){var l=s.start;u.map((function(e){e.offset+=l;var r=t.subarray(e.offset,e.offset+e.size);n.samples.push(new AudioSample(e.dts+c,r,e.duration))}))}}}if(e){if(!i&&!o){var d=MP4Parser.findBox(e,["moov"])[0];if(!d)throw new Error("cannot found moov box");MP4Parser.moovToTrack(MP4Parser.moov(d),r,n)}var f=MP4Parser.findBox(e,["moof"])[0];if(f){var h,p=MP4Parser.moofToSamples(MP4Parser.moof(f),r,n),g=r.baseMediaDecodeTime,y=n.baseMediaDecodeTime,v=f.start;Object.keys(p).forEach((function(t){r.id==t?p[t].map((function(t){t.offset+=v;var n=new VideoSample((t.pts||t.dts)+g,t.dts+g);n.duration=t.duration,n.gopId=t.gopId,t.keyframe&&n.setToKeyframe();for(var i=e.subarray(t.offset,t.offset+t.size),o=0,a=i.length-1;o<a;)h=readBig32(i,o),o+=4,n.units.push(i.subarray(o,o+h)),o+=h;r.samples.push(n)})):n.id==t&&p[t].map((function(t){t.offset+=v;var r=e.subarray(t.offset,t.offset+t.size);n.samples.push(new AudioSample(t.dts+y,r,t.duration))}))}))}}return{videoTrack:r,audioTrack:n,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}}],[{key:"probe",value:function(e){return MP4Parser.probe(e)}}]),e}();function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}var $$V=_export$1,global$B=global$1T,arrayBufferModule=arrayBuffer,setSpecies$3=setSpecies$8,ARRAY_BUFFER="ArrayBuffer",ArrayBuffer$2=arrayBufferModule[ARRAY_BUFFER],NativeArrayBuffer=global$B[ARRAY_BUFFER];$$V({global:!0,forced:NativeArrayBuffer!==ArrayBuffer$2},{ArrayBuffer:ArrayBuffer$2}),setSpecies$3(ARRAY_BUFFER);var UINT32_MAX=Math.pow(2,32)-1,MP4=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=8+(r=r.filter(Boolean)).reduce((function(e,t){return e+t.byteLength}),0),o=new Uint8Array(i);o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=255&i,o.set(e,4);var a=8;return r.forEach((function(e){o.set(e,a),a+=e.byteLength})),o}},{key:"ftyp",value:function(t){return t.find((function(e){return e.type===TrackType.VIDEO&&e.codecType===VideoCodecType.HEVC}))?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){return concatUint8Array(e.ftyp(t),e.moov(t))}},{key:"moov",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(_toConsumableArray(t.map((function(t){return e.trak(t)}))),[e.mvex(t)]))}},{key:"mvhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]))}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===TrackType.VIDEO?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.STTS,e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){return e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t.type===TrackType.VIDEO?e.avc1hev1(t):e.mp4a(t))}},{key:"avc1hev1",value:function(t){var r=t.codecType===VideoCodecType.HEVC,n=r?e.types.hvc1:e.types.avc1,i=r?e.hvcC(t):e.avcC(t),o=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i];return t.sarRatio&&t.sarRatio.length>1&&o.push(e.pasp(t.sarRatio)),e.box.apply(e,[n].concat(o))}},{key:"avcC",value:function(t){var r,n=[],i=[];return t.sps.forEach((function(e){r=e.byteLength,n.push(r>>>8&255),n.push(255&r),n.push.apply(n,_toConsumableArray(e))})),t.pps.forEach((function(e){r=e.byteLength,i.push(r>>>8&255),i.push(255&r),i.push.apply(i,_toConsumableArray(e))})),e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(i)))}},{key:"hvcC",value:function(t){var r=t.hvcC;if(r instanceof ArrayBuffer)return r;var n,i=t.vps,o=t.sps,a=t.pps;if(r){var s=r.generalProfileCompatibilityFlags,u=r.generalConstraintIndicatorFlags,c=(i.length&&1)+(o.length&&1)+(a.length&&1);n=[1,r.generalProfileSpace<<6|r.generalTierFlag<<5|r.generalProfileIdc,s>>>24,s>>>16,s>>>8,s,u[0],u[1],u[2],u[3],u[4],u[5],r.generalLevelIdc,240,0,252,252|r.chromaFormatIdc,248|r.bitDepthLumaMinus8,248|r.bitDepthChromaMinus8,0,0,r.numTemporalLayers<<3|r.temporalIdNested<<2|3,c];var l=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,_toConsumableArray(e))};i.length&&(n.push(160,0,i.length),i.forEach(l)),o.length&&(n.push(161,0,o.length),o.forEach(l)),a.length&&(n.push(162,0,a.length),a.forEach(l))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var r=_slicedToArray(t,2),n=r[0],i=r[1];return e.box(e.types.pasp,new Uint8Array([n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var r=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+r,0,0,0,4,15+r,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([r]).concat(t).concat([6,1,2])))}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat(_toConsumableArray(t.map((function(t){return e.trex(t.id)})))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"moof",value:function(t,r){return e.box.apply(e,[e.types.moof,e.mfhd(t)].concat(_toConsumableArray(r.map((function(t){return e.traf(t)})))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){return e.box(e.types.traf,e.tfhd(t.id),e.tfdt(t.baseMediaDecodeTime),e.trun(t.samples,76))}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t){var r=Math.floor(t/(UINT32_MAX+1)),n=Math.floor(t%(UINT32_MAX+1));return e.box(e.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"trun",value:function(t,r){var n=t.length,i=12+16*n;r+=8+i;var o=new Uint8Array(i);o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var a=0;a<n;a++){var s=t[a],u=s.duration,c=s.size,l=s.flag,d=void 0===l?{}:l,f=s.cts,h=void 0===f?0:f;o.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|(null==d.dependsOn?1:d.dependsOn),d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|(null==d.isNonSyncSample?1:d.isNonSyncSample),61440&d.degradationPriority,15&d.degradationPriority,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a)}return e.box(e.types.trun,o)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(_toConsumableArray(t.map((function(t){return e.trackMP4(t)})))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===TrackType.VIDEO?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var r=t.ext,n=[e.stsd(t),e.stts(r.stts),e.stsc(r.stsc),e.stsz(r.stsz),e.stco(r.stco)];return r.stss.length&&n.push(e.stss(r.stss)),r.ctts.length&&n.push(e.ctts(r.ctts)),e.box.apply(e,[e.types.stbl].concat(n))}},{key:"stts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach((function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8})),e.box(e.types.stts,concatUint8Array(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsc",value:function(t){var r=t.length,n=new Uint8Array(12*r),i=0;return t.forEach((function(e){var t=e.firstChunk,r=e.samplesPerChunk,o=e.sampleDescIndex;n.set([t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,o>>24,o>>16&255,o>>8&255,255&o],i),i+=12})),e.box(e.types.stsc,concatUint8Array(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsz",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stsz,concatUint8Array(new Uint8Array([0,0,0,0,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stco",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stco,concatUint8Array(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stss",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stss,concatUint8Array(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"ctts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach((function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8})),e.box(e.types.ctts,concatUint8Array(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}}]),e}();_defineProperty$1(MP4,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trun","trex","tkhd","vmhd","smhd","ctts","stss"].reduce((function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e}),Object.create(null))),_defineProperty$1(MP4,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),_defineProperty$1(MP4,"FTYPAVC1",MP4.box(MP4.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),_defineProperty$1(MP4,"FTYPHEV1",MP4.box(MP4.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),_defineProperty$1(MP4,"DINF",MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),_defineProperty$1(MP4,"VMHD",MP4.box(MP4.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),_defineProperty$1(MP4,"SMHD",MP4.box(MP4.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),_defineProperty$1(MP4,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),_defineProperty$1(MP4,"STTS",MP4.box(MP4.types.stts,MP4.StblTable)),_defineProperty$1(MP4,"STSC",MP4.box(MP4.types.stsc,MP4.StblTable)),_defineProperty$1(MP4,"STSZ",MP4.box(MP4.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),_defineProperty$1(MP4,"STCO",MP4.box(MP4.types.stco,MP4.StblTable));var browserVersions=/Chrome\/([^.]+)/.exec(navigator.userAgent),ForceFirstIDR=browserVersions&&Number(browserVersions[1])<50,FMP4Remuxer=function(){function e(t,r){_classCallCheck$1(this,e),this.videoTrack=t,this.audioTrack=r}return _createClass$1(e,[{key:"remux",value:function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.videoTrack,a=this.audioTrack,s=o.exist(),u=a.exist();return o.duration=o.duration||4294967295,a.duration=a.duration||4294967295,i&&(s&&(e=MP4.initSegment([this.videoTrack])),u&&(t=MP4.initSegment([this.audioTrack]))),s&&o.hasSample()&&(r=this._remuxVideo()),u&&a.hasSample()&&(n=this._remuxAudio()),o.samples=[],a.samples=[],{videoInitSegment:e,audioInitSegment:t,videoSegment:r,audioSegment:n}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack,t=e.samples;ForceFirstIDR&&(t[0].flag={dependsOn:2,isNonSyncSample:0});var r=0;t.forEach((function(e){r+=e.units.reduce((function(e,t){return e+t.byteLength}),0),r+=4*e.units.length}));for(var n,i=new Uint8Array(r),o=new DataView(i.buffer),a=function(e,r,a,s){s=t[e];var u=0;s.units.forEach((function(e){o.setUint32(a,e.byteLength),a+=4,i.set(e,a),a+=e.byteLength,u+=4+e.byteLength})),s.size=u,c=a,n=s},s=0,u=t.length,c=0;s<u;s++)a(s,0,c,n);return concatUint8Array(MP4.moof(this.videoTrack.sequenceNumber++,[e]),MP4.mdat(i))}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=MP4.moof(this.audioTrack.sequenceNumber++,[e]),r=new Uint8Array(e.samples.reduce((function(e,t){return e+t.size}),0));return e.samples.reduce((function(e,t){return r.set(t.data,e),e+t.size}),0),concatUint8Array(t,MP4.mdat(r))}}]),e}(),MP4Remuxer=function(){function e(t,r){_classCallCheck$1(this,e),this.videoTrack=t,this.audioTrack=r}return _createClass$1(e,[{key:"remux",value:function(e,t){this.videoTrack=e||this.videoTrack,this.audioTrack=t||this.audioTrack;var r,n,i=(null==e?void 0:e.exist())&&(null==e?void 0:e.hasSample()),o=(null==t?void 0:t.exist())&&(null==t?void 0:t.hasSample());return i&&o?r=this._remuxMix(e,t):i?r=this._remuxTrack(e):o&&(n=this._remuxTrack(t)),e&&(e.samples=[]),t&&(t.samples=[]),{videoSegment:r,audioSegment:n}}},{key:"_remuxMix",value:function(e,t){var r=MP4.ftyp([e,t]),n=this._remuxData(e,r.byteLength+8),i=n.mdatData,o=n.chunkOffset,a=this._remuxData(t,o).mdatData,s=MP4.mdat(concatUint8Array(i,a)),u=MP4.moovMP4([e,t]);return e.ext=void 0,t.ext=void 0,e.samples=[],t.samples=[],concatUint8Array(r,s,u)}},{key:"_remuxTrack",value:function(e){var t=MP4.ftyp([e]),r=this._remuxData(e,t.byteLength+8).mdatData,n=MP4.mdat(r),i=MP4.moovMP4([e]);return e.ext=void 0,e.samples=[],concatUint8Array(t,n,i)}},{key:"_remuxData",value:function(e,t){var r=e.type===TrackType.VIDEO,n=e.samples,i=0;r?n.forEach((function(e){i+=e.units.reduce((function(e,t){return e+t.byteLength}),0),i+=4*e.units.length})):i=n.reduce((function(e,t){return e+t.size}),0);for(var o,a=new Uint8Array(i),s=new DataView(a.buffer),u=e.ext={stts:[],stsc:[],stsz:[],stco:[],stss:[],ctts:[]},c=0,l=0,d=n.length,f=0;f<d;f++){l+=(o=n[f]).duration;var h=r?0:o.size;r?o.units.forEach((function(e){s.setUint32(c,e.byteLength),c+=4,a.set(e,c),c+=e.byteLength,h+=4+e.byteLength})):(a.set(o.data,c),c+=h),o.size=h,u.stsz.push(h),r&&this._fillCttsSamples(u.ctts,o.cts),this._fillSttsSamples(u.stts,o,n[f+1]),this._fillStcoSamples(u.stco,f,1,t),t+=h,r&&o.keyframe&&u.stss.push(f+1)}return e.duration=l,this._fillStscSamples(u.stsc,d,1),{mdatData:a,chunkOffset:t}}},{key:"_fillSttsSamples",value:function(e,t,r){var n=e[e.length-1];r?n&&n.value===t.duration?n.count++:e.push({value:t.duration,count:1}):n?n.count++:e.push({value:40,count:1})}},{key:"_fillCttsSamples",value:function(e,t){var r=e[e.length-1];r&&r.value===t?r.count++:e.push({value:t,count:1})}},{key:"_fillStcoSamples",value:function(e,t,r,n){t%r||e.push(n)}},{key:"_fillStscSamples",value:function(e,t,r){if(t<=r)e.push({firstChunk:1,samplesPerChunk:t,sampleDescIndex:1});else{var n=Math.floor(t/r),i=t%r;e.push({firstChunk:1,samplesPerChunk:r,sampleDescIndex:1}),i&&e.push({firstChunk:n+1,samplesPerChunk:i,sampleDescIndex:1})}}}]),e}();function ownKeys$j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$j(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function getOption$1(e){var t=_objectSpread$g({retryCount:3,retryDelay:1e3,loadTimeout:1e4,maxReaderInterval:5e3,preloadTime:5,isLive:!1,softDecode:!1,bufferBehind:10,maxJumpDistance:3,analyzeDuration:2e4,seamlesslyReload:!1},e);return t.isLive&&t.preloadTime&&(t.maxLatency||(t.maxLatency=2*t.preloadTime),t.targetLatency||(t.targetLatency=t.preloadTime),null==t.disconnectTime&&(t.disconnectTime=t.maxLatency)),t}function searchKeyframeIndex(e,t){var r=0,n=e.length-1,i=0,o=0,a=n;for(t<e[0]&&(r=0,o=a+1);o<=a;){if((i=o+Math.floor((a-o)/2))===n||t>=e[i]&&t<e[i+1]){r=i;break}e[i]<t?o=i+1:a=i-1}return r}function ownKeys$i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$i(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var logger$6=new Logger$2("BufferService"),BufferService$1=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e4;_classCallCheck$1(this,e),_defineProperty$1(this,"flv",null),_defineProperty$1(this,"_demuxer",new FlvDemuxer),_defineProperty$1(this,"_remuxer",null),_defineProperty$1(this,"_mse",null),_defineProperty$1(this,"_softVideo",null),_defineProperty$1(this,"_sourceCreated",!1),_defineProperty$1(this,"_needInitSegment",!0),_defineProperty$1(this,"_discontinuity",!0),_defineProperty$1(this,"_contiguous",!1),_defineProperty$1(this,"_initSegmentId",""),_defineProperty$1(this,"_cachedBuffer",null),_defineProperty$1(this,"_demuxStartTime",0),_defineProperty$1(this,"_analyzeDuration",0),this.flv=t,this._analyzeDuration=n,r?this._softVideo=r:(this._remuxer=new FMP4Remuxer(this._demuxer.videoTrack,this._demuxer.audioTrack),this._mse=new MSE$2,this._mse.bindMedia(t.media))}var t,r,n,i,o,a;return _createClass$1(e,[{key:"baseDts",get:function(){var e,t;return null===(e=this._demuxer)||void 0===e||null===(t=e._fixer)||void 0===t?void 0:t._baseDts}},{key:"seamlessSwitch",value:function(){this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!0,this._initSegmentId=""}},{key:"unContiguous",value:function(e){this._contiguous=!1,this._demuxStartTime=e}},{key:"reset",value:(a=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=5;break}return e.next=3,this._mse.unbindMedia();case 3:return e.next=5,this._mse.bindMedia(this.flv.media);case 5:this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!1,this._sourceCreated=!1,this._initSegmentId="";case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"endOfStream",value:(o=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=7;break}if(!this._sourceCreated){e.next=5;break}return e.next=4,this._mse.endOfStream();case 4:this.flv.emit(EVENT.BUFFEREOS);case 5:e.next=8;break;case 7:this._softVideo&&this._softVideo.endOfStream();case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"updateDuration",value:(i=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=7;break}if(this._mse.isOpened){e.next=4;break}return e.next=4,this._mse.open();case 4:return logger$6.debug("update duration",t),e.next=7,this._mse.updateDuration(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"destroy",value:(n=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=3;break}return e.next=3,this._mse.unbindMedia();case 3:this._mse=null,this._softVideo=null,this._demuxer=null,this._remuxer=null;case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"appendBuffer",value:(r=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f,h,p,g;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cachedBuffer&&(t=concatUint8Array$1(this._cachedBuffer,t),this._cachedBuffer=null),r=this._demuxer,t&&t.length&&r){e.next=4;break}return e.abrupt("return");case 4:e.prev=4,r.demuxAndFix(t,this._discontinuity,this._contiguous,this._demuxStartTime),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(4),new StreamingError(ERR.DEMUX,ERR.SUB_TYPES.FLV,e.t0);case 11:if(n=r.videoTrack,i=r.audioTrack,o=r.metadataTrack,a=n.exist(),s=i.exist(),!(!a&&n.present||!s&&i.present)){e.next=27;break}if(u=0,(c=a?n:s?i:void 0)&&c.samples.length&&(u=(c.samples[c.samples.length-1].originPts-c.samples[0].originPts)/c.timescale*1e3),!(u>this._analyzeDuration)){e.next=25;break}logger$6.warn("analyze duration exceeded, ".concat(u,"ms"),c),n.present=a,i.present=s,this.flv.emit(EVENT.ANALYZE_DURATION_EXCEEDED,{duration:u}),e.next=27;break;case 25:return this._cachedBuffer=t,e.abrupt("return");case 27:if(l=n.type,d=i.type,this._fireEvents(n,i,o),this._discontinuity=!1,this._contiguous=!0,this._demuxStartTime=0,!(f=this._mse)){e.next=62;break}if(this._sourceCreated){e.next=42;break}return e.next=38,f.open();case 38:a&&f.createSource(l,"video/mp4;codecs=".concat(n.codec)),s&&f.createSource(d,"audio/mp4;codecs=".concat(i.codec)),this._sourceCreated=!0,this.flv.emit(EVENT.SOURCEBUFFER_CREATED);case 42:(h="".concat(n.codec,"/").concat(n.width,"/").concat(n.height,"/").concat(i.codec))!==this._initSegmentId&&(this._needInitSegment=!0,this._initSegmentId=h,this._emitMetaParsedEvent(n,i)),e.prev=44,p=this._remuxer.remux(this._needInitSegment),e.next=51;break;case 48:throw e.prev=48,e.t1=e.catch(44),new StreamingError(ERR.REMUX,ERR.SUB_TYPES.FMP4,e.t1);case 51:if(!this._needInitSegment||p.videoInitSegment||p.audioInitSegment){e.next=53;break}return e.abrupt("return");case 53:return this._needInitSegment=!1,g=[],p.videoInitSegment&&g.push(f.append(l,p.videoInitSegment)),p.audioInitSegment&&g.push(f.append(d,p.audioInitSegment)),p.videoSegment&&g.push(f.append(l,p.videoSegment)),p.audioSegment&&g.push(f.append(d,p.audioSegment)),e.abrupt("return",Promise.all(g));case 62:this._softVideo&&this._softVideo.appendBuffer(n,i);case 63:case"end":return e.stop()}}),e,this,[[4,8],[44,48]])}))),function(e){return r.apply(this,arguments)})},{key:"evictBuffer",value:(t=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.flv.media,this._mse&&this._demuxer&&r&&t&&!(t<0)){e.next=3;break}return e.abrupt("return");case 3:if(n=r.currentTime,!((i=n-t)<=0)){e.next=7;break}return e.abrupt("return");case 7:if(!(Buffer.start(Buffer.get(r))+1>=i)){e.next=10;break}return e.abrupt("return");case 10:return e.abrupt("return",this._mse.clearBuffer(0,i).then((function(){return o.flv.emit(EVENT.REMOVE_BUFFER,{removeEnd:i})})));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_emitMetaParsedEvent",value:function(e,t){e.exist()&&this.flv.emit(EVENT.METADATA_PARSED,{type:"video",meta:{codec:e.codec,timescale:e.timescale,width:e.width,height:e.height,sarRatio:e.sarRatio,baseDts:e.baseDts}}),t.exist()&&this.flv.emit(EVENT.METADATA_PARSED,{type:"audio",meta:{codec:t.codec,channelCount:t.channelCount,sampleRate:t.sampleRate,timescale:t.timescale,baseDts:t.baseDts}}),logger$6.debug("track parsed",e,t)}},{key:"_fireEvents",value:function(e,t,r){var n=this;logger$6.debug(e.samples,t.samples),r.flvScriptSamples.forEach((function(e){n.flv.emit(EVENT.FLV_SCRIPT_DATA,e),logger$6.debug("flvScriptData",e)})),e.samples.forEach((function(e){e.keyframe&&n.flv.emit(EVENT.KEYFRAME,{pts:e.pts})})),e.warnings.forEach((function(e){var t;switch(e.type){case WarningType.LARGE_AV_SHIFT:t=EVENT.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case WarningType.LARGE_VIDEO_GAP:t=EVENT.LARGE_VIDEO_DTS_GAP_DETECT;break;case WarningType.LARGE_VIDEO_GAP_BETWEEN_CHUNK:t=EVENT.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT}t&&n.flv.emit(EVENT.STREAM_EXCEPTION,_objectSpread$f(_objectSpread$f({},e),{},{type:t})),logger$6.warn("video exception",e)})),t.warnings.forEach((function(e){var t;switch(e.type){case WarningType.LARGE_AUDIO_GAP:t=EVENT.LARGE_AUDIO_DTS_GAP_DETECT;break;case WarningType.AUDIO_FILLED:t=EVENT.AUDIO_GAP_DETECT;break;case WarningType.AUDIO_DROPPED:t=EVENT.AUDIO_OVERLAP_DETECT}t&&n.flv.emit(EVENT.STREAM_EXCEPTION,_objectSpread$f(_objectSpread$f({},e),{},{type:t})),logger$6.warn("audio exception",e)})),r.seiSamples.forEach((function(e){n.flv.emit(EVENT.SEI,_objectSpread$f(_objectSpread$f({},e),{},{sei:{code:e.data.type,content:e.data.payload,dts:e.pts}}))}))}}]),e}();function ownKeys$h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$h(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper$m(e){var t=_isNativeReflectConstruct$m();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var logger$5=new Logger$2("flv"),Flv=function(e){_inherits(c,e);var t,r,n,i,o,a,s,u=_createSuper$m(c);function c(e){var t;return _classCallCheck$1(this,c),_defineProperty$1(_assertThisInitialized(t=u.call(this)),"media",null),_defineProperty$1(_assertThisInitialized(t),"_loading",!1),_defineProperty$1(_assertThisInitialized(t),"_opts",null),_defineProperty$1(_assertThisInitialized(t),"_bufferService",null),_defineProperty$1(_assertThisInitialized(t),"_gapService",null),_defineProperty$1(_assertThisInitialized(t),"_mediaLoader",null),_defineProperty$1(_assertThisInitialized(t),"_maxChunkWaitTimer",null),_defineProperty$1(_assertThisInitialized(t),"_tickTimer",null),_defineProperty$1(_assertThisInitialized(t),"_tickInterval",500),_defineProperty$1(_assertThisInitialized(t),"_noEndOfStreamOnDone",!1),_defineProperty$1(_assertThisInitialized(t),"_urlSwitching",!1),_defineProperty$1(_assertThisInitialized(t),"_seamlessSwitching",!1),_defineProperty$1(_assertThisInitialized(t),"_keyframes",null),_defineProperty$1(_assertThisInitialized(t),"_acceptRanges",!0),_defineProperty$1(_assertThisInitialized(t),"_onProgress",function(){var e=_asyncToGenerator(regenerator.mark((function e(r,n,i){var o,a,s,u;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.startTime,a=i.endTime,t._loading=!n,t._bufferService){e.next=4;break}return e.abrupt("return");case 4:return clearTimeout(t._maxChunkWaitTimer),t._bandwidthService.addChunkRecord(null==r?void 0:r.byteLength,a-o),e.prev=6,e.next=9,t._bufferService.appendBuffer(r);case 9:t.isLive&&(null===(s=t._bufferService)||void 0===s||s.evictBuffer(t._opts.bufferBehind)),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(6),e.abrupt("return",t._emitError(StreamingError.create(e.t0)));case 15:if(t._urlSwitching&&(t._urlSwitching=!1,t.emit(EVENT.SWITCH_URL_SUCCESS,{url:t._opts.url})),t._seamlessSwitching&&(t._seamlessSwitching=!1,t.media.play(),t._tick()),!n||t.media.seeking){e.next=27;break}if(t.emit(EVENT.LOAD_COMPLETE),logger$5.debug("load done",t._noEndOfStreamOnDone),!t._noEndOfStreamOnDone){e.next=24;break}t._noEndOfStreamOnDone=!1,e.next=25;break;case 24:return e.abrupt("return",t._end());case 25:e.next=29;break;case 27:(u=t._opts.maxReaderInterval)&&(clearTimeout(t._maxChunkWaitTimer),t._maxChunkWaitTimer=setTimeout((function(){logger$5.debug("onMaxChunkWait",u),t._end()}),u));case 29:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t,r,n){return e.apply(this,arguments)}}()),_defineProperty$1(_assertThisInitialized(t),"_onRetryError",(function(e,r){logger$5.debug("load retry",e,r),t.emit(EVENT.LOAD_RETRY,{error:StreamingError.network(e),retryTime:r})})),_defineProperty$1(_assertThisInitialized(t),"_end",(function(){t._clear(),t._bufferService&&t._bufferService.endOfStream(),logger$5.debug("end stream")})),_defineProperty$1(_assertThisInitialized(t),"_tick",(function(){clearTimeout(t._tickTimer);var e=_assertThisInitialized(t).media;if(e){t._tickTimer=setTimeout(t._tick,t._tickInterval);var r=Buffer.end(Buffer.get(e));if(!(r<.1)&&e.readyState){var n=t._opts;if(isMediaPlaying(e))t._gapService&&t._gapService.do(e,n.maxJumpDistance,t.isLive,3);else{if(!e.currentTime&&t._gapService)return void t._gapService.do(e,n.maxJumpDistance,t.isLive,3);n.isLive&&r>n.disconnectTime&&t.disconnect()}}}})),_defineProperty$1(_assertThisInitialized(t),"_onPlay",(function(){t.isLive&&!t._loading&&t.replay(void 0,!0)})),_defineProperty$1(_assertThisInitialized(t),"_onSeeking",_asyncToGenerator(regenerator.mark((function e(){var r,n,i,o,a;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLive||!t.seekable){e.next=14;break}if(r=t._keyframes.times,n=t._keyframes.filepositions,null!=r&&r.length&&null!=n&&n.length){e.next=5;break}return e.abrupt("return");case 5:if(i=t.media.currentTime,o=searchKeyframeIndex(t._keyframes.times,i),null!=(a=n[o])){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t._mediaLoader.cancel();case 12:t._loadData(null,[a]),t._bufferService.unContiguous(r[o]);case 14:case"end":return e.stop()}}),e)})))),_defineProperty$1(_assertThisInitialized(t),"_onTimeupdate",(function(){if(t.media){var e=t._opts,r=t.media.currentTime;if(e.isLive&&e.maxLatency&&e.targetLatency){var n=Buffer.end(Buffer.get(t.media));n-r>=e.maxLatency&&(t.media.currentTime=n-e.targetLatency)}t._seiService.throw(r)}})),_defineProperty$1(_assertThisInitialized(t),"_onFlvScriptData",(function(e){var r,n,i,o,a=null===(r=e.data)||void 0===r||null===(n=r.onMetaData)||void 0===n?void 0:n.keyframes,s=null===(i=e.data)||void 0===i||null===(o=i.onMetaData)||void 0===o?void 0:o.duration;a&&(t._keyframes=a),!t._opts.isLive&&s&&t._bufferService.updateDuration(s)})),t._opts=getOption$1(e),t.media=t._opts.media||document.createElement("video"),t._opts.media=null,t._mediaLoader=new NetLoader(_objectSpread$e(_objectSpread$e({},t._opts.fetchOptions),{},{retry:t._opts.retryCount,retryDelay:t._opts.retryDelay,timeout:t._opts.loadTimeout,onRetryError:t._onRetryError,onProgress:t._onProgress,responseType:"arraybuffer"})),t._bufferService=new BufferService$1(_assertThisInitialized(t),t._opts.softDecode?t.media:void 0,t._opts.analyzeDuration),t._seiService=new SeiService(_assertThisInitialized(t)),t._bandwidthService=new BandwidthService,t._opts.softDecode||(t._gapService=new GapService),t.media.addEventListener("play",t._onPlay),t.media.addEventListener("seeking",t._onSeeking),t.media.addEventListener("timeupdate",t._onTimeupdate),t.on(EVENT.FLV_SCRIPT_DATA,t._onFlvScriptData),t}return _createClass$1(c,[{key:"version",get:function(){return"3.0.0-next.6"}},{key:"isLive",get:function(){return this._opts.isLive}},{key:"baseDts",get:function(){var e;return null===(e=this._bufferService)||void 0===e?void 0:e.baseDts}},{key:"seekable",get:function(){return!!this._keyframes&&this._acceptRanges}},{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"bufferInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;return Buffer.info(Buffer.get(this.media),null===(e=this.media)||void 0===e?void 0:e.currentTime,t)}},{key:"playbackQuality",value:function(){return getVideoPlaybackQuality(this.media)}},{key:"load",value:(s=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._bufferService){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._reset();case 4:this._loadData(t),clearTimeout(this._tickTimer),this._tickTimer=setTimeout(this._tick,this._tickInterval);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"replay",value:(a=_asyncToGenerator(regenerator.mark((function e(){var t,r,n=this,i=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:this._opts.seamlesslyReload,r=i.length>1?i[1]:void 0,this.media){e.next=4;break}return e.abrupt("return");case 4:if(!t){e.next=11;break}return this._noEndOfStreamOnDone=!0,e.next=8,this._clear();case 8:setTimeout((function(){n._loadData(n._opts.url),n._bufferService.seamlessSwitch(),n._seamlessSwitching=!0})),e.next=13;break;case 11:return e.next=13,this.load();case 13:return e.abrupt("return",this.media.play(!r));case 14:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"disconnect",value:function(){return this._clear()}},{key:"switchURL",value:(o=_asyncToGenerator(regenerator.mark((function e(t,r){var n=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._bufferService){e.next=2;break}return e.abrupt("return");case 2:if(r&&this._opts.isLive){e.next=7;break}return e.next=5,this.load(t);case 5:return this._urlSwitching=!0,e.abrupt("return",this.media.play(!0));case 7:return this._noEndOfStreamOnDone=!0,e.next=10,this._clear();case 10:setTimeout((function(){n._loadData(t),n._bufferService.seamlessSwitch(),n._urlSwitching=!0,n._seamlessSwitching=!0}));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"destroy",value:(i=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.media){e.next=2;break}return e.abrupt("return");case 2:return this.removeAllListeners(),this._seiService.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),e.next=9,Promise.all([this._clear(),this._bufferService.destroy()]);case 9:this.media=null,this._bufferService=null;case 11:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_emitError",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];logger$5.table(e),logger$5.error(e),logger$5.error(null===(t=this.media)||void 0===t?void 0:t.error),this._urlSwitching&&(this._urlSwitching=!1,this._seamlessSwitching=!1,this.emit(EVENT.SWITCH_URL_FAILED,e)),this.emit(EVENT.ERROR,e),r&&(this._seiService.reset(),this._end())}},{key:"_reset",value:(n=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._seiService.reset(),this._bandwidthService.reset(),e.next=4,this._clear();case 4:return e.next=6,this._bufferService.reset();case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_loadData",value:(r=_asyncToGenerator(regenerator.mark((function e(t,r){var n,i,o,a,s;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(this._opts.url=t),t=this._opts.url){e.next=4;break}throw new Error("Source url is missing");case 4:return this.emit(EVENT.LOAD_START,{url:t}),logger$5.debug("load data",t),this._loading=!0,e.prev=7,e.next=10,this._mediaLoader.load({url:t,range:r});case 10:if(n=e.sent){e.next=13;break}return e.abrupt("return");case 13:i=n.response,o=n.firstByteTime,a=n.startTime,s=i.headers,this.emit(EVENT.TTFB,{url:t,responseUrl:i.url,elapsed:o-a}),this.emit(EVENT.LOAD_RESPONSE_HEADERS,{headers:s}),this._acceptRanges=!(null==s||!s.get("Accept-Ranges"))||!(null==s||!s.get("Content-Range")),this.isLive&&this._bufferService.updateDuration(1/0),e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(7),e.abrupt("return",this._emitError(StreamingError.network(e.t0)));case 24:case"end":return e.stop()}}),e,this,[[7,21]])}))),function(e,t){return r.apply(this,arguments)})},{key:"_clear",value:(t=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(this._maxChunkWaitTimer),clearTimeout(this._tickTimer),!this._mediaLoader){e.next=5;break}return e.next=5,this._mediaLoader.cancel();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"isSupported",value:function(e){return e?softDecodeProbe():MSE$2.isSupported()||softDecodeProbe()}},{key:"enableLogger",value:function(){Logger$2.enable(),Logger$1.enable()}},{key:"disableLogger",value:function(){Logger$2.disable(),Logger$1.disable()}}]),c}(EventEmitter$1);try{localStorage.getItem("xgd")?Flv.enableLogger():Flv.disableLogger()}catch(error){}function ownKeys$g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$g(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var PluginExtension$1=function(){function e(t,r){var n=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_onLowDecode",(function(){var e,t,r,i,o=n._opts,a=o.media,s=o.innerDegrade,u=o.backupURL;null===(e=n._plugin)||void 0===e||null===(t=e.player)||void 0===t||t.emit("lowdecode",a.degradeInfo),null===(r=n._plugin)||void 0===r||null===(i=r.player)||void 0===i||i.emit("core_event",_objectSpread$d(_objectSpread$d({},a.degradeInfo),{},{eventName:EVENT.LOWDECODE})),1!==s&&3!==s||!u||n._degrade(u)})),_defineProperty$1(this,"_degrade",(function(e){var t=n._plugin.player,r=t.video;if("MVideo"===(null==r?void 0:r.TAG)){var i=t.video.degradeVideo;t.video=i,r.degrade(e),e&&(t.config.url=e);var o=t.root.firstChild;"MVideo"===o.TAG&&t.root.replaceChild(i,o);var a=n._plugin.constructor.pluginName.toLowerCase();t.unRegisterPlugin(a),t.once("canplay",(function(){t.play()}))}})),_defineProperty$1(this,"forceDegradeToVideo",(function(e){var t=n._opts.innerDegrade;1!==t&&3!==t||n._degrade(e)})),this._opts=t,this._plugin=r,this._init()}return _createClass$1(e,[{key:"_init",value:function(){var e=this._opts,t=e.media,r=e.preloadTime,n=e.innerDegrade,i=e.decodeMode;t&&(n&&t.setAttribute("innerdegrade",n),r&&t.setAttribute("preloadtime",r),t.setDecodeMode&&t.setDecodeMode(i),this._bindEvents())}},{key:"_bindEvents",value:function(){this._opts.media.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var e,t;null===(e=this._opts)||void 0===e||null===(t=e.media)||void 0===t||t.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),e}();function ownKeys$f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$f(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper$l(e){var t=_isNativeReflectConstruct$l();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var FlvPlugin$1=function(e){_inherits(r,e);var t=_createSuper$l(r);function r(){var e;_classCallCheck$1(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$1(_assertThisInitialized(e=t.call.apply(t,[this].concat(i))),"flv",null),_defineProperty$1(_assertThisInitialized(e),"pluginExtension",null),_defineProperty$1(_assertThisInitialized(e),"destroy",(function(){var t;e.flv&&(e.flv.destroy(),e.flv=null),null===(t=e.pluginExtension)||void 0===t||t.destroy(),e.pluginExtension=null})),_defineProperty$1(_assertThisInitialized(e),"_onSwitchURL",(function(t,r){e.flv&&(e.player.config.url=t,e.flv.switchURL(t,r))})),_defineProperty$1(_assertThisInitialized(e),"_onDefinitionChange",(function(t){var r=t.to;e.flv&&e.flv.switchURL(r)})),e}return _createClass$1(r,[{key:"core",get:function(){return this.flv}},{key:"version",get:function(){var e;return null===(e=this.flv)||void 0===e?void 0:e.version}},{key:"softDecode",get:function(){var e,t;return"live-video"===(null===(e=this.player)||void 0===e||null===(t=e.config)||void 0===t?void 0:t.mediaType)}},{key:"beforePlayerInit",value:function(){var e=this,t=this.player.config;this.flv&&this.flv.destroy(),this.player.switchURL=this._onSwitchURL;var r,n=t.flv||{};(null==n.disconnectTime&&(n.disconnectTime=0),this.flv=new Flv(_objectSpread$c({softDecode:this.softDecode,isLive:t.isLive,media:this.player.video},n)),this.softDecode||BasePlugin.defineGetterOrSetter(this.player,{url:{get:function(){var t,r;return null===(t=e.flv)||void 0===t||null===(r=t.media)||void 0===r?void 0:r.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new PluginExtension$1(_objectSpread$c({media:this.player.video},t.flv),this),this.player.forceDegradeToVideo=function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(t=e.pluginExtension)||void 0===t?void 0:t.forceDegradeToVideo.apply(t,n)}),t.isLive)&&(null===(r=this.player)||void 0===r||r.useHooks("replay",(function(){var t;return null===(t=e.flv)||void 0===t?void 0:t.replay()})));this.on(URL_CHANGE,this._onSwitchURL),this.on(DESTROY,this.destroy),this._transError(),this._transCoreEvent(EVENT.TTFB),this._transCoreEvent(EVENT.LOAD_START),this._transCoreEvent(EVENT.LOAD_RESPONSE_HEADERS),this._transCoreEvent(EVENT.LOAD_COMPLETE),this._transCoreEvent(EVENT.LOAD_RETRY),this._transCoreEvent(EVENT.SOURCEBUFFER_CREATED),this._transCoreEvent(EVENT.ANALYZE_DURATION_EXCEEDED),this._transCoreEvent(EVENT.REMOVE_BUFFER),this._transCoreEvent(EVENT.BUFFEREOS),this._transCoreEvent(EVENT.KEYFRAME),this._transCoreEvent(EVENT.METADATA_PARSED),this._transCoreEvent(EVENT.SEI),this._transCoreEvent(EVENT.SEI_IN_TIME),this._transCoreEvent(EVENT.FLV_SCRIPT_DATA),this._transCoreEvent(EVENT.STREAM_EXCEPTION),this._transCoreEvent(EVENT.SWITCH_URL_SUCCESS),this._transCoreEvent(EVENT.SWITCH_URL_FAILED),this.flv.load(t.url)}},{key:"_transError",value:function(){var e=this;this.flv.on(EVENT.ERROR,(function(t){e.player&&e.player.emit(ERROR$2,new Errors$2(e.player,t))}))}},{key:"_transCoreEvent",value:function(e){var t=this;this.flv.on(e,(function(r){t.player&&t.player.emit("core_event",_objectSpread$c(_objectSpread$c({},r),{},{eventName:e}))}))}}],[{key:"pluginName",get:function(){return"flv"}},{key:"isSupported",value:function(e){return Flv.isSupported(e)}}]),r}(BasePlugin);_defineProperty$1(FlvPlugin$1,"Flv",Flv);var FlvPlugin=FlvPlugin$1;function ownKeys$e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$e(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Event$3=_objectSpread$b(_objectSpread$b({},EVENT),{},{STREAM_PARSED:"core.streamparsed"});function ownKeys$d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$d(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function getConfig(e){var t=(null==e?void 0:e.media)||document.createElement("video");return _objectSpread$a(_objectSpread$a({maxPlaylistSize:50,retryCount:3,retryDelay:1e3,loadTimeout:1e4,preloadTime:30,softDecode:!1,bufferBehind:10,maxJumpDistance:3,startTime:0},e),{},{media:t})}function clamp(e,t,r){return Math.min(Math.max(e,t),r)}var Stream$2=function(){function e(t,r){_classCallCheck$1(this,e),_defineProperty$1(this,"live",void 0),_defineProperty$1(this,"id",0),_defineProperty$1(this,"bitrate",0),_defineProperty$1(this,"width",0),_defineProperty$1(this,"height",0),_defineProperty$1(this,"name",""),_defineProperty$1(this,"url",""),_defineProperty$1(this,"audioCodec",""),_defineProperty$1(this,"videoCodec",""),_defineProperty$1(this,"textCodec",""),_defineProperty$1(this,"startCC",0),_defineProperty$1(this,"endCC",0),_defineProperty$1(this,"startSN",0),_defineProperty$1(this,"endSN",-1),_defineProperty$1(this,"totalDuration",0),_defineProperty$1(this,"targetDuration",0),_defineProperty$1(this,"snDiff",null),_defineProperty$1(this,"segments",[]),_defineProperty$1(this,"audioStreams",[]),_defineProperty$1(this,"currentAudioStream",null),this.update(t,r)}return _createClass$1(e,[{key:"lastSegment",get:function(){if(this.segments.length)return this.segments[this.segments.length-1]}},{key:"segmentDuration",get:function(){var e;return this.targetDuration||(null===(e=this.segments[0])||void 0===e?void 0:e.duration)||0}},{key:"liveEdge",get:function(){return this.endTime}},{key:"endTime",get:function(){var e;return(null===(e=this.lastSegment)||void 0===e?void 0:e.end)||0}},{key:"clearOldSegment",value:function(e,t){return this.currentAudioStream&&this._clearSegments(this.currentAudioStream,e,t),this._clearSegments(this,e,t)}},{key:"getAudioSegment",value:function(e){if(e&&this.currentAudioStream){var t=e.sn-this.snDiff;return this.currentAudioStream.segments.find((function(e){return e.sn===t}))}}},{key:"update",value:function(e,t){this.url=e.url,Array.isArray(e.segments)?(null==this.live&&(this.live=e.live),this._updateSegments(e,this),this.startCC=e.startCC,this.endCC=e.endCC,this.startSN=e.startSN,this.endSN=e.endSN||-1,this.totalDuration=e.totalDuration,this.targetDuration=e.targetDuration,this.live=e.live,t&&this.currentAudioStream&&Array.isArray(t.segments)&&(this._updateSegments(t,this.currentAudioStream),null==this.snDiff&&e.segments.length&&t.segments.length&&(this.snDiff=e.segments[0].sn-t.segments[0].sn))):(this.id=e.id,this.bitrate=e.bitrate,this.width=e.width,this.height=e.height,this.name=e.name,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.textCodec=e.textCodec,this.audioStreams=e.audioStreams,!this.currentAudioStream&&this.audioStreams.length&&(this.currentAudioStream=this.audioStreams.find((function(e){return e.default}))||this.audioStreams[0]))}},{key:"_clearSegments",value:function(e,t){for(var r=0,n=this.segments,i=0,o=n.length;i<o;i++)if(n[i].end>=e){r=i;break}return r>t&&(r=t),r&&(this.segments=this.segments.slice(r),this.currentAudioStream&&(this.currentAudioStream.segments=this.currentAudioStream.segments.slice(r))),t-r}},{key:"_updateSegments",value:function(e,t){var r=t.segments;if(this.live){var n=r[r.length-1],i=(null==n?void 0:n.sn)||-1;if(i<e.endSN&&e.segments.length){var o=e.segments.findIndex((function(e){return e.sn===i})),a=o<0?e.segments:e.segments.slice(o+1);if(r.length&&a.length){var s=n.end;a.forEach((function(e){e.start=s,s=e.end}));var u=(null==n?void 0:n.cc)||-1;u>a[0].cc&&a.forEach((function(e){return e.cc+=u}))}t.segments=r.concat(a)}}else t.segments=e.segments}}]),e}(),Playlist=function(){function e(t){_classCallCheck$1(this,e),_defineProperty$1(this,"streams",[]),_defineProperty$1(this,"currentStream",null),_defineProperty$1(this,"dvrWindow",0),_defineProperty$1(this,"_segmentPointer",-1),this.hls=t}return _createClass$1(e,[{key:"lastSegment",get:function(){var e;return null===(e=this.currentStream)||void 0===e?void 0:e.lastSegment}},{key:"currentSegment",get:function(){var e;return null===(e=this.currentSegments)||void 0===e?void 0:e[this._segmentPointer]}},{key:"nextSegment",get:function(){var e;return null===(e=this.currentSegments)||void 0===e?void 0:e[this._segmentPointer+1]}},{key:"currentSegments",get:function(){var e;return null===(e=this.currentStream)||void 0===e?void 0:e.segments}},{key:"liveEdge",get:function(){var e;return null===(e=this.currentStream)||void 0===e?void 0:e.liveEdge}},{key:"seekRange",get:function(){var e=this.currentSegments;if(e&&e.length)return[e[0].start,e[e.length-1].end]}},{key:"isEmpty",get:function(){var e;return!(null!==(e=this.currentSegments)&&void 0!==e&&e.length)}},{key:"isLive",get:function(){var e;return null===(e=this.currentStream)||void 0===e?void 0:e.live}},{key:"getAudioSegment",value:function(e){var t;return null===(t=this.currentStream)||void 0===t?void 0:t.getAudioSegment(e)}},{key:"moveSegmentPointer",value:function(e){var t;null==e&&(e=this._segmentPointer+1),this._segmentPointer=clamp(e,-1,null===(t=this.currentSegments)||void 0===t?void 0:t.length)}},{key:"reset",value:function(){this.streams=[],this.currentStream=null,this.dvrWindow=0,this._segmentPointer=-1}},{key:"getSegmentByIndex",value:function(e){var t;return null===(t=this.currentSegments)||void 0===t?void 0:t[e]}},{key:"setNextSegmentByIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._segmentPointer=e-1}},{key:"findSegmentIndexByTime",value:function(e){var t=this.currentSegments;if(t){for(var r,n=0,i=t.length;n<i;n++)if(e>=(r=t[n]).start&&e<r.end)return n;var o=t[t.length-1];if(Math.abs(e-o.end)<.2)return t.length-1}}},{key:"upsertPlaylist",value:function(e,t){var r=this;if(e){if(e.isMaster)this.streams.length=e.streams.length,e.streams.filter((function(e){return e.url})).forEach((function(e,t){r.streams[t]?r.streams[t].update(e):r.streams[t]=new Stream$2(e)})),this.currentStream=this.streams[0];else if(Array.isArray(e.segments)){var n=this.currentStream;n?n.update(e,t):(this.reset(),this.currentStream=this.streams[0]=new Stream$2(e,t))}this.currentStream&&this.hls.isLive&&!this.dvrWindow&&(this.dvrWindow=this.currentSegments.reduce((function(e,t){return e+=t.duration}),0))}}},{key:"clearOldSegment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=this.currentStream;if(this.dvrWindow&&t){var r=t.endTime-this.dvrWindow;if(!(r<=0)){var n=t.segments;n.length<=e||(this._segmentPointer=t.clearOldSegment(r,this._segmentPointer))}}}}]),e}(),Decryptor=function(){function e(){_classCallCheck$1(this,e);var t=window.crypto||window.msCrypto;this.subtle=t&&(t.subtle||t.webkitSubtle),this.externalDecryptor=null}var t,r;return _createClass$1(e,[{key:"decrypt",value:function(e,t){if(e||t){var r=[];return e&&(r[0]=this._decryptSegment(e)),t&&(r[1]=this._decryptSegment(t)),Promise.all(r)}}},{key:"_decryptSegment",value:(r=_asyncToGenerator(regenerator.mark((function e(t){var r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,!t.key){e.next=5;break}return e.next=4,this._decryptData(t.data,t.key,t.keyIv);case 4:r=e.sent;case 5:if(t.map){e.next=7;break}return e.abrupt("return",r);case 7:return e.abrupt("return",concatUint8Array$1(t.map,r));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_decryptData",value:(t=_asyncToGenerator(regenerator.mark((function e(t,r,n){var i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.externalDecryptor){e.next=6;break}return e.next=3,this.externalDecryptor.decrypt(t,r,n);case 3:return e.abrupt("return",e.sent);case 6:if(this.subtle){e.next=8;break}throw new Error("crypto is not defined");case 8:return e.next=10,this.subtle.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt","decrypt"]);case 10:return i=e.sent,e.t0=Uint8Array,e.next=14,this.subtle.decrypt({name:"AES-CBC",iv:n},i,t);case 14:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 16:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})}]),e}();function ownKeys$c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$9(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$c(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var logger$4=new Logger$2("Transmuxer"),Transmuxer=function(){function e(t,r,n){_classCallCheck$1(this,e),this.hls=t,this._demuxer=r?new FMP4Demuxer:new TsDemuxer,this._isMP4=r,n&&(this._remuxer=new FMP4Remuxer(this._demuxer.videoTrack,this._demuxer.audioTrack))}return _createClass$1(e,[{key:"transmux",value:function(e,t,r,n,i,o){var a=this._demuxer;try{this._isMP4?a.demux(e,t):a.demuxAndFix(concatUint8Array$1(e,t),r,n,i)}catch(error){throw new StreamingError(ERR.DEMUX,ERR.SUB_TYPES.HLS,error)}var s=a.videoTrack,u=a.audioTrack,c=a.metadataTrack;if(this._fireEvents(s,u,c,r),!this._remuxer)return[s,u];try{var l=this._remuxer.remux(o),d=l.videoInitSegment,f=l.videoSegment,h=l.audioInitSegment,p=l.audioSegment,g=concatUint8Array$1(d,f),y=concatUint8Array$1(h,p);return[g?{codec:s.codec,data:g}:void 0,y?{codec:u.codec,data:y}:void 0]}catch(error){throw new StreamingError(ERR.REMUX,ERR.SUB_TYPES.FMP4,error)}}},{key:"_fireEvents",value:function(e,t,r,n){var i=this;logger$4.debug(e.samples,t.samples),n&&(e.exist()&&this.hls.emit(Event$3.METADATA_PARSED,{type:"video",meta:{codec:e.codec,timescale:e.timescale,width:e.width,height:e.height,sarRatio:e.sarRatio,baseDts:e.baseDts}}),t.exist()&&this.hls.emit(Event$3.METADATA_PARSED,{type:"audio",meta:{codec:t.codec,channelCount:t.channelCount,sampleRate:t.sampleRate,timescale:t.timescale,baseDts:t.baseDts}}),logger$4.debug("discontinuity",e,t)),e.warnings.forEach((function(e){var t;switch(e.type){case WarningType.LARGE_AV_SHIFT:t=Event$3.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case WarningType.LARGE_VIDEO_GAP:t=Event$3.LARGE_VIDEO_DTS_GAP_DETECT;break;case WarningType.LARGE_VIDEO_GAP_BETWEEN_CHUNK:t=Event$3.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT}t&&i.hls.emit(Event$3.STREAM_EXCEPTION,_objectSpread$9(_objectSpread$9({},e),{},{type:t})),logger$4.warn("video exception",e)})),t.warnings.forEach((function(e){var t;switch(e.type){case WarningType.LARGE_AUDIO_GAP:t=Event$3.LARGE_AUDIO_DTS_GAP_DETECT;break;case WarningType.AUDIO_FILLED:t=Event$3.AUDIO_GAP_DETECT;break;case WarningType.AUDIO_DROPPED:t=Event$3.AUDIO_OVERLAP_DETECT}t&&i.hls.emit(Event$3.STREAM_EXCEPTION,_objectSpread$9(_objectSpread$9({},e),{},{type:t})),logger$4.warn("audio exception",e)})),e.samples.forEach((function(e){e.keyframe&&i.hls.emit(Event$3.KEYFRAME,{pts:e.pts})})),r.seiSamples.forEach((function(e){i.hls.emit(Event$3.SEI,_objectSpread$9(_objectSpread$9({},e),{},{originPts:e.originPts/90,sei:{code:e.data.type,content:e.data.payload,dts:e.pts}}))}))}}]),e}(),logger$3=new Logger$2("BufferService"),BufferService=function(){function e(t){_classCallCheck$1(this,e),_defineProperty$1(this,"_decryptor",new Decryptor),_defineProperty$1(this,"_transmuxer",null),_defineProperty$1(this,"_mse",null),_defineProperty$1(this,"_softVideo",null),_defineProperty$1(this,"_sourceCreated",!1),_defineProperty$1(this,"_needInitSegment",!0),_defineProperty$1(this,"_directAppend",!1),this.hls=t,t.config.softDecode?this._softVideo=t.media:(this._mse=new MSE$2,this._mse.bindMedia(t.media)),t.config.decryptor&&(this._decryptor.externalDecryptor=t.config.decryptor)}var t,r,n,i,o,a,s,u;return _createClass$1(e,[{key:"baseDts",get:function(){var e,t,r;return null===(e=this._transmuxer)||void 0===e||null===(t=e._demuxer)||void 0===t||null===(r=t._fixer)||void 0===r?void 0:r._baseDts}},{key:"updateDuration",value:(u=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(logger$3.debug("update duration",t),!this._mse){e.next=9;break}if(this._mse.isOpened){e.next=5;break}return e.next=5,this._mse.open();case 5:return e.next=7,this._mse.updateDuration(t);case 7:e.next=10;break;case 9:this._softVideo&&(this._softVideo.duration=t);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"createSource",value:function(e,t,r,n){if(!this._sourceCreated){var i=e||t;if(i){if(TsDemuxer.probe(i))this._transmuxer||(this._transmuxer=new Transmuxer(this.hls,!1,!this._softVideo));else{if(!MP4Parser.probe(i))throw new StreamingError(ERR.OTHER,null,null,null,"unsupported stream");if(this._softVideo)this._transmuxer||(this._transmuxer=new Transmuxer(this.hls,!0));else{this._directAppend=!0;var o=!1;e&&!r&&MP4Parser.findBox(e,["moov","trak"]).forEach((function(e){var t=MP4Parser.findBox(e.data,["trak","mdia","minf","stbl","stsd"])[0];if(t){var i=MP4Parser.stsd(t).entries[0];if(i)if(i.hvcC)r=i.hvcC.codec||"hev1.1.6.L93.B0";else if(i.avcC)r=i.avcC.codec;else if(i.sampleRate||i.esds){var a;n=(null===(a=i.esds)||void 0===a?void 0:a.codec)||"mp4a.40.2",o=!0}}})),t&&!n&&MP4Parser.findBox(t,["moov","trak","mdia","minf","stbl","stsd"]).forEach((function(e){var t=MP4Parser.stsd(e).entries[0];t&&t.esds&&(n=t.esds.codec)})),e&&!r&&(r="avc1.42e01e"),t&&!n&&(n="mp4a.40.2"),o&&(r+=", ".concat(n),n=""),this._createMseSource(r,n)}}this._softVideo&&(this._sourceCreated=!0)}}}},{key:"appendBuffer",value:(s=_asyncToGenerator(regenerator.mark((function e(t,r,n,i,o){var a,s,u,c,l,d;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.length||null!=r&&r.length){e.next=2;break}return e.abrupt("return");case 2:if(!this._directAppend){e.next=7;break}return a=[],t&&a.push(this._mse.append(MSE$2.VIDEO,t)),r&&a.push(this._mse.append(MSE$2.AUDIO,r)),e.abrupt("return",Promise.all(a));case 7:if(s=this._transmuxer.transmux(t,r,n,i,o,this._needInitSegment||n),u=_slicedToArray(s,2),c=u[0],l=u[1],!this._softVideo){e.next=12;break}this._softVideo.appendBuffer(c,l),e.next=20;break;case 12:if(!this._mse){e.next=20;break}return this._sourceCreated||this._createMseSource(null==c?void 0:c.codec,null==l?void 0:l.codec),this._needInitSegment=!1,d=this._mse,a=[],c&&a.push(d.append(MSE$2.VIDEO,c.data)),l&&a.push(d.append(MSE$2.AUDIO,l.data)),e.abrupt("return",Promise.all(a));case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i){return s.apply(this,arguments)})},{key:"evictBuffer",value:(a=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.hls.media,this._mse&&r&&t&&!(t<0)){e.next=3;break}return e.abrupt("return");case 3:if(n=r.currentTime,!((i=n-t)<=0)){e.next=7;break}return e.abrupt("return");case 7:if(!(Buffer.start(Buffer.get(r))+1>=i)){e.next=10;break}return e.abrupt("return");case 10:return e.abrupt("return",this._mse.clearBuffer(0,i).then((function(){return o.hls.emit(EVENT.REMOVE_BUFFER,{removeEnd:i})})));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"clearAllBuffer",value:(o=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=2;break}return e.abrupt("return",this._mse.clearAllBuffer());case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"decryptBuffer",value:function(e,t){return this._decryptor.decrypt(e,t)}},{key:"reset",value:(i=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=5;break}return e.next=3,this._mse.unbindMedia();case 3:return e.next=5,this._mse.bindMedia(this.hls.media);case 5:this._transmuxer=null,this._sourceCreated=!1,this._needInitSegment=!0,this._directAppend=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"endOfStream",value:(n=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=5;break}if(!this._sourceCreated){e.next=5;break}return e.next=4,this._mse.endOfStream();case 4:this.hls.emit(EVENT.BUFFEREOS);case 5:this._softVideo&&this._softVideo.endOfStream();case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setLiveSeekableRange",value:(r=_asyncToGenerator(regenerator.mark((function e(t,r){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._mse&&this._mse.setLiveSeekableRange(t,r);case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"destroy",value:(t=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._mse,this._mse=null,this._softVideo=null,!t){e.next=6;break}return e.next=6,t.unbindMedia();case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_createMseSource",value:function(e,t){logger$3.debug("create mse source, videoCodec=".concat(e,", audioCodec=").concat(t));var r=this._mse;r&&(e&&(r.createSource(MSE$2.VIDEO,"video/mp4;codecs=".concat(e)),this._sourceCreated=!0),t&&(r.createSource(MSE$2.AUDIO,"audio/mp4;codecs=".concat(t)),this._sourceCreated=!0),this.hls.emit(EVENT.SOURCEBUFFER_CREATED))}}]),e}(),MasterPlaylist=_createClass$1((function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"version",0),_defineProperty$1(this,"streams",[]),_defineProperty$1(this,"isMaster",!0)})),AudioStream=_createClass$1((function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"id",0),_defineProperty$1(this,"url",""),_defineProperty$1(this,"default",!1),_defineProperty$1(this,"group",""),_defineProperty$1(this,"name",""),_defineProperty$1(this,"lang",""),_defineProperty$1(this,"channels",0),_defineProperty$1(this,"segments",[])})),MasterStream=_createClass$1((function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"id",0),_defineProperty$1(this,"bitrate",0),_defineProperty$1(this,"width",0),_defineProperty$1(this,"height",0),_defineProperty$1(this,"name",""),_defineProperty$1(this,"url",""),_defineProperty$1(this,"audioCodec",""),_defineProperty$1(this,"videoCodec",""),_defineProperty$1(this,"textCodec",""),_defineProperty$1(this,"audioGroup",""),_defineProperty$1(this,"audioStreams",[])})),MediaPlaylist=_createClass$1((function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"version",0),_defineProperty$1(this,"url",""),_defineProperty$1(this,"type",""),_defineProperty$1(this,"startCC",0),_defineProperty$1(this,"endCC",0),_defineProperty$1(this,"startSN",0),_defineProperty$1(this,"endSN",0),_defineProperty$1(this,"totalDuration",0),_defineProperty$1(this,"targetDuration",0),_defineProperty$1(this,"live",!0),_defineProperty$1(this,"segments",[])})),MediaSegment=function(){function e(){_classCallCheck$1(this,e),_defineProperty$1(this,"sn",0),_defineProperty$1(this,"cc",0),_defineProperty$1(this,"url",""),_defineProperty$1(this,"title",""),_defineProperty$1(this,"start",0),_defineProperty$1(this,"duration",0),_defineProperty$1(this,"key",null),_defineProperty$1(this,"byteRange",null),_defineProperty$1(this,"isInitSegment",!1),_defineProperty$1(this,"initSegment",null),_defineProperty$1(this,"isLast",!1)}return _createClass$1(e,[{key:"end",get:function(){return this.start+this.duration}},{key:"setByteRange",value:function(e,t){this.byteRange=[0];var r=e.split("@");1===r.length&&t&&t.byteRange?(this.byteRange[0]=t.byteRange[1]||0,this.byteRange[0]&&(this.byteRange[0]+=1)):this.byteRange[0]=parseInt(r[1]),this.byteRange[1]=this.byteRange[0]+parseInt(r[0])-1}}]),e}(),MediaSegmentKey=function(){function e(t){_classCallCheck$1(this,e),_defineProperty$1(this,"method",""),_defineProperty$1(this,"url",""),_defineProperty$1(this,"iv",null),_defineProperty$1(this,"keyFormat",""),_defineProperty$1(this,"keyFormatVersions",""),t instanceof e&&(this.method=t.method,this.url=t.url,this.keyFormat=t.keyFormat,this.keyFormatVersions=t.keyFormatVersions,t.iv&&(this.iv=new Uint8Array(t.iv)))}return _createClass$1(e,[{key:"clone",value:function(t){var r=new e(this);return null!=t&&r.setIVFromSN(t),r}},{key:"setIVFromSN",value:function(e){if(!this.iv&&"AES-128"===this.method&&"number"==typeof e&&this.url){this.iv=new Uint8Array(16);for(var t=12;t<16;t++)this.iv[t]=e>>8*(15-t)&255}}}]),e}(),REGEXP_TAG=/^#(EXT[^:]*)(?::(.*))?$/,REGEXP_ATTR=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,REGEXP_ABSOLUTE_URL=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,REGEXP_URL_PAIR=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function getLines(e){return e.split(/[\r\n]/).map((function(e){return e.trim()})).filter(Boolean)}function parseTag(e){var t=e.match(REGEXP_TAG);if(t&&t[1])return[t[1].replace("EXT-X-",""),t[2]]}function parseAttr(e){for(var t={},r=REGEXP_ATTR.exec(e);r;)t[r[1]]=r[2]||r[3],r=REGEXP_ATTR.exec(e);return t}function getAbsoluteUrl(e,t){if(!t||!e||REGEXP_ABSOLUTE_URL.test(e))return e;var r=REGEXP_URL_PAIR.exec(t);return r?"/"===e[0]?r[1]+e:r[1]+r[2]+e:e}var CODECS_REGEXP={audio:[/^mp4a/,/^vorbis$/,/^opus$/,/^flac$/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function getCodecs(e,t){var r=CODECS_REGEXP[e];if(r&&t&&t.length)for(var n=0;n<r.length;n++)for(var i=0;i<t.length;i++)if(r[n].test(t[i]))return t[i]}function parseMasterPlaylist(e,t){for(var r,n=new MasterPlaylist,i=0,o=[];r=e[i++];){var a=parseTag(r);if(a){var s=_slicedToArray(a,2),u=s[0],c=s[1];if("VERSION"===u)n.version=parseInt(c);else if("MEDIA"===u&&c){var l=parseAttr(c);if("AUDIO"===l.TYPE&&l.URI){var d=new AudioStream;d.url=getAbsoluteUrl(l.URI,t),d.default="YES"===l.DEFAULT,d.group=l["GROUP-ID"],d.name=l.NAME,d.lang=l.LANGUAGE,l.CHANNELS&&(d.channels=Number(l.CHANNELS.split("/")[0]),isNaN(d.channels)&&(d.channels=0)),o.push(d)}}else if("STREAM-INF"===u&&c){var f=new MasterStream,h=parseAttr(c);if(f.bitrate=parseInt(h["AVERAGE-BANDWIDTH"]||h.BANDWIDTH),f.name=h.NAME,f.url=getAbsoluteUrl(e[i++],t),h.RESOLUTION){var p=_slicedToArray(h.RESOLUTION.split("x"),2),g=p[0],y=p[1];f.width=parseInt(g),f.height=parseInt(y)}if(h.CODECS){var v=h.CODECS.split(/[ ,]+/).filter(Boolean);f.videoCodec=getCodecs("video",v),f.audioCodec=getCodecs("audio",v),f.textCodec=getCodecs("text",v)}f.audioGroup=h.AUDIO,n.streams.push(f)}}}return n.streams.forEach((function(e,t){e.id=t})),o.length&&(o.forEach((function(e,t){e.id=t})),n.streams.forEach((function(e){e.audioGroup&&(e.audioStreams=o.filter((function(t){return t.group===e.audioGroup})))}))),n}function parseMediaPlaylist(e,t){var r=new MediaPlaylist;r.url=t;for(var n,i=new MediaSegment,o=null,a=null,s=0,u=0,c=0,l=0;n=e[l++];)if("#"===n[0]){var d=parseTag(n);if(d){var f=_slicedToArray(d,2),h=f[0],p=f[1];switch(h){case"VERSION":r.version=parseInt(p);break;case"PLAYLIST-TYPE":r.type=null==p?void 0:p.toUpperCase();break;case"TARGETDURATION":r.targetDuration=parseFloat(p);break;case"ENDLIST":var g=r.segments[r.segments.length-1];g&&(g.isLast=!0),r.live=!1;break;case"MEDIA-SEQUENCE":u=r.startSN=parseInt(p);break;case"DISCONTINUITY-SEQUENCE":c=r.startCC=parseInt(p);break;case"DISCONTINUITY":c++;break;case"BYTERANGE":i.setByteRange(p,r.segments[r.segments.length-1]);break;case"EXTINF":var y=_slicedToArray(p.split(","),2),v=y[0],m=y[1];i.start=s,i.duration=parseFloat(v),s+=i.duration,i.title=m;break;case"KEY":var _=parseAttr(p);if("NONE"===_.METHOD){a=null;break}if("AES-128"!==_.METHOD)throw new Error("encrypt ".concat(_.METHOD,"/").concat(_.KEYFORMAT," is not supported"));if((a=new MediaSegmentKey).method=_.METHOD,a.url=/^blob:/.test(_.URI)?_.URI:getAbsoluteUrl(_.URI,t),a.keyFormat=_.KEYFORMAT||"identity",a.keyFormatVersions=_.KEYFORMATVERSIONS,_.IV){var b=_.IV.slice(2);b=(1&b.length?"0":"")+b,a.iv=new Uint8Array(b.length/2);for(var A=0,E=b.length/2;A<E;A++)a.iv[A]=parseInt(b.slice(2*A,2*A+2),16)}break;case"MAP":var S=parseAttr(p);i.url=getAbsoluteUrl(S.URI,t),S.BYTERANGE&&i.setByteRange(S.BYTERANGE),i.isInitSegment=!0,i.sn=0,a&&(i.key=a.clone(0)),o=i,i=new MediaSegment}}}else i.sn=u,i.cc=c,i.url=getAbsoluteUrl(n,t),a&&(i.key=a.clone(u)),o&&(i.initSegment=o),r.segments.push(i),i=new MediaSegment,u++;var T=r.segments[r.segments.length-1];return T&&(r.endSN=T.sn),r.totalDuration=s,r.endCC=c,r}var M3U8Parser=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;if(!t.includes("#EXTM3U"))throw new Error("Invalid m3u8 file");var n=getLines(t);return e.isMediaPlaylist(t)?parseMediaPlaylist(n,r):parseMasterPlaylist(n,r)}},{key:"isMediaPlaylist",value:function(e){return e.includes("#EXTINF:")||e.includes("#EXT-X-TARGETDURATION:")}}]),e}();function ownKeys$b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$b(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ManifestLoader=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_onLoaderRetry",(function(e,t){r.hls.emit(Event$3.LOAD_RETRY,{error:StreamingError.network(e),retryTime:t})})),this.hls=t,this._timer=null;var n=this.hls.config,i=n.retryCount,o=n.retryDelay,a=n.loadTimeout,s=n.fetchOptions;this._loader=new NetLoader(_objectSpread$8(_objectSpread$8({},s),{},{responseType:"text",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry})),this._audioLoader=new NetLoader(_objectSpread$8(_objectSpread$8({},s),{},{responseType:"text",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry}))}var t;return _createClass$1(e,[{key:"load",value:(t=_asyncToGenerator(regenerator.mark((function e(t,r){var n,i,o,a,s,u,c,l,d,f;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[this._loader.load(t)],r&&n.push(this._audioLoader.load(r)),e.prev=2,e.next=5,Promise.all(n);case 5:if(a=e.sent,s=_slicedToArray(a,2),u=s[0],c=s[1],u){e.next=11;break}return e.abrupt("return",[]);case 11:i=u.data,o=null==c?void 0:c.data,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(2),StreamingError.network(e.t0);case 18:l=this.hls.config.onPreM3U8Parse,e.prev=19,l&&(i=l(i)||i,o&&(o=l(o,!0)||o)),d=M3U8Parser.parse(i,t),o&&(f=M3U8Parser.parse(o,r)),e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),new StreamingError(ERR.MANIFEST,ERR.SUB_TYPES.HLS);case 28:return d&&(d.isMaster?this.hls.emit(Event$3.HLS_MANIFEST_LOADED,{playlist:d}):this.hls.emit(Event$3.HLS_LEVEL_LOADED,{playlist:d})),e.abrupt("return",[d,f]);case 30:case"end":return e.stop()}}),e,this,[[2,15],[19,25]])}))),function(e,r){return t.apply(this,arguments)})},{key:"poll",value:function(e,t,r,n,i){var o=this;clearTimeout(this._timer),i=i||3e3;var a=function(){var s=_asyncToGenerator(regenerator.mark((function s(){var u;return regenerator.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return clearTimeout(o._timer),s.prev=1,s.next=4,o.load(e,t);case 4:if((u=s.sent)[0]){s.next=7;break}return s.abrupt("return");case 7:r(u[0],u[1]),o._timer=setTimeout(a,i),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),n(s.t0);case 14:case"end":return s.stop()}}),s,null,[[1,11]])})));return function(){return s.apply(this,arguments)}}();this._timer=setTimeout(a,i)}},{key:"stopPoll",value:function(){return clearTimeout(this._timer),this.cancel()}},{key:"cancel",value:function(){return Promise.all([this._loader.cancel(),this._audioLoader.cancel()])}}]),e}();function ownKeys$a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$a(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var SegmentLoader=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_emitOnLoaded",(function(e,t){var n=e.endTime-e.startTime;r._bandwidthService.addRecord(e.contentLength,n),r.hls.emit(EVENT.SPEED,{time:n,byteLength:e.contentLength,url:t}),r.hls.emit(EVENT.LOAD_COMPLETE,{url:t,elapsed:n||0});var i=e.response,o=e.firstByteTime,a=e.startTime;r.hls.emit(EVENT.TTFB,{url:t,responseUrl:i.url,elapsed:o-a}),r.hls.emit(EVENT.LOAD_RESPONSE_HEADERS,{headers:i.headers})})),_defineProperty$1(this,"_onLoaderRetry",(function(e,t){r.hls.emit(EVENT.LOAD_RETRY,{error:StreamingError.network(e),retryTime:t})})),this.hls=t,this._bandwidthService=new BandwidthService,this._mapCache={},this._keyCache={};var n=this.hls.config,i=n.retryCount,o=n.retryDelay,a=n.loadTimeout,s=n.fetchOptions;this._segmentLoader=new NetLoader(_objectSpread$7(_objectSpread$7({},s),{},{responseType:"arraybuffer",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry})),this._audioSegmentLoader=new NetLoader(_objectSpread$7(_objectSpread$7({},s),{},{responseType:"arraybuffer",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry})),this._keyLoader=new NetLoader(_objectSpread$7(_objectSpread$7({},s),{},{responseType:"arraybuffer",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry}))}var t,r;return _createClass$1(e,[{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"load",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,i=[];return e&&(i[0]=this.loadVideoSegment(e,r)),t&&(i[1]=this.loadAudioSegment(t,n)),Promise.all(i)}},{key:"loadVideoSegment",value:function(e,t){return this._loadSegment(this._segmentLoader,e,t)}},{key:"loadAudioSegment",value:function(e,t){return this._loadSegment(this._audioSegmentLoader,e,t)}},{key:"_loadSegment",value:(r=_asyncToGenerator(regenerator.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f,h,p,g,y,v,m,_=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=[],this.hls.emit(EVENT.LOAD_START,{url:r.url}),d[0]=t.load(r.url),n&&r.initSegment&&(h=r.initSegment.url,(a=this._mapCache[h])||(this.hls.emit(EVENT.LOAD_START,{url:h}),d[1]=t.load(h).then((function(e){e&&(Object.keys(_._mapCache)>30&&(_._mapCache={}),a=_._mapCache[h]=e.data,_._emitOnLoaded(e,h))}))),(p=null===(f=r.initSegment.key)||void 0===f?void 0:f.url)&&(l=r.initSegment.key.iv,(c=this._keyCache[p])||(this.hls.emit(EVENT.LOAD_START,{url:p}),d[2]=this._keyLoader.load(p).then((function(e){e&&(c=_._keyCache[p]=e.data,_._emitOnLoaded(e,p))}))))),(g=null===(i=r.key)||void 0===i?void 0:i.url)&&(u=r.key.iv,(s=this._keyCache[g])||(this.hls.emit(EVENT.LOAD_START,{url:g}),d[3]=this._keyLoader.load(g).then((function(e){e&&(s=_._keyCache[g]=e.data,_._emitOnLoaded(e,g))})))),e.next=8,Promise.all(d);case 8:if(y=e.sent,v=_slicedToArray(y,1),m=v[0]){e.next=13;break}return e.abrupt("return");case 13:return o=m.data,this._emitOnLoaded(m,r.url),e.abrupt("return",{data:o,map:a,key:s,mapKey:c,keyIv:u,mapKeyIv:l});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"reset",value:function(){this._mapCache={},this._keyCache={},this._bandwidthService.reset()}},{key:"cancel",value:(t=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._keyLoader.cancel(),this._segmentLoader.cancel(),this._audioSegmentLoader.cancel()]);case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function _createSuper$k(e){var t=_isNativeReflectConstruct$k();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var logger$2=new Logger$2("hls"),Hls=function(e){_inherits(f,e);var t,r,n,i,o,a,s,u,c,l,d=_createSuper$k(f);function f(e){var t;return _classCallCheck$1(this,f),_defineProperty$1(_assertThisInitialized(t=d.call(this)),"version",f.version),_defineProperty$1(_assertThisInitialized(t),"media",null),_defineProperty$1(_assertThisInitialized(t),"config",null),_defineProperty$1(_assertThisInitialized(t),"_manifestLoader",null),_defineProperty$1(_assertThisInitialized(t),"_segmentLoader",null),_defineProperty$1(_assertThisInitialized(t),"_playlist",null),_defineProperty$1(_assertThisInitialized(t),"_bufferService",null),_defineProperty$1(_assertThisInitialized(t),"_gapService",null),_defineProperty$1(_assertThisInitialized(t),"_seiService",null),_defineProperty$1(_assertThisInitialized(t),"_prevSegSn",null),_defineProperty$1(_assertThisInitialized(t),"_prevSegCc",null),_defineProperty$1(_assertThisInitialized(t),"_tickTimer",null),_defineProperty$1(_assertThisInitialized(t),"_tickInterval",500),_defineProperty$1(_assertThisInitialized(t),"_segmentProcessing",!1),_defineProperty$1(_assertThisInitialized(t),"_reloadOnPlay",!1),_defineProperty$1(_assertThisInitialized(t),"_loadM3U8",function(){var e=_asyncToGenerator(regenerator.mark((function e(r){var n,i,o,a;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,t._manifestLoader.load(r);case 4:i=e.sent,o=_slicedToArray(i,1),n=o[0],e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),t._emitError(StreamingError.create(e.t0));case 12:if(n){e.next=14;break}return e.abrupt("return");case 14:if(t._playlist.upsertPlaylist(n),!n.isMaster){e.next=18;break}return e.next=18,t._refreshM3U8();case 18:if(t.emit(Event$3.STREAM_PARSED),!t.isLive){e.next=25;break}t._bufferService.setLiveSeekableRange(0,4294967295),t._bufferService.updateDuration(1/0),n.isMaster||t._pollM3U8(r),e.next=29;break;case 25:return e.next=27,t._bufferService.updateDuration(t._playlist.currentStream.totalDuration);case 27:(a=t.config.startTime)&&(t.media.currentTime=a,t._playlist.setNextSegmentByIndex(t._playlist.findSegmentIndexByTime(a)||0));case 29:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),_defineProperty$1(_assertThisInitialized(t),"_loadSegment",_asyncToGenerator(regenerator.mark((function e(){var r,n;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._segmentProcessing&&t.media){e.next=2;break}return e.abrupt("return");case 2:if(r=t.media.currentTime,n=t._playlist.currentSegment,t._playlist.nextSegment&&!(n&&n.end-r>=t.config.preloadTime)){e.next=7;break}return e.abrupt("return");case 7:return e.abrupt("return",t._loadSegmentDirect());case 8:case"end":return e.stop()}}),e)})))),_defineProperty$1(_assertThisInitialized(t),"_onPlay",_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(t._disconnectTimer),!t._reloadOnPlay){e.next=6;break}t._reloadOnPlay=!1,t.replay(!0),e.next=9;break;case 6:return e.next=8,t._loadSegment();case 8:t._startTick();case 9:case"end":return e.stop()}}),e)})))),_defineProperty$1(_assertThisInitialized(t),"_onPause",(function(){if(t.isLive){if(!t._reloadOnPlay){var e=t.config.disconnectTime;if(null==e&&(e=t._playlist.dvrWindow),!isFinite(e))return;clearTimeout(t._disconnectTimer),t._disconnectTimer=setTimeout((function(){t._reloadOnPlay=!0,t._clear()}),e||0)}}else t._stopTick()})),_defineProperty$1(_assertThisInitialized(t),"_onSeeking",_asyncToGenerator(regenerator.mark((function e(){var r,n,i,o,a,s,u;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.media){e.next=2;break}return e.abrupt("return");case 2:if(r=t.media.currentTime,!(n=t._playlist.seekRange)){e.next=9;break}if(i=clamp(r,n[0]+.1,n[1]-.1),!(Math.abs(r-i)>=.1)){e.next=9;break}return t.media.currentTime=i,e.abrupt("return");case 9:if(!(o=t._playlist.currentSegment)){e.next=14;break}if(!((a=Buffer.info(Buffer.get(t.media),r,.1)).end&&a.end>=o.end)){e.next=14;break}return e.abrupt("return");case 14:if(s=t._playlist.findSegmentIndexByTime(r),u=t._playlist.getSegmentByIndex(s),null!=s&&u&&(!t._segmentProcessing||u!==t._playlist.nextSegment)){e.next=18;break}return e.abrupt("return");case 18:return logger$2.debug("seek to",r,u),t._playlist.setNextSegmentByIndex(s),t._stopTick(),e.next=23,t._segmentLoader.cancel();case 23:return e.next=25,t._loadSegmentDirect();case 25:t._startTick();case 26:case"end":return e.stop()}}),e)})))),_defineProperty$1(_assertThisInitialized(t),"_onTimeupdate",(function(){if(t.media){var e=t.config;if(e.isLive&&e.maxLatency&&e.targetLatency&&t.media){var r=t._playlist.liveEdge;if(!r)return;var n=r-t.media.currentTime;n>=e.maxLatency&&(logger$2.debug("latency jump",n),t.media.currentTime=r-e.targetLatency)}t._seiService.throw(t.media.currentTime)}})),_defineProperty$1(_assertThisInitialized(t),"_tick",(function(){if(t.media){t._startTick();var e=t.media;Buffer.end(Buffer.get(e))<.1||!e.readyState||(isMediaPlaying(e)?(t._loadSegment(),t._gapService&&t._gapService.do(e,t.config.maxJumpDistance,t.isLive)):e.readyState<2&&t._gapService&&t._gapService.do(e,t.config.maxJumpDistance,t.isLive))}})),t.config=e=getConfig(e),t.media=t.config.media,t._manifestLoader=new ManifestLoader(_assertThisInitialized(t)),t._segmentLoader=new SegmentLoader(_assertThisInitialized(t)),t._playlist=new Playlist(_assertThisInitialized(t)),t._bufferService=new BufferService(_assertThisInitialized(t)),t._seiService=new SeiService(_assertThisInitialized(t)),e.softDecode||(t._gapService=new GapService),t.media.addEventListener("play",t._onPlay),t.media.addEventListener("pause",t._onPause),t.media.addEventListener("seeking",t._onSeeking),t.media.addEventListener("timeupdate",t._onTimeupdate),t}return _createClass$1(f,[{key:"isLive",get:function(){return this._playlist.isLive}},{key:"streams",get:function(){return this._playlist.streams}},{key:"currentStream",get:function(){return this._playlist.currentStream}},{key:"baseDts",get:function(){var e;return null===(e=this._bufferService)||void 0===e?void 0:e.baseDts}},{key:"speedInfo",value:function(){return this._segmentLoader.speedInfo()}},{key:"bufferInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;return Buffer.info(Buffer.get(this.media),null===(e=this.media)||void 0===e?void 0:e.currentTime,t)}},{key:"playbackQuality",value:function(){return getVideoPlaybackQuality(this.media)}},{key:"load",value:(l=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||this.config.url,e.next=3,this._reset();case 3:if(t&&(t=t.trim()),t){e.next=6;break}throw this._emitError(new StreamingError(ERR.OTHER,ERR.SUB_TYPES.OPTION,null,null,"m3u8 url is missing"));case 6:return e.next=8,this._loadM3U8(t);case 8:return e.next=10,this._loadSegment();case 10:this._startTick();case 11:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"replay",value:(c=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.startTime=0,!this.config.softDecode){e.next=5;break}this.load(),e.next=7;break;case 5:return e.next=7,this.load();case 7:return this._reloadOnPlay=!1,e.abrupt("return",this.media.play(!t));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"switchURL",value:(u=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:0,this.config.startTime=r,e.prev=2,!this.config.softDecode){e.next=7;break}e.t0=this.load(t),e.next=10;break;case 7:return e.next=9,this.load(t);case 9:e.t0=e.sent;case 10:n=e.t0,e.next=17;break;case 13:throw e.prev=13,e.t1=e.catch(2),this.emit(Event$3.SWITCH_URL_FAILED,e.t1),e.t1;case 17:return this._reloadOnPlay=!1,n&&this.emit(Event$3.SWITCH_URL_SUCCESS,{url:t}),e.abrupt("return",this.media.play(!0));case 20:case"end":return e.stop()}}),e,this,[[2,13]])}))),function(e){return u.apply(this,arguments)})},{key:"switchStream",value:(s=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o,a,s=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(s.length>1&&void 0!==s[1])||s[1],n=this.currentStream,i=this.streams,n&&n.id!==t&&i&&!(i.length<2)){e.next=5;break}return e.abrupt("return");case 5:if(o=i.find((function(e){return e.id===t}))){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,e.next=11,this._clear();case 11:if(!r){e.next=14;break}return e.next=14,this._bufferService.clearAllBuffer();case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(8),this._emitError(StreamingError.create(e.t0));case 19:if(n.currentAudioStream&&o.audioStreams.length>2&&(a=n.currentAudioStream.id,o.currentAudioStream=o.audioStreams.find((function(e){return e.id===a}))||o.currentAudioStream),this._playlist.currentStream=o,e.prev=21,!this.isLive&&o.segments.length){e.next=25;break}return e.next=25,this._refreshM3U8();case 25:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,e.next=29,this._loadSegmentDirect();case 29:e.next=35;break;case 31:throw e.prev=31,e.t1=e.catch(21),this._playlist.currentStream=n,e.t1;case 35:return this._startTick(),e.abrupt("return",o);case 37:case"end":return e.stop()}}),e,this,[[8,16],[21,31]])}))),function(e){return s.apply(this,arguments)})},{key:"switchAudioStream",value:(a=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o,a=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>1&&void 0!==a[1])||a[1],n=this.currentStream){e.next=4;break}return e.abrupt("return");case 4:if((i=n.currentAudioStream)&&i.id!==t&&!(n.audioStreams.length<2)){e.next=7;break}return e.abrupt("return");case 7:if(o=n.audioStreams.find((function(e){return e.id===t}))){e.next=10;break}return e.abrupt("return");case 10:return e.prev=10,e.next=13,this._clear();case 13:if(!r){e.next=16;break}return e.next=16,this._bufferService.clearAllBuffer();case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(10),this._emitError(StreamingError.create(e.t0));case 21:if(n.currentAudioStream=o,e.prev=22,!this.isLive&&o.segments.length){e.next=26;break}return e.next=26,this._refreshM3U8();case 26:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,e.next=30,this._loadSegmentDirect();case 30:e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(22),n.currentAudioStream=i,e.t1;case 36:return this._startTick(),e.abrupt("return",o);case 38:case"end":return e.stop()}}),e,this,[[10,18],[22,32]])}))),function(e){return a.apply(this,arguments)})},{key:"destroy",value:(o=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.media){e.next=2;break}return e.abrupt("return");case 2:return this.removeAllListeners(),this._playlist.reset(),this._segmentLoader.reset(),this._seiService.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("pause",this._onPause),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),e.next=12,Promise.all([this._clear(),this._bufferService.destroy()]);case 12:this.media=null;case 13:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_refreshM3U8",value:function(){var e,t=this,r=this._playlist.currentStream;if(!r||!r.url)throw this._emitError(StreamingError.create(null,null,new Error("m3u8 url is not defined")));var n=r.url,i=null===(e=r.currentAudioStream)||void 0===e?void 0:e.url;return this._manifestLoader.load(n,i).then((function(e){var r=_slicedToArray(e,2),o=r[0],a=r[1];o&&(t._playlist.upsertPlaylist(o,a),t.isLive&&t._pollM3U8(n,i))})).catch((function(e){throw t._emitError(StreamingError.create(e))}))}},{key:"_pollM3U8",value:function(e,t){var r,n=this,i=this._playlist.isEmpty;this._manifestLoader.poll(e,t,(function(e,t){n._playlist.upsertPlaylist(e,t),e&&i&&!n._playlist.isEmpty&&n._loadSegment(),i&&(i=n._playlist.isEmpty)}),(function(e){n._emitError(StreamingError.create(e),!0)}),1e3*((null===(r=this._playlist.lastSegment)||void 0===r?void 0:r.duration)||0))}},{key:"_loadSegmentDirect",value:(i=_asyncToGenerator(regenerator.mark((function e(){var t,r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._playlist.nextSegment){e.next=3;break}return e.abrupt("return");case 3:return r=!1,this._segmentProcessing=!0,e.prev=5,e.next=8,this._reqAndBufferSegment(t,this._playlist.getAudioSegment(t));case 8:r=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),this._emitError(StreamingError.create(e.t0));case 14:return e.prev=14,this._segmentProcessing=!1,e.finish(14);case 17:return r&&(this._playlist.moveSegmentPointer(),t.isLast?this._end():this._loadSegment()),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,this,[[5,11,14,17]])}))),function(){return i.apply(this,arguments)})},{key:"_reqAndBufferSegment",value:(n=_asyncToGenerator(regenerator.mark((function e(t,r){var n,i,o,a,s,u,c,l;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t?t.cc:r.cc,o=this._prevSegCc!==i,e.next=4,this._segmentLoader.load(t,r,o);case 4:if((a=e.sent)[0]){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(n=this._bufferService).decryptBuffer.apply(n,_toConsumableArray(a));case 9:if(s=e.sent){e.next=12;break}return e.abrupt("return");case 12:return u=t?t.sn:r.sn,c=t?t.start:r.start,l=this._playlist.currentStream,this._bufferService.createSource(s[0],s[1],null==l?void 0:l.videoCodec,null==l?void 0:l.audioCodec),e.next=18,this._bufferService.appendBuffer(s[0],s[1],o,this._prevSegSn===u-1,c);case 18:return e.next=20,this._bufferService.evictBuffer(this.config.bufferBehind);case 20:return this._prevSegCc=i,this._prevSegSn=u,e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_clear",value:(r=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._disconnectTimer),this._stopTick(),e.next=4,Promise.all([this._segmentLoader.cancel(),this._manifestLoader.stopPoll()]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_reset",value:(t=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._reloadOnPlay=!1,this._prevSegSn=null,this._prevSegCc=null,this._playlist.reset(),this._segmentLoader.reset(),this._seiService.reset(),e.next=8,this._clear();case 8:return e.abrupt("return",this._bufferService.reset());case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_end",value:function(){this._clear(),this._bufferService.endOfStream()}},{key:"_stopTick",value:function(){clearTimeout(this._tickTimer)}},{key:"_startTick",value:function(){this._stopTick(),this._tickTimer=setTimeout(this._tick,this._tickInterval)}},{key:"_emitError",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return logger$2.table(e),this.emit(Event$3.ERROR,e),t&&this._end(),this._seiService.reset(),e}}],[{key:"isSupported",value:function(e){return e?softDecodeProbe():MSE$2.isSupported()||softDecodeProbe()}},{key:"enableLogger",value:function(){Logger$2.enable(),Logger$1.enable()}},{key:"disableLogger",value:function(){Logger$2.disable(),Logger$1.disable()}}]),f}(EventEmitter$1);_defineProperty$1(Hls,"version","3.0.0-next.6-6");try{localStorage.getItem("xgd")?Hls.enableLogger():Hls.disableLogger()}catch(error){}function ownKeys$9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$9(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$9(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var PluginExtension=function(){function e(t,r){var n=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_opts",null),_defineProperty$1(this,"_plugin",null),_defineProperty$1(this,"_onLowDecode",(function(){var e,t,r,i,o=n._opts,a=o.media,s=o.innerDegrade;null===(e=n._plugin)||void 0===e||null===(t=e.player)||void 0===t||t.emit("lowdecode",a.degradeInfo),null===(r=n._plugin)||void 0===r||null===(i=r.player)||void 0===i||i.emit("core_event",_objectSpread$6(_objectSpread$6({},a.degradeInfo),{},{eventName:Event$3.LOWDECODE})),1===s&&n._degrade(a.src)})),_defineProperty$1(this,"_degrade",(function(e){var t=n._plugin.player,r=t.video;if(!r||"MVideo"===r.TAG){var i=t.video.degradeVideo;t.video=i,r.degrade(e),e&&(t.config.url=e);var o=t.root.firstChild;"MVideo"===o.TAG&&t.root.replaceChild(i,o);var a=n._plugin.constructor.pluginName.toLowerCase();t.unRegisterPlugin(a),t.once("canplay",(function(){t.play()}))}})),_defineProperty$1(this,"forceDegradeToVideo",(function(e){1===n._opts.innerDegrade&&n._degrade(e)})),this._opts=t,this._plugin=r,this._init()}return _createClass$1(e,[{key:"_init",value:function(){var e=this._opts,t=e.media,r=e.preloadTime,n=e.innerDegrade,i=e.isLive;t&&(i||!t.setPlayMode?(n&&t.setAttribute("innerdegrade",n),r&&t.setAttribute("preloadtime",r),this._bindEvents()):t.setPlayMode("VOD"))}},{key:"_bindEvents",value:function(){this._opts.media.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var e,t;null===(e=this._opts)||void 0===e||null===(t=e.media)||void 0===t||t.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),e}();function ownKeys$8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$8(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$8(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper$j(e){var t=_isNativeReflectConstruct$j();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var HlsPlugin$1=function(e){_inherits(r,e);var t=_createSuper$j(r);function r(){var e;_classCallCheck$1(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$1(_assertThisInitialized(e=t.call.apply(t,[this].concat(i))),"hls",null),_defineProperty$1(_assertThisInitialized(e),"pluginExtension",null),_defineProperty$1(_assertThisInitialized(e),"destroy",(function(){var t;e.hls&&(e.hls.destroy(),e.hls=null),null===(t=e.pluginExtension)||void 0===t||t.destroy(),e.pluginExtension=null})),_defineProperty$1(_assertThisInitialized(e),"_onSwitchURL",(function(t){e.hls&&(e.player.config.url=t,e.hls.config.url=t,e.hls.switchURL(t).catch((function(e){})))})),_defineProperty$1(_assertThisInitialized(e),"_onDefinitionChange",(function(t){var r=t.to;e.hls&&e.hls.switchURL(r).catch((function(e){}))})),e}return _createClass$1(r,[{key:"core",get:function(){return this.hls}},{key:"version",get:function(){var e;return null===(e=this.hls)||void 0===e?void 0:e.version}},{key:"softDecode",get:function(){var e,t;return"live-video"===(null===(e=this.player)||void 0===e||null===(t=e.config)||void 0===t?void 0:t.mediaType)}},{key:"beforePlayerInit",value:function(){var e,t=this,r=this.player.config;this.hls&&this.hls.destroy(),this.player.switchURL=this._onSwitchURL;var n=r.hls||{};n.innerDegrade=n.innerDegrade||r.innerDegrade,null==n.disconnectTime&&(n.disconnectTime=0),this.hls=new Hls(_objectSpread$5({softDecode:this.softDecode,isLive:r.isLive,media:this.player.video,startTime:r.startTime,url:r.url},n)),this.softDecode||BasePlugin.defineGetterOrSetter(this.player,{url:{get:function(){var e,r;return null===(e=t.hls)||void 0===e||null===(r=e.media)||void 0===r?void 0:r.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new PluginExtension(_objectSpread$5({isLive:r.isLive,media:this.player.video},n),this),this.player.forceDegradeToVideo=function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(e=t.pluginExtension)||void 0===e?void 0:e.forceDegradeToVideo.apply(e,n)}),null===(e=this.player)||void 0===e||e.useHooks("replay",(function(){var e;return null===(e=t.hls)||void 0===e?void 0:e.replay()})),this.on(URL_CHANGE,this._onSwitchURL),this.on(DESTROY,this.destroy),this._transError(),this._transCoreEvent(EVENT.TTFB),this._transCoreEvent(EVENT.LOAD_START),this._transCoreEvent(EVENT.LOAD_RESPONSE_HEADERS),this._transCoreEvent(EVENT.LOAD_COMPLETE),this._transCoreEvent(EVENT.LOAD_RETRY),this._transCoreEvent(EVENT.SOURCEBUFFER_CREATED),this._transCoreEvent(EVENT.REMOVE_BUFFER),this._transCoreEvent(EVENT.BUFFEREOS),this._transCoreEvent(EVENT.KEYFRAME),this._transCoreEvent(EVENT.METADATA_PARSED),this._transCoreEvent(EVENT.SEI),this._transCoreEvent(EVENT.SEI_IN_TIME),this._transCoreEvent(EVENT.SPEED),this._transCoreEvent(EVENT.HLS_MANIFEST_LOADED),this._transCoreEvent(Event$3.STREAM_PARSED),this._transCoreEvent(EVENT.HLS_LEVEL_LOADED),this._transCoreEvent(EVENT.STREAM_EXCEPTION),this._transCoreEvent(EVENT.SWITCH_URL_SUCCESS),this._transCoreEvent(EVENT.SWITCH_URL_FAILED),r.url&&this.hls.load(r.url).catch((function(e){}))}},{key:"_transError",value:function(){var e=this;this.hls.on(Event$3.ERROR,(function(t){e.player&&e.player.emit(ERROR$2,new Errors$2(e.player,t))}))}},{key:"_transCoreEvent",value:function(e){var t=this;this.hls.on(e,(function(r){t.player&&t.player.emit("core_event",_objectSpread$5(_objectSpread$5({},r),{},{eventName:e}))}))}}],[{key:"pluginName",get:function(){return"hls"}},{key:"isSupported",value:function(e){return Hls.isSupported(e)}}]),r}(BasePlugin);_defineProperty$1(HlsPlugin$1,"Hls",Hls),_defineProperty$1(HlsPlugin$1,"EVENT",Event$3);var HlsPlugin=HlsPlugin$1,shakaPlayer_compiled={};!function(t){!function(){var r="undefined"!=typeof window?window:commonjsGlobal$1,n={};for(var i in function(t,r,n){var i,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},a=void 0!==t&&t===this?this:void 0!==r&&null!=r?r:this;function s(){s=function(){},a.Symbol||(a.Symbol=c)}var u,c=(u=0,function(e){return"jscomp_symbol_"+(e||"")+u++});function l(){s();var e=a.Symbol.iterator;e||(e=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&o(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return d(this)}}),l=function(){}}function d(e){var t=0;return f((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function f(e){return l(),(e={next:e})[a.Symbol.iterator]=function(){return this},e}function h(e){l();var t=e[Symbol.iterator];return t?t.call(e):d(e)}function p(e,t){if(t){for(var r=a,n=e.split("."),i=0;i<n.length-1;i++){var s=n[i];s in r||(r[s]={}),r=r[s]}(s=t(i=r[n=n[n.length-1]]))!=i&&null!=s&&o(r,n,{configurable:!0,writable:!0,value:s})}}function g(e){return function(e){function t(t){return e.next(t)}function r(t){return e.throw(t)}return new Promise((function(n,i){!function e(o){o.done?n(o.value):Promise.resolve(o.value).then(t,r).then(e,i)}(e.next())}))}(e())}p("Promise",(function(e){function t(e){this.h=0,this.l=void 0,this.g=[];var t=this.i();try{e(t.resolve,t.reject)}catch(r){t.reject(r)}}function r(){this.g=null}function n(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;r.prototype.h=function(e){null==this.g&&(this.g=[],this.j()),this.g.push(e)},r.prototype.j=function(){var e=this;this.i((function(){e.m()}))};var i=a.setTimeout;r.prototype.i=function(e){i(e,0)},r.prototype.m=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(n){this.l(n)}}}this.g=null},r.prototype.l=function(e){this.i((function(){throw e}))},t.prototype.i=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.C),reject:e(this.j)}},t.prototype.C=function(e){if(e===this)this.j(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(_typeof$3(e)){case"object":var r=null!=e;break e;case"function":r=!0;break e;default:r=!1}r?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(r){return void this.j(r)}"function"==typeof t?this.J(t,e):this.m(e)},t.prototype.j=function(e){this.o(2,e)},t.prototype.m=function(e){this.o(1,e)},t.prototype.o=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.l=t,this.u()},t.prototype.u=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)o.h(this.g[e]);this.g=null}};var o=new r;return t.prototype.F=function(e){var t=this.i();e.nc(t.resolve,t.reject)},t.prototype.J=function(e,t){var r=this.i();try{e.call(t,r.resolve,r.reject)}catch(n){r.reject(n)}},t.prototype.then=function(e,r){function n(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(r){o(r)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.nc(n(e,i),n(r,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.nc=function(e,t){function r(){switch(n.h){case 1:e(n.l);break;case 2:t(n.l);break;default:throw Error("Unexpected state: "+n.h)}}var n=this;null==this.g?o.h(r):this.g.push(r)},t.resolve=n,t.reject=function(e){return new t((function(t,r){r(e)}))},t.race=function(e){return new t((function(t,r){for(var i=h(e),o=i.next();!o.done;o=i.next())n(o.value).nc(t,r)}))},t.all=function(e){var r=h(e),i=r.next();return i.done?n([]):new t((function(e,t){function o(t){return function(r){a[t]=r,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,n(i.value).nc(o(a.length-1),t),i=r.next()}while(!i.done)}))},t})),p("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}));var y,v="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)y=Object.setPrototypeOf;else{var m;e:{var _={};try{_.__proto__={a:!0},m=_.a;break e}catch(u){}m=!1}y=m?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var b=y;function A(e,t){if(e.prototype=v(t.prototype),e.prototype.constructor=e,b)b(e,t);else for(var r in t)if("prototype"!=r)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(e,r,n)}else e[r]=t[r];e.Lg=t.prototype}function E(){this.l=!1,this.i=null,this.B=void 0,this.s=1,this.h=this.j=0,this.o=this.g=null}function S(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function T(e,t){e.g={ce:t,ne:!0},e.s=e.j||e.h}function $(e,t,r){return e.s=r,{value:t}}function w(e){e.s=0}function C(e,t,r){e.j=t,null!=r&&(e.h=r)}function I(e,t){e.j=0,e.h=t||0}function k(e,t){e.s=t,e.j=0}function O(e){e.j=0;var t=e.g.ce;return e.g=null,t}function P(e){e.o=[e.g],e.j=0,e.h=0}function R(e,t){var r=e.o.splice(0)[0];(r=e.g=e.g||r)?r.ne?e.s=e.j||e.h:null!=r.I&&e.h<r.I?(e.s=r.I,e.g=null):e.s=e.h:e.s=t}function x(e){this.g=new E,this.h=e}function D(e,t,r,n){try{var i=t.call(e.g.i,r);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(a){return e.g.i=null,T(e.g,a),L(e)}return e.g.i=null,n.call(e.g,o),L(e)}function L(e){for(;e.g.s;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(r){e.g.B=void 0,T(e.g,r)}if(e.g.l=!1,e.g.g){if(t=e.g.g,e.g.g=null,t.ne)throw t.ce;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function N(e){this.next=function(t){return S(e.g),e.g.i?t=D(e,e.g.i.next,t,e.g.m):(e.g.m(t),t=L(e)),t},this.throw=function(t){return S(e.g),e.g.i?t=D(e,e.g.i.throw,t,e.g.m):(T(e.g,t),t=L(e)),t},this.return=function(t){return function(e,t){S(e.g);var r=e.g.i;return r?D(e,"return"in r?r.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),L(e))}(e,t)},l(),this[Symbol.iterator]=function(){return this}}function M(e,t){return N.prototype=e.prototype,new N(new x(t))}function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e,t,r){e instanceof String&&(e=String(e));for(var n=e.length,i=0;i<n;i++){var o=e[i];if(t.call(r,o,i,e))return{le:i,Qe:o}}return{le:-1,Qe:void 0}}function j(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""}E.prototype.m=function(e){this.B=e},E.prototype.return=function(e){this.g={return:e},this.s=this.h},E.prototype.I=function(e){this.s=e},p("Array.prototype.keys",(function(e){return e||function(){return function(e,t){l(),e instanceof String&&(e+="");var r=0,n={next:function(){if(r<e.length){var i=r++;return{value:t(i,e[i]),done:!1}}return n.next=function(){return{done:!0,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n}(this,(function(e){return e}))}})),p("WeakMap",(function(e){function t(e){if(this.g=(a+=Math.random()+1).toString(),e){s(),l(),e=h(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function r(e){B(e,i)||o(e,i,{value:{}})}function n(e){var t=Object[e];t&&(Object[e]=function(e){return r(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([[t,2],[r,3]]);return 2==n.get(t)&&3==n.get(r)&&(n.delete(t),n.set(r,4),!n.has(t)&&4==n.get(r))}catch(i){return!1}}())return e;var i="$jscomp_hidden_"+Math.random();n("freeze"),n("preventExtensions"),n("seal");var a=0;return t.prototype.set=function(e,t){if(r(e),!B(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.g]=t,this},t.prototype.get=function(e){return B(e,i)?e[i][this.g]:void 0},t.prototype.has=function(e){return B(e,i)&&B(e[i],this.g)},t.prototype.delete=function(e){return!(!B(e,i)||!B(e[i],this.g))&&delete e[i][this.g]},t})),p("Map",(function(e){function t(){var e={};return e.Na=e.next=e.head=e}function r(e,t){var r=e.g;return f((function(){if(r){for(;r.head!=e.g;)r=r.Na;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}}))}function n(e,t){var r=t&&_typeof$3(t);"object"==r||"function"==r?o.has(t)?r=o.get(t):(r=""+ ++a,o.set(t,r)):r="p_"+t;var n=e.h[r];if(n&&B(e.h,r))for(var i=0;i<n.length;i++){var s=n[i];if(t!=t&&s.key!=s.key||t===s.key)return{id:r,list:n,index:i,ga:s}}return{id:r,list:n,index:-1,ga:void 0}}function i(e){if(this.h={},this.g=t(),this.size=0,e){e=h(e);for(var r;!(r=e.next()).done;)r=r.value,this.set(r[0],r[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e(h([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var n=r.entries(),i=n.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=n.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!n.next().done)}catch(o){return!1}}())return e;s(),l();var o=new WeakMap;i.prototype.set=function(e,t){var r=n(this,e);return r.list||(r.list=this.h[r.id]=[]),r.ga?r.ga.value=t:(r.ga={next:this.g,Na:this.g.Na,head:this.g,key:e,value:t},r.list.push(r.ga),this.g.Na.next=r.ga,this.g.Na=r.ga,this.size++),this},i.prototype.delete=function(e){return!(!(e=n(this,e)).ga||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.ga.Na.next=e.ga.next,e.ga.next.Na=e.ga.Na,e.ga.head=null,this.size--,!0)},i.prototype.clear=function(){this.h={},this.g=this.g.Na=t(),this.size=0},i.prototype.has=function(e){return!!n(this,e).ga},i.prototype.get=function(e){return(e=n(this,e).ga)&&e.value},i.prototype.entries=function(){return r(this,(function(e){return[e.key,e.value]}))},i.prototype.keys=function(){return r(this,(function(e){return e.key}))},i.prototype.values=function(){return r(this,(function(e){return e.value}))},i.prototype.forEach=function(e,t){for(var r,n=this.entries();!(r=n.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var a=0;return i})),p("Set",(function(e){function t(e){if(this.g=new Map,e){e=h(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e(h([t]));if(!r.has(t)||1!=r.size||r.add(t)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var n=r.entries(),i=n.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&(!(i=n.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&n.next().done)}catch(o){return!1}}()?e:(s(),l(),t.prototype.add=function(e){return this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var r=this;this.g.forEach((function(n){return e.call(t,n,n,r)}))},t)})),p("Array.prototype.findIndex",(function(e){return e||function(e,t){return U(this,e,t).le}})),p("Array.prototype.find",(function(e){return e||function(e,t){return U(this,e,t).Qe}})),p("String.prototype.startsWith",(function(e){return e||function(e,t){for(var r=j(this,e,"startsWith"),n=r.length,i=e.length,o=Math.max(0,Math.min(0|t,r.length)),a=0;a<i&&o<n;)if(r[o++]!=e[a++])return!1;return a>=i}})),p("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),p("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length,i=t||0;for(0>i&&(i=Math.max(i+n,0));i<n;i++){var o=r[i];if(o===e||Object.is(o,e))return!0}return!1}})),p("String.prototype.includes",(function(e){return e||function(e,t){return-1!==j(this,e,"includes").indexOf(e,t||0)}})),p("Array.from",(function(e){return e||function(e,t,r){l(),t=null!=t?t:function(e){return e};var n=[],i=e[Symbol.iterator];if("function"==typeof i)for(e=i.call(e);!(i=e.next()).done;)n.push(t.call(r,i.value));else{i=e.length;for(var o=0;o<i;o++)n.push(t.call(r,e[o]))}return n}}));var F="function"==typeof Object.assign?Object.assign:function(e,t){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var i in n)B(n,i)&&(e[i]=n[i])}return e};p("Object.assign",(function(e){return e||F}));var V=this;function G(e,t){var r,n=e.split("."),i=V;n[0]in i||!i.execScript||i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||void 0===t?i=i[r]?i[r]:i[r]={}:i[r]=t}function H(e,t){function r(){}r.prototype=t.prototype,e.Lg=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Wg=function(e,r,n){return t.prototype[r].apply(e,Array.prototype.slice.call(arguments,2))}}function K(e){this.i=Math.exp(Math.log(.5)/e),this.h=this.g=0}function z(e,t,r){var n=Math.pow(e.i,t);r=r*(1-n)+n*e.g,isNaN(r)||(e.g=r,e.h+=t)}function W(e){return e.g/(1-Math.pow(e.i,e.h))}function Y(){this.h=new K(2),this.i=new K(5),this.g=0}V.g=!0,Y.prototype.getBandwidthEstimate=function(e){return 128e3>this.g?e:Math.min(W(this.h),W(this.i))};var X={sb:0,kc:function(){},ba:function(){},error:function(){},v:function(){},info:function(){},debug:function(){},K:function(){},O:function(){}};function Z(e,t,r,n){for(var i=[],o=3;o<arguments.length;++o)i[o-3]=arguments[o];this.severity=e,this.category=t,this.code=r,this.data=i,this.handled=!1}t.console&&t.console.log.bind&&(X.ba=console.warn.bind(console),X.kc=console.error.bind(console),1<=X.sb&&(X.error=console.error.bind(console)),2<=X.sb&&(X.v=console.warn.bind(console)),3<=X.sb&&(X.info=console.info.bind(console)),4<=X.sb&&(X.debug=console.log.bind(console)),5<=X.sb&&(X.K=console.debug.bind(console)),6<=X.sb&&(X.O=console.debug.bind(console))),G("shaka.util.Error",Z),Z.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},Z.Severity={RECOVERABLE:1,CRITICAL:2},Z.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},Z.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};var q=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Q(e){var t;e instanceof Q?(J(this,e.Ba),this.pb=e.pb,this.Aa=e.Aa,ee(this,e.Ob),this.pa=e.pa,te(this,e.g.clone()),this.bb=e.bb):e&&(t=String(e).match(q))?(J(this,t[1]||"",!0),this.pb=re(t[2]||""),this.Aa=re(t[3]||"",!0),ee(this,t[4]),this.pa=re(t[5]||"",!0),te(this,t[6]||"",!0),this.bb=re(t[7]||"")):this.g=new le(null)}function J(e,t,r){e.Ba=r?re(t,!0):t,e.Ba&&(e.Ba=e.Ba.replace(/:$/,""))}function ee(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Ob=t}else e.Ob=null}function te(e,t,r){t instanceof le?e.g=t:(r||(t=ne(t,ue)),e.g=new le(t))}function re(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function ne(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,ie),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ie(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=Q.prototype).Ba="",i.pb="",i.Aa="",i.Ob=null,i.pa="",i.bb="",i.toString=function(){var e=[],t=this.Ba;if(t&&e.push(ne(t,oe,!0),":"),t=this.Aa){e.push("//");var r=this.pb;r&&e.push(ne(r,oe,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Ob)&&e.push(":",String(t))}return(t=this.pa)&&(this.Aa&&"/"!=t.charAt(0)&&e.push("/"),e.push(ne(t,"/"==t.charAt(0)?se:ae,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.bb)&&e.push("#",ne(t,ce)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.Ba&&(t=new Q);var r=!!e.Ba;r?J(t,e.Ba):r=!!e.pb,r?t.pb=e.pb:r=!!e.Aa,r?t.Aa=e.Aa:r=null!=e.Ob;var n=e.pa;if(r)ee(t,e.Ob);else if(r=!!e.pa){if("/"!=n.charAt(0))if(this.Aa&&!this.pa)n="/"+n;else{var i=t.pa.lastIndexOf("/");-1!=i&&(n=t.pa.substr(0,i+1)+n)}if(".."==n||"."==n)n="";else if(-1!=n.indexOf("./")||-1!=n.indexOf("/.")){i=0==n.lastIndexOf("/",0),n=n.split("/");for(var o=[],a=0;a<n.length;){var s=n[a++];"."==s?i&&a==n.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==n.length&&o.push("")):(o.push(s),i=!0)}n=o.join("/")}}return r?t.pa=n:r=""!==e.g.toString(),r?te(t,e.g.clone()):r=!!e.bb,r&&(t.bb=e.bb),t},i.clone=function(){return new Q(this)};var oe=/[#\/\?@]/g,ae=/[#\?:]/g,se=/[#\?]/g,ue=/[#\?@]/g,ce=/#/g;function le(e){this.g=e||null}(i=le.prototype).na=null,i.qc=null,i.add=function(e,t){if(!this.na&&(this.na={},this.qc=0,this.g))for(var r=this.g.split("&"),n=0;n<r.length;n++){var i=r[n].indexOf("="),o=null;if(0<=i){var a=r[n].substring(0,i);o=r[n].substring(i+1)}else a=r[n];a=decodeURIComponent(a.replace(/\+/g," ")),o=o||"",this.add(a,decodeURIComponent(o.replace(/\+/g," ")))}return this.g=null,(r=this.na.hasOwnProperty(e)&&this.na[e])||(this.na[e]=r=[]),r.push(t),this.qc++,this},i.toString=function(){if(this.g)return this.g;if(!this.na)return"";var e,t=[];for(e in this.na)for(var r=encodeURIComponent(e),n=this.na[e],i=0;i<n.length;i++){var o=r;""!==n[i]&&(o+="="+encodeURIComponent(n[i])),t.push(o)}return this.g=t.join("&")},i.clone=function(){var e=new le;if(e.g=this.g,this.na){var t,r={};for(t in this.na)r[t]=this.na[t].concat();e.na=r,e.qc=this.qc}return e};var de={df:function(e,t){return e.reduce(function(e,t,r){return t.catch(e.bind(null,r))}.bind(null,t),Promise.reject())},Rc:function(e,t){return e.concat(t)},Bc:function(){},Ra:function(e){return null!=e}};function fe(e,t){if(0==t.length)return e;var r=t.map((function(e){return new Q(e)}));return e.map((function(e){return new Q(e)})).map((function(e){return r.map(e.resolve.bind(e))})).reduce(de.Rc,[]).map((function(e){return e.toString()}))}function he(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var pe={Za:"video",Sb:"audio",za:"text",Ug:"image",Sg:"application"},ge=1/15;function ye(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r}function ve(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=Ee(e),e=escape(e);try{return decodeURIComponent(e)}catch(t){throw new Z(2,2,2004)}}function me(e,t,r){if(!e)return"";if(!r&&0!=e.byteLength%2)throw X.error("Data has an incorrect length, must be even."),new Z(2,2,2004);if(e instanceof ArrayBuffer)var n=e;else(r=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),n=r.buffer;e=Math.floor(e.byteLength/2),r=new Uint16Array(e),n=new DataView(n);for(var i=0;i<e;i++)r[i]=n.getUint16(2*i,t);return Ee(r)}function _e(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return ve(t);if(254==t[0]&&255==t[1])return me(t.subarray(2),!1);if(255==t[0]&&254==t[1])return me(t.subarray(2),!0);var r=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(X.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return me(e,!1);if(0==t[1]&&0==t[3])return me(e,!0);if(r(0)&&r(1)&&r(2)&&r(3))return ve(e);throw new Z(2,2,2003)}function be(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t.buffer}function Ae(e,t){for(var r=new Uint8Array(2*e.length),n=new DataView(r.buffer),i=0;i<e.length;++i)n.setUint16(2*i,e.charCodeAt(i),t);return r.buffer}function Ee(e){if(!Se)for(var t=function(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(r){return!1}},r={size:65536};0<r.size;(r={size:r.size}).size/=2)if(t(r.size)){Se=function(e){return function(t){for(var r="",n=0;n<t.length;n+=e.size)r+=String.fromCharCode.apply(null,t.subarray(n,n+e.size));return r}}(r);break}return Se(e)}ye.prototype.resolve=function(){},ye.prototype.reject=function(){},G("shaka.util.StringUtils.fromUTF8",ve),G("shaka.util.StringUtils.fromUTF16",me),G("shaka.util.StringUtils.fromBytesAutoDetect",_e),G("shaka.util.StringUtils.toUTF8",be),G("shaka.util.StringUtils.toUTF16",Ae);var Se=null;G("shaka.util.StringUtils.resetFromCharCode",(function(){Se=null}));var Te={Mc:function(e,r){var n=Ee(e);return r=null==r||r,n=t.btoa(n).replace(/\+/g,"-").replace(/\//g,"_"),r?n:n.replace(/=*$/,"")}};function $e(){this.g=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.h=null,this.l=[],this.i=[],this.j=!1,this.g.on("data",this.o.bind(this)),this.g.on("done",this.m.bind(this))}function we(e,r){return!(!t.muxjs||"mp2t"!=e.toLowerCase().split(";")[0].split("/")[1])&&(r?MediaSource.isTypeSupported(Ce(r,e)):MediaSource.isTypeSupported(Ce("audio",e))||MediaSource.isTypeSupported(Ce("video",e)))}function Ce(e,t){var r=t.replace(/mp2t/i,"mp4");"audio"==e&&(r=r.replace("video","audio"));var n=/avc1\.(66|77|100)\.(\d+)/.exec(r);if(n){var i="avc1.",o=n[1],a=Number(n[2]);i=("66"==o?i+"4200":"77"==o?i+"4d00":i+"6400")+(a>>4).toString(16),i+=(15&a).toString(16),r=r.replace(n[0],i)}return r}function Ie(e){this.h=e,this.g=null}function ke(e){this.h=e,this.g=null}function Oe(e,t){var r={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.o=null==e.maxAttempts?r.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?r.baseDelay:e.baseDelay,this.m=null==e.fuzzFactor?r.fuzzFactor:e.fuzzFactor,this.l=null==e.backoffFactor?r.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function Pe(e){return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:if(e.g>=e.o){if(!e.i)return t.return(Promise.reject());e.g=1,e.h=e.j}return r=e.g,e.g++,0==r?t.return():(n=e.h*(1+(2*Math.random()-1)*e.m),$(t,new Promise((function(e){new ke(e).V(n/1e3)})),2));case 2:e.h*=e.l,w(t)}}))}))}function Re(e,t){this.promise=e,this.se=t,this.g=!1}function xe(e){return new Re(Promise.reject(e),(function(){return Promise.resolve()}))}function De(){var e=Promise.reject(new Z(2,7,7001));return e.catch((function(){})),new Re(e,(function(){return Promise.resolve()}))}function Le(e){return new Re(Promise.resolve(e),(function(){return Promise.resolve()}))}function Ne(e){return new Re(e,(function(){return e.catch((function(){}))}))}function Me(e){return new Re(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Be(e,r){for(var n in r=void 0===r?{}:r)this[n]=r[n];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=t.performance&&t.performance.now?t.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Ue(){this.g={}}function je(){this.hd=new Ue,this.jc=this}function Fe(e){var t=new Set;return function e(r){switch(_typeof$3(r)){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return r;default:if(!r||r.buffer&&r.buffer.constructor==ArrayBuffer)return r;if(t.has(r))return null;var n=r.constructor==Array;if(r.constructor!=Object&&!n)return null;t.add(r);var i,o=n?[]:{};for(i in r)o[i]=e(r[i]);return n&&(o.length=r.length),o}}(e)}function Ve(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ge(e,t){var r=e.indexOf(t);-1<r&&e.splice(r,1)}function He(e,t,r){if(r||(r=Ve),e.length!=t.length)return!1;t=t.slice();for(var n={},i=(e=h(e)).next();!i.done;n={item:n.item},i=e.next()){if(n.item=i.value,-1==(i=t.findIndex(function(e){return function(t){return r(e.item,t)}}(n))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Ke(){this.g=[]}function ze(e,t){e.g.push(t.finally((function(){Ge(e.g,t)})))}function We(e){je.call(this),this.j=!1,this.l=new Ke,this.g=new Set,this.h=new Set,this.i=e||null}G("shaka.util.Uint8ArrayUtils.toBase64",Te.Mc),Te.Ja=function(e){e=t.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r},G("shaka.util.Uint8ArrayUtils.fromBase64",Te.Ja),Te.$c=function(e){for(var r=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)r[n/2]=t.parseInt(e.substr(n,2),16);return r},G("shaka.util.Uint8ArrayUtils.fromHex",Te.$c),Te.Nc=function(e){for(var t="",r=0;r<e.length;++r){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t},G("shaka.util.Uint8ArrayUtils.toHex",Te.Nc),Te.Ha=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!=t[r])return!1;return!0},G("shaka.util.Uint8ArrayUtils.equal",Te.Ha),Te.concat=function(e){for(var t=[],r=0;r<arguments.length;++r)t[r]=arguments[r];for(var n=r=0;n<t.length;++n)r+=t[n].length;r=new Uint8Array(r);for(var i=n=0;i<t.length;++i)r.set(t[i],n),n+=t[i].length;return r},G("shaka.util.Uint8ArrayUtils.concat",Te.concat),$e.prototype.destroy=function(){return this.g.dispose(),this.g=null,Promise.resolve()},$e.prototype.o=function(e){this.i=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.l.push(t)},$e.prototype.m=function(){var e={data:Te.concat.apply(null,this.l),captions:this.i};this.h.resolve(e),this.j=!1},Ie.prototype.V=function(e){var r=this;this.stop();var n=!0,i=null;return this.g=function(){t.clearTimeout(i),n=!1},i=t.setTimeout((function(){n&&r.h()}),1e3*e),this},Ie.prototype.stop=function(){this.g&&(this.g(),this.g=null)},G("shaka.util.Timer",ke),ke.prototype.Lc=function(){return this.stop(),this.h(),this},ke.prototype.tickNow=ke.prototype.Lc,ke.prototype.V=function(e){var t=this;return this.stop(),this.g=new Ie((function(){t.h()})).V(e),this},ke.prototype.tickAfter=ke.prototype.V,ke.prototype.Oa=function(e){var t=this;return this.stop(),this.g=new Ie((function(){t.g.V(e),t.h()})).V(e),this},ke.prototype.tickEvery=ke.prototype.Oa,ke.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},ke.prototype.stop=ke.prototype.stop,G("shaka.util.AbortableOperation",Re),Re.failed=xe,Re.aborted=De,Re.completed=Le,Re.notAbortable=Ne,Re.prototype.abort=function(){return this.g=!0,this.se()},Re.prototype.abort=Re.prototype.abort,Re.all=Me,Re.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},Re.prototype.finally=Re.prototype.finally,Re.prototype.ca=function(e,t){function r(r){return function(s){if(i.g&&r)o.reject(a);else{var u=r?e:t;u?n=function(e,t,r){try{var n=e(t);return n&&n.promise&&n.abort?(r.resolve(n.promise),function(){return n.abort()}):(r.resolve(n),function(){return Promise.resolve(n).then((function(){}),(function(){}))})}catch(i){return r.reject(i),function(){return Promise.resolve()}}}(u,s,o):(r?o.resolve:o.reject)(s)}}}function n(){return o.reject(a),i.abort()}var i=this,o=new ye,a=new Z(2,7,7001);return this.promise.then(r(!0),r(!1)),new Re(o,(function(){return n()}))},Re.prototype.chain=Re.prototype.ca,G("shaka.util.FakeEvent",Be),Be.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Be.prototype.stopImmediatePropagation=function(){this.g=!0},Be.prototype.stopPropagation=function(){},(i=Ue.prototype).push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},i.get=function(e){return(e=this.g[e])?e.slice():null},i.getAll=function(){var e,t=[];for(e in this.g)t.push.apply(t,this.g[e]);return t},i.remove=function(e,t){var r=this.g[e];if(r)for(var n=0;n<r.length;++n)r[n]==t&&(r.splice(n,1),--n)},i.forEach=function(e){for(var t in this.g)e(t,this.g[t])},i.size=function(){return Object.keys(this.g).length},je.prototype.addEventListener=function(e,t){this.hd.push(e,t)},je.prototype.removeEventListener=function(e,t){this.hd.remove(e,t)},je.prototype.dispatchEvent=function(t){for(var r=this.hd.get(t.type)||[],n=0;n<r.length;++n){t.target=this.jc,t.currentTarget=this.jc;var i=r[n];try{i.handleEvent?i.handleEvent(t):i.call(this,t)}catch(e){X.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(t.g)break}return t.defaultPrevented},Ke.prototype.destroy=function(){var e=[];return this.g.forEach((function(t){t.promise.catch((function(){})),e.push(t.abort())})),this.g=[],Promise.all(e)},H(We,je),G("shaka.net.NetworkingEngine",We),We.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},We.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Ye={};function Xe(e,t,r){r=r||3;var n=Ye[e];(!n||r>=n.priority)&&(Ye[e]={priority:r,mg:t})}function Ze(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function qe(e,t,r,n,i,o,a){var s=new Q(r.uris[i]),u=s.Ba,c=!1;u||(J(s,u=(u=location.protocol).slice(0,-1)),r.uris[i]=s.toString()),u=u.toLowerCase();var l,d=(u=Ye[u])?u.mg:null;return d?Ne(Pe(n)).ca((function(){return e.j?De():(l=Date.now(),d(r.uris[i],r,t,(function(r,n,i){e.i&&1==t&&(e.i(r,n),c=!0,a.g=i)})))})).ca((function(e){return null==e.timeMs&&(e.timeMs=Date.now()-l),{response:e,Nf:c}}),(function(s){if(s&&7001==s.code)throw s;if(e.j)return De();if(s&&1==s.severity)return e.dispatchEvent(new Be("retry",{error:s instanceof Z?s:null})),i=(i+1)%r.uris.length,qe(e,t,r,n,i,s,a);throw s||o})):xe(new Z(2,1,1e3,s))}function Qe(){this.g=0}function Je(e,t,r){Re.call(this,e,t),this.h=r}function et(){}function tt(){this.g=new Ue}function rt(t,r,n,i){this.target=t,this.type=r,this.listener=n,this.g=function(t,r){if(null==r)return!1;if("boolean"==typeof r)return r;var n=new Set(["passive","capture"]);return Object.keys(r).filter((function(e){return!n.has(e)})),function(t){var r=nt;if(null==r){r=!1;try{var n={},i={get:function(){return r=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},t.addEventListener("test",i,n),t.removeEventListener("test",i,n)}catch(e){r=!1}nt=r}return r||!1}(t)?r:r.capture||!1}(t,i),this.target.addEventListener(r,n,this.g)}We.registerScheme=Xe,We.unregisterScheme=function(e){delete Ye[e]},We.prototype.og=function(e){this.g.add(e)},We.prototype.registerRequestFilter=We.prototype.og,We.prototype.Ng=function(e){this.g.delete(e)},We.prototype.unregisterRequestFilter=We.prototype.Ng,We.prototype.bf=function(){this.g.clear()},We.prototype.clearAllRequestFilters=We.prototype.bf,We.prototype.pg=function(e){this.h.add(e)},We.prototype.registerResponseFilter=We.prototype.pg,We.prototype.Og=function(e){this.h.delete(e)},We.prototype.unregisterResponseFilter=We.prototype.Og,We.prototype.cf=function(){this.h.clear()},We.prototype.clearAllResponseFilters=We.prototype.cf,We.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}},We.makeRequest=Ze,We.prototype.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.destroy()},We.prototype.destroy=We.prototype.destroy,We.prototype.request=function(e,t){var r=this,n=new Qe;if(this.j){var i=Promise.reject(new Z(2,7,7001));return i.catch((function(){})),new Je(i,(function(){return Promise.resolve()}),n)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Fe(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=Fe(t.uris),i=function(e,t,r){for(var n=Le(void 0),i={},o=(e=h(e.g)).next();!o.done;i={Gd:i.Gd},o=e.next())i.Gd=o.value,n=n.ca(function(e){return function(){return e.Gd(t,r)}}(i));return n.ca(void 0,(function(e){if(e&&7001==e.code)throw e;throw new Z(2,1,1006,e)}))}(this,e,t);var o=i.ca((function(){return qe(r,e,t,new Oe(t.retryParameters,!1),0,null,n)})),a=o.ca((function(t){return function(e,t,r){for(var n=Le(void 0),i=(e=h(e.h)).next();!i.done;i=e.next())n=n.ca(i.value.bind(null,t,r.response));return n.ca((function(){return r}),(function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof Z&&(t=e.severity),new Z(t,1,1007,e)}))}(r,e,t)})),s=Date.now(),u=0;i.promise.then((function(){u=Date.now()-s}),(function(){}));var c=0;return o.promise.then((function(){c=Date.now()}),(function(){})),i=new Je((i=a.ca((function(t){var n=Date.now()-c,i=t.response;return i.timeMs+=u,i.timeMs+=n,t.Nf||!r.i||i.fromCache||1!=e||r.i(i.timeMs,i.data.byteLength),i}),(function(e){throw e&&(e.severity=2),e}))).promise,i.se,n),ze(this.l,i),i},We.prototype.request=We.prototype.request,We.NumBytesRemainingClass=Qe,A(Je,Re),We.PendingRequest=Je,Je.all=Me,Je.notAbortable=Ne,Je.completed=Le,Je.aborted=De,Je.failed=xe,G("shaka.util.IReleasable",et),et.prototype.release=function(){},G("shaka.util.EventManager",tt),tt.prototype.release=function(){this.nb(),this.g=null},tt.prototype.release=tt.prototype.release,tt.prototype.H=function(e,t,r,n){this.g&&(e=new rt(e,t,r,n),this.g.push(t,e))},tt.prototype.listen=tt.prototype.H,tt.prototype.ya=function(e,t,r,n){var i=this;this.H(e,t,(function n(o){i.ta(e,t,n),r(o)}),n)},tt.prototype.listenOnce=tt.prototype.ya,tt.prototype.ta=function(e,t,r){if(this.g)for(var n=this.g.get(t)||[],i=(n=h(n)).next();!i.done;i=n.next())(i=i.value).target!=e||r!=i.listener&&r||(i.ta(),this.g.remove(t,i))},tt.prototype.unlisten=tt.prototype.ta,tt.prototype.nb=function(){if(this.g){for(var e=this.g.getAll(),t=(e=h(e)).next();!t.done;t=e.next())t.value.ta();this.g.g={}}},tt.prototype.removeAll=tt.prototype.nb,rt.prototype.ta=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1},rt.prototype.unlisten=rt.prototype.ta;var nt=void 0;function it(e){return new Q(e=_e(e)).Aa}function ot(e,t,r){function n(e){new DataView(i.buffer).setUint32(o,e.byteLength,!0),o+=4,i.set(e,o),o+=e.byteLength}if(!r||!r.byteLength)throw new Z(2,6,6015);t="string"==typeof t?new Uint8Array(Ae(t,!0)):new Uint8Array(t),e=Ae(e=_e(e),!0);var i=new Uint8Array(12+e.byteLength+t.byteLength+r.byteLength),o=0;return n(new Uint8Array(e)),n(t),n(new Uint8Array(r)),i}function at(e,t){for(var r=[],n=h(e),i=n.next();!i.done;i=n.next())r.push(t(i.value));return r}function st(e,t){for(var r=h(e),n=r.next();!n.done;n=r.next())if(!t(n.value))return!1;return!0}function ut(e){var t=new Map;return Object.keys(e).forEach((function(r){t.set(r,e[r])})),t}function ct(e){var t={};return e.forEach((function(e,r){t[r]=e})),t}function lt(e,t){var r=e;return t&&(r+='; codecs="'+t+'"'),r}function dt(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function ft(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}G("shaka.util.FairPlayUtils.defaultGetContentId",it),G("shaka.util.FairPlayUtils.initDataTransform",ot);var ht=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function pt(){return!(!t.MediaSource||!MediaSource.isTypeSupported)}function gt(e){return""!=bt().canPlayType(e)}function yt(){return _t("Tizen")}function vt(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!yt()}function mt(){if(!vt())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function _t(e){return(navigator.userAgent||"").includes(e)}function bt(){return Et||(At||(At=new ke((function(){Et=null}))),(Et=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Et=document.createElement("video")),At.V(1),Et)}var At=null,Et=null;function St(e,t){var r=this;t=void 0===t?1:t,this.J=e,this.C=new Set,this.m=this.o=null,this.Z=!1,this.P=0,this.g=null,this.u=new tt,this.h=new Map,this.F=[],this.A=new ye,this.j=null,this.l=function(t){r.A.reject(t),e.onError(t)},this.wa=new Map,this.da=new Map,this.X=new ke((function(){return function(e){var t=e.wa,r=e.da;r.clear(),t.forEach((function(e,t){return r.set(t,e)})),(t=Array.from(r.values())).length&&t.every((function(e){return"expired"==e}))&&e.l(new Z(2,6,6014)),e.J.Dc(ct(r))}(r)})),this.i=!1,this.ua=new ye,this.L=!1,this.M=[],this.va=!1,this.ea=new ke((function(){!function(e){e.h.forEach((function(t,r){var n=t.xd,i=r.expiration;isNaN(i)&&(i=1/0),i!=n&&(e.J.onExpirationUpdated(r.sessionId,i),t.xd=i)}))}(r)})).Oa(t),this.A.catch((function(){}))}function Tt(e,t,r){return e.F=r,e.L=0<r.length,$t(e,t)}function $t(e,r){var n=function(e){if(0==(e=ut(e.j.clearKeys)).size)return null;var r=[],n=[];e.forEach((function(e,t){var i=Te.$c(t),o=Te.$c(e);i={kty:"oct",kid:Te.Mc(i,!1),k:Te.Mc(o,!1)},r.push(i),n.push(i.kid)})),e=JSON.stringify({keys:r});var i=JSON.stringify({kids:n});return i=[{initData:new Uint8Array(be(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+t.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:i,keyIds:[]}}(e);if(n)for(var i=h(r),o=i.next();!o.done;o=i.next())o.value.drmInfos=[n];for((n=r.some((function(e){return 0<e.drmInfos.length})))||function(e,t){var r=[];t.forEach((function(e,t){r.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})}));for(var n=h(e),i=n.next();!i.done;i=n.next())i.value.drmInfos=r}(r,o=ut(e.j.servers)),o=(i=h(r)).next();!o.done;o=i.next())for(var a=(o=h(o.value.drmInfos)).next();!a.done;a=o.next())Vt(a.value,ut(e.j.servers),ut(e.j.advanced||{}));return o=function(e,t){for(var r=new Set,n=h(t),i=n.next();!i.done;i=n.next()){var o=h(i.value.drmInfos);for(i=o.next();!i.done;i=o.next())r.add(i.value)}for(n=h(r),i=n.next();!i.done;i=n.next())Vt(i.value,ut(e.j.servers),ut(e.j.advanced||{}));o=e.L?"required":"optional";var a=e.L?["persistent-license"]:["temporary"];for(n=new Map,r=h(r),i=r.next();!i.done;i=r.next())i=i.value,n.set(i.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:o,sessionTypes:a,label:i.keySystem,drmInfos:[]});for(r=h(t),i=r.next();!i.done;i=r.next()){o=(i=i.value).audio,a=i.video;var s=o?Rt(o):"",u=a?Rt(a):"",c=h(i.drmInfos);for(i=c.next();!i.done;i=c.next()){i=i.value;var l=n.get(i.keySystem);l.drmInfos.push(i),i.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),i.persistentStateRequired&&(l.persistentState="required"),o&&(l.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:s}),"ac-3"==o.codecs.toLowerCase()&&yt()&&l.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:lt(o.mimeType,"ec-3")})),a&&l.videoCapabilities.push({robustness:i.videoRobustness||"",contentType:u})}}return n}(e,r),o.size?(o=xt(e,o),n?o:o.catch((function(){}))):(e.Z=!0,Promise.resolve())}function wt(e){return g((function t(){var r;return M(t,(function(t){switch(t.s){case 1:if(!(e.o&&e.g&&e.g.serverCertificate&&e.g.serverCertificate.length)){t.I(0);break}return C(t,3),$(t,e.o.setServerCertificate(e.g.serverCertificate),5);case 5:t.B||X.v("Server certificates are not supported by the key system.  The server certificate has been ignored."),k(t,0);break;case 3:return r=O(t),t.return(Promise.reject(new Z(2,6,6004,r.message)))}}))}))}function Ct(e){var t=e.g?e.g.initData:[];return t.forEach((function(t){return It(e,t.initDataType,t.initData)})),e.F.forEach((function(t){return Dt(e,t)})),t.length||e.F.length||e.A.resolve(),e.A}function It(e,t,r){for(var n=e.h.values(),i=(n=h(n)).next();!i.done;i=n.next())if(Te.Ha(r,i.value.initData)&&!_t("Tizen 2"))return void X.debug("Ignoring duplicate init data.");!function(e,t,r){try{if(e.L){X.K("Creating new persistent session");var n=e.o.createSession("persistent-license")}else X.K("Creating new temporary session"),n=e.o.createSession()}catch(i){return void e.l(new Z(2,6,6005,i.message))}e.u.H(n,"message",e.ye.bind(e)),e.u.H(n,"keystatuseschange",e.we.bind(e)),e.h.set(n,{initData:r,loaded:!1,xd:1/0,Ga:null});try{r=e.j.initDataTransform(r,e.g)}catch(i){return t=i,i instanceof Z||(t=new Z(2,6,6016,i)),void e.l(t)}n.generateRequest(t,r).catch((function(t){if(!e.i){if(e.h.delete(n),t.errorCode&&t.errorCode.systemCode){var r=t.errorCode.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}e.l(new Z(2,6,6006,t.message,t,r))}}))}(e,t,r)}function kt(e){return e?e.keySystem:""}function Ot(e,t){if(navigator.userAgent.match(/Edge\//))return!0;if(t=t.toLowerCase(),yt()&&t.includes('codecs="ac-3"')){var r=t.replace("ac-3","ec-3");return e.C.has(t)||e.C.has(r)}return e.C.has(t)}function Pt(e){return e=at(e=e.h.keys(),(function(e){return e.sessionId})),Array.from(e)}function Rt(e){var t=lt(e.mimeType,e.codecs);return we(t)?Ce(e.type,t):t}function xt(e,t){if(1==t.size&&t.has(""))return Promise.reject(new Z(2,6,6e3));for(var r=h(t.values()),n=r.next();!n.done;n=r.next())0==(n=n.value).audioCapabilities.length&&delete n.audioCapabilities,0==n.videoCapabilities.length&&delete n.videoCapabilities;var i=r=new ye;return[!0,!1].forEach(function(e){var r=this;t.forEach((function(t,n){t.drmInfos.some((function(e){return!!e.licenseServerUri}))==e&&(i=i.catch(function(){if(!this.i)return navigator.requestMediaKeySystemAccess(n,[t])}.bind(r)))}))}.bind(e)),i=(i=i.catch((function(){return Promise.reject(new Z(2,6,6001))}))).then(function(e){if(this.i)return Promise.reject();this.C.clear();var r=e.getConfiguration(),n=r.videoCapabilities||[],i=h(r.audioCapabilities||[]);for(r=i.next();!r.done;r=i.next())this.C.add(r.value.contentType.toLowerCase());for(r=(n=h(n)).next();!r.done;r=n.next())this.C.add(r.value.contentType.toLowerCase());n=e.keySystem,i=[];var o=[],a=[],s=[];return function(e,t,r,n,i){e.forEach((function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(r.some((function(t){return Te.Ha(t,e.serverCertificate)}))||r.push(e.serverCertificate)),e.initData&&e.initData.forEach((function(e){n.some((function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&Te.Ha(t.initData,e.initData)}))||n.push(e)})),e.keyIds)for(var o=0;o<e.keyIds.length;++o)i.includes(e.keyIds[o])||i.push(e.keyIds[o])}))}((r=t.get(e.keySystem)).drmInfos,i,o,a,s),1<o.length&&X.v("Multiple unique server certificates found! Only the first will be used."),1<i.length&&X.v("Multiple unique license server URIs found! Only the first will be used."),this.g={keySystem:n,licenseServerUri:i[0],distinctiveIdentifierRequired:"required"==r.distinctiveIdentifier,persistentStateRequired:"required"==r.persistentState,audioRobustness:(r.audioCapabilities?r.audioCapabilities[0].robustness:"")||"",videoRobustness:(r.videoCapabilities?r.videoCapabilities[0].robustness:"")||"",serverCertificate:o[0],initData:a,keyIds:s},this.g.licenseServerUri?e.createMediaKeys():Promise.reject(new Z(2,6,6012,this.g.keySystem))}.bind(e)).then(function(e){if(this.i)return Promise.reject();X.info("Created MediaKeys object for key system",this.g.keySystem),this.o=e,this.Z=!0}.bind(e)).catch(function(e){if(!this.i)return this.g=null,this.C.clear(),e instanceof Z?Promise.reject(e):Promise.reject(new Z(2,6,6002,e.message))}.bind(e)),r.reject(),i}function Dt(e,t){try{X.K("Attempting to load an offline session",t);var r=e.o.createSession("persistent-license")}catch(o){var n=new Z(2,6,6005,o.message);return e.l(n),Promise.reject(n)}e.u.H(r,"message",e.ye.bind(e)),e.u.H(r,"keystatuseschange",e.we.bind(e));var i={initData:null,loaded:!1,xd:1/0,Ga:null};return e.h.set(r,i),r.load(t).then(function(e){return this.i?Promise.reject():(X.O("Loaded offline session",t,e),e?(i.loaded=!0,Ft(this)&&this.A.resolve(),r):(this.h.delete(r),void this.l(new Z(2,6,6013))))}.bind(e),function(e){this.i||(this.h.delete(r),this.l(new Z(2,6,6005,e.message)))}.bind(e))}function Lt(e,t){if(kt(t).startsWith("com.apple.fps")){var r=t.serverCertificate;e=ot(e,it(e),r)}return e}function Nt(e,t){var r=t.target;X.K("Sending license request for session",r.sessionId,"of type",t.messageType);var n=e.h.get(r),i=e.g.licenseServerUri,o=e.j.advanced[e.g.keySystem];"individualization-request"==t.messageType&&o&&o.individualizationServer&&(i=o.individualizationServer),(i=Ze([i],e.j.retryParameters)).body=t.message,i.method="POST",i.licenseRequestType=t.messageType,i.sessionId=r.sessionId,"com.microsoft.playready"!=e.g.keySystem&&"com.chromecast.playready"!=e.g.keySystem||function(e){var t=me(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){X.debug("Unwrapping PlayReady request.");for(var r=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),n=0;n<r.length;++n)e.headers[r[n].getElementsByTagName("name")[0].textContent]=r[n].getElementsByTagName("value")[0].textContent;e.body=Te.Ja(t.getElementsByTagName("Challenge")[0].textContent).buffer}else X.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(i),e.g.keySystem.startsWith("com.apple.fps")&&e.j.fairPlayTransform&&function(e){var t=new Uint8Array(e.body);t="spc="+Te.Mc(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=be(t)}(i);var a=Date.now();e.J.Ib.request(2,i).promise.then(function(e){return this.i?Promise.reject():(this.g.keySystem.startsWith("com.apple.fps")&&this.j.fairPlayTransform&&function(e){try{var t=ve(e.data)}catch(r){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(r){}e.data=Te.Ja(t).buffer}(e),this.P+=(Date.now()-a)/1e3,X.K("Updating session",r.sessionId),r.update(e.data).then(function(){var e=this;this.J.onEvent(new Be("drmsessionupdate")),n&&(n.Ga&&n.Ga.resolve(),new ke((function(){n.loaded=!0,Ft(e)&&e.A.resolve()})).V(Ht))}.bind(this)))}.bind(e),function(e){this.i||(e=new Z(2,6,6007,e),this.l(e),n&&n.Ga&&n.Ga.reject(e))}.bind(e)).catch(function(e){this.i||(e=new Z(2,6,6008,e.message),this.l(e),n&&n.Ga&&n.Ga.reject(e))}.bind(e))}function Mt(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],r=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map((function(e){return n=e,g((function e(){var i,o,a;return M(e,(function(e){switch(e.s){case 1:return C(e,2),$(e,navigator.requestMediaKeySystemAccess(n,t),4);case 4:return i=e.B,a=!!(o=i.getConfiguration().sessionTypes)&&o.includes("persistent-license"),_t("Tizen 3")&&(a=!1),r.set(n,{persistentState:a}),$(e,i.createMediaKeys(),5);case 5:k(e,0);break;case 2:O(e),r.set(n,null),w(e)}}))}));var n})),Promise.all(e).then((function(){return ct(r)}))}function Bt(e,t){var r=t.audio,n=t.video;if(r&&r.encrypted&&!Ot(e,r=Rt(r))||n&&n.encrypted&&!Ot(e,n=Rt(n)))return!1;var i=kt(e.g);return 0==t.drmInfos.length||t.drmInfos.some((function(e){return e.keySystem==i}))}function Ut(e,t){if(!e.length)return t;if(!t.length)return e;for(var r=[],n=0;n<e.length;n++)for(var i=0;i<t.length;i++)if(e[n].keySystem==t[i].keySystem){var o=e[n];i=t[i];var a=[];a=(a=a.concat(o.initData||[])).concat(i.initData||[]);var s=[];s=(s=s.concat(o.keyIds)).concat(i.keyIds),r.push({keySystem:o.keySystem,licenseServerUri:o.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:o.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:o.persistentStateRequired||i.persistentStateRequired,videoRobustness:o.videoRobustness||i.videoRobustness,audioRobustness:o.audioRobustness||i.audioRobustness,serverCertificate:o.serverCertificate||i.serverCertificate,initData:a,keyIds:s});break}return r}function jt(e){return g((function t(){var r;return M(t,(function(t){if(1===t.s)return r=Array.from(e.h.keys()),e.h.clear(),$(t,Promise.all(r.map((function(e){return g((function t(){return M(t,(function(t){switch(t.s){case 1:return X.K("Closing session",e.sessionId),C(t,2),$(t,function(e){return g((function t(){var r;return M(t,(function(t){switch(t.s){case 1:return r=new Promise((function(e,t){new ke(t).V(Gt)})),C(t,2),$(t,Promise.race([Promise.all([e.close(),e.closed]),r]),4);case 4:k(t,0);break;case 2:O(t),X.v("Timeout waiting for session close"),w(t)}}))}))}(e),4);case 4:k(t,0);break;case 2:O(t),w(t)}}))}))}))),0)}))}))}function Ft(e){return st(e=e.h.values(),(function(e){return e.loaded}))}function Vt(e,r,n){!e.keySystem||"org.w3.clearkey"==e.keySystem&&e.licenseServerUri||(r.size&&(r=r.get(e.keySystem)||"",e.licenseServerUri=r),e.keyIds||(e.keyIds=[]),(n=n.get(e.keySystem))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.videoRobustness||(e.videoRobustness=n.videoRobustness),e.audioRobustness||(e.audioRobustness=n.audioRobustness),e.serverCertificate||(e.serverCertificate=n.serverCertificate)),t.cast&&t.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready"))}(i=St.prototype).destroy=function(){var e=this;return g((function t(){return M(t,(function(t){switch(t.s){case 1:return e.i?$(t,e.ua,0):(e.i=!0,$(t,function(e){return g((function t(){return M(t,(function(t){switch(t.s){case 1:return e.u.release(),e.u=null,e.A.reject(),e.ea.stop(),e.ea=null,e.X.stop(),e.X=null,$(t,jt(e),2);case 2:if(!e.m){t.I(3);break}return C(t,4),$(t,e.m.setMediaKeys(null),6);case 6:k(t,5);break;case 4:O(t);case 5:e.m=null;case 3:e.g=null,e.C.clear(),e.o=null,e.F=[],e.j=null,e.l=null,e.J=null,w(t)}}))}))}(e),4));case 4:e.ua.resolve(),t.I(0)}}))}))},i.configure=function(e){this.j=e},i.Ub=function(e){var t=this;if(!this.o)return this.u.ya(e,"encrypted",(function(){t.l(new Z(2,6,6010))})),Promise.resolve();this.m=e,this.u.ya(this.m,"play",(function(){for(var e=0;e<t.M.length;e++)Nt(t,t.M[e]);t.va=!0,t.M=[]})),"webkitCurrentPlaybackTargetIsWireless"in this.m&&this.u.H(this.m,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return jt(t)})),e=(e=this.m.setMediaKeys(this.o)).catch((function(e){return Promise.reject(new Z(2,6,6003,e.message))}));var r=wt(this);return Promise.all([e,r]).then((function(){if(t.i)return Promise.reject();Ct(t),t.g.initData.length||t.F.length||t.u.H(t.m,"encrypted",(function(e){return It(t,e.initDataType,new Uint8Array(e.initData))}))})).catch((function(e){if(!t.i)return Promise.reject(e)}))},i.Xb=function(){for(var e=1/0,t=this.h.keys(),r=(t=h(t)).next();!r.done;r=t.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},i.ye=function(e){this.m&&this.j.delayLicenseRequestUntilPlayed&&this.m.paused&&!this.va?this.M.push(e):Nt(this,e)},i.we=function(e){e=e.target,X.O("Key status changed for session",e.sessionId);var t=this.h.get(e),r=!1;e.keyStatuses.forEach(function(e,n){if("string"==typeof n){var i=n;n=e,e=i}if("com.microsoft.playready"==this.g.keySystem&&16==n.byteLength&&(_t("Trident/")||navigator.userAgent.match(/Edge?\//))){var o=(i=new DataView(n)).getUint32(0,!0),a=i.getUint16(4,!0),s=i.getUint16(6,!0);i.setUint32(0,o,!1),i.setUint16(4,a,!1),i.setUint16(6,s,!1)}"com.microsoft.playready"==this.g.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(r=!0),i=Te.Nc(new Uint8Array(n)),this.wa.set(i,e)}.bind(this));var n=e.expiration-Date.now();(0>n||r&&1e3>n)&&t&&!t.Ga&&(X.debug("Session has expired",e.sessionId),this.h.delete(e),e.close().catch((function(){}))),Ft(this)&&(this.A.resolve(),this.X.V(Kt))};var Gt=1,Ht=5,Kt=.5;function zt(){this.g=new muxjs.mp4.CaptionParser,this.l=[],this.j={}}function Wt(){}function Yt(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Xt(e,t,r){return r=void 0===r?0:r,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+r>=e.start(0)}function Zt(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var r=0,n=e.length-1;0<=n&&e.end(n)>t;--n)r+=e.end(n)-Math.max(e.start(n),t);return r}function qt(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}function Qt(e,t,r){this.startTime=e,this.direction=ir,this.endTime=t,this.payload=r,this.region=new fr,this.position=null,this.positionAlign=Jt,this.size=0,this.textAlign=er,this.writingMode=or,this.lineInterpretation=ar,this.line=null,this.lineHeight="",this.lineAlign=sr,this.displayAlign=rr,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=cr,this.fontStyle=lr,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}zt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.l=t.videoTrackIds(e),this.j=t.timescale(e),this.g.init()},zt.prototype.h=function(e,t){var r=new Uint8Array(e);(r=this.g.parse(r,this.l,this.j))&&r.captions&&t(r.captions),this.g.clearParsedCaptions()},zt.prototype.i=function(){this.g.resetCaptionStream()},Wt.prototype.init=function(){},Wt.prototype.h=function(){},Wt.prototype.i=function(){},G("shaka.text.Cue",Qt),Qt.prototype.clone=function(){var e,t=new Qt(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t};var Jt="auto";Qt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Jt};var er="center",tr={LEFT:"left",RIGHT:"right",CENTER:er,START:"start",END:"end"};Qt.textAlign=tr;var rr="after",nr={BEFORE:"before",CENTER:"center",AFTER:rr};Qt.displayAlign=nr;var ir="ltr";Qt.direction={HORIZONTAL_LEFT_TO_RIGHT:ir,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var or="horizontal-tb";Qt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:or,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var ar=0;Qt.lineInterpretation={LINE_NUMBER:ar,PERCENTAGE:1};var sr="start",ur={CENTER:"center",START:sr,END:"end"};Qt.lineAlign=ur;var cr=400;Qt.fontWeight={NORMAL:cr,BOLD:700};var lr="normal",dr={NORMAL:lr,ITALIC:"italic",OBLIQUE:"oblique"};function fr(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=hr,this.scroll=pr}Qt.fontStyle=dr,Qt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},G("shaka.text.CueRegion",fr);var hr=1;fr.units={PX:0,PERCENTAGE:hr,LINES:2};var pr="";function gr(e){this.l=null,this.i=e,this.j=this.A=0,this.m=1/0,this.h=this.g=null,this.u="",this.o=new Map}fr.scrollMode={NONE:pr,UP:"up"};var yr={};function vr(e){return!!(yr[e]||t.muxjs&&"application/cea-608"==e)}function mr(e,t){"application/cea-608"!=t&&(e.l=new yr[t])}function _r(e,t,r,n,i){for(var o=r+" "+n,a=new Map,s=(t=h(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,a.has(s)||a.set(s,new Map),a.get(s).has(o)||a.get(s).set(o,[]),u.startTime+=i,u.endTime+=i,u.startTime>=e.j&&u.startTime<e.m&&(u=new Qt(u.startTime,u.endTime,u.text),a.get(s).get(o).push(u),s==e.u&&e.i.append([u]))}for(o=(i=h(a.keys())).next();!o.done;o=i.next())for(o=o.value,e.o.has(o)||e.o.set(o,new Map),s=(t=h(a.get(o).keys())).next();!s.done;s=t.next())s=s.value,u=a.get(o).get(s),e.o.get(o).set(s,u);e.g=null==e.g?Math.max(r,e.j):Math.min(e.g,Math.max(r,e.j)),e.h=Math.max(e.h,Math.min(n,e.m))}function br(e,t,r){this.j=e,this.l=r,this.h={},this.g=null,this.i={},this.o=new tt,this.F=!1,this.u={},this.A=t,this.C=new ye,this.m=function(e,t){var r=new MediaSource;return e.o.ya(r,"sourceopen",(function(){URL.revokeObjectURL(e.J),t.resolve()})),e.J=Ar(r),e.j.src=e.J,r}(this,this.C),this.J=""}G("shaka.text.TextEngine.registerParser",(function(e,t){yr[e]=t})),G("shaka.text.TextEngine.unregisterParser",(function(e){delete yr[e]})),gr.prototype.destroy=function(){return this.i=this.l=null,this.o.clear(),Promise.resolve()},gr.prototype.xc=function(e){try{return this.l.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(t){throw new Z(2,2,2009,t)}},gr.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.i||!this.i.remove(e,t)||null==this.g||t<=this.g||e>=this.h||(e<=this.g&&t>=this.h?this.g=this.h=null:e<=this.g&&t<this.h?this.g=t:e>this.g&&t>=this.h&&(this.h=e))}.bind(this))};var Ar=t.URL.createObjectURL;function Er(e){var t=lt(e.mimeType,e.codecs),r=function(e){var t=[e.mimeType];return ht.forEach((function(r,n){var i=e[n];i&&t.push(r+'="'+i+'"')})),t.join(";")}(e);return vr(t)||MediaSource.isTypeSupported(r)||we(t,e.type)}function Sr(e,t){e.g||(e.g=new gr(e.l)),mr(e.g,t)}function Tr(e){return!e.m||"ended"==e.m.readyState}function $r(e,t){if("text"==t)var r=e.g.g;else r=!(r=Cr(e,t))||1==r.length&&1e-6>r.end(0)-r.start(0)?null:1==r.length&&0>r.start(0)?0:r.length?r.start(0):null;return r}function wr(e,t){return"text"==t?e.g.h:Yt(Cr(e,t))}function Cr(e,t){try{return e.h[t].buffered}catch(r){return t in e.h&&X.error("failed to get buffered range for "+t,r),null}}function Ir(e,r,n,i,o,a){return"text"==r?function(e,t,r,n){return Promise.resolve().then(function(){if(this.l&&this.i)if(null==r||null==n)this.l.parseInit(new Uint8Array(t));else{var e={periodStart:this.A,segmentStart:r,segmentEnd:n};e=this.l.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.j&&e.startTime<this.m}.bind(this)),this.i.append(e),null==this.g&&(this.g=Math.max(r,this.j)),this.h=Math.min(n,this.m)}}.bind(e))}(e.g,n,i,o):e.u[r]?function(e,t){e.j=!0,e.h=new ye,e.l=[],e.i=[];var r=new Uint8Array(t);return e.g.push(r),e.g.flush(),e.j&&e.h.reject(new Z(2,3,3018)),e.h}(e.u[r],n).then(function(e){return this.g||Sr(this,"text/vtt"),e.captions&&e.captions.length&&_r(this.g,e.captions,i,o,this.h.video.timestampOffset),Pr(this,r,this.Me.bind(this,r,e.data.buffer))}.bind(e)):(a&&t.muxjs&&(e.g||Sr(e,"text/vtt"),null==i&&null==o?e.A.init(n):e.A.h(n,(function(t){t.length&&_r(e.g,t,i,o,e.h.video.timestampOffset)}))),Pr(e,r,e.Me.bind(e,r,n)))}function kr(e,t){var r=wr(e,"video")||0;!function(e,t,r){if(e.u=t,t=e.o.get(t))for(var n=h(t.keys()),i=n.next();!i.done;i=n.next())(i=t.get(i.value).filter((function(e){return e.endTime<=r})))&&e.i.append(i)}(e.g,t,r)}function Or(e,t){return"text"==t?e.g?(e.A.i(),e.g.remove(0,1/0)):Promise.resolve():Pr(e,t,e.Ne.bind(e,t,0,e.m.duration))}function Pr(e,t,r){if(e.F)return Promise.reject();if(r={start:r,p:new ye},e.i[t].push(r),1==e.i[t].length)try{r.start()}catch(n){"QuotaExceededError"==n.name?r.p.reject(new Z(2,3,3017,t)):r.p.reject(new Z(2,3,3015,n)),xr(e,t)}return r.p}function Rr(e,t){if(e.F)return Promise.reject();var r,n=[];for(r in e.h){var i=new ye,o={start:function(e){e.resolve()}.bind(null,i),p:i};e.i[r].push(o),n.push(i),1==e.i[r].length&&o.start()}return Promise.all(n).then(function(){try{t()}catch(n){var e=Promise.reject(new Z(2,3,3015,n))}for(var r in this.h)xr(this,r);return e}.bind(e),function(e){throw e}.bind(e))}function xr(e,t){e.i[t].shift();var r=e.i[t][0];if(r)try{r.start()}catch(n){r.p.reject(new Z(2,3,3015,n)),xr(e,t)}}function Dr(e,t){return e=Nr(e),t=Nr(t),e.split("-")[0]==t.split("-")[0]}function Lr(e,t){e=Nr(e),t=Nr(t);var r=e.split("-"),n=t.split("-");return r[0]==n[0]&&1==r.length&&2==n.length}function Nr(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Ur.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Mr(e){return e.language?Nr(e.language):e.audio&&e.audio.language?Nr(e.audio.language):e.video&&e.video.language?Nr(e.video.language):"und"}function Br(e,t){for(var r=Nr(e),n=new Set,i=h(t),o=i.next();!o.done;o=i.next())n.add(Nr(o.value));for(o=(i=h(n)).next();!o.done;o=i.next())if((o=o.value)==r)return o;for(o=(i=h(n)).next();!o.done;o=i.next())if(Lr(o=o.value,r))return o;for(o=(i=h(n)).next();!o.done;o=i.next()){var a=o=o.value,s=r;if(a=Nr(a),s=Nr(s),a=a.split("-"),s=s.split("-"),2==a.length&&2==s.length&&a[0]==s[0])return o}for(o=(n=h(n)).next();!o.done;o=n.next())if(Lr(r,i=o.value))return i;return null}(i=br.prototype).destroy=function(){var e=this;this.F=!0;var t,r=[];for(t in this.i){var n=this.i[t],i=n[0];for(this.i[t]=n.slice(0,1),i&&r.push(i.p.catch(de.Bc)),i=1;i<n.length;++i)n[i].p.reject()}for(var o in this.g&&r.push(this.g.destroy()),this.l&&r.push(this.l.destroy()),this.u)r.push(this.u[o].destroy());return Promise.all(r).then((function(){e.o&&(e.o.release(),e.o=null),e.j&&(e.j.removeAttribute("src"),e.j.load(),e.j=null),e.m=null,e.g=null,e.l=null,e.h={},e.u={},e.A=null,e.i={}}))},i.init=function(e,t){var r=this;return g((function n(){var i;return M(n,(function(n){switch(n.s){case 1:return i=pe,$(n,r.C,2);case 2:e.forEach((function(e,n){var o=lt(e.mimeType,e.codecs);n==i.za?Sr(r,o):(!t&&MediaSource.isTypeSupported(o)||!we(o,n)||(r.u[n]=new $e,o=Ce(n,o)),o=r.m.addSourceBuffer(o),r.o.H(o,"error",r.Dg.bind(r,n)),r.o.H(o,"updateend",r.Lb.bind(r,n)),r.h[n]=o,r.i[n]=[])})),w(n)}}))}))},i.bd=function(e){if(e.total=qt(this.j.buffered),e.audio=qt(Cr(this,"audio")),e.video=qt(Cr(this,"video")),e.text=[],this.g){var t=this.g.g,r=this.g.h;null!=t&&null!=r&&e.text.push({start:t,end:r})}},i.remove=function(e,t,r){return"text"==e?this.g.remove(t,r):Pr(this,e,this.Ne.bind(this,e,t,r))},i.flush=function(e){return"text"==e?Promise.resolve():Pr(this,e,this.lf.bind(this,e))},i.endOfStream=function(e){return Rr(this,function(){Tr(this)||(e?this.m.endOfStream(e):this.m.endOfStream())}.bind(this))},i.Fa=function(e){return Rr(this,function(){this.m.duration=e}.bind(this))},i.ha=function(){return this.m.duration},i.Me=function(e,t){this.h[e].appendBuffer(t)},i.Ne=function(e,t,r){r<=t?this.Lb(e):this.h[e].remove(t,r)},i.Ve=function(e){var t=this.h[e].appendWindowStart,r=this.h[e].appendWindowEnd;this.h[e].abort(),this.h[e].appendWindowStart=t,this.h[e].appendWindowEnd=r,this.Lb(e)},i.lf=function(e){this.j.currentTime-=.001,this.Lb(e)},i.Cg=function(e,t){0>t&&(t+=.001),this.h[e].timestampOffset=t,this.Lb(e)},i.zg=function(e,t,r){this.h[e].appendWindowStart=0,this.h[e].appendWindowEnd=r,this.h[e].appendWindowStart=t,this.Lb(e)},i.Dg=function(e){this.i[e][0].p.reject(new Z(2,3,3014,this.j.error?this.j.error.code:0))},i.Lb=function(e){var t=this.i[e][0];t&&(t.p.resolve(),xr(this,e))};var Ur=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),jr={$d:function(e,t){var r=e.periods.reduce((function(e,t){return e.concat(t.variants)}),[]);r=jr.ee(r,t),r=jr.Lf(r),r=jr.jf(r);for(var n=jr.kf(r),i=(r=h(e.periods)).next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter((function(e){return jr.he(e)==n||(X.debug("Dropping Variant (better codec available)",e),!1)}))},Lf:function(e){for(var t=new Ue,r=(e=h(e)).next();!r.done;r=e.next()){r=r.value;var n=jr.he(r);t.push(n,r)}return t},jf:function(e){var t=0,r=new Map,n=e.size();return e.forEach((function(e,i){for(var o=h(i),a=o.next();!a.done;a=o.next()){var s=(a=a.value).video;if(s&&s.width&&s.height){s=s.width*s.height*(s.frameRate||1),r.has(s)||r.set(s,new Ue);var u=r.get(s);u.push(e,a),u.size()===n&&(t=Math.max(t,s))}}})),t?r.get(t):e},kf:function(e){var t="",r=1/0;return e.forEach((function(e,n){for(var i=0,o=0,a=h(n),s=a.next();!s.done;s=a.next())i+=s.value.bandwidth||0,++o;i/=o,X.debug("codecs",e,"avg bandwidth",i),i<r&&(t=e,r=i)})),t},he:function(e){var t="";e.video&&(t=ft(e.video.codecs)[0]);var r="";return e.audio&&(r=ft(e.audio.codecs)[0]),t+"-"+r},rd:function(e,t,r){function n(e,t,r){return e>=t&&e<=r}var i=e.video;return!(i&&i.width&&i.height&&(!n(i.width,t.minWidth,Math.min(t.maxWidth,r.width))||!n(i.height,t.minHeight,Math.min(t.maxHeight,r.height))||!n(i.width*i.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!n(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!n(e.bandwidth,t.minBandwidth,t.maxBandwidth))},Xd:function(e,t,r){var n=!1;return e.forEach((function(e){var i=e.allowedByApplication;e.allowedByApplication=jr.rd(e,t,r),i!=e.allowedByApplication&&(n=!0)})),n},filterNewPeriod:function(e,t,r,n){n.variants=n.variants.filter((function(n){if(e&&e.Z&&!Bt(e,n))return X.debug("Dropping variant - not compatible with key system",n),!1;var i=n.audio;return n=n.video,i&&!Er(i)?(X.debug("Dropping variant - audio not compatible with platform",jr.fb(i)),!1):n&&!Er(n)||_t("Xbox One")&&n&&(n.width&&1920<n.width||n.height&&1080<n.height)&&n.codecs.includes("avc1.")?(X.debug("Dropping variant - video not compatible with platform",jr.fb(n)),!1):i&&t&&!jr.Yd(i,t)?(X.debug("Droping variant - not compatible with active audio","active audio",jr.fb(t),"variant.audio",jr.fb(i)),!1):!(n&&r&&!jr.Yd(n,r))||(X.debug("Droping variant - not compatible with active video","active video",jr.fb(r),"variant.video",jr.fb(n)),!1)})),n.textStreams=n.textStreams.filter((function(e){var t=vr(lt(e.mimeType,e.codecs));return t||X.debug("Dropping text stream. Is not supported by the platform.",e),t}))},Yd:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},Oc:function(e){var t=e.audio,r=e.video,n=t?t.codecs:null,i=r?r.codecs:null,o=[];i&&o.push(i),n&&o.push(n);var a=[];r&&a.push(r.mimeType),t&&a.push(t.mimeType),a=a[0]||null;var s=[];t&&s.push(t.kind),r&&s.push(r.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach((function(e){return u.add(e)})),r&&r.roles.forEach((function(e){return u.add(e)})),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:a,codecs:o.join(", "),audioCodec:n,videoCodec:i,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},r&&(e.videoId=r.id,e.originalVideoId=r.originalId,e.width=r.width||null,e.height=r.height||null,e.frameRate=r.frameRate||null,e.pixelAspectRatio=r.pixelAspectRatio||null,e.videoBandwidth=r.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},Kc:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},gd:function(e){return e.__shaka_id||(e.__shaka_id=jr.Uf++),e.__shaka_id},Uf:0,Of:function(e){var t=jr.ke(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},je:function(e){var t=jr.ke(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},ke:function(e){return{id:jr.gd(e),active:!1,type:"",bandwidth:0,language:Nr(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Gb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},Bf:function(e){return e.filter((function(e){return jr.Gb(e)}))},ee:function(e,t){for(var r=e.filter((function(e){return e.audio&&e.audio.channelsCount})),n=new Map,i=(r=h(r)).next();!i.done;i=r.next()){var o=(i=i.value).audio.channelsCount;n.has(o)||n.set(o,[]),n.get(o).push(i)}return 0==(r=Array.from(n.keys())).length?e:(i=r.filter((function(e){return e<=t}))).length?n.get(Math.max.apply(null,i)):n.get(Math.min.apply(null,r))},Wb:function(e,t,r){var n=e,i=e.filter((function(e){return e.primary}));i.length&&(n=i);var o=n.length?n[0].language:"";if(n=n.filter((function(e){return e.language==o})),t){var a=Br(Nr(t),e.map((function(e){return e.language})));a&&(n=e.filter((function(e){return Nr(e.language)==a})))}if(r){if((e=jr.de(n,r)).length)return e;X.v("No exact match for the text role could be found.")}else if((e=n.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=n.map((function(e){return e.roles})).reduce(de.Rc,[])).length?jr.de(n,e[0]):n},de:function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},ie:function(e,t,r){for(var n=0;n<r.length;n++)if(r[n].audio==e&&r[n].video==t)return r[n];return null},Pf:function(e){return"audio"==e.type},Sf:function(e){return"video"==e.type},Kf:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},fb:function(e){return jr.Pf(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:jr.Sf(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function Fr(){this.m=null,this.i=!1,this.h=new Y,this.l=[],this.o=!1,this.g=this.j=null}function Vr(e,t){return e&&(t=t.filter((function(t){return jr.rd(t,e,{width:1/0,height:1/0})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function Gr(e,t){this.g=e,this.h=t}function Hr(e,t){var r=new Gr(2,6),n=Wr,i=n.g,o=r.h-i.h;(0<(r.g-i.g||o)?n.i:n.h)(n.g,r,e,t)}function Kr(e,t,r,n){X.ba([r,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",n].join(" "))}function zr(e,t,r,n){X.kc([r,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",n].join(""))}G("shaka.abr.SimpleAbrManager",Fr),Fr.prototype.stop=function(){this.m=null,this.i=!1,this.l=[],this.j=null},Fr.prototype.stop=Fr.prototype.stop,Fr.prototype.init=function(e){this.m=e},Fr.prototype.init=Fr.prototype.init,Fr.prototype.chooseVariant=function(){var e=Vr(this.g.restrictions,this.l),t=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate);this.l.length&&!e.length&&(X.v("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=Vr(null,this.l))[0]]);for(var r=e[0]||null,n=0;n<e.length;++n){var i=e[n],o=i.bandwidth/this.g.bandwidthDowngradeTarget,a=(e[n+1]||{bandwidth:1/0}).bandwidth/this.g.bandwidthUpgradeTarget;X.O("Bandwidth ranges:",(i.bandwidth/1e6).toFixed(3),(o/1e6).toFixed(3),(a/1e6).toFixed(3)),t>=o&&t<=a&&(r=i)}return this.j=Date.now(),r},Fr.prototype.chooseVariant=Fr.prototype.chooseVariant,Fr.prototype.enable=function(){this.i=!0},Fr.prototype.enable=Fr.prototype.enable,Fr.prototype.disable=function(){this.i=!1},Fr.prototype.disable=Fr.prototype.disable,Fr.prototype.segmentDownloaded=function(e,t){X.O("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.j,"enabled="+this.i);var r=this.h;if(!(16e3>t)){var n=8e3*t/e,i=e/1e3;r.g+=t,z(r.h,i,n),z(r.i,i,n)}if(null!=this.j&&this.i)e:{if(X.O("Suggesting Streams..."),this.o){if(Date.now()-this.j<1e3*this.g.switchInterval){X.O("Still within switch interval...");break e}}else{if(!(128e3<=this.h.g)){X.O("Still waiting for a good estimate...");break e}this.o=!0}r=this.chooseVariant(),n=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate),X.debug("Calling switch_(), bandwidth="+Math.round(n/1e3)+" kbps"),this.m(r)}},Fr.prototype.segmentDownloaded=Fr.prototype.segmentDownloaded,Fr.prototype.getBandwidthEstimate=function(){return this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate)},Fr.prototype.getBandwidthEstimate=Fr.prototype.getBandwidthEstimate,Fr.prototype.setVariants=function(e){this.l=e},Fr.prototype.setVariants=Fr.prototype.setVariants,Fr.prototype.configure=function(e){this.g=e},Fr.prototype.configure=Fr.prototype.configure,Gr.prototype.toString=function(){return"v"+this.g+"."+this.h};var Wr=null,Yr="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Xr="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Zr=["loop","playbackRate"],qr=["pause","play"],Qr="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),Jr={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},en={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},tn=[["getConfiguration","configure"]],rn=[["isTextTrackVisible","setTextTrackVisibility"]],nn="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),on=["attach","detach","load","unload"];function an(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Be){var r={};for(i in t){var n=t[i];n&&"object"==_typeof$3(n)?"detail"==i&&(r[i]=n):i in Event||(r[i]=n)}return r}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(r in t)i.add(r);for(r=(n=h(Object.getOwnPropertyNames(t))).next();!r.done;r=n.next())i.add(r.value);for(n={},r=(i=h(i)).next();!r.done;r=i.next())n[r=r.value]=t[r];i={__type__:"Error",contents:n}}else if(t instanceof TimeRanges)for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},r=0;r<t.length;++r)i.start.push(t.start(r)),i.end.push(t.end(r));else i=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return i}}))}function sn(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var r=NaN;else if("-Infinity"==t)r=-1/0;else if("Infinity"==t)r=1/0;else if(t&&"object"==_typeof$3(t)&&"TimeRanges"==t.__type__)r=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==_typeof$3(t)&&"Uint8Array"==t.__type__)r=new Uint8Array(t.entries);else if(t&&"object"==_typeof$3(t)&&"Error"==t.__type__){r=t.contents;var n,i=Error(r.message);for(n in r)i[n]=r[n];r=i}else r=t;return r}))}function un(e,t,r,n,i,o){this.X=e,this.j=new ke(t),this.Z=r,this.u=!1,this.F=n,this.P=i,this.L=o,this.h=this.m=!1,this.M="",this.o=null,this.A=this.yd.bind(this),this.C=this.ag.bind(this),this.g={video:{},player:{}},this.J=0,this.i={},this.l=null,vn.add(this)}var cn=!1,ln=null;function dn(e){for(var t=h(vn),r=t.next();!r.done;r=t.next())fn(r.value,e)}function fn(e,t){X.debug("CastSender: onExistingSessionJoined");var r=e.L();e.l=new ye,e.u=!0,e.Ad(r,t)}function hn(e){for(var t=h(vn),r=t.next();!r.done;r=t.next()){r=r.value;var n=e;X.debug("CastSender: receiver status",n),cn="available"==n,r.j.Lc()}}function pn(e){var t=ln;t.removeUpdateListener(e.A),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function gn(e){for(var t in e.i){var r=e.i[t];delete e.i[t],r.reject(new Z(1,7,7e3))}}function yn(t,r){var n=an(r),i=ln;try{i.sendMessage("urn:x-cast:com.google.shaka.v2",n,(function(){}),X.error)}catch(e){throw X.error("Cast session sendMessage threw",e),n=new Z(2,8,8005,e),t.F("player",new Be("error",{detail:n})),t.Bb(),n}}(i=un.prototype).destroy=function(){return vn.delete(this),gn(this),ln&&pn(this),this.j&&(this.j.stop(),this.j=null),this.P=this.F=null,this.h=this.m=!1,this.C=this.A=this.l=this.i=this.g=this.o=null,Promise.resolve()},i.la=function(){return this.h},i.Dd=function(){return this.M},i.init=function(){if(this.X.length)if(t.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.Lc();var e=new chrome.cast.SessionRequest(this.X);e=new chrome.cast.ApiConfig(e,dn.bind(this),hn.bind(this),"origin_scoped"),chrome.cast.initialize(e,(function(){X.debug("CastSender: init")}),(function(e){X.error("CastSender: init error",e)})),cn&&this.j.V(.02),(e=ln)&&e.status!=chrome.cast.SessionStatus.STOPPED?(X.debug("CastSender: re-using existing connection"),fn(this,e)):ln=null}else t.__onGCastApiAvailable||(t.__onGCastApiAvailable=mn),t.__onGCastApiAvailable!=mn&&X.ba("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")},i.Md=function(e){this.o=e,this.h&&yn(this,{type:"appData",appData:this.o})},i.cast=function(e){return this.m?cn?this.h?Promise.reject(new Z(1,8,8002)):(this.l=new ye,chrome.cast.requestSession(this.Ad.bind(this,e),this.ve.bind(this)),this.l):Promise.reject(new Z(1,8,8001)):Promise.reject(new Z(1,8,8e3))},i.Bb=function(){if(this.h){if(gn(this),ln){pn(this);try{ln.stop((function(){}),(function(){}))}catch(u){}ln=null}this.yd()}},i.get=function(e,t){if("video"==e){if(qr.includes(t))return this.Ee.bind(this,e,t)}else if("player"==e){if(en[t]&&!this.get("player","isLive")())return function(){};if(nn.includes(t))return this.Ee.bind(this,e,t);if(on.includes(t))return this.rg.bind(this,e,t);if(Jr[t])return this.Be.bind(this,e,t)}return this.Be(e,t)},i.set=function(e,t,r){this.g[e][t]=r,yn(this,{type:"set",targetName:e,property:t,value:r})},i.Ad=function(e,t){X.debug("CastSender: onSessionInitiated"),ln=t,t.addUpdateListener(this.A),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.C),this.yd(),yn(this,{type:"init",initState:e,appData:this.o}),this.l.resolve()},i.ve=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.l.reject(new Z(2,8,t,e))},i.Be=function(e,t){return this.g[e][t]},i.Ee=function(e,t,r){for(var n=[],i=2;i<arguments.length;++i)n[i-2]=arguments[i];yn(this,{type:"call",targetName:e,methodName:t,args:n})},i.rg=function(e,t,r){for(var n=[],i=2;i<arguments.length;++i)n[i-2]=arguments[i];i=new ye;var o=this.J.toString();this.J++,this.i[o]=i;try{yn(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:o})}catch(a){i.reject(a)}return i},i.yd=function(){var e=!!ln&&"connected"==ln.status;if(X.debug("CastSender: connection status",e),this.h&&!e){for(var t in this.P(),this.g)this.g[t]={};gn(this)}this.M=(this.h=e)?ln.receiver.friendlyName:"",this.j.Lc()},i.ag=function(e,t){var r=sn(t);switch(X.O("CastSender: message",r),r.type){case"event":var n=r.event;this.F(r.targetName,new Be(n.type,n));break;case"update":for(var i in n=r.update)for(var o in r=this.g[i]||{},n[i])r[o]=n[i][o];this.u&&(this.Z(),this.u=!1);break;case"asyncComplete":if(i=r.id,r=r.error,o=this.i[i],delete this.i[i],o)if(r){for(n in i=new Z(r.severity,r.category,r.code),r)i[n]=r[n];o.reject(i)}else o.resolve()}};var vn=new Set;function mn(e){if(e)for(var t=(e=h(vn)).next();!t.done;t=e.next())t.value.init()}function _n(e,t,r){var n=this;je.call(this),this.i=e,this.h=t,this.o=this.l=this.j=this.u=this.m=null,this.C=r,this.A=new Map,this.g=new un(r,(function(){return En(n)}),(function(){return Sn(n)}),(function(e,t){return wn(n,e,t)}),(function(){return Tn(n)}),(function(){return An(n)})),function(e){for(var t in e.g.init(),e.o=new tt,Yr.forEach(function(e){this.o.H(this.i,e,this.L.bind(this))}.bind(e)),Qr.forEach(function(e){this.o.H(this.h,e,this.F.bind(this))}.bind(e)),e.m={},e.i)Object.defineProperty(e.m,t,{configurable:!1,enumerable:!0,get:e.J.bind(e,t),set:e.M.bind(e,t)});e.u={},bn(e,(function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return $n(e,t)}})})),function(e){var t=new Map;bn(e,(function(r,n){if(t.has(n)){var i=t.get(n);r.length<i.length?e.A.set(r,i):e.A.set(i,r)}else t.set(n,r)}))}(e),e.j=new je,e.j.jc=e.m,e.l=new je,e.l.jc=e.u}(this)}function bn(e,t){function r(e){return"constructor"!=e&&"function"==typeof n[e]&&!i.has(e)}var n=e.h,i=new Set;for(o in n)r(o)&&(i.add(o),t(o,n[o]));for(var o=Object.getPrototypeOf(n),a=Object.getPrototypeOf({});o&&o!=a;){for(var s=h(Object.getOwnPropertyNames(o)),u=s.next();!u.done;u=s.next())r(u=u.value)&&(i.add(u),t(u,n[u]));o=Object.getPrototypeOf(o)}}function An(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.tc(),startTime:null};return e.i.pause(),Zr.forEach(function(e){t.video[e]=this.i[e]}.bind(e)),e.i.ended||(t.startTime=e.i.currentTime),tn.forEach(function(e){var r=e[1];e=this.h[e[0]](),t.player[r]=e}.bind(e)),rn.forEach(function(e){var r=e[1];e=this.h[e[0]](),t.playerAfterLoad[r]=e}.bind(e)),t}function En(e){e.dispatchEvent(new Be("caststatuschanged"))}function Sn(e){e.j.dispatchEvent(new Be(e.m.paused?"pause":"play"))}function Tn(e){tn.forEach(function(e){var t=e[1];e=this.g.get("player",e[0])(),this.h[t](e)}.bind(e));var t=e.g.get("player","getAssetUri")(),r=e.g.get("video","ended"),n=Promise.resolve(),i=e.i.autoplay,o=null;r||(o=e.g.get("video","currentTime")),t&&(e.i.autoplay=!1,n=e.h.load(t,o));var a={};Zr.forEach(function(e){a[e]=this.g.get("video",e)}.bind(e)),n.then((function(){e.i&&(Zr.forEach(function(e){this.i[e]=a[e]}.bind(e)),rn.forEach(function(e){var t=e[1];e=this.g.get("player",e[0])(),this.h[t](e)}.bind(e)),e.i.autoplay=i,t&&e.i.play())}),(function(t){e.h.dispatchEvent(new Be("error",{detail:t}))}))}function $n(e,t){if(e.A.has(t)&&(t=e.A.get(t)),"addEventListener"==t)return e.l.addEventListener.bind(e.l);if("removeEventListener"==t)return e.l.removeEventListener.bind(e.l);if("getMediaElement"==t)return function(){return this.m}.bind(e);if("getSharedConfiguration"==t)return X.v("Can't share configuration across a network. Returning copy."),e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return e.g.la()&&X.v("NOTE: getNetworkingEngine() is always local!"),e.h.Yb.bind(e.h);if(e.g.la()){if("getManifest"==t||"drmInfo"==t)return function(){return X.ba(t+"() does not work while casting!"),null};if("getManifestUri"==t)return Hr("getManifestUri",'Please use "getAssetUri" instead.'),$n(e,"getAssetUri");if("attach"==t||"detach"==t)return function(){return X.ba(t+"() does not work while casting!"),Promise.resolve()}}return e.g.la()&&0==Object.keys(e.g.g.video).length&&Jr[t]||!e.g.la()?e.h[t].bind(e.h):e.g.get("player",t)}function wn(e,t,r){e.g.la()&&("video"==t?e.j.dispatchEvent(r):"player"==t&&e.l.dispatchEvent(r))}function Cn(e,t,r,n){var i=this;je.call(this),this.g=e,this.h=t,this.i=new tt,this.L={video:e,player:t},this.C=r||function(){},this.M=n||function(e){return e},this.F=!1,this.m=!0,this.l=0,this.A=!1,this.u=!0,this.o=this.j=null,this.J=new ke((function(){kn(i)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.xe.bind(e),t.onSenderDisconnected=e.xe.bind(e),t.onSystemVolumeChanged=e.hf.bind(e),e.o=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.o.onMessage=e.Wf.bind(e),e.j=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.j.onMessage=e.fg.bind(e),t.start(),Yr.forEach(function(e){this.i.H(this.g,e,this.Ce.bind(this,"video"))}.bind(e)),Qr.forEach(function(e){this.i.H(this.h,e,this.Ce.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.Nd(3840,2160):e.h.Nd(1920,1080),e.i.H(e.g,"loadeddata",function(){this.A=!0}.bind(e)),e.i.H(e.h,"loading",function(){this.m=!1,In(this)}.bind(e)),e.i.H(e.g,"playing",function(){this.m=!1,In(this)}.bind(e)),e.i.H(e.g,"pause",function(){In(this)}.bind(e)),e.i.H(e.h,"unloading",function(){this.m=!0,In(this)}.bind(e)),e.i.H(e.g,"ended",function(){var e=this;new ke((function(){e.g&&e.g.ended&&(e.m=!0,In(e))})).V(5)}.bind(e))}(this)}function In(e){Promise.resolve().then(function(){this.h&&(this.dispatchEvent(new Be("caststatuschanged")),On(this)||xn(this))}.bind(e))}function kn(e){e.J.V(.5);var t={video:{},player:{}};if(Xr.forEach(function(e){t.video[e]=this.g[e]}.bind(e)),e.h.aa())for(var r in en)0==e.l%en[r]&&(t.player[r]=e.h[r]());for(var n in Jr)0==e.l%Jr[n]&&(t.player[n]=e.h[n]());(r=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=r.level,t.video.muted=r.muted),e.A&&(e.l+=1),Rn(e,{type:"update",update:t},e.j),On(e)}function On(e){return!(!e.u||!e.g.duration&&!e.h.aa())&&(Pn(e),e.u=!1,!0)}function Pn(e,t){t=void 0===t?0:t;var r={contentId:e.h.tc(),streamType:e.h.aa()?"LIVE":"BUFFERED",contentType:""};e.h.aa()||(r.duration=e.g.duration),xn(e,t,r)}function Rn(e,t,r,n){e.F&&(e=an(t),n?r.getCastChannel(n).send(e):r.broadcast(e))}function xn(e,t,r){t=void 0===t?0:t,r=void 0===r?null:r;var n=e.g.playbackRate,i=Dn;n={mediaSessionId:0,playbackRate:n,playerState:i=e.m?i.IDLE:e.h.jd()?i.Re:e.g.paused?i.Te:i.Ue,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}},r&&(n.media=r),Rn(e,{requestId:t,type:"MEDIA_STATUS",status:[n]},e.o)}H(_n,je),G("shaka.cast.CastProxy",_n),_n.prototype.destroy=function(e){return e&&this.g.Bb(),this.o&&(this.o.release(),this.o=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.m=this.i=null,Promise.all(e)},_n.prototype.destroy=_n.prototype.destroy,_n.prototype.Mf=function(){return this.m},_n.prototype.getVideo=_n.prototype.Mf,_n.prototype.Df=function(){return this.u},_n.prototype.getPlayer=_n.prototype.Df,_n.prototype.Ye=function(){return this.g.m&&cn},_n.prototype.canCast=_n.prototype.Ye,_n.prototype.la=function(){return this.g.la()},_n.prototype.isCasting=_n.prototype.la,_n.prototype.Dd=function(){return this.g.Dd()},_n.prototype.receiverName=_n.prototype.Dd,_n.prototype.cast=function(){var e=An(this);return this.g.cast(e).then(function(){if(this.h)return this.h.Ud()}.bind(this))},_n.prototype.cast=_n.prototype.cast,_n.prototype.Md=function(e){this.g.Md(e)},_n.prototype.setAppData=_n.prototype.Md,_n.prototype.Kg=function(){var e=this.g;if(e.h){var t=e.L();chrome.cast.requestSession(e.Ad.bind(e,t),e.ve.bind(e))}},_n.prototype.suggestDisconnect=_n.prototype.Kg,_n.prototype.af=function(e){var t=this;return g((function r(){return M(r,(function(r){switch(r.s){case 1:return e==t.C?r.return():(t.C=e,t.g.Bb(),$(r,t.g.destroy(),2));case 2:t.g=null,t.g=new un(e,(function(){return En(t)}),(function(){return Sn(t)}),(function(e,r){return wn(t,e,r)}),(function(){return Tn(t)}),(function(){return An(t)})),t.g.init(),w(r)}}))}))},_n.prototype.changeReceiverId=_n.prototype.af,_n.prototype.Bb=function(){this.g.Bb()},_n.prototype.forceDisconnect=_n.prototype.Bb,_n.prototype.J=function(e){if("addEventListener"==e)return this.j.addEventListener.bind(this.j);if("removeEventListener"==e)return this.j.removeEventListener.bind(this.j);if(this.g.la()&&0==Object.keys(this.g.g.video).length){var t=this.i[e];if("function"!=typeof t)return t}return this.g.la()?this.g.get("video",e):("function"==typeof(e=this.i[e])&&(e=e.bind(this.i)),e)},_n.prototype.M=function(e,t){this.g.la()?this.g.set("video",e,t):this.i[e]=t},_n.prototype.L=function(e){this.g.la()||this.j.dispatchEvent(new Be(e.type,e))},_n.prototype.F=function(e){this.g.la()||this.l.dispatchEvent(e)},H(Cn,je),G("shaka.cast.CastReceiver",Cn),Cn.prototype.isConnected=function(){return this.F},Cn.prototype.isConnected=Cn.prototype.isConnected,Cn.prototype.Rf=function(){return this.m},Cn.prototype.isIdle=Cn.prototype.Rf,Cn.prototype.destroy=function(){var e=this;return g((function t(){var r;return M(t,(function(t){switch(t.s){case 1:return e.i&&(e.i.release(),e.i=null),r=[],e.h&&(r.push(e.h.destroy()),e.h=null),e.J&&(e.J.stop(),e.J=null),e.g=null,e.L=null,e.C=null,e.F=!1,e.m=!0,e.j=null,e.o=null,$(t,Promise.all(r),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),w(t)}}))}))},Cn.prototype.destroy=Cn.prototype.destroy,(i=Cn.prototype).xe=function(){this.l=0,this.u=!0,this.F=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,In(this)},i.Ce=function(e,t){this.h&&(kn(this),Rn(this,{type:"event",targetName:e,event:t},this.j))},i.hf=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Rn(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.j),Rn(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.j)},i.fg=function(e){var t=sn(e.data);switch(X.debug("CastReceiver: message",t),t.type){case"init":this.l=0,this.A=!1,this.u=!0,function(e,t,r){for(var n in t.player)e.h[n](t.player[n]);e.C(r),r=Promise.resolve();var i=e.g.autoplay;t.manifest&&(e.g.autoplay=!1,r=e.h.load(t.manifest,t.startTime)),r.then((function(){if(e.h){for(var r in t.video)e.g[r]=t.video[r];for(var n in t.playerAfterLoad)e.h[n](t.playerAfterLoad[n]);e.g.autoplay=i,t.manifest&&(e.g.play(),xn(e))}}),(function(t){e.h.dispatchEvent(new Be("error",{detail:t}))}))}(this,t.initState,t.appData),kn(this);break;case"appData":this.C(t.appData);break;case"set":var r=t.targetName,n=t.property;if(t=t.value,"video"==r){var i=cast.receiver.CastReceiverManager.getInstance();if("volume"==n){i.setSystemVolumeLevel(t);break}if("muted"==n){i.setSystemVolumeMuted(t);break}}this.L[r][n]=t;break;case"call":(r=this.L[t.targetName])[t.methodName].apply(r,t.args);break;case"asyncCall":r=t.targetName,n=t.methodName,"player"==r&&"load"==n&&(this.l=0,this.A=!1),i=t.id,e=e.senderId;var o=this.L[r];t=o[n].apply(o,t.args),"player"==r&&"load"==n&&(t=t.then(function(){this.u=!0}.bind(this))),t.then(this.Je.bind(this,e,i,null),this.Je.bind(this,e,i))}},i.Wf=function(e){var t=sn(e.data);switch(X.debug("CastReceiver: message",t),t.type){case"PLAY":this.g.play(),xn(this);break;case"PAUSE":this.g.pause(),xn(this);break;case"SEEK":e=t.currentTime;var r=t.resumeState;null!=e&&(this.g.currentTime=Number(e)),r&&"PLAYBACK_START"==r?(this.g.play(),xn(this)):r&&"PLAYBACK_PAUSE"==r&&(this.g.pause(),xn(this));break;case"STOP":this.h.Ud().then(function(){this.h&&xn(this)}.bind(this));break;case"GET_STATUS":Pn(this,Number(t.requestId));break;case"VOLUME":e=(r=t.volume).level,r=r.muted;var n=this.g.volume,i=this.g.muted;null!=e&&(this.g.volume=Number(e)),null!=r&&(this.g.muted=r),n==this.g.volume&&i==this.g.muted||xn(this);break;case"LOAD":this.l=0,this.u=this.A=!1,e=t.media,r=t.currentTime,n=this.M(e.contentId),i=t.autoplay||!0,this.C(e.customData),i&&(this.g.autoplay=!0),this.h.load(n,r).then(function(){this.h&&Pn(this)}.bind(this)).catch(function(e){var r="LOAD_FAILED";7==e.category&&7e3==e.code&&(r="LOAD_CANCELLED"),Rn(this,{requestId:Number(t.requestId),type:r},this.o)}.bind(this));break;default:X.v("Unrecognized message type from the generic Chromecast controller!",t.type),Rn(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.o)}},i.Je=function(e,t,r){this.h&&Rn(this,{type:"asyncComplete",id:t,error:r},this.j,e)};var Dn={IDLE:"IDLE",Ue:"PLAYING",Re:"BUFFERING",Te:"PAUSED"};function Ln(e,t){this.S=e,this.h=t==Nn,this.g=0}G("shaka.util.DataViewReader",Ln);var Nn=1;function Mn(){throw new Z(2,3,3e3)}function Bn(){this.i=[],this.h=[],this.g=!1}function Un(e){for(var t=Hn(e);e.reader.Ca()&&!e.parser.g;)e.parser.Fc(e.start+t,e.reader,e.partialOkay)}function jn(e){for(var t=Hn(e),r=e.reader.N();0<r&&!e.parser.g;--r)e.parser.Fc(e.start+t,e.reader,e.partialOkay)}function Fn(e){return function(t){e(t.reader.mb(t.reader.S.byteLength-t.reader.ka()))}}function Vn(e){for(var t=0,r=0;r<e.length;r++)t=t<<8|e.charCodeAt(r);return t}function Gn(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Hn(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}function Kn(e){var t=this;this.g=[],this.h=[],this.data=[],(new Bn).box("moov",Un).ma("pssh",(function(e){if(1<e.version)X.v("Unrecognized PSSH version found!");else{var r=e.reader.S;if(r=new Uint8Array(r.buffer,r.byteOffset-12,e.size),t.data.push(r),t.g.push(Te.Nc(e.reader.mb(16))),0<e.version){r=e.reader.N();for(var n=0;n<r;++n){var i=Te.Nc(e.reader.mb(16));t.h.push(i)}}}})).parse(e),0==this.data.length&&X.v("No pssh box found!")}Ln.Endianness={Tg:0,Vg:Nn},Ln.prototype.Ca=function(){return this.g<this.S.byteLength},Ln.prototype.hasMoreData=Ln.prototype.Ca,Ln.prototype.ka=function(){return this.g},Ln.prototype.getPosition=Ln.prototype.ka,Ln.prototype.sf=function(){return this.S.byteLength},Ln.prototype.getLength=Ln.prototype.sf,Ln.prototype.ra=function(){try{var e=this.S.getUint8(this.g);return this.g+=1,e}catch(t){Mn()}},Ln.prototype.readUint8=Ln.prototype.ra,Ln.prototype.dc=function(){try{var e=this.S.getUint16(this.g,this.h);return this.g+=2,e}catch(t){Mn()}},Ln.prototype.readUint16=Ln.prototype.dc,Ln.prototype.N=function(){try{var e=this.S.getUint32(this.g,this.h);return this.g+=4,e}catch(t){Mn()}},Ln.prototype.readUint32=Ln.prototype.N,Ln.prototype.De=function(){try{var e=this.S.getInt32(this.g,this.h);return this.g+=4,e}catch(t){Mn()}},Ln.prototype.readInt32=Ln.prototype.De,Ln.prototype.Pb=function(){try{if(this.h)var e=this.S.getUint32(this.g,!0),t=this.S.getUint32(this.g+4,!0);else t=this.S.getUint32(this.g,!1),e=this.S.getUint32(this.g+4,!1)}catch(r){Mn()}if(2097151<t)throw new Z(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},Ln.prototype.readUint64=Ln.prototype.Pb,Ln.prototype.mb=function(e){this.g+e>this.S.byteLength&&Mn();var t=new Uint8Array(this.S.buffer,this.S.byteOffset+this.g,e);return this.g+=e,t},Ln.prototype.readBytes=Ln.prototype.mb,Ln.prototype.U=function(e){this.g+e>this.S.byteLength&&Mn(),this.g+=e},Ln.prototype.skip=Ln.prototype.U,Ln.prototype.Fe=function(e){this.g<e&&Mn(),this.g-=e},Ln.prototype.rewind=Ln.prototype.Fe,Ln.prototype.seek=function(e){(0>e||e>this.S.byteLength)&&Mn(),this.g=e},Ln.prototype.seek=Ln.prototype.seek,Ln.prototype.Cd=function(){for(var e=this.g;this.Ca()&&0!=this.S.getUint8(this.g);)this.g+=1;return e=new Uint8Array(this.S.buffer,this.S.byteOffset+e,this.g-e),this.g+=1,ve(e)},Ln.prototype.readTerminatedString=Ln.prototype.Cd,G("shaka.util.Mp4Parser",Bn),Bn.prototype.box=function(e,t){var r=Vn(e);return this.i[r]=0,this.h[r]=t,this},Bn.prototype.box=Bn.prototype.box,Bn.prototype.ma=function(e,t){var r=Vn(e);return this.i[r]=1,this.h[r]=t,this},Bn.prototype.fullBox=Bn.prototype.ma,Bn.prototype.stop=function(){this.g=!0},Bn.prototype.stop=Bn.prototype.stop,Bn.prototype.parse=function(e,t){var r=new Uint8Array(e);for(r=new Ln(new DataView(r.buffer,r.byteOffset,r.byteLength),0),this.g=!1;r.Ca()&&!this.g;)this.Fc(0,r,t)},Bn.prototype.parse=Bn.prototype.parse,Bn.prototype.Fc=function(e,t,r){var n=t.ka(),i=t.N(),o=t.N(),a=!1;switch(X.O("Parsing MP4 box",Gn(o)),i){case 0:i=t.S.byteLength-n;break;case 1:i=t.Pb(),a=!0}var s=this.h[o];if(s){var u=null,c=null;1==this.i[o]&&(u=(c=t.N())>>>24,c&=16777215),o=n+i,r&&o>t.S.byteLength&&(o=t.S.byteLength),o-=t.ka(),t=0<o?t.mb(o):new Uint8Array(0),s({parser:this,partialOkay:r||!1,version:u,flags:c,reader:t=new Ln(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:i,start:n+e,has64BitSize:a})}else t.U(Math.min(n+i-t.ka(),t.S.byteLength-t.ka()))},Bn.prototype.parseNext=Bn.prototype.Fc,Bn.children=Un,Bn.sampleDescription=jn,Bn.allData=Fn,Bn.typeToString=Gn,Bn.headerSize=Hn;var zn={sc:function(e,t){var r=zn.Y(e,t);return 1!=r.length?null:r[0]},Yc:function(e,t,r){return 1!=(e=zn.fe(e,t,r)).length?null:e[0]},Y:function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName==t}))},fe:function(e,t,r){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName==r&&e.namespaceURI==t}))},getAttributeNS:function(e,t,r){return e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null},uc:function(e){return Array.prototype.every.call(e.childNodes,(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},R:function(e,t,r,n){n=void 0===n?null:n;var i=null;return null!=(e=e.getAttribute(t))&&(i=r(e)),null==i?n:i},jg:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ma:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(X.v("Invalid duration string:",e),null)},Hc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Gc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},Mb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},ff:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},Ae:function(e,t){var r=new DOMParser;try{var n=r.parseFromString(e,"text/xml")}catch(o){}if(n&&n.documentElement.tagName==t)var i=n.documentElement;return i&&0<i.getElementsByTagName("parsererror").length?null:i},ze:function(e,t){try{var r=ve(e);return zn.Ae(r,t)}catch(n){}}},Wn=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Yn(e,t,r){var n=function(e){for(var t=[],r=(e=h(e)).next();!r.done;r=e.next())(r=qn(r.value))&&t.push(r);return t}(e),i=null;e=[];var o=[],a=new Set(n.map((function(e){return e.keyId})));if(a.delete(null),1<a.size)throw new Z(2,4,4010);if(r||(o=n.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Ge||(i=e.init||i,!1)}))).length&&(e=function(e,t,r){for(var n=[],i=(r=h(r)).next();!i.done;i=r.next()){i=i.value;var o=Wn.get(i.Ge);if(o){var a;if(a=zn.Yc(i.node,"urn:microsoft:playready","pro")){a=Te.Ja(a.textContent);var s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=a.length,c=s.length+16+u,l=new ArrayBuffer(c),d=new Uint8Array(l),f=0;(l=new DataView(l)).setUint32(f,c),f+=4,l.setUint32(f,1886614376),f+=4,l.setUint32(f,0),f+=4,d.set(s,f),f+=s.length,l.setUint32(f,u),f+=4,d.set(a,f),a=[{initData:d,initDataType:"cenc",keyId:i.keyId}]}else a=null;a=he(o,i.init||e||a),(o=Zn.get(o))&&(a.licenseServerUri=o(i)),n.push(a)}else for(o=(i=h(i=t(i.node)||[])).next();!o.done;o=i.next())n.push(o.value)}return n}(i,t,o),0==e.length&&(e=[he("",i)])),n.length&&(r||!o.length))for(e=[],r=(t=h(Wn.values())).next();!r.done;r=t.next())"org.w3.clearkey"!=(r=r.value)&&e.push(he(r,i));if(a=Array.from(a)[0]||null)for(r=(t=h(e)).next();!r.done;r=t.next())for(n=(r=h(r.value.initData)).next();!n.done;n=r.next())n.value.keyId=a;return{be:a,Xg:i,drmInfos:e,ge:!0}}var Xn,Zn=(new Map).set("com.widevine.alpha",(function(e){return(e=zn.Yc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",(function(e){return(e=zn.Yc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,r=new DataView(e).getUint32(t,!0);if(t+=4,r!==e.byteLength)return X.v("PlayReady Object with invalid length encountered."),[];t+=2,r=[];for(var n=new DataView(e);t<e.byteLength-1;){var i=n.getUint16(t,!0);t+=2;var o=n.getUint16(t,!0);t+=2;var a=new Uint8Array(e,t,o);r.push({type:i,value:a}),t+=o}return r}((e=Te.Ja(e.textContent)).buffer).filter((function(e){return 1===e.type}))[0])?(e=me(e.value,!0),(e=zn.Ae(e,"WRMHEADER"))?function(e){for(var t=(e=h(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var r=(t=h(t.value.childNodes)).next();!r.done;r=t.next())if((r=r.value)instanceof Element&&"LA_URL"==r.tagName)return r.textContent;return""}(e):""):""}));function qn(e){var t=e.getAttribute("schemeIdUri"),r=zn.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),n=zn.fe(e,"urn:mpeg:cenc:2013","pssh").map(zn.uc);if(!t)return X.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase()).includes(" "))throw new Z(2,4,4009);var i=[];try{i=n.map((function(e){return{initDataType:"cenc",initData:Te.Ja(e),keyId:null}}))}catch(o){throw new Z(2,4,4007)}return{node:e,Ge:t,keyId:r,init:0<i.length?i:null}}function Qn(e,r,n,i,o){var a={RepresentationID:r,Number:n,Bandwidth:i,Time:o};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(r,n,i,o){if("$$"==r)return"$";var s=a[n];if(null==s)return X.v("URL template does not have an available substitution for identifier",'"'+n+'":',e),r;switch("RepresentationID"==n&&i&&(X.v("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),i=void 0),"Time"==n&&(s=Math.round(s)),o){case void 0:case"d":case"i":case"u":r=s.toString();break;case"o":r=s.toString(8);break;case"x":r=s.toString(16);break;case"X":r=s.toString(16).toUpperCase();break;default:r=s.toString()}return i=t.parseInt(i,10)||1,Array(Math.max(0,i-r.length)+1).join("0")+r}))}function Jn(e,t){var r=ei(e,t,"timescale"),n=1;r&&(n=zn.Gc(r)||1),r=ei(e,t,"duration"),(r=zn.Gc(r||""))&&(r/=n);var i=ei(e,t,"startNumber"),o=Number(ei(e,t,"presentationTimeOffset"))||0,a=zn.Mb(i||"");null!=i&&null!=a||(a=1);var s=ti(e,t,"SegmentTimeline");if(i=null,s){i=n;var u=e.$.duration||1/0;s=zn.Y(s,"S");for(var c=[],l=-o,d=0;d<s.length;++d){var f=s[d],h=zn.R(f,"t",zn.Mb),p=zn.R(f,"d",zn.Mb),g=zn.R(f,"r",zn.parseInt);if(null!=h&&(h-=o),!p){X.v('"S" element must have a duration:','ignoring the remaining "S" elements.',f);break}if(h=null!=h?h:l,0>(g=g||0))if(d+1<s.length){if(null==(g=zn.R(s[d+1],"t",zn.Mb))){X.v('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',f);break}if(h>=g){X.v('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',f);break}g=Math.ceil((g-h)/p)-1}else{if(1/0==u){X.v('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',f);break}if(h/i>=u){X.v('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',f);break}g=Math.ceil((u*i-h)/p)-1}for(0<c.length&&h!=l&&(Math.abs((h-l)/i)>=ge&&X.v("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",f),c[c.length-1].end=h/i),f=0;f<=g;++f)l=h+p,c.push({start:h/i,end:l/i,Pg:h}),h=l}i=c}return{timescale:n,ia:r,ob:a,sa:o/n||0,Vd:o,W:i}}function ei(e,t,r){return[t(e.G),t(e.fa),t(e.qa)].filter(de.Ra).map((function(e){return e.getAttribute(r)})).reduce((function(e,t){return e||t}))}function ti(e,t,r){return[t(e.G),t(e.fa),t(e.qa)].filter(de.Ra).map((function(e){return zn.sc(e,r)})).reduce((function(e,t){return e||t}))}function ri(e,t,r,n,i,o){if(o=void 0===o?0:o,zn.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var a=function(e,t,r,n,i,o){for(var a=zn.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),s=zn.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<e.attributes.length;u++){var c=e.attributes[u];"http://www.w3.org/1999/xlink"==c.namespaceURI&&(e.removeAttributeNS(c.namespaceURI,c.localName),--u)}if(5<=o)return xe(new Z(2,4,4028));if("onLoad"!=s)return xe(new Z(2,4,4027));var l=fe([n],[a]);return i.request(0,Ze(l,t)).ca((function(n){if(!(n=zn.ze(n.data,e.tagName)))return xe(new Z(2,4,4001,a));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;n.childNodes.length;){var s=n.childNodes[0];n.removeChild(s),e.appendChild(s)}for(s=0;s<n.attributes.length;s++){var u=n.attributes[s].nodeName,c=n.getAttribute(u);e.setAttribute(u,c)}return ri(e,t,r,l[0],i,o+1)}))}(e,t,r,n,i,o);return r&&(a=a.ca(void 0,(function(){return ri(e,t,r,n,i,o)}))),a}a=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==zn.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&a.push(ri(u,t,r,n,i,o)))}return Me(a).ca((function(){return e}))}function ni(e,t,r){this.i=e,this.h=t,this.g=r}function ii(e,t,r,n,i,o){this.position=e,this.startTime=t,this.endTime=r,this.i=n,this.h=i,this.g=o}function oi(e,t,r,n){var i,o=(new Bn).ma("sidx",(function(e){i=function(e,t,r,n){var i=[];n.reader.U(4);var o=n.reader.N();if(0==o)throw X.error("Invalid timescale."),new Z(2,3,3005);if(0==n.version)var a=n.reader.N(),s=n.reader.N();else a=n.reader.Pb(),s=n.reader.Pb();n.reader.U(2);var u=n.reader.dc();for(e=e+n.size+s,s=0;s<u;s++){var c=n.reader.N(),l=(2147483648&c)>>>31;c&=2147483647;var d=n.reader.N();if(n.reader.U(4),1==l)throw X.error("Heirarchical SIDXs are not supported."),new Z(2,3,3006);i.push(new ii(i.length,a/o-t,(a+d)/o-t,(function(){return r}),e,e+c-1)),a+=d,e+=c}return n.parser.stop(),i}(t,n,r,e)}));if(e&&o.parse(e),i)return i;throw X.error('Invalid box type, expected "sidx".'),new Z(2,3,3004)}function ai(e){this.g=e}function si(e,t){for(;e.g.length&&e.g[e.g.length-1].startTime>=t;)e.g.pop();for(;e.g.length&&0>=e.g[0].endTime;)e.g.shift();if(0!=e.g.length){var r=e.g[e.g.length-1];e.g[e.g.length-1]=new ii(r.position,r.startTime,t,r.i,r.h,r.g)}}function ui(e){this.h=e,this.g=new Ln(e,0),Xn||(Xn=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function ci(e){var t=li(e);if(7<t.length)throw new Z(2,3,3002);for(var r=0,n=0;n<t.length;n++)r=256*r+t[n];t=r,r=li(e);e:{n=Te.Ha;for(var i=0;i<Xn.length;i++)if(n(r,Xn[i])){n=!0;break e}n=!1}if(n)r=e.h.byteLength-e.g.ka();else{if(8==r.length&&224&r[1])throw new Z(2,3,3001);for(n=r[0]&(1<<8-r.length)-1,i=1;i<r.length;i++)n=256*n+r[i];r=n}return r=e.g.ka()+r<=e.h.byteLength?r:e.h.byteLength-e.g.ka(),n=new DataView(e.h.buffer,e.h.byteOffset+e.g.ka(),r),e.g.U(r),new di(t,n)}function li(e){var t,r=e.g.ra();for(t=1;8>=t&&!(r&1<<8-t);t++);if(8<t)throw new Z(2,3,3002);var n=new Uint8Array(t);for(n[0]=r,r=1;r<t;r++)n[r]=e.g.ra();return n}function di(e,t){this.id=e,this.g=t}function fi(e){if(8<e.g.byteLength)throw new Z(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Z(2,3,3001);for(var t=0,r=0;r<e.g.byteLength;r++){t=256*t+e.g.getUint8(r)}return t}function hi(){}function pi(e){var t=new ui(e.g);if(179!=(e=ci(t)).id)throw X.v("Not a CueTime element."),new Z(2,3,3013);if(e=fi(e),183!=(t=ci(t)).id)throw X.v("Not a CueTrackPositions element."),new Z(2,3,3012);t=new ui(t.g);for(var r=0;t.Ca();){var n=ci(t);if(241==n.id){r=fi(n);break}}return{Qg:e,qg:r}}function gi(e,t){var r=ti(e,t,"Initialization");if(!r)return null;var n=e.G.xa,i=r.getAttribute("sourceURL");i&&(n=fe(e.G.xa,[i])),i=0;var o=null;return(r=zn.R(r,"range",zn.Hc))&&(i=r.start,o=r.end),new ni((function(){return n}),i,o)}function yi(e,t,r,n,i,o,a,s){var u=e.presentationTimeline,c=!e.zb||!e.$.ld,l=e.$.start,d=e.$.duration,f=t,h=null;return{createSegmentIndex:function(){var e=[f(n,i,o),"webm"==a?f(r.i(),r.h,r.g):null];return f=null,Promise.all(e).then((function(e){var t=e[0];e=e[1]||null,t="mp4"==a?oi(t,i,n,s):(new hi).parse(t,e,n,s),u.Jb(t,l),h=new ai(t),c&&si(h,d)}))},findSegmentPosition:function(e){return h.find(e)},getSegmentReference:function(e){return h.get(e)}}}function vi(e){return e.ec}function mi(e,t){var r=gi(e,_i),n=function(e){return[e.G.Ua,e.fa.Ua,e.qa.Ua].filter(de.Ra).map((function(e){return zn.Y(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.me&&(e.me=!0,X.v("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Tf:t.getAttribute("media"),start:(t=zn.R(t,"mediaRange",zn.Hc,{start:0,end:null})).start,end:t.end}}))}(e),i=Jn(e,_i),o=i.ob;0==o&&(X.v("SegmentList@startNumber must be > 0"),o=1);var a=0;if(i.ia?a=i.ia*(o-1):i.W&&0<i.W.length&&(a=i.W[0].start),!(n={ia:i.ia,startTime:a,ob:o,sa:i.sa,W:i.W,jb:n}).ia&&!n.W&&1<n.jb.length)throw X.v("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.G),new Z(2,4,4002);if(!n.ia&&!e.$.duration&&!n.W&&1==n.jb.length)throw X.v("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.G),new Z(2,4,4002);if(n.W&&0==n.W.length)throw X.v("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.G),new Z(2,4,4002);return o=i=null,e.qa.id&&e.G.id&&(i=t[o=e.qa.id+","+e.G.id]),a=function(e,t,r,n){var i=n.jb.length;n.W&&n.W.length!=n.jb.length&&(i=Math.min(n.W.length,n.jb.length),X.v("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",n.jb.length,"to",i));for(var o=[],a=n.startTime,s=0;s<i;s++){var u=n.jb[s],c=fe(r,[u.Tf]),l=void 0;l=null!=n.ia?a+n.ia:n.W?n.W[s].end:a+e,o.push(new ii(s+t,a,l,function(e){return e}.bind(null,c),u.start,u.end)),a=l}return o}(e.$.duration,n.ob,e.G.xa,n),i?(i.sd(a),o=e.presentationTimeline.$b(),i.Vc(o-e.$.start)):(e.presentationTimeline.Jb(a,e.$.start),i=new ai(a),o&&e.zb&&(t[o]=i)),e.zb&&e.$.ld||si(i,e.$.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:i.find.bind(i),getSegmentReference:i.get.bind(i),initSegmentReference:r,sa:n.sa}}function _i(e){return e.Ua}function bi(e,t,r,n){var i=function(e){var t=ei(e,Ai,"initialization");if(!t)return null;var r=e.G.id,n=e.bandwidth||null,i=e.G.xa;return new ni((function(){var e=Qn(t,r,null,n,null);return fe(i,[e])}),0,null)}(e),o=Jn(e,Ai),a=ei(e,Ai,"media"),s=ei(e,Ai,"index");if(a=(o={ia:o.ia,timescale:o.timescale,ob:o.ob,sa:o.sa,Vd:o.Vd,W:o.W,qd:a,bc:s}).bc?1:0,a+=o.W?1:0,0==(a+=o.ia?1:0))throw X.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.G),new Z(2,4,4002);if(1!=a&&(X.v("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.G),o.bc?(X.info("Using the index URL template by default."),o.W=null):X.info("Using the SegmentTimeline by default."),o.ia=null),!o.bc&&!o.qd)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.G),new Z(2,4,4002);if(o.bc){if("mp4"!=(r=e.G.mimeType.split("/")[1])&&"webm"!=r)throw X.error("SegmentTemplate specifies an unsupported container type.",e.G),new Z(2,4,4006);if("webm"==r&&!i)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.G),new Z(2,4,4005);n=Qn(o.bc,e.G.id,null,e.bandwidth||null,null),e=yi(e,t,i,n=fe(e.G.xa,[n]),0,null,r,o.sa)}else o.ia?(n||(e.presentationTimeline.ud(o.ia),e.presentationTimeline.vd(e.$.start)),e=function(e,t){var r=e.$.duration,n=t.ia,i=t.ob,o=t.timescale,a=t.qd,s=e.bandwidth||null,u=e.G.id,c=e.G.xa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||r&&e>=r?null:Math.floor(e/n)},getSegmentReference:function(e){var t=e*n,l=t+n;return r&&(l=Math.min(l,r)),0>l||r&&t>=r?null:new ii(e,t,l,(function(){var r=Qn(a,u,e+i,s,t*o);return fe(c,[r])}),0,null)}}}(e,o)):(a=t=null,e.qa.id&&e.G.id&&(t=r[a=e.qa.id+","+e.G.id]),s=function(e,t){for(var r=[],n=0;n<t.W.length;n++){var i=n+t.ob;r.push(new ii(i,t.W[n].start,t.W[n].end,function(e,t,r,n,i,o){return fe(n,[e=Qn(e,t,i,r,o)]).map((function(e){return e.toString()}))}.bind(null,t.qd,e.G.id,e.bandwidth||null,e.G.xa,i,t.W[n].Pg+t.Vd),0,null))}return r}(e,o),n=!e.zb||!e.$.ld,t?(n&&si(new ai(s),e.$.duration),t.sd(s),r=e.presentationTimeline.$b(),t.Vc(r-e.$.start)):(e.presentationTimeline.Jb(s,e.$.start),t=new ai(s),a&&e.zb&&(r[a]=t)),n&&si(t,e.$.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:i,sa:o.sa}}function Ai(e){return e.gc}G("shaka.media.InitSegmentReference",ni),ni.prototype.Tc=function(){return this.i()},ni.prototype.createUris=ni.prototype.Tc,ni.prototype.dd=function(){return this.h},ni.prototype.getStartByte=ni.prototype.dd,ni.prototype.cd=function(){return this.g},ni.prototype.getEndByte=ni.prototype.cd,G("shaka.media.SegmentReference",ii),ii.prototype.ka=function(){return this.position},ii.prototype.getPosition=ii.prototype.ka,ii.prototype.xc=function(){return this.startTime},ii.prototype.getStartTime=ii.prototype.xc,ii.prototype.qf=function(){return this.endTime},ii.prototype.getEndTime=ii.prototype.qf,ii.prototype.Tc=function(){return this.i()},ii.prototype.createUris=ii.prototype.Tc,ii.prototype.dd=function(){return this.h},ii.prototype.getStartByte=ii.prototype.dd,ii.prototype.cd=function(){return this.g},ii.prototype.getEndByte=ii.prototype.cd,G("shaka.media.SegmentIndex",ai),ai.prototype.destroy=function(){return this.g=null,Promise.resolve()},ai.prototype.destroy=ai.prototype.destroy,ai.prototype.find=function(e){for(var t=this.g.length-1,r=t;0<=r;--r){var n=this.g[r],i=r<t?this.g[r+1].startTime:n.endTime;if(e>=n.startTime&&e<i)return n.position}return this.g.length&&e<this.g[0].startTime?this.g[0].position:null},ai.prototype.find=ai.prototype.find,ai.prototype.get=function(e){return 0==this.g.length||0>(e-=this.g[0].position)||e>=this.g.length?null:this.g[e]},ai.prototype.get=ai.prototype.get,ai.prototype.offset=function(e){for(var t=0;t<this.g.length;++t)this.g[t].startTime+=e,this.g[t].endTime+=e},ai.prototype.offset=ai.prototype.offset,ai.prototype.sd=function(e){for(var t=[],r=0,n=0;r<this.g.length&&n<e.length;){var i=this.g[r],o=e[n];i.startTime<o.startTime?(t.push(i),r++):(i.startTime>o.startTime?0==r?t.push(o):X.v("Refusing to rewrite original references on update!"):(.1<Math.abs(i.endTime-o.endTime)?t.push(new ii(i.position,o.startTime,o.endTime,o.i,o.h,o.g)):t.push(i),r++),n++)}for(;r<this.g.length;)t.push(this.g[r++]);if(t.length)for(r=t[t.length-1].position+1;n<e.length;)i=new ii(r++,(i=e[n++]).startTime,i.endTime,i.i,i.h,i.g),t.push(i);else t=e;this.g=t},ai.prototype.merge=ai.prototype.sd,ai.prototype.Vc=function(e){for(var t=0;t<this.g.length;++t)if(this.g[t].endTime>e)return void this.g.splice(0,t);this.g=[]},ai.prototype.evict=ai.prototype.Vc,ui.prototype.Ca=function(){return this.g.Ca()},hi.prototype.parse=function(e,t,r,n){var i;if(440786851!=ci(t=new ui(new DataView(t))).id)throw X.error("Not an EBML element."),new Z(2,3,3008);var o=ci(t);if(408125543!=o.id)throw X.error("Not a Segment element."),new Z(2,3,3009);for(t=o.g.byteOffset,o=new ui(o.g),i=null;o.Ca();){var a=ci(o);if(357149030==a.id){i=a;break}}if(!i)throw X.error("Not an Info element."),new Z(2,3,3010);for(o=new ui(i.g),i=1e6,a=null;o.Ca();){var s=ci(o);if(2807729==s.id)i=fi(s);else if(17545==s.id)if(4==(a=s).g.byteLength)a=a.g.getFloat32(0);else{if(8!=a.g.byteLength)throw new Z(2,3,3003);a=a.g.getFloat64(0)}}if(null==a)throw new Z(2,3,3011);if(i=a*(o=i/1e9),475249515!=(e=ci(new ui(new DataView(e)))).id)throw X.error("Not a Cues element."),new Z(2,3,3007);return function(e,t,r,n,i,o){function a(){return i}var s=[];e=new ui(e.g);for(var u=null,c=null;e.Ca();){var l=ci(e);if(187==l.id){var d=pi(l);d&&(l=r*d.Qg,d=t+d.qg,null!=u&&s.push(new ii(s.length,u-o,l-o,a,c,d-1)),u=l,c=d)}}return null!=u&&s.push(new ii(s.length,u-o,n-o,a,c,null)),s}(e,t,o,i,r,n)};var Ei={Nb:{},cc:{},Fd:function(e,t){Ei.cc[e]=t}};function Si(e,t,r){this.j=e,this.Ic=t,this.m=this.l=1/0,this.g=1,this.h=this.i=null,this.u=0,this.A=!0,this.o=0,this.C=void 0===r||r}function Ti(e,t,r,n){return e=Ze(e,n),0==t&&null==r||(e.headers.Range=r?"bytes="+t+"-"+r:"bytes="+t+"-"),e}function $i(){var e=this;this.h=this.g=null,this.j=[],this.i=null,this.u=[],this.m=1,this.A={},this.C=0,this.F=new K(5),this.o=new ke((function(){!function(e){g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return X.info("Updating manifest..."),r=0,C(t,2),$(t,wi(e),4);case 4:r=t.B,k(t,3);break;case 2:n=O(t),e.h&&(n.severity=1,e.h.onError(n));case 3:if(!e.h)return t.return();Oi(e,r),w(t)}}))}))}(e)})),this.l=new Ke}function wi(e){var t=Date.now(),r=e.h.networkingEngine.request(0,Ze(e.j,e.g.retryParameters));return ze(e.l,r),r.promise.then((function(t){if(e.h)return t.uri&&!e.j.includes(t.uri)&&e.j.unshift(t.uri),function(e,t,r){if(!(t=zn.ze(t,"MPD")))throw new Z(2,4,4001,r);return t=ri(t,e.g.retryParameters,e.g.dash.xlinkFailGracefully,r,e.h.networkingEngine),ze(e.l,t),t.promise.then((function(t){return function(e,t,r){return g((function n(){var i,o,a,s,u,c,l,d,f,h,p,g,y,v,m,_,b,A,E,S,T,C,I,k;return M(n,(function(n){switch(n.s){case 1:s=de,c=[r],0<(l=(u=zn).Y(t,"Location").map(u.uc).filter(s.Ra)).length&&(d=fe(c,l),c=e.j=d),f=u.Y(t,"BaseURL").map(u.uc),h=fe(c,f),p=e.g.dash.ignoreMinBufferTime,g=0,p||(g=u.R(t,"minBufferTime",u.Ma)),e.C=u.R(t,"minimumUpdatePeriod",u.Ma,-1),y=u.R(t,"availabilityStartTime",u.jg),v=u.R(t,"timeShiftBufferDepth",u.Ma),m=u.R(t,"maxSegmentDuration",u.Ma),_=t.getAttribute("type")||"static",b=e.g.dash.ignoreSuggestedPresentationDelay,A=null,b||(A=u.R(t,"suggestedPresentationDelay",u.Ma)),e.i?E=e.i.presentationTimeline:(S=Math.max(e.g.dash.defaultPresentationDelay,1.5*g),E=new Si(y,null!=A?A:S,e.g.dash.autoCorrectDrift));for(var O={zb:"static"!=_,presentationTimeline:E,qa:null,$:null,fa:null,G:null,bandwidth:0,me:!1},P=h,R=zn.R(t,"mediaPresentationDuration",zn.Ma),x=[],D=0,L=zn.Y(t,"Period"),N=0;N<L.length;N++){var M=L[N];D=zn.R(M,"start",zn.Ma,D);var B=zn.R(M,"duration",zn.Ma),U=null;if(N!=L.length-1){var j=zn.R(L[N+1],"start",zn.Ma);null!=j&&(U=j-D)}else null!=R&&(U=R-D);if(j=ge,U&&B&&Math.abs(U-B)>j&&X.v("There is a gap/overlap between Periods",M),null==U&&(U=B),M=Ci(e,O,P,{start:D,duration:U,node:M,ld:null==U||N==L.length-1}),x.push(M),B=O.qa.id,e.u.includes(B)||(e.u.push(B),e.i&&(e.h.filterNewPeriod(M),e.i.periods.push(M))),null==U){N!=L.length-1&&X.v("Skipping Period",N+1,"and any subsequent Periods:","Period",N+1,"does not have a valid start time.",x[N+1]),D=null;break}D+=U}if(null==e.i&&e.h.filterAllPeriods(x),null!=R?(D!=R&&X.v("@mediaPresentationDuration does not match the total duration of all","Periods."),i=x,o=R,a=!1):(i=x,o=D,a=!0),T=o,C=i,E.hc("static"==_),"static"!=_&&a||E.Fa(T||1/0),E.aa()&&!isNaN(e.g.availabilityWindowOverride)&&(v=e.g.availabilityWindowOverride),null==v&&(v=1/0),E.Pd(v),E.ud(m||1),e.i){n.I(0);break}if(e.i={presentationTimeline:E,periods:C,offlineSessionIds:[],minBufferTime:g||0},!E.Pe()){n.I(0);break}return I=u.Y(t,"UTCTiming"),$(n,function(e,t,r){r=r.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}));var n=e.g.dash.clockSyncUri;return!r.length&&n&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:n}),de.df(r,function(e){var r=e.scheme;switch(e=e.value,r){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Ri(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Ri(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return r=Date.parse(e),isNaN(r)?0:r-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return X.ba("NTP UTCTiming scheme is not supported"),Promise.reject();default:return X.ba("Unrecognized scheme in UTCTiming element",r),Promise.reject()}}.bind(e)).catch((function(){return X.ba("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0}))}(e,h,I),4);case 4:if(k=n.B,!e.h)return n.return();E.Ke(k),w(n)}}))}))}(e,t,r)}))}(e,t.data,t.uri)})).then((function(){var r=(Date.now()-t)/1e3;return z(e.F,1,r),r}))}function Ci(e,t,r,n){if(t.qa=Pi(n.node,null,r),t.$=n,t.qa.id||(X.info("No Period ID given for Period with start time "+n.start+",  Assigning a default"),t.qa.id="__shaka_period_"+n.start),zn.Y(n.node,"EventStream").forEach(e.kg.bind(e,n.start,n.duration)),r=zn.Y(n.node,"AdaptationSet").map(e.ig.bind(e,t)).filter(de.Ra),t.zb){t=[];for(var i=h(r),o=i.next();!o.done;o=i.next())for(var a=(o=h(o.value.tg)).next();!a.done;a=o.next())t.push(a.value);if(t.length!=new Set(t).size)throw new Z(2,4,4018)}var s=r.filter((function(e){return!e.Td}));if(r.filter((function(e){return e.Td})).forEach((function(e){var t=e.Td.split(" ");s.forEach((function(r){t.includes(r.id)&&r.streams.forEach((function(t){t.trickModeVideo=e.streams.find((function(e){return ft(t.codecs)[0]==ft(e.codecs)[0]}))}))}))})),t=Ii(s,"video"),i=Ii(s,"audio"),!t.length&&!i.length)throw new Z(2,4,4004);for(r=e.g.disableAudio,i.length&&!r||(i=[null]),r=e.g.disableVideo,t.length&&!r||(t=[null]),r=[],o=0;o<i.length;o++)for(a=0;a<t.length;a++)ki(e,i[o],t[a],r);if(t=[],!e.g.disableText)for(e=Ii(s,"text"),i=0;i<e.length;i++)t.push.apply(t,e[i].streams);return{startTime:n.start,textStreams:t,variants:r}}function Ii(e,t){return e.filter((function(e){return e.contentType==t}))}function ki(e,t,r,n){if(t||r)if(t&&r){var i=t.drmInfos,o=r.drmInfos;if(!i.length||!o.length||0<Ut(i,o).length){o=Ut(t.drmInfos,r.drmInfos);for(var a=0;a<t.streams.length;a++)for(var s=0;s<r.streams.length;s++)i=(r.streams[s].bandwidth||0)+(t.streams[a].bandwidth||0),i={id:e.m++,language:t.language,primary:t.pd||r.pd,audio:t.streams[a],video:r.streams[s],bandwidth:i,drmInfos:o,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}else for(o=t||r,a=0;a<o.streams.length;a++)i=o.streams[a].bandwidth||0,i={id:e.m++,language:o.language||"und",primary:o.pd,audio:t?o.streams[a]:null,video:r?o.streams[a]:null,bandwidth:i,drmInfos:o.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}function Oi(e,t){0>e.C||e.o.V(Math.max(3,e.C-t,W(e.F)))}function Pi(e,t,r){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,wd:null,audioSamplingRate:null},r=r||t.xa;var n=zn.Mb,i=zn.ff,o=zn.Y(e,"BaseURL").map(zn.uc),a=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs;i=zn.R(e,"frameRate",i)||t.frameRate;for(var c=e.getAttribute("sar")||t.pixelAspectRatio,l=zn.Y(e,"InbandEventStream"),d=t.emsgSchemeIdUris.slice(),f=(l=h(l)).next();!f.done;f=l.next())f=f.value.getAttribute("schemeIdUri"),d.includes(f)||d.push(f);return l=function(e){for(var t=0;t<e.length;++t){var r=e[t],n=r.getAttribute("schemeIdUri");if(n&&(r=r.getAttribute("value")))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var i=parseInt(r,10);if(!i){X.v("Channel parsing failure! Ignoring scheme and value",n,r);continue}return i;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(i=parseInt(r,16))){X.v("Channel parsing failure! Ignoring scheme and value",n,r);continue}for(e=0;i;)1&i&&++e,i>>=1;return e;default:X.v("Unrecognized audio channel scheme:",n,r)}}return null}(l=zn.Y(e,"AudioChannelConfiguration"))||t.wd,f=zn.R(e,"audioSamplingRate",n)||t.audioSamplingRate,a||(a=xi(s,u)),{xa:fe(r,o),ec:zn.sc(e,"SegmentBase")||t.ec,Ua:zn.sc(e,"SegmentList")||t.Ua,gc:zn.sc(e,"SegmentTemplate")||t.gc,width:zn.R(e,"width",n)||t.width,height:zn.R(e,"height",n)||t.height,contentType:a,mimeType:s,codecs:u,frameRate:i,pixelAspectRatio:c,emsgSchemeIdUris:d,id:e.getAttribute("id"),wd:l,audioSamplingRate:f}}function Ri(e,t,r,n){return(t=Ze(t=fe(t,[r]),e.g.retryParameters)).method=n,t=e.h.networkingEngine.request(4,t),ze(e.l,t),t.promise.then((function(e){if("HEAD"==n){if(!e.headers||!e.headers.date)return X.v("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=ve(e.data);return e=Date.parse(e),isNaN(e)?(X.v("Unable to parse date from UTC timing response"),0):e-Date.now()}))}function xi(e,t){return vr(lt(e,t))?"text":e.split("/")[0]}function Di(e,t,r,n){this.h=e,this.type=t,this.g=r,this.segments=n||null}function Li(e,t,r,n){this.id=e,this.name=t,this.g=r,this.value=void 0===n?null:n}function Ni(e,t){this.name=e,this.value=t}function Mi(e,t,r){return(e=e.getAttribute(t))?e.value:r||null}function Bi(e,t){this.h=t,this.g=e}G("shaka.media.ManifestParser.registerParserByExtension",Ei.Fd),Ei.Qb=function(e,t){Ei.Nb[e]=t},G("shaka.media.ManifestParser.registerParserByMime",Ei.Qb),Ei.ng=function(){var e={};if(pt()){for(var t in Ei.Nb)e[t]=!0;for(var r in Ei.cc)e[r]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var n=(r=h(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=r.next())e[n=n.value]=pt()?!!Ei.Nb[n]:gt(n);for(var i in t)e[i]=pt()?!!Ei.cc[i]:gt(t[i]);return e},Ei.create=function(e,t,r,n){return g((function i(){var o,a;return M(i,(function(i){switch(i.s){case 1:return C(i,2),$(i,Ei.rf(e,t,r,n),4);case 4:return o=i.B,i.return(new o);case 2:throw(a=O(i)).severity=2,a}}))}))},Ei.rf=function(e,t,r,n){return g((function i(){var o,a,s,u,c;return M(i,(function(i){switch(i.s){case 1:if(o=Ei,n){if(a=o.Nb[n.toLowerCase()])return i.return(a);X.v("Could not determine manifest type using MIME type ",n)}if(s=o.getExtension(e)){if(u=o.cc[s])return i.return(u);X.v("Could not determine manifest type for extension ",s)}else X.v("Could not find extension for ",e);if(n){i.I(2);break}return $(i,o.zf(e,t,r),3);case 3:if(n=i.B){if(c=Ei.Nb[n])return i.return(c);X.v("Could not determine manifest type using MIME type",n)}case 2:throw new Z(2,4,4e3,e)}}))}))},Ei.zf=function(e,t,r){return g((function n(){var i,o,a;return M(n,(function(n){switch(n.s){case 1:return(i=Ze([e],r)).method="HEAD",$(n,t.request(0,i).promise,2);case 2:return o=n.B,a=o.headers["content-type"],n.return(a?a.toLowerCase().split(";").shift():"")}}))}))},Ei.getExtension=function(e){return 1==(e=new Q(e).pa.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},Ei.isSupported=function(e,t){return!!pt()&&(t in Ei.Nb||Ei.getExtension(e)in Ei.cc)},G("shaka.media.PresentationTimeline",Si),Si.prototype.ha=function(){return this.l},Si.prototype.getDuration=Si.prototype.ha,Si.prototype.xf=function(){return this.g},Si.prototype.getMaxSegmentDuration=Si.prototype.xf,Si.prototype.Fa=function(e){this.l=e},Si.prototype.setDuration=Si.prototype.Fa,Si.prototype.Ff=function(){return this.j},Si.prototype.getPresentationStartTime=Si.prototype.Ff,Si.prototype.Ke=function(e){this.u=e},Si.prototype.setClockOffset=Si.prototype.Ke,Si.prototype.hc=function(e){this.A=e},Si.prototype.setStatic=Si.prototype.hc,Si.prototype.Pd=function(e){this.m=e},Si.prototype.setSegmentAvailabilityDuration=Si.prototype.Pd,Si.prototype.Ag=function(e){this.Ic=e},Si.prototype.setDelay=Si.prototype.Ag,Si.prototype.pf=function(){return this.Ic},Si.prototype.getDelay=Si.prototype.pf,Si.prototype.Jb=function(e,t){if(0!=e.length){var r=e[e.length-1].endTime+t;this.vd(e[0].startTime+t),this.g=e.reduce((function(e,t){return Math.max(e,t.endTime-t.startTime)}),this.g),this.h=Math.max(this.h,r),null!=this.j&&this.C&&(this.j=(Date.now()+this.u)/1e3-this.h-this.g),X.K("notifySegments:","maxSegmentDuration="+this.g)}},Si.prototype.notifySegments=Si.prototype.Jb,Si.prototype.vd=function(e){this.i=null==this.i?e:Math.min(this.i,e)},Si.prototype.notifyMinSegmentStartTime=Si.prototype.vd,Si.prototype.ud=function(e){this.g=Math.max(this.g,e),X.K("notifyNewSegmentDuration:","maxSegmentDuration="+this.g)},Si.prototype.notifyMaxSegmentDuration=Si.prototype.ud,Si.prototype.offset=function(e){null!=this.i&&(this.i+=e),null!=this.h&&(this.h+=e)},Si.prototype.offset=Si.prototype.offset,Si.prototype.aa=function(){return 1/0==this.l&&!this.A},Si.prototype.isLive=Si.prototype.aa,Si.prototype.ib=function(){return 1/0!=this.l&&!this.A},Si.prototype.isInProgress=Si.prototype.ib,Si.prototype.$b=function(){if(1/0==this.m)return this.o;var e=this.Db()-this.m;return Math.max(this.o,e)},Si.prototype.getSegmentAvailabilityStart=Si.prototype.$b,Si.prototype.Le=function(e){this.o=e},Si.prototype.setUserSeekStart=Si.prototype.Le,Si.prototype.Db=function(){return this.aa()||this.ib()?Math.min(Math.max(0,(Date.now()+this.u)/1e3-this.g-this.j),this.l):this.l},Si.prototype.getSegmentAvailabilityEnd=Si.prototype.Db,Si.prototype.Zb=function(e){var t=Math.max(this.i,this.o);if(1/0==this.m)return Math.ceil(1e3*t)/1e3;var r=this.Db()-this.m;return e=Math.min(r+e,this.Ka()),Math.max(t,e)},Si.prototype.getSafeSeekRangeStart=Si.prototype.Zb,Si.prototype.Cb=function(){return this.Zb(0)},Si.prototype.getSeekRangeStart=Si.prototype.Cb,Si.prototype.Ka=function(){var e=this.aa()||this.ib()?this.Ic:0;return Math.max(0,this.Db()-e)},Si.prototype.getSeekRangeEnd=Si.prototype.Ka,Si.prototype.Pe=function(){return!(null==this.j||null!=this.h&&this.C)},Si.prototype.usingPresentationStartTime=Si.prototype.Pe,G("shaka.dash.DashParser",$i),(i=$i.prototype).configure=function(e){this.g=e},i.start=function(e,t){var r=this;return g((function n(){var i;return M(n,(function(n){switch(n.s){case 1:return r.j=[e],r.h=t,$(n,wi(r),2);case 2:if(i=n.B,r.h&&Oi(r,i),!r.h)throw new Z(2,7,7001);return n.return(r.i)}}))}))},i.stop=function(){return this.g=this.h=null,this.j=[],this.i=null,this.u=[],this.A={},null!=this.o&&(this.o.stop(),this.o=null),this.l.destroy()},i.update=function(){wi(this).catch(function(e){this.h&&this.h.onError(e)}.bind(this))},i.onExpirationUpdated=function(){},i.ig=function(e,t){if(e.fa=Pi(t,e.qa,null),"image"==e.fa.contentType)return X.v("Skipping Image AdaptationSet",e.fa),null;var r=!1,n=zn.Y(t,"Role"),i=n.map((function(e){return e.getAttribute("value")})).filter(de.Ra),o=void 0,a="text"==e.fa.contentType;a&&(o="subtitle");for(var s=0;s<n.length;s++){var u=n[s].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=n[s].getAttribute("value"),u){case"main":r=!0;break;case"caption":case"subtitle":o=u}}var c=null,l=!1;zn.Y(t,"EssentialProperty").forEach((function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?c=e.getAttribute("value"):l=!0})),s=zn.Y(t,"Accessibility");var d=new Map;for(n={},u=(s=h(s)).next();!u.done;n={Vb:n.Vb},u=s.next()){var f=u.value;u=f.getAttribute("schemeIdUri"),f=f.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==u||"urn:scte:dash:cc:cea-708:2015"==u?(n.Vb=1,null!=f?f.split(";").forEach(function(e){return function(t){if(t.includes("=")){var r=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else r="CC"+e.Vb,e.Vb+=2;d.set(r,Nr(t))}}(n)):d.set("CC1","und")):"urn:mpeg:dash:role:2011"==u&&null!=f&&(i.push(f),"captions"==f&&(o="caption"))}if(l)return null;var p=Yn(n=zn.Y(t,"ContentProtection"),this.g.dash.customScheme,this.g.dash.ignoreDrmInfo);if(n=Nr(t.getAttribute("lang")||"und"),s=t.getAttribute("label"),(u=zn.Y(t,"Label"))&&u.length&&((u=u[0]).textContent&&(s=u.textContent)),0==(i=(u=zn.Y(t,"Representation")).map(this.lg.bind(this,e,p,o,n,s,r,i,d)).filter((function(e){return!!e}))).length){if(this.g.dash.ignoreEmptyAdaptationSet||a)return null;throw new Z(2,4,4003)}return e.fa.contentType&&"application"!=e.fa.contentType||(e.fa.contentType=xi(i[0].mimeType,i[0].codecs),i.forEach((function(t){t.type=e.fa.contentType}))),i.forEach((function(e){p.drmInfos.forEach((function(t){e.keyId&&t.keyIds.push(e.keyId)}))})),a=u.map((function(e){return e.getAttribute("id")})).filter(de.Ra),{id:e.fa.id||"__fake__"+this.m++,contentType:e.fa.contentType,language:n,pd:r,streams:i,drmInfos:p.drmInfos,Td:c,tg:a}},i.lg=function(e,t,r,n,i,o,a,s,u){if(e.G=Pi(u,e.fa,null),!function(e){var t=e.ec?1:0;if(t+=e.Ua?1:0,0==(t+=e.gc?1:0))return"text"==e.contentType||"application"==e.contentType||(X.v("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1);return 1!=t&&(X.v("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.ec?(X.info("Using SegmentBase by default."),e.Ua=null):X.info("Using SegmentList by default."),e.gc=null),!0}(e.G))return X.v("Skipping Representation",e.G),null;e.bandwidth=zn.R(u,"bandwidth",zn.Gc)||0;var c=e.G.contentType;c="text"==c||"application"==c;try{var l=this.ug.bind(this);if(e.G.ec)var d=function(e,t){var r=Number(ei(e,vi,"presentationTimeOffset"))||0,n=ei(e,vi,"timescale"),i=1;n&&(i=zn.Gc(n)||1),r=r/i||0,n=gi(e,vi);var o=e.G.contentType;if(i=e.G.mimeType.split("/")[1],"text"!=o&&"mp4"!=i&&"webm"!=i)throw X.error("SegmentBase specifies an unsupported container type.",e.G),new Z(2,4,4006);if("webm"==i&&!n)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.G),new Z(2,4,4005);o=ti(e,vi,"RepresentationIndex");var a=ei(e,vi,"indexRange"),s=e.G.xa;if(a=zn.Hc(a||""),o){var u=o.getAttribute("sourceURL");u&&(s=fe(e.G.xa,[u])),a=zn.R(o,"range",zn.Hc,a)}if(!a)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.G),new Z(2,4,4002);return{createSegmentIndex:(i=yi(e,t,n,s,a.start,a.end,i,r)).createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:n,sa:r}}(e,l);else if(e.G.Ua)d=mi(e,this.A);else if(e.G.gc)d=bi(e,l,this.A,!!this.i);else{var f=e.G.xa,h=e.$.duration||0;d={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<h?1:null},getSegmentReference:function(e){return 1!=e?null:new ii(1,0,h,(function(){return f}),0,null)},initSegmentReference:null,sa:0}}}catch(p){if(c&&4002==p.code)return null;throw p}return u=function(e,t,r,n){var i=Yn(e,t,n);if(r.ge)e=1==r.drmInfos.length&&!r.drmInfos[0].keySystem,t=0==i.drmInfos.length,(0==r.drmInfos.length||e&&!t)&&(r.drmInfos=i.drmInfos),r.ge=!1;else if(0<i.drmInfos.length&&(r.drmInfos=r.drmInfos.filter((function(e){return i.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==r.drmInfos.length))throw new Z(2,4,4008);return i.be||r.be}(u=zn.Y(u,"ContentProtection"),this.g.dash.customScheme,t,this.g.dash.ignoreDrmInfo),{id:this.m++,originalId:e.G.id,createSegmentIndex:d.createSegmentIndex,findSegmentPosition:d.findSegmentPosition,getSegmentReference:d.getSegmentReference,initSegmentReference:d.initSegmentReference,presentationTimeOffset:d.sa,mimeType:e.G.mimeType,codecs:e.G.codecs,frameRate:e.G.frameRate,pixelAspectRatio:e.G.pixelAspectRatio,bandwidth:e.bandwidth,width:e.G.width,height:e.G.height,kind:r,encrypted:0<t.drmInfos.length,keyId:u,language:n,label:i,type:e.fa.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:e.G.emsgSchemeIdUris,roles:a,channelsCount:e.G.wd,audioSamplingRate:e.G.audioSamplingRate,closedCaptions:s}},i.kg=function(e,t,r){var n=zn.Mb,i=r.getAttribute("schemeIdUri")||"",o=r.getAttribute("value")||"",a=zn.R(r,"timescale",n)||1;zn.Y(r,"Event").forEach(function(r){var s=zn.R(r,"presentationTime",n)||0,u=zn.R(r,"duration",n)||0;u=(s=s/a+e)+u/a,null!=t&&(s=Math.min(s,e+t),u=Math.min(u,e+t)),r={schemeIdUri:i,value:o,startTime:s,endTime:u,id:r.getAttribute("id")||"",eventElement:r},this.h.onTimelineRegionAdded(r)}.bind(this))},i.ug=function(e,t,r){return e=Ti(e,t,r,this.g.retryParameters),e=this.h.networkingEngine.request(1,e),ze(this.l,e),e.promise.then((function(e){return e.data}))},Ei.Fd("mpd",$i),Ei.Qb("application/dash+xml",$i),Ei.Qb("video/vnd.mpeg.dash.mpd",$i),Li.prototype.toString=function(){var e="#"+this.name,t=this.g?this.g.map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Li.prototype.getAttribute=function(e){var t=this.g.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Ui={Ab:function(e,t){return e.filter((function(e){return e.name==t}))},cb:function(e,t){var r=Ui.Ab(e,t);return r.length?r[0]:null},Zc:function(e,t,r){return e.filter((function(e){var n=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),n.value==t&&e.value==r}))},Sc:function(e,t){return fe([e],[t])[0]},kd:function(e){return/^#(?!EXT)/m.test(e)}};function ji(e){this.h=e,this.g=0}function Fi(e){Vi(e,/[ \t]+/gm)}function Vi(e,t){t.lastIndex=e.g;var r=t.exec(e.h);return r=null==r?null:{position:r.index,length:r[0].length,wg:r},e.g==e.h.length||null==r||r.position!=e.g?null:(e.g+=r.length,r.wg)}function Gi(e){return e.g==e.h.length?null:(e=Vi(e,/[^ \t\n]*/gm))?e[0]:null}function Hi(){this.g=0}function Ki(e,t,r){var n=(t=(t=ve(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new Z(2,4,4015);t=0;for(var i=1;i<n.length;i++)if(!Ui.kd(n[i])){var o=Wi(e,n[i]);if(--e.g,Yi.includes(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(i+=1)}for(i=[],o=1;o<n.length;)if(Ui.kd(n[o]))o+=1;else{var a=Wi(e,n[o]);if(Xi.includes(a.name)){if(1!=t)throw new Z(2,4,4017);return new Di(r,t,i,e=zi(e,r,n=n.splice(o,n.length-o),i))}i.push(a),o+=1,"EXT-X-STREAM-INF"==a.name&&(a.g.push(new Ni("URI",n[o])),o+=1)}return new Di(r,t,i)}function zi(e,t,r,n){var i=[],o=[];return r.forEach((function(r){if(/^(#EXT)/.test(r))r=Wi(e,r),Yi.includes(r.name)?n.push(r):o.push(r);else{if(Ui.kd(r))return[];r=Ui.Sc(t,r.trim()),i.push(new Bi(r,o)),o=[]}})),i}function Wi(e,t){var r=e.g++,n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new Z(2,4,4016,t);var i,o=n[1],a=n[2];if(n=[],a){var s;(s=Vi(a=new ji(a),/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Vi(a,u);)n.push(new Ni(s[1],s[2]||s[3]))}return new Li(r,o,n,i)}var Yi="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Xi="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Zi(e){try{var t=Zi.parse(e);return Le({uri:e,Bd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(r){return xe(r)}}function qi(){var e=this;this.g=this.j=null,this.ea=1,this.L=new Map,this.Z=new Set,this.h=new Map,this.i=null,this.F="",this.C=new Hi,this.X=0,this.m=new ke((function(){!function(e){g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return X.info("Updating manifest..."),e.j?(C(t,2),$(t,e.update(),4)):t.return();case 4:r=e.X,e.m.V(r),k(t,0);break;case 2:if(n=O(t),!e.j)return t.return();n.severity=1,e.j.onError(n),e.m.V(.1),w(t)}}))}))}(e)})),this.l=mo,this.A=null,this.J=0,this.M=1/0,this.o=new Ke,this.P=[],this.u=new Map,this.da=!1}function Qi(e,t){return g((function r(){var n,i,o,a,s,u,c,l,d,f;return M(r,(function(r){switch(r.s){case 1:return n=Ui,i=_o,o=t.We,$(r,yo(e,Ze([o],e.g.retryParameters),0),2);case 2:if(a=r.B,1!=(s=Ki(e.C,a.data,a.uri)).type)throw new Z(2,4,4017);return c=(u=n.cb(s.g,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,l=t.stream,$(r,ao(e,t.Pc,s,c,l.mimeType,l.codecs),3);case 3:d=r.B,t.fc.g=d,f=d[d.length-1],n.cb(s.g,"EXT-X-ENDLIST")&&(go(e,i.$a),e.i.Fa(f.endTime)),w(r)}}))}))}function Ji(e){e.forEach((function(e){if(e){var t=e.stream.codecs.split(",");t=t.filter((function(e){return"mp4a.40.34"!=e})),e.stream.codecs=t.join(",")}}))}function eo(e,t,r,n,i){return{id:e.ea++,language:t?t.language:"und",primary:!!t&&t.primary||!!r&&r.primary,audio:t,video:r,bandwidth:n,drmInfos:i,allowedByApplication:!0,allowedByKeySystem:!0}}function to(e,t,r){return g((function n(){var i,o,a,s,u,c,l,d,f,h,p;return M(n,(function(n){switch(n.s){case 1:if(i=co(t,"URI"),e.h.has(i))return n.return(e.h.get(i));if(o=co(t,"TYPE").toLowerCase(),a=pe,"subtitles"==o&&(o=a.za),s=Nr(Mi(t,"LANGUAGE","und")),u=Mi(t,"NAME"),c=t.getAttribute("DEFAULT"),l="YES"==c,d=Mi(t,"CHANNELS"),"audio"==o)if(d){var g=d.split("/")[0];g=parseInt(g,10)}else g=null;else g=null;return f=g,h=Mi(t,"CHARACTERISTICS"),$(n,ro(e,i,r,o,s,l,u,f,null,h),2);case 2:return p=n.B,e.h.has(i)?n.return(e.h.get(i)):null==p?n.return(null):(e.L.set(t.id,p),e.h.set(i,p),n.return(p))}}))}))}function ro(e,t,r,n,i,o,a,s,u,c){return g((function l(){var d,f,p,y,v,m,_,b,A,E,S,T,w,I,P,R,x,D,L,N,B,U,j,F,V,G,H,K;return M(l,(function(l){switch(l.s){case 1:return f=(d=Ui).Sc(e.F,t),$(l,yo(e,Ze([f],e.g.retryParameters),0),2);case 2:if(p=l.B,f=p.uri,1!=(y=Ki(e.C,p.data,f)).type)throw new Z(2,4,4017);v=[],y.segments.forEach((function(e){e=d.Ab(e.h,"EXT-X-KEY"),v.push.apply(v,e)})),m=!1,_=[],b=null;for(var z=h(v),W=z.next();!W.done;W=z.next())if(A=W.value,"NONE"!=(E=co(A,"METHOD"))){if(m=!0,"AES-128"==E)return X.v("Unsupported HLS Encryption",E),e.da=!0,l.return(null);S=co(A,"KEYFORMAT"),(w=(T=vo[S])?T(A):null)?(w.keyIds.length&&(b=w.keyIds[0]),_.push(w)):X.v("Unsupported HLS KEYFORMAT",S)}if(m&&!_.length)throw new Z(2,4,4026);return function(e,t){var r=_o,n=Ui.cb(t.g,"EXT-X-PLAYLIST-TYPE"),i=Ui.cb(t.g,"EXT-X-ENDLIST");i=n&&"VOD"==n.value||i,n=n&&"EVENT"==n.value&&!i,n=!i&&!n,i?go(e,r.$a):(go(e,n?r.Wd:r.Se),r=lo(t.g,"EXT-X-TARGETDURATION"),r=Number(r.value),e.J=Math.max(r,e.J),e.M=Math.min(r,e.M))}(e,y),I=function(e,t){if(1==t.length)return t[0];var r=uo(e,t);if(null!=r)return r;throw new Z(2,4,4025,t)}(n,r),$(l,function(e,t,r,n){return g((function i(){var o,a,s,u,c,l,d,f,h,p;return M(i,(function(i){switch(i.s){case 1:return o=pe,a=n.segments[0].g,s=new Q(a),u=s.pa.split(".").pop(),c=po[t],(l=c[u])?i.return(l):t==o.za?r&&"vtt"!=r&&"wvtt"!=r?i.return("application/mp4"):i.return("text/vtt"):((d=Ze([a],e.g.retryParameters)).method="HEAD",$(i,yo(e,d,1),2));case 2:return f=i.B,(h=f.headers["content-type"])?i.return(h.split(";")[0]):(p=c.mp4,i.return(p))}}))}))}(e,n,I,y),3);case 3:return P=l.B,ho.includes(P)&&(I=""),x=(R=d.cb(y.g,"EXT-X-MEDIA-SEQUENCE"))?Number(R.value):0,C(l,4),$(l,ao(e,t,y,x,P,I),6);case 6:D=l.B,k(l,5);break;case 4:if(4035==(L=O(l)).code)return X.ba("Skipping unsupported HLS stream",P,t),l.return(null);throw L;case 5:if(N=D[0].startTime,B=D[D.length-1].endTime,U=B-N,j=new ai(D),F=no(y),V=void 0,"text"==n&&(V="subtitle"),G=[],c)for(W=(z=h(c.split(","))).next();!W.done;W=z.next())H=W.value,G.push(H);return K={id:e.ea++,originalId:a,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:j.find.bind(j),getSegmentReference:j.get.bind(j),initSegmentReference:F,presentationTimeOffset:0,mimeType:P,codecs:I,kind:V,encrypted:m,keyId:b,language:i,label:a,type:n,primary:o,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:G,channelsCount:s,audioSamplingRate:null,closedCaptions:u},l.return({stream:K,fc:j,drmInfos:_,Pc:t,We:f,td:N,Yg:B,duration:U})}}))}))}function no(e){var t=Ui.Ab(e.g,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new Z(2,4,4020);var r=co(t=t[0],"URI"),n=Ui.Sc(e.h,r);return e=0,r=null,(t=Mi(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),r=(e=Number(e[1]))+t-1),new ni((function(){return[n]}),e,r)}function io(e,t,r,n){var i=t.h,o=t.g;t=lo(i,"EXTINF").value.split(","),t=n+Number(t[0]);var a=0,s=null;return(i=Ui.cb(i,"EXT-X-BYTERANGE"))&&(a=i.value.split("@"),i=Number(a[0]),s=(a=a[1]?Number(a[1]):e.g+1)+i-1),new ii(r,n,t,(function(){return[o]}),a,s)}function oo(e){e.i&&(e.P.forEach((function(t){e.i.Jb(t,0)})),e.P=[])}function ao(e,t,r,n,i,o){return g((function a(){var s,u,c,l,d,f,h,p,y,v;return M(a,(function(a){switch(a.s){case 1:return s=r.segments,u=[],c=s[0].g,l=io(null,s[0],n,0),d=no(r),$(a,function(e,t,r,n,i,o){return g((function a(){var s,u,c,l,d,f,h,p,g;return M(a,(function(a){switch(a.s){case 1:if(e.A){if(s=e.h.get(t),u=s.fc,c=u.get(n.position))return X.K("Found segment start time in previous manifest"),a.return(c.startTime);X.debug("Unable to find segment start time in previous manifest!")}if(X.K("Fetching segment to find start time"),i=i.toLowerCase(),ho.includes(i))throw X.ba("Raw formats are not yet supported.  Skipping "+i),new Z(1,4,4035);if("video/webm"==i)throw X.ba("WebM in HLS is not yet supported.  Skipping."),new Z(1,4,4035);if("video/mp4"!=i&&"audio/mp4"!=i){a.I(2);break}return l=[so(e,n)],r&&l.push(so(e,r)),$(a,Promise.all(l),3);case 3:return d=a.B,f=d[0],h=d[1]||d[0],a.return(function(e,t,r,n){var i=0;if((new Bn).box("moov",Un).box("trak",Un).box("mdia",Un).ma("mdhd",(function(e){e.reader.U(0==e.version?8:16),i=e.reader.N(),e.parser.stop()})).parse(n,!0),!i)throw X.error("Unable to find timescale in init segment!"),new Z(2,4,4030,e,t);var o=0,a=!1;if((new Bn).box("moof",Un).box("traf",Un).ma("tfdt",(function(e){o=(0==e.version?e.reader.N():e.reader.Pb())/i,a=!0,e.parser.stop()})).parse(r,!0),!a)throw new Z(2,4,4030,e,t);return o}(t,f.uri,f.data,h.data));case 2:if("video/mp2t"!=i){a.I(4);break}return $(a,so(e,n),5);case 5:return p=a.B,a.return(function(e,t,r){function n(){o.seek(a+188),71!=(s=o.ra())&&(o.seek(a+192),s=o.ra()),71!=s&&(o.seek(a+204),s=o.ra()),71!=s&&i(),o.Fe(1)}function i(){throw new Z(2,4,4030,e,t)}for(var o=new Ln(new DataView(r),0),a=0,s=0;;)if(a=o.ka(),71!=(s=o.ra())&&i(),8191==(8191&(r=o.dc())))n();else if(16384&r){if(0!=(r=(48&o.ra())>>4)&&2!=r||i(),3==r&&(r=o.ra(),o.U(r)),1==o.N()>>8)return o.U(3),0!=(r=o.ra()>>6)&&1!=r||i(),0==o.ra()&&i(),(1073741824*((14&(r=o.ra()))>>1)+((65534&o.dc())<<14|(65534&o.dc())>>1))/9e4;n()}else n()}(t,p.uri,p.data));case 4:if("application/mp4"!=i&&!i.startsWith("text/")){a.I(6);break}return $(a,so(e,n),7);case 7:return g=a.B,a.return(function(e,t,r){return vr(e=lt(e,t))?(mr(t=new gr(null),e),t.xc(r)):0}(i,o,g.data));case 6:throw new Z(2,4,4030,t)}}))}))}(e,t,d,l,i,o),2);case 2:f=a.B,X.debug("First segment",c.split("/").pop(),"starts at",f);for(var m=0;m<s.length;++m)h=s[m],p=u[u.length-1],y=0==m?f:p.endTime,v=io(p,h,n+m,y),u.push(v);return e.P.push(u),oo(e),a.return(u)}}))}))}function so(e,t){return g((function r(){var n,i,o,a,s,u;return M(r,(function(r){switch(r.s){case 1:return n=1,i=Ti(t.i(),t.h,t.h+2048-1,e.g.retryParameters),o=Ti(t.i(),t.h,t.g,e.g.retryParameters),e.g.hls.useFullSegmentsForStartTime?r.return(yo(e,o,n)):(C(r,2),$(r,yo(e,i,n),4));case 4:return a=r.B,r.return(a);case 2:if(7001==(s=O(r)).code)throw s;return X.ba("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),$(r,yo(e,o,n),5);case 5:return u=r.B,r.return(u)}}))}))}function uo(e,t){for(var r=fo[e],n=0;n<r.length;n++)for(var i=0;i<t.length;i++)if(r[n].test(t[i].trim()))return t[i].trim();return"text"==e?"":null}function co(e,t){var r=e.getAttribute(t);if(!r)throw new Z(2,4,4023,t);return r.value}function lo(e,t){var r=Ui.cb(e,t);if(!r)throw new Z(2,4,4024,t);return r}G("shaka.net.DataUriPlugin",Zi),Zi.parse=function(e){var r=e.split(":");if(2>r.length||"data"!=r[0])throw X.error("Bad data URI, failed to parse scheme"),new Z(2,1,1004,e);if(2>(r=r.slice(1).join(":").split(",")).length)throw X.error("Bad data URI, failed to extract encoding and MIME type"),new Z(2,1,1004,e);var n=r[0];e=t.decodeURIComponent(r.slice(1).join(",")),r=n.split(";"),n=r[0];var i=!1;return 1<r.length&&"base64"==r[r.length-1]&&(i=!0,r.pop()),{data:i?Te.Ja(e).buffer:be(e),contentType:n}},Xe("data",Zi),G("shaka.hls.HlsParser",qi),(i=qi.prototype).configure=function(e){this.g=e},i.start=function(e,t){var r=this;return g((function n(){var i,o;return M(n,(function(n){switch(n.s){case 1:return r.j=t,$(n,yo(r,Ze([e],r.g.retryParameters),0),2);case 2:return i=n.B,r.F=i.uri,$(n,function(e,t){return g((function r(){var n,i,o,a,s,u,c,l,d,f,p;return M(r,(function(r){switch(r.s){case 1:if(0!=(n=Ki(e.C,t,e.F)).type)throw new Z(2,4,4022);return $(r,function(e,t){return g((function r(){var n,i,o,a,s,u,c,l,d,f,p,y;return M(r,(function(r){switch(r.s){case 1:return n=Ui,i=de,o=t.g,a=n.Ab(t.g,"EXT-X-MEDIA"),s=a.filter(function(e){return"SUBTITLES"==co(e,"TYPE")}.bind(e)),u=s.map(function(e){var t=this;return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return t.g.disableText?r.return(null):(C(r,2),$(r,function(e,t){return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return co(t,"TYPE"),$(r,to(e,t,[]),2);case 2:return n=r.B,r.return(n.stream)}}))}))}(t,e),4));case 4:return r.return(r.B);case 2:if(n=O(r),t.g.hls.ignoreTextStreamFailures)return r.return(null);throw n}}))}))}.bind(e)),c=a.filter((function(e){return"CLOSED-CAPTIONS"==co(e,"TYPE")})),function(e,t){for(var r=h(t),n=r.next();!n.done;n=r.next()){co(n=n.value,"TYPE");var i=Mi(n,"LANGUAGE")||"und";i=Nr(i);var o=co(n,"GROUP-ID");n=co(n,"INSTREAM-ID"),e.u.get(o)||e.u.set(o,new Map),e.u.get(o).set(n,i)}}(e,c),$(r,Promise.all(u),2);case 2:return l=r.B,d=n.Ab(o,"EXT-X-STREAM-INF"),f=d.map(function(e){return function(e,t,r){return g((function n(){var i,o,a,s,u,c,l,d,f,p,y,v,m,_,b,A,E,S,T,w,C,I,k,O,P,R,x,D,L;return M(n,(function(n){switch(n.s){case 1:return i=pe,o=Ui,a=[],e.g.disableVideo||a.push("avc1.42E01E"),e.g.disableAudio||a.push("mp4a.40.2"),s=a.join(","),u=Mi(t,"CODECS",s),c=function(e){for(var t=new Set,r=[],n=(e=h(e)).next();!n.done;n=e.next()){var i=ft(n=n.value)[0];t.has(i)?X.debug("Ignoring duplicate codec"):(r.push(n),t.add(i))}return r}(u.split(/\s*,\s*/)),l=t.getAttribute("RESOLUTION"),f=d=null,p=Mi(t,"FRAME-RATE"),y=Number(Mi(t,"AVERAGE-BANDWIDTH"))||Number(co(t,"BANDWIDTH")),l&&(v=l.value.split("x"),d=v[0],f=v[1]),m=(m=o.Ab(r.g,"EXT-X-MEDIA")).filter((function(e){return"CLOSED-CAPTIONS"!=co(e,"TYPE")})),m=m.filter((function(e){var t=Mi(e,"URI")||"";return"SUBTITLES"==(Mi(e,"TYPE")||"")||""!=t})),_=Mi(t,"AUDIO"),b=Mi(t,"VIDEO"),_?m=o.Zc(m,"AUDIO",_):b&&(m=o.Zc(m,"VIDEO",b)),(A=uo(i.za,c))&&((E=Mi(t,"SUBTITLES"))&&(S=o.Zc(m,"SUBTITLES",E)).length&&(T=e.L.get(S[0].id))&&(T.stream.codecs=A),Ge(c,A)),w=m.map(function(e){return to(this,e,c)}.bind(e)),C=[],I=[],$(n,Promise.all(w),2);case 2:if(O=(O=n.B).filter((function(e){return null!=e})),_?C=O:b&&(I=O),X.debug("Guessing stream type for",t.toString()),R=!1,C.length||I.length?C.length?(D=co(t,"URI"),L=C[0].Pc,D==L?(X.debug("Guessing audio-only."),P=i.Sb,R=!0):(X.debug("Guessing video."),P=i.Za)):(X.debug("Guessing audio."),P=i.Sb):1==c.length?(x=uo(i.Za,c),l||p||x?(X.debug("Guessing video-only."),P=i.Za):(X.debug("Guessing audio-only."),P=i.Sb)):(X.debug("Guessing multiplexed audio+video."),P=i.Za,c=[c.join(",")]),R){n.I(3);break}return $(n,function(e,t,r,n){return g((function i(){var o,a,s,u,c;return M(i,(function(i){switch(i.s){case 1:return o=pe,a=co(t,"URI"),e.h.has(a)?i.return(e.h.get(a)):(s=Mi(t,"CLOSED-CAPTIONS"),u=null,n==o.Za&&s&&"NONE"!=s&&(u=e.u.get(s)),$(i,ro(e,a,r,n,"und",!1,null,null,u,null),2));case 2:return null==(c=i.B)?i.return(null):e.h.has(a)?i.return(e.h.get(a)):(e.h.set(a,c),i.return(c))}}))}))}(e,t,c,P),4);case 4:k=n.B;case 3:if(k)k.stream.type==i.Sb?C=[k]:I=[k];else if(null===k)return X.debug("streamInfo is null"),n.return([]);return I&&Ji(I),C&&Ji(C),n.return(function(e,t,r,n,i,o,a){r.forEach(function(e){(e=e.stream)&&(e.width=Number(i)||void 0,e.height=Number(o)||void 0,e.frameRate=Number(a)||void 0)}.bind(e));var s=!!e.g&&e.g.disableAudio;t.length&&!s||(t=[null]);s=!!e.g&&e.g.disableVideo,(!r.length||s)&&(r=[null]);s=[];for(var u=(t=h(t)).next();!u.done;u=t.next()){u=u.value;for(var c=h(r),l=c.next();!l.done;l=c.next()){var d=l.value;l=u?u.stream:null;var f=d?d.stream:null,p=u?u.drmInfos:null,g=d?d.drmInfos:null;d=(d?d.Pc:"")+" - "+(u?u.Pc:"");var y=void 0;if(l&&f){if(p.length&&g.length&&!(0<Ut(p,g).length)){X.v("Incompatible DRM info in HLS variant.  Skipping.");continue}y=Ut(p,g)}else l?y=p:f&&(y=g);e.Z.has(d)?X.debug("Skipping variant which only differs in text streams."):(l=eo(e,l,f,n,y),s.push(l),e.Z.add(d))}}return s}(e,C,I,y,d,f,p))}}))}))}(this,e,t)}.bind(e)),$(r,Promise.all(f),3);case 3:return p=r.B,y=(y=p.reduce(i.Rc,[])).filter((function(e){return null!=e})),r.return({startTime:0,variants:y,textStreams:l.filter((function(e){return null!=e}))})}}))}))}(e,n),2);case 2:if(i=r.B,!e.j)throw new Z(2,7,7001);if(e.da&&0==i.variants.length)throw X.info("No stream is created, because we don't support AES-128","encryption yet"),new Z(2,4,4034);e.j.filterAllPeriods([i]),o=1/0,a=0,s=1/0;for(var y=h(e.h.values()),v=y.next();!v.done;v=y.next())u=v.value,o=Math.min(o,u.td),a=Math.max(a,u.td),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(e.l!=_o.$a?(e.i=new Si(0,3*e.J),e.i.hc(!1)):(e.i=new Si(null,0),e.i.hc(!0)),oo(e),e.l!=_o.$a){for(e.X=e.M,c=_o,e.l==c.Wd&&(l=e.i.Ic,isNaN(e.g.availabilityWindowOverride)||(l=e.g.availabilityWindowOverride),e.i.Pd(l)),d=0;95443.7176888889<=a;)d+=95443.7176888889,a-=95443.7176888889;if(d)for(X.debug("Offsetting live streams by",d,"to compensate for rollover"),v=(y=h(e.h.values())).next();!v.done;v=y.next())95443.7176888889>(f=v.value).td?(X.K("Offset applied to",f.stream.type),f.stream.presentationTimeOffset=-d,f.fc.offset(d)):X.K("Offset NOT applied to",f.stream.type)}else for(e.i.Fa(s),e.i.offset(-o),v=(y=h(e.h.values())).next();!v.done;v=y.next())(p=v.value).stream.presentationTimeOffset=o,p.fc.offset(-o),si(p.fc,s);e.A={presentationTimeline:e.i,periods:[i],offlineSessionIds:[],minBufferTime:0},w(r)}}))}))}(r,i.data),3);case 3:return 0<(o=r.X)&&r.m.V(o),n.return(r.A)}}))}))},i.stop=function(){this.m&&(this.m.stop(),this.m=null);var e=[];return this.o&&(e.push(this.o.destroy()),this.o=null),this.g=this.j=null,this.L.clear(),this.Z.clear(),this.h.clear(),this.A=null,Promise.all(e)},i.update=function(){if(this.l!=_o.$a){for(var e=[],t=h(this.h.values()),r=t.next();!r.done;r=t.next())e.push(Qi(this,r.value));return Promise.all(e)}},i.onExpirationUpdated=function(){};var fo={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},ho=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],po={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function go(e,t){e.l=t,e.i&&e.i.hc(e.l==_o.$a),e.l!=_o.$a||e.m.stop()}function yo(e,t,r){if(!e.o)throw new Z(2,7,7001);return t=e.j.networkingEngine.request(r,t),ze(e.o,t),t.promise}var vo={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=co(e,"METHOD");Hr("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var r=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return r.includes(t)?(t=co(e,"URI"),t=Zi.parse(t),t=he("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Mi(e,"KEYID"))&&(t.keyIds=[e.toLowerCase().substr(2)]),t):(X.error("Widevine in HLS is only supported with [",r.join(", "),"], not",t),null)}},mo="VOD",_o={$a:mo,Se:"EVENT",Wd:"LIVE"};function bo(){this.g=new Map}function Ao(e,t,r){Eo(e,t).text=r}function Eo(e,t){return e.g.has(t)||e.g.set(t,new So),e.g.get(t)}function So(){this.text=this.variant=null}function To(e,t){this.g=e,this.h=new Set([e]);for(var r=h(t=t||[]),n=r.next();!n.done;n=r.next())this.add(n.value)}function $o(e,t){var r;if(!(r=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(r=e.audio&&t.audio)){r=e.audio;var n=t.audio;r=!(r.channelsCount==n.channelsCount&&wo(r,n)&&Co(r.roles,n.roles))}return!r&&(r=e.video&&t.video)&&(r=!(wo(r=e.video,n=t.video)&&Co(r.roles,n.roles))),!r}function wo(e,t){if(e.mimeType!=t.mimeType)return!1;var r=e.codecs.split(",").map((function(e){return ft(e)[0]})),n=t.codecs.split(",").map((function(e){return ft(e)[0]}));if(r.length!=n.length)return!1;r.sort(),n.sort();for(var i=0;i<r.length;i++)if(r[i]!=n[i])return!1;return!0}function Co(e,t){var r=new Set(e),n=new Set(t);if(r.delete("main"),n.delete("main"),r.size!=n.size)return!1;for(var i=(r=h(r)).next();!i.done;i=r.next())if(!n.has(i.value))return!1;return!0}function Io(e){this.g=e,this.h=new ko(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function ko(e,t,r,n){this.i=e,this.j=t,this.g=r,this.h=void 0===n?"":n}function Oo(){this.g=xo,this.h=(new Map).set(xo,2).set(Ro,1)}function Po(e,t,r){e.h.set(xo,r).set(Ro,t)}Ei.Fd("m3u8",qi),Ei.Qb("application/x-mpegurl",qi),Ei.Qb("application/vnd.apple.mpegurl",qi),To.prototype.add=function(e){return $o(this.g,e)?(this.h.add(e),!0):(X.v("Rejecting variant - not compatible with root."),!1)},To.prototype.values=function(){return this.h.values()},Io.prototype.create=function(e){var t=this,r=e.filter((function(e){return $o(t.g,e)}));return r.length?new To(r[0],r):this.h.create(e)},ko.prototype.create=function(e){var t=[];t=function(e,t){var r=Br(Nr(t),e.map((function(e){return Mr(e)})));return r?e.filter((function(e){return r==Mr(e)})):[]}(e,this.i);var r=e.filter((function(e){return e.primary}));for((e=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(t=t.length?t:r.length?r:e,this.j)).length?t=e:X.v("No exact match for variant role could be found."),this.g&&((e=jr.ee(t,this.g)).length?t=e:X.v("No exact match for the channel count could be found.")),this.h&&(e=function(e,t){return e.filter((function(e){return!!e.audio&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.h),e.length?t=e:X.v("No exact match for variant label could be found.")),e=new To(t[0]),r=(t=h(t)).next();!r.done;r=t.next())r=r.value,$o(e.g,r)&&e.add(r);return e};var Ro=0,xo=1;function Do(e,t){this.l=e,this.m=No(e),this.g=e.g.currentTime,this.j=Date.now()/1e3,this.h=!1,this.o=t,this.i=function(){}}function Lo(e){this.g=e}function No(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.buffered,e=e.g.currentTime;for(var r=0;r<t.length;r++){var n=t.start(r),i=t.end(r);if(!(e<n-.1||e>i-.5)){t=!0;break e}}t=!1}return t}function Mo(e,t,r,n,i){var o=this;this.g=e,this.F=t,this.C=r,this.u=i,this.j=new tt,this.o=!1,this.A=e.readyState,this.i=!1,this.h=n,this.m=!1,this.j.H(e,"waiting",(function(){return Bo(o)})),this.l=new ke((function(){Bo(o)})).Oa(.25)}function Bo(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.o)return}else e.o=!1;if(!e.g.paused||0==e.g.currentTime){var t;if(e.g.readyState!=e.A&&(e.i=!1,e.A=e.g.readyState),!(t=!e.h)){var r=(t=e.h).l,n=No(r),i=r.g.currentTime,o=Date.now()/1e3;t.g==i&&t.m==n||(t.j=o,t.g=i,t.m=n,t.h=!1),(n=(i=o-t.j)>=t.o&&n&&!t.h)&&(t.i(t.g,i),t.h=!0,t.g=r.g.currentTime),t=!n}if(t){o=e.C.smallGapLimit,t=e.g.currentTime;e:{if((r=e.g.buffered)&&r.length&&!(1==r.length&&1e-6>r.end(0)-r.start(0)))for(n=navigator.userAgent.match(/Edge\//)||_t("Trident/")||yt()||_t("CrKey")?.5:.1,i=0;i<r.length;i++)if(r.start(i)>t&&(0==i||r.end(i-1)-t<=n)){n=i;break e}n=null}if(null!=n&&(0!=n||e.m)){i=r.start(n);var a=e.F.Ka();if(!(i>=a)){o=(a=i-t)<=o;var s=!1;if(!(.001>a)){if(!o&&!e.i){e.i=!0;var u=new Be("largegap",{currentTime:t,gapSize:a});u.cancelable=!0,e.u(u),e.C.jumpLargeGaps&&!u.defaultPrevented?s=!0:X.info("Ignoring large gap at",t,"size",a)}(o||s)&&(0==n?X.info("Jumping forward",a,"seconds because of gap before start time of",i):X.info("Jumping forward",a,"seconds because of gap starting at",r.end(n-1),"and ending at",i),e.g.currentTime=i)}}}}}}}function Uo(e){var t=this;this.i=e,this.g=new Set,this.h=new ke((function(){jo(t,!1)})).Oa(.25)}function jo(e,t){for(var r=h(e.g),n=r.next();!n.done;n=r.next())n.value.l(e.i.currentTime,t)}function Fo(e){for(var t=[],r=(e=h(e)).next();!r.done;r=e.next())for(var n=(r=h(r.value.variants)).next();!n.done;n=r.next())t.push(n.value);return t}function Vo(e,t){for(var r=null,n=h(e),i=n.next();!i.done;i=n.next())t>=(i=i.value).startTime&&(r=i);return r}function Go(e){this.i=e,this.g=null,this.h=function(){}}function Ho(e){var t=this;this.g=e,this.j=!1,this.i=this.g.wc(),this.h=new ke((function(){t.g.pe(.25*t.i)}))}function Ko(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.wc()!=t&&e.g.Od(t))}catch(r){}e.h.Oa(.25),0!=e.g.wc()&&e.g.Od(0)}function zo(e,t,r,n){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?n():(t=Wo.get(t),r.ya(e,t,n))}Do.prototype.release=function(){this.l=null,this.i=function(){}},Mo.prototype.release=function(){this.j&&(this.j.release(),this.j=null),null!=this.l&&(this.l.stop(),this.l=null),this.h&&(this.h.release(),this.h=null),this.g=this.F=this.u=null},Mo.prototype.zd=function(){this.m=!0,Bo(this)},Uo.prototype.release=function(){this.h.stop();for(var e=h(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},Go.prototype.release=function(){this.g=this.i=null,this.h=function(){}},Go.prototype.l=function(e){var t=this.g,r=this.i.periods;t!=(e=Vo(r,e)||r[0])&&this.h(e),this.g=e},Ho.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},Ho.prototype.set=function(e){this.i=e,Ko(this)},Ho.prototype.vc=function(){return this.g.vc()};var Wo=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Yo(e,t,r){var n=this;this.g=e,this.l=t,this.j=r,this.m=!1,this.h=new tt,this.i=new Jo(e),zo(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){qo(n,n.j)}))}function Xo(e){return e.m?e.g.currentTime:e.j}function Zo(e,t){0<e.g.readyState?ea(e.i,t):zo(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){qo(e,e.j)}))}function qo(e,t){.001>Math.abs(e.g.currentTime-t)?Qo(e):(e.h.ya(e.g,"seeking",(function(){Qo(e)})),ea(e.i,0==e.g.currentTime?t:e.g.currentTime))}function Qo(e){e.m=!0,e.h.H(e.g,"seeking",(function(){return e.l()}))}function Jo(e){var t=this;this.h=e,this.m=10,this.l=this.i=this.j=0,this.g=new ke((function(){0>=t.j?(X.v(["Failed to move playhead from",t.i,"to",t.l].join(" ")),t.g.stop()):t.h.currentTime!=t.i?t.g.stop():(t.h.currentTime=t.l,t.j--)}))}function ea(e,t){e.i=e.h.currentTime,e.l=t,e.j=e.m,e.h.currentTime=t,e.g.Oa(.1)}function ta(e){var t=this;this.g=e,this.j=!1,this.i=null,this.h=new tt,zo(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.h,(function(){null==t.i?t.j=!0:(t.h.ya(t.g,"seeking",(function(){t.j=!0})),t.g.currentTime=Math.max(0,t.g.currentTime+t.i))}))}function ra(e,t,r,n,i,o){var a=this;this.i=e,this.g=t.presentationTimeline,this.J=t.minBufferTime||0,this.m=r,this.F=i,this.u=null,this.j=new Mo(e,t.presentationTimeline,r,function(e,t){if(!t.stallEnabled)return null;var r=t.stallSkip,n=new Do(new Lo(e),t.stallThreshold);return function(e,t){e.i=t}(n,(function(t,n){X.debug("Stall detected at "+t+" for "+n+" seconds."),r?(X.debug("Seeking forward "+r+" seconds to break stall."),e.currentTime+=r):(X.debug("Pausing and unpausing to break stall."),e.pause(),e.play())})),n}(e,r),o),this.h=new Yo(e,(function(){e:{var e=a.j;e.o=!0,e.m=!1,e.i=!1,e=Xo(a.h);var t=ia(a,e);if(.001<Math.abs(t-e)){var r=Date.now()/1e3;if(!a.u||a.u<r-1){a.u=r,Zo(a.h,t),e=void 0;break e}}X.K("Seek to "+e),a.F(),e=void 0}return e}),function(e,t){return null==t?t=1/0>e.g.ha()?e.g.Cb():e.g.Ka():0>t&&(t=e.g.Ka()+t),na(e,oa(e,t))}(this,n)),this.o=new ke((function(){if(0!=a.i.readyState&&!a.i.paused){var e=Xo(a.h),t=a.g.Cb(),r=a.g.Ka();3>r-t&&(t=r-3),e<t&&(t=ia(a,e),X.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),a.i.currentTime=t)}})).Oa(.25)}function na(e,t){var r=e.g.ha();return t>=r?r-e.m.durationBackoff:t}function ia(e,t){var r=Xt.bind(null,e.i.buffered),n=Math.max(e.J,e.m.rebufferingGoal),i=e.m.safeSeekOffset,o=e.g.Cb(),a=e.g.Ka(),s=e.g.ha();3>a-o&&(o=a-3);var u=e.g.Zb(n),c=e.g.Zb(i);return n=e.g.Zb(n+i),t>=s?(X.K("Playhead past duration."),na(e,t)):t>a?(X.K("Playhead past end."),a):t<o?r(c)?(X.K("Playhead before start & start is buffered"),c):(X.K("Playhead before start & start is unbuffered"),n):t>=u||r(t)?(X.K("Playhead in safe region or in buffered region."),t):(X.K("Playhead outside safe region & in unbuffered region."),n)}function oa(e,t){var r=e.g.Cb();return t<r||t>(r=e.g.Ka())?r:t}function aa(e){var t=this;this.h=function(){},this.g=new Set,this.j=e,this.i=new ke((function(){for(var e=t.j(),r=h(t.g),n=r.next();!n.done;n=r.next())(n=n.value).endTime<e.start&&t.g.delete(n)})).Oa(2)}function sa(e){var t=this;this.m=e,this.j=new Map,this.g=function(){},this.h=function(){},this.i=function(){},this.o=[{rb:null,qb:ca,hb:function(e,r){return t.g(e,r)}},{rb:ua,qb:ca,hb:function(e,r){return t.g(e,r)}},{rb:la,qb:ca,hb:function(e,r){return t.g(e,r)}},{rb:ca,qb:ua,hb:function(e,r){return t.h(e,r)}},{rb:ca,qb:la,hb:function(e,r){return t.h(e,r)}},{rb:ua,qb:la,hb:function(e,r){return t.i(e,r)}},{rb:la,qb:ua,hb:function(e,r){return t.i(e,r)}}]}Yo.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.l=function(){},this.g=null},Jo.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},ta.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.g=null},ta.prototype.A=function(e){this.i=this.j?this.i:e},ta.prototype.l=function(){return(this.j?this.g.currentTime:this.i)||0},ta.prototype.C=function(){},ra.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.o&&(this.o.stop(),this.o=null),this.i=this.h=this.g=this.m=null,this.F=function(){}},ra.prototype.A=function(e){Zo(this.h,e)},ra.prototype.l=function(){var e=Xo(this.h);return 0<this.i.readyState&&!this.i.paused?oa(this,e):e},ra.prototype.C=function(){this.j.zd()},aa.prototype.release=function(){this.h=function(){},this.g.clear(),this.i.stop()},sa.prototype.release=function(){this.m=null,this.j.clear(),this.g=function(){},this.h=function(){},this.i=function(){}},sa.prototype.l=function(e,t){for(var r=h(this.m.g),n=r.next();!n.done;n=r.next()){n=n.value;var i=this.j.get(n),o=e<n.startTime?ua:e>n.endTime?la:ca;this.j.set(n,o);for(var a=h(this.o),s=a.next();!s.done;s=a.next())(s=s.value).rb==i&&s.qb==o&&s.hb(n,t)}};var ua=1,ca=2,la=3;function da(e,t){this.g=t,this.i=e,this.l=null,this.u=1,this.F=Promise.resolve(),this.m=[],this.o=new Map,this.h=new Map,this.C=!1,this.M=null,this.L=this.j=this.A=!1,this.J=0}function fa(e){return pa(e,"audio")}function ha(e){return pa(e,"video")}function pa(e,t){var r=e.h.get(t);return r?r.Ta||r.stream:null}function ga(e,t){return g((function r(){var n,i,o,a,s,u,c,l,d;return M(r,(function(r){switch(r.s){case 1:return n=pe,$(r,Or(e.g.T,n.za),2);case 2:return e.J++,e.L=!1,i=e.J,o=e.g.T,a=new Map,s=new Set,a.set(n.za,t),s.add(t),$(r,o.init(a,!1),3);case 3:return e.j?r.return():$(r,Sa(e,s),4);case 4:if(e.j)return r.return();u=e.g.T.l.isTextVisible()||e.l.alwaysStreamText,e.J!=i||e.h.has(n.za)||e.L||!u||(c=e.g.eb(),l=Pa(e,c),d=Aa(t,l,0),e.h.set(n.za,d),La(e,d,0)),w(r)}}))}))}function ya(e,t){var r=e.h.get("video");if(r){var n=r.stream;if(n)if(X.debug("setTrickPlay",t),t){var i=n.trickModeVideo;i&&!r.Ta&&(X.debug("Engaging trick mode stream",i),ma(e,i,!1,0,!1),r.Ta=n)}else(n=r.Ta)&&(X.debug("Restoring non-trick-mode stream",n),r.Ta=null,ma(e,n,!0,0,!1))}}function va(e,t,r,n){var i=!1;if(t.video){var o=ma(e,t.video,r,n,!1);i=i||o}return t.audio&&(e=ma(e,t.audio,r,n,!1),i=i||e),i}function ma(e,t,r,n,i){var o=e.h.get(t.type);if(!o&&"text"==t.type&&e.l.ignoreTextStreamFailures)return ga(e,t),!0;if(!o)return!1;var a=Ra(e,t),s=Array.from(e.h.values()).every((function(e){return e.oa==o.oa}));return r&&a!=o.oa&&s?(X.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),e.h.forEach((function(t){_a(e,t)})),!0):(o.Ta&&(X.debug("switch during trick play mode",t),t.trickModeVideo?(o.Ta=t,t=t.trickModeVideo,X.debug("switch found trick play stream",t)):(o.Ta=null,X.debug("switch found no special trick play stream"))),!(!(s=e.m[a])||!s.Rb)&&(!(!(s=e.o.get(t.id))||!s.Rb)&&(o.stream!=t||i?("text"==t.type&&Sr(e.g.T,lt(t.mimeType,t.codecs)),o.stream=t,o.Ac=!0,X.debug("switch: switching to Stream "+Ua(o)),function(e,t,r){if(!t.lb)return!1;var n=e.g.eb(),i=wr(e.g.T,t.type),o=wa(e,t,n,i,r);return r=o&&o.g?o.g-o.h:null,o&&!r&&(r=(o.endTime-o.xc())*t.stream.bandwidth/8),!isNaN(r)&&((o=t.stream.initSegmentReference)&&(r+=(o.g?o.g-o.h:null)||0),o=e.g.getBandwidthEstimate(),8*r/o<i-n-Math.max(e.i.minBufferTime||0,e.l.rebufferingGoal)||t.lb.h.g>r)}(e,o,a)&&(X.info("Aborting current segment request to switch."),o.lb.abort()),r&&(o.ab?o.Qc=!0:o.Sa?(o.Wa=!0,o.oc=n,o.Qc=!0):(Na(o),Da(e,o,!0,n).catch((function(t){e.g&&e.g.onError(t)})))),!0):(X.debug("switch: Stream "+Ua(o)+" already active"),!1))))}function _a(e,t){var r=Ua(t);t.ab?X.debug(r,"clear: already clearing the buffer"):t.Wa?X.debug(r,"clear: already waiting"):t.Sa?(X.debug(r,"clear: currently updating"),t.Wa=!0,t.oc=0):null==$r(e.g.T,t.type)?(X.debug(r,"clear: nothing buffered"),null==t.Pa&&La(e,t,0)):(X.debug(r,"clear: handling right now"),Na(t),Da(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)})))}function ba(e,t,r,n,i){return g((function o(){var a,s,u,c,l,d,f;return M(o,(function(o){switch(o.s){case 1:return a=e.g.eb(),s=Pa(e,a),u=pe,c=new Map,l=new Set,t&&(c.set(u.Sb,t),l.add(t)),r&&(c.set(u.Za,r),l.add(r)),n&&(c.set(u.za,n),l.add(n)),d=e.g.T,f=e.l.forceTransmuxTS,$(o,d.init(c,f),2);case 2:return e.j?o.return():(function(e){var t=e.i.presentationTimeline.ha();1/0>t?e.g.T.Fa(t):e.g.T.Fa(Math.pow(2,32))}(e),$(o,Sa(e,l),3));case 3:if(e.j)return o.return();c.forEach((function(t,r){if(!e.h.has(r)){var n=Aa(t,s,i);e.h.set(r,n),La(e,n,0)}})),w(o)}}))}))}function Aa(e,t,r){return{stream:e,type:e.type,Hb:null,La:null,Ta:null,Ac:!0,oa:t,endOfStream:!1,Sa:!1,Pa:null,Wa:!1,oc:0,Qc:!1,ab:!1,Ed:!1,ac:!1,Hd:r||0,lb:null}}function Ea(e,t){var r=e.m[t];if(r)return X.debug("(all) Period "+t+" is being or has been set up"),r.promise;X.debug("(all) setting up Period "+t),r={promise:new ye,Rb:!1},e.m[t]=r;for(var n=new Set,i=h(e.i.periods[t].variants),o=i.next();!o.done;o=i.next())(o=o.value).video&&n.add(o.video),o.video&&o.video.trickModeVideo&&n.add(o.video.trickModeVideo),o.audio&&n.add(o.audio);for(o=(i=h(e.i.periods[t].textStreams)).next();!o.done;o=i.next())n.add(o.value);return e.F=e.F.then(function(){if(!this.j)return Sa(this,n)}.bind(e)).then(function(){this.j||(this.m[t].promise.resolve(),this.m[t].Rb=!0,X.K("(all) setup Period "+t))}.bind(e)).catch(function(e){this.j||(this.m[t].promise.catch((function(){})),this.m[t].promise.reject(),delete this.m[t],X.v("(all) failed to setup Period "+t),this.g.onError(e))}.bind(e)),r.promise}function Sa(e,t){return g((function r(){var n,i,o,a,s,u,c;return M(r,(function(r){switch(r.s){case 1:n=[];for(var l=h(t),d=l.next();!d.done;d=l.next())i=d.value,(o=e.o.get(i.id))?(X.debug("(all) Stream "+i.id+" is being or has been set up"),n.push(o.promise)):(X.K("(all) setting up Stream "+i.id),e.o.set(i.id,{promise:new ye,Rb:!1}),n.push(i.createSegmentIndex()));return C(r,2),$(r,Promise.all(n),4);case 4:if(e.j)return r.return();k(r,3);break;case 2:if(a=O(r),e.j)return r.return();for(d=(r=h(t)).next();!d.done;d=r.next())s=d.value,e.o.get(s.id).promise.catch((function(){})),e.o.get(s.id).promise.reject(),e.o.delete(s.id);throw a;case 3:for(d=(l=h(t)).next();!d.done;d=l.next())u=d.value,(c=e.o.get(u.id)).Rb||(c.promise.resolve(),c.Rb=!0,X.K("(all) setup Stream "+u.id));w(r)}}))}))}function Ta(t,r){if(!t.j){var n=Ua(r);if(!r.Sa&&null!=r.Pa&&!r.ab)if(r.Pa=null,r.Wa)X.debug(n,"skipping update and clearing the buffer"),Da(t,r,r.Qc,r.oc);else{try{var i=function(e,t){if(ka(t))return kr(e.g.T,t.stream.originalId||""),null;var r=Ua(t),n=e.g.eb(),i=$a(e,t,n);X.O(r,"timeNeeded="+i);var o=Ra(e,t.stream),a=Pa(e,i),s=function(e,t,r){return"text"==t?null==(e=e.g).h||e.h<r?0:e.h-Math.max(r,e.g):Zt(e=Cr(e,t),r)}(e.g.T,t.type,n);X.O(r,"update_:","presentationTime="+n,"bufferedAhead="+s);var u=Math.max(e.i.minBufferTime||0,e.l.rebufferingGoal,e.l.bufferingGoal)*e.u;if(i>=e.i.presentationTimeline.ha())return X.debug(r,"buffered to end of presentation"),t.endOfStream=!0,"video"==t.type&&(i=e.h.get("text"))&&"application/cea-608"==i.stream.mimeType&&(i.endOfStream=!0),null;if(t.endOfStream=!1,t.oa=a,a!=o)return X.debug(r,"need Period "+a,"presentationTime="+n,"timeNeeded="+i,"currentPeriodIndex="+o),null;if(s>=u)return X.O(r,"buffering goal met"),.5;if(r=wr(e.g.T,t.type),!(r=wa(e,t,n,r,o)))return 1;var c=1/0;return Array.from(e.h.values()).forEach((function(t){ka(t)||(t=$a(e,t,n),c=Math.min(c,t))})),i>=c+e.i.presentationTimeline.g?1:(t.Hd=0,function(e,t,r,n,i){var o=Ua(t),a=e.i.periods[n];X.K(o,"fetchAndAppend_:","presentationTime="+r,"currentPeriod.startTime="+a.startTime,"reference.position="+i.position,"reference.startTime="+i.startTime,"reference.endTime="+i.endTime);var s=t.stream,u=e.i.presentationTimeline.ha(),c=e.i.periods[n+1];n=function(e,t,r,n,i){if(!t.Ac)return Promise.resolve();var o=Ua(t);return r=e.i.periods[r].startTime-t.stream.presentationTimeOffset,X.K(o,"setting timestamp offset to "+r),X.K(o,"setting append window start to "+n),X.K(o,"setting append window end to "+i),n=function(e,t,r,n,i){return"text"==t?(e.g.A=r,(e=e.g).j=n,e.m=i,Promise.resolve()):Promise.all([Pr(e,t,e.Ve.bind(e,t)),Pr(e,t,e.Cg.bind(e,t,r)),Pr(e,t,e.zg.bind(e,t,n,i))])}(e.g.T,t.type,r,n,i),t.stream.initSegmentReference?(X.K(o,"fetching init segment"),e=xa(e,t,t.stream.initSegmentReference).then(function(e){if(!this.j)return X.K(o,"appending init segment"),Ir(this.g.T,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch((function(e){return t.Ac=!0,Promise.reject(e)})),Promise.all([n,e])):n}(e,t,n,Math.max(0,a.startTime-.1),c?c.startTime+.01:u),t.Sa=!0,t.Ac=!1,X.O(o,"fetching segment"),u=xa(e,t,i),Promise.all([n,u]).then(function(e){if(!this.j&&!this.A)return function(e,t,r,n,i,o,a){var s=Ua(t),u=i.closedCaptions&&0<i.closedCaptions.size;return null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length&&(new Bn).ma("emsg",e.P.bind(e,n,o,i.emsgSchemeIdUris)).parse(a),function(e,t,r){var n=Ua(t);X.O(n,"checking buffer length");var i=Math.max(e.l.bufferBehind,e.i.presentationTimeline.g),o=$r(e.g.T,t.type);if(null==o)return X.O(n,"buffer behind okay because nothing buffered:","presentationTime="+r,"bufferBehind="+i),Promise.resolve();var a=r-o,s=a-i;return.01>=s?(X.O(n,"buffer behind okay:","presentationTime="+r,"bufferedBehind="+a,"bufferBehind="+i,"underflow="+Math.abs(s)),Promise.resolve()):(X.K(n,"buffer behind too large:","presentationTime="+r,"bufferedBehind="+a,"bufferBehind="+i,"overflow="+s),e.g.T.remove(t.type,o,o+s).then(function(){this.j||X.K(n,"evicted "+s+" seconds")}.bind(e)))}(e,t,r).then(function(){if(!this.j)return X.K(s,"appending media segment"),Ir(this.g.T,t.type,a,o.startTime+n.startTime,o.endTime+n.startTime,u)}.bind(e)).then(function(){if(!this.j)return X.O(s,"appended media segment"),t.Hb=i,t.La=o,Promise.resolve()}.bind(e))}(this,t,r,a,s,i,e[1])}.bind(e)).then(function(){this.j||this.A||(t.Sa=!1,t.Ed=!1,t.Wa||this.g.zd(),La(this,t,0),function(e,t,r){if(!e.C){var n=Ua(t);if(1==(t=Array.from(e.h.values())).length&&"text"==t[0].type||(e.C=t.every((function(e){return"text"==e.type||!e.Wa&&!e.ab&&e.La}))),e.C){for(X.debug(n,"startup complete"),r=Ra(e,r),e.m[r]||Ea(e,r).then(function(){this.j||(X.K(n,"calling onCanSwitch()..."),this.g.te())}.bind(e)).catch(de.Bc),r=0;r<e.i.periods.length;++r)Ea(e,r).catch(de.Bc);e.g.gg&&(X.K(n,"calling onStartupComplete()..."),e.g.gg())}}}(this,t,s),X.K(o,"finished fetch and append"))}.bind(e)).catch(function(e){this.j||this.A||(t.Sa=!1,"text"==t.type&&this.l.ignoreTextStreamFailures?(1001==e.code?X.v(o,"Text stream failed to download. Proceeding without it."):X.v(o,"Text stream failed to parse. Proceeding without it."),this.h.delete("text")):7001==e.code?(t.Sa=!1,t.Pa=null,La(this,t,0)):3017==e.code?function(e,t,r){var n=Ua(t);if(Array.from(e.h.values()).some((function(e){return e!=t&&e.Ed})))X.debug(n,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var i=Math.round(100*e.u);if(20<i)e.u-=.2;else{if(!(4<i))return X.error(n,"MediaSource threw QuotaExceededError too many times"),t.ac=!0,e.A=!0,void e.g.onError(r);e.u-=.04}X.v(n,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.u))+"%"),t.Ed=!0}La(e,t,4)}(this,t,e):(X.error(o,"failed fetch and append: code="+e.code),t.ac=!0,e.severity=2,Ba(this,e)))}.bind(e))}(e,t,n,o,r),null)}(t,r);null!=i&&(La(t,r,i),r.ac=!1)}catch(e){return void Ba(t,e)}i=Array.from(t.h.values()),function(e,t){var r=Ua(t),n=Ra(e,t.stream);if(t.oa!=n){var i=t.oa,o=Array.from(e.h.values());o.every((function(e){return e.oa==i||ka(e)}))?o.every(Oa)?(X.debug(r,"all need Period "+i),Ea(e,i).then(function(){if(!this.j)if(o.every(function(e){var t=Oa(e),r=Ra(this,e.stream);return!!ka(e)||t&&e.oa==i&&r!=i}.bind(this))){var e=this.i.periods[i];X.K(r,"calling onChooseStreams()...");var t=this.g.ue(e),n=new Map;t.variant&&t.variant.video&&n.set("video",t.variant.video),t.variant&&t.variant.audio&&n.set("audio",t.variant.audio),t.text&&n.set("text",t.text);for(var a=(t=h(this.h.keys())).next();!a.done;a=t.next())if(a=a.value,!n.has(a)&&"text"!=a)return X.error(r,"invalid Streams chosen: missing "+a+" Stream"),void this.g.onError(new Z(2,5,5005));for(a=(t=h(Array.from(n.keys()))).next();!a.done;a=t.next())if(a=a.value,!this.h.has(a)){if("text"!=a)return X.error(r,"invalid Streams chosen: unusable "+a+" Stream"),void this.g.onError(new Z(2,5,5005));ba(this,null,null,n.get("text"),e.startTime),n.delete(a)}for(a=(t=h(Array.from(this.h.keys()))).next();!a.done;a=t.next()){a=a.value;var s=this.h.get(a),u=n.get(a);if(u){var c=ka(s);c&&(s.oa=i,s.Hd=e.startTime),ma(this,u,!1,0,!1),c&&ka(s)||La(this,this.h.get(a),0)}else this.h.delete(a)}X.K(r,"calling onCanSwitch()..."),this.g.te()}else X.debug(r,"ignoring transition to Period",i,"since another is happening")}.bind(e)).catch(de.Bc)):X.debug(r,"all MediaStates need Period "+i+", but not all MediaStates are idle"):X.debug(r,"not all MediaStates need Period "+i)}}(t,r),t.C&&i.every((function(e){return e.endOfStream}))&&(X.K(n,"calling endOfStream()..."),t.g.T.endOfStream().then(function(){if(!this.j){var e=this.g.T.ha();0!=e&&e<this.i.presentationTimeline.ha()&&this.i.presentationTimeline.Fa(e)}}.bind(t)))}}}function $a(e,t,r){return t.Hb&&t.La?(r=Ra(e,t.Hb),e.i.periods[r].startTime+t.La.endTime):Math.max(r,t.Hd)}function wa(e,t,r,n,i){var o=Ua(t);return t.La&&t.stream==t.Hb?(n=t.La.position+1,X.O(o,"next position known:","position="+n),Ia(e,t,i,n)):(t.La?(X.K(o,"next position unknown: another Stream buffered"),o=Ra(e,t.Hb),o=Ca(e,t,e.i.periods[o].startTime+t.La.endTime,i)):(X.K(o,"next position unknown: nothing buffered"),o=Ca(e,t,n||r,i)),null==o?null:(r=null,null==n&&(r=Ia(e,t,i,Math.max(0,o-1))),r||Ia(e,t,i,o)))}function Ca(e,t,r,n){var i=Ua(t);return e=e.i.periods[n],X.debug(i,"looking up segment:","presentationTime="+r,"currentPeriod.startTime="+e.startTime),r=Math.max(0,r-e.startTime),null==(t=t.stream.findSegmentPosition(r))&&X.v(i,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+r),t}function Ia(e,t,r,n){var i=Ua(t);return r=e.i.periods[r],(t=t.stream.getSegmentReference(n))?(e=(n=e.i.presentationTimeline).$b(),n=n.Db(),r.startTime+t.endTime<e||r.startTime+t.startTime>n?(X.O(i,"segment is not available:","currentPeriod.startTime="+r.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+n),null):t):(X.K(i,"segment does not exist:","currentPeriod.startTime="+r.startTime,"position="+n),null)}function ka(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function Oa(e){return!e.Sa&&null==e.Pa&&!e.Wa&&!e.ab}function Pa(e,t){var r=Vo(e.i.periods,t+ge);return r?e.i.periods.indexOf(r):0}function Ra(e,t){for(var r=e.i.periods,n=0;n<r.length;n++){for(var i=r[n],o=new Set,a=h(i.variants),s=a.next();!s.done;s=a.next())(s=s.value).audio&&o.add(s.audio),s.video&&o.add(s.video),s.video&&s.video.trickModeVideo&&o.add(s.video.trickModeVideo);for(a=(i=h(i.textStreams)).next();!a.done;a=i.next())o.add(a.value);if(o.has(t))return n}return-1}function xa(e,t,r){var n=Ti(r.i(),r.h,r.g,e.l.retryParameters);return X.O("fetching: reference=",r),e=e.g.Ib.request(1,n),t.lb=e,e.promise.then((function(e){return t.lb=null,e.data}))}function Da(e,t,r,n){return g((function i(){var o,a,s,u;return M(i,(function(i){switch(i.s){case 1:return o=Ua(t),t.Wa=!1,t.Qc=!1,t.oc=0,t.ab=!0,t.Hb=null,t.La=null,X.debug(o,"clearing buffer"),n?(s=e.g.eb(),u=e.g.T.ha(),a=e.g.T.remove(t.type,s+n,u)):a=Or(e.g.T,t.type).then(function(){if(!this.j&&r)return this.g.T.flush(t.type)}.bind(e)),$(i,a,2);case 2:if(e.j)return i.return();X.debug(o,"cleared buffer"),t.ab=!1,t.endOfStream=!1,La(e,t,0),w(i)}}))}))}function La(e,t,r){var n=Ua(t),i=t.type;"text"!=i||e.h.has(i)?(X.O(n,"updating in "+r+" seconds"),t.Pa=new Ie((function(){return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return C(r,2),$(r,Ta(e,t),4);case 4:k(r,0);break;case 2:n=O(r),e.g&&e.g.onError(n),w(r)}}))}))})).V(r)):X.K(n,"Text stream is unloaded. No update is needed.")}function Na(e){null!=e.Pa&&(e.Pa.stop(),e.Pa=null)}function Ma(e){return g((function t(){return M(t,(function(t){if(1===t.s){if(e.lb)return $(t,e.lb.abort(),0);t.I(0)}}))}))}function Ba(e,t){Pe(e.M).then(function(){this.j||(this.g.onError(t),t.handled||this.l.failureCallback(t))}.bind(e))}function Ua(e){return"("+e.type+":"+e.stream.id+")"}function ja(e,t,r,n,i,o){if(200<=r&&299>=r&&202!=r)return{uri:i||n,Bd:n,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=_e(t)}catch(a){}throw X.debug("HTTP error text:",i),new Z(401==r||403==r?2:1,1,1001,n,r,i,e,o)}function Fa(e,t,r,n){var i=new Fa.h;ut(t.headers).forEach((function(e,t){i.append(t,e)}));var o=new Fa.g,a={Zd:!1,Oe:!1};if(e=new Re(e=Fa.u(e,r,{body:t.body||void 0,headers:i,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},a,n),(function(){return a.Zd=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var s=new ke((function(){a.Oe=!0,o.abort()}));s.V(t/1e3),e.finally((function(){s.stop()}))}return e}function Va(e,t,r,n){var i=new Va.j,o=Date.now(),a=0;return new Re(new Promise((function(s,u){for(var c in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new Z(1,1,7001,e,r))},i.onload=function(t){for(var n=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),i={},o=(n=h(n)).next();!o.done;o=n.next())i[(o=o.value.split(": "))[0].toLowerCase()]=o.slice(1).join(": ");try{var a=ja(i,t.response,t.status,e,t.responseURL,r);s(a)}catch(c){u(c)}},i.onerror=function(t){u(new Z(1,1,1002,e,t,r))},i.ontimeout=function(){u(new Z(1,1,1003,e,r))},i.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(n(t-o,e.loaded-a,e.total-e.loaded),a=e.loaded,o=t)},t.headers)i.setRequestHeader(c.toLowerCase(),t.headers[c]);i.send(t.body)})),(function(){return i.abort(),Promise.resolve()}))}function Ga(){this.g=this.j=this.h=0,this.i=new Map,this.l=0}function Ha(e,t,r){this.m=e,this.h=new Map,this.i=!1,this.l=t,this.j=r,this.g=new Ga}function Ka(e,t,r,n,i,o){var a=function(e,t){e.h+=t;var r=e.l;return e.l++,e.i.set(r,t),r}(e.g,n);n=e.h.get(t)||Promise.resolve(),e.h.set(t,n.then((function(){return g((function t(){var n,s,u,c,l,d;return M(t,(function(t){switch(t.s){case 1:return $(t,function(e,t){return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return $(r,e.m.request(1,t).promise,2);case 2:return n=r.B,r.return(n.data)}}))}))}(e,r),2);case 2:if(n=t.B,e.i)throw new Z(2,9,7001);if(i)for(var f in s=new Uint8Array(n),(u=new Kn(s)).data)c=Number(f),l=u.data[c],d=u.g[c],e.j(l,d);return e.g.close(a,n.byteLength),f=e.g,e.l(0==f.h?0:f.j/f.h,e.g.g),t.return(o(n))}}))}))})))}function za(e,t){var r=this;this.i=e,this.h=e.objectStore(t),this.g=new ye,e.onabort=function(e){e.preventDefault(),r.g.reject()},e.onerror=function(e){e.preventDefault(),r.g.reject()},e.oncomplete=function(){r.g.resolve()}}function Wa(e,t){return new Promise((function(r,n){var i=e.h.openCursor();i.onerror=n,i.onsuccess=function(e){if(!(e=e.target.result))return r();t(e.key,e.value,e),e.continue()}}))}function Ya(e){this.h=e,this.g=[]}function Xa(e,t){return Za(e,t,"readwrite")}function Za(e,t,r){var n=new za(r=e.h.transaction([t],r),t);return e.g.push(n),n.promise().then((function(){Ge(e.g,n)}),(function(){Ge(e.g,n)})),n}function qa(e,t,r){this.h=new Ya(e),this.i=t,this.g=r}function Qa(e){return Promise.reject(new Z(2,9,9011,"Cannot add new value to "+e))}function Ja(e,t,r,n){t=(e=Xa(e.h,t)).store();for(var i={},o=(r=h(r)).next();!o.done;i={key:i.key},o=r.next())i.key=o.value,t.delete(i.key).onsuccess=function(e){return function(){return n(e.key)}}(i);return e.promise()}function es(e,t,r){return g((function n(){var i,o,a,s,u,c,l;return M(n,(function(n){switch(n.s){case 1:for(i=Za(e.h,t,"readonly"),o=i.store(),a={},s=[],u={},c=h(r),l=c.next();!l.done;u={request:u.request,key:u.key},l=c.next())u.key=l.value,u.request=o.get(u.key),u.request.onsuccess=function(e){return function(){null==e.request.result&&s.push(e.key),a[e.key]=e.request.result}}(u);return $(n,i.promise(),2);case 2:if(s.length)throw new Z(2,9,9012,"Could not find values for "+s);return n.return(r.map((function(e){return a[e]})))}}))}))}function ts(e){this.g=new Ya(e)}function rs(){this.g=new Map}function ns(e,t,r){if(!(e=e.g.get(t)))throw new Z(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(r)))throw new Z(2,9,9013,"Could not find cell with name "+r);return t}function is(e,t){os.set(e,t)}da.prototype.destroy=function(){var e=this;return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:r=[];for(var i=h(e.h.values()),o=i.next();!o.done;o=i.next())Na(n=o.value),r.push(Ma(n));return $(t,Promise.all(r),2);case 2:e.h.clear(),e.o.clear(),e.g=null,e.i=null,e.F=null,e.m=null,e.l=null,e.j=!0,w(t)}}))}))},da.prototype.configure=function(e){this.l=e,this.M=new Oe({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},da.prototype.start=function(){var e=this;return g((function t(){var r,n,i;return M(t,(function(t){switch(t.s){case 1:return r=e.g.eb(),n=Pa(e,r),(i=e.g.ue(e.i.periods[n])).variant||i.text?$(t,ba(e,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,r),2):(X.error("init: no Streams chosen"),t.return(new Z(2,5,5005)));case 2:if(e.j)return t.return();X.debug("init: completed initial Stream setup"),e.g&&e.g.Yf&&(X.K("init: calling onInitialStreamsSetup()..."),e.g.Yf()),w(t)}}))}))},da.prototype.P=function(e,t,r,n){var i=n.reader.Cd(),o=n.reader.Cd(),a=n.reader.N(),s=n.reader.N(),u=n.reader.N(),c=n.reader.N();n=n.reader.mb(n.reader.S.byteLength-n.reader.ka()),e=e.startTime+t.startTime+s/a,r.includes(i)&&("urn:mpeg:dash:event:2012"==i?this.g.Zf():this.g.onEvent(new Be("emsg",{detail:{startTime:e,endTime:e+u/a,schemeIdUri:i,value:o,timescale:a,presentationTimeDelta:s,eventDuration:u,id:c,messageData:n}})))},G("shaka.net.HttpFetchPlugin",Fa),Fa.u=function(e,t,r,n,i){return g((function o(){var a,s,u,c,l,d,f,h,p,y,v,m;return M(o,(function(o){switch(o.s){case 1:return a=Fa.l,s=Fa.i,d=l=0,f=Date.now(),C(o,2),$(o,a(e,r),4);case 4:return u=o.B,h=u.clone().body.getReader(),y=(p=u.headers.get("Content-Length"))?parseInt(p,10):0,new s({start:function(e){!function t(){return g((function r(){var n,o,a;return M(r,(function(r){switch(r.s){case 1:return C(r,2),$(r,h.read(),4);case 4:n=r.B,k(r,3);break;case 2:return o=O(r),X.K("error reading from stream",o.message),r.return();case 3:n.done||(l+=n.value.byteLength),(100<(a=Date.now())-f||n.done)&&(i(a-f,l-d,y-l),d=l,f=a),n.done?e.close():(e.enqueue(n.value),t()),w(r)}}))}))}()}}),$(o,u.arrayBuffer(),5);case 5:c=o.B,k(o,3);break;case 2:if(v=O(o),n.Zd)throw new Z(1,1,7001,e,t);if(n.Oe)throw new Z(1,1,1003,e,t);throw new Z(1,1,1002,e,v,t);case 3:return m={},u.headers.forEach((function(e,t){m[t.trim()]=e})),o.return(ja(m,c,u.status,e,u.url,t))}}))}))},Fa.isSupported=function(){if(!t.ReadableStream)return!1;try{new ReadableStream({})}catch(u){return!1}return!(!t.fetch||!t.AbortController)},Fa.isSupported=Fa.isSupported,Fa.l=t.fetch,Fa.g=t.AbortController,Fa.i=t.ReadableStream,Fa.h=t.Headers,Fa.isSupported()&&(Xe("http",Fa,2),Xe("https",Fa,2)),G("shaka.net.HttpXHRPlugin",Va),Va.j=t.XMLHttpRequest,Xe("http",Va,1),Xe("https",Va,1),Ga.prototype.close=function(e,t){if(this.i.has(e)){var r=this.i.get(e);this.i.delete(e),this.j+=r,this.g+=t}},Ha.prototype.destroy=function(){return this.i=!0,Promise.all(this.h.values()).then((function(){}),(function(){}))},za.prototype.abort=function(){try{this.i.abort()}catch(u){}return this.g.catch((function(){}))},za.prototype.store=function(){return this.h},za.prototype.promise=function(){return this.g},Ya.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},(i=qa.prototype).destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return Qa(this.i)},i.removeSegments=function(e,t){return Ja(this,this.i,e,t)},i.getSegments=function(e){var t=this;return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return $(r,es(t,t.i,e),2);case 2:return n=r.B,r.return(n.map((function(e){return t.ae(e)})))}}))}))},i.addManifests=function(){return Qa(this.g)},i.updateManifestExpiration=function(e,t){var r=Xa(this.h,this.g),n=r.store();return n.get(e).onsuccess=function(r){(r=r.target.result)&&(r.expiration=t,n.put(r,e))},r.promise()},i.removeManifests=function(e,t){return Ja(this,this.g,e,t)},i.getManifests=function(e){var t=this;return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return $(r,es(t,t.g,e),2);case 2:return n=r.B,r.return(n.map((function(e){return t.pc(e)})))}}))}))},i.getAllManifests=function(){var e=this;return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return r=Za(e.h,e.g,"readonly"),n=new Map,$(t,Wa(r,(function(t,r){n.set(t,e.pc(r))})),2);case 2:return $(t,r.promise(),3);case 3:return t.return(n)}}))}))},i.ae=function(e){return e},i.pc=function(e){return e},i.add=function(e,t){var r=this;return g((function n(){var i,o,a,s;return M(n,(function(n){switch(n.s){case 1:i=Xa(r.h,e),o=i.store(),a=[];for(var u=h(t),c=u.next();!c.done;c=u.next())s=c.value,o.add(s).onsuccess=function(e){a.push(e.target.result)};return $(n,i.promise(),2);case 2:return n.return(a)}}))}))},ts.prototype.destroy=function(){return this.g.destroy()},ts.prototype.getAll=function(){var e=this;return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return r=Za(e.g,"session-ids","readonly"),n=[],$(t,Wa(r,(function(e,t){n.push(t)})),2);case 2:return $(t,r.promise(),3);case 3:return t.return(n)}}))}))},ts.prototype.add=function(e){for(var t=Xa(this.g,"session-ids"),r=t.store(),n=(e=h(e)).next();!n.done;n=e.next())r.add(n.value);return t.promise()},ts.prototype.remove=function(e){var t=this;return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return $(r,Wa(n=Xa(t.g,"session-ids"),(function(t,r,n){0<=e.indexOf(r.sessionId)&&n.delete()})),2);case 2:return $(r,n.promise(),0)}}))}))},rs.prototype.destroy=function(){for(var e=[],t=h(this.g.values()),r=t.next();!r.done;r=t.next())e.push(r.value.destroy());return this.g.clear(),Promise.all(e)},rs.prototype.init=function(){var e=this;os.forEach((function(t,r){var n=t();n?e.g.set(r,n):X.info("Skipping "+r+" as it is not supported on this platform")}));for(var t=[],r=h(this.g.values()),n=r.next();!n.done;n=r.next())t.push(n.value.init());return Promise.all(t)},rs.prototype.erase=function(){var e=this;return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return r=Array.from(e.g.values()),(n=0<r.length)||os.forEach((function(e){(e=e())&&r.push(e)})),$(t,Promise.all(r.map((function(e){return e.erase()}))),2);case 2:if(!n)return $(t,Promise.all(r.map((function(e){return e.destroy()}))),0);t.I(0)}}))}))},G("shaka.offline.StorageMuxer.register",is),G("shaka.offline.StorageMuxer.unregister",(function(e){os.delete(e)}));var os=new Map;function as(e){qa.apply(this,arguments)}function ss(e){return function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType})),r=e.streams.filter((function(e){return"video"==e.contentType}));if(!t.every((function(e){return e.variantIds}))||!r.every((function(e){return e.variantIds}))){t.forEach((function(e){e.variantIds=[]})),r.forEach((function(e){e.variantIds=[]}));var n=0;if(r.length&&!t.length){X.debug("Found video-only content. Creating variants for video.");var i=n++;r.forEach((function(e){e.variantIds.push(i)}))}if(!r.length&&t.length){X.debug("Found audio-only content. Creating variants for audio.");var o=n++;t.forEach((function(e){e.variantIds.push(o)}))}r.length&&t.length&&(X.debug("Found audio-video content. Creating variants."),t.forEach((function(e){r.forEach((function(t){var r=n++;e.variantIds.push(r),t.variantIds.push(r)}))})))}}(e),e.streams.forEach((function(){})),{startTime:e.startTime,streams:e.streams.map(us)}}function us(e){var t=e.initSegmentUri?ls(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(cs),variantIds:e.variantIds}}function cs(e){var t=ls(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ls(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Z(2,9,9004,"Could not parse uri "+e)}function ds(e,t,r,n){qa.call(this,e,t,r),this.j=n}function fs(){this.l=this.i=this.h=this.g=this.j=null}function hs(e,t,r,n){this.g=e,this.l=t,this.j=r,this.i=n,this.h=["offline:",e,"/",t,"/",r,"/",n].join("")}function ps(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var r=e[2];if(!r)return null;var n=e[3];return n&&null!=t?new hs(t,r,n,Number(e[4])):null}function gs(e,t){this.h=e,this.g=t}function ys(e,t,r){var n=t.streams.filter((function(e){return"audio"==e.contentType})),i=t.streams.filter((function(e){return"video"==e.contentType}));return n=function(e,t,r){for(var n=new Set,i=h(t),o=i.next();!o.done;o=i.next()){var a=h(o.value.variantIds);for(o=a.next();!o.done;o=a.next())n.add(o.value)}for(i=h(r),o=i.next();!o.done;o=i.next())for(o=(a=h(o.value.variantIds)).next();!o.done;o=a.next())n.add(o.value);for(i=new Map,n=h(n),o=n.next();!o.done;o=n.next())o=o.value,i.set(o,{id:o,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=h(t),n=t.next();!n.done;n=t.next())for(o=vs(e,n=n.value),n=(a=h(n.variantIds)).next();!n.done;n=a.next())(n=i.get(n.value)).language=o.language,n.primary=n.primary||o.primary,n.audio=o;for(r=h(r),t=r.next();!t.done;t=r.next())for(t=vs(e,n=t.value),n=(o=h(n.variantIds)).next();!n.done;n=o.next())(n=i.get(n.value)).primary=n.primary||t.primary,n.video=t;return i}(e,n,i),i=t.streams.filter((function(e){return"text"==e.contentType})).map((function(t){return vs(e,t)})),t.streams.forEach((function(n){n=n.segments.map((function(t,r){return ms(e,r,t)})),r.Jb(n,t.startTime)})),{startTime:t.startTime,variants:Array.from(n.values()),textStreams:i}}function vs(e,t){var r=t.segments.map((function(t,r){return ms(e,r,t)})),n=new ai(r);return r={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return n.find(e)},getSegmentReference:function(e){return n.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,pixelAspectRatio:t.pixelAspectRatio||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=t.initSegmentKey&&(r.initSegmentReference=function(e,t){var r=new hs("segment",e.h,e.g,t);return new ni((function(){return[r.toString()]}),0,null)}(e,t.initSegmentKey)),r}function ms(e,t,r){var n=new hs("segment",e.h,e.g,r.dataKey);return new ii(t,r.startTime,r.endTime,(function(){return[n.toString()]}),0,null)}function _s(){this.g=null}function bs(e){var t=ps(e);return t&&"manifest"==t.g?bs.m(e):t&&"segment"==t.g?bs.o(t.key(),t):xe(new Z(2,1,9004,e))}function As(e,t,r){return g((function n(){var i,o,a,s,u,c;return M(n,(function(n){switch(n.s){case 1:i=[];for(var l=[],d=h(r),f=d.next();!f.done;f=d.next()){f=f.value;for(var p=!1,y=h(l),v=y.next();!v.done;v=y.next())if(Es((v=v.value).info,f)){v.sessionIds.push(f.sessionId),p=!0;break}p||l.push({info:f,sessionIds:[f.sessionId]})}o=h(l),a=o.next();case 2:if(a.done){n.I(4);break}return s=a.value,u=function(e,t,r){return g((function n(){var i,o,a,s;return M(n,(function(n){switch(n.s){case 1:return i=new St({Ib:t,onError:function(){},Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),C(n,2),i.configure(e),$(n,function(e,t,r,n,i,o){var a=new Map;return a.set(t,{audioCapabilities:i,videoCapabilities:o,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:r,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:n,initData:null,keyIds:null}]}),xt(e,a)}(i,r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:k(n,3);break;case 2:return o=O(n),X.v("Error initializing EME",o),$(n,i.destroy(),5);case 5:case 9:return n.return([]);case 3:return C(n,6),$(n,wt(i),8);case 8:k(n,7);break;case 6:return a=O(n),X.v("Error setting server certificate",a),$(n,i.destroy(),9);case 7:return s=[],$(n,Promise.all(r.sessionIds.map((function(e){return g((function t(){var r;return M(t,(function(t){switch(t.s){case 1:return C(t,2),$(t,function(e,t){return g((function r(){var n,i,o;return M(r,(function(r){switch(r.s){case 1:return $(r,Dt(e,t),2);case 2:return(n=r.B)?(i=[],(o=e.h.get(n))&&(o.Ga=new ye,i.push(o.Ga)),X.O("Attempting to remove session",t),i.push(n.remove()),$(r,Promise.all(i),0)):(X.O("Ignoring attempt to remove missing session",t),r.return())}}))}))}(i,e),4);case 4:s.push(e),k(t,0);break;case 2:r=O(t),X.v("Error deleting offline session",r),w(t)}}))}))}))),10);case 10:return $(n,i.destroy(),11);case 11:return n.return(s)}}))}))}(e,t,s),$(n,u,5);case 5:c=n.B,i=i.concat(c),a=o.next(),n.I(2);break;case 4:return n.return(i)}}))}))}function Es(e,t){function r(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&He(e.audioCapabilities,t.audioCapabilities,r)&&He(e.videoCapabilities,t.videoCapabilities,r)}function Ss(e,t){var r={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},n=this;this.m=t,this.i=e,this.j=r,this.o=null,this.l=[],this.h=this.g=null,this.u=!0,this.A=Promise.resolve().then((function(){return function(e){return g((function t(){return M(t,(function(t){if(1===t.s){if(e.u){if(0==e.l.length||e.g&&!e.g.gb)var r=!1;else{e.g&&(e.g.Da.kb(),e.g=null);var n=(r=e.l.shift()).create(e.j);n?(r.Da.Kb(),e.g={node:n.node,payload:n.payload,gb:n.gb,Da:r.Da}):r.Da.Ec(),r=!0}return r?r=Promise.resolve():e.g?r=function(e){return g((function t(){var r,n;return M(t,(function(t){switch(t.s){case 1:return e.i=e.m.Af(e.i,e.j,e.g.node,e.g.payload),C(t,2),e.h=e.m.ef(e.i,e.j,e.g.payload),$(t,e.h.promise,4);case 4:e.h=null,e.i==e.g.node&&(e.g.Da.Cc(),e.g=null),k(t,0);break;case 2:return 7001==(r=O(t)).code?e.g.Da.kb():e.g.Da.onError(r),e.g=null,e.h=null,n=e,$(t,e.m.handleError(e.j,r),5);case 5:n.i=t.B,w(t)}}))}))}(e):(e.m.Xf(e.i),e.o=new ye,r=e.o),$(t,r,1)}t.I(0)}}))}))}(n)}))}function Ts(e,t){var r={Kb:function(){},Cc:function(){},kb:function(){},onError:function(){},Ec:function(){},$g:function(){}};return e.l.push({create:t,Da:r}),e.h&&e.h.abort(),$s(e),r}function $s(e){e.o&&(e.o.resolve(),e.o=null)}function ws(e){this.g=null;for(var t=0;t<e.textTracks.length;++t){var r=e.textTracks[t];r.mode="disabled","Shaka Player TextTrack"==r.label&&(this.g=r)}this.g||(this.g=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.g.mode="hidden"}function Cs(e){if(e.startTime>=e.endTime)return X.v("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(r){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Is(e,t){var r=e.mode;e.mode="showing"==r?"showing":"hidden";for(var n=e.cues,i=n.length-1;0<=i;i--){var o=n[i];o&&t(o)&&e.removeCue(o)}e.mode=r}function ks(e,t,r,n,i){var o,a=i in n,s=!0;for(o in t){var u=i+"."+o,c=a?n[i]:r[o];a||o in r?void 0===t[o]?void 0===c||a?delete e[o]:e[o]=Fe(c):c.constructor==Object&&t[o]&&t[o].constructor==Object?(e[o]||(e[o]=Fe(c)),u=ks(e[o],t[o],c,n,u),s=s&&u):_typeof$3(t[o])!=_typeof$3(c)||null==t[o]||"function"!=typeof t[o]&&t[o].constructor!=c.constructor?(X.kc("Invalid config, wrong type for "+u),s=!1):("function"==typeof r[o]&&r[o].length!=t[o].length&&X.ba("Unexpected number of arguments for "+u),e[o]=t[o]):(X.kc("Invalid config, unrecognized key "+u),s=!1)}return s}function Os(e,t){for(var r={},n=r,i=0,o=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(n[o=e.substring(o,i).replace(/\\\./g,".")]={},n=n[o],o=i+1),i+=1;return n[e.substring(o).replace(/\\\./g,".")]=t,r}function Ps(){}function Rs(){var e=5e5,t=1/0;navigator.connection&&(navigator.connection.downlink&&(e=1e6*navigator.connection.downlink),navigator.connection.saveData&&(t=360));var r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Lt,fairPlayTransform:!0,updateExpirationTime:1},n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(e){return X.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(_t("Web0S")||yt()||_t("CrKey"))&&(i.stallSkip=0);var o={trackSelectionCallback:function(e){return g((function t(){return M(t,(function(t){if(1===t.s)return t.return(e)}))}))},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},a={drm:r,manifest:n,streaming:i,offline:o,abrFactory:Fr,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return o.trackSelectionCallback=function(e){return g((function t(){return M(t,(function(t){if(1===t.s)return t.return(function(e,t){var r=e.filter((function(e){return"variant"==e.type})),n=[],i=Br(t,r.map((function(e){return e.language})));i&&(n=r.filter((function(e){return Nr(e.language)==i}))),0==n.length&&(n=r.filter((function(e){return e.primary}))),0==n.length&&(1<new Set(r.map((function(e){return e.language}))).size&&X.v("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),n=r);var o=n.filter((function(e){return e.height&&480>=e.height}));if(o.length&&(o.sort((function(e,t){return t.height-e.height})),n=o.filter((function(e){return e.height==o[0].height}))),r=[],n.length){var a=Math.floor(n.length/2);n.sort((function(e,t){return e.bandwidth-t.bandwidth})),r.push(n[a])}for(n=h(e),a=n.next();!a.done;a=n.next())"text"==(a=a.value).type&&r.push(a);return r}(e,a.preferredAudioLanguage))}))}))},a}function xs(e,t,r){var n={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return ks(e,t,r||Rs(),n,"")}function Ds(){this.g=null,this.h=[]}function Ls(e,t){if(null==e.g)e.g={timestamp:Date.now()/1e3,state:t,duration:0};else{var r=Date.now()/1e3;e.g.duration=r-e.g.timestamp,e.g.state!=t&&(e.h.push(e.g),e.g={timestamp:r,state:t,duration:0})}}function Ns(e,t){var r=0;e.g&&e.g.state==t&&(r+=e.g.duration);for(var n=h(e.h),i=n.next();!i.done;i=n.next())r+=(i=i.value).state==t?i.duration:0;return r}function Ms(){this.h=this.i=null,this.g=[]}function Bs(){this.j=this.C=this.m=this.h=this.o=this.u=this.A=this.l=this.F=NaN,this.g=new Ds,this.i=new Ms}function Us(e,r){var n=this;je.call(this),this.o=Iu,this.g=null,this.ub=!1,this.l=new tt,this.Uc=this.u=this.Tb=this.i=this.C=this.j=this.rc=this.L=this.ic=this.J=this.wb=this.A=this.M=this.m=this.X=null,this.re=1e9,this.lc=new Set,this.yb=!0,this.wa=null,this.qe=!1,this.oe=0,this.va=null,this.Z=new bo,this.h=qs(this),this.mc={width:1/0,height:1/0},this.F=null,this.tb=new ko(this.h.preferredAudioLanguage,this.h.preferredVariantRole,this.h.preferredAudioChannelCount),this.ua=this.h.preferredTextLanguage,this.Xa=this.h.preferredTextRole,this.Wc=[],r&&r(this),this.X=function(e){return new We((function(t,r){e.u&&e.u.segmentDownloaded(t,r)}))}(this),this.l.H(t,"online",(function(){n.Id()})),this.P={name:"detach"},this.da={name:"attach"},this.Qa={name:"unload"},this.nd={name:"manifest-parser"},this.md={name:"manifest"},this.vb={name:"media-source"},this.ad={name:"drm-engine"},this.ea={name:"load"},this.od={name:"src-equals-drm-engine"},this.xb={name:"src-equals"};var i=new Map;i.set(this.da,(function(e,t){return Ne(function(e,t,r){return null==t.D&&(t.D=r.D,e.l.H(t.D,"error",(function(){var t=pu(e);t&&e.Va(t)}))),e.g=t.D,Promise.resolve()}(n,e,t))})),i.set(this.P,(function(e){return e.D&&(n.l.ta(e.D,"error"),e.D=null),n.g=null,Ne(e=Promise.resolve())})),i.set(this.Qa,(function(e){return Ne(Gs(n,e))})),i.set(this.vb,(function(e){return e=function(e,r){return g((function n(){var i,o,a,s;return M(n,(function(n){switch(n.s){case 1:return i=t.muxjs?new zt:new Wt,o=e.h.textDisplayFactory,a=new o,e.fd=o,$(n,(s=new br(r.D,i,a)).C,2);case 2:e.M=s,w(n)}}))}))}(n,e),Ne(e)})),i.set(this.nd,(function(e,t){var r=function(e,t,r){return g((function n(){var i,o,a,s;return M(n,(function(n){switch(n.s){case 1:if(t.Ia=r.Ia,t.mimeType=r.mimeType,t.uri=r.uri,i=t.uri,o=e.X,e.Tb=i,t.Ia){e.C=t.Ia(),n.I(2);break}return a=e,$(n,Ei.create(i,o,e.h.manifest.retryParameters,t.mimeType),3);case 3:a.C=n.B;case 2:s=Fe(e.h.manifest),r.D&&"AUDIO"===r.D.nodeName&&(s.disableVideo=!0),e.C.configure(s),w(n)}}))}))}(n,e,t);return Ne(r)})),i.set(this.md,(function(e){return function(e,t){var r=t.uri,n=e.X;e.rc=new aa((function(){return e.He()})),function(e,t){e.h=t}(e.rc,(function(t){hu(e,"timelineregionadded",t)}));var i={networkingEngine:n,filterNewPeriod:function(t){return e.Xc(t)},filterAllPeriods:function(t){return Qs(e,t)},onTimelineRegionAdded:function(t){var r=e.rc;e:{for(var n=h(r.g),i=n.next();!i.done;i=n.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.id==t.id&&i.startTime==t.startTime&&i.endTime==t.endTime){n=i;break e}n=null}null==n&&(r.g.add(t),r.h(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Va(t)}};return new Re(Promise.resolve().then((function(){return g((function t(){var n;return M(t,(function(t){switch(t.s){case 1:return n=e,$(t,e.C.start(r,i),2);case 2:if(n.i=t.B,e.dispatchEvent(new Be("manifestparsed")),0==e.i.periods.length)throw new Z(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some((function(e){return e.variants.some(t)}))&&(X.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),e.forEach((function(e){e.variants=e.variants.filter(t)})))}(e.i.periods),w(t)}}))}))})),(function(){return X.info("Aborting parser step..."),e.C.stop()}))}(n,e)})),i.set(this.ad,(function(e){return e=function(e,t){return g((function r(){return M(r,(function(r){switch(r.s){case 1:return e.m=Hs(e,{Ib:e.X,onError:function(t){e.Va(t)},Dc:function(t){gu(e,t)},onExpirationUpdated:function(t,r){yu(e,t,r)},onEvent:function(t){e.dispatchEvent(t)}}),e.m.configure(e.h.drm),$(r,Tt(e.m,Fo(e.i.periods),e.i.offlineSessionIds),2);case 2:return $(r,e.m.Ub(t.D),3);case 3:Qs(e,e.i.periods),w(r)}}))}))}(n,e),Ne(e)})),i.set(this.ea,(function(e,t){return Ne(function(e,t,r){return g((function n(){var i,o,a,s,u,c,l,d,f,p;return M(n,(function(n){switch(n.s){case 1:return t.startTime=r.startTime,i=t.D,o=t.uri,e.Tb=o,e.J=new Ho({wc:function(){return t.D.playbackRate},vc:function(){return t.D.defaultPlaybackRate},Od:function(e){t.D.playbackRate=e},pe:function(e){t.D.currentTime+=e}}),e.F=new Bs,a=function(){return nu(e)},s=function(){return ru(e)},e.l.H(i,"playing",a),e.l.H(i,"pause",a),e.l.H(i,"ended",a),e.l.H(i,"ratechange",s),u=e.h.abrFactory,e.u&&e.Uc==u||(e.Uc=u,e.u=new u,e.u.configure(e.h.abr)),function(e,t){for(var r=0;r<t.length;r++){for(var n=t[r],i=new Map,o=h(n.variants),a=o.next();!a.done;a=o.next())if((a=a.value).video&&a.video.closedCaptions)for(var s=h((a=a.video).closedCaptions.keys()),u=s.next();!u.done;u=s.next())if(u=u.value,!i.has(u)){var c={id:e.re++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:a.closedCaptions.get(u),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:a.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};i.set(u,c)}for(o=(i=h(i.values())).next();!o.done;o=i.next())n.textStreams.push(o.value)}}(e,e.i.periods),e.tb=new ko(e.h.preferredAudioLanguage,e.h.preferredVariantRole,e.h.preferredAudioChannelCount),e.ua=e.h.preferredTextLanguage,e.Xa=e.h.preferredTextRole,function(e,t,r){0<t&&(e.aa()?X.v("|playRangeStart| has been configured for live content. Ignoring the setting."):e.Le(t)),r<e.ha()&&(e.aa()?X.v("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.Fa(r))}(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd),e.u.init((function(t,r,n){r=void 0!==r&&r,n=void 0===n?0:n,X.debug("switch_");e:{for(var i=h(e.i.periods),o=i.next();!o.done;o=i.next())if((o=o.value).variants.includes(t)){i=o;break e}i=null}Xs(e,i,t,!0),e.j&&va(e.j,t,r,n)&&su(e)})),e.A=function(e,t){return new ra(e.g,e.i,e.h.streaming,t,(function(){e.wb&&jo(e.wb,!0),e.j&&function(e){function t(t){var i=e.g.T;return t="text"==t?null!=(t=i.g).g&&null!=t.h&&r>=t.g&&r<t.h:Xt(t=Cr(i,t),r,n)}var r=e.g.eb(),n=e.l.smallGapLimit,i=!1,o=Pa(e,r);if(st(e.h.values(),(function(e){return e.oa==o})))for(var a=h(e.h.keys()),s=a.next();!s.done;s=a.next())t(s=s.value)||(_a(e,e.h.get(s)),i=!0);else st(e.h.keys(),t)||(X.debug("(all): seeked: unbuffered seek: clearing all buffers"),e.h.forEach((function(t){_a(e,t)})),i=!0);i||X.debug("(all): seeked: buffered seek: presentationTime="+r)}(e.j),e.L&&zs(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t.startTime),e.wb=function(e){var t=new Go(e.i);!function(e,t){e.h=t}(t,(function(){uu(e)}));var r=new sa(e.rc);!function(e,t,r,n){e.g=t,e.h=r,e.i=n}(r,(function(t){hu(e,"timelineregionenter",t)}),(function(t){hu(e,"timelineregionexit",t)}),(function(t,r){r||(hu(e,"timelineregionenter",t),hu(e,"timelineregionexit",t))}));var n=new Uo(e.g);return n.g.add(t),n.g.add(r),n}(e),c=Math.max(e.i.minBufferTime,e.h.streaming.rebufferingGoal),Ks(e,c),e.j=function(e){return new da(e.i,{eb:function(){return e.A.l()},getBandwidthEstimate:function(){return e.u.getBandwidthEstimate()},T:e.M,Ib:e.X,ue:e.Vf.bind(e),te:e.Ze.bind(e),onError:e.Va.bind(e),onEvent:function(t){return e.dispatchEvent(t)},Zf:e.$f.bind(e),zd:e.eg.bind(e)})}(e),e.j.configure(e.h.streaming),jr.$d(e.i,e.h.preferredAudioChannelCount),e.o=ku,e.dispatchEvent(new Be("streaming")),$(n,e.j.start(),2);case 2:e.h.streaming.startAtSegmentBoundary&&(l=e.A.l(),d=function(e,t){function r(e,t){if(!e)return null;var r=e.findSegmentPosition(t-o.startTime);return null==r?null:(r=e.getSegmentReference(r))?r.startTime+o.startTime:null}var n=fa(e.j),i=ha(e.j),o=Eu(e);return n=r(n,t),null!=(i=r(i,t))&&null!=n?Math.max(i,n):null!=i?i:null!=n?n:t}(e,l),e.A.A(d)),e.i.periods.forEach(e.Xc.bind(e)),uu(e),su(e),f=Eu(e)||e.i.periods[0],p=f.variants.some((function(e){return e.primary})),e.h.preferredAudioLanguage||p||X.v("No preferred audio language set.  We will choose an arbitrary language initially"),iu(e,f.variants),e.l.ya(i,"loadedmetadata",(function(){e.F.h=Date.now()/1e3-r.Rd})),w(n)}}))}))}(n,e,t))})),i.set(this.od,(function(e,t){var r=function(e,t,r){return g((function n(){var i,o;return M(n,(function(n){switch(n.s){case 1:return i=pe,e.m=Hs(e,{Ib:e.X,onError:function(t){e.Va(t)},Dc:function(t){gu(e,t)},onExpirationUpdated:function(t,r){yu(e,t,r)},onEvent:function(t){e.dispatchEvent(t)}}),e.m.configure(e.h.drm),o={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:r.mimeType?r.mimeType.split(";")[0]:"video/mp4",codecs:r.mimeType?dt(r.mimeType):"",encrypted:!0,keyId:null,language:"und",label:null,type:i.Za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},$(n,Tt(e.m,[o],[]),2);case 2:return $(n,e.m.Ub(t.D),0)}}))}))}(n,e,t);return Ne(r)})),i.set(this.xb,(function(e,t){return function(e,t,r){function n(){return nu(e)}if(t.uri=r.uri,t.startTime=r.startTime,e.Tb=t.uri,e.F=new Bs,e.A=new ta(t.D),null!=t.startTime&&e.A.A(t.startTime),e.J=new Ho({wc:function(){return t.D.playbackRate},vc:function(){return t.D.defaultPlaybackRate},Od:function(e){t.D.playbackRate=e},pe:function(e){t.D.currentTime+=e}}),Ks(e,e.h.streaming.rebufferingGoal),e.l.H(t.D,"playing",n),e.l.H(t.D,"pause",n),e.l.H(t.D,"ended",n),e.l.H(t.D,"ratechange",(function(){return ru(e)})),"none"!=e.g.preload&&e.l.ya(t.D,"loadedmetadata",(function(){e.F.h=Date.now()/1e3-r.Rd})),e.g.audioTracks&&(e.l.H(e.g.audioTracks,"addtrack",(function(){return uu(e)})),e.l.H(e.g.audioTracks,"removetrack",(function(){return uu(e)})),e.l.H(e.g.audioTracks,"change",(function(){return uu(e)}))),e.g.textTracks){var i=e.g.textTracks;e.l.H(i,"addtrack",(function(){return uu(e)})),e.l.H(i,"removetrack",(function(){return uu(e)})),e.l.H(i,"change",(function(){return uu(e)}))}t.D.src=t.uri,(yt()||_t("Web0S"))&&t.D.load(),e.o=Ou,e.dispatchEvent(new Be("streaming"));var o=new ye;zo(e.g,HTMLMediaElement.HAVE_METADATA,e.l,(function(){o.resolve()}));var a=!1;return e.Wc.push((function(){a=!0})),zo(e.g,HTMLMediaElement.HAVE_CURRENT_DATA,e.l,(function(){return g((function t(){return M(t,(function(t){switch(t.s){case 1:if(a)return t.return();if(function(e){var t=e.h.preferredAudioLanguage;if(""!=t){e.Jd(t);var r=e.h.preferredVariantRole;""!=r&&e.Jd(t,r)}}(e),Ys(e).find((function(e){return"disabled"!=e.mode}))){t.I(2);break}return $(t,new Promise((function(t){e.l.ya(e.g.textTracks,"change",t),new ke(t).V(1)})),2);case 2:if(a)return t.return();!function(e){var t=e.h.preferredTextLanguage;if(""!=t){e.Kd(t);var r=e.h.preferredTextRole;""!=r&&e.Kd(t,r)}}(e),w(t)}}))}))})),e.g.error?o.reject(pu(e)):"none"==e.g.preload&&(X.ba('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),o.resolve()),e.l.ya(e.g,"error",(function(){o.reject(pu(e))})),new Re(o,(function(){return o.reject(new Z(2,7,7001)),Promise.resolve()}))}(n,e,t)})),this.Ya=new Ss(this.P,{Af:function(e,t,r,i){var o=null;return e==n.P&&(o=r==n.P?n.P:n.da),e==n.da&&(o=r==n.P||t.D!=i.D?n.P:r==n.da?n.da:r==n.vb||r==n.ea?n.vb:r==n.xb?n.od:null),e==n.vb&&(o=r==n.ea&&t.D==i.D?n.nd:n.Qa),e==n.nd&&(o=$u(n.ea,n.md,n.Qa,r,t,i)),e==n.md&&(o=$u(n.ea,n.ad,n.Qa,r,t,i)),e==n.ad&&(o=$u(n.ea,n.ea,n.Qa,r,t,i)),e==n.od&&(o=r==n.xb&&t.D==i.D?n.xb:n.Qa),e!=n.ea&&e!=n.xb||(o=n.Qa),e==n.Qa&&(o=i.D&&t.D==i.D?n.da:n.P),o},ef:function(e,t,r){return n.dispatchEvent(new Be("onstatechange",{state:e.name})),i.get(e)(t,r)},handleError:function(e,t){return g((function r(){return M(r,(function(r){switch(r.s){case 1:return X.v("The walker saw an error:"),t instanceof Z?X.v("Error Code:",t.code):(X.v("Error Message:",t.message),X.v("Error Stack:",t.stack)),$(r,Gs(n,e),2);case 2:return r.return(e.D?n.da:n.P)}}))}))},Xf:function(e){n.dispatchEvent(new Be("onstateidle",{state:e.name}))}}),e&&this.Ub(e,!0)}A(as,qa),as.prototype.updateManifestExpiration=function(e,t){var r=Xa(this.h,this.g),n=r.store(),i=new ye;return n.get(e).onsuccess=function(r){(r=r.target.result)?(r.expiration=t,n.put(r),i.resolve()):i.reject(new Z(2,9,9012,"Could not find values for "+e))},r.promise().then((function(){return i}))},as.prototype.pc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(ss),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},as.prototype.ae=function(e){return{data:e.data}},A(ds,qa),ds.prototype.hasFixedKeySpace=function(){return this.j},ds.prototype.addSegments=function(e){return this.j?Qa(this.i):this.add(this.i,e)},ds.prototype.addManifests=function(e){return this.j?Qa(this.g):this.add(this.g,e)},ds.prototype.pc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(i=fs.prototype).init=function(){var e=this,r=new ye,n=t.indexedDB.open("shaka_offline_db",4);return n.onsuccess=function(t){t=t.target.result,e.j=t;var n=t.objectStoreNames;n.contains("manifest")&&n.contains("segment")?(X.debug("Mounting v1 idb storage cell"),n=new as(t,"segment","manifest")):n=null,e.g=n,(n=t.objectStoreNames).contains("manifest-v2")&&n.contains("segment-v2")?(X.debug("Mounting v2 idb storage cell"),n=new ds(t,"segment-v2","manifest-v2",!0)):n=null,e.h=n,(n=t.objectStoreNames).contains("manifest-v3")&&n.contains("segment-v3")?(X.debug("Mounting v3 idb storage cell"),n=new ds(t,"segment-v3","manifest-v3",!1)):n=null,e.i=n,t.objectStoreNames.contains("session-ids")?(X.debug("Mounting session ID idb storage cell"),t=new ts(t)):t=null,e.l=t,r.resolve()},n.onupgradeneeded=function(e){e=e.target.result;for(var t=h(["segment-v3","manifest-v3","session-ids"]),r=t.next();!r.done;r=t.next())r=r.value,e.objectStoreNames.contains(r)||e.createObjectStore(r,{autoIncrement:!0})},n.onerror=function(e){r.reject(new Z(2,9,9001,n.error)),e.preventDefault()},r},i.destroy=function(){var e=this;return g((function t(){return M(t,(function(t){switch(t.s){case 1:if(!e.g){t.I(2);break}return $(t,e.g.destroy(),2);case 2:if(!e.h){t.I(4);break}return $(t,e.h.destroy(),4);case 4:if(!e.i){t.I(6);break}return $(t,e.i.destroy(),6);case 6:if(!e.l){t.I(8);break}return $(t,e.l.destroy(),8);case 8:e.j&&e.j.close(),w(t)}}))}))},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),e},i.getEmeSessionCell=function(){return this.l},i.erase=function(){var e=this;return g((function r(){return M(r,(function(r){switch(r.s){case 1:if(!e.g){r.I(2);break}return $(r,e.g.destroy(),2);case 2:if(!e.h){r.I(4);break}return $(r,e.h.destroy(),4);case 4:if(!e.i){r.I(6);break}return $(r,e.i.destroy(),6);case 6:return e.j&&e.j.close(),$(r,function(){var e=new ye,r=t.indexedDB.deleteDatabase("shaka_offline_db");return r.onblocked=function(){X.v("Deleting","shaka_offline_db","is being blocked")},r.onsuccess=function(){e.resolve()},r.onerror=function(t){e.reject(new Z(2,9,9001,r.error)),t.preventDefault()},e}(),8);case 8:return e.j=null,e.g=null,e.h=null,e.i=null,$(r,e.init(),0)}}))}))},is("idb",(function(){return _t("CrKey")||!t.indexedDB?null:new fs})),hs.prototype.Ea=function(){return this.l},hs.prototype.ja=function(){return this.j},hs.prototype.key=function(){return this.i},hs.prototype.toString=function(){return this.h},(i=_s.prototype).configure=function(){},i.start=function(e){var t=this;return g((function r(){var n,i,o,a,s;return M(r,(function(r){switch(r.s){case 1:return n=ps(e),t.g=n,null==n||"manifest"!=n.g?r.return(Promise.reject(new Z(2,1,9004,n))):(i=new rs,I(r,2),$(r,i.init(),4));case 4:return $(r,ns(i,n.Ea(),n.ja()),5);case 5:return $(r,r.B.getManifests([n.key()]),6);case 6:return o=r.B,a=o[0],s=new gs(n.Ea(),n.ja()),r.return(function(e,t){var r=new Si(null,0);r.Fa(t.duration);var n=t.periods.map((function(t){return ys(e,t,r)})),i=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&n.forEach((function(e){e.variants.forEach((function(e){e.drmInfos=i}))})),{presentationTimeline:r,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:n}}(s,a));case 2:return P(r),$(r,i.destroy(),7);case 7:R(r,0)}}))}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var r=this;return g((function n(){var i,o,a,s,u,c,l,d;return M(n,(function(n){switch(n.s){case 1:return i=r.g,o=new rs,C(n,2,3),$(n,o.init(),5);case 5:return $(n,ns(o,i.Ea(),i.ja()),6);case 6:return $(n,(a=n.B).getManifests([i.key()]),7);case 7:if(s=n.B,u=s[0],c=u.sessionIds.includes(e),l=null==u.expiration||u.expiration>t,!c||!l){n.I(3);break}return X.debug("Updating expiration for stored content"),$(n,a.updateManifestExpiration(i.key(),t),3);case 3:return P(n),$(n,o.destroy(),10);case 10:R(n,0);break;case 2:d=O(n),X.error("There was an error updating",i,d),n.I(3)}}))}))},Ei.Qb("application/x-offline-manifest",_s),G("shaka.offline.OfflineScheme",bs),bs.m=function(e){return Le(e={uri:e,Bd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},bs.o=function(e,t){var r=new rs;return Le(void 0).ca((function(){return r.init()})).ca((function(){return ns(r,t.Ea(),t.ja())})).ca((function(e){return e.getSegments([t.key()])})).ca((function(e){return{uri:t,Bd:t,data:e[0].data,headers:{}}})).finally((function(){return r.destroy()}))},Xe("offline",bs),Ss.prototype.destroy=function(){var e=this;return g((function t(){return M(t,(function(t){switch(t.s){case 1:return e.u=!1,e.h&&e.h.abort(),$s(e),$(t,e.A,2);case 2:e.g&&e.g.Da.kb();for(var r=h(e.l),n=r.next();!n.done;n=r.next())n.value.Da.kb();e.g=null,e.l=[],e.m=null,w(t)}}))}))},G("shaka.text.SimpleTextDisplayer",ws),ws.prototype.remove=function(e,t){return!!this.g&&(Is(this.g,(function(r){return r.startTime<t&&r.endTime>e})),!0)},ws.prototype.remove=ws.prototype.remove,ws.prototype.append=function(e){var t=Cs,r=e.map((function(e){if(e.nestedCues.length){var t=e.nestedCues.map((function(e){return e.spacer?"\n":e.payload+" "})).join("").replace(/ $/m,"");(e=e.clone()).nestedCues=[],e.payload=t}return e})),n=[];e=this.g.cues?Array.from(this.g.cues):[];for(var i={},o=(r=h(r)).next();!o.done;i={Fb:i.Fb},o=r.next())i.Fb=o.value,e.some(function(e){return function(t){return t.startTime==e.Fb.startTime&&t.endTime==e.Fb.endTime&&t.text==e.Fb.payload}}(i))||(o=t(i.Fb))&&n.push(o);n.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?n.indexOf(t)-n.indexOf(e):n.indexOf(e)-n.indexOf(t)})).forEach(function(e){this.g.addCue(e)}.bind(this))},ws.prototype.append=ws.prototype.append,ws.prototype.destroy=function(){return this.g&&Is(this.g,(function(){return!0})),this.g=null,Promise.resolve()},ws.prototype.destroy=ws.prototype.destroy,ws.prototype.isTextVisible=function(){return"showing"==this.g.mode},ws.prototype.isTextVisible=ws.prototype.isTextVisible,ws.prototype.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"},ws.prototype.setTextVisibility=ws.prototype.setTextVisibility,G("shaka.util.ConfigUtils.mergeConfigObjects",ks),G("shaka.util.ConfigUtils.convertToConfigObject",Os),G("shaka.util.PlayerConfiguration",Ps),Ps.mergeConfigObjects=xs,H(Us,je),G("shaka.Player",Us),Us.prototype.destroy=function(){var e=this;return g((function t(){var r;return M(t,(function(t){switch(t.s){case 1:return e.o==Cu?t.return():(e.o=Cu,r=Ts(e.Ya,(function(){return{node:e.P,payload:{Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},gb:!1}})),$(t,new Promise((function(t){r.Kb=function(){X.info("Preparing to destroy walker...")},r.Cc=function(){t(),e.dispatchEvent(new Be("loaded"))},r.kb=function(){t()},r.onError=function(){t()},r.Ec=function(){t()}})),2));case 2:return $(t,e.Ya.destroy(),3);case 3:if(e.l&&(e.l.release(),e.l=null),e.Uc=null,e.u=null,e.h=null,!e.X){t.I(0);break}return $(t,e.X.destroy(),5);case 5:e.X=null,w(t)}}))}))},Us.prototype.destroy=Us.prototype.destroy,Us.version="v2.5.23";var js=["2","5"];Wr=new function(e){this.g=e,this.i=Kr,this.h=zr}(new Gr(Number(js[0]),Number(js[1])));var Fs=["output-restricted","internal-error"],Vs={};function Gs(e,t){return g((function r(){var n;return M(r,(function(r){switch(r.s){case 1:return e.o!=Cu&&(e.o=Iu),n=e.Wc.map((function(e){return e()})),e.Wc=[],$(r,Promise.all(n),2);case 2:if(e.dispatchEvent(new Be("unloading")),t.Ia=null,t.mimeType=null,t.startTime=null,t.uri=null,t.D&&(e.l.ta(t.D,"loadedmetadata"),e.l.ta(t.D,"playing"),e.l.ta(t.D,"pause"),e.l.ta(t.D,"ended"),e.l.ta(t.D,"ratechange")),e.wb&&(e.wb.release(),e.wb=null),e.ic&&(e.ic.stop(),e.ic=null),!e.C){r.I(3);break}return $(r,e.C.stop(),4);case 4:e.C=null;case 3:if(!e.u){r.I(5);break}return $(r,e.u.stop(),5);case 5:if(!e.j){r.I(7);break}return $(r,e.j.destroy(),8);case 8:e.j=null;case 7:if(e.J&&(e.J.release(),e.J=null),e.A&&(e.A.release(),e.A=null),!e.M){r.I(9);break}return $(r,e.M.destroy(),10);case 10:e.M=null;case 9:if(!t.D||!t.D.src){r.I(11);break}return $(r,new Promise((function(e){return new ke(e).V(.1)})),12);case 12:t.D.removeAttribute("src"),t.D.load();case 11:if(!e.m){r.I(13);break}return $(r,e.m.destroy(),14);case 14:e.m=null;case 13:e.Z.g.clear(),e.Tb=null,e.L=null,e.lc.clear(),e.i=null,e.F=null,e.fd=null,e.yb=!0,tu(e),w(r)}}))}))}function Hs(e,t){return new St(t,e.h.drm.updateExpirationTime)}function Ks(e,t){e.L=new Oo,e.L.g=Ro,Po(e.L,t,Math.min(.5,t/2)),tu(e),e.ic=new ke((function(){zs(e)})).Oa(.25)}function zs(e){switch(e.o){case Ou:var t=!!e.g.ended||Yt(e.g.buffered)>=e.g.duration-1;break;case ku:e:if(e.g.ended||Tr(e.M))t=!0;else{if(e.i.presentationTimeline.aa()){var r=e.i.presentationTimeline.Db();if(Yt(e.g.buffered)>=r){t=!0;break e}}t=!1}break;default:t=!1}var n=Zt(e.g.buffered,e.g.currentTime),i=t,o=(r=e.L).h.get(r.g);t=r.g,n=i||n>=o?xo:Ro,r.g=n,t!=n&&tu(e)}function Ws(e){if(e.C){var t=Fe(e.h.manifest);e.g&&"AUDIO"===e.g.nodeName&&(t.disableVideo=!0),e.C.configure(t)}if(e.m&&e.m.configure(e.h.drm),e.j){e.j.configure(e.h.streaming);try{e.i.periods.forEach(e.Xc.bind(e))}catch(o){e.Va(o)}var r=fa(e.j),n=ha(e.j);t=Eu(e),r=jr.ie(r,n,t.variants),e.u&&r&&r.allowedByApplication&&r.allowedByKeySystem?iu(e,t.variants):(X.debug("Choosing new streams after changing configuration"),ou(e,t))}if(e.M&&(t=e.h.textDisplayFactory,e.fd!=t)){r=new t;var i=(n=e.M).l;n.l=r,i&&(r.setTextVisibility(i.isTextVisible()),i.destroy()),n.g&&(n.g.i=r),e.fd=t,e.j&&((r=(t=e.j).h.get("text"))&&ma(t,r.stream,!0,0,!0))}e.u&&(e.u.configure(e.h.abr),e.h.abr.enabled&&!e.yb?e.u.enable():e.u.disable(),fu(e)),e.L&&(t=e.h.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),Po(e.L,t,Math.min(.5,t/2)))}function Ys(e){return Array.from(e.g.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function Xs(e,t,r,n){Eo(e.Z,t).variant=r,(e=e.F.i).i!=r&&(e.i=r,e.g.push({timestamp:Date.now()/1e3,id:r.id,type:"variant",fromAdaptation:n,bandwidth:r.bandwidth}))}function Zs(e,t,r,n){Ao(e.Z,t,r),(e=e.F.i).h!=r&&(e.h=r,e.g.push({timestamp:Date.now()/1e3,id:r.id,type:"text",fromAdaptation:n,bandwidth:null}))}function qs(e){var t=Rs();return t.streaming.failureCallback=function(t){e.aa()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,X.v("Live streaming error.  Retrying automatically..."),e.Id())},t.textDisplayFactory=function(){return new ws(e.g)},t}function Qs(e,t){var r=e.j?fa(e.j):null,n=e.j?ha(e.j):null;if(t.forEach(jr.filterNewPeriod.bind(null,e.m,r,n)),r=function(e,t){var r=0;return e.forEach((function(e){r+=t(e)?1:0})),r}(t,(function(e){return e.variants.some(jr.Gb)})),0==r)throw new Z(2,4,4032);if(r<t.length)throw new Z(2,4,4011);t.forEach(function(e){jr.Xd(e.variants,this.h.restrictions,this.mc)&&this.j&&Eu(this)==e&&uu(this),vu(this,e.variants)}.bind(e))}function Js(e,t,r,n){return r=void 0!==r&&r,n=void 0===n?0:n,e.yb?(e.wa=t,e.qe=r,e.oe=n,!0):((t=va(e.j,t,r,n))&&cu(e),t)}function eu(e,t){if(e.yb)return e.va=t,!0;var r=ma(e.j,t,!0,0,!1);return r&&lu(e),r}function tu(e){var t=e.jd();if(e.F&&e.L&&e.A){var r=e.J;r.j=t,Ko(r),nu(e)}e.dispatchEvent(new Be("buffering",{buffering:t}))}function ru(e){var t=e.g.playbackRate;0!=t&&e.J.set(t)}function nu(e){if(e.F&&e.L){var t=e.F.g;e.L.g==Ro?Ls(t,"buffering"):e.g.paused?Ls(t,"paused"):e.g.ended?Ls(t,"ended"):Ls(t,"playing")}}function iu(e,t){try{vu(e,t)}catch(n){return e.Va(n),null}var r=t.filter((function(e){return jr.Gb(e)}));return r=e.tb.create(r),e.u.setVariants(Array.from(r.values())),e.u.chooseVariant()}function ou(e,t){var r=au(e,t,!1),n=jr.Wb(t.textStreams,e.ua,e.Xa)[0]||null,i=!1;n&&(e.h.streaming.alwaysStreamText||e.zc())&&(Zs(e,t,n,!0),i=eu(e,n)),(r||i)&&su(e)}function au(e,t,r){r=void 0===r||r;var n=iu(e,t.variants),i=!1;return n&&(Xs(e,t,n,!0),i=Js(e,n,!0)),r&&i&&su(e),i}function su(e){mu(e,new Be("adaptation"))}function uu(e){mu(e,new Be("trackschanged"))}function cu(e){mu(e,new Be("variantchanged"))}function lu(e){mu(e,new Be("textchanged"))}function du(e){mu(e,new Be("texttrackvisibility"))}function fu(e){mu(e,new Be("abrstatuschanged",{Zg:e.h.abr.enabled}))}function hu(e,t,r){e.dispatchEvent(new Be(t,{detail:{schemeIdUri:r.schemeIdUri,value:r.value,startTime:r.startTime,endTime:r.endTime,id:r.id,eventElement:r.eventElement}}))}function pu(e){if(!e.g.error)return null;var t=e.g.error.code;if(1==t)return null;var r=e.g.error.msExtendedCode;return r&&(0>r&&(r+=Math.pow(2,32)),r=r.toString(16)),new Z(2,3,3016,t,r,e.g.error.message)}function gu(e,t){if(e.j){var r=Eu(e),n=!1,i=Object.keys(t);0==i.length&&X.v("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var o=1==i.length&&"00"==i[0];o&&X.v("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),i.length&&e.i.periods.forEach((function(e){e.variants.forEach((function(e){jr.Kf(e).forEach((function(r){var i=e.allowedByKeySystem;r.keyId&&(r=t[o?"00":r.keyId],e.allowedByKeySystem=!!r&&!Fs.includes(r)),i!=e.allowedByKeySystem&&(n=!0)}))}))})),i=fa(e.j);var a=ha(e.j);(i=jr.ie(i,a,r.variants))&&!i.allowedByKeySystem&&(X.debug("Choosing new variants after key status changed"),au(e,r)),n&&(uu(e),iu(e,r.variants))}}function yu(e,t,r){e.C&&e.C.onExpirationUpdated&&e.C.onExpirationUpdated(t,r),e.dispatchEvent(new Be("expirationupdated"))}function vu(e,t){var r=e.m?ct(e.m.da):{},n=Object.keys(r);n=n.length&&"00"==n[0];for(var i=!1,o=!1,a=[],s=[],u=h(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var d=(l=h(l)).next();!d.done;d=l.next())if((d=d.value).keyId){var f=r[n?"00":d.keyId];f?Fs.includes(f)&&(s.includes(f)||s.push(f)):a.includes(d.keyId)||a.push(d.keyId)}c.allowedByApplication?c.allowedByKeySystem&&(i=!0):o=!0}if(!i)throw new Z(2,4,4012,{hasAppRestrictions:o,missingKeys:a,restrictedKeyStatuses:s})}function mu(e,t){g((function r(){return M(r,(function(r){switch(r.s){case 1:return $(r,Promise.resolve(),2);case 2:e.o!=Cu&&e.dispatchEvent(t),w(r)}}))}))}function _u(e){for(var t=new Set,r=(e=h(e)).next();!r.done;r=e.next())(r=r.value).language?t.add(Nr(r.language)):t.add("und");return t}function bu(e){for(var t=new Map,r=(e=h(e)).next();!r.done;r=e.next()){var n=r.value;r="und";var i=[];for(n.language&&(r=Nr(n.language)),(i="variant"==n.type?n.audioRoles:n.roles)&&i.length||(i=[""]),t.has(r)||t.set(r,new Set),i=(n=h(i)).next();!i.done;i=n.next())i=i.value,t.get(r).add(i)}var o=[];return t.forEach((function(e,t){for(var r=h(e),n=r.next();!n.done;n=r.next())o.push({language:t,role:n.value})})),o}function Au(e){return null==(e=Eu(e))?[]:e.variants.filter((function(e){return jr.Gb(e)}))}function Eu(e){for(var t=e.A.l(),r=null,n=(e=h(e.i.periods)).next();!n.done;n=e.next())(n=n.value).startTime<=t&&(r=n);return r}function Su(e){var t=Eu(e);return Eo(e.Z,t).variant}function Tu(){return new Z(2,7,7e3)}function $u(e,t,r,n,i,o){return n==e&&i.D==o.D&&i.uri==o.uri&&i.mimeType==o.mimeType&&i.Ia==o.Ia?t:r}function wu(e){return new Promise((function(t,r){e.kb=function(){return r(Tu())},e.Cc=function(){return t()},e.onError=function(e){return r(e)},e.Ec=function(){return r(Tu())}}))}Us.registerSupportPlugin=function(e,t){Vs[e]=t},Us.isBrowserSupported=function(){if(!(t.Promise&&t.Uint8Array&&Array.prototype.forEach))return!1;var e=mt();return!(e&&12>e||!(t.MediaKeys&&t.navigator&&t.navigator.requestMediaKeySystemAccess&&t.MediaKeySystemAccess&&t.MediaKeySystemAccess.prototype.getConfiguration))&&(!!pt()||gt("application/x-mpegurl"))},Us.probeSupport=function(){return Mt().then((function(e){for(var t=Ei.ng(),r={},n=h('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),i=n.next();!i.done;i=n.next()){r[i=i.value]=pt()?!!vr(i)||(MediaSource.isTypeSupported(i)||we(i)):gt(i);var o=i.split(";")[0];r[o]=r[o]||r[i]}for(var a in e={manifest:t,media:r,drm:e},Vs)e[a]=Vs[a]();return e}))},Us.prototype.Ub=function(e,t){if(t=void 0===t||t,this.o==Cu)return Promise.reject(Tu());var r={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null};r.D=e,pt()||(t=!1);var n=t?this.vb:this.da,i=Ts(this.Ya,(function(){return{node:n,payload:r,gb:!1}}));return i.Kb=function(){return X.info("Starting attach...")},wu(i)},Us.prototype.attach=Us.prototype.Ub,Us.prototype.detach=function(){var e=this;if(this.o==Cu)return Promise.reject(Tu());var t=Ts(this.Ya,(function(){return{node:e.P,payload:{Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},gb:!1}}));return t.Kb=function(){return X.info("Starting detach...")},wu(t)},Us.prototype.detach=Us.prototype.detach,Us.prototype.Ud=function(e){var t=this;if(e=void 0===e||e,this.o==Cu)return Promise.reject(Tu());pt()||(e=!1);var r={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},n=Ts(this.Ya,(function(n){var i=n.D&&e?t.vb:n.D?t.da:t.P;return r.D=n.D,{node:i,payload:r,gb:!1}}));return n.Kb=function(){return X.info("Starting unload...")},wu(n)},Us.prototype.unload=Us.prototype.Ud,Us.prototype.load=function(e,t,r){if(this.o==Cu)return Promise.reject(Tu());this.dispatchEvent(new Be("loading"));var n={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null};n.uri=e,n.Rd=Date.now()/1e3,r&&"string"!=typeof r&&(Hr("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),n.Ia=function(){return new r}),r&&"string"==typeof r&&(n.mimeType=r),void 0!==t&&(n.startTime=t);var i=function(e,t){if(t.Ia)return!1;if(!pt())return!0;var r=t.mimeType,n=t.uri||"";return r||(r={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[Ei.getExtension(n)]),!!r&&(""!=(t.D||bt()).canPlayType(r)&&(!Ei.isSupported(n,r)||vt()&&e.h.streaming.useNativeHlsOnSafari))}(this,n)?this.xb:this.ea,o=Ts(this.Ya,(function(e){return null==e.D?null:(n.D=e.D,{node:i,payload:n,gb:!0})}));return o.Kb=function(){return X.info("Starting load of "+e+"...")},new Promise((function(e,t){o.Ec=function(){return t(new Z(2,7,7002))},o.Cc=function(){return e()},o.kb=function(){return t(Tu())},o.onError=function(e){return t(e)}}))},Us.prototype.load=Us.prototype.load,Us.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Os(e,t));var r=xs(this.h,e,qs(this));return Ws(this),r},Us.prototype.configure=Us.prototype.configure,Us.prototype.getConfiguration=function(){var e=qs(this);return xs(e,this.h,qs(this)),e},Us.prototype.getConfiguration=Us.prototype.getConfiguration,Us.prototype.vg=function(){for(var e in this.h)delete this.h[e];xs(this.h,qs(this),qs(this)),Ws(this)},Us.prototype.resetConfiguration=Us.prototype.vg,Us.prototype.tf=function(){return this.o},Us.prototype.getLoadMode=Us.prototype.tf,Us.prototype.yf=function(){return this.g},Us.prototype.getMediaElement=Us.prototype.yf,Us.prototype.Yb=function(){return this.X},Us.prototype.getNetworkingEngine=Us.prototype.Yb,Us.prototype.tc=function(){return this.Tb},Us.prototype.getAssetUri=Us.prototype.tc,Us.prototype.wf=function(){return Hr("getManifestUri",'Please use "getAssetUri" instead.'),this.tc()},Us.prototype.getManifestUri=Us.prototype.wf,Us.prototype.aa=function(){return this.i?this.i.presentationTimeline.aa():!(!this.g||!this.g.src)&&1/0==this.g.duration},Us.prototype.isLive=Us.prototype.aa,Us.prototype.ib=function(){return!!this.i&&this.i.presentationTimeline.ib()},Us.prototype.isInProgress=Us.prototype.ib,Us.prototype.Qf=function(){if(this.i){if(!this.i.periods.length)return!1;var e=this.i.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.g||!this.g.src)&&(this.g.videoTracks?0==this.g.videoTracks.length:0==this.g.videoHeight)},Us.prototype.isAudioOnly=Us.prototype.Qf,Us.prototype.He=function(){if(this.i){var e=this.i.presentationTimeline;return{start:e.Cb(),end:e.Ka()}}return this.g&&this.g.src&&(e=this.g.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Us.prototype.seekRange=Us.prototype.He,Us.prototype.keySystem=function(){return kt(this.drmInfo())},Us.prototype.keySystem=Us.prototype.keySystem,Us.prototype.drmInfo=function(){return this.m?this.m.g:null},Us.prototype.drmInfo=Us.prototype.drmInfo,Us.prototype.Xb=function(){return this.m?this.m.Xb():1/0},Us.prototype.getExpiration=Us.prototype.Xb,Us.prototype.jd=function(){return!!this.L&&this.L.g==Ro},Us.prototype.isBuffering=Us.prototype.jd,Us.prototype.Cf=function(){if(this.J){var e=this.J;e=e.j?0:e.i}else e=0;return e},Us.prototype.getPlaybackRate=Us.prototype.Cf,Us.prototype.Mg=function(e){0==e?X.ba("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.J&&this.J.set(e),this.o==ku&&ya(this.j,1<Math.abs(e)))},Us.prototype.trickPlay=Us.prototype.Mg,Us.prototype.$e=function(){var e=this.J.vc();this.o==Ou&&this.J.set(e),this.o==ku&&(this.J.set(e),ya(this.j,!1))},Us.prototype.cancelTrickPlay=Us.prototype.$e,Us.prototype.ed=function(){if(this.i&&this.A){for(var e=Su(this),t=[],r=h(Au(this)),n=r.next();!n.done;n=r.next()){n=n.value;var i=jr.Oc(n);i.active=n==e,t.push(i)}return t}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map((function(e){return jr.je(e)})):[]},Us.prototype.getVariantTracks=Us.prototype.ed,Us.prototype.Eb=function(){if(this.i&&this.A){for(var e=function(e){var t=Eu(e);if(null==t)return null;if(!Eo(e.Z,t).text){var r=jr.Wb(t.textStreams,e.ua,e.Xa);r.length&&Ao(e.Z,t,r[0])}return Eo(e.Z,t).text}(this),t=[],r=h(function(e){var t=Eu(e);return null==t?[]:t.textStreams.filter((function(t){return!e.lc.has(t)}))}(this)),n=r.next();!n.done;n=r.next()){n=n.value;var i=jr.Kc(n);i.active=n==e,t.push(i)}return t}return this.g&&this.g.src&&this.g.textTracks?Ys(this).map((function(e){return jr.Of(e)})):[]},Us.prototype.getTextTracks=Us.prototype.Eb,Us.prototype.Ld=function(e){if(this.i&&this.j){var t=Eu(this),r=t.textStreams.find((function(t){return t.id==e.id}));r?(Zs(this,t,r,!1),eu(this,r),this.ua=r.language):X.error("No stream with id",e.id)}else if(this.g&&this.g.src&&this.g.textTracks){for(r=(t=h(t=Ys(this))).next();!r.done;r=t.next())r=r.value,jr.gd(r)==e.id?r.mode=this.ub?"showing":"hidden":r.mode="disabled";lu(this)}},Us.prototype.selectTextTrack=Us.prototype.Ld,Us.prototype.xg=function(){Hr("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.Eb().filter((function(e){return"application/cea-608"==e.mimeType}));0<e.length?this.Ld(e[0]):X.v("Unable to find the text track embedded in the video.")},Us.prototype.selectEmbeddedTextTrack=Us.prototype.xg,Us.prototype.Rg=function(){Hr("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.Eb().filter((function(e){return e.active}))[0];return!!e&&"application/cea-608"==e.mimeType},Us.prototype.usingEmbeddedTextTrack=Us.prototype.Rg,Us.prototype.Ie=function(e,t,r){if(r=void 0===r?0:r,this.i&&this.j){var n=Eu(this);this.h.abr.enabled&&X.ba("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=n.variants.find((function(t){return t.id==e.id}));i?jr.Gb(i)?(Xs(this,n,i,!1),Js(this,i,t,r),this.tb=new Io(i),iu(this,n.variants)):X.error("Unable to switch to restricted track",e.id):X.error("No variant with id",e.id)}else if(this.g&&this.g.audioTracks){for(r=(t=h(t=Array.from(this.g.audioTracks))).next();!r.done;r=t.next())r=r.value,jr.gd(r)==e.id&&(r.enabled=!0);cu(this)}},Us.prototype.selectVariantTrack=Us.prototype.Ie,Us.prototype.nf=function(){return bu(this.ed())},Us.prototype.getAudioLanguagesAndRoles=Us.prototype.nf,Us.prototype.Jf=function(){return bu(this.Eb())},Us.prototype.getTextLanguagesAndRoles=Us.prototype.Jf,Us.prototype.mf=function(){return Array.from(_u(this.ed()))},Us.prototype.getAudioLanguages=Us.prototype.mf,Us.prototype.If=function(){return Array.from(_u(this.Eb()))},Us.prototype.getTextLanguages=Us.prototype.If,Us.prototype.Jd=function(e,t){if(this.i&&this.A){var r=Eu(this);if(this.tb=new ko(e,t||"",0,""),!this.h.abr.enabled){var n=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},i=Eu(this)||this.i.periods[0],o=Eo(this.Z,i).variant,a=this.tb.create(i.variants);i=null;for(var s=(a=h(a.values())).next();!s.done;s=a.next())s=s.value,(!i||n(i,o)>n(s,o))&&(i=s);if(i)return r=jr.Oc(i),void this.Ie(r,!0)}au(this,r)}else if(this.g&&this.g.audioTracks){for(i=Array.from(this.g.audioTracks),r=Nr(e),o=n=null,a=(i=h(i)).next();!a.done;a=i.next())a=a.value,Nr((s=jr.je(a)).language)==r&&(n=a,t?s.roles.includes(t)&&(o=a):0==s.roles.length&&(o=a));o?(o.enabled=!0,cu(this)):n&&(n.enabled=!0,cu(this))}},Us.prototype.selectAudioLanguage=Us.prototype.Jd,Us.prototype.Kd=function(e,t){if(this.i&&this.A){var r=Eu(this);this.ua=e,this.Xa=t||"";var n=jr.Wb(r.textStreams,this.ua,this.Xa)[0]||null;n&&(Zs(this,r,n,!1),(this.h.streaming.alwaysStreamText||this.zc())&&eu(this,n))}else{var i=Nr(e);(r=this.Eb().filter((function(e){return Nr(e.language)==i&&(!t||e.roles.includes(t))}))[0])&&this.Ld(r)}},Us.prototype.selectTextLanguage=Us.prototype.Kd,Us.prototype.yg=function(e){if(this.i&&this.A){for(var t=Eu(this),r=null,n=h(Au(this)),i=n.next();!i.done;i=n.next())if((i=i.value).audio.label==e){r=i;break}null==r?X.v("No variants were found with label: "+e+". Ignoring the request to switch."):(this.tb=new ko(r.language,"",0,e),au(this,t))}},Us.prototype.selectVariantsByLabel=Us.prototype.yg,Us.prototype.zc=function(){var e=this.ub;return this.M?this.M.l.isTextVisible():this.g&&this.g.src&&this.g.textTracks?Ys(this).some((function(e){return"showing"==e.mode})):e},Us.prototype.isTextTrackVisible=Us.prototype.zc,Us.prototype.Bg=function(e){var t=this;return g((function r(){var n,i,o,a;return M(r,(function(r){switch(r.s){case 1:if(t.ub==(n=!!e))return r.return();if(t.ub=n,t.o!=ku){if(t.g&&t.g.src&&t.g.textTracks)for(var s=h(Ys(t)),u=s.next();!u.done;u=s.next())"disabled"!=(i=u.value).mode&&(i.mode=n?"showing":"hidden");r.I(2);break}if(t.M.l.setTextVisibility(n),t.h.streaming.alwaysStreamText){r.I(2);break}if(!n){!function(e){e.L=!0;var t=e.h.get("text");t&&(Na(t),Ma(t).catch((function(){})),e.h.delete("text"))}(t.j),r.I(2);break}if(pa(t.j,"text")){r.I(2);break}if(o=Eu(t),!(0<(a=jr.Wb(o.textStreams,t.ua,t.Xa)).length)){r.I(2);break}return $(r,ga(t.j,a[0]),2);case 2:du(t),w(r)}}))}))},Us.prototype.setTextTrackVisibility=Us.prototype.Bg,Us.prototype.Ef=function(){if(!this.aa())return X.v("getPlayheadTimeAsDate is for live streams!"),null;var e=this.Ya.j,t=0;if(this.A)t=this.A.l();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.i?new Date(1e3*(this.i.presentationTimeline.j+this.g.currentTime)):this.g&&this.g.getStartDate?(e=this.g.getStartDate(),isNaN(e.getTime())?(X.v("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(X.v("No way to get playhead time as Date!"),null)},Us.prototype.getPlayheadTimeAsDate=Us.prototype.Ef,Us.prototype.Gf=function(){if(!this.aa())return X.v("getPresentationStartTimeAsDate is for live streams!"),null;if(this.i)return new Date(1e3*this.i.presentationTimeline.j);if(this.g&&this.g.getStartDate){var e=this.g.getStartDate();return isNaN(e.getTime())?(X.v("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return X.v("No way to get presentation start time as Date!"),null},Us.prototype.getPresentationStartTimeAsDate=Us.prototype.Gf,Us.prototype.bd=function(){var e={total:[],audio:[],video:[],text:[]};return this.o==Ou&&(e.total=qt(this.g.buffered)),this.o==ku&&this.M.bd(e),e},Us.prototype.getBufferedInfo=Us.prototype.bd,Us.prototype.getStats=function(){if(this.o!=ku&&this.o!=Ou)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};nu(this);var e=this.g;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.F,r=Number(e.totalVideoFrames);t.A=Number(e.droppedVideoFrames),t.u=r,this.F.o=Number(e.corruptedVideoFrames)}this.m?e=(e=this.m).P?e.P:NaN:e=NaN,this.F.m=e,this.o==ku&&((e=Su(this))&&(this.F.C=e.bandwidth),e&&e.video&&(t=this.F,r=e.video.height||NaN,t.F=e.video.width||NaN,t.l=r),e=this.u.getBandwidthEstimate(),this.F.j=e);var n=this.F;e=n.F,t=n.l,r=n.C;for(var i=n.u,o=n.A,a=n.o,s=n.j,u=n.h,c=Ns(n.g,"playing"),l=Ns(n.g,"paused"),d=Ns(n.g,"buffering"),f=n.m,p=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var r=[],n=h(e.h),i=n.next();!i.done;i=n.next())r.push(t(i.value));return e.g&&r.push(t(e.g)),r}(n.g),g=[],y=(n=h(n.i.g)).next();!y.done;y=n.next())y=y.value,g.push({timestamp:y.timestamp,id:y.id,type:y.type,fromAdaptation:y.fromAdaptation,bandwidth:y.bandwidth});return{width:e,height:t,streamBandwidth:r,decodedFrames:i,droppedFrames:o,corruptedFrames:a,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:d,licenseTime:f,stateHistory:p,switchHistory:g}},Us.prototype.getStats=Us.prototype.getStats,Us.prototype.addTextTrack=function(e,t,r,n,i,o){var a=this;return g((function s(){var u,c,l,d,f,h,p,g,y;return M(s,(function(s){switch(s.s){case 1:if(a.o==Ou)throw X.error("Cannot add text when loaded with src="),Error("State error!");if(a.o!=ku)throw X.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(u=Eu(a),c=pe,l=a.i.periods.indexOf(u),f=(d=l+1)>=a.i.periods.length?a.i.presentationTimeline.ha():a.i.periods[d].startTime,1/0==(h=f-u.startTime))throw new Z(1,4,4033);return p=new ii(1,0,h,(function(){return[e]}),0,null),g={id:a.re++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:n,codecs:i||"",kind:r,encrypted:!1,keyId:null,language:t,label:o||null,type:c.za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},a.lc.add(g),u.textStreams.push(g),$(s,ga(a.j,g),2);case 2:return(y=pa(a.j,"text"))&&Ao(a.Z,u,y),a.lc.delete(g),X.debug("Choosing new streams after adding a text stream"),ou(a,u),uu(a),s.return(jr.Kc(g))}}))}))},Us.prototype.addTextTrack=Us.prototype.addTextTrack,Us.prototype.Nd=function(e,t){this.mc.width=e,this.mc.height=t},Us.prototype.setMaxHardwareResolution=Us.prototype.Nd,Us.prototype.Id=function(){if(this.o==ku){var e=this.j;if(e.j)X.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.A)X.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=h(e.h.values()),r=t.next();!r.done;r=t.next()){var n=Ua(r=r.value);r.ac&&(X.info(n,"Retrying after failure..."),r.ac=!1,La(e,r,.1))}e=!0}}else e=!1;return e},Us.prototype.retryStreaming=Us.prototype.Id,Us.prototype.uf=function(){return this.i},Us.prototype.getManifest=Us.prototype.uf,Us.prototype.vf=function(){return this.C?this.C.constructor:null},Us.prototype.getManifestParserFactory=Us.prototype.vf,(i=Us.prototype).Xc=function(e){var t=this.j?fa(this.j):null,r=this.j?ha(this.j):null;if(jr.filterNewPeriod(this.m,t,r,e),!(t=e.variants).some(jr.Gb))throw new Z(2,4,4011);if(vu(this,e.variants),jr.Xd(t,this.h.restrictions,this.mc)&&this.j&&Eu(this)==e&&uu(this),(e=this.m?this.m.g:null)&&this.m.o)for(r=(t=h(t)).next();!r.done;r=t.next())for(var n=(r=h(r.value.drmInfos)).next();!n.done;n=r.next())if((n=n.value).keySystem==e.keySystem)for(var i=(n=h(n.initData||[])).next();!i.done;i=n.next())i=i.value,It(this.m,i.initDataType,i.initData)},i.Vf=function(e){X.debug("onChooseStreams_",e);try{X.O("onChooseStreams_, choosing variant from ",e.variants),X.O("onChooseStreams_, choosing text from ",e.textStreams),this.yb=!0,this.u.disable(),fu(this),X.debug("Choosing new streams after period changed");var t=iu(this,e.variants),r=jr.Wb(e.textStreams,this.ua,this.Xa)[0]||null;this.wa&&(e.variants.includes(this.wa)&&(t=this.wa),this.wa=null),this.va&&(e.textStreams.includes(this.va)&&(r=this.va),this.va=null),t&&Xs(this,e,t,!0),r&&Zs(this,e,r,!0);var n=this.j,i=n.h.get("video");if(i)var o=n.i.periods[i.oa];else{var a=n.h.get("audio");o=a?n.i.periods[a.oa]:null}var s=t?t.audio:null;if(!o&&r){var u;if(u=s){e=r;var c=Nr(this.h.preferredTextLanguage),l=Nr(s.language),d=Nr(e.language);u=Dr(d,c)&&!Dr(l,d)}u&&(this.ub=!0),this.ub&&this.M.l.setTextVisibility(!0),du(this)}var f=this.h.streaming.alwaysStreamText||this.zc()?{variant:t,text:r}:{variant:t,text:null};return X.O("onChooseStreams_, chose variant ",f.variant),X.O("onChooseStreams_, chose text ",f.text),f}catch(h){return this.Va(h),{variant:null,text:null}}},i.Ze=function(){X.debug("canSwitch_"),this.yb=!1,this.h.abr.enabled&&(this.u.enable(),fu(this)),this.wa&&(va(this.j,this.wa,this.qe,this.oe),cu(this),this.wa=null),this.va&&(ma(this.j,this.va,!0,0,!1),lu(this),this.va=null)},i.$f=function(){this.C&&this.C.update&&this.C.update()},i.eg=function(){this.A&&this.A.C()},i.Va=function(e){if(this.o!=Cu){var t=new Be("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var Cu=0,Iu=1,ku=2,Ou=3;function Pu(e,t){var r=ys(new gs(e.Ea(),e.ja()),t.periods[0],new Si(null,0)),n=t.appMetadata||{};return r=Ru(r),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:r,appMetadata:n}}function Ru(e){for(var t=[],r=jr.Bf(e.variants),n=(r=h(r)).next();!n.done;n=r.next())t.push(jr.Oc(n.value));for(r=(e=h(e.textStreams)).next();!r.done;r=e.next())t.push(jr.Kc(r.value));return t}function xu(){this.g={}}function Du(e,t){var r=t.audio,n=t.video;if(r&&!n&&(e.g[r.id]=r.bandwidth||t.bandwidth),!r&&n&&(e.g[n.id]=n.bandwidth||t.bandwidth),r&&n){var i=r.bandwidth||393216,o=n.bandwidth||t.bandwidth-i;0>=o&&(X.v("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),o=t.bandwidth),e.g[r.id]=i,e.g[n.id]=o}}function Lu(e,t){var r=e.g[t];return null==r&&(r=0,X.error("Asking for bitrate of stream not given to the estimator")),0==r&&X.v("Using bitrate of 0, this stream won't affect progress"),r}function Nu(e){this.g=!1,this.h=new ye,this.i=e}function Mu(e){var t=new Uu;e.periods.forEach((function(e,r){var n=Fu(e.variants);if(0==r)for(var i=(n=h(n.g)).next();!i.done;i=n.next())t.add(i.value);else!function(e,t){e.g=e.g.filter((function(e){return ju(t,e)}))}(t,n)}));for(var r=(e=h(e.periods)).next();!r.done;r=e.next())(r=r.value).variants=r.variants.filter((function(e){return ju(t,new Bu(e))}))}function Bu(e){var t=e.audio;e=e.video,this.h=t?t.mimeType:null,this.g=t?t.codecs.split(".")[0]:null,this.j=e?e.mimeType:null,this.i=e?e.codecs.split(".")[0]:null}function Uu(){this.g=[]}function ju(e,t){return e.g.some((function(e){return t.h==e.h&&t.g==e.g&&t.j==e.j&&t.i==e.i}))}function Fu(e){for(var t=new Uu,r=(e=h(e)).next();!r.done;r=e.next())t.add(new Bu(r.value));return t}function Vu(e){var t=this;if(e&&e.constructor!=Us)throw new Z(2,9,9008);this.h=this.g=null,e?(this.g=e.h,this.h=e.Yb()):(this.g=Rs(),this.h=new We),this.j=!1,this.i=[],this.l=[];var r=!e;this.m=new Nu((function(){return g((function e(){var n;return M(e,(function(e){switch(e.s){case 1:return n=function(){},$(e,Promise.all(t.l.map((function(e){return e.then(n,n)}))),2);case 2:if(!r){e.I(3);break}return $(e,t.h.destroy(),3);case 3:t.g=null,t.h=null,w(e)}}))}))}))}function Gu(){if(pt())e:{for(var e=h(os.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Hu(e,t){for(var r=[],n=h(e.periods),i=n.next();!i.done;i=n.next())for(var o=(i=h(i.value.streams)).next();!o.done;o=i.next())o=o.value,t&&"video"==o.contentType?r.push({contentType:lt(o.mimeType,o.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=o.contentType||r.push({contentType:lt(o.mimeType,o.codecs),robustness:e.drmInfo.audioRobustness});return r}function Ku(e,t,r){return g((function n(){return M(n,(function(n){if(1===n.s)return $(n,function(e,t,r,n){return g((function i(){var o,a,s;return M(i,(function(i){switch(i.s){case 1:return n.drmInfo?(o=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new Z(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(r),a=n.sessionIds.map((function(e){return{sessionId:e,keySystem:n.drmInfo.keySystem,licenseUri:n.drmInfo.licenseServerUri,serverCertificate:n.drmInfo.serverCertificate,audioCapabilities:Hu(n,!1),videoCapabilities:Hu(n,!0)}})),$(i,As(t,e,a),2)):i.return();case 2:return s=i.B,$(i,o.remove(s),3);case 3:return $(i,o.add(a.filter((function(e){return-1==s.indexOf(e.sessionId)}))),0)}}))}))}(e.h,e.g.drm,r,t),0)}))}))}function zu(e,t,r,n){function i(){s+=1,e.g.offline.progressCallback(u,s/a)}var o=function(e){var t=[];return e.periods.forEach((function(e){e.streams.forEach((function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach((function(e){t.push(e.dataKey)}))}))})),t}(n),a=o.length+1,s=0,u=Pu(r,n);return Promise.all([t.removeSegments(o,i),t.removeManifests([r.key()],i)])}function Wu(e,t,r,n,i,o){var a={id:o.id,originalId:o.originalId,primary:o.primary,presentationTimeOffset:o.presentationTimeOffset||0,contentType:o.type,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:o.pixelAspectRatio,kind:o.kind,language:o.language,label:o.label,width:o.width||null,height:o.height||null,initSegmentKey:null,encrypted:o.encrypted,keyId:o.keyId,segments:[],variantIds:[]};i=i.presentationTimeline.$b();var s=o.id,u=o.initSegmentReference;return u&&(u=Ti(u.i(),u.h,u.g,e.g.streaming.retryParameters),Ka(t,s,u,.5*Lu(n,o.id),!0,(function(t){return g((function n(){var i;return M(n,(function(n){switch(n.s){case 1:return $(n,r.addSegments([{data:t}]),2);case 2:i=n.B,e.i.push(i[0]),a.initSegmentKey=i[0],w(n)}}))}))}))),function(e,t,r){for(var n=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);n;)r(n),n=e.getSegmentReference(++t)}(o,i,(function(i){var u=Ti(i.i(),i.h,i.g,e.g.streaming.retryParameters);Ka(t,s,u,function(e,t,r){return r=r.endTime-r.startTime,Lu(e,t)*r}(n,o.id,i),!1,(function(t){return g((function n(){var o;return M(n,(function(n){switch(n.s){case 1:return $(n,r.addSegments([{data:t}]),2);case 2:o=n.B,e.i.push(o[0]),a.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:o[0]}),w(n)}}))}))}))})),a}function Yu(e){if(e.m.g)throw new Z(2,9,7001)}function Xu(){if(!Gu())throw new Z(2,9,9e3)}function Zu(e,t){return g((function r(){return M(r,(function(r){switch(r.s){case 1:return e.l.push(t),I(r,2),$(r,t,4);case 4:return r.return(r.B);case 2:P(r),Ge(e.l,t),R(r,0)}}))}))}function qu(e){var t=new Set(e.variants.map((function(e){return e.video}))),r=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&X.v("Multiple video tracks selected to be stored");for(var n=(t=h(r)).next();!n.done;n=t.next()){n=n.value;for(var i=h(r),o=i.next();!o.done;o=i.next())n!=(o=o.value)&&n.language==o.language&&X.v("Similar audio tracks were selected to be stored",n.id,o.id)}for(t=(r=h(e)).next();!t.done;t=r.next())for(t=t.value,i=(n=h(e)).next();!i.done;i=n.next())t!=(i=i.value)&&t.language==i.language&&X.v("Similar text tracks were selected to be stored",t.id,i.id)}Us.LoadMode={DESTROYED:Cu,NOT_LOADED:Iu,MEDIA_SOURCE:ku,SRC_EQUALS:Ou},Nu.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},Uu.prototype.add=function(e){ju(this,e)||this.g.push(e)},G("shaka.offline.Storage",Vu),Vu.support=Gu,Vu.prototype.destroy=function(){return this.m.destroy()},Vu.prototype.destroy=Vu.prototype.destroy,Vu.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Os(e,t));var r=e,n=!1;return null!=r.trackSelectionCallback&&(n=!0,r.offline=r.offline||{},r.offline.trackSelectionCallback=r.trackSelectionCallback,delete r.trackSelectionCallback),null!=r.progressCallback&&(n=!0,r.offline=r.offline||{},r.offline.progressCallback=r.progressCallback,delete r.progressCallback),null!=r.usePersistentLicense&&(n=!0,r.offline=r.offline||{},r.offline.usePersistentLicense=r.usePersistentLicense,delete r.usePersistentLicense),n&&Hr("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),xs(this.g,e)},Vu.prototype.configure=Vu.prototype.configure,Vu.prototype.getConfiguration=function(){var e=Rs();return xs(e,this.g,Rs()),e},Vu.prototype.getConfiguration=Vu.prototype.getConfiguration,Vu.prototype.Yb=function(){return this.h},Vu.prototype.getNetworkingEngine=Vu.prototype.Yb,Vu.prototype.store=function(e,t,r){var n=this;return Zu(this,function(e,t,r,n){return g((function i(){var o,a,s,u,c,l,d,f,p;return M(i,(function(i){switch(i.s){case 1:return Xu(),e.j?i.return(Promise.reject(new Z(2,9,9006))):(e.j=!0,$(i,function(e,t,r){return g((function n(){var i,o,a,s,u,c;return M(n,(function(n){switch(n.s){case 1:return i=null,o=e.h,a={networkingEngine:o,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},$(n,r(),2);case 2:return(s=n.B).configure(e.g.manifest),Yu(e),I(n,3),$(n,s.start(t,a),5);case 5:return u=n.B,Yu(e),c=function(e){for(var t=new Set,r=(e=h(e.periods)).next();!r.done;r=e.next()){for(var n=h((r=r.value).textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(n=(r=h(r.variants)).next();!n.done;n=r.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video)}return t}(u),$(n,Promise.all(at(c,(function(e){return e.createSegmentIndex()}))),6);case 6:if(Yu(e),i)throw i;return n.return(u);case 3:return P(n),$(n,s.stop(),7);case 7:R(n,0)}}))}))}(e,t,n),2));case 2:if(o=i.B,Yu(e),!(!o.presentationTimeline.aa()&&!o.presentationTimeline.ib()))throw new Z(2,9,9005,t);return a=null,s=new rs,c=u=null,C(i,3,4),$(i,function(e,t,r){return g((function n(){var i,o,a;return M(n,(function(n){switch(n.s){case 1:return i=new St({Ib:e.h,onError:r,Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),o=Fo(t.periods),a=e.g,i.configure(a.drm),$(n,function(e,t,r){return e.F=[],e.L=r,$t(e,t)}(i,o,a.offline.usePersistentLicense),2);case 2:return $(n,wt(i),3);case 3:return $(n,Ct(i),4);case 4:return n.return(i)}}))}))}(e,o,(function(e){c=c||e})),6);case 6:if(a=i.B,Yu(e),c)throw c;return $(i,function(e,t,r){return g((function n(){var i,o;return M(n,(function(n){switch(n.s){case 1:return i={width:1/0,height:1/0},function(e,t,r){for(var n=(e=h(e.periods)).next();!n.done;n=e.next())(n=n.value).variants=n.variants.filter((function(e){return jr.rd(e,t,r)}))}(t,e.g.restrictions,i),function(e){for(var t=(e=h(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter((function(e){var t=!0;return e.audio&&(t=t&&Er(e.audio)),e.video&&(t=t&&Er(e.video)),t}))}(t),function(e,t){for(var r=h(e.periods),n=r.next();!n.done;n=r.next())(n=n.value).variants=n.variants.filter((function(e){return Bt(t,e)}))}(t,r),Mu(t),o=e.g.preferredAudioChannelCount,jr.$d(t,o),$(n,function(e,t){return g((function r(){var n,i,o,a;return M(r,(function(r){switch(r.s){case 1:n=null,i=h(e.periods),o=i.next();case 2:if(o.done){r.I(0);break}return a=o.value,n&&(a.variants=a.variants.filter((function(e){return ju(n,new Bu(e))}))),$(r,t(a),5);case 5:n=Fu(a.variants),o=i.next(),r.I(2)}}))}))}(t,(function(t){return g((function r(){var n,i,o,a,s,u,c,l;return M(r,(function(r){switch(r.s){case 1:n=jr,i=[];for(var d=h(t.variants),f=d.next();!f.done;f=d.next())o=f.value,i.push(n.Oc(o));for(f=(d=h(t.textStreams)).next();!f.done;f=d.next())a=f.value,i.push(n.Kc(a));return $(r,e.g.offline.trackSelectionCallback(i),2);case 2:for(s=r.B,u=new Set,c=new Set,f=(d=h(s)).next();!f.done;f=d.next())"variant"==(l=f.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);t.variants=t.variants.filter((function(e){return u.has(e.id)})),t.textStreams=t.textStreams.filter((function(e){return c.has(e.id)})),w(r)}}))}))})),2);case 2:(function(e){if(0==e.periods.length)throw new Z(2,4,4014);for(var t=(e=h(e.periods)).next();!t.done;t=e.next())qu(t.value)})(t),w(n)}}))}))}(e,o,a),7);case 7:return $(i,s.init(),8);case 8:return Yu(e),$(i,function(e){var t=null;if(e.g.forEach((function(e,r){e.getCells().forEach((function(e,n){e.hasFixedKeySpace()||t||(t={path:{Ea:r,ja:n},ja:e})}))})),t)return t;throw new Z(2,9,9013,"Could not find a cell that supports add-operations")}(s),9);case 9:return u=i.B,Yu(e),$(i,function(e,t,r,n,i,o){return g((function a(){var s,u,c,l,d,f,p,y,v,m;return M(a,(function(a){switch(a.s){case 1:return s=function(e,t,r){var n=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.ha(),size:0,expiration:n,tracks:t=Ru(t.periods[0]),appMetadata:r}}(i,n,o),u=n.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos&&e.drmInfos.length}))})),c=n.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos.some((function(e){return e.initData&&e.initData.length}))}))})),d=null,(l=u&&!c)&&(f=r.g,d=Qu.get(f.keySystem)),p=new Ha(e.h,(function(t,r){s.size=r,e.g.offline.progressCallback(s,t)}),(function(t,n){l&&e.g.offline.usePersistentLicense&&d==n&&It(r,"cenc",t)})),I(a,2),v=y=function(e,t,r,n,i,o,a){var s=new xu,u=i.periods.map((function(n){return function(e,t,r,n,i,o){for(var a=h(o.variants),s=a.next();!s.done;s=a.next())Du(n,s.value);for(a=h(o.textStreams),s=a.next();!s.done;s=a.next())n.g[s.value.id]=52;a=function(e){for(var t=new Set,r=h(e.textStreams),n=r.next();!n.done;n=r.next())t.add(n.value);for(e=h(e.variants),r=e.next();!r.done;r=e.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video);return t}(o);var u=new Map;for(a=h(a),s=a.next();!s.done;s=a.next()){var c=Wu(e,t,r,n,i,s=s.value);u.set(s.id,c)}return o.variants.forEach((function(e){e.audio&&u.get(e.audio.id).variantIds.push(e.id),e.video&&u.get(e.video.id).variantIds.push(e.id)})),{startTime:o.startTime,streams:Array.from(u.values())}}(e,t,r,s,i,n)})),c=n.g,l=e.g.offline.usePersistentLicense;return c&&l&&(c.initData=[]),{originalManifestUri:o,duration:i.presentationTimeline.ha(),size:0,expiration:n.Xb(),periods:u,sessionIds:l?Pt(n):[],drmInfo:c,appMetadata:a}}(e,p,t,r,n,i,o),$(a,function(e){return g((function t(){return M(t,(function(t){switch(t.s){case 1:return $(t,Promise.all(e.h.values()),2);case 2:return t.return(e.g.g)}}))}))}(p),4);case 4:if(v.size=a.B,y.expiration=r.Xb(),m=Pt(r),y.sessionIds=e.g.offline.usePersistentLicense?m:[],u&&e.g.offline.usePersistentLicense&&!m.length)throw new Z(2,9,9007);return a.return(y);case 2:return P(a),$(a,p.destroy(),5);case 5:R(a,0)}}))}))}(e,u.ja,a,o,t,r),10);case 10:if(l=i.B,Yu(e),c)throw c;return $(i,u.ja.addManifests([l]),11);case 11:return d=i.B,Yu(e),f=new hs("manifest",u.path.Ea,u.path.ja,d[0]),i.return(Pu(f,l));case 4:return P(i),e.j=!1,e.i=[],$(i,s.destroy(),12);case 12:if(!a){i.I(13);break}return $(i,a.destroy(),13);case 13:R(i,0);break;case 3:if(p=O(i),!u){i.I(15);break}return $(i,u.ja.removeSegments(e.i,(function(){})),15);case 15:throw c||p}}))}))}(this,e,t||{},(function(){return g((function t(){var i,o;return M(t,(function(t){switch(t.s){case 1:return r&&"string"!=typeof r?(Hr("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=r,t.return(new i)):$(t,Ei.create(e,n.h,n.g.manifest.retryParameters,r),2);case 2:return o=t.B,t.return(o)}}))}))})))},Vu.prototype.store=Vu.prototype.store,Vu.prototype.Hf=function(){return this.j},Vu.prototype.getStoreInProgress=Vu.prototype.Hf,Vu.prototype.remove=function(e){return Zu(this,function(e,t){return g((function r(){var n,i,o,a,s,u;return M(r,(function(r){switch(r.s){case 1:return Xu(),null==(n=ps(t))||"manifest"!=n.g?r.return(Promise.reject(new Z(2,9,9004,t))):(i=n,o=new rs,I(r,2),$(r,o.init(),4));case 4:return $(r,ns(o,i.Ea(),i.ja()),5);case 5:return $(r,(a=r.B).getManifests([i.key()]),6);case 6:return s=r.B,u=s[0],$(r,Promise.all([Ku(e,u,o),zu(e,a,i,u)]),2);case 2:return P(r),$(r,o.destroy(),8);case 8:R(r,0)}}))}))}(this,e))},Vu.prototype.remove=Vu.prototype.remove,Vu.prototype.sg=function(){return Zu(this,function(e){return g((function t(){var r,n,i,o,a,s,u,c,l;return M(t,(function(t){switch(t.s){case 1:return Xu(),r=e.h,n=e.g.drm,i=new rs,o=!1,I(t,2),$(t,i.init(),4);case 4:for(a=[],function(e,t){e.g.forEach((function(e){t(e.getEmeSessionCell())}))}(i,(function(e){return a.push(e)})),s=Promise.resolve(),u={},c=h(a),l=c.next();!l.done;u={Jc:u.Jc},l=c.next())u.Jc=l.value,s=s.then(function(e){return function(){return g((function t(){var i,a;return M(t,(function(t){switch(t.s){case 1:return $(t,e.Jc.getAll(),2);case 2:return i=t.B,$(t,As(n,r,i),3);case 3:return a=t.B,$(t,e.Jc.remove(a),4);case 4:a.length!=i.length&&(o=!0),w(t)}}))}))}}(u));return $(t,s,2);case 2:return P(t),$(t,i.destroy(),6);case 6:R(t,3);break;case 3:return t.return(!o)}}))}))}(this))},Vu.prototype.removeEmeSessions=Vu.prototype.sg,Vu.prototype.list=function(){return Zu(this,g((function e(){var t,r,n;return M(e,(function(e){switch(e.s){case 1:return Xu(),t=[],r=new rs,I(e,2),$(e,r.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach((function(e,r){e.getCells().forEach((function(e,n){t({Ea:r,ja:n},e)}))}))}(r,(function(e,r){n=n.then((function(){return g((function n(){return M(n,(function(n){switch(n.s){case 1:return $(n,r.getAllManifests(),2);case 2:n.B.forEach((function(r,n){var i=Pu(new hs("manifest",e.Ea,e.ja,n),r);t.push(i)})),w(n)}}))}))}))})),$(e,n,2);case 2:return P(e),$(e,r.destroy(),6);case 6:R(e,3);break;case 3:return e.return(t)}}))})))},Vu.prototype.list=Vu.prototype.list,Vu.deleteAll=function(){return g((function e(){var t;return M(e,(function(e){switch(e.s){case 1:return t=new rs,I(e,2),$(e,t.erase(),2);case 2:return P(e),$(e,t.destroy(),5);case 5:R(e,0)}}))}))};var Qu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");Vs.offline=Gu,G("shaka.polyfill.installAll",(function(){for(var e=0;e<tc.length;++e)try{tc[e].Xe()}catch(t){X.ba("Error installing polyfill!",t)}}));var Ju,ec,tc=[];function rc(e,t){for(var r={priority:t=t||0,Xe:e},n=0;n<tc.length;n++)if(tc[n].priority<t)return void tc.splice(n,0,r);tc.push(r)}function nc(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var r=new Event(t,e);else(r=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(r)}function ic(e,t,r){if("input"==e&&"range"===this.type)e="change";HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,r)}function oc(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];return(r=e.apply(this,r)).abort=function(){},r}}function ac(e,t){X.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var r=new sc(e,t);return Promise.resolve(r)}catch(n){return Promise.reject(n)}}function sc(e,t){if(X.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(var r=h(t),n=r.next();!n.done;n=r.next()){var i=n.value;if("required"==i.persistentState)n=null;else{n={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var o=!1,a=!1;if(i.audioCapabilities)for(var s=h(i.audioCapabilities),u=s.next();!u.done;u=s.next())if((u=u.value).contentType){o=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(n.audioCapabilities.push(u),a=!0)}if(i.videoCapabilities)for(u=(i=h(i.videoCapabilities)).next();!u.done;u=i.next())(s=u.value).contentType&&(o=!0,u=s.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(n.videoCapabilities.push(s),a=!0));o||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),n=a?n:null}if(n)return void(this.g=n)}throw(r=Error("Unsupported keySystem")).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function uc(e){X.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&lc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?lc(e,this):Promise.resolve()}function cc(e){X.debug("PatchedMediaKeysApple.MediaKeys"),this.h=new WebKitMediaKeys(e),this.g=new tt}function lc(e,t){if(e.g.nb(),!t)return Promise.resolve();e.g.H(t,"webkitneedkey",fc);try{return zo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(r){return Promise.reject(r)}}function dc(e){X.debug("PatchedMediaKeysApple.MediaKeySession"),je.call(this),this.h=null,this.l=e,this.i=this.g=null,this.j=new tt,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new pc}function fc(e){if(X.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=be(e=me(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function hc(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.g=t,e.dispatchEvent(new Be("keystatuseschange"))}function pc(){this.size=0,this.g=void 0}function gc(e,t){X.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var r=new yc(e,t);return Promise.resolve(r)}catch(n){return Promise.reject(n)}}function yc(e,t){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var r=!1,n=0;n<t.length;++n){var i=t[n],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label},a=!1;if(i.audioCapabilities)for(var s=0;s<i.audioCapabilities.length;++s){var u=i.audioCapabilities[s];if(u.contentType){a=!0;var c=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.audioCapabilities.push(u),r=!0)}}if(i.videoCapabilities)for(s=0;s<i.videoCapabilities.length;++s)(u=i.videoCapabilities[s]).contentType&&(a=!0,c=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.videoCapabilities.push(u),r=!0));if(a||(r=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(r=!1),r)return void(this.g=o)}throw(r=Error("Unsupported keySystem")).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function vc(e){X.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&_c(t,null),delete this.mediaKeys,(this.mediaKeys=e)?_c(e,this):Promise.resolve()}function mc(e){X.debug("PatchedMediaKeysMs.MediaKeys"),this.h=new MSMediaKeys(e),this.g=new tt}function _c(e,t){if(e.g.nb(),!t)return Promise.resolve();e.g.H(t,"msneedkey",Ac);try{return zo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.msSetMediaKeys(e.h)})),Promise.resolve()}catch(r){return Promise.reject(r)}}function bc(e){X.debug("PatchedMediaKeysMs.MediaKeySession"),je.call(this),this.i=null,this.l=e,this.h=this.g=null,this.j=new tt,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new Sc}function Ac(e){if(X.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Kn(e);if(1>=t.data.length)return e;e=[];for(var r={},n=(t=h(t.data)).next();!n.done;r={yc:r.yc},n=t.next())r.yc=n.value,e.some(function(e){return function(t){return Te.Ha(t,e.yc)}}(r))||e.push(r.yc);return Te.concat.apply(Te,e instanceof Array?e:function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(h(e)))}(e.initData).buffer,this.dispatchEvent(t)}}function Ec(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.g=t,e.dispatchEvent(new Be("keystatuseschange"))}function Sc(){this.size=0,this.g=void 0}function Tc(){return X.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function $c(e){return X.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function wc(){throw new TypeError("Illegal constructor.")}function Cc(){throw new TypeError("Illegal constructor.")}G("shaka.polyfill.register",rc),rc((function(){Fl()}),-1),rc((function(){if(t.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",nc),document.addEventListener("webkitfullscreenerror",nc),document.addEventListener("mozfullscreenchange",nc),document.addEventListener("mozfullscreenerror",nc),document.addEventListener("MSFullscreenChange",nc),document.addEventListener("MSFullscreenError",nc)}})),rc((function(){X.debug("InputEvent.install"),_t("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(X.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=ic)})),rc((function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})})),rc((function(){X.debug("mathRound.install")})),rc((function(){X.debug("MediaSource.install");var e=mt();t.MediaSource?t.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(X.info("Patching Chromecast MSE bugs."),function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var r=t.split(/ *; */);return r.shift(),r.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}}()):e?(function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),12>=e?(X.info("Patching Safari 11 & 12 MSE bugs."),oc(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,r){return e.call(this,t,r-.001)}}()):(X.info("Patching Safari 13 MSE bugs."),oc())):_t("Tizen 2")||_t("Tizen 3")||_t("Tizen 4")?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=ft(t)[0]&&e(t)}}():X.info("Using native MSE as-is."):X.info("No MSE implementation available.")})),sc.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new cc(this.keySystem);return Promise.resolve(e)},sc.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.g},cc.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new dc(this.h)},cc.prototype.setServerCertificate=function(e){return X.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),Promise.resolve(!0)},H(dc,je),(i=dc.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.g=new ye;try{this.h=this.l.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.h.sessionId||"",this.j.H(this.h,"webkitkeymessage",this.Gg.bind(this)),this.j.H(this.h,"webkitkeyadded",this.Eg.bind(this)),this.j.H(this.h,"webkitkeyerror",this.Fg.bind(this)),hc(this,"status-pending")}catch(r){this.g.reject(r)}return this.g},i.load=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){X.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.i=new ye;try{this.h.update(new Uint8Array(e))}catch(t){this.i.reject(t)}return this.i},i.close=function(){X.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.h.close(),this.closed.resolve(),this.j.nb()}catch(u){this.closed.reject(u)}return this.closed},i.remove=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.Gg=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.g&&(this.g.resolve(),this.g=null),this.dispatchEvent(new Be("message",{messageType:null==this.keyStatuses.g?"license-request":"license-renewal",message:e.message.buffer}))},i.Eg=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.i&&(hc(this,"usable"),this.i.resolve(),this.i=null)},i.Fg=function(e){if(X.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.h.error,null!=this.g)this.g.reject(e),this.g=null;else if(null!=this.i)this.i.reject(e),this.i=null;else switch(this.h.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:hc(this,"output-not-allowed");break;default:hc(this,"internal-error")}},(i=pc.prototype).forEach=function(e){this.g&&e(this.g,Ju)},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Ju;return!(!this.g||!Te.Ha(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},rc((function(){t.HTMLVideoElement&&t.WebKitMediaKeys&&(X.info("Using Apple-prefixed EME"),Ju=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=uc,t.MediaKeys=cc,t.MediaKeySystemAccess=sc,navigator.requestMediaKeySystemAccess=ac)})),yc.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new mc(this.keySystem);return Promise.resolve(e)},yc.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.g},mc.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new bc(this.h)},mc.prototype.setServerCertificate=function(){return X.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},H(bc,je),(i=bc.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.g=new ye;try{this.i=this.l.createSession("video/mp4",new Uint8Array(t),null),this.j.H(this.i,"mskeymessage",this.dg.bind(this)),this.j.H(this.i,"mskeyadded",this.bg.bind(this)),this.j.H(this.i,"mskeyerror",this.cg.bind(this)),Ec(this,"status-pending")}catch(r){this.g.reject(r)}return this.g},i.load=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){X.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.h=new ye;try{this.i.update(new Uint8Array(e))}catch(t){this.h.reject(t)}return this.h},i.close=function(){X.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.i.close(),this.closed.resolve(),this.j.nb()}catch(u){this.closed.reject(u)}return this.closed},i.remove=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.dg=function(e){X.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.g&&(this.g.resolve(),this.g=null),this.dispatchEvent(new Be("message",{messageType:null==this.keyStatuses.g?"license-request":"license-renewal",message:e.message.buffer}))},i.bg=function(e){X.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.g?(X.debug("Simulating completion for a PR persistent license."),Ec(this,"usable"),this.g.resolve(),this.g=null):this.h&&(Ec(this,"usable"),this.h.resolve(),this.h=null)},i.cg=function(e){if(X.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.i.error,null!=this.g)this.g.reject(e),this.g=null;else if(null!=this.h)this.h.reject(e),this.h=null;else switch(this.i.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Ec(this,"output-not-allowed");break;default:Ec(this,"internal-error")}},(i=Sc.prototype).forEach=function(e){this.g&&e(this.g,ec)},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=ec;return!(!this.g||!Te.Ha(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},rc((function(){!t.HTMLVideoElement||!t.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("Using ms-prefixed EME v20140218"),ec=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=vc,t.MediaKeys=mc,t.MediaKeySystemAccess=yc,navigator.requestMediaKeySystemAccess=gc)})),wc.prototype.createSession=function(){},wc.prototype.setServerCertificate=function(){},Cc.prototype.getConfiguration=function(){},Cc.prototype.createMediaKeys=function(){},rc((function(){!t.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("EME not available."),navigator.requestMediaKeySystemAccess=Tc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=$c,t.MediaKeys=wc,t.MediaKeySystemAccess=Cc)}),-10);var Ic,kc="";function Oc(e){return kc?kc+e.charAt(0).toUpperCase()+e.slice(1):e}function Pc(e,t){X.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var r=new xc(e,t);return Promise.resolve(r)}catch(n){return Promise.reject(n)}}function Rc(e){X.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Lc(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Lc(e,this),Promise.resolve()}function xc(e,t){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.g=this.keySystem=e;var r=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",r=!1);var n=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var o=0;o<t.length;++o){var a=t[o],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:a.initDataTypes,sessionTypes:["temporary"],label:a.label},u=!1;if(a.audioCapabilities)for(var c=0;c<a.audioCapabilities.length;++c){var l=a.audioCapabilities[c];if(l.contentType){u=!0;var d=l.contentType.split(";")[0];i.canPlayType(d,this.g)&&(s.audioCapabilities.push(l),n=!0)}}if(a.videoCapabilities)for(c=0;c<a.videoCapabilities.length;++c)(l=a.videoCapabilities[c]).contentType&&(u=!0,i.canPlayType(l.contentType,this.g)&&(s.videoCapabilities.push(l),n=!0));if(u||(n=i.canPlayType("video/mp4",this.g)||i.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(r?(s.persistentState="required",s.sessionTypes=["persistent-license"]):n=!1),n)return void(this.h=s)}throw r="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(r="None of the requested configurations were supported."),(r=Error(r)).name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r}function Dc(e){X.debug("PatchedMediaKeysWebkit.MediaKeys"),this.l=e,this.h=null,this.g=new tt,this.i=[],this.j={}}function Lc(e,t){e.h=t,e.g.nb();var r=kc;t&&(e.g.H(t,r+"needkey",e.hg.bind(e)),e.g.H(t,r+"keymessage",e.Jg.bind(e)),e.g.H(t,r+"keyadded",e.Hg.bind(e)),e.g.H(t,r+"keyerror",e.Ig.bind(e)))}function Nc(e,t){var r=e.j[t];return r?(X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",r),r):(r=e.i.shift())?(r.sessionId=t,e.j[t]=r,X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",r),r):null}function Mc(e,t,r){X.debug("PatchedMediaKeysWebkit.MediaKeySession"),je.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=r,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new jc}function Bc(e,t,r){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(r)var n=new Uint8Array(be("LOAD_SESSION|"+r));else{var i=be("PERSISTENT|"),o=new Uint8Array(i.byteLength+t.byteLength);o.set(new Uint8Array(i),0),o.set(new Uint8Array(t),i.byteLength),n=o}else n=new Uint8Array(t)}catch(s){return Promise.reject(s)}e.h=new ye;var a=Oc("generateKeyRequest");try{e.j[a](e.i,n)}catch(s){if("InvalidStateError"!=s.name)return e.h=null,Promise.reject(s);new ke((function(){try{e.j[a](e.i,n)}catch(t){e.h.reject(t),e.h=null}})).V(.01)}return e.h}function Uc(e,t){var r=e.keyStatuses;r.size=null==t?0:1,r.g=t,e.dispatchEvent(new Be("keystatuseschange"))}function jc(){this.size=0,this.g=void 0}function Fc(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Vc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Gc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Hc(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Kc(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function zc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Wc(e,r,n){return new t.TextTrackCue(e,r,n)}function Yc(e,r,n){return new t.TextTrackCue(e+"-"+r+"-"+n,e,r,n)}function Xc(){}xc.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new Dc(this.g);return Promise.resolve(e)},xc.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.h},(i=Dc.prototype).createSession=function(e){if(X.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new Mc(t,this.l,e),this.i.push(e),e},i.setServerCertificate=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},i.hg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.h.dispatchEvent(t)},i.Jg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Nc(this,e.sessionId);t?(e=new Be("message",{messageType:null==t.keyStatuses.g?"licenserequest":"licenserenewal",message:e.message}),X.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.h&&(t.h.resolve(),t.h=null),t.dispatchEvent(e)):X.error("Session not found",e.sessionId)},i.Hg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Nc(this,e.sessionId))&&(X.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Uc(e,"usable"),e.g&&e.g.resolve(),e.g=null)},i.Ig=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Nc(this,e.sessionId);t&&t.handleError(e)},H(Mc,je),(i=Mc.prototype).handleError=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),r=e.errorCode;r.systemCode=e.systemCode,t.errorCode=r,!e.sessionId&&this.h?(45==e.systemCode&&(t.message="Unsupported session type."),this.h.reject(t),this.h=null):e.sessionId&&this.g?(this.g.reject(t),this.g=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Uc(this,"output-restricted"):Uc(this,1==t?"expired":"internal-error"))},i.Qd=function(e,t){if(this.g)this.g.then(this.Qd.bind(this,e,t)).catch(this.Qd.bind(this,e,t));else{if(this.g=e,"webkit-org.w3.clearkey"==this.i){var r=ve(t),n=JSON.parse(r);"oct"!=n.keys[0].kty&&(this.g.reject(Error("Response is not a valid JSON Web Key Set.")),this.g=null),r=Te.Ja(n.keys[0].k),n=Te.Ja(n.keys[0].kid)}else r=new Uint8Array(t),n=null;var i=Oc("addKey");try{this.j[i](this.i,r,n,this.sessionId)}catch(o){this.g.reject(o),this.g=null}}},i.generateRequest=function(e,t){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Bc(this,t,null)},i.load=function(e){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.l?Bc(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new ye;return this.Qd(t,e),t},i.close=function(){if(X.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Oc("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},i.remove=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(i=jc.prototype).forEach=function(e){this.g&&e(this.g,Ic)},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Ic;return!(!this.g||!Te.Ha(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},rc((function(){if(!(!t.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)X.info("Using webkit-prefixed EME v0.1b"),kc="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;X.info("Using nonprefixed EME v0.1b")}Ic=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Pc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Rc,t.MediaKeys=Dc,t.MediaKeySystemAccess=xc}})),rc((function(){if(t.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(X.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=Vc,Object.defineProperty(e,"disablePictureInPicture",{get:Hc,set:Kc,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Gc,document.addEventListener("webkitpresentationmodechanged",Fc,!0))}})),rc((function(){if(X.debug("VideoPlayPromise.install"),t.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch((function(){})),t}}})),rc((function(){if(t.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in e&&(e.getVideoPlaybackQuality=zc)}})),rc((function(){if(t.VTTCue)X.info("Using native VTTCue.");else if(t.TextTrackCue){var e=TextTrackCue.length;if(3==e)X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),t.VTTCue=Wc;else if(6==e)X.info("Using VTTCue polyfill from 6 argument TextTrackCue."),t.VTTCue=Yc;else{try{var r=!!Wc(1,2,"")}catch(n){r=!1}r&&(X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),t.VTTCue=Wc)}}else X.error("VTTCue not available.")})),G("shaka.text.TtmlTextParser",Xc),Xc.prototype.parseInit=function(){},Xc.prototype.parseInit=Xc.prototype.parseInit,Xc.prototype.parseMedia=function(e,t){var r=ve(e),n=[],i=new DOMParser,o=null;if(""==r)return n;try{o=i.parseFromString(r,"text/xml")}catch(b){throw new Z(2,2,2005,"Failed to parse TTML.")}if(o){if(r=o.getElementsByTagName("parsererror")[0])throw new Z(2,2,2005,r.textContent);if(!(i=o.getElementsByTagName("tt")[0]))throw new Z(2,2,2005,"TTML does not contain <tt> tag.");var a=zn.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=zn.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=zn.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=zn.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","tickRate");if(o=i.getAttribute("xml:space")||"default",r=zn.getAttributeNS(i,"http://www.w3.org/ns/ttml#styling","extent"),"default"!=o&&"preserve"!=o)throw new Z(2,2,2005,"Invalid xml:space value: "+o);o="default"==o,a=new Al(a,s,u,c),s=cl(i.getElementsByTagName("metadata")[0]),u=cl(i.getElementsByTagName("styling")[0]),c=cl(i.getElementsByTagName("layout")[0]);for(var l=[],d=0;d<c.length;d++){var f,p,g=c[d],y=u,v=r,m=new fr,_=g.getAttribute("xml:id");if(_)m.id=_,_=null,v&&(_=Qc.exec(v)||el.exec(v)),v=_?Number(_[1]):null,_=_?Number(_[2]):null,(f=gl(g,y,"extent"))&&(null!=(f=(p=Qc.exec(f))||el.exec(f))&&(m.width=null!=v?100*Number(f[1])/v:Number(f[1]),m.height=null!=_?100*Number(f[2])/_:Number(f[2]),m.widthUnits=p||null!=v?hr:0,m.heightUnits=p||null!=_?hr:0)),(g=gl(g,y,"origin"))&&(null!=(f=(p=Qc.exec(g))||el.exec(g))&&(m.viewportAnchorX=null!=v?100*Number(f[1])/v:Number(f[1]),m.viewportAnchorY=null!=_?100*Number(f[2])/_:Number(f[2]),m.viewportAnchorUnits=p||null!=v?hr:0));else X.v("TtmlTextParser parser encountered a region with no id. Region will be ignored."),m=null;m&&l.push(m)}for(r=ll(i.getElementsByTagName("body")[0]),i=(r=h(r)).next();!i.done;i=r.next())(i=fl(i.value,t.periodStart,a,s,u,c,l,o,!1))&&n.push(i)}return n},Xc.prototype.parseMedia=Xc.prototype.parseMedia;var Zc,qc,Qc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Jc=/^(\d+px|\d+em)$/,el=/^(\d+)px (\d+)px$/,tl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,rl=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,nl=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,il=/^(\d*(?:\.\d*)?)f$/,ol=/^(\d*(?:\.\d*)?)t$/,al=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,sl={left:sr,center:"center",right:"end",start:sr,end:"end"},ul={left:"line-left",center:"center",right:"line-right"};function cl(e){var t=[];if(!e)return t;for(var r=h(e.childNodes),n=r.next();!n.done;n=r.next())(n=n.value).nodeType==Node.ELEMENT_NODE&&"br"!==n.nodeName&&(n=cl(n),t=t.concat(n));return t.length||t.push(e),t}function ll(e){if(!e)return[];for(var t=[],r=(e=h(e.childNodes)).next();!r.done;r=e.next())(r=r.value)instanceof Element&&(r.hasAttribute("begin")?t.push(r):t=t.concat(ll(r)));return t}function dl(e,t){for(var r="",n=h(e.childNodes),i=n.next();!i.done;i=n.next())"br"==(i=i.value).nodeName&&e.childNodes[0]!==i?r+="\n":i.childNodes&&0<i.childNodes.length?r+=dl(i,t):t?r+=i=(i=i.textContent.trim()).replace(/\s+/g," "):r+=i.textContent;return r}function fl(e,t,r,n,i,o,a,s,u){if(u&&"br"==e.nodeName)return(e=new Qt(0,0,"")).spacer=!0,e;var c=/^[\s\n]*$/.test(e.textContent),l=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;s="default"==(e.getAttribute("xml:space")||(s?"default":"preserve")),c=_l(e.getAttribute("begin"),r),l=_l(e.getAttribute("end"),r);var d=_l(e.getAttribute("dur"),r);if(null==l&&null!=d&&(l=c+d),!u&&(null==c||null==l))throw new Z(2,2,2001);if(c=u&&null==c?0:c+t,l=u&&null==l?0:l+t,d="",u=[],Array.from(e.childNodes).find((function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)})))d=dl(e,s);else for(var f=h(e.childNodes),p=f.next();!p.done;p=f.next())(p=fl(p.value,t,r,n,i,o,a,s,!0))&&(p.startTime=p.startTime||c,p.endTime=p.endTime||l,u.push(p));if((t=new Qt(c,l,d)).nestedCues=u,(o=ml(e,"region",o,"")[0])&&o.getAttribute("xml:id")){var g=o.getAttribute("xml:id");t.region=a.filter((function(e){return e.id==g}))[0]}return function(e,t,r,n,i){"rtl"==pl(t,r,i,"direction")&&(e.direction="rtl");var o=pl(t,r,i,"writingMode");"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=ir),(o=pl(t,r,i,"textAlign"))?(e.positionAlign=ul[o],e.lineAlign=sl[o],e.textAlign=tr[o.toUpperCase()]):e.textAlign="start",(o=pl(t,r,i,"displayAlign"))&&(e.displayAlign=nr[o.toUpperCase()]);(o=pl(t,r,i,"color"))&&(e.color=o);(o=pl(t,r,i,"backgroundColor"))&&(e.backgroundColor=o);(o=pl(t,r,i,"fontFamily"))&&(e.fontFamily=o);(o=pl(t,r,i,"fontWeight"))&&"bold"==o&&(e.fontWeight=700),(o=pl(t,r,i,"wrapOption"))&&"noWrap"==o&&(e.wrapLine=!1),(o=pl(t,r,i,"lineHeight"))&&o.match(Jc)&&(e.lineHeight=o),(o=pl(t,r,i,"fontSize"))&&o.match(Jc)&&(e.fontSize=o),(o=pl(t,r,i,"fontStyle"))&&(e.fontStyle=dr[o.toUpperCase()]);if(n){o=n.getAttribute("imageType")||n.getAttribute("imagetype");var a=n.getAttribute("encoding");n=n.textContent.trim(),"PNG"==o&&"Base64"==a&&n&&(e.backgroundImage="data:image/png;base64,"+n)}(r=gl(r,i,"textDecoration"))&&hl(e,r),(t=yl(t,i,"textDecoration"))&&hl(e,t)}(t,e,o,n=ml(e,"backgroundImage",n,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0],i),t}function hl(e,t){for(var r=t.split(" "),n=0;n<r.length;n++)switch(r[n]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ge(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ge(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ge(e.textDecoration,"overline")}}function pl(e,t,r,n){return(e=yl(e,r,n))?e:gl(t,r,n)}function gl(e,t,r){if(!e)return null;for(var n=cl(e),i=0;i<n.length;i++){var o=zn.getAttributeNS(n[i],"http://www.w3.org/ns/ttml#styling",r);if(o)return o}return vl(e,t,r)}function yl(e,t,r){var n=zn.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",r);return n||vl(e,t,r)}function vl(e,t,r){e=ml(e,"style",t,"");for(var n=null,i=0;i<e.length;i++){var o=zn.getAttributeNS(e[i],"http://www.w3.org/ns/ttml#styling",r);o||(o=yl(e[i],t,r)),o&&(n=o)}return n}function ml(e,t,r,n,i){var o=[];if(!e||1>r.length)return o;var a=e;for(e=null;a&&!(e=i?zn.getAttributeNS(a,i,t):a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(i=(t=h(t=t.split(" "))).next();!i.done;i=t.next())for(i=i.value,a=(e=h(r)).next();!a.done;a=e.next())if(n+(a=a.value).getAttribute("xml:id")==i){o.push(a);break}return o}function _l(e,t){var r=null;if(tl.test(e)){r=tl.exec(e);var n=Number(r[1]),i=Number(r[2]),o=Number(r[3]),a=Number(r[4]);r=(o+=(a+=(Number(r[5])||0)/t.h)/t.frameRate)+60*i+3600*n}else rl.test(e)?r=bl(rl,e):nl.test(e)?r=bl(nl,e):il.test(e)?(r=il.exec(e),r=Number(r[1])/t.frameRate):ol.test(e)?(r=ol.exec(e),r=Number(r[1])/t.g):al.test(e)&&(r=bl(al,e));return r}function bl(e,t){var r=e.exec(t);return null==r||""==r[0]?null:(Number(r[4])||0)/1e3+(Number(r[3])||0)+60*(Number(r[2])||0)+3600*(Number(r[1])||0)}function Al(e,t,r,n){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(n),0==this.g&&(this.g=e?this.frameRate*this.h:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function El(){this.g=new Xc}function Sl(){}function Tl(e,t,r){var n;if(n=/^align:(start|middle|center|end|left|right)$/.exec(t))t=n[1],e.textAlign="middle"==t?er:tr[t.toUpperCase()];else if(n=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==n[1]?"vertical-lr":"vertical-rl";else if(n=/^size:([\d.]+)%$/.exec(t))e.size=Number(n[1]);else if(n=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(n[1]),n[2]&&(t=n[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(n=/^region:(.*)$/.exec(t))){e:{if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(r[1]),r[2]&&(e.lineAlign=ur[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=ar,e.line=Number(r[1]),r[2]&&(e.lineAlign=ur[r[2].toUpperCase()])}e=!0}return e}(t=function(e,t){var r=e.filter((function(e){return e.id==t}));return r.length?r[0]:(X.v("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}(r,n[1]))&&(e.region=t)}return!0}function $l(e){if(null==(e=Vi(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)}function wl(){this.g=null}function Cl(e,t,r){var n,i,o;return(new Bn).box("payl",Fn((function(e){n=ve(e)}))).box("iden",Fn((function(e){i=ve(e)}))).box("sttg",Fn((function(e){o=ve(e)}))).parse(e),n?function(e,t,r,n,i){if(e=new Qt(n,i,e),t&&(e.id=t),r)for(t=new ji(r),r=Gi(t);r;)Tl(e,r,[])||X.v("VTT parser encountered an invalid VTT setting: ",r," The setting will be ignored."),Fi(t),r=Gi(t);return e}(n,i,o,t,r):null}function Il(){}function kl(){Zc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Zc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Ol):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function Ol(e,t){var r=this;return g((function n(){var i;return M(n,(function(n){switch(n.s){case 1:return console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),$(n,Zc.call(r,e,t),2);case 2:return Ul(i=n.B)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Zc,n.return(i)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=Pl,n.return(Pl.call(r,e,t)))}}))}))}function Pl(e,t){var r=this;return g((function n(){var i,o,a,s,u,c,l,d;return M(n,(function(n){switch(n.s){case 1:console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),i=Bl(e),o=[];for(var f=h(t),p=f.next();!p.done;p=f.next())a=p.value,s=Rl(a.videoCapabilities,i),u=Rl(a.audioCapabilities,i),a.videoCapabilities&&a.videoCapabilities.length&&!s.length||a.audioCapabilities&&a.audioCapabilities.length&&!u.length||((c=Object.assign({},a)).videoCapabilities=s,c.audioCapabilities=u,o.push(c));if(!o.length)throw(l=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",l.code=DOMException.NOT_SUPPORTED_ERR,l;return $(n,Zc.call(r,e,o),2);case 2:return d=n.B,n.return(new Ml(d,i))}}))}))}function Rl(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function xl(){}function Dl(){qc?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(qc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Ll):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Ll(e){var t=this;return g((function r(){var n,i;return M(r,(function(r){switch(r.s){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),$(r,qc.call(t,e),2);case 2:return n=r.B,e.keySystemConfiguration?(i=n.keySystemAccess)&&Ul(i)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=qc,r.return(n)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Nl,r.return(Nl.call(t,e))):r.return(n)}}))}))}function Nl(e){var t=this;return g((function r(){var n,i,o,a,s,u,c,l,d;return M(r,(function(r){switch(r.s){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=null,e.keySystemConfiguration&&(i=e.keySystemConfiguration,o=i.keySystem,a=i.audio&&i.audio.encryptionScheme,s=i.video&&i.video.encryptionScheme,n=Bl(o),u={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},a&&a!=n||s&&s!=n)?r.return(u):$(r,qc.call(t,e),2);case 2:if((c=r.B).keySystemAccess){c.keySystemAccess=new Ml(c.keySystemAccess,n),r.I(3);break}if(!e.keySystemConfiguration){r.I(3);break}var f=e.keySystemConfiguration,h=[],p=[];return f.audio&&h.push({robustness:f.audio.robustness||"",contentType:e.audio.contentType}),f.video&&p.push({robustness:f.video.robustness||"",contentType:e.video.contentType}),f={initDataTypes:f.initDataType?[f.initDataType]:[],distinctiveIdentifier:f.distinctiveIdentifier,persistentState:f.persistentState,sessionTypes:f.sessionTypes},h.length&&(f.audioCapabilities=h),p.length&&(f.videoCapabilities=p),l=f,d=c,$(r,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[l]),5);case 5:d.keySystemAccess=r.B;case 3:return r.return(c)}}))}))}function Ml(e,t){this.h=e,this.g=t,this.keySystem=e.keySystem}function Bl(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Ul(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function jl(){}function Fl(){kl(),Dl()}yr["application/ttml+xml"]=Xc,G("shaka.text.Mp4TtmlParser",El),El.prototype.parseInit=function(e){var t=!1;if((new Bn).box("moov",Un).box("trak",Un).box("mdia",Un).box("minf",Un).box("stbl",Un).ma("stsd",jn).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new Z(2,2,2007)},El.prototype.parseInit=El.prototype.parseInit,El.prototype.parseMedia=function(e,t){var r=!1,n=[];if((new Bn).box("mdat",Fn(function(e){r=!0,n=n.concat(this.g.parseMedia(e,t))}.bind(this))).parse(e),!r)throw new Z(2,2,2007);return n},El.prototype.parseMedia=El.prototype.parseMedia,yr['application/mp4; codecs="stpp"']=El,yr['application/mp4; codecs="stpp.ttml.im1t"']=El,yr['application/mp4; codecs="stpp.TTML.im1t"']=El,G("shaka.text.VttTextParser",Sl),Sl.prototype.parseInit=function(){},Sl.prototype.parseInit=Sl.prototype.parseInit,Sl.prototype.parseMedia=function(e,t){var r=ve(e);if(r=(r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(r[0]))throw new Z(2,2,2e3);var n=t.segmentStart;if(null==n&&(n=0,r[0].includes("X-TIMESTAMP-MAP"))){var i=r[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=r[0].match(/MPEGTS:(\d+)/m);if(i&&o){if(null==(n=$l(new ji(i[1]))))throw new Z(2,2,2e3);n=t.periodStart+(Number(o[1])/9e4-n)}}o=[];var a=r[0].split("\n");for(i=1;i<a.length;i++)if(/^Region:/.test(a[i])){var s=new ji(a[i]),u=new fr;Gi(s),Fi(s);for(var c=Gi(s);c;){var l;e:{var d=u,f=c;if(l=/^id=(.*)$/.exec(f))d.id=l[1];else if(l=/^width=(\d{1,2}|100)%$/.exec(f))d.width=Number(l[1]);else if(l=/^lines=(\d+)$/.exec(f))d.height=Number(l[1]),d.heightUnits=2;else if(l=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))d.regionAnchorX=Number(l[1]),d.regionAnchorY=Number(l[2]);else if(l=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))d.viewportAnchorX=Number(l[1]),d.viewportAnchorY=Number(l[2]);else{if(!/^scroll=up$/.exec(f)){l=!1;break e}d.scroll="up"}l=!0}l||X.v("VTT parser encountered an invalid VTTRegion setting: ",c," The setting will be ignored."),Fi(s),c=Gi(s)}o.push(u)}for(i=[],s=1;s<r.length;s++){if(l=a=r[s].split("\n"),d=n,a=o,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0])a=null;else{u=null,l[0].includes("--\x3e")||(u=l[0],l.splice(0,1)),f=$l(c=new ji(l[0]));var h=Vi(c,/[ \t]+--\x3e[ \t]+/g),p=$l(c);if(null==f||null==h||null==p)throw new Z(2,2,2001);for(l=new Qt(f+d,p+d,l.slice(1).join("\n").trim()),Fi(c),d=Gi(c);d;)Tl(l,d,a)||X.v("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Fi(c),d=Gi(c);null!=u&&(l.id=u),a=l}a&&i.push(a)}return i},Sl.prototype.parseMedia=Sl.prototype.parseMedia,yr["text/vtt"]=Sl,yr['text/vtt; codecs="vtt"']=Sl,yr['text/vtt; codecs="wvtt"']=Sl,G("shaka.text.Mp4VttParser",wl),wl.prototype.parseInit=function(e){var t=!1;if((new Bn).box("moov",Un).box("trak",Un).box("mdia",Un).ma("mdhd",function(e){0==e.version?(e.reader.U(4),e.reader.U(4),this.g=e.reader.N(),e.reader.U(4)):(e.reader.U(8),e.reader.U(8),this.g=e.reader.N(),e.reader.U(8)),e.reader.U(4)}.bind(this)).box("minf",Un).box("stbl",Un).ma("stsd",jn).box("wvtt",(function(){t=!0})).parse(e),!this.g)throw new Z(2,2,2008);if(!t)throw new Z(2,2,2008)},wl.prototype.parseInit=wl.prototype.parseInit,wl.prototype.parseMedia=function(e,t){var r=this;if(!this.g)throw X.error("No init segment for MP4+VTT!"),new Z(2,2,2008);var n,i=0,o=[],a=[],s=!1,u=!1,c=!1,l=null;if((new Bn).box("moof",Un).box("traf",Un).ma("tfdt",(function(e){s=!0,i=0==e.version?e.reader.N():e.reader.Pb()})).ma("tfhd",(function(e){var t=e.flags;(e=e.reader).U(4),1&t&&e.U(8),2&t&&e.U(4),l=8&t?e.N():null})).ma("trun",(function(e){u=!0;var t=e.version,r=e.flags,n=(e=e.reader).N();1&r&&e.U(4),4&r&&e.U(4);for(var i=[],a=0;a<n;a++){var s={duration:null,sampleSize:null,Sd:null};256&r&&(s.duration=e.N()),512&r&&(s.sampleSize=e.N()),1024&r&&e.U(4),2048&r&&(s.Sd=0==t?e.N():e.De()),i.push(s)}o=i})).box("mdat",Fn((function(e){c=!0,n=e}))).parse(e),!c&&!s&&!u)throw new Z(2,2,2008);var d=i,f=new Ln(new DataView(n.buffer,n.byteOffset,n.byteLength),0);return o.forEach((function(e){var n=e.duration||l,o=e.Sd?i+e.Sd:d;d=o+(n||0);var s=0;do{var u=f.N();s+=u;var c=f.N(),h=null;"vttc"==(c=Gn(c))?8<u&&(h=f.mb(u-8)):("vtte"!=c&&X.error("Unknown box "+c+"! Skipping!"),f.U(u-8)),n?h&&a.push(Cl(h,t.periodStart+o/r.g,t.periodStart+d/r.g)):X.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&s<e.sampleSize)})),a.filter(de.Ra)},wl.prototype.parseMedia=wl.prototype.parseMedia,yr['application/mp4; codecs="wvtt"']=wl,G("shaka.util.Dom.createHTMLElement",(function(e){return document.createElement(e)})),G("shaka.util.Dom.createVideoElement",(function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e})),G("shaka.util.Dom.asHTMLElement",(function(e){return e})),G("shaka.util.Dom.asHTMLMediaElement",(function(e){return e})),G("shaka.util.Dom.removeAllChildren",(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})),G("EmeEncryptionSchemePolyfill",Il),Il.install=kl,G("McEncryptionSchemePolyfill",xl),xl.install=Dl,Ml.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var t=h(e.videoCapabilities),r=t.next();!r.done;r=t.next())r.value.encryptionScheme=this.g;if(e.audioCapabilities)for(r=(t=h(e.audioCapabilities)).next();!r.done;r=t.next())r.value.encryptionScheme=this.g;return e},Ml.prototype.createMediaKeys=function(){return this.h.createMediaKeys()},G("EncryptionSchemePolyfills",jl),jl.install=Fl,void 0!==n&&n.gf&&(n.gf=jl)}.call(n,r,r,void 0),n.shaka)t[i]=n.shaka[i]}()}(shakaPlayer_compiled);var ShakaJsPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),_defineProperty$3(_assertThisInitialized$2(n=t.call(this,e)),"onAdaptation_",(function(){n.shakaplayer.getVariantTracks().forEach((function(e){if(e.active)for(var t=0;t<this.content.length;++t){var r=this.content[t];r.value===e.id?r.selected=!0:r.selected=!1}}))})),shakaPlayer_compiled.polyfill.installAll(),n}return _createClass$3(r,[{key:"afterCreate",value:function(){var e=this;this.content=[],this.url=this.player.config.url,shakaPlayer_compiled.Player.isBrowserSupported()&&this.on(URL_CHANGE,(function(t){/^blob/.test(t)||(e.url=t,e.loadUrl(t))}))}},{key:"beforePlayerInit",value:function(){if(!shakaPlayer_compiled.Player.isBrowserSupported())throw new Error("Browser not supported!");this._initShaka()}},{key:"destroy",value:function(){this.shakaplayer&&(this.shakaplayer.destroy(),this.shakaplayer=null)}},{key:"_initShaka",value:function(){var e=this.player;this.shakaplayer=new shakaPlayer_compiled.Player(e.video),this.shakaplayer.addEventListener("error",(function(e){console.error("Error code",e.detail.code,"object",e.detail)})),this.config.shakaOpts&&this.shakaplayer.configure(this.config.shakaOpts),this.shakaplayer.getNetworkingEngine().registerRequestFilter((function(e,t){e===shakaPlayer_compiled.net.NetworkingEngine.RequestType.LICENSE&&(t.headers["CWIP-Auth-Header"]="VGhpc0lzQVRlc3QK")})),this.shakaplayer.addEventListener("adaptation",this.onAdaptation_);this.shakaplayer.configure({abr:{enabled:!1}}),this.loadUrl(this.url)}},{key:"loadUrl",value:function(e){var t=this;this.shakaplayer.load(e).then((function(){console.log(" this.onTracksChanged_"),t.onTracksChanged_()})).catch((function(e){console.trace("event",e),console.error("Error code",e.detail.code,"object",e.detail)}))}},{key:"onTracksChanged_",value:function(){this.updateVariantTracks_()}},{key:"updateVariantTracks_",value:function(){var e=this.shakaplayer.getVariantTracks();e.sort((function(e,t){return e.bandwidth-t.bandwidth})),this.updateTrackOptions_(e)}},{key:"updateTrackOptions_",value:function(e){var t=this,r={variant:function(e){var t="";return e.width&&e.height&&(t+=e.height+"P"),t}};this.content=[],e.forEach((function(e){var n={};n.textContent=r[e.type](e),n.track=e,n.value=e.id,n.selected=e.active,t.content.push(n)})),this.updateDefinition()}},{key:"updateDefinition",value:function(){"mobile"!==sniffer.device&&console.log("updateDefinition",this.content)}}],[{key:"pluginName",get:function(){return"ShakaPlugin"}},{key:"defaultConfig",get:function(){return{shakaOpts:{}}}},{key:"isSupported",value:function(){return shakaPlayer_compiled.Player.isBrowserSupported()}}]),r}(BasePlugin),$$U=_export$1,uncurryThis$G=functionUncurryThis$1,$IndexOf$1=arrayIncludes$1.indexOf,arrayMethodIsStrict$8=arrayMethodIsStrict$d,un$IndexOf$1=uncurryThis$G([].indexOf),NEGATIVE_ZERO$1=!!un$IndexOf$1&&1/un$IndexOf$1([1],1,-0)<0,STRICT_METHOD$7=arrayMethodIsStrict$8("indexOf");$$U({target:"Array",proto:!0,forced:NEGATIVE_ZERO$1||!STRICT_METHOD$7},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return NEGATIVE_ZERO$1?un$IndexOf$1(this,e,t)||0:$IndexOf$1(this,e,t)}});var $$T=_export$1,bind$7=functionBind;$$T({target:"Function",proto:!0,forced:Function.bind!==bind$7},{bind:bind$7});var uncurryThis$F=functionUncurryThis$1,redefine=redefine$h.exports,DatePrototype$1=Date.prototype,INVALID_DATE$1="Invalid Date",TO_STRING$2="toString",un$DateToString$1=uncurryThis$F(DatePrototype$1[TO_STRING$2]),getTime$2=uncurryThis$F(DatePrototype$1.getTime);String(new Date(NaN))!=INVALID_DATE$1&&redefine(DatePrototype$1,TO_STRING$2,(function(){var e=getTime$2(this);return e==e?un$DateToString$1(this):INVALID_DATE$1}));var $$S=_export$1,global$A=global$1T,apply$6=functionApply$1,isCallable$o=isCallable$Q,userAgent$5=engineUserAgent$1,arraySlice$7=arraySlice$j,validateArgumentsLength$3=validateArgumentsLength$7,MSIE$1=/MSIE .\./.test(userAgent$5),Function$3=global$A.Function,wrap$2=function(e){return function(t,r){var n=validateArgumentsLength$3(arguments.length,1)>2,i=isCallable$o(t)?t:Function$3(t),o=n?arraySlice$7(arguments,2):void 0;return e(n?function(){apply$6(i,this,o)}:i,r)}};$$S({global:!0,bind:!0,forced:MSIE$1},{setTimeout:wrap$2(global$A.setTimeout),setInterval:wrap$2(global$A.setInterval)});var global$z=global$1T,fails$A=fails$1m,uncurryThis$E=functionUncurryThis$1,toString$j=toString$A,trim$4=stringTrim$1.trim,whitespaces$6=whitespaces$9,$parseInt$3=global$z.parseInt,_Symbol$7=global$z.Symbol,ITERATOR$6=_Symbol$7&&_Symbol$7.iterator,hex$1=/^[+-]?0x/i,exec$6=uncurryThis$E(hex$1.exec),FORCED$8=8!==$parseInt$3(whitespaces$6+"08")||22!==$parseInt$3(whitespaces$6+"0x16")||ITERATOR$6&&!fails$A((function(){$parseInt$3(Object(ITERATOR$6))})),numberParseInt$1=FORCED$8?function(e,t){var r=trim$4(toString$j(e));return $parseInt$3(r,t>>>0||(exec$6(hex$1,r)?16:10))}:$parseInt$3,$$R=_export$1,$parseInt$2=numberParseInt$1;$$R({global:!0,forced:parseInt!=$parseInt$2},{parseInt:$parseInt$2});var $$Q=_export$1,uncurryThis$D=functionUncurryThis$1,fails$z=fails$1m,ArrayBufferModule$1=arrayBuffer,anObject$j=anObject$E,toAbsoluteIndex$4=toAbsoluteIndex$c,toLength$6=toLength$g,speciesConstructor$3=speciesConstructor$8,ArrayBuffer$1=ArrayBufferModule$1.ArrayBuffer,DataView$1=ArrayBufferModule$1.DataView,DataViewPrototype=DataView$1.prototype,un$ArrayBufferSlice=uncurryThis$D(ArrayBuffer$1.prototype.slice),getUint8=uncurryThis$D(DataViewPrototype.getUint8),setUint8=uncurryThis$D(DataViewPrototype.setUint8),INCORRECT_SLICE=fails$z((function(){return!new ArrayBuffer$1(2).slice(1,void 0).byteLength}));$$Q({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:INCORRECT_SLICE},{slice:function(e,t){if(un$ArrayBufferSlice&&void 0===t)return un$ArrayBufferSlice(anObject$j(this),e);for(var r=anObject$j(this).byteLength,n=toAbsoluteIndex$4(e,r),i=toAbsoluteIndex$4(void 0===t?r:t,r),o=new(speciesConstructor$3(this,ArrayBuffer$1))(toLength$6(i-n)),a=new DataView$1(this),s=new DataView$1(o),u=0;n<i;)setUint8(s,u++,getUint8(a,n++));return o}});var $$P=_export$1,forEach$3=arrayForEach$1;$$P({target:"Array",proto:!0,forced:[].forEach!=forEach$3},{forEach:forEach$3});var $$O=_export$1,$reduce=arrayReduce.left,arrayMethodIsStrict$7=arrayMethodIsStrict$d,CHROME_VERSION=engineV8Version$1,IS_NODE$3=engineIsNode$1,STRICT_METHOD$6=arrayMethodIsStrict$7("reduce"),CHROME_BUG=!IS_NODE$3&&CHROME_VERSION>79&&CHROME_VERSION<83;$$O({target:"Array",proto:!0,forced:!STRICT_METHOD$6||CHROME_BUG},{reduce:function(e){var t=arguments.length;return $reduce(this,e,t,t>1?arguments[1]:void 0)}});var eventEmitter={exports:{}},d$1={exports:{}},_undefined$1=void 0,is$4=function(e){return e!==_undefined$1&&null!==e},isValue$6=is$4,possibleTypes={object:!0,function:!0,undefined:!0},is$3=function(e){return!!isValue$6(e)&&hasOwnProperty.call(possibleTypes,_typeof$3(e))},isObject$k=is$3,is$2=function(e){if(!isObject$k(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(error){return!1}},isPrototype=is$2,is$1=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(error){return!1}return!isPrototype(e)},isFunction=is$1,classRe=/^\s*class[\s{/}]/,functionToString$2=Function.prototype.toString,is=function(e){return!!isFunction(e)&&!classRe.test(functionToString$2.call(e))},isImplemented$2=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},isImplemented$1=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}},noop$1=function(){},_undefined=noop$1(),isValue$5=function(e){return e!==_undefined&&null!==e},isValue$4=isValue$5,keys$6=Object.keys,shim$2=function(e){return keys$6(isValue$4(e)?Object(e):e)},keys$5=isImplemented$1()?Object.keys:shim$2,isValue$3=isValue$5,validValue=function(e){if(!isValue$3(e))throw new TypeError("Cannot use null or undefined");return e},keys$4=keys$5,value$1=validValue,max$4=Math.max,shim$1=function(t,r){var n,i,o,a=max$4(arguments.length,2);for(t=Object(value$1(t)),o=function(i){try{t[i]=r[i]}catch(e){n||(n=e)}},i=1;i<a;++i)keys$4(r=arguments[i]).forEach(o);if(void 0!==n)throw n;return t},assign$1=isImplemented$2()?Object.assign:shim$1,isValue$2=isValue$5,forEach$2=Array.prototype.forEach,create$1=Object.create,process$5=function(e,t){var r;for(r in e)t[r]=e[r]},normalizeOptions=function(e){var t=create$1(null);return forEach$2.call(arguments,(function(e){isValue$2(e)&&process$5(Object(e),t)})),t},str="razdwatrzy",isImplemented=function(){return"function"==typeof str.contains&&(!0===str.contains("dwa")&&!1===str.contains("foo"))},indexOf$2=String.prototype.indexOf,shim=function(e){return indexOf$2.call(this,e,arguments[1])>-1},contains$2=isImplemented()?String.prototype.contains:shim,isValue$1=is$4,isPlainFunction=is,assign=assign$1,normalizeOpts=normalizeOptions,contains$1=contains$2,d=d$1.exports=function(e,t){var r,n,i,o,a;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],isValue$1(e)?(r=contains$1.call(e,"c"),n=contains$1.call(e,"e"),i=contains$1.call(e,"w")):(r=i=!0,n=!1),a={value:t,configurable:r,enumerable:n,writable:i},o?assign(normalizeOpts(o),a):a};d.gs=function(e,t,r){var n,i,o,a;return"string"!=typeof e?(o=r,r=t,t=e,e=null):o=arguments[3],isValue$1(t)?isPlainFunction(t)?isValue$1(r)?isPlainFunction(r)||(o=r,r=void 0):r=void 0:(o=t,t=r=void 0):t=void 0,isValue$1(e)?(n=contains$1.call(e,"c"),i=contains$1.call(e,"e")):(n=!0,i=!1),a={get:t,set:r,configurable:n,enumerable:i},o?assign(normalizeOpts(o),a):a};var validCallable=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e};!function(e,t){var r,n,i,o,a,s,u,c=d$1.exports,l=validCallable,d=Function.prototype.apply,f=Function.prototype.call,h=Object.create,p=Object.defineProperty,g=Object.defineProperties,y=Object.prototype.hasOwnProperty,v={configurable:!0,enumerable:!1,writable:!0};n=function(e,t){var n,o;return l(t),o=this,r.call(this,e,n=function(){i.call(o,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},o=function(e){var t,r,n,i,o;if(y.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"===_typeof$3(i)){for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;n=i[t];++t)d.call(n,this,o)}else switch(arguments.length){case 1:f.call(i,this);break;case 2:f.call(i,this,arguments[1]);break;case 3:f.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];d.call(i,this,o)}},a={on:r=function(e,t){var r;return l(t),y.call(this,"__ee__")?r=this.__ee__:(r=v.value=h(null),p(this,"__ee__",v),v.value=null),r[e]?"object"===_typeof$3(r[e])?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:n,off:i=function(e,t){var r,n,i,o;if(l(t),!y.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"===_typeof$3(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},emit:o},s={on:c(r),once:c(n),off:c(i),emit:c(o)},u=g({},s),e.exports=t=function(e){return null==e?h(u):g(Object(e),s)},t.methods=a}(eventEmitter,eventEmitter.exports);var EventEmitter=eventEmitter.exports,isValue=isValue$5,map={function:!0,object:!0},isObject$j=function(e){return isValue(e)&&map[_typeof$3(e)]||!1},isObject$i=isObject$j,validObject=function(e){if(!isObject$i(e))throw new TypeError(e+" is not an Object");return e},value=validObject,hasOwnProperty$3=Object.prototype.hasOwnProperty,allOff=function(e){var t,r=arguments[1];if(value(e),void 0===r)hasOwnProperty$3.call(e,"__ee__")&&delete e.__ee__;else{if(!(t=hasOwnProperty$3.call(e,"__ee__")&&e.__ee__))return;t[r]&&delete t[r]}};function debounce$2(e,t,r){var n;return function(){var i=this,o=arguments,a=function(){n=null,r||e.apply(i,o)},s=r&&!n;clearTimeout(n),n=setTimeout(a,t),s&&e.apply(i,o)}}var ProxyPromise=function(){function e(){var t,r;_classCallCheck$1(this,e);var n=new Promise((function(e,n){t=e,r=n}));return n.resolve=t,n.reject=r,n}return _createClass$1(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}(),$$N=_export$1,global$y=global$1T,uncurryThis$C=functionUncurryThis$1,Date$1=global$y.Date,getTime$1=uncurryThis$C(Date$1.prototype.getTime);$$N({target:"Date",stat:!0},{now:function(){return getTime$1(new Date$1)}});var Raf=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"install",value:function(){if(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame,!window.requestAnimationFrame){var e=Date.now();window.requestAnimationFrame=function(t){var r=Date.now(),n=Math.max(16.7-(r-e),0),i=setTimeout(t,n);return e=r+n,i}}window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}}]),e}(),FpsDetection=function(){function e(){_classCallCheck$1(this,e),this.fps=0,this.isStoped=!0,this.ticks=[],this.isSupport=!0,this.maxFps=0,this.step=this._step.bind(this),this.rafId=null}return _createClass$1(e,[{key:"_step",value:function(e){var t=this.ticks;if(t.unshift(e),t.length>10){var r=t.pop();r&&(this.fps=Math.floor(1e4/(e-r)),this.updateFpsInfo())}this.isStoped||(this.rafId=window.requestAnimationFrame(this.step))}},{key:"updateFpsInfo",value:function(){this.fps>this.maxFps&&(this.maxFps=this.fps)}},{key:"start",value:function(){void 0!==window.requestAnimationFrame&&(this.isStoped=!1,this.rafId=window.requestAnimationFrame(this.step))}},{key:"stop",value:function(){window.cancelAnimationFrame(this.rafId),this.isStoped=!0}}],[{key:"install",value:function(){Raf.install()}}]),e}(),Xml2Json=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"parse",value:function(t){var r=e.parseXmlString(t);return null!==r?e.parseDOMChildren(r):null}},{key:"parseXmlString",value:function(e){if(void 0===e)return null;var t,r=new window.DOMParser;try{(t=r.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(n){t=null}return t}},{key:"parseDOMChildren",value:function(t,r){if(t.nodeType===Node.DOCUMENT_NODE){for(var n={},i=t.childNodes,o=0;o<i.length;o++){var a=i[o];a.nodeType===Node.ELEMENT_NODE&&(n=e.parseDOMChildren(a))}return n}if(t.nodeType===Node.ELEMENT_NODE){for(var s={__cnt:0},u=[],c=t.childNodes,l=0;l<c.length;l++){var d=c[l],f=e.getNodeLocalName(d);if(d.nodeType!==Node.COMMENT_NODE){var h=r+"."+f;if(s.__cnt++,null==s[f]){var p=e.parseDOMChildren(d,h);if("#text"!==f||/[^\s]/.test(p)){var g={};g[f]=p,u.push(g)}s[f]=p,e.toArrayAccessForm(s,f)}else{null!=s[f]&&(s[f]instanceof Array||(s[f]=[s[f]],e.toArrayAccessForm(s,f,h)));var y=e.parseDOMChildren(d,h);if("#text"!==f||/[^\s]/.test(y)){var v={};v[f]=y,u.push(v)}s[f][s[f].length]=y}}}for(var m=0;m<t.attributes.length;m++){var _=t.attributes[m];s.__cnt++;var b=_.value;s[_.name]=b}var A=t.prefix;return null!=A&&""!==A&&(s.__cnt++,s.__prefix=A),null!=s["#text"]&&(s.__text=s["#text"],s.__text instanceof Array&&(s.__text=s.__text.join("\n")),delete s["#text"],delete s["#text_asArray"]),null!=s["#cdata-section"]&&(s.__cdata=s["#cdata-section"],delete s["#cdata-section"],delete s["#cdata-section_asArray"]),1===s.__cnt&&null!=s.__text?s=s.__text:1===s.__cnt&&null!=s.__cdata&&(s=s.__cdata),delete s.__cnt,s}if(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.CDATA_SECTION_NODE)return t.nodeValue}},{key:"getNodeLocalName",value:function(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!==t||(t=e.nodeName),t}},{key:"toArrayAccessForm",value:function(e,t){e[t]instanceof Array||(e[t]=[e[t]])}}]),e}();function isSupportRawCryptoCTR(){var e=new ProxyPromise,t=window.crypto||window.msCrypto;if(!t)return e.resolve(!1),e;var r=new Uint8Array(16),n=new Uint8Array([1]),i=null;try{t.subtle.generateKey({name:"AES-CTR",length:256},!1,["encrypt","decrypt"]).then((function(e){return i=e,t.subtle.encrypt({name:"AES-CTR",counter:r,length:128},e,n)})).then((function(e){return t.subtle.decrypt({name:"AES-CTR",counter:r,length:128},i,e)})).then((function(t){var r=new Uint8Array(t);e.resolve(r[0]===n[0])})).catch((function(){e.resolve(!1)}))}catch(error){e.resolve(!1)}return e}var SpeedSampler=function(){function e(){_classCallCheck$1(this,e),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,"undefined"!=typeof window&&window.performance&&window.performance.now?this._now=window.performance.now.bind(window.performance):this._now=Date.now}return _createClass$1(e,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}},{key:"addBytes",value:function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0===e&&(e=1),this._intervalBytes/e/1024}},{key:"lastSecondKBps",get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}},{key:"averageKBps",get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}}]),e}();function getResponseHeaders$1(e){var t={};if(e instanceof window.XMLHttpRequest)try{e.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift(),i=r.join(": ");t[n]=i}))}catch(error){}return t}var IntervalTimer=function(){function e(){_classCallCheck$1(this,e),this.timeID=null,this.func=null}return _createClass$1(e,[{key:"repeat",value:function(e,t){this.timeID=1,this.repeatInterval(e,t)}},{key:"repeatInterval",value:function(e,t){var r=this;this.timeID&&(null===this.func&&(this.func=e),this.func===e&&(this.timeID&&clearTimeout(this.timeID),this.timeID=null,this.timeID=setTimeout((function(){e(),r.repeatInterval(e,t)}),t)))}},{key:"clear",value:function(){clearTimeout(this.timeID),this.timeID=null}}]),e}(),IntervalTimer$1=IntervalTimer,isSupport$2=_isLocalStorageUsable$1();function probeSupport$1(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function checkIfLocalStorageThrows$1(){var t="_localstorage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(e){return!0}}function _isLocalStorageUsable$1(){return probeSupport$1&&!checkIfLocalStorageThrows$1()}var proxyLocalStorage={length:isSupport$2?localStorage.length:0,clear:function(e){try{for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}}catch(error){}},getItem:function(e){try{return localStorage.getItem(e)}catch(error){return null}},key:function(e){try{return localStorage.key(e)}catch(error){return null}},setItem:function(e,t){try{localStorage.setItem(e,t)}catch(error){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(error){}},isSupport:isSupport$2},proxyLocalStorage$1=proxyLocalStorage,ERROR_TYPE_CODE={data:1e3,runtime:1002,parse:1004,other:9999,notSupport:1005,canplay:1006,bufferbreak:1007,network:1003,pdnetwork:1008,licetwork:1009,media:1010},Errors=_createClass$1((function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;_classCallCheck$1(this,e);var o={errorType:t,errorTypeCode:ERROR_TYPE_CODE[t],errorCode:r,playerVersion:"3.0.25"};return n&&"object"===_typeof$1(n)&&Object.keys(n).map((function(e){return o[e]=n[e],e})),i&&(o.currentTime=i.currentTime||0,o.duration=i.duration||0,o.ended=i.ended?0:1,o.vtype="dash"===i.playerType?"DASH":"LOWER_MP4",i.config&&(o.vid=i.config.vid),i.error&&(o.videoError=i.error)),o}));Errors.NETWORK="network",Errors.PD_NETWORK="pdnetwork",Errors.LIC_NETWORK="licetwork",Errors.MSE="mse",Errors.PARSE="parse",Errors.FORMAT="format",Errors.DECODER="decoder",Errors.RUNTIME="runtime",Errors.CANPLAY="canplay",Errors.BUFFERBREAK="bufferbreak",Errors.TIMEOUT="timeout",Errors.OTHER="other",Errors.MEDIA="media",Errors.NETEORK_ERROR_CODES={timeout:-499895,401:-499898,403:-499897,404:-499898},Errors.MPD_PARSE_ERROR=-499970,Errors.MSE_PARSE_ERROR=-499971,Errors.DUR_PARSE_ERROR=-499972,Errors.SEG_PARSE_ERROR=-499973,Errors.LIC_PARSE_ERROR=-499974,Errors.SID_PARSE_ERROR=-499975,Errors.HEADER_PARSE_ERROR=-499976,Errors.BUF_PARSE_ERROR=-499977,Errors.BYTE_PARSE_ERROR=-499978,Errors.BOX_KEY_ERROR=-499983,Errors.NO_CANPLAY_ERROR=-499985,Errors.BUFFERBREAK_ERROR=-499986,Errors.NETWORK_DISCONNECT=-499900,Errors.CDM_LICENSE_ERROR=-499901,Errors.MSE_MEDIA_TYPES_NOT_SUPPORTED=-499902;var Errors$1=Errors,ERROR_REQUEST_TIME=5e3,DEFAULT_PROGRESS_TIMER=1e3,DEFAULT_PRELOAD_TIME=50,DEFAULT_CHECK_BUFFER_TIME=10,DASH_BUFFER_BREAK=2e4,DASH_NO_INITSEGMENT=6e3,DASH_NO_CANPLAY=16e3,DEFAULT_END=1,SPPED_CACHE$1="danger_d_speed",SEGMENT_EXCEPTION_CODE=[413,416],SEGMENT_ERR_MSG="segment_exception",DEFAULT_REQ_SEQ_NUM=1,MAX_TIMESTAMP=5e9,MIN_EXPIRE_INTERVAL=300,MONITOR_HEADERS={"x-cache":"x_cache","x-response-sinfo":"server_ip"},SIDX_EXCEPTION="sidx_exception",SEGMENT_SIZE_CONFIG={"360p":.45,"480p":.75,"720p":1.6,"1080p":5,"2k":7.5,"4k":12.5},PLAYER_START="player_start",WASM_START="wasm_start",WASM_READY="wasm_ready",INIT_FINISHED="init_finished",CORE_START="core_start",START_PLAY="start_play",ERROR_HANDLER="error_handler",ERROR_CATCHING="error_catching",ERROR_NO_MP4OPTS="error_no_mp4opts",ERROR_CATCH_FINISHED="error_catch_finished",NEXT_START="next_start",NEXT_FINISHED="next_finished",PRELOAD_HIT="PRELOAD_HIT",PRELOAD_CACHED="PRELOAD_CACHED",SEGMENT_STATE={NO_START:0,GOING:1,APPEND:2},CANCEL="CANCEL",MEDIA_CONTENT_ERR="media_exception",MP4_SOURCE_ERR="mp4_source_exception",SEGMENT_REQUEST_TIMEOUT="segment_request_timeout",SEGMENT_REQUEST_EXPIRED="segment_request_expired",TASK_REQUEST_EXPIRED="task_request_expired",TASK_REQUEST_TIMEOUT="task_request_timeout",TASK_REQUEST_ERROR="tasl_request_error",TASK_URL_NOT_FOUND="Not Found",CDM_LICENSE_ERROR="CDM_LICENSE_ERROR",CDM_LICENSE_SUCCESS="CDM_LICENSE_SUCCESS",MPD_SEEK_TYPE={NORMAL:0,SEEK:1,INIT:2},DASH_TYPE={MAIN:"0",BACK:"1"},CHANGE_STATES$2={INIT:"init",ERR:"error"},URL_DASH_TAG="currentDashType",TRANSFORM_IV=new Uint8Array([91,104,69,75,156,171,238,71,202,4,244,5]).buffer,global$x=global$1T,fails$y=fails$1m,uncurryThis$B=functionUncurryThis$1,toString$i=toString$A,trim$3=stringTrim$1.trim,whitespaces$5=whitespaces$9,charAt$7=uncurryThis$B("".charAt),n$ParseFloat$1=global$x.parseFloat,_Symbol$6=global$x.Symbol,ITERATOR$5=_Symbol$6&&_Symbol$6.iterator,FORCED$7=1/n$ParseFloat$1(whitespaces$5+"-0")!=-1/0||ITERATOR$5&&!fails$y((function(){n$ParseFloat$1(Object(ITERATOR$5))})),numberParseFloat$1=FORCED$7?function(e){var t=trim$3(toString$i(e)),r=n$ParseFloat$1(t);return 0===r&&"-"==charAt$7(t,0)?-0:r}:n$ParseFloat$1,$$M=_export$1,$parseFloat$1=numberParseFloat$1;$$M({global:!0,forced:parseFloat!=$parseFloat$1},{parseFloat:$parseFloat$1});var util={ArrayBufferToString:function(e){for(var t="",r=new Uint8Array(e),n=0;n<r.length;n++)t+=String.fromCharCode(r[n]);return t},StringToArrayBuffer:function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},Base64ToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));if(t){for(var n=[],i=0;i<r.length;i++)n.push(r.charCodeAt(i));return new Uint8Array(n).buffer}for(var o="",a=0;a<r.length;a++)o+=("0"+r.charCodeAt(a).toString(16)).substr(-2);return o},HexToBase64:function(e){for(var t="",r=0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return window.btoa(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},findBox:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.type!==t){if(e&&e.subBox){var n=e.subBox.filter((function(e){return e.type===t}));n.length?n.forEach((function(e){return r.push(e)})):e.subBox.forEach((function(e){return util.findBox(e,t,r)}))}}else r.push(e);return(r=[].concat(r)).length>1?r:r[0]},padStart:function(e,t,r){for(var n=String(r),i=t>>0,o=Math.ceil(i/n.length),a=[],s=String(e);o--;)a.push(n);return a.join("").substring(0,i-s.length)+s},durationConvert:function(e){var t=0,r=0,n=0;return(e=e.slice(e.indexOf("PT")+2)).indexOf("H")>-1&&e.indexOf("M")>-1&&e.indexOf("S")>-1?(t=parseFloat(e.slice(0,e.indexOf("H"))),r=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("M"))),n=parseFloat(e.slice(e.indexOf("M")+1,e.indexOf("S")))):e.indexOf("H")>-1&&e.indexOf("M")>-1&&e.indexOf("S")<0?(t=parseFloat(e.slice(0,e.indexOf("H"))),r=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("M")))):e.indexOf("H")<0&&e.indexOf("M")>-1&&e.indexOf("S")>-1?(r=parseFloat(e.slice(0,e.indexOf("M"))),n=parseFloat(e.slice(e.indexOf("M")+1,e.indexOf("S")))):e.indexOf("H")>-1&&e.indexOf("M")<0&&e.indexOf("S")>-1?(t=parseFloat(e.slice(0,e.indexOf("H"))),n=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("S")))):e.indexOf("H")<0&&e.indexOf("M")<0&&e.indexOf("S")>-1?n=parseFloat(e.slice(0,e.indexOf("S"))):e.indexOf("H")<0&&e.indexOf("M")>-1&&e.indexOf("S")<0&&(r=parseFloat(e.slice(0,e.indexOf("M")))),3600*t+60*r+n},preFixInterge:function(e,t){return(Array(t).join(0)+e).slice(-t)},toHex:function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.push(util.padStart(Number(t).toString(16),2,0))})),e},sum:function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e+=t})),e},toUTF8:function(e){for(var t=encodeURIComponent(e),r=unescape(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n.buffer},fromHex:function(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t},fromCharCode:function(e){for(var t="",r=0;r<e.length;r+=16e3){var n=e.subarray(r,r+16e3);t+=String.fromCharCode.apply(null,n)}return t},toBase64:function(e,t){var r=util.fromCharCode(e);t=void 0===t||t;var n=window.btoa(r).replace(/\+/g,"-").replace(/\//g,"_");return t?n:n.replace(/=*$/,"")},str2hex:function(e){if(""===e)return"";for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t},bufferToString:function(e){return("0"+Number(e).toString(16)).slice(-2).toUpperCase()},stringToBuffer:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e[r]+e[r+1],16));return new Uint8Array(t)}};util.toHex=function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.push(util.padStart(Number(t).toString(16),2,0))})),e},util.formatIV=function(e){var t="";return e.forEach((function(e){t+=util.bufferToString(e)})),t},util.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number(e.toFixed(t))},util.isSogou=function(){return window.navigator.userAgent.toLowerCase().indexOf("metasr")>-1},util.isEdge=function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("edge")>-1||e.indexOf("edg/")>-1},util.offInDestroy=function(e,t,r,n){e.once(n,(function i(){e.off(t,r),e.off(n,i)}))},util.on=function(e,t,r,n){if(n)e.on(t,r),util.offInDestroy(e,t,r,n);else{e.on(t,(function n(i){r(i),e.off(t,n)}))}},util.once=function(e,t,r,n){if(n)e.once(t,r),util.offInDestroy(e,t,r,n);else{e.once(t,(function n(i){r(i),e.off(t,n)}))}},util.promisePolyfill=function(){Promise.prototype.finally||(Promise.prototype.finally={finally:function(e){var t=function(t){return Promise.resolve(e()).then(t)};return this.then((function(e){return t((function(){return e}))}),(function(e){return t((function(){return Promise.reject(e)}))}))}}.finally)},util.transformHeaders=function(e,t){var r=Object.assign({},e);return Object.keys(t).forEach((function(n){var i=t[n];e&&e[n]&&(r[i]=e[n],delete r[n])})),r},util.generateUniqueKey=function(e){var t=e.vid,r=e.start,n=e.end,i=e.mediaType,o=e.definition,a=e.codecType,s=e.format;return r=r||0,n=n||0,a=a||"h264",s=s||"dash",t&&i?o?"".concat(t,"#").concat(i,"#").concat(o,"#").concat(r,"#").concat(n,"#").concat(a,"#").concat(s):"".concat(t,"#").concat(i,"#").concat(r,"#").concat(n,"#").concat(a,"#").concat(s):null},util.exchangeListUrl=function(e){if(e&&0!==e.length)for(var t=0;t<e.length;t++)util.exchangeUrl(e[t])},util.exchangeUrl=function(e){if(e&&e.main_url&&e.backup_url_1){var t=e.main_url,r=e.backup_url_1,n=t.split("?");2===n.length&&-1===r.indexOf("?")?(e.main_url=r+"?"+n[1],e.backup_url_1=n[0]):(e.main_url=r,e.backup_url_1=t)}},util.validateFragment=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t instanceof ArrayBuffer){try{var n=new Uint8Array(t,4,4),i=String.fromCharCode.apply(null,n);if(2===r.length){var o=r[1]-r[0]+1;if(!(t.byteLength===o))return}if("moof"!==i&&"styp"!==i&&"ftyp"!==i)return!1}catch(e){return!1}return!0}return!1},util.validateUrlRange=function(e,t){var r=e||[];if(r.length>0)for(var n=0;n<r.length;n++){var i=r[n];if(/([0-9.\-A-Za-z]+)/.test(i)&&t.indexOf(i)>-1)return!0}return!1},util.isBase64=function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)};var cipher=function(e){var t=function(e){return e.split("").map((function(e){return e.charCodeAt(0)}))},r=function(e){return("0"+Number(e).toString(16)).substr(-2)},n=function(r){return t(e).reduce((function(e,t){return e^t}),r)};return function(e){return e.split("").map(t).map(n).map(r).join("")}},decipher=function(e){var t=function(t){return(r=e,r.split("").map((function(e){return e.charCodeAt(0)}))).reduce((function(e,t){return e^t}),t);var r};return function(e){return e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})).map(t).map((function(e){return String.fromCharCode(e)})).join("")}},myCipher=cipher("vodTimestampSalt"),myDecipher=decipher("vodTimestampSalt");util.getUnionInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(myCipher((new Date).getTime().toString()))},util.checkUnionInfoExpired=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(0===t.indexOf(e)){var n=parseInt(myDecipher(t.slice(e.length))),i=(new Date).getTime()-n;if(i>0&&i<=1e3*r)return!0}return!1},util.getCookieValue=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.cookie.split(";"),r=0;r<t.length;r++){var n=t[r].trim().split("=");if(n[0]===e)return n[1]}return null};var util$1=util,sameValue$1=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},call$m=functionCall$1,fixRegExpWellKnownSymbolLogic$3=fixRegexpWellKnownSymbolLogic$1,anObject$i=anObject$E,requireObjectCoercible$a=requireObjectCoercible$l,sameValue=sameValue$1,toString$h=toString$A,getMethod$7=getMethod$e,regExpExec$3=regexpExecAbstract$1;fixRegExpWellKnownSymbolLogic$3("search",(function(e,t,r){return[function(t){var r=requireObjectCoercible$a(this),n=null==t?void 0:getMethod$7(t,e);return n?call$m(n,t,r):new RegExp(t)[e](toString$h(r))},function(e){var n=anObject$i(this),i=toString$h(e),o=r(t,n,i);if(o.done)return o.value;var a=n.lastIndex;sameValue(a,0)||(n.lastIndex=0);var s=regExpExec$3(n,i);return sameValue(n.lastIndex,a)||(n.lastIndex=a),null===s?-1:s.index}]}));var LOGOPEN="undefined"!=typeof window&&(window.location.search.indexOf("log=true")>-1||!!proxyLocalStorage$1.getItem("abrdebug")),debug$2={},debugPrefix={log:"log",network:"network",abr:"abr",encrypt:"encrypt",segment:"segment",definition:"definition",content:"content",mse:"mse",media:"media",time:"time",preload:"preload",gap:"gap"};for(var item in debugPrefix)debug$2[item]=LOGOPEN?console.log.bind(window,"".concat(item,":")):function(){};var debug$1$1=debug$2,TASK_PREOGRESS="TASK_PREOGRESS";function emitProgressEvent(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n.connectTime=e.connectCostTime,n.loaded=e.loaded;var i=util$1.transformHeaders(e.headers,MONITOR_HEADERS),o=Object.assign({},n,i);e.emit("progress_event",{costTime:parseInt(r,10),pos:e.loaded,cdnUrl:e.realUrl,range:e.range||[],speed:e.speed,headers:e.headers,status:e.status,type:t,ext:o})}function nowTime$1(){return parseInt(performance.now(),10)}var Task=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e4,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{limitSizeM:1/0},s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0;_classCallCheck$1(this,e),EventEmitter(this);var c=this;c.url=t,c.realUrl=t,c.running=!1,c.loaded=0,c.startTime=0,c.startConnectTime=0,c.startDownloadTime=0,c.lastTime=nowTime$1(),c.range=n,c.speed=0,c.status=0,c.headers={},c.cacheKey=a.cacheKey||util$1.generateUniqueKey(a),c.useUrlRange=a.useUrlRange||!1,c.canceled=!1,c.preloadManager=u,c.isCache=s,c.pendingCallbacks=[],c.cacheKey&&c.preloadManager?c.preloadManager.getItem(c.cacheKey).then((function(e){if(debug$1$1.preload(c.cacheKey,"getItem cost",nowTime$1()-c.lastTime,"ms","hit cache",e),e){if(debug$1$1.preload("hit cache",c.cacheKey,"cancel",c.canceled),!c.canceled&&e.res instanceof ArrayBuffer){c.emit("getHeaders",e.headers),c.emit(s?PRELOAD_CACHED:PRELOAD_HIT,c.cacheKey);var u=e.res.byteLength;c.emit(TASK_PREOGRESS,{total:u,loaded:u,cacheKey:c.cacheKey}),i(e.res,e.headers,e.status,!0),c.executePendingCallback(e.res,e.headers,e.status),allOff(r)}}else c.initialize(t,n,i,o,a,s)})).catch((function(){c.initialize(t,n,i,o,a,s)})):c.initialize(t,n,i,o,a,s)}return _createClass$1(e,[{key:"executePendingCallback",value:function(e,t,r){for(var n=0;n<this.pendingCallbacks.length;n++)this.pendingCallbacks[n](e,t,r);this.pendingCallbacks=[]}},{key:"initialize",value:function(t,r,n,i,o,a){for(var s=this,u=this,c=0;c<e.queue.length;c++){var l=e.queue[c];if(l.url===t&&JSON.stringify(l.range)===JSON.stringify(r))return l.isCache?(l.pendingCallbacks.push(n),debug$1$1.log("task cache repeat")):n("repeat"),allOff(this),void debug$1$1.log("preload repeat",u.cacheKey,"isCache",u.isCache)}var d=u.useUrlRange;d&&r&&r.length>1&&(t=t+(t.split("?")[1]?"&":"?")+"range=".concat(r[0],"-").concat(r[1]),u.realUrl=t);var f=new XMLHttpRequest;f.target=u,f.responseType="arraybuffer",f.open("get",t),i>0&&(f.timeout=i),r&&r.length>1&&!d&&(u.range=r,u.id=r.join("-"),f.setRequestHeader("Range","bytes=".concat(r[0],"-").concat(r[1]))),f.onreadystatechange=function(e){2===f.readyState&&(u.headers=getResponseHeaders$1(f),u.emit("getHeaders",u.headers),u.status=f.status,u.startDownloadTime=nowTime$1()),1===f.readyState&&(u.lastTime=nowTime$1())},f.onload=function(e){if(u.loaded=e.loaded,u.speed=Math.floor(u.loaded/u.costTime/1024*1e3),200===f.status||206===f.status){if(u.emit(TASK_PREOGRESS,{total:e.total,loaded:e.loaded,cacheKey:u.cacheKey}),n&&n instanceof Function&&(n(f.response,u.headers,f.status),u.executePendingCallback(f.response,u.headers,f.status)),a&&util$1.validateFragment(f.response,r)&&u.preloadManager&&(u.preloadManager.setItem(u.cacheKey,{res:f.response,headers:u.headers,status:f.status}).catch((function(){})),u.emit(PRELOAD_CACHED,u.cacheKey)),o.isVideo){var i=!!(r&&r.length>1),s=i?r[1]-r[0]+1:0,c=i?s:f.response?f.response.byteLength:0,l=8*c/o.bitrate;l>o.ratio&&c/1048576>o.limitSizeM&&emitProgressEvent(u,"oversize",u.costTime,{start:r&&r[0]||-1,end:r&&r[1]||-1,segment_resolution:o.segment_resolution,segment_ratio:l,segment_bitrate:o.bitrate,segment_size:f.response.byteLength,segment_size_total:e.total,segment_range_size:s}),i&&f&&f.response&&s!==f.response.byteLength&&emitProgressEvent(u,"oversizecdn",u.costTime,{start:r&&r[0]||-1,end:r&&r[1]||-1,segment_resolution:o.segment_resolution,segment_ratio:l,segment_bitrate:o.bitrate,segment_size:f.response.byteLength,segment_size_total:e.total,segment_range_size:s})}}else 404===f.status?(u._emitCancel(),n&&n instanceof Function&&n(TASK_URL_NOT_FOUND)):(u._emitCancel(),u.emit("error",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[f&&f.status?f.status:"timeout"],{line:40,handle:"[DASH] task",msg:TASK_REQUEST_EXPIRED,url:t,headers:u.headers,status:f&&f.status})));var d=200===f.status||206===f.status?"success":"error";o.isVideo&&emitProgressEvent(u,d,u.costTime,{start:r&&r.length>1?r[0]:0,end:r&&r.length>1?r[1]:e.total}),f.target.remove()},f.onerror=function(){u._emitCancel();var e="error";navigator&&!navigator.onLine&&(e="network"),n(e,u.headers||{},f.status,f.readyState),0===u.status&&(u.status=-1),o.isVideo&&emitProgressEvent(u,"error",u.costTime,{}),f.target.remove()},f.onabort=function(){u._emitCancel(),o.isVideo&&emitProgressEvent(u,"abort",u.costTime,{}),f.target.remove()},f.ontimeout=function(){o.isVideo&&emitProgressEvent(u,"timeout",u.costTime,{start:r&&r.length>1?r[0]:-1,end:r&&r.length>1?r[1]:-1}),u._emitCancel(),n("timeout",u.headers||{},f.status),f.target.remove()},f.onprogress=function(t){var r=t.loaded-u.loaded;if(r>0&&nowTime$1()-s.startTime>500){s.startTime=nowTime$1();var n=e.speedSampler.currentKBps;e.speedCallBacks.map((function(e){return e(n)}))}var i=nowTime$1();if(i-u.lastTime>100||t.lengthComputable&&t.loaded===t.total){var o=r/((i-u.lastTime)/1e3)/1024;u.speed=o,e.historySpeed.length>=20&&e.historySpeed.shift(),e.historySpeed.push(o),u.lastTime=i}u.loaded=t.loaded,a||e.speedSampler.addBytes(r),u.emit(TASK_PREOGRESS,{total:t.total,loaded:t.loaded,cacheKey:u.cacheKey})},u.canceled||(u.xhr=f,e.queue.push(u)),u.update()}},{key:"cancel",value:function(){this.running&&this.xhr.abort(),this._emitCancel(),this.remove(),this.canceled=!0}},{key:"_emitCancel",value:function(){this.emit(CANCEL)}},{key:"remove",value:function(){var t=this,r=this;r.running=!1,e.queue.filter((function(n,i){return n.url===t.url&&JSON.stringify(n.range)===JSON.stringify(t.range)&&(e.queue.splice(i,1),n.pendingCallbacks=[],allOff(r),!0)})),this.update()}},{key:"update",value:function(){var t=e.queue,r=t.filter((function(e){return e.running})),n=t.filter((function(e){return!e.running})),i=e.limit-r.length;n.forEach((function(e,t){t<i&&e.run()}))}},{key:"run",value:function(){1===this.xhr.readyState?(this.running=!0,this.lastTime=nowTime$1(),this.xhr.send(),this.startTime=nowTime$1(),this.startDownloadTime=nowTime$1(),this.startConnectTime=nowTime$1()):this.remove()}},{key:"costTime",get:function(){return 0===this.startDownloadTime?nowTime$1()-this.startConnectTime:nowTime$1()-this.startDownloadTime}},{key:"connectCostTime",get:function(){return this.startDownloadTime>0?this.startDownloadTime-this.startConnectTime:0}}],[{key:"clear",value:function(){e.queue.forEach((function(e){e.cancel()})),e.queue.length=0,e.speedSampler.reset()}},{key:"currentSpeed",get:function(){return e.speedSampler.lastSecondKBps}},{key:"historyAvspeed",get:function(){var t=e.historySpeed.reduce((function(e,t){return e+t}),0);return 0===e.historySpeed.length?0:t/e.historySpeed.length}}]),e}();Task.queue=[],Task.limit=4,Task.speedCallBacks=[],Task.speedSampler=new SpeedSampler,Task.historySpeed=[];var Task$1=Task,ArrayBufferViewCore=arrayBufferViewCore,TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS=typedArrayConstructorsRequireWrappers,aTypedArrayConstructor=ArrayBufferViewCore.aTypedArrayConstructor,exportTypedArrayStaticMethod=ArrayBufferViewCore.exportTypedArrayStaticMethod;function checkIsMSBrowser(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/");return t>0||r>0}function checkIsQQBrowser(){return window.navigator.userAgent.toLowerCase().indexOf("qqbrowser")>-1}function checkIsFirefoxBrowser(){var e=window.navigator.userAgent;return!(window.location.search.indexOf("firefox_dash=true")>-1||!!proxyLocalStorage$1.getItem("firefox_dash"))&&e.toLowerCase().indexOf("firefox")>-1}function checkIsSafariBrowser(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function checkIsChromeCoreBrowser(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1}function checkIsEdgeBrowser(){return navigator.userAgent.indexOf("Edge")>0||navigator.userAgent.indexOf("Edg/")>0}function checkIsIncompatibleBrowser(){var e=checkIsSafariBrowser(),t=checkIsMSBrowser(),r=checkIsFirefoxBrowser(),n=checkIsEdgeBrowser();return e||t||r||n}function checkWebAssemblySupport(){try{if("object"===("undefined"==typeof WebAssembly?"undefined":_typeof$1(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(e){console.log(e)}return!1}function checkMediaSourceSupport(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported}exportTypedArrayStaticMethod("of",(function(){for(var e=0,t=arguments.length,r=new(aTypedArrayConstructor(this))(t);t>e;)r[e]=arguments[e++];return r}),TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);var AV1MimeTypes=['video/mp4; codecs="av01.0.01M.08,mp4a.40.5"'];function isCodecSupported(e){if(!checkMediaSourceSupport())return!1;for(var t=0;t<e.length;t++){var r=e[t];if(MediaSource.isTypeSupported(r))return!0}return!1}function isAV1Supported(){return isCodecSupported(AV1MimeTypes)}function isEMESupported(){return!!navigator.requestMediaKeySystemAccess&&!checkIsIncompatibleBrowser()}function isSupported(){return checkWebAssemblySupport()&&checkMediaSourceSupport()&&!checkIsMSBrowser()}function isEncryptSupported(){return checkWebAssemblySupport()&&checkMediaSourceSupport()&&!checkIsMSBrowser()&&!checkIsQQBrowser()}function getDrmServerUrl(e){return new Promise((function(t,r){checkWebAssemblySupport()&&checkMediaSourceSupport()&&navigator.requestMediaKeySystemAccess||t(void 0);checkIsSafariBrowser();var n=checkIsChromeCoreBrowser(),i=checkIsEdgeBrowser();n&&!checkIsQQBrowser()?navigator.requestMediaKeySystemAccess("com.widevine.alpha",[{initDataTypes:["keyids","webm"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42c01e"'}]}]).then((function(r){t("https://".concat(e,"/video/drm/v1/widevine?aid=32&kid="))}),(function(){t(void 0)})):t(i?"https://".concat(e,"/video/drm/v1/playready?aid=32&kid="):void 0)}))}var isSupport$1=Object.freeze(Object.defineProperty({__proto__:null,AV1MimeTypes:AV1MimeTypes,checkWebAssemblySupport:checkWebAssemblySupport,getDrmServerUrl:getDrmServerUrl,isAV1Supported:isAV1Supported,isCodecSupported:isCodecSupported,isEMESupported:isEMESupported,isEncryptSupported:isEncryptSupported,isSupported:isSupported},Symbol.toStringTag,{value:"Module"})),PRELOAD_NEXT$2="PRELOAD_NEXT",PRELOAD_SEG_DONE="PRELOAD_SEG_DONE",STATES={PREPARE:"PREPARE",IDLE:"IDLE",PRELOADING:"PRELOADING",FINISH:"FINISH"},ONE_STEP_DONE="ONE_STEP_DONE",MEDIA_TYPES$2={VIDEO:0,AUDIO:1,MIXED:2},CACHE_TYPES={INDEXDB:0,MEMORY:1},DOWN_STATES={FAIL:-1,SUCCESS:0,DOWNLOADING:1},DESCRIPTORS$k=descriptors$1,uncurryThis$A=functionUncurryThis$1,objectKeys$3=objectKeys$7,toIndexedObject$a=toIndexedObject$o,$propertyIsEnumerable$2=objectPropertyIsEnumerable$1.f,propertyIsEnumerable=uncurryThis$A($propertyIsEnumerable$2),push$5=uncurryThis$A([].push),createMethod$4=function(e){return function(t){for(var r,n=toIndexedObject$a(t),i=objectKeys$3(n),o=i.length,a=0,s=[];o>a;)r=i[a++],DESCRIPTORS$k&&!propertyIsEnumerable(n,r)||push$5(s,e?[r,n[r]]:n[r]);return s}},objectToArray={entries:createMethod$4(!0),values:createMethod$4(!1)},$$L=_export$1,$values=objectToArray.values;$$L({target:"Object",stat:!0},{values:function(e){return $values(e)}});var RETRY_MAX=10,PRELOADER=function(){function e(t,r,n,i,o){_classCallCheck$1(this,e),EventEmitter(this),this.state=STATES.PREPARE,this.options=t||{},this.logger=t.logger||function(){},this._preloadManager=r,this.player=r.player,this._predictInst=this._preloadManager.predictInst,this._handlers=n,this._toLoadList=[],this.retryCount=0,this._cachedHandler=i,this._cachedDataHanlder=o}return _createClass$1(e,[{key:"start",value:function(){var e=this,t=new ProxyPromise;return this._handlers.start(this.options).then((function(r){r.onObtain().then((function(n){e._predictInst.updateMediaInfos(n);var i=e._predictInst.preloadPredict(e.options),o=e._predictInst.cachedData;e._cachedDataHanlder(Object.assign({vid:e.options.vid},{data:o}));var a=Object.assign(i,e.options);r.onTransform(a).then((function(r){e._toLoadList=r,t.resolve(r)}))}))})).catch((function(e){t.reject(new Error("preload unit start error"))})),t}},{key:"preloadSeg",value:function(){var e=this;if(0===this._toLoadList.length)return this.state=STATES.FINISH,void this.emit(PRELOAD_SEG_DONE,!0);this.state="PRELOADING";var t=this._toLoadList.shift();this._handlers.onRequest(t,(function(r){var n=Object.assign({},t.extData,r);e._cachedHandler(n)})).then((function(){e.state=STATES.IDLE,e.emit(PRELOAD_SEG_DONE)})).catch((function(t){e.requestError(),e.emit(PRELOAD_SEG_DONE,!1)}))}},{key:"requestError",value:function(){this.retryCount++,this.state=STATES.IDLE,this.retryCount>=RETRY_MAX&&(this.state=STATES.FINISH),this.emit(ONE_STEP_DONE),this.logger("preload request error")}},{key:"cancelLoading",value:function(){this._toLoadList=[]}}]),e}();function getIDB(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}var idb=getIDB(),idb$1=idb;function isIndexedDBValid(){try{if(!idb$1||!idb$1.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),r="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||r)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function executeCallback(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function executeTwoCallbacks(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function normalizeKey(e){return"string"!=typeof e&&(console.warn("".concat(e," used as a key, but it is not a string.")),e=String(e)),e}var dbContexts={},READ_ONLY="readonly",READ_WRITE="readwrite";function _deferReadiness(e){var t=dbContexts[e.name],r={};r.promise=new Promise((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function _advanceReadiness(e){var t=dbContexts[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function _rejectReadiness(e,t){var r=dbContexts[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function _getConnection(e,t){return new Promise((function(r,n){if(dbContexts[e.name]=dbContexts[e.name]||createDbContext(),e.db){if(!t)return r(e.db);_deferReadiness(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=idb$1.open.apply(idb$1,i);t&&(o.onupgradeneeded=function(t){var r=o.result;try{r.createObjectStore(e.storeName)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){r(o.result),_advanceReadiness(e)}}))}function _getOriginalConnection(e){return _getConnection(e,!1)}function _getUpgradedConnection(e){return _getConnection(e,!0)}function _isUpgradeNeeded(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,i=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function _tryReconnect(e){_deferReadiness(e);for(var t=dbContexts[e.name],r=t.forages,n=0;n<r.length;n++){var i=r[n];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,_getOriginalConnection(e).then((function(t){return e.db=t,_isUpgradeNeeded(e)?_getUpgradedConnection(e):t})).then((function(n){e.db=t.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n})).catch((function(t){throw _rejectReadiness(e,t),t}))}function createTransaction(e,t,r,n){void 0===n&&(n=1);try{var i=e.db.transaction(e.storeName,t);r(null,i)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return Promise.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),_getUpgradedConnection(e)})).then((function(){return _tryReconnect(e).then((function(){createTransaction(e,t,r,n-1)}))})).catch(r);r(o)}}function createDbContext(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}var AsyncStorage=function(){function t(){_classCallCheck$1(this,t)}return _createClass$1(t,[{key:"ready",value:function(){return this._ready}},{key:"_initStorage",value:function(e){var t=this;t._defaultConfig=e;var r={db:null};if(e)for(var n in e)r[n]=e[n];var i=dbContexts[r.name];i||(i=createDbContext(),dbContexts[r.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=t._fullyReady);var o=[];function a(){return Promise.resolve()}for(var s=0;s<i.forages.length;s++){var u=i.forages[s];u!==t&&o.push(u._initReady().catch(a))}var c=i.forages.slice(0);return t._ready=Promise.all(o).then((function(){return r.db=i.db,_getOriginalConnection(r)})).then((function(e){return r.db=e,_isUpgradeNeeded(r,t._defaultConfig.version)?_getUpgradedConnection(r):e})).then((function(e){r.db=i.db=e,t._dbInfo=r;for(var n=0;n<c.length;n++){var o=c[n];o!==t&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})),t._ready}},{key:"probeSupport",get:function(){return isIndexedDBValid()}},{key:"getItem",value:function(t,r){var n=this;t=normalizeKey(t);var i=new Promise((function(r,i){n.ready().then((function(){createTransaction(n._dbInfo,READ_ONLY,(function(o,a){if(o)return i(o);try{var s=a.objectStore(n._dbInfo.storeName).get(t);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),r(e)},s.onerror=function(){i(s.error)}}catch(e){i(e)}}))})).catch(i)}));return executeCallback(i,r),i}},{key:"setItem",value:function(t,r,n){var i=this;t=normalizeKey(t);var o=new Promise((function(n,o){i.ready().then((function(){return r})).then((function(r){createTransaction(i._dbInfo,READ_WRITE,(function(a,s){if(a)return o(a);try{var u=s.objectStore(i._dbInfo.storeName);null===r&&(r=void 0);var c=u.put(r,t);s.oncomplete=function(){void 0===r&&(r=null),n(r)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return executeCallback(o,n),o}},{key:"removeItem",value:function(t,r){var n=this;t=normalizeKey(t);var i=new Promise((function(r,i){n.ready().then((function(){createTransaction(n._dbInfo,READ_WRITE,(function(o,a){if(o)return i(o);try{var s=a.objectStore(n._dbInfo.storeName).delete(t);a.oncomplete=function(){r()},a.onerror=function(){i(s.error)},a.onabort=function(){var e=s.error?s.error:s.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return executeCallback(i,r),i}},{key:"clear",value:function(t){var r=this,n=new Promise((function(t,n){r.ready().then((function(){createTransaction(r._dbInfo,READ_WRITE,(function(i,o){if(i)return n(i);try{var a=o.objectStore(r._dbInfo.storeName).clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return executeCallback(n,t),n}},{key:"length",value:function(t){var r=this,n=new Promise((function(t,n){r.ready().then((function(){createTransaction(r._dbInfo,READ_ONLY,(function(i,o){if(i)return n(i);try{var a=o.objectStore(r._dbInfo.storeName).count();a.onsuccess=function(){t(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return executeCallback(n,t),n}},{key:"all",value:function(t){var r=this,n=new Promise((function(t,n){r.ready().then((function(){createTransaction(r._dbInfo,READ_ONLY,(function(i,o){if(i)return n(i);try{var a=o.objectStore(r._dbInfo.storeName).openCursor(),s=[];a.onsuccess=function(){var e=a.result;e?(s.push({key:e.key,value:e.value}),e.continue()):t(s)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return executeCallback(n,t),n}},{key:"_fullyReady",value:function(e){var t=this,r=t._initReady().then((function(){var e=dbContexts[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return executeTwoCallbacks(r,e,e),r}}]),t}(),IndexedDB=AsyncStorage,MemoryCache=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,[{key:"_initStorage",value:function(e){var t=e.name+"_"+e.storeName;return this.key=t,window[t]&&"object"===_typeof$1(window[t])||(window[t]={}),this.store=window[t],Promise.resolve()}},{key:"getItem",value:function(e,t){var r=this.store[e];return void 0===r&&(r=null),this._internalPromise(t,r)}},{key:"setItem",value:function(e,t,r){return this.store[e]=t,this._internalPromise(r)}},{key:"removeItem",value:function(e,t){return delete this.store[e],this._internalPromise(t)}},{key:"clear",value:function(e){return this.store={},window[this.key]={},this._internalPromise(e)}},{key:"length",value:function(e){var t=Object.keys(this.store).length;return this._internalPromise(e,t)}},{key:"_internalPromise",value:function(e,t){var r=t?Promise.resolve(t):Promise.resolve();return executeCallback(r,e),r}},{key:"all",value:function(e){for(var t=[],r=Object.keys(this.store),n=0;n<r.length;n++){var i=r[n];t.push({key:i,value:this.store[i]})}return this._internalPromise(e,t)}},{key:"probeSupport",value:function(){return!0}}]),e}(),MemoryCache$1=MemoryCache,DefaultConfig={description:"",name:"__PRE_CACHE__",storeName:"keyvaluepairs",version:1},SPLIT="|",SESSION_KEY="__PRE_CACHE__KEYS",TIMESPLIT="$",MAX_CACHE=200,PreloadCache=function(){function e(t,r){_classCallCheck$1(this,e);var n=r===CACHE_TYPES.MEMORY?MemoryCache$1:IndexedDB;this._driver=new n,this._driver._initStorage(DefaultConfig).catch((function(){})),this._hasIdbForbidden=!1,this._maxCache=!t||t<=0?MAX_CACHE:t,this.setMaxCache(this._maxCache),this._allCachedKeys={},this._allCachedTimeKeys={},this.getCachedKeysFromLocal(),this._readyPromise=new ProxyPromise,this.init()}return _createClass$1(e,[{key:"getCachedKeysFromLocal",value:function(){var e=proxyLocalStorage$1.getItem(SESSION_KEY);if(e)for(var t=e.split(SPLIT),r=0;r<t.length;r++){var n=t[r],i=this._getCacheKeyInfos(n),o=i.time,a=i.cachedKey;this._allCachedKeys[a]=1,this._allCachedTimeKeys[a]=o}}},{key:"_getCacheKeyInfos",value:function(e){var t,r=e.split(TIMESPLIT);return 2===r.length&&(t=r[0],e=r[1]),{time:t,cachedKey:e}}},{key:"writeCachedKeysToLocal",value:function(e){var t=[];this._allCachedKeys={},this._allCachedTimeKeys={};for(var r=0;r<e.length;r++){var n=e[r].key,i=this._getCacheKeyInfos(n),o=i.time,a=i.cachedKey;this._allCachedKeys[a]=1,this._allCachedTimeKeys[a]=o,t.push(n)}var s=t.join(SPLIT);proxyLocalStorage$1.setItem(SESSION_KEY,s)}},{key:"init",value:function(){var e=this;this._driver.setItem("test","test").then((function(){})).catch((function(){e._hasIdbForbidden=!0})).finally((function(){e._driver.removeItem("test").catch((function(){})),e._hasIdbForbidden&&(e._driver=new MemoryCache$1,e._driver._initStorage(DefaultConfig)),e._getAll(),e._readyPromise.resolve()}))}},{key:"_getAll",value:function(){var e=this;this._driver.all().then((function(t){e._cachedLength=t.length;var r=t.length-e._maxCache,n=t;if(r>0){var i=t.slice(0,r);n=t.slice(r);for(var o=0;o<i.length;o++)e.removeItem(i[o].key).then((function(){}))}e.writeCachedKeysToLocal(n)})).catch((function(){}))}},{key:"getItem",value:function(e,t){if(!this.hasItem(e))return Promise.resolve(!1);var r=this._getTimeKey(e).timeKey;return this._driver.getItem(r,t)}},{key:"setItem",value:function(e,t,r){var n=this;this._getTimeKey(e).timeKey&&this.removeItem(e);var i=(new Date).getTime();this._allCachedKeys[e]=1,this._allCachedTimeKeys[e]=i;var o=this._genTimeKey(e,i);return r=r?function(){n._getAll(),r()}:function(){n._getAll()},this._driver.setItem(o,t,r)}},{key:"_getTimeKey",value:function(e){var t=this._allCachedTimeKeys[e],r=e;return t&&(r=this._genTimeKey(e,t)),{timeKey:r,time:t}}},{key:"_genTimeKey",value:function(e,t){return"".concat(t).concat(TIMESPLIT).concat(e)}},{key:"removeItem",value:function(e,t){var r=this._getTimeKey(e).timeKey,n=this._driver.removeItem(r,t);return delete this._allCachedKeys[e],delete this._allCachedTimeKeys[e],n}},{key:"hasItem",value:function(e){return!!this._allCachedKeys[e]}},{key:"clear",value:function(e){return this._driver.clear(e)}},{key:"length",value:function(e){return this._driver.length(e)}},{key:"setMaxCache",value:function(e){"number"==typeof e&&e>0&&(this._maxCache=e)}}]),e}(),PreloadCache$1=PreloadCache,PreloaderManager=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck$1(this,e),EventEmitter(this),this._preloadDataList=[],this._currentPreloadInst=null,this._dashPreloadList=[],this.autoPreload=t.autoPreload||!1,this._onPreloadNext=this.onPreloadNextReady.bind(this),this.on(PRELOAD_NEXT$2,this._onPreloadNext),this.update(t,r,n),this._cacheInst=new PreloadCache$1(t.preloadMaxCacheCount,t.preloadCacheType),this._preloadCacheProgress={},this._ptag_=!0,this._cachedDatas={}}return _createClass$1(e,[{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._options=e,this._predictInst=r,!this._predictInst)throw new Error("PreloaderManager predictInst is null");this._readyPromise=this._predictInst.init(e),this.handlers=t}},{key:"cachedDatas",get:function(){return this._cachedDatas}},{key:"predictInst",get:function(){return this._predictInst}},{key:"onCacheSegment",value:function(e){var t=e.vid,r=e.format,n=e.cacheKey,i=e.total,o=e.loaded,a=e.isInitSegment,s=e.mediaType,u=this.getProgressCacheKey(t,r,s),c=this._preloadCacheProgress[u];c||(c=this._preloadCacheProgress[u]={}),c[n]={total:i,loaded:o,isInitSegment:a}}},{key:"onCachePredict",value:function(e){var t=e.vid,r=e.data;t&&r&&(this._cachedDatas[t]=r)}},{key:"getProgressCacheKey",value:function(e,t,r){return"".concat(e,"-").concat(t,"-").concat(r)}},{key:"onPreloadNextReady",value:function(){var e=this;this._readyPromise.then((function(){e.onPreloadNext()}))}},{key:"onPreloadSegDone",value:function(){this.autoPreload&&this.emit(PRELOAD_NEXT$2)}},{key:"onPreloadNext",value:function(){var e=this;if(null==this._currentPreloadInst&&this._preloadDataList.length>0){if(this._preloadDataList.length>0){var t=this._preloadDataList.shift().data;t.payload&&(this._currentPreloadInst=new PRELOADER(t,this,this.handlers,(function(t){e.onCacheSegment(t)}),(function(t){e.onCachePredict(t)})),this._currentPreloadInst.on(PRELOAD_SEG_DONE,this.onPreloadSegDone.bind(this)),this._currentPreloadInst.start().then((function(){e._currentPreloadInst.preloadSeg()})).catch((function(){e._currentPreloadInst=null})))}}else null!=this._currentPreloadInst&&(this._currentPreloadInst.state===STATES.IDLE?this._currentPreloadInst.preloadSeg():this._currentPreloadInst.state===STATES.FINISH&&(this._currentPreloadInst=null))}},{key:"addDashPreloader",value:function(e){e&&e.data&&(this._preloadDataList.push(e),this.sort(this._preloadDataList),this.autoPreload&&this.emit(PRELOAD_NEXT$2))}},{key:"_addDashPreloader",value:function(e){e&&e.data&&this._preloadDataList.push(e)}},{key:"addDashPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.sort(e);for(var t=0;t<e.length;t++)this._addDashPreloader(e[t])}},{key:"sort",value:function(e){e.sort((function(e,t){return void 0===e.order&&void 0===e.order||e.order<t.order?-1:1}))}},{key:"destroy",value:function(){this.off(PRELOAD_NEXT$2,this._onPreloadNext)}},{key:"cancelLoading",value:function(){this._currentPreloadInst&&(this._currentPreloadInst.cancelLoading(),this._currentPreloadInst=null),this._preloadDataList=[]}},{key:"preloadCacheProgress",value:function(e){var t=e.vid,r=e.format,n=e.mediaType,i=e.prelaodType,o=e.bitrate,a=e.set_duration,s=e.set_size,u=e.media_type,c=e.start_time,l=this.getProgressCacheKey(t,r,n),d=this._preloadCacheProgress[l];if(d){for(var f=Object.values(d),h=0,p=0,g=0,y=0,v=0,m=0;m<f.length;m++){var _=f[m];_.isInitSegment&&(h=_.total,g=_.loaded,y=_.loaded===_.total?DOWN_STATES.SUCCESS:DOWN_STATES.DOWNLOADING),p+=_.total,v+=_.loaded}return{media_type:u,preload_type:i,stream_bitrate:o,header_size:h,content_total_size:p,start_time:c||-1,state_info:{set_duration:a,set_size:s,current_header_download_size:g,current_content_download_size:v,header_download_state:y,content_download_state:v===p?DOWN_STATES.SUCCESS:DOWN_STATES.DOWNLOADING}}}return null}},{key:"getPreloadTaskInfos",value:function(){}},{key:"getItem",value:function(e,t){return this._cacheInst.getItem(e,t)}},{key:"setItem",value:function(e,t,r){return this._cacheInst.setItem(e,t,r)}},{key:"removeItem",value:function(e,t){return this.removeItem(e,t)}}],[{key:"getInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=window[e.GLOBAL_KEY];if(i&&i._ptag_)return i.update(t,r,n),i;var o=new e(t,r,n);return window[e.GLOBAL_KEY]=o,o}}]),e}();PreloaderManager.GLOBAL_KEY="__preloadcontext__";var PreloaderManager$1=PreloaderManager,PreloaderBase=function(){function t(e){_classCallCheck$1(this,t),EventEmitter(this),this.options=e,this.promisePolyfill(),this.before(),this.check(),this._preloadManager=PreloaderManager$1.getInstance(e,this.handlers,this.predictInst),this.loadingTasks=[]}return _createClass$1(t,[{key:"promisePolyfill",value:function(){Promise.prototype.finally||(Promise.prototype.finally={finally:function(e){var t=function(t){return Promise.resolve(e()).then(t)};return this.then((function(e){return t((function(){return e}))}),(function(e){return t((function(){return Promise.reject(e)}))}))}}.finally)}},{key:"before",value:function(){throw new Error("need")}},{key:"check",value:function(){if(!this.handlers)throw new Error("handlers null");if(!this.handlers.start||!this.handlers.onRequest)throw new Error("handlers callback null");if(!this.predictInst)throw new Error("predictInst null");if(!this.predictInst.__p__)throw new Error("predictInst need extends predictbase")}},{key:"preloadNext",value:function(){this._preloadManager.emit(PRELOAD_NEXT$2)}},{key:"preloadManager",get:function(){return this._preloadManager}},{key:"start",value:function(e){throw new Error("start need implment, return Promise")}},{key:"cancelLoading",value:function(){for(var t=0;t<this.loadingTasks.length;t++)try{var r=this.loadingTasks[t];"function"==typeof r.cancel&&r.cancel()}catch(e){}this.loadingTasks=[],this._preloadManager.cancelLoading()}},{key:"addTasker",value:function(e){this.loadingTasks.push(e)}},{key:"removeTasker",value:function(e){var t=this;setTimeout((function(){for(var r=t.loadingTasks.length-1;r>-1;r--)if(t.loadingTasks[r]===e){t.loadingTasks.splice(r,1);break}}))}},{key:"addDashPreloader",value:function(e){this._preloadManager.addDashPreloader(e)}},{key:"addDashPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._preloadManager.addDashPreloaderList(e)}}]),t}(),PredictBase=function(){function e(){_classCallCheck$1(this,e),this.bandwidth2item={},this._mediaInfos=null,this.__p__=!0}return _createClass$1(e,[{key:"init",value:function(){throw new Error("init func not implement, return promise")}},{key:"preloadPredict",value:function(e){throw new Error("preloadPredict error",e)}},{key:"updateMediaInfos",value:function(e){if(this._mediaInfos=e,this.bandwidth2item={},this.dynamic_video=e&&e.dynamic_video_list,this.dynamic_video&&this.dynamic_video.length>0)for(var t=0;t<this.dynamic_video.length;t++){var r=this.dynamic_video[t];this.bandwidth2item[r.bitrate||r.bandwidth]=r}}},{key:"getIdx",value:function(e,t){var r=0;return e.forEach((function(e,n){e.definition===t&&(r=n)})),r}},{key:"cachedData",get:function(){return null}}]),e}(),$$K=_export$1,lastIndexOf=arrayLastIndexOf;$$K({target:"Array",proto:!0,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf:lastIndexOf});var $$J=_export$1,$every=arrayIteration$1.every,arrayMethodIsStrict$6=arrayMethodIsStrict$d,STRICT_METHOD$5=arrayMethodIsStrict$6("every");$$J({target:"Array",proto:!0,forced:!STRICT_METHOD$5},{every:function(e){return $every(this,e,arguments.length>1?arguments[1]:void 0)}});var XHR=_createClass$1((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,n=t.method,i=void 0===n?"GET":n,o=t.type,a=void 0===o?"arraybuffer":o,s=t.data,u=void 0===s?{}:s;return _classCallCheck$1(this,e),new Promise((function(e,t){var n=new window.XMLHttpRequest,o=i.toUpperCase(),s=[];for(var c in a&&(n.responseType=a),u)s.push("k=".concat(u[c]));if("GET"===o)n.open(o,"".concat(r,"?").concat(s.join("&"))),n.send();else{if("POST"!==o)throw new Error("xhr ".concat(o," is not supported"));n.open(o,r,!0),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(u))}n.onload=function(){200===n.status||206===n.status?e(n):t(n)},n.onerror=function(){t(n)}}))})),XHR$1=XHR,$$I=_export$1,ArrayBufferModule=arrayBuffer,NATIVE_ARRAY_BUFFER=arrayBufferNative;$$I({global:!0,forced:!NATIVE_ARRAY_BUFFER},{DataView:ArrayBufferModule.DataView});var Stream=function(){function e(t){if(_classCallCheck$1(this,e),!(t instanceof ArrayBuffer))throw new Errors$1(Errors$1.PARSE,Errors$1.BUF_PARSE_ERROR,{line:9,handle:"[Stream] constructor",msg:"data is valid"});this.buffer=t,this.dataview=new DataView(t),this.dataview.position=0}return _createClass$1(e,[{key:"position",get:function(){return this.dataview.position},set:function(e){this.dataview.position=e}},{key:"skip",value:function(t){for(var r=Math.floor(t/4),n=t%4,i=0;i<r;i++)e.readByte(this.dataview,4);n>0&&e.readByte(this.dataview,n)}},{key:"readUint8",value:function(){return e.readByte(this.dataview,1)}},{key:"readUint16",value:function(){return e.readByte(this.dataview,2)}},{key:"readUint24",value:function(){return e.readByte(this.dataview,3)}},{key:"readUint32",value:function(){return e.readByte(this.dataview,4)}},{key:"readUint64",value:function(){return e.readByte(this.dataview,8)}},{key:"readInt8",value:function(){return e.readByte(this.dataview,1,!0)}},{key:"readInt16",value:function(){return e.readByte(this.dataview,2,!0)}},{key:"readInt32",value:function(){return e.readByte(this.dataview,4,!0)}},{key:"readString",value:function(e){if(this.position+e<=this.buffer.byteLength){for(var t="",r=0;r<e;r++)t+=String.fromCharCode(this.readUint8());return t}throw new Errors$1(Errors$1.PARSE,Errors$1.BYTE_PARSE_ERROR,{line:124,handle:"[Stream] readString",msg:"readstring error"})}}],[{key:"readByte",value:function(e,t,r){var n;switch(t){case 1:n=r?e.getInt8(e.position):e.getUint8(e.position);break;case 2:n=r?e.getInt16(e.position):e.getUint16(e.position);break;case 3:if(r)throw new Error("not supported for readByte 3");n=e.getUint8(e.position)<<16,n|=e.getUint8(e.position+1)<<8,n|=e.getUint8(e.position+2);break;case 4:n=r?e.getInt32(e.position):e.getUint32(e.position);break;case 8:if(r)throw new Errors$1(Errors$1.PARSE,Errors$1.BYTE_PARSE_ERROR,{line:73,handle:"[Stream] readByte",msg:"not supported for readBody 8"});n=e.getUint32(e.position)<<32,n|=e.getUint32(e.position+4);break;default:n=""}return e.position+=t,n}}]),e}(),Stream$1=Stream,Box=function(){function e(){_classCallCheck$1(this,e),this.headSize=8,this.size=0,this.type="",this.subBox=[],this.start=-1}return _createClass$1(e,[{key:"readHeader",value:function(e){if(this.start=e.position,this.size=e.readUint32(),this.type=String.fromCharCode(e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()),1===this.size)this.size=e.readUint64();else if(0===this.size&&"mdat"!==this.type)throw new Errors$1(Errors$1.PARSE,Errors$1.HEADER_PARSE_ERROR,{line:20,handle:"[Box] readHeader",msg:"parse mp4 mdat box failed"});if("uuid"===this.type)for(var t=[],r=0;r<16;r++)t.push(e.readUint8())}},{key:"readBody",value:function(t){var r,n=this.size-t.position+this.start,i=this.type;this.data=t.buffer.slice(t.position,t.position+n),t.position+=this.data.byteLength,(r=e.containerBox.find((function(e){return e===i}))?e.containerParser:e[i])&&r instanceof Function&&r.call(this)}},{key:"read",value:function(e){this.readHeader(e),this.readBody(e)}}],[{key:"containerParser",value:function(){for(var t=new Stream$1(this.data),r=t.buffer.byteLength;t.position<r;){var n=new e;n.readHeader(t),this.subBox.push(n),n.readBody(t)}delete this.data,t=null}},{key:"parseSampleFlags",value:function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}}]),e}();Box.containerBox=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","mfra","udta"];var Box$1=Box,concat$2={};Object.defineProperty(concat$2,"__esModule",{value:!0}),concat$2.default=function(e){for(var t=0,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;t+=l.length}}catch(_){a=!0,s=_}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}var d=new e(t),f=0,h=!0,p=!1,g=void 0;try{for(var y,v=n[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){var m=y.value;d.set(m,f),f+=m.length}}catch(_){p=!0,g=_}finally{try{!h&&v.return&&v.return()}finally{if(p)throw g}}return d};var _concat=concat$2,_concat2=_interopRequireDefault(_concat);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var lib$1=_concat2.default;function MP4DecConfigDescrTag(e){var t,r=new Box$1;return r.type=e.readUint8(),128===(t=e.readUint8())?(r.extend=!0,e.skip(2),t=e.readUint8()+5):t+=2,r.size=t,r.typeID=e.readUint8(),r.streamUint=e.readUint8(),r.bufferSize=Stream$1.readByte(e.dataview,3),r.maximum=e.readUint32(),r.average=e.readUint32(),r.subBox.push(Box$1.MP4DecSpecificDescrTag(e)),r}function MP4DecSpecificDescrTag(e){var t,r,n=new Box$1;n.type=e.readUint8(),128===(t=e.readUint8())?(n.extend=!0,e.skip(2),r=(t=e.readUint8()+5)-5):(r=t,t+=2),n.size=t;for(var i=[],o=0;o<r;o++)i.push(Number(e.readUint8()).toString(16).padStart(2,"0"));return n.EScode=i,delete n.subBox,n}function MP4ESDescrTag(e){var t,r=new Box$1;return r.type=e.readUint8(),128===(t=e.readUint8())?(r.extend=!0,e.skip(2),t=e.readUint8()+5):t+=2,r.size=t,r.esID=e.readUint16(),r.priority=e.readUint8(),r.subBox.push(Box$1.MP4DecConfigDescrTag(e)),r.subBox.push(Box$1.SLConfigDescriptor(e)),r}function SLConfigDescriptor(e){var t,r=new Box$1;return r.type=e.readUint8(),128===(t=e.readUint8())?(r.extend=!0,e.skip(2),t=e.readUint8()+5):t+=2,r.size=t,r.SL=e.readUint8(),delete r.subBox,r}function av01(){var e=new Stream$1(this.data);for(this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),e.skip(2),this.data_reference_index=e.readUint16(),e.skip(16),this.width=e.readUint16(),this.height=e.readUint16(),e.skip(50);e.position<e.buffer.byteLength;){var t=new Box$1;t.readHeader(e),this.subBox.push(t),t.readBody(e)}delete this.data,e=null}function av1C(){var e=new Stream$1(this.data),t=e.readUint8();this.marker=t>>7&1,console.assert(1===this.marker,"maker should 1"),this.version=127&t,console.assert(1===this.version,"version shoud 1"),t=e.readUint8(),this.seq_profile=t>>5&7,this.seq_level_idx_0=31&t,t=e.readUint8(),this.seq_tier_0=t>>7&1,this.high_bitdepth=t>>6&1,this.twelve_bit=t>>5&1,this.monochrome=t>>4&1,this.chroma_subsampling_x=t>>3&1,this.chroma_subsampling_y=t>>2&1,this.chroma_sample_position=3&t,t=e.readUint8(),this.initial_presentation_delay_present=t>>4&1,this.initial_presentation_delay_present&&(this.initial_presentation_delay_minus_one=15&t),this.configOBUs=new Uint8Array(e.buffer.slice(e.position))}function avc1(){var e=new Stream$1(this.data);e.skip(6),this.dataReferenceIndex=e.readUint16(),e.skip(16),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.skip(4),this.frameCount=e.readUint16(),e.skip(1);for(var t=0;t<31;t++)String.fromCharCode(e.readUint8());for(this.depth=e.readUint16(),e.skip(2);e.position<e.buffer.byteLength;){var r=new Box$1;r.readHeader(e),this.subBox.push(r),r.readBody(e)}delete this.data,e=null}var Golomb=function(){function e(t){_classCallCheck$1(this,e),this.TAG="Golomb",this._buffer=t,this._bufferIndex=0,this._totalBytes=t.byteLength,this._totalBits=8*t.byteLength,this._currentWord=0,this._currentWordBitsLeft=0}return _createClass$1(e,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var e=this._totalBytes-this._bufferIndex,t=Math.min(4,e),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+t)),this._currentWord=new DataView(r.buffer).getUint32(0),this._bufferIndex+=t,this._currentWordBitsLeft=8*t}},{key:"readBits",value:function(e){var t=Math.min(this._currentWordBitsLeft,e),r=this._currentWord>>>32-t;if(e>32)throw new Error("Cannot read more than 32 bits at a time");return this._currentWordBitsLeft-=t,this._currentWordBitsLeft>0?this._currentWord<<=t:this._totalBytes-this._bufferIndex>0&&this._fillCurrentWord(),(t=e-t)>0&&this._currentWordBitsLeft?r<<t|this.readBits(t):r}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var e;for(e=0;e<this._currentWordBitsLeft;e++)if(0!=(this._currentWord&2147483648>>>e))return this._currentWord<<=e,this._currentWordBitsLeft-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}},{key:"readUEG",value:function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1}},{key:"readSEG",value:function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}}]),e}(),Golomb$1=Golomb,SPSParser=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,null,[{key:"_ebsp2rbsp",value:function(e){for(var t=e,r=t.byteLength,n=new Uint8Array(r),i=0,o=0;o<r;o++)o>=2&&3===t[o]&&0===t[o-1]&&0===t[o-2]||(n[i]=t[o],i++);return new Uint8Array(n.buffer,0,i)}},{key:"parseSPS",value:function(t){var r=e._ebsp2rbsp(t),n=new Golomb$1(r);n.readByte();var i=n.readByte();n.readByte();var o=n.readByte();n.readUEG();var a=e.getProfileString(i),s=e.getLevelString(o),u=1,c=420,l=8;if((100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i||138===i||144===i)&&(3===(u=n.readUEG())&&n.readBits(1),u<=3&&(c=[0,420,422,444][u]),l=n.readUEG()+8,n.readUEG(),n.readBits(1),n.readBool()))for(var d=3!==u?8:12,f=0;f<d;f++)n.readBool()&&(f<6?e._skipScalingList(n,16):e._skipScalingList(n,64));n.readUEG();var h=n.readUEG();if(0===h)n.readUEG();else if(1===h){n.readBits(1),n.readSEG(),n.readSEG();for(var p=n.readUEG(),g=0;g<p;g++)n.readSEG()}n.readUEG(),n.readBits(1);var y=n.readUEG(),v=n.readUEG(),m=n.readBits(1);0===m&&n.readBits(1),n.readBits(1);var _=0,b=0,A=0,E=0;n.readBool()&&(_=n.readUEG(),b=n.readUEG(),A=n.readUEG(),E=n.readUEG());var S=1,T=1,$=0,w=!0,C=0,I=0;if(n.readBool()){if(n.readBool()){var k=n.readByte();k>0&&k<16?(S=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][k-1],T=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][k-1]):255===k&&(S=n.readByte()<<8|n.readByte(),T=n.readByte()<<8|n.readByte())}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(4),n.readBool()&&n.readBits(24)),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool()){var O=n.readBits(32),P=n.readBits(32);w=n.readBool(),$=(C=P)/(I=2*O)}}var R=1;1===S&&1===T||(R=S/T);var x=0,D=0;0===u?(x=1,D=2-m):(x=3===u?1:2,D=(1===u?2:1)*(2-m));var L=16*(y+1),N=16*(v+1)*(2-m);L-=(_+b)*x,N-=(A+E)*D;var M=Math.ceil(L*R);return n.destroy(),n=null,{profile_string:a,level_string:s,bit_depth:l,chroma_format:c,chroma_format_string:e.getChromaFormatString(c),frame_rate:{fixed:w,fps:$,fps_den:I,fps_num:C},par_ratio:{width:S,height:T},codec_size:{width:L,height:N},present_size:{width:M,height:N}}}},{key:"_skipScalingList",value:function(e,t){for(var r=8,n=8,i=0;i<t;i++)0!==n&&(n=(r+e.readSEG()+256)%256),r=0===n?r:n}},{key:"getProfileString",value:function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(e){return(e/10).toFixed(1)}},{key:"getChromaFormatString",value:function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}},{key:"toVideoMeta",value:function(e){var t={};e&&e.codec_size&&(t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height),t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.parRatio={width:e.par_ratio.width,height:e.par_ratio.height},t.frameRate=e.frame_rate;var r=t.frameRate.fps_den,n=t.frameRate.fps_num;t.refSampleDuration=Math.floor(t.timescale*(r/n))}}]),e}(),SpsParser=SPSParser;function avcC(){var e=new Stream$1(this.data);this.configVersion=e.readUint8(),this.profile=e.readUint8(),this.profileCompatibility=e.readUint8(),this.AVCLevelIndication=e.readUint8(),this.lengthSizeMinusOne=1+(3&e.readUint8()),this.numOfSequenceParameterSets=31&e.readUint8();var t=e.readUint16();this.sequenceLength=t;for(var r=[],n=0;n<t;n++)r.push(e.readUint8());this.spsInfo=SpsParser.parseSPS(new Uint8Array(r)),this.ppsCount=e.readUint8();var i=e.readUint16();this.ppsLength=i;for(var o=[],a=0;a<i;a++)o.push(Number(e.readUint8()).toString(16));this.pps=o,this.sps=r;for(var s=[],u=e.dataview.byteLength;e.position<u;)s.push(e.readUint8());this.last=s,delete this.subBox,delete this.data,e=null}function btrt(){var e=new Stream$1(this.data);this.bufferSizeDB=e.readUint32(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32(),delete this.subBox,delete this.data,e=null}function co64(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.count=e.readUint32();var t=[];this.entries=t;for(var r=0,n=this.count;r<n;r++)t.push(e.readUint64());delete this.subBox,delete this.data,e=null}function ctts(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.entryCount=e.readUint32();var t=[];this.entry=t;for(var r=0,n=this.entryCount;r<n;r++)t.push({count:e.readUint32(),offset:e.readUint32()});delete this.subBox,delete this.data,e=null}function dref(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3);var t=e.readUint32();this.entryCount=t;for(var r=0;r<t;r++){var n=new Box$1;this.subBox.push(n),n.read(e)}delete this.data,e=null}function elst(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3);var t=[],r=e.readUint32();this.entries=t;for(var n=0;n<r;n++){var i={};t.push(i),1===this.version?(i.segment_duration=e.readUint64(),i.media_time=e.readUint64()):(i.segment_duration=e.readUint32(),i.media_time=e.readInt32()),i.media_rate_integer=e.readInt16(),i.media_rate_fraction=e.readInt16()}delete this.subBox,e=null}function enca(){var e=new Stream$1(this.data);for(e.readUint16(),e.readUint16(),e.readUint16(),this.data_reference_index=e.readUint16(),e.readUint32(),e.readUint32(),this.channelCount=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.sampleRate=e.readUint32()/65536;e.position<e.buffer.byteLength;){var t=new Box$1;t.readHeader(e),this.subBox.push(t),t.readBody(e)}e=null}function encv(){var e=new Stream$1(this.data);for(e.readUint16(),e.readUint16(),e.readUint16(),e.readUint16(),e.skip(16),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16(),e.skip(32),this.depth=e.readUint16(),e.readUint16();e.position<e.buffer.byteLength;){var t=new Box$1;t.readHeader(e),this.subBox.push(t),t.readBody(e)}e=null}function esds(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3);var t=Box$1.MP4ESDescrTag(e);this.subBox.push(t),delete this.data,e=null}function frma(){var e=new Stream$1(this.data);this.data_format="";for(var t=0;t<4;t++)this.data_format+=String.fromCharCode(e.readUint8())}function ftyp(){}function hdlr(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),e.skip(4),this.handleType="".concat(String.fromCharCode(e.readUint8())).concat(String.fromCharCode(e.readUint8())).concat(String.fromCharCode(e.readUint8())).concat(String.fromCharCode(e.readUint8())),e.skip(12);for(var t=[];e.position<this.size-8;)t.push(String.fromCharCode(e.readUint8()));this.name=t.join(""),delete this.subBox,e=null}function iods(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3);for(var t=[],r=e.buffer.byteLength;e.position<r;)t.push(e.readUint8());this.content=t,delete this.subBox,delete this.data,e=null}var UTC=function(){function e(){_classCallCheck$1(this,e);var t=new Date;t.setFullYear(1904),t.setMonth(0),t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),this.time=t}return _createClass$1(e,[{key:"setTime",value:function(e){return this.time.setTime(this.time.getTime()+Number(e)),this.time.toLocaleString()}}]),e}(),UTC$1=UTC;function mdhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),1===this.version?(this.create=e.readUint64(),this.modify=e.readUint64(),this.createTime=(new UTC$1).setTime(1e3*this.create),this.modifyTime=(new UTC$1).setTime(1e3*this.modify),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.create=e.readUint32(),this.modify=e.readUint32(),this.createTime=(new UTC$1).setTime(1e3*this.create),this.modifyTime=(new UTC$1).setTime(1e3*this.modify),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.language=e.readUint16(),e.readUint16(),delete this.subBox,e=null}function mehd(){var e=new Stream$1(this.data);e.skip(4),this.fragment_duration=e.readUint32()}function mp4a(){var e=new Stream$1(this.data);e.skip(6),this.dataReferenceIndex=e.readUint16(),e.skip(8),this.channelCount=e.readUint16(),this.sampleSize=e.readUint16(),e.skip(4),this.sampleRate=e.readUint32()>>16;var t=new Box$1;t.readHeader(e),this.subBox.push(t),t.readBody(e),delete this.data,e=null}function mvhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.create=e.readUint32(),this.modify=e.readUint32(),this.createTime=(new UTC$1).setTime(1e3*this.create),this.modifyTime=(new UTC$1).setTime(1e3*this.modify),this.timeScale=e.readUint32(),this.duration=e.readUint32(),this.rate=e.readUint16()+"."+e.readUint16(),this.volume=e.readUint8()+"."+e.readUint8(),Stream$1.readByte(e.dataview,8),Stream$1.readByte(e.dataview,2);for(var t=[],r=0;r<9;r++)t.push(e.readUint16()+"."+e.readUint16());this.matrix=t,Stream$1.readByte(e.dataview,24),this.nextTrackID=e.readUint32(),delete this.subBox}function pasp(){var e=new Stream$1(this.data);this.hSpacing=e.readUint32(),this.vSpacing=e.readUint32(),e=null}function pssh(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flags=e.readUint24();for(var t=[],r=[],n=0;n<16;n++)r.push(util$1.toHex(e.readUint8()));if(this.version>0)for(var i=e.readUint32(),o=0;o<String(i).length;o++)for(var a=0;a<16;a++){var s=e.readUint8();t.push(util$1.toHex(s))}var u=e.readUint32();this.data_size=u,e.skip(u),this.kid=t,this.system_id=r,this.buffer=e.buffer,e=null}function saio(){var e=new Stream$1(this.data);this.entry_count=e.readUint32(),e=null}function saiz(){var e=new Stream$1(this.data);this.default_sample_info_size=e.readUint8(),e.readUint32(),this.sample_info_size=e.readUint32(),e=null}function schm(){var e=new Stream$1(this.data);this.scheme_version=e.readUint32(),this.scheme_type="";for(var t=0;t<4;t++)this.scheme_type+=String.fromCharCode(e.readUint8());if(1&this.flags){this.scheme_uri="";for(var r=0;r<this.size-this.hdr_size-8;r++)this.scheme_uri+=String.fromCharCode(e.readUint8())}}function senc(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flags=e.readUint24();var t=e.readUint32();if(this.samples=[],t)for(var r=0;r<t;r++){var n={},i=2&this.flags;if(i&&Math.floor(this.data.byteLength/t)<=16?n.InitializationVector=[e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()]:n.InitializationVector=[e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()],i){n.subsamples=[];for(var o=e.readUint16(),a=0;a<o;a++){var s={};s.BytesOfClearData=e.readUint16(),s.BytesOfProtectedData=e.readUint32(),n.subsamples.push(s)}}this.samples.push(n)}}function sidx(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.reference_ID=e.readUint32(),this.timescale=e.readUint32(),0===this.version?(this.earliest_presentation_time=e.readUint32(),this.first_offset=e.readUint32()):(this.earliest_presentation_time=e.readUint64(),this.first_offset=e.readUint64()),e.readUint16(),this.references=[];for(var t=e.readUint16(),r=0;r<t;r++){var n={};this.references.push(n);var i=e.readUint32();n.reference_type=i>>31&1,n.referenced_size=2147483647&i,n.subsegment_duration=e.readUint32(),i=e.readUint32(),n.starts_with_SAP=i>>31&1,n.SAP_type=i>>28&7,n.SAP_delta_time=268435455&i}e=null}function smhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.balance=e.readInt8()+"."+e.readInt8(),delete this.subBox,delete this.data,e=null}function stco(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.count=e.readUint32();var t=[];this.entries=t;for(var r=0,n=this.count;r<n;r++)t.push(e.readUint32());delete this.subBox,delete this.data,e=null}function stsc(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.count=e.readUint32();var t=[];this.entries=t;for(var r=0,n=this.count;r<n;r++)t.push({first_chunk:e.readUint32(),samples_per_chunk:e.readUint32(),sample_desc_index:e.readUint32()});for(var i,o,a=0,s=this.count;a<s-1;a++)i=t[a],o=t[a-1],i.chunk_count=t[a+1].first_chunk-i.first_chunk,i.first_sample=0===a?1:o.first_sample+o.chunk_count*o.samples_per_chunk;if(1===this.count){var u=t[0];u.first_sample=1,u.chunk_count=0}else if(this.count>1){var c=t[this.count-1],l=t[this.count-2];c.first_sample=l.first_sample+l.chunk_count*l.samples_per_chunk,c.chunk_count=0}delete this.subBox,delete this.data,e=null}function stsd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.entryCount=e.readUint32();var t=new Box$1;t.readHeader(e),this.subBox.push(t),t.readBody(e),delete this.data,e=null}function stss(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.count=e.readUint32();var t=[];this.entries=t;for(var r=0,n=this.count;r<n;r++)t.push(e.readUint32());delete this.subBox,delete this.data,e=null}function stsz(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.sampleSize=e.readUint32(),this.count=e.readUint32();var t=[];this.entries=t;for(var r=0,n=this.count;r<n;r++)this.sampleSize?t.push(this.sampleSize):t.push(e.readUint32());delete this.subBox,delete this.data,e=null}function stts(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3),this.count=e.readUint32();for(var t=[],r=0,n=this.count;r<n;r++)t.push({sampleCount:e.readUint32(),sampleDuration:e.readUint32()});this.entry=t,delete this.subBox,delete this.data,e=null}function tenc(){var e=new Stream$1(this.data);e.skip(6),this.default_IsEncrypted=e.readUint8(),this.default_IV_size=e.readUint8(),this.default_KID=[];for(var t=0;t<16;t++)this.default_KID.push(util$1.toHex(e.readUint8()))}function tfhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flags=e.readUint24(),e.skip(3),this.track_id=e.readUint8(),this.hdr_size=16,this.size>this.hdr_size&&1&this.flags?(this.base_data_offset=e.readUint64(),this.hdr_size=this.hdr_size+8):this.base_data_offset=0,this.size>this.hdr_size&&2&this.flags?(this.default_sample_description_index=e.readUint32(),this.hdr_size=this.hdr_size+4):this.default_sample_description_index=0,this.size>this.hdr_size&&8&this.flags?(this.default_sample_duration=e.readUint32(),this.hdr_size=this.hdr_size+4):this.default_sample_duration=0,this.size>this.hdr_size&&16&this.flags?(this.default_sample_size=e.readUint32(),this.hdr_size=this.hdr_size+4):this.default_sample_size=0,this.size>this.hdr_size&&32&this.flags?(this.default_sample_flags=e.readUint32(),this.hdr_size=this.hdr_size+4):this.default_sample_flags=0}function tkhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3,0),1===this.version?(this.create=e.readUint64(),this.modify=e.readUint64(),this.createTime=(new UTC$1).setTime(1e3*this.create),this.modifyTime=(new UTC$1).setTime(1e3*this.modify),this.trackID=e.readUint32(),this.reserverd=e.readUint32(),this.duration=e.readUint64()):(this.create=e.readUint32(),this.modify=e.readUint32(),this.createTime=(new UTC$1).setTime(1e3*this.create),this.modifyTime=(new UTC$1).setTime(1e3*this.modify),this.trackID=e.readUint32(),this.reserverd=e.readUint32(),this.duration=e.readUint32()),e.readUint64(),this.layer=e.readInt16(),this.alternate_group=e.readInt16(),this.volume=e.readInt16()>>8,e.readUint16();for(var t=[],r=0;r<9;r++)t.push(e.readUint16()+"."+e.readUint16());this.matrix=t,this.width=e.readUint16()+"."+e.readUint16(),this.height=e.readUint16()+"."+e.readUint16(),delete this.subBox,e=null}function trun(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flags=e.readUint24(),this.samples=[],this.sampleInfos=[];var t,r,n=1&this.flags,i=4&this.flags,o=256&this.flags,a=512&this.flags,s=1024&this.flags,u=2048&this.flags,c=e.readUint32();for(n&&(this.dataOffset=e.readUint32()),i&&c&&(r=Box$1.parseSampleFlags([e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()]));c>0;)c--,t={},o&&(t.duration=e.readUint32()),a&&(t.size=e.readUint32()),s&&(t.flags=Box$1.parseSampleFlags([e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()])),u&&(t.compositionTimeOffset=e.readUint32()),this.samples.push(t.size),this.sampleInfos.push(t);r&&this.sampleInfos.length>0&&(this.sampleInfos[0].flags=r),delete this.subBox,e=null}var findBox=util$1.findBox;function udta(){}function meta(){var e=new Stream$1(this.data),t=e.buffer.byteLength;this.version=e.readUint8(),this.flag=Stream$1.readByte(e.dataview,3);for(var r=this;e.position<t;){var n=new Box$1;n.readHeader(e),r.subBox.push(n),n.readBody(e)}this.vid=null;var i=findBox(r,"keys"),o=findBox(r,"ilst");if(i&&o){var a=i.metaKeys.indexOf("comment");if(a>-1){var s=o.datas[a];"string"==typeof s&&s.indexOf("vid")>-1&&(this.vid=s.split(":")[1])}}if(!this.vid&&o)for(var u=0;u<o.datas.length;u++){var c=o.datas[u];if("string"==typeof c&&c.indexOf("vid")>-1){this.vid=c.split(":")[1];break}}delete r.data,e=null}function keys$3(){var e=new Stream$1(this.data);e.skip(4),this.count=e.readUint32(),this.metaKeys=[];for(var t=0;t<this.count;t++){var r=e.readUint32();r-=8,"mdta"!==e.readString(4)&&e.skip(r);var n=e.readString(r);this.metaKeys.push(n)}e=null}function ilst(){var e=new Stream$1(this.data),t=e.buffer.byteLength;for(this.datas=[];e.position<t;){e.skip(4);var r=e.readUint32()-1,n=e.readUint32();if("data"!==e.readString(4))e.skip(n-8);else{e.skip(8);var i=e.readString(n-16);this.datas[r]=i}}e=null}function vmhd(){var e=new Stream$1(this.data);this.version=e.readUint8(),this.flag=[e.readUint8(),e.readUint8(),e.readUint8()],this.graphicsmode=e.readUint16(),this.opcolor=[e.readUint16(),e.readUint16(),e.readUint16()],delete this.subBox,e=null}Box$1.MP4DecConfigDescrTag=MP4DecConfigDescrTag,Box$1.MP4DecSpecificDescrTag=MP4DecSpecificDescrTag,Box$1.MP4ESDescrTag=MP4ESDescrTag,Box$1.SLConfigDescriptor=SLConfigDescriptor,Box$1.av01=av01,Box$1.av1C=av1C,Box$1.avc1=avc1,Box$1.avcC=avcC,Box$1.btrt=btrt,Box$1.co64=co64,Box$1.ctts=ctts,Box$1.dref=dref,Box$1.elst=elst,Box$1.enca=enca,Box$1.encv=encv,Box$1.esds=esds,Box$1.frma=frma,Box$1.ftyp=ftyp,Box$1.hdlr=hdlr,Box$1.iods=iods,Box$1.mdhd=mdhd,Box$1.mehd=mehd,Box$1.mp4a=mp4a,Box$1.mvhd=mvhd,Box$1.pasp=pasp,Box$1.pssh=pssh,Box$1.saio=saio,Box$1.saiz=saiz,Box$1.schm=schm,Box$1.senc=senc,Box$1.sidx=sidx,Box$1.smhd=smhd,Box$1.stco=stco,Box$1.stsc=stsc,Box$1.stsd=stsd,Box$1.stss=stss,Box$1.stsz=stsz,Box$1.stts=stts,Box$1.tenc=tenc,Box$1.tfhd=tfhd,Box$1.tkhd=tkhd,Box$1.trun=trun,Box$1.udta=udta,Box$1.meta=meta,Box$1.ilst=ilst,Box$1.keys=keys$3,Box$1.vmhd=vmhd;var Parse=_createClass$1((function e(t){_classCallCheck$1(this,e),this.buffer=null,this.boxes=[],this.nextBox=null,this.start=0;var r=this;r.buffer?lib$1(Uint8Array,r.buffer,t):r.buffer=t;var n=t.byteLength;t.position=0;for(var i=new Stream$1(t);n-i.position>=8;){var o=new Box$1;if(o.readHeader(i),o.size-8<=n-i.position)o.readBody(i),r.boxes.push(o);else{if("mdat"!==o.type){r.nextBox=o,i.position-=8;break}o.readBody(i),r.boxes.push(o)}}r.buffer=new Uint8Array(r.buffer.slice(i.position))})),Parser=Parse,_CodecsConfigMap,CodecsItem=_createClass$1((function e(t,r,n,i,o,a){_classCallCheck$1(this,e),this.type=t,this.codecs=r,this.visualEntryBox=n,this.configurationBox=i,this.types=o,this.logCodeType=a})),CodecsTypes={AVC:"avc",AV1:"av1"},CodecsConfigMap=(_CodecsConfigMap={},_defineProperty$1(_CodecsConfigMap,CodecsTypes.AVC,new CodecsItem("avc","avc1.64001E","avc1","avcC",["h264"],"h264")),_defineProperty$1(_CodecsConfigMap,CodecsTypes.AV1,new CodecsItem("av1","av01.0.08M.08","av01","av1C",["av1"],"av1")),_CodecsConfigMap),MPD=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;_classCallCheck$1(this,t),EventEmitter(this),this.url=e,this.options=n,this.dash=i,this.mediaList={video:[],audio:[]},this.retryMax=10,this.retry=0,this.type="live",this.isEnd=!1,this.duration=0,this.videoCodecType=null,this.videoCodecs=null,setTimeout((function(){r.init(e)}))}var r;return _createClass$1(t,[{key:"calcVideoCodeType",value:function(e,t){if((e||t)&&!this.videoCodecType){var r=null;t?r=t.split(".")[0]:e&&(r=e.split(".")[0]);for(var n=Object.keys(CodecsConfigMap),i=0;i<n.length;i++){var o=n[i],a=CodecsConfigMap[o];if(a.types.concat(a.visualEntryBox).indexOf(r)>-1){this.videoCodecType=o,this.videoCodecs=a.codecs;break}}debug$1$1.log("mpd dataType:",e,"codecs:",t,"cal type:",this.videoCodecType,"videoCodecs",this.videoCodecs),this.videoCodecType||(this.videoCodecType=CodecsTypes.AVC,this.videoCodecs=CodecsConfigMap[CodecsTypes.AVC].codecs,console.warn("calcVideoCodeType default")),this.dash&&this.dash._pluginInst&&this.dash._pluginInst.setCodeInfo(this.videoCodecType)}}},{key:"fetch",value:(r=_asyncToGenerator(regenerator.mark((function e(r){var n,i,o,a=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,i={TYPE:"LIVE",ENDLIST:""},o=[],e.abrupt("return",new Promise((function(e,s){new XHR$1({type:"",url:r}).then((function(u){var c=u.responseText;if(c){var l=t.parseMPD(c);l||s(new Error("parse mpd error"));var d=[];"static"===l.type&&(i.TYPE="VOD"),l.minBufferTime&&(i.minBufferTime=util$1.durationConvert(l.minBufferTime)),l.maxSegmentDuration&&(i.maxSegmentDuration=util$1.durationConvert(l.maxSegmentDuration)),l.mediaPresentationDuration&&(n.duration=util$1.durationConvert(l.mediaPresentationDuration));var f="";l.BaseURL&&(f=l.BaseURL[0]);var h=l.Period[0];!n.duration&&h&&h.duration&&(n.duration=util$1.durationConvert(h.duration)),i.duration=n.duration,h.AdaptationSet&&h.AdaptationSet.length>1&&h.AdaptationSet.forEach((function(e){var t="video/mp4",i="avc1.64001E",o="640",s="360",u="25",c="1:1",l="1",h="588633";e.mimeType&&("video/mp4"===(t=e.mimeType)?(i=e.codecs,o=parseFloat(e.width),s=parseFloat(e.height),u=parseFloat(e.frameRate),c=e.sar,l=e.startWithSAP,h=parseFloat(e.bandwidth),n.calcVideoCodeType(null,i)):"audio/mp4"===t&&(i=e.codecs,l=e.startWithSAP,h=parseFloat(e.bandwidth))),e.Representation.forEach((function(p){d.indexOf(p.id)>-1&&(p.id=(parseInt(d[d.length-1],10)+1).toString()),d.push(p.id);var g,y="",v=[],m=0,_=0,b=r.slice(0,r.lastIndexOf("/")+1)+f;p.mimeType&&(t=p.mimeType),p.mimeType&&(t=p.mimeType),"video/mp4"===t?(p.codecs&&(i=p.codecs,n.calcVideoCodeType(null,i)),p.width&&(o=parseFloat(p.width)),p.height&&(s=parseFloat(p.height)),p.frameRate&&(u=parseFloat(p.frameRate)),p.sar&&(c=p.sar),p.startWithSAP&&(l=p.startWithSAP),p.bandwidth&&(h=parseFloat(p.bandwidth))):"audio/mp4"===t&&(p.codecs&&(i=p.codecs),p.startWithSAP&&(l=p.startWithSAP),p.bandwidth&&(h=parseFloat(p.bandwidth))),p.BaseURL&&p.BaseURL.length>0&&(b+=p.BaseURL[0]),e.SegmentTemplate&&e.SegmentTemplate.length>0&&(g=e.SegmentTemplate[0]),p.SegmentTemplate&&p.SegmentTemplate.length>0&&(g=p.SegmentTemplate[0]);var A=!1;if((e.ContentProtection||p.ContentProtection)&&(A=!0),g){y=g.initialization,m=parseFloat(g.timescale),_=parseFloat(g.duration);for(var E=Math.round(_/m),S=parseInt(g.startNumber,10),T=S+Math.ceil(n.duration/E)-1,$=S;$<=T;$++){var w=E*($-S),C=E*($-S+1);$===T&&(E=n.duration-E*(T-S),C=n.duration),v.push({idx:$,start:Math.round(w),end:Math.round(C),url:b+g.media.replace("$RepresentationID$",p.id).replace("$Number%04d$",util$1.preFixInterge($,4)),downloaded:0,segmentDuration:E,height:s})}}if(h=1e3*parseInt(h/1e3,10),"video/mp4"===t){var I,k;if(a.options.dynamic_video&&a.options.dynamic_video.dynamic_video_list)for(var O=0;O<a.options.dynamic_video.dynamic_video_list.length;O++){var P=a.options.dynamic_video.dynamic_video_list[O];P.bitrate===h&&(I=P.size,k=P.definition)}n.mediaList.video.push({id:p.id,baseURL:b,initSegment:b+y.replace("$RepresentationID$",p.id),inited:!1,mediaSegments:v,mimeType:t,codecs:i,width:o,height:s,size:I,frameRate:u,sar:c,startWithSAP:l,bandwidth:h,timescale:m,duration:_,encrypted:A,definition:k})}else if("audio/mp4"===t){var R;if(a.options.dynamic_video&&a.options.dynamic_video.dynamic_audio_list)for(var x=0;x<a.options.dynamic_video.dynamic_audio_list.length;x++)a.options.dynamic_video.dynamic_audio_list[x].bitrate===h&&(R=a.options.dynamic_video.dynamic_audio_list[x].size);n.mediaList.audio.push({id:p.id,baseURL:b,initSegment:b+y.replace("$RepresentationID$",p.id),inited:!1,mediaSegments:v,mimeType:t,codecs:i,startWithSAP:l,bandwidth:h,size:R,timescale:m,duration:_,encrypted:A})}}))})),["video","audio"].forEach((function(e){n.mediaList[e].length>0&&(n.mediaList[e].selectedIdx="video"===e&&n.dash.selectedIdx||0,n.mediaList[e].sort((function(t,r){return"video"===e?r.height-t.height:r.bandwidth-t.bandwidth})))})),0===n.mediaList.video.length&&0===n.mediaList.audio.length&&setTimeout((function(){n.dash.player&&n.dash.player.emit("NO_MEDIALIST",{dynamic_type:"segment_template"})})),e({meta:i,segments:o})}else n.dash.emit("error",new Errors$1(Errors$1.PARSE,Errors$1.MPD_PARSE_ERROR,{line:253,handle:"[MPD] parse",msg:"mpd segment template Parse error",url:r},n.dash.player)),s()})).catch((function(e){var t=403===e.status?TASK_REQUEST_EXPIRED:"mpd Request error";n.dash.emit("error",new Errors$1(Errors$1.PD_NETWORK,Errors$1.NETEORK_ERROR_CODES[e&&e.status?e.status:"timeout"],{line:258,handle:"[MPD] xhr",msg:t,url:r},n.dash.player)),s(e)}))})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"init",value:function(e){var t=this,r=t.options;if(r.dynamic_video.dynamic_type&&"segment_template"!==r.dynamic_video.dynamic_type){t.dashType="segment_base";var n=0;r.duration;var i=r.dynamic_video;["dynamic_video_list","dynamic_audio_list"].forEach((function(e){var o="dynamic_audio_list"===e;i[e].forEach((function(i){var a=parseInt(i.init_range.split("-")[0],10),s=parseInt(i.init_range.split("-")[1],10),u=parseInt(i.index_range.split("-")[0],10),c=parseInt(i.index_range.split("-")[1],10);o||t.calcVideoCodeType(i.codec_type),t.mediaList["dynamic_audio_list"===e?"audio":"video"].push({id:("dynamic_audio_list"===e?0:n++).toString(),baseURL:i.main_url,initSegment:i.main_url,initSegmentRange:[a,s],sidxRange:[u,c],inited:!1,hasSidx:!1,mediaSegments:[],mimeType:o?"audio/mp4":"video/mp4",codecs:o?"mp4a.40.2":i.codec_type&&i.codec_type.indexOf("h265")>-1?"hev1.1.6.L93.B0":t.videoCodecs,width:i.vwidth,height:i.vheight,bandwidth:1e3*parseInt(i.bitrate/1e3,10),size:i.size,timescale:-1,duration:r.duration,encrypted:i.encrypt,kid:i.kid,definition:i.definition,sidxRes:void 0})}))})),t.type="vod",["video","audio"].forEach((function(e){t.mediaList[e].length>0&&(t.mediaList[e].selectedIdx="video"===e&&t.dash.selectedIdx||0,t.mediaList[e].sort((function(t,r){return"video"===e?r.height-t.height:r.bandwidth-t.bandwidth})))})),0===t.mediaList.video.length&&0===t.mediaList.audio.length&&t.dash&&t.dash.player&&setTimeout((function(){t.dash.player.emit("NO_MEDIALIST",{dynamic_type:"segment_base"})})),t.emit("ready")}else t.dashType="segment_template",t.fetch(r.dynamic_video.main_url).then((function(e){t.type=e.meta.TYPE.toLocaleLowerCase(),t.emit("ready")}),(function(){["video","audio"].forEach((function(e){t.mediaList[e]=[]})),t.retry++,t.retry,t.retryMax}))}},{key:"getSidx",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,o=this,a=o.mediaList[r][n],s=a.sidxRange[1];a.sidxFetching=!0;try{new Parser(t).boxes.every((function(e){if("sidx"===e.type){var r=[],n=0,o=0,u=s+1,c=u-1;return e.references.forEach((function(t,i){o+=t.subsegment_duration,c+=t.referenced_size,r.push({idx:i+1,url:a.initSegment,start:Math.round(n/e.timescale),end:Math.round(o/e.timescale),range:[u,c],downloaded:0,segmentDuration:Math.round(t.subsegment_duration/e.timescale),reference_type:t.reference_type,starts_with_SAP:t.starts_with_SAP,SAP_type:t.SAP_type,SAP_delta_time:t.SAP_delta_time}),n=o+1,u=c+1})),r[0].startTime_=0,a.mediaDuration=0,r.forEach((function(e,t){a.mediaDuration+=e.segmentDuration,t>0&&(e.startTime_=r[t-1].startTime_+r[t-1].segmentDuration),t===r.length-1&&i&&(e.end=i)})),a.hasSidx=!0,a.mediaSegments=r,a.timescale=e.timescale,a.sidxRes=t,!1}return!0})),a.sidxFetching=!1}catch(e){throw a.sidxFetching=!1,o.dash.reportMonitorEvent(SIDX_EXCEPTION),new Errors$1(Errors$1.PARSE,Errors$1.SID_PARSE_ERROR,{line:398,handle:"[MPD] getSidx",msg:"mpd segment base Parse getSidx error"},o.dash.player)}}},{key:"checkInBuffered",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=this.dash.mse.buffered(e);if(!i)return!1;for(var o=0;o<i.length;o++){var a=util$1.round(i.start(o)),s=util$1.round(i.end(o));if(util$1.round(t)+n>=a&&util$1.round(r)-n<=s)return!0}return!1}},{key:"seek",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MPD_SEEK_TYPE.NORMAL;debug$1$1.log("mpd seek: ".concat(e));var n=this,i={};function o(){["video","audio"].forEach((function(t){if(n.mediaList[t].length<1)return!0;var o=n.mediaList[t][n.mediaList[t].selectedIdx].mediaSegments;i[t]=o.filter((function(i,a){if(i.downloaded===SEGMENT_STATE.APPEND){if(n.checkInBuffered(t,i.start,i.end,0))return!1;if(i.incomplete)return!1;debug$1$1.log("".concat(t," ").concat(a," start:").concat(i.start," end:").concat(i.end," segment downloaded set false")),i.downloaded=SEGMENT_STATE.NO_START}if(i.start<=e&&e<i.end&&i.downloaded===SEGMENT_STATE.NO_START)return i.downloaded=SEGMENT_STATE.GOING,!0;if(r===MPD_SEEK_TYPE.NORMAL)for(var s=1;s<(n.dash.config.reqSegNum||DEFAULT_REQ_SEQ_NUM);s++)if(a-s>=0&&o[a-s].start<=e&&e<o[a-s].end&&!i.downloaded)return i.downloaded=SEGMENT_STATE.GOING,!0;return!1}))}))}return new Promise((function(r,n){"vod"===t.type||void 0!==e?(o(),r(i)):n("media error2")}))}},{key:"clearBuffer",value:function(e,t){var r=this;"vod"===r.type&&["video","audio"].forEach((function(n){r.mediaList[n].length>0&&r.mediaList[n][r.mediaList[n].selectedIdx].mediaSegments.forEach((function(r,i){r.downloaded&&(r.end<e||r.start>t||(debug$1$1.log("".concat(n," ").concat(i," start:").concat(r.start," end:").concat(r.end," segment downloaded set false")),r.downloaded=SEGMENT_STATE.NO_START))}))}))}}],[{key:"parseMPD",value:function(e){var t;if("string"==typeof e&&(t=e),e instanceof ArrayBuffer){var r=new Uint8Array(e);t=String.fromCharCode.apply(null,r)}if(!t)return null;var n=performance.now();return t=t.replace(/<(\/)?(\w+:)+(\w+)/g,"<$1$3"),debug$1$1.log("MPD cost",performance.now()-n),Xml2Json.parse(t)}},{key:"parseTime",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.getAttribute(r);i&&(t[n||r]=util$1.durationConvert(i))}}]),t}(),MPD$1=MPD,collection=collection$2,collectionStrong=collectionStrong$2;collection("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),collectionStrong);var createTypedArrayConstructor$6=typedArrayConstructor.exports;createTypedArrayConstructor$6("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var SPPED_CACHE="danger_d_speed";function convert32ToC64(e){var t=e.toString(16);return t.length<=8?{high:0,low:e}:{high:parseInt(t.substr(0,t.length-8),16),low:parseInt(t.substr(t.length-8),16)}}var BaseAbr=function(){function e(t,r,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{logger:function(){},openLog:!1};_classCallCheck$1(this,e),this.bitrate=r,this.segment_duration=i||5e3,this.logger=o.logger,this.openLog=o.openLog,this.cdnHost=t.cdnHost,this._loadedPromise=new ProxyPromise,this._wasmPromise=new ProxyPromise,this.config=t,this.autoBitrateOpts=t.autoBitrateOpts||{},this.stall_penalty=this.autoBitrateOpts.stall_penalty||11,this.switch_penalty=this.autoBitrateOpts.switch_penalty||4,this.interval=this.autoBitrateOpts.interval||1e3;var a=t.progressTimer||1e3,s=this.autoBitrateOpts.startInterval||a;this.initInterval=.8*s,this._prealodMethod=t.preloadmethod||0,this._videoWidth=0,this._videoHeight=0,this._hasDeviceInfoChanged=!0,this.updateMediaInfos(n,!1)}return _createClass$1(e,[{key:"onLoadWasm",value:function(){var e=this,t=this.module={onRuntimeInitialized:function(){e._wasmPromise.resolve()}};return(0,this.autoBitrateOpts.module)(t),this._wasmPromise}},{key:"updateMediaInfos",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._heightToDefitionConfig=new Map,this._bitrateToDefitionConfig=new Map,e?(this.mediaInfos=e,this.mediaInfos.dynamic_video_list.forEach((function(e){t._heightToDefitionConfig.set(e.vheight,e),t._bitrateToDefitionConfig.set(e.bitrate,e)}))):r&&console.error("baseAbr mediaInfos null")}},{key:"parseMPD",value:function(){if(this.setDebugModel(this.openLog),this.mediaInfos){this.logger("mediaInfos",this.mediaInfos);try{for(var e=[],t=this.mediaInfos.dynamic_video_list,r=0;r<t.length;r++){var n=t[r];e.push({stream_id:"s".concat(r),bandwidth:n.bitrate||n.bandwidth,width:n.vwidth||n.width,height:n.vheight||n.height,codec:n.codecs||n.codec_type||"h264",frame_rate:Number(n.fps)||-1,segment_duration:this.segment_duration})}var i={v_adaptation:e},o=JSON.stringify(i);this.module.ccall("parseMPD","null",["string"],[o])}catch(error){}}else console.warn("mediaInfos is null")}},{key:"_getDefautSpeed",value:function(e){var t=0,r=window.navigator.connection;if(r&&r.downlink)t=1024*navigator.connection.downlink/8,this.logger("initSpeed connect",t);else try{t=parseFloat(proxyLocalStorage$1.getItem(SPPED_CACHE))||0,this.logger("initSpeed connect",t)}catch(error){}return 0===t&&(t=e&&e.historyAvspeed||0,this.logger("initSpeed history",t)),t}},{key:"setDebugModel",value:function(e){this.module._setDebugModel(e)}},{key:"updateBitrate",value:function(e){this.bitrate=e}},{key:"_updatePreloadSupplier",value:function(e,t){this.module._updatePreloadSupplier(e,t)}},{key:"updatePreloadSupplier",value:function(e){var t=this._getDefautSpeed();this._updatePreloadSupplier(t,e)}},{key:"getPreloadBitrate",value:function(){var e,t=null,r=[];try{this.logger("preloadMethod",this._prealodMethod),e=this.module._getPreloadBitrate(this._prealodMethod);for(var n=0;n<5;n++)r.push(this.module.HEAP32[e/Int32Array.BYTES_PER_ELEMENT+n]);var i={bitrate:r[0],pduration:r[1],preloadType:r[2],size:r[3],mediaType:r[4]};return this.logger("getPreloadBitrate",i),i}catch(error){t=null,console.log("getPreloadBitrate",error)}finally{this.module._free(e)}return t}},{key:"_updateDeviceInfo",value:function(e){try{if(this._hasDeviceInfoChanged){var t=window.devicePixelRatio||1;this.module._updateDeviceInfo(this._videoWidth||Number(this.config.width),this._videoHeight||Number(this.config.height),t,e||-1)}this._hasDeviceInfoChanged=!1}catch(error){console.log("_updateDeviceInfo")}}},{key:"preload",value:function(e){this.parseMPD(),this.updatePreloadSupplier(e),this._updateDeviceInfo(-1);var t=window.devicePixelRatio||1;return this.logger("baseAbr updateDeviceInfo width",this._videoWidth||Number(this.config.width),"height",this._videoHeight||Number(this.config.height),"dpr",t),this.getPreloadBitrate()}}]),e}();function _createSuper$i(e){var t=_isNativeReflectConstruct$i();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}BaseAbr.SPPED_CACHE=SPPED_CACHE;var ABR_EVENTS={ABR_CHANGE:"ABR_CHANGE_A",ABR_UPDATE_SPEC:"ABR_UPDATE_SPEC",START_ABR:"START_ABR",UPDATE_AUTO_DESC:"UPDATE_AUTO_DESC",ABR_START_PROGRESS:"ABR_START_PROGRESS",MAX_BUFFER_CHANGE:"MAX_BUFFER_CHANGE"},INIT_BIRTATE=0,AUTO_FLAG="__auto__",MIN_WAITIONG$1=200,SEEKING_STATE={SEEK_NO:0,SEEK_FORWARD:1,SEEK_BACKWORD:-1},STALL_STATE={STALL_NO:0,STALL:1},AVG_ARGS={PLAYBACK_BITRATE:"avg_play_bitrate",DOWNLOAD_BITRATE:"avg_download_bitrate",DOWNLOAD_NETWORK_SPEED:"avg_download_speed",PREDICT_NETWORK_SPEED:"avg_predict_speed",BUFFER_LENGTH:"avg_buffer_length",QOE:"avg_qoe"},ABR=function(t){_inherits(n,t);var r=_createSuper$i(n);function n(e,t,i,o,a){var s,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{logger:function(){},openLog:!1};_classCallCheck$1(this,n),(s=r.call(this,t,i,o,a,u)).player=e,s.timerId=0,s.isOpenAutoDefi=!!s.autoBitrateOpts.isOpenAutoDefi,s.onPlayrateChange=s._onPlayrateChange.bind(_assertThisInitialized(s)),s.onPlay=s._onPlay.bind(_assertThisInitialized(s)),s._stop=s.stop.bind(_assertThisInitialized(s)),s._bufferRange=new Map,s._sortedBufferRange=[],s._lastCheckResolutionStamp=0,s._currentDefinition=null,s._isSeeking=!1,s._waitingStartTime=0,s._stallCount=0,s._seekState=SEEKING_STATE.SEEK_NO,s._stallState=STALL_STATE.STALL_NO,s._videoCurrentTime=0,s.listeners=[{evt:"playbackrateChange",handler:s.onPlayrateChange},{evt:"ended",handler:s._stop},{evt:"error",handler:s._stop},{evt:"timeupdate",handler:s._onTimeUpdate.bind(_assertThisInitialized(s))},{evt:"addVideoBufferEnd",handler:s._bufferRangeUpdate.bind(_assertThisInitialized(s))},{evt:"canplay",handler:s._updateAutoDesc.bind(_assertThisInitialized(s))},{evt:"play",handler:s._onplayStart.bind(_assertThisInitialized(s))},{evt:ABR_EVENTS.MAX_BUFFER_CHANGE,handler:s._onMaxBufferChange.bind(_assertThisInitialized(s))},{evt:"seeking",handler:s._onSeeking.bind(_assertThisInitialized(s))},{evt:"seeked",handler:s._onSeekEnd.bind(_assertThisInitialized(s))},{evt:"waiting",handler:s._onWaiting.bind(_assertThisInitialized(s))},{evt:"playing",handler:s._onPlaying.bind(_assertThisInitialized(s))}],s._hasStart=!1,s.listeners.forEach((function(e){var t=e.evt,r=e.handler;s.player.on(t,r)})),s._isPaused=!1,s._hasAddFrament=!1,s._eventInfo={local_time_ms:0,internet_speed:0,buffer_length:0,last_bitrate:0,now_bitrate:0,play_speed:1},s._bitrateSet=[],s._generalInfo={},s._currentInAbr=!1,s._hasCalcTimelineLog=!1,s._abr_play_info={start_play_time_ms:0,is_hint:0,playback_info:{internet_speed_record:[],play_bitrate_record:[],buffer_length_record:[],play_speed_record:[],qoe_record:[],qoe_a_record:[],qoe_b_record:[],qoe_c_record:[]}},s._abrMethod=s.autoBitrateOpts.method||0,s.logger("abr: constructor"),s._loopInterval=s.initInterval,s._tickCount=0,s._fps=30,FpsDetection.install(),s.startTime=performance.now(),s.logger("time abr",(new Date).getTime()),s._maxCacheTimeVideo=s.config.maxBufferLength||s.config.preloadTime||50,s._maxCacheTimeAudio=s._maxCacheTimeVideo,s._prevDefinitionItem=null,s._currentItem=null,s._switchCount=0,s._switchBitrate=0,s._avgStatItems={};for(var c=Object.keys(AVG_ARGS),l=0;l<c.length;l++){var d=c[l],f=AVG_ARGS[d];s._avgStatItems[f]=new AvgStat}return s._qoeArgs=[0,0,0,0],s._abrUsed=-1,s._abrAlwaysOn=1,s._prelaodInfo=null,s._hasLogStartInfo=!1,s._hasExecuteAbrAlgo=!1,s._lastExecuteTimeInMs=0,s}return _createClass$1(n,[{key:"init",value:function(e){return this._mediaList=e,this.isOpenAutoDefi?this.onLoadWasm():this._wasmPromise.resolve(),this._wasmPromise}},{key:"execute",value:function(){return this.listenSize(),this.initFps(),this.onWinElemSizeChange(),this.onPlay()}},{key:"_onSeeking",value:function(){this._isSeeking=!0,this.player.currentTime<this._videoCurrentTime?this._seekState=SEEKING_STATE.SEEK_BACKWORD:this._seekState=SEEKING_STATE.SEEK_FORWARD,this.logger("seekState",this._seekState)}},{key:"_onSeekEnd",value:function(){this._isSeeking=!1}},{key:"_onWaiting",value:function(){var e=this;this._isSeeking||this._waitingStartTime>0||(this._waitingStartTime=(new Date).getTime(),this._stallId=setTimeout((function(){clearTimeout(e._stallId),e._stallCount++,e._stallState=STALL_STATE.STALL}),MIN_WAITIONG$1))}},{key:"_onPlaying",value:function(){this._waitingStartTime=0,this._stallState=STALL_STATE.STALL_NO,clearTimeout(this._stallId)}},{key:"initFps",value:function(){this.fpsDetection=new FpsDetection,this.fpsDetection.start(),this._fps=this.fpsDetection.fps,this._hasDeviceInfoChanged=!0}},{key:"listenSize",value:function(){this.mediaElem=this.player.video,this._onWinSizeChange=debounce$2(this.onWinElemSizeChange.bind(this),1e3,!1),window.addEventListener("resize",this._onWinSizeChange)}},{key:"onWinElemSizeChange",value:function(){if(this.mediaElem){var e=this.mediaElem.getBoundingClientRect();this._videoWidth=Math.floor(e.width),this._videoHeight=Math.floor(e.height),this._hasDeviceInfoChanged=!0}}},{key:"_onMaxBufferChange",value:function(e){var t=e.videoCacheTime,r=e.audioCacheTime;this._maxCacheTimeAudio=r,this._maxCacheTimeVideo=t}},{key:"_onTimeUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._sortedBufferRange&&0!==this._sortedBufferRange.length&&this._currentInAbr){this._videoCurrentTime=this.player.currentTime;var r=Date.now();if(!(r-this._lastCheckResolutionStamp<1e3&&0!==this._lastCheckResolutionStamp)||t){this._lastCheckResolutionStamp=r;for(var n=this.player.currentTime,i=0,o=this._sortedBufferRange.length-1,a=null;i<=o;){var s=Math.floor(i+(o-i)/2),u=this._sortedBufferRange[s];if(n<u.start)o=s-1;else{if(!(n>=u.end)){a=u;break}i=s+1}}if(a){var c=this._bitrateToDefitionConfig.get(a.bandwidth),l=c&&c.definition;if(this._currentDefinition===l&&!t||!l)return void(l||this.logger("error defintion, mpd配置与接口配置不一致"));this._currentDefinition=l,this._prevDefinitionItem=this._currentItem,this._currentFps=c.fps,this._currentItem=c,this._emitAutoDescChange(l,!1,this._currentFps,c)}}}}},{key:"_emitAutoDescChange",value:function(e,t,r,n){console.log("[ABR],emitAutoDescChange, definition, ",e,",item,",n,",pre_item,",this._prevDefinitionItem),this.player.emit(ABR_EVENTS.UPDATE_AUTO_DESC,{definition:e,reset:t,fps:r,item:n,pre_item:this._prevDefinitionItem})}},{key:"_onplayStart",value:function(){this._hasStart=!0,this.logger("onplaystart")}},{key:"_updateAutoDesc",value:function(){var e=this;this._currentInAbr&&this._currentDefinition&&(this._updateId=setTimeout((function(){clearTimeout(e._updateId),e._emitAutoDescChange(e._currentDefinition,!1,e._currentFps,e._currentItem)}),0))}},{key:"_bufferRangeUpdate",value:function(e){if(void 0!==e.start){null===this._currentItem&&this._onTimeUpdate(null,!0);var t=e.start;this._hasAddFrament=!0,this._bufferRange.set(t,e);var r=_toConsumableArray(this._bufferRange.values());this._sortedBufferRange=r.sort((function(e,t){return e.start-t.start})),this.avgStat(AVG_ARGS.DOWNLOAD_BITRATE,e.bandwidth)}}},{key:"_onPlayrateChange",value:function(){this.module&&this.updateBufferInfo()}},{key:"_onPlay",value:function(){var e=this;if(!this.isOpenAutoDefi)return this.logger("onPlay"),INIT_BIRTATE;var t=INIT_BIRTATE;try{this.logger("abr: loadeddata"),this.updateSwitchInfo(),this.parseMPD(),this.updateDeviceInfo();var r=n.getIsPlayAutoDefi(this.autoBitrateOpts);if(this.isOpenAutoDefi&&r){this._abrUsed=1;var i=this._getDefautSpeed(this.player);t=this._loopAbr(i),this.start(),this.logger("time abr start prgress",(new Date).getTime()),this.logger("time abr costTime",performance.now()-this.startTime),this.logger("abr onplay"),this.startTimer=setTimeout((function(){e._loopInterval=e.interval,clearTimeout(e.startTimer),e.logger("interval change")}),5e3)}}catch(error){this.logger("abr: loadeddata error",error),this.logger("time abr costTime err",performance.now()-this.startTime)}return t}},{key:"start",value:function(){if(this.logger("abr: start"),this._isPaused=!1,!this._hasCalcTimelineLog){var e=1===Math.floor(100*Math.random());this._abr_play_info.is_hint=e?1:0}this._hasCalcTimelineLog=!0,this._loop()}},{key:"_loop",value:function(){var e=this;this._isPaused||(clearTimeout(this.timerId),this.timerId=setTimeout((function(){if(!e.player.paused||!e.player.config.autoplay&&!e._hasStart){var t=e._hasAddFrament?void 0:e._getDefautSpeed(e.player);e._loopAbr(t)}e._loop()}),this._loopInterval))}},{key:"updateDeviceInfo",value:function(){try{if(this.fpsDetection){var e=this.fpsDetection.fps;e!==this._fps&&(this._fps=e,this._hasDeviceInfoChanged=!0)}this._updateDeviceInfo(this._fps)}catch(error){}}},{key:"updateBufferInfo",value:function(e){var t=this.player.playbackRate,r=this.bufferLength,n=e||Math.floor(this.player.downloadSpeed);return this._tickCount<5&&0===n&&(n=this._getDefautSpeed(this.player),this.logger("initSpeed fix")),this.logger("maxCacheTimeAudio:",this._maxCacheTimeAudio,"maxCacheVideoTime",this._maxCacheTimeVideo,"seekState",this._seekState,"stallState",this._stallState),this.module._updateBufferInfo(t,this._maxCacheTimeAudio,this._maxCacheTimeVideo,r,r,n,this._seekState,this.player.currentTime,this._stallState),this._seekState=SEEKING_STATE.SEEK_NO,this._eventInfo={internet_speed:n,buffer_length:r,last_bitrate:this.bitrate,play_speed:t},this.logger("playRate:",t,"buff:",r,"downloadSpeed:",n),{buffer:r,downloadSpeed:n}}},{key:"updateSwitchInfo",value:function(){var e=(new Date).getTime();this._openTimeMs=e,this._abr_play_info.start_play_time_ms=e;var t=this.player.config.preloadTime||50,r=convert32ToC64(e),n=this.autoBitrateOpts.noStallCheckTime||5,i=this.openLog;this.logger("openTime:",e,"this.logger",i),this.module._updateSwitchInfo(r.low,r.high,n,i,this.stall_penalty,this.switch_penalty);var o=this._mediaList.video,a=o.map((function(e){var t=e.bandwidth,r=e.bitrate;return t||r}));this._bitrateSet=a.map((function(e,t){return{bitrate:e,codecs:o[t].codecs||o[t].codec_type}})),this._generalInfo={max_cache_time:t,bitrate_set:this._bitrateSet,segment_duration:this.segment_duration,preload_info:{},startup_info:{}}}},{key:"updatePreloadCacheInfo",value:function(t){try{this._prelaodInfo=t,this.logger("update preloadInfo",t),t&&t.item_num!==t.items.length&&(this.logger("preloadInfo invalid"),this._prelaodInfo=null)}catch(e){this.logger("updatePreloadCacheInfo",e),this._prelaodInfo=null}}},{key:"updatePreloadLogInfo",value:function(e){this._generalInfo.preload_info=e||{}}},{key:"_updatePreloadInfo",value:function(){try{var t=this.player.getPreloadInfos();if(t){var r=t.preloadInfo,n=t.abr;this.updatePreloadLogInfo(r),n&&this.updatePreloadCacheInfo(r)}if(this.logger("_updatePreloadInfo preloadinfos",t),null!=this._prelaodInfo){var i=JSON.stringify(this._prelaodInfo);this.module.ccall("updatePreloadInfo","null",["string"],[i])}else this.logger("_updatePreloadInfo preloadinfo null, no preload")}catch(e){this.logger("_updatePreloadInfo err",e)}}},{key:"_loopAbr",value:function(e){var t;this._tickCount++;var r=[];try{this.updateDeviceInfo();var n=this.updateBufferInfo(e),i=n.downloadSpeed,o=n.buffer;t=this.module._getPredictedBitrate(this.bitrate,this._abrMethod);for(var a=0;a<7;a++)r.push(this.module.HEAP32[t/Int32Array.BYTES_PER_ELEMENT+a]);var s=r[0],u=1===r[1];this._eventInfo.now_bitrate=s,this._eventInfo.local_time_ms=(new Date).getTime();var c=0;if(s!==this.bitrate&&0!==s){var l=this.bitrate;c=Math.abs(l-s);for(var d=[],f=this.player.video.buffered,h=0;h<f.length;h++)d.push({start:f.start(h),end:f.end(h)});var p=this._videoWidth||Number(this.config.width),g=this._videoHeight||Number(this.config.height),y=(new Date).getTime(),v={speed:"".concat(i," KB/s"),buffer_length:"".concat(o," s"),video_pos:this.player.currentTime,all_buffers:d,seek_state:this._seekState,stall_state:this._stallState,screen_width:p,screen_height:g,dpr:window&&window.devicePixelRatio,playbackRate:this.player.playbackRate,bitrateSet:this._bitrateSet,abrMethod:this._abrMethod,delta:this._hasExecuteAbrAlgo?y-this._lastExecuteTimeInMs:0};this._lastExecuteTimeInMs=y,this._hasExecuteAbrAlgo=!0,this.player.emit(ABR_EVENTS.ABR_CHANGE,this.bitrate,s,u,JSON.stringify(v)),this.logger("abr loop predicte:",s,"willStall:",u,"switchBitrate",c,"cur",l),this.bitrate=s}this._hasLogStartInfo||(this._hasLogStartInfo=!0,this._generalInfo.startup_info={predict_bitrate:s,download_speed:i,screen_width:this._videoWidth||Number(this.config.width),screen_height:this._videoHeight||Number(this.config.height),device_pixel_ratio:window&&window.devicePixelRatio,screen_fps:this._fps,startup_method:this._abrMethod}),this.player.emit("ABR_LOOP"),this.onAbrLoop(i,r[2],c,r.slice(3))}catch(error){this.logger("abr error",error),console.log("error",error)}finally{this.module._free(t)}return this.bitrate}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===e&&(this._abrAlwaysOn=-1),clearTimeout(this.timerId),this._isPaused=!0,this.logger("abr: stop")}},{key:"destroy",value:function(){var e=this;this._stop(),this.listeners.forEach((function(t){var r=t.evt,n=t.handler;e.player.off(r,n)})),this.player=null,this._heightToDefitionConfig=null,this._bitrateToDefitionConfig=null,this._bufferRange=null,this._sortedBufferRange=null,this.module=null,clearTimeout(this._stallId),clearTimeout(this._updateId),clearTimeout(this.startTimer),window.removeEventListener("resize",this._onWinSizeChange),this.fpsDetection&&this.fpsDetection.stop(),this.player=null}},{key:"eventInfo",get:function(){return this._eventInfo}},{key:"generalInfo",get:function(){return this._generalInfo}},{key:"bufferLength",get:function(){var e=this.player.getBufferedRange(),t=this.player.video.currentTime,r=e[1]-Math.max(e[0],t);return r=Math.max(0,r).toFixed(2),parseFloat(r)}},{key:"downloadSpeed",get:function(){return Math.floor(this.player.downloadSpeed)}},{key:"nowBitrate",get:function(){return this.bitrate}},{key:"openTimeMs",get:function(){return this._openTimeMs}},{key:"isCurrentInAbr",get:function(){return this._currentInAbr},set:function(e){this._currentInAbr=e}},{key:"onAbrLoop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(this._qoeArgs=n,this._currentItem&&this.avgStat(AVG_ARGS.PLAYBACK_BITRATE,this._currentItem.bitrate),this.avgStat(AVG_ARGS.DOWNLOAD_NETWORK_SPEED,1e3*e*8),this.avgStat(AVG_ARGS.PREDICT_NETWORK_SPEED,t),this.avgStat(AVG_ARGS.BUFFER_LENGTH,this.bufferLength),this.avgStat(AVG_ARGS.QOE,this.getQoeRelValue(0)),r>0&&(this._switchCount++,this._switchBitrate+=r),this._abr_play_info.is_hint){var i=this,o=((new Date).getTime()-this.openTimeMs)/1e3;o=parseFloat(o.toFixed(2)),this._abr_play_info.playback_info.internet_speed_record.push([o,i.downloadSpeed]),this._abr_play_info.playback_info.play_bitrate_record.push([o,i.nowBitrate]),this._abr_play_info.playback_info.buffer_length_record.push([o,i.bufferLength]),this._abr_play_info.playback_info.play_speed_record.push([o,this.player.playbackRate]),this._abr_play_info.playback_info.qoe_record.push([o,this.getQoeRelValue(0)]),this._abr_play_info.playback_info.qoe_a_record.push([o,this.getQoeRelValue(1)]),this._abr_play_info.playback_info.qoe_b_record.push([o,this.getQoeRelValue(2)]),this._abr_play_info.playback_info.qoe_c_record.push([o,this.getQoeRelValue(3)])}}},{key:"getQoeRelValue",value:function(e){return this._qoeArgs[e]/100}},{key:"avgStat",value:function(e,t){var r=this._avgStatItems[e];r&&r.add(t)}},{key:"getAbrPlayInfo",value:function(){return this._abr_play_info}},{key:"updateAbrMethod",value:function(e){this._abrMethod=e}},{key:"getAbrMethod",value:function(){return this._abrMethod}},{key:"getAbrVVStats",value:function(){for(var e={},t=Object.keys(AVG_ARGS),r=0;r<t.length;r++){var n=t[r],i=AVG_ARGS[n],o=this._avgStatItems[i];e[i]=o.avg()}return e.switch_counts=this._switchCount,e.avg_switch_bitrate=0===this._switchCount?0:this._switchBitrate/this._switchCount,e.abr_qoe=this.getQoeRelValue(0),e.abr_qoe_a=this.getQoeRelValue(1),e.abr_qoe_b=this.getQoeRelValue(2),e.abr_qoe_c=this.getQoeRelValue(3),e.abr_method=this._abrMethod,e.abr_used=this._abrUsed,e.abr_always_on=this._abrAlwaysOn,this.logger("abrVVStats",e),e}}],[{key:"getIsPlayAutoDefi",value:function(e){return!!e.isPlayAutoDefi}}]),n}(BaseAbr),AvgStat=function(){function e(){_classCallCheck$1(this,e),this.total=0,this.count=0}return _createClass$1(e,[{key:"add",value:function(e){this.total+=e,this.count++}},{key:"avg",value:function(){if(0===this.count)return 0;var e=this.total/this.count;return Math.floor(e)}}]),e}();function _createSuper$h(e){var t=_isNativeReflectConstruct$h();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var MEDIA_TYPES$1=MEDIA_TYPES$2,PrelaodAbr=function(e){_inherits(r,e);var t=_createSuper$h(r);function r(e,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{logger:function(){},openLog:!1};return _classCallCheck$1(this,r),t.call(this,e,n,i,o,a)}return _createClass$1(r,[{key:"init",value:function(){return this.onLoadWasm()}},{key:"preloadPredict",value:function(){return this.preload(MEDIA_TYPES$1.VIDEO)}}]),r}(BaseAbr);function _createSuper$g(e){var t=_isNativeReflectConstruct$g();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var MixedPredict=function(e){_inherits(r,e);var t=_createSuper$g(r);function r(e){var n;return _classCallCheck$1(this,r),(n=t.call(this)).loggerConfig=e,n._isWasmSupport=checkWebAssemblySupport(),n}return _createClass$1(r,[{key:"init",value:function(e){var t=e.autoBitrateOpts||{},r=t.module,n=t.isOpenAutoDefi;return n&&!r&&console.warn("if open abr, need [module]"),this._isWasmSupport&&r&&n?(this._abrPreloadInst=new PrelaodAbr(e,0,null,5,this.loggerConfig),this._abrPreloadInst.init()):Promise.resolve()}},{key:"preloadPredict",value:function(e){var t=this._mediaInfos,r=0,n=0;if(this._isWasmSupport&&(e.useAbr||void 0===e.useAbr)){this._abrPreloadInst.updateMediaInfos(this._mediaInfos);var i=this._abrPreloadPredict();r=i.videoIdx,n=i.time}else r=this.getIdx(t.dynamic_video_list,e.defaultDefinition),this._cachedData=null;var o=t.dynamic_video_list[r]||t.dynamic_video_list[0];return{bandwidth:o.bitrate||o.bandwidth,executeTime:n}}},{key:"_abrPreloadPredict",value:function(){var e=this._abrPreloadInst.preloadPredict();this._cachedData=e;var t=e.bitrate,r=0,n=this.bandwidth2item[t];if(n){var i=n.definition;r=this.getIdx(this._mediaInfos.dynamic_video_list,i)}return{videoIdx:r,time:e.pduration}}},{key:"cachedData",get:function(){return this._cachedData}}]),r}(PredictBase);function _createSuper$f(e){var t=_isNativeReflectConstruct$f();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var DashPreloader=function(t){_inherits(n,t);var r=_createSuper$f(n);function n(e,t,i){var o;return _classCallCheck$1(this,n),(o=r.call(this,t)).player=e,o.logger=i||function(){},o}return _createClass$1(n,[{key:"before",value:function(){var t=this;this.handlers={start:function(e){return t.start(e)},onRequest:function(e,r){var n=e.url,i=e.range,o=e.extData;return t.getData(n,i,o,r)}},this.loggerConfig={logger:function(){},openLog:!1};try{!!localStorage.getItem("abrdebug")&&(this.loggerConfig.logger=console.log,this.loggerConfig.openLog=!0)}catch(e){}this.predictInst=new MixedPredict(this.loggerConfig)}},{key:"start",value:function(e){var t=this,r=new ProxyPromise,n={dynamic_video:e.payload},i=new MPD$1("anytext",n,this),o={mediaInfos:{dynamic_video_list:[],dynamic_audio_list:[]},onObtain:function(e){var t=new ProxyPromise;return t.resolve(o.mediaInfos),t},onTransform:function(r){var n=new ProxyPromise,o=r.bandwidth,a=i.mediaList.video||[],s=i.mediaList.audio||[],u=e.vid;if("segment_template"===i.dashType)t._calRequests(i,r,n,e,!0);else{var c=[];if(s&&s.length>0){var l=t.makeInitBaseSegemntRequest(i,e.duration,"audio",0,void 0,u);c.push(l)}if(a&&a.length>0){var d=t._calVideoItemIdx(a,o)||0,f=a[d].definition,h=t.makeInitBaseSegemntRequest(i,e.duration,"video",d,f,u);c.push(h)}Promise.all(c).then((function(){t._calRequests(i,r,n,e)})).catch((function(){console.warn&&console.warn("catch no reqeuset"),n.resolve([])}))}return n}};return i.once("ready",(function(){o.type=i.type,o.mediaInfos.dynamic_video_list=i.mediaList.video||[],o.mediaInfos.dynamic_audio_list=i.mediaList.audio||[],r.resolve(o)})),r}},{key:"_calRequests",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[],a=t.bandwidth,s=t.time,u=t.executeTime,c=e.mediaList.video||[],l=e.mediaList.audio||[],d=n.vid;if(l&&l.length>0){var f=this._calUrls(l[0],s,u,"audio",d,null,i);o=o.concat(f)}if(c&&c.length>0){var h=this._calVideoItemIdx(c,a)||0,p=c[h],g=this._calUrls(p,s,u,"video",d,p.definition,i);o=o.concat(g)}0===o.length&&console.warn&&console.warn("no reqeusts from preloader"),r.resolve(o)}},{key:"_calUrls",value:function(e,t,r,n,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=[];if(e){var u=e;a&&s.push({url:u.initSegment,range:u.initSegmentRange||[],extData:{cacheKey:util$1.generateUniqueKey({vid:i,mediaType:n,codecType:u.codec_type,format:"dash"}),vid:i,format:"dash",isInitSegment:!0,mediaType:n,useUrlRange:util$1.validateUrlRange(this.options.url_range_domains,u.initSegment)}});var c=e.mediaSegments,l=this._calStartEnd(c,t,r),d=c[l];s.push({url:d.url,range:d.range||[],extData:{cacheKey:util$1.generateUniqueKey({vid:i,mediaType:n,codecType:u.codec_type,format:"dash",start:d.start,end:d.end,definition:o}),vid:i,format:"dash",isInitSegment:!1,mediaType:n,useUrlRange:util$1.validateUrlRange(this.options.url_range_domains,d.url)}})}return s}},{key:"_calStartEnd",value:function(e,t,r){for(var n=-1,i=0;i<e.length;i++){var o=e[i],a=t||0;if(o.start>=a&&a<o.end){n=i;break}}return-1===n&&(n=0),n}},{key:"_calVideoItemIdx",value:function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n&&n.bandwidth===t)return r}return null}},{key:"getData",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,o=this;return o.currentTask=null,new Promise((function(a,s){var u=new Task$1(e,r,(function(e,t){o.currentTask=null,a({res:e,headers:t})}),n.isInitSegment?-1:t.options.timeout,n,!0,t.preloadManager);u.once(CANCEL,(function(e){o.currentTask=null,s(e)}));u.once(PRELOAD_CACHED,(function(e){o.emitPreloadCached(e)})),u.on(TASK_PREOGRESS,(function(e){i&&i(e)}))}))}},{key:"makeInitBaseSegemntRequest",value:function(e,t,r,n,i,o){var a=this,s=new ProxyPromise,u=e.mediaList[r][n],c=[u.initSegmentRange[0],u.sidxRange[1]],l=u.initSegment,d={mediaType:r,vid:o,definition:i,useUrlRange:util$1.validateUrlRange(this.options.url_range_domains,l),timeout:-1,isInitSegment:!0};return this.getData(l,c,d,(function(e){var t=Object.assign({},e,{vid:o,mediaType:r,isInitSegment:!0,format:"dash"});a._preloadManager.onCacheSegment(t)}),-1).then((function(i){var o=i.res;o?a.handleInitData(o,c,u.sidxRange).then((function(i){i.sidxSegmentRes&&e.getSidx(i.sidxSegmentRes,r,n,t),util$1.validateFragment(i.initSegmentRes,c)?s.resolve(i.initSegmentRes):(s.reject({mediaType:r,index:n,initSegmentRange:c,url:l,rejected:!0}),a.logger("initSegmentRequest 分片校验失败"))})).catch((function(e){s.reject({mediaType:r,index:n,initSegmentRange:c,url:l,rejected:!0}),a.logger("initSegmentRequest error",e)})):s.reject({mediaType:r,index:n,initSegmentRange:c,url:l,rejected:!0})})).catch((function(e){s.reject({mediaType:r,index:n,initSegmentRange:c,url:l,rejected:!0}),a.logger("initSegmentRequest error",e)})),s}},{key:"handleInitData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=new ProxyPromise,i=e instanceof ArrayBuffer;if(i){var o=0===t.length?e:e.slice(t[0],t[1]+1),a=null===r?null:e.slice(r[0],r[1]+1);n.resolve({initSegmentRes:o,sidxSegmentRes:a})}else;return n}},{key:"emitPreloadCached",value:function(e){this.logger("cachedLog",e),this.player&&this.player.emit("log",{type:"onetemp",action:"append",data:{preload_cached:e+"|"}})}}]),n}(PreloaderBase);DashPreloader.encryptUtils=isSupport$1;var $$H=_export$1,$some$1=arrayIteration$1.some,arrayMethodIsStrict$5=arrayMethodIsStrict$d,STRICT_METHOD$4=arrayMethodIsStrict$5("some");$$H({target:"Array",proto:!0,forced:!STRICT_METHOD$4},{some:function(e){return $some$1(this,e,arguments.length>1?arguments[1]:void 0)}});var $$G=_export$1,DESCRIPTORS$j=descriptors$1,defineProperties$1=objectDefineProperties$1.f;$$G({target:"Object",stat:!0,forced:Object.defineProperties!==defineProperties$1,sham:!DESCRIPTORS$j},{defineProperties:defineProperties$1});var $$F=_export$1,DESCRIPTORS$i=descriptors$1,defineProperty$9=objectDefineProperty$1.f;$$F({target:"Object",stat:!0,forced:Object.defineProperty!==defineProperty$9,sham:!DESCRIPTORS$i},{defineProperty:defineProperty$9});var CONTENT_TYPES={VIDEO:"video",AUDIO:"audio"},ERROR_TYPES$1={MSE_OP_FAIL:"MS_OP_FAIL",MSE_DESTROY:"MSE_DESTROY",QuotaExceededError:"QuotaExceededError"},MSE=function(){function t(e,r){_classCallCheck$1(this,t),this.mediaSource=new window.MediaSource(e),this.url=window.URL.createObjectURL(this.mediaSource),this.queue=[],this._hasDestroyed=!1,this._sourceOpenPromise=new ProxyPromise,this._onSourceOpen=this._onSourceOpen.bind(this),this._onSourceBufferError=this._onSourceBufferError.bind(this),this._onSourceBufferUpdateEnd=this._onSourceBufferUpdateEnd.bind(this),this.mediaSource.addEventListener("sourceopen",this._onSourceOpen),this.opQueues={},this.sourceBuffers={},this.updateHanders={},this.errorHandlers={},this.logger=r||function(){},this._sourceOpenDonePromise=new ProxyPromise}return _createClass$1(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_defineProperty$1({},CONTENT_TYPES.VIDEO,{mimeType:"video/mp4",codec:'video/mp4; codecs="avc1.64001E, mp4a.40.5"'});this.contentTypes=t;var r=Object.keys(this.contentTypes);return this._sourceOpenPromise.then((function(){for(var t=0;t<r.length;t++)try{!function(){var n=r[t],i=e.contentTypes[n].codec,o=e.mediaSource.addSourceBuffer(i),a=function(){return e._onSourceBufferError(n)};o.addEventListener("error",a);var s=function(){return e._onSourceBufferUpdateEnd(n)};o.addEventListener("updateend",s),e.updateHanders={},e.sourceBuffers[n]=o,e.opQueues[n]=[],e.updateHanders[n]=s,e.errorHandlers[n]=a}()}catch(error){e._sourceOpenDonePromise.reject(error)}e.logger("[debug mse] mse init ready, readyState",e.mediaSource.readyState),e._sourceOpenDonePromise.resolve()})),this._sourceOpenDonePromise}},{key:"sourceOpenPromise",value:function(){return this._sourceOpenPromise}},{key:"_onSourceOpen",value:function(){this.mediaSource.removeEventListener("sourceopen",this._onSourceOpen),this._sourceOpenPromise.resolve()}},{key:"_onSourceBufferError",value:function(e){this._hasDestroyed||(this.logger("[debug mse] sourceBuffer error, contentType",e,"readyState",this.mediaSource.readyState),this.opQueues[e][0].p.reject(new Error(ERROR_TYPES$1.MSE_OP_FAIL)))}},{key:"_onSourceBufferUpdateEnd",value:function(e){if(!this._hasDestroyed){var t=this.opQueues[e][0];t&&(t.p.resolve(),this.pop(e))}}},{key:"state",get:function(){return this.mediaSource.readyState}},{key:"duration",get:function(){return this.mediaSource.duration}},{key:"setDuration",value:function(e){var t=this;return this.mediaSource.duration>e?Promise.resolve():this.enqueueBlockOp((function(){t.ended()?t.logger("[debug mse] setDuration ended"):(t.logger("[debug mse] setDuration"),t.mediaSource.duration=e)}),"setDuration")}},{key:"appendBuffer",value:function(e,t){var r=this;return this.enqueueOp(e,(function(){return r._append(e,t)}),"appendBuffer")}},{key:"_append",value:function(e,t){this.logger("[real append], len = ",t.byteLength),this.sourceBuffers[e].appendBuffer(t)}},{key:"enqueueOp",value:function(e,t,r){var n=this;if(this._hasDestroyed)return Promise.reject(new Error(ERROR_TYPES$1.MSE_DESTROY)).catch((function(){}));var i={handler:t,p:new ProxyPromise,name:r};return this._sourceOpenDonePromise.then((function(){if(n._hasDestroyed)return i.p.reject(new Error(ERROR_TYPES$1.MSE_DESTROY)).catch((function(){}));n.opQueues[e]||(n.opQueues[e]=[]),n.opQueues[e].push(i),1===n.opQueues[e].length&&n.handleOp(e)})),i.p}},{key:"enqueueBlockOp",value:function(t,r){var n=this;if(this._hasDestroyed)return Promise.reject(new Error(ERROR_TYPES$1.MSE_DESTROY));var i=new ProxyPromise;return this._sourceOpenDonePromise.then((function(){if(n._hasDestroyed)return i.reject(new Error(ERROR_TYPES$1.MSE_DESTROY));for(var o=[],a=Object.keys(n.contentTypes),s=function(e){var t=a[e],i=new ProxyPromise,s={handler:function(){return i.resolve()},p:i,name:r};n.opQueues[t]||(n.opQueues[t]=[]),n.opQueues[t].push(s),o.push(i),1===n.opQueues[t].length&&s.handler()},u=0;u<a.length;u++)s(u);Promise.all(o).then((function(){try{t()}catch(e){console.log(e)}finally{for(var r=0;r<a.length;r++){var o=a[r];n.pop(o)}i.resolve()}})).catch((function(e){console.log("waiting cath",e)}))})),i}},{key:"handleOp",value:function(e){if(!this._hasDestroyed){var t=this.opQueues[e][0];if(t)try{t.handler()}catch(error){t.p.reject(new Error(error.name)),this.pop(e)}}}},{key:"pop",value:function(e){this._hasDestroyed||(this.opQueues[e].shift(),this.handleOp(e))}},{key:"clearEnqueAndRemoveBuffer",value:function(e,t,r){r<=t?this._onSourceBufferUpdateEnd(e):(this.opQueues[e]=this.opQueues[e].slice(0,1),this.removeBuffer(e,t,r))}},{key:"removeBuffer",value:function(e,t,r){var n=this;return this.enqueueOp(e,(function(){return n._remove(e,t,r)}),"removeBuffer")}},{key:"_remove",value:function(e,t,r){r<=t?this._onSourceBufferUpdateEnd(e):this.sourceBuffers[e].remove(t,r)}},{key:"endOfStream",value:function(){var e=this;return this.enqueueBlockOp((function(){e.ended()||e._hasDestroyed||e.mediaSource.endOfStream()}),"endOfStream")}},{key:"ended",value:function(){return!this.mediaSource||"ended"===this.mediaSource.readyState}},{key:"isMediaSourceOpen",value:function(){return!!this.mediaSource&&"open"===this.mediaSource.readyState}},{key:"abort",value:function(e){var t=this;return this.isMediaSourceOpen()?this.enqueueOp(e,(function(){t.sourceBuffers[e].abort(),t._onSourceBufferUpdateEnd(e)}),"abort"):Promise.resolve()}},{key:"reuse",value:function(e,t){for(var r=Object.keys(this.contentTypes),n=0;n<r.length;n++){var i=r[n];this.removeBuffer(i,e,t)}}},{key:"_forceAbort",value:function(){try{for(var e=Object.keys(this.contentTypes),t=0;t<e.length;t++){var r=e[t];this.sourceBuffers[r].abort()}}catch(error){console.log("forceAbort error")}}},{key:"destroy",value:function(){if(this.logger("[debug mse] destroy execute"),!this._hasDestroyed){this._forceAbort(),this._hasDestroyed=!0,window.URL.revokeObjectURL(this.url),this.mediaSource&&(this.mediaSource.removeEventListener("sourceclose",this._onMediaSourceClose),this.mediaSource.removeEventListener("sourceopen",this._onSourceOpen));for(var e=Object.keys(this.contentTypes),t=0;t<e.length;t++){var r=e[t],n=this.sourceBuffers[r];if(n){var i=this.errorHandlers[r];n.removeEventListener("error",i);var o=this.updateHanders[r];n.removeEventListener("updateend",o)}}this.opQueues={},this.sourceBuffers={}}}},{key:"buffered",value:function(e){return this.sourceBuffers[e]&&this.sourceBuffers[e].buffered}},{key:"sourceBuffer",value:function(e){return this.sourceBuffers[e]}},{key:"removeSourceBuffer",value:function(e){var t=this.sourceBuffer(e);if(t){this.mediaSource.removeSourceBuffer(t);var r=this.errorHandlers[e];t.removeEventListener("error",r);var n=this.updateHanders[e];t.removeEventListener("updateend",n),delete this.errorHandlers[e],delete this.sourceBuffers[e],delete this.updateHanders[e]}}},{key:"setTimeoffset",value:function(e,t){var r=this;return this.enqueueOp(e,(function(){t<0&&(t+=.001),r.sourceBuffers[e].timestampOffset=t,r._onSourceBufferUpdateEnd(e)}),"setTimeoffset")}}],[{key:"isSupported",value:function(e){return window.MediaSource&&window.MediaSource.isTypeSupported(e)}}]),t}(),MSE$1=MSE,createTypedArrayConstructor$5=typedArrayConstructor.exports;createTypedArrayConstructor$5("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var EME=function(){function e(t){_classCallCheck$1(this,e),this.drm=t,this.KEYSYSTEM_TYPE="",this.keys={},this.drm.clearKeys?(this.KEYSYSTEM_TYPE="org.w3.clearkey",this.keys=this.drm.clearKeys):this.drm.widevine?(this.KEYSYSTEM_TYPE="com.widevine.alpha",this.keys=this.drm.widevine):this.drm.playready&&(this.KEYSYSTEM_TYPE="com.microsoft.playready",this.keys=this.drm.playready),this.options=[],this.ensurePromise=void 0,this.licenseStep=0,EventEmitter(this)}return _createClass$1(e,[{key:"bail",value:function(e){}},{key:"getLicenseRequestFromMessage",value:function(e){if("com.microsoft.playready"===this.KEYSYSTEM_TYPE){var t=null,r=new DOMParser,n=new Uint16Array(e),i=String.fromCharCode.apply(null,n),o=r.parseFromString(i,"application/xml");if(!o.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var a=o.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return a&&(t=window.atob(a)),t}return new Uint8Array(e)}},{key:"parseServerResponse",value:function(e){var t="http://schemas.xmlsoap.org/soap/envelope/";if(window.DOMParser){var r=this.uintToString(e),n=(new window.DOMParser).parseFromString(r,"text/xml"),i=n?n.getElementsByTagNameNS(t,"Envelope")[0]:null,o=i?i.getElementsByTagNameNS(t,"Body")[0]:null;if(o?o.getElementsByTagNameNS(t,"Fault")[0]:null)return null}return e}},{key:"uintToString",value:function(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}},{key:"licenseRequestReady",value:function(e){var t=this,r=new XMLHttpRequest;r.open("GET",this.keys.serverURL),r.onreadystatechange=function(){if(4===r.readyState){var n=e.message,i=r.response;"com.microsoft.playready"===t.KEYSYSTEM_TYPE&&(i=JSON.parse(r.response),i="".concat(i.licenseAcquisitionUrl,"?ExpressPlayToken=").concat(i.token));var o=new XMLHttpRequest;o.keySession=e.target,o.responseType="arraybuffer",o.withCredentials=!1,o.open("POST",String(i)),"com.microsoft.playready"===t.KEYSYSTEM_TYPE&&o.setRequestHeader("Content-type","text/xml"),o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)return void t.emit(CDM_LICENSE_ERROR,{data:t.licenseStep});var e;t.emit(CDM_LICENSE_SUCCESS,{data:t.licenseStep}),t.licenseStep++,e="com.microsoft.playready"===t.KEYSYSTEM_TYPE?t.parseServerResponse(o.response):new Uint8Array(o.response),o.keySession.update(e).catch(console.error.bind(console,"update() failed"))}},o.send(t.getLicenseRequestFromMessage(n))}},r.send()}},{key:"UpdateSessionFunc",value:function(e){var t=this;return function(r){var n=[],i=[];Object.keys(e).forEach((function(t){var r=e[t],o=util$1.fromHex(t),a=util$1.fromHex(r),s={kty:"oct",kid:util$1.toBase64(o,!1),k:util$1.toBase64(a,!1)};n.push(s),i.push(s.kid)}));var o={keys:n},a=JSON.stringify(o);r.target.update(util$1.StringToArrayBuffer(a)).then((function(){}),t.bail(" MediaKeySession update failed"))}}},{key:"KeysChange",value:function(e){}},{key:"EnsureMediaKeysCreated",value:function(e,t){return this.ensurePromise||(this.ensurePromise=navigator.requestMediaKeySystemAccess(t,[{initDataTypes:["keyids","webm"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42c01e"'}]}]).then((function(e){return e.createMediaKeys()}),this.bail(" Failed to request key system access.")).then((function(t){return e.setMediaKeys(t)}),this.bail(" failed to create MediaKeys object"))),this.ensurePromise}},{key:"SetupEME",value:function(e,t){var r=this,n=this;e.sessions=[];util$1.on(this,"encrypted",(function(t){var i,o,a;"org.w3.clearkey"===r.KEYSYSTEM_TYPE?(i="keyids",o=JSON.stringify({kids:["0123456789abcdef0123456789abcdef"]}),a=new Uint8Array(util$1.toUTF8(o))):"com.widevine.alpha"===r.KEYSYSTEM_TYPE?(i="cenc",a=t&&new Uint8Array(t.initData)||new Uint8Array([0,0,0,67,112,115,115,104,0,0,0,0,237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237,0,0,0,35,8,1,18,16,51,51,51,51,51,51,51,51,51,51,51,51,0,0,0,0,26,10,105,110,116,101,114,116,114,117,115,116,34,1,42])):"com.microsoft.playready"===r.KEYSYSTEM_TYPE&&(i="cenc",a=t&&new Uint8Array(t.initData)||new Uint8Array([0,0,2,38,112,115,115,104,0,0,0,0,154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149,0,0,2,6,6,2,0,0,1,0,1,0,252,1,60,0,87,0,82,0,77,0,72,0,69,0,65,0,68,0,69,0,82,0,32,0,120,0,109,0,108,0,110,0,115,0,61,0,34,0,104,0,116,0,116,0,112,0,58,0,47,0,47,0,115,0,99,0,104,0,101,0,109,0,97,0,115,0,46,0,109,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,99,0,111,0,109,0,47,0,68,0,82,0,77,0,47,0,50,0,48,0,48,0,55,0,47,0,48,0,51,0,47,0,80,0,108,0,97,0,121,0,82,0,101,0,97,0,100,0,121,0,72,0,101,0,97,0,100,0,101,0,114,0,34,0,32,0,118,0,101,0,114,0,115,0,105,0,111,0,110,0,61,0,34,0,52,0,46,0,48,0,46,0,48,0,46,0,48,0,34,0,62,0,60,0,68,0,65,0,84,0,65,0,62,0,60,0,80,0,82,0,79,0,84,0,69,0,67,0,84,0,73,0,78,0,70,0,79,0,62,0,60,0,75,0,69,0,89,0,76,0,69,0,78,0,62,0,49,0,54,0,60,0,47,0,75,0,69,0,89,0,76,0,69,0,78,0,62,0,60,0,65,0,76,0,71,0,73,0,68,0,62,0,65,0,69,0,83,0,67,0,84,0,82,0,60,0,47,0,65,0,76,0,71,0,73,0,68,0,62,0,60,0,47,0,80,0,82,0,79,0,84,0,69,0,67,0,84,0,73,0,78,0,70,0,79,0,62,0,60,0,75,0,73,0,68,0,62,0,77,0,122,0,77,0,122,0,77,0,122,0,77,0,122,0,77,0,122,0,77,0,122,0,77,0,122,0,77,0,122,0,65,0,65,0,65,0,65,0,65,0,65,0,61,0,61,0,60,0,47,0,75,0,73,0,68,0,62,0,60,0,67,0,72,0,69,0,67,0,75,0,83,0,85,0,77,0,62,0,65,0,49,0,53,0,66,0,89,0,87,0,68,0,52,0,113,0,115,0,73,0,61,0,60,0,47,0,67,0,72,0,69,0,67,0,75,0,83,0,85,0,77,0,62,0,60,0,47,0,68,0,65,0,84,0,65,0,62,0,60,0,47,0,87,0,82,0,77,0,72,0,69,0,65,0,68,0,69,0,82,0,62,0])),n.EnsureMediaKeysCreated(e,n.KEYSYSTEM_TYPE).then((function(){var t=e.mediaKeys.createSession();return e.sessions.push(t),"org.w3.clearkey"===n.KEYSYSTEM_TYPE?t.addEventListener("message",n.UpdateSessionFunc(n.keys)):("com.widevine.alpha"===n.KEYSYSTEM_TYPE||"com.microsoft.playready"===n.KEYSYSTEM_TYPE)&&t.addEventListener("message",n.licenseRequestReady.bind(n)),t.addEventListener("keystatuseschange",n.KeysChange),t.generateRequest(i,a.buffer)}),n.bail(" failed to ensure MediaKeys on HTMLMediaElement")).then((function(){}),n.bail(" Failed to generate request."))}),"destroy")}},{key:"destroy",value:function(){allOff(this)}}]),e}(),EME$1=EME;function ownKeys$7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$7(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$7(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var DASH=function(){function t(e,r,n){_classCallCheck$1(this,t),EventEmitter(this),this._pluginInst=r,this.__dash__=n;var i=r.config,o=r.player;this.mse=void 0,this.config=i,this.player=o,this.url=e,this.inited=!1,this.loadingTasks=[],this.keyValue=void 0,this.dynamic_video=this.config.dashOpts.dynamic_video,this.useEME=this.config.useEME,this.intertrustServerURL=this.config.intertrustServerURL,this.taskErrorList=[],this.defaultDefinition=this.config.defaultDefinition,this.selectedIdx=0,this.getLicenseUrl=this.config.getLicenseUrl,this.egleIds={},this.lastDefaultSampleDuration={}}return _createClass$1(t,[{key:"getData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this;return new Promise((function(i,o){var a=new Task$1(e,t,(function(e,t,r,n){i({res:e,headers:t,status:r,readyState:n})}),r.timeout||n.config.timeout,r,!1,n._pluginInst.preloadManager);util$1.once(a,"error",(function(e){403===e.status&&o({status:403})}));util$1.once(a,"progress_event",(function(e){n.player&&n.player.emit("progress_event",e)}));util$1.once(a,PRELOAD_HIT,(function(e){n.emitPreloadHit(e)}))}))}},{key:"playWithKeyValue",value:function(e,t){var r,n=this;r=n.__dash__.awManager.openBox(t);var i=new ProxyPromise;return new Promise((function(e,t){var i=util$1.getCookieValue("volcvui");n.config.useUnionInfoDRM&&util$1.checkUnionInfoExpired(n.player.unionID,i,n.config.keyTokenExpiredDuration)?n.__dash__.awManager.transformWithUnionInfo(r,i).then((function(t){e(t)})):e(r)})).then((function(t){t||n.player.emit("DRM_ERROR",new Errors$1(Errors$1.PARSE,Errors$1.BOX_KEY_ERROR)),n.config.dashOpts.drm={clearKeys:_defineProperty$1({},e,t)},n.keyValue=t,(n.__dash__.dashVideoEncrypted||n.__dash__.dashAudioEncrypted)&&!1===n.useEME&&n.__dash__.crypto?isSupportRawCryptoCTR().then((function(e){debug$1$1.encrypt("importKeys useRaw",e),n.useRawCrypto=e,e?n.__dash__.crypto.importKeys(n.keyValue).then(i.resolve):i.resolve()})):(debug$1$1.log("no importKeys"),i.resolve())})),i}},{key:"_getCryptInfos",value:function(){var e="",t="";if(this.dynamic_video.dynamic_video_list&&this.dynamic_video.dynamic_video_list.length>0){for(var r=0;r<this.dynamic_video.dynamic_video_list.length;r++)if(this.dynamic_video.dynamic_video_list[r].kid){e=this.dynamic_video.dynamic_video_list[r].kid,t=this.dynamic_video.dynamic_video_list[r].spade_a;break}}else if(this.dynamic_video.dynamic_audio_list)for(var n=0;n<this.dynamic_video.dynamic_audio_list.length;n++)if(this.dynamic_video.dynamic_audio_list[n].kid){e=this.dynamic_video.dynamic_audio_list[n].kid,t=this.dynamic_video.dynamic_audio_list[n].spade_a;break}return{keyId:e,spade_a:t}}},{key:"init",value:function(e){this._initStartMs=Date.now();var t=this._getCryptInfos(),r=t.keyId,n=t.spade_a,i=this;return i.config.dashOpts&&i.config.dashOpts.drm&&!i.useEME&&!i.keyValue&&(i.keyValue=Object.values(i.config.dashOpts.drm.clearKeys)[0],debug$1$1.log("initDash kv")),new Promise((function(t,o){if(r)if(i.player.emit("drmTypeChange",1),i.intertrustServerURL){var a=window.navigator.userAgent.toLocaleLowerCase().indexOf("chrome")>-1?"widevine":"playready";i.config.dashOpts.drm=_defineProperty$1({},a,{serverURL:i.intertrustServerURL+r}),i.initDash(e,t,o)}else if(i.config.usePlaySpade)setTimeout((function(){i.playWithKeyValue(r,n).then((function(){debug$1$1.encrypt("playWithKeyValue resolve"),i.initDash(e,t,o)}))}),0);else if(i.config.keyToken&&i.config.playDomain){var s=i.config.playDomain,u=util$1.isBase64(i.config.keyToken)?window.atob(i.config.keyToken):i.config.keyToken;new XHR$1({type:"json",method:"GET",url:"//".concat(s,"?").concat(u,"&DrmType=").concat(i.config.useUnionInfoDRM?"webdevice":"22","&PlayAuthIds=").concat(r,"&ssl=true")}).then((function(a){var c=a.response;c&&c.Result&&c.Result.PlayAuthInfoList?(n=c.Result.PlayAuthInfoList[0].PlayAuthContent,i.playWithKeyValue(r,n).then((function(){debug$1$1.encrypt("playWithKeyValue resolve"),i.initDash(e,t,o)}))):(i.player.emit("DRM_ERROR",new Errors$1(Errors$1.PARSE,Errors$1.LIC_PARSE_ERROR,{url:i.getLicenseUrl,data:{host:s,keyToken:u}})),o({}))})).catch((function(e){void 0!==e.status&&i.player.emit("DRM_ERROR",new Errors$1(Errors$1.LIC_NETWORK,Errors$1.NETEORK_ERROR_CODES[e&&e.status?e.status:"timeout"],{url:i.getLicenseUrl,data:{host:s,keyToken:u}})),o(e)}))}else{var c={drm_type:"22",license_request:[{vid:i.config.vid||"",kids:[].concat(r)}]};new XHR$1({type:"json",method:"POST",url:i.getLicenseUrl,data:c}).then((function(a){var s=a.response;s?(n=s.play_licenses[i.config.vid][r],i.playWithKeyValue(r,n).then((function(){debug$1$1.encrypt("playWithKeyValue resolve"),i.initDash(e,t,o)}))):(i.player.emit("DRM_ERROR",new Errors$1(Errors$1.PARSE,Errors$1.LIC_PARSE_ERROR,{url:i.getLicenseUrl,data:c})),o({}))})).catch((function(e){void 0!==e.status&&i.player.emit("DRM_ERROR",new Errors$1(Errors$1.LIC_NETWORK,Errors$1.NETEORK_ERROR_CODES[e&&e.status?e.status:"timeout"],{url:i.getLicenseUrl,data:c})),o(e)}))}else i.initDash(e,t,o)}))}},{key:"_handleIncompleSegment",value:function(e,t){var r=this;e.incomplete=!0,r.__dash__&&(r.__dash__._minDuration=Math.min(t,r.__dash__._minDuration))}},{key:"initDash",value:function(e,t,r){var n,i,o,a=this;this._pluginInst.info({msg:"dash init",data:"dash init",startMs:this._initStartMs,profile:!0});var s=this;s.config.dashOpts&&s.config.dashOpts.drm&&s.useEME&&(s.eme=new EME$1(s.config.dashOpts.drm),s.eme.on(CDM_LICENSE_ERROR,(function(e){a.player&&a.player.emit("log",_objectSpread$4({type:"oneevent",end_type:CDM_LICENSE_ERROR,ua:navigator.userAgent},e)),a.player.errorHandler(new Errors$1(Errors$1.LIC_NETWORK,Errors$1.CDM_LICENSE_ERROR,{line:1021,handle:"",msg:"CDM license reject"}))})),s.eme.on(CDM_LICENSE_SUCCESS,(function(e){a.player&&a.player.emit("log",_objectSpread$4({type:"oneevent",end_type:CDM_LICENSE_SUCCESS,ua:navigator.userAgent},e))})));var u=new MPD$1(e,s.config.dashOpts,s);s.mpd=u;var c=Date.now();util$1.once(u,"ready",(function(){debug$1$1.log("mpd ready"),a._pluginInst.info({msg:"mpd ready",name:"mpd ready",startMs:c,profile:!0}),s.type=u.type,i=u.mediaList.video,o=u.mediaList.audio,s.config&&s.config.defaultDefinition?i.forEach((function(e,t){e.definition===s.config.defaultDefinition&&(i.selectedIdx=t)})):i.selectedIdx=0,s.eme&&s.useEME&&s.eme.SetupEME(s.player.video),debug$1$1.segment(i),debug$1$1.segment(o);var e=Date.now();n=new MSE$1(s.config&&s.config.mediaType,void 0);var r=!!(i.length>0&&i[i.selectedIdx])&&s.config&&!s.config.dashOpts.audioOnly,l=!!(o.length>0&&o[o.selectedIdx]),d=u.mediaList.audio,f=u.mediaList.video,h={};l&&(h[CONTENT_TYPES.AUDIO]={mimeType:"audio/mp4",codec:'audio/mp4; codecs="'.concat(d[d.selectedIdx].codecs,'"')}),r&&(h[CONTENT_TYPES.VIDEO]={mimeType:"video/mp4",codec:'video/mp4; codecs="'.concat(f[f.selectedIdx].codecs,'"')}),n.init(h).then((function(){a._pluginInst.info({msg:"mse init success",name:"mseInit",startMs:e,profile:!0});var t=[];s.config&&!s.config.dashOpts.audioOnly&&i&&i.length>0&&i[i.selectedIdx]&&i[i.selectedIdx].initSegment&&t.push(s.__dash__._makeInitSegemntRequestWithRetry("video",i.selectedIdx)),o[o.selectedIdx]&&o[o.selectedIdx].initSegment&&t.push(s.__dash__._makeInitSegemntRequestWithRetry("audio",o.selectedIdx)),Promise.all(t).then((function(e){var t,n,a;t=e,n=-1,a=[],(s.config&&s.config.dashOpts.audioOnly?["audio"]:["video","audio"]).forEach((function(e){var r=u.mediaList[e];if(!(r.length<1)&&r[r.selectedIdx]&&r[r.selectedIdx].mimeType){n++;var i=t[n];if(!i.initSegmentRes)return debug$1$1.abr("initSegment null, task request error, stop"),void s.emit("error",new Errors$1(Errors$1.PARSE,Errors$1.SEG_PARSE_ERROR,{line:180,handle:"[DASH] addBuffer",msg:"wrapperData.initSegmentRes is null"},s.player));a.push(s.__dash__._appendInitSegment(e,i,r.selectedIdx))}})),Promise.all(a).then((function(){s.inited=!0,(r&&(i[i.selectedIdx].encrypted||i[i.selectedIdx].kid)||l&&(o[o.selectedIdx].encrypted||o[o.selectedIdx].kid))&&s.eme&&s.eme.emit("encrypted"),"vod"===s.type&&(s.seek(0,MPD_SEEK_TYPE.INIT),s.emit("start_play"))}))}))})).catch((function(e){console.log("mse init error",e),a._pluginInst.info({msg:"msecatch",error:e}),s.player.errorHandler(new Errors$1(Errors$1.MSE,Errors$1.MSE_MEDIA_TYPES_NOT_SUPPORTED,{line:329,msg:"mse init fail"}))})),s.mse=n,t(n)}))}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MPD_SEEK_TYPE.NORMAL,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this;this.mpd.seek(e,t).then((function(e){var t=n.mpd.mediaList.video,i=n.mpd.mediaList.audio,o=!!(t.length>0&&t[t.selectedIdx]),a=!!(i.length>0&&i[i.selectedIdx]);o&&a&&2*t[t.selectedIdx].mediaDuration<i[i.selectedIdx].mediaDuration?n.emit("error",new Errors$1(Errors$1.PARSE,Errors$1.DUR_PARSE_ERROR,{line:261,handle:"[DASH] seek",msg:"the video.mediaDuration not match audio.mediaDuration"},n.player)):(debug$1$1.log("seekResult: ",e),(n.config.dashOpts&&n.config.dashOpts.audioOnly?["audio"]:["video","audio"]).forEach((function(t){e[t]&&e[t].length>0&&(e[t].length<=1||e[t].some((function(e){return e.downloaded===SEGMENT_STATE.APPEND})))&&e[t].every((function(e){return e.downloaded===SEGMENT_STATE.APPEND||(e.bufferInCache?(debug$1$1.log("append缓存buffer"),debug$1$1.log("append ".concat(t," ").concat(e.start," ").concat(e.end)),n.appendSegment(t,e.bufferInCache.res,e,e.bufferInCache.headers||{},e.bufferInCache.extData)):n.makeSegmentRequestWithRetry(t,e).then((function(i){var o=i.res,a=i.headers,s=i.extData;r?(debug$1$1.log("缓存buffer"),e.bufferInCache={res:o,headers:a,extData:s},n.updateItemState(e,!1)):(n.updateItemState(e,!0),debug$1$1.log("append ".concat(t," ").concat(e.start," ").concat(e.end)),n.appendSegment(t,o,e,a||{},s))}))),!0}))})))}))}},{key:"makeSegmentRequestWithRetry",value:function(e,t){var r=this,n=new ProxyPromise;return r.makeSegmentRequest(e,t).then((function(e){var t=e.res,r=e.headers,i=e.extData;n.resolve({res:t,headers:r,extData:i})})).catch((function(e){r.updateItemState(t),console.log("err",e)})),n}},{key:"makeSegmentRequest",value:function(e,t){var r=this,n=this,i=new ProxyPromise;void 0===t.range&&(t.range=[]),"video"===e&&debug$1$1.network("http get video start: ".concat(t.start,", end: ").concat(t.end," ,range: ").concat(t.range));var o=!1;n.player&&n.__dash__._checkUrlRange(t.url);var a={limitSizeM:1/0,segment_resolution:"",isVideo:"video"===e,ratio:n.config.segmentRatio||7.5,vid:n.config.vid,mediaType:e,start:t.start,end:t.end,useUrlRange:n.config.useUrlRange},s=1/0;if("video"===e){try{var u=n.mpd.mediaList[e],c=u[u.selectedIdx],l=c.definition||n.__dash__.bandwidth2item[c.bandwidth].definition;s=SEGMENT_SIZE_CONFIG[l.toLowerCase()],a.segment_resolution=l.toLowerCase(),a.definition=a.segment_resolution,a.bitrate=c.bandwidth}catch(error){s=1/0}a.limitSizeM=s}var d=n&&n.config&&n.config.retryTimes,f=new Task$1(t.url,t.range,(function(s,u,c){t.realUrl=f.realUrl;var l=f.realUrl||t.url;if(s!==TASK_URL_NOT_FOUND){if("network"===s)return n.updateItemState(t),void n.emit("error",new Errors$1(Errors$1.NETWORK,Errors$1.NETWORK_DISCONNECT,{line:326,handle:"[DASH] task",url:l,range:t.range,headers:u},n.player));if("error"===s&&n.reportMonitorEvent(SEGMENT_REQUEST_EXPIRED,l,t.range[0],t.range[1],u,{status:c,segment_resolution:a.segment_resolution}),"timeout"===s||"error"===s)return n.removeTask(f),t.tryTimes||(t.tryTimes=0),t.tryTimes++,t.tryTimes>(d||2)?(debug$1$1.abr("task retry fail",t.range),n&&n.player&&n.__dash__&&(n.__dash__.errorNeedTryRefresh=!0),"timeout"===s&&n.reportMonitorEvent(403===c?SEGMENT_REQUEST_EXPIRED:SEGMENT_REQUEST_TIMEOUT,l,t.range[0],t.range[1],u,{status:c,segment_resolution:a.segment_resolution}),void n.emit("error",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[s&&s.status?s.status:"timeout"],{line:326,handle:"[DASH] task",msg:403===c?TASK_REQUEST_EXPIRED:TASK_REQUEST_ERROR,url:l,range:t.range,headers:u},n.player))):(debug$1$1.abr("task retry ",t.range),r.makeSegmentRequest(e,t),void n.updateItemState(t));if(n&&n.player&&n.__dash__&&n.__dash__.errorNeedTryRefresh&&(n.__dash__.errorNeedTryRefresh=!1),"repeat"===s)return o=!0,n.updateItemState(t),void debug$1$1.log(t.url,t.range,"repeat");n.removeTask(f),s instanceof ArrayBuffer?(i.resolve({res:s,headers:u,extData:{status:c,segment_resolution:a.segment_resolution}}),n.mseLog("task loadsucc",t,e)):(n.mseLog("task loaderror",t,e),n.updateItemState(t))}else{var h=n.mse.buffered(e);if(h&&h.length>0){var p=h.end(h.length-1);n._handleIncompleSegment(t,p)}}}),n.config.timeout,a,!1,n._pluginInst.preloadManager);util$1.once(f,"error",(function(e){if(t.segmentExpiredTimes||(t.segmentExpiredTimes=0),t.segmentExpiredTimes++,t.segmentExpiredTimes>(d||2)&&(e.segmentExpired=!0,n.reportMonitorEvent(SEGMENT_REQUEST_EXPIRED,t.realUrl||t.url,t.range[0],t.range[1],e.headers,{segment_resolution:a.segment_resolution}),n.emit("error",e)),e[status]&&SEGMENT_EXCEPTION_CODE.includes(e[status])){var r=e.headers||{};r.segment_resolution=a.segment_resolution,n.reportMonitorEvent(SEGMENT_ERR_MSG,t.realUrl||t.url,t.range[0],t.range[1],r)}}));util$1.once(f,"getHeaders",(function(r){if("video"===e&&n.player){var i=n.mpd.mediaList[e],o=i[i.selectedIdx].definition;n.__dash__.curReqVideoSegInfo={url:t.realUrl||t.url,start:t.start,end:t.end,range:t.range,definition:o,headers:r}}}));util$1.once(f,"progress_event",(function(e){try{e.vid=n.player.vid||n.config.vid,n.player.emit("progress_event",e)}catch(error){console.log(error)}}));util$1.once(f,CANCEL,(function(){n.updateItemState(t),n.mseLog("task cancel",t,e)}));return util$1.once(f,PRELOAD_HIT,(function(e){n.emitPreloadHit(e)})),o||n.loadingTasks.push(f),i}},{key:"reportMonitorEvent",value:function(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=this,s=a.getReportData(r,n,i,o),u=i.eagleid;if(u){if(this.egleIds[u])return;this.egleIds[u]=1}a.player&&a.player.emit("log",{type:"oneevent",end_type:e,cdnUrl:t,ext:s})}},{key:"getReportData",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=util$1.transformHeaders(r,MONITOR_HEADERS),o=Object.assign({},{start:e||-1,end:t||-1},i,n);return o}},{key:"reportMenuEvent",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this._pluginInst.player,a=this.getReportData(t,r,n,i);a.url=e,o.emit("menusegment",a)}},{key:"appendSegment",value:function(t,r,n,i,o){var a=this;if(!this._hasDestroyed&&a.mpd){var s,u=o.status,c=o.segment_resolution,l=a.mpd.mediaList[t],d=l.selectedIdx,f=0,h=-1,p=n.realUrl||n.url;if(r instanceof ArrayBuffer)try{h=r.byteLength;var g=new Uint8Array(r,4,4),y=String.fromCharCode.apply(null,g);if("moof"!==y&&"styp"!==y&&(debug$1$1.media("segment content error",n,i),f=1,a.reportMonitorEvent(MEDIA_CONTENT_ERR,p,n.range[0],n.range[1],i,{segment_size:r.byteLength,status:u,segment_resolution:c,box_type:y,step:f,segment_origin_size:h})),"ftyp"===y&&200===u&&2===n.range.length){f=2;var v=n.range[0];r=r.slice(v,n.range[1]+1)}}catch(e){a.reportMonitorEvent(MEDIA_CONTENT_ERR,p,n.range[0],n.range[1],i,{segment_size:r.byteLength,status:u,segment_resolution:c,step:f,box_type:"error",segment_origin_size:h}),debug$1$1.media("segment content catch",n,e)}a.reportMenuEvent(p,n.range[0],n.range[1],i,{segment_size:r.byteLength,status:u,segment_resolution:c}),a.keyValue&&(a.__dash__.dashVideoEncrypted||a.__dash__.dashAudioEncrypted)&&!1===a.useEME&&a.__dash__.crypto?(s=performance.now(),a.mseLog("decryptBody start",n,t),a.__dash__.crypto.decryptBody(r,this.keyValue,"video"===t,a.useRawCrypto).then((function(e){var r=e.data,i=e.id,o=e.headerId;if(r){var u=performance.now();if(a.encryptTotalAll||(a.encryptTotalAll=0),a.encryptTotalAll+=u-s,debug$1$1.encrypt("encryptTotalAll:".concat(a.encryptTotalAll)),a.mseLog("decryptBody succ",n,t),"video"===t&&(a.encryptTotal||(a.encryptTotal=0),a.encryptTotal+=u-s,debug$1$1.encrypt("encryptVideo:".concat(a.encryptTotal)),i<o))return a.updateItemState(n),void console.warn("decrytbody discard, id:".concat(i,", headerId:").concat(o,", index:").concat(d,",  url:").concat(n.url,", start:").concat(n.start));a.doAppendSegment(t,l,r,n,d)}else a.updateItemState(n)}))):a.doAppendSegment(t,l,r,n,d)}}},{key:"doAppendSegment",value:function(e,t,r,n,i){var o=this,a={start:n.start,end:n.end,index:i,bandwidth:t[t.selectedIdx].bandwidth,fps:t[t.selectedIdx].fps,mediaType:e,sequence:n.idx};e!==CONTENT_TYPES.VIDEO||-1===this.__dash__.curVideoInitSegmentIdx||i===this.__dash__.curVideoInitSegmentIdx?o.mse.appendBuffer(e,new Uint8Array(r)).then((function(){o.updateItemState(n,!0),"video"===e&&(o.player.emit("addVideoBufferEnd",a),o.__dash__.bufferingGoalScale+=.1,o.__dash__.bufferingGoalScale=Math.min(1,o.__dash__.bufferingGoalScale),1===o.__dash__.bufferingGoalScale&&(o.config.progressTimer=1e3));var t=o.mse,r=o.mpd;if(t&&a.start>=0){var i=t.buffered(e),s=i.end(i.length-1),u=r.mediaList[e][a.index].mediaSegments[a.sequence-1],c=u.segmentDuration;c-s%c>.1&&0!==s%c&&s<=a.end&&(o._handleIncompleSegment(u,s),debug$1$1.log("extData",a))}})).catch((function(e){if(console.log("err",e),o.updateItemState(n,!1),"QuotaExceededError"===e.message){debug$1$1.log("bufferingSacleChange",o.__dash__.bufferingGoalScale);var t=Math.round(100*o.__dash__.bufferingGoalScale);t>50?o.__dash__.bufferingGoalScale=.2:t>10?o.__dash__.bufferingGoalScale/=2:o.__dash__.bufferingGoalScale=.1,o.__dash__&&o.__dash__.clearBuffer(!0)}e&&e.message===ERROR_TYPES$1.MSE_OP_FAIL&&o.player.emit(new Errors$1(Errors$1.MSE,Errors$1.MSE_PARSE_ERROR,{line:800,handle:"[DASH] appendInit",msg:e.message}))})):debug$1$1.log("init 与 segment不匹配")}},{key:"abortLoadingTasks",value:function(){try{this.loadingTasks.forEach((function(e){e.cancel()}))}catch(e){debug$1$1.log("type-video abort error",e)}Task$1.queue=[],this.loadingTasks=[],debug$1$1.log("preload abortLoadingTasks")}},{key:"removeTask",value:function(t){try{var r=this.loadingTasks.indexOf(t);r>-1&&this.loadingTasks.splice(r,1)}catch(e){debug$1$1.log("type-video remove error",e)}}},{key:"updateItemState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];e.length>0?r=e:r.push(e),r.forEach((function(e){e.downloaded=t?SEGMENT_STATE.APPEND:SEGMENT_STATE.NO_START}))}},{key:"mseLog",value:function(e,t,r){debug$1$1.mse("type-".concat(r,"-start-").concat(t.start,"-end-").concat(t.end,"-").concat(e,",range:").concat(JSON.stringify(t.range)))}},{key:"emitPreloadHit",value:function(e){debug$1$1.preload("emit preloadhit",e),this.player&&this.player.emit("log",{type:"onetemp",action:"append",data:{preload_hit:e+"|"}})}},{key:"destroy",value:function(){this._hasDestroyed=!0}}]),t}(),DASH$1=DASH;function funcToSource(e,t){var r=[e.toString().replace(/^function\s*.*?\s*\(\)\s*\{/,"").replace(/\}$/,"")];return t&&r.push("//# sourceMappingURL="+t+"\n"),r}function createURL$1(e,t){var r=funcToSource(e,t),n=new Blob(r,{type:"application/javascript"});return URL.createObjectURL(n)}function createInlineWorkerFactory(e,t){var r;return function(n){return r=r||createURL$1(e,t),new Worker(r,n)}}var WorkerFactory$4=createInlineWorkerFactory((function(){!function(){function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=function(e){return e&&e.Math==Math&&e},o=i("object"==("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))&&globalThis)||i("object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window)||i("object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self)||i("object"==_typeof$3(n)&&n)||function(){return this}()||Function("return this")(),a={},s=function(e){try{return!!e()}catch(error){return!0}},u=!s((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c=!s((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),l=c,d=Function.prototype.call,f=l?d.bind(d):function(){return d.apply(d,arguments)},h={},p={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,y=g&&!p.call({1:2},1);h.f=y?function(e){var t=g(this,e);return!!t&&t.enumerable}:p;var v,m,_=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},b=c,A=Function.prototype,E=A.bind,S=A.call,T=b&&E.bind(S,S),$=b?function(e){return e&&T(e)}:function(e){return e&&function(){return S.apply(e,arguments)}},w=$,C=w({}.toString),I=w("".slice),k=function(e){return I(C(e),8,-1)},O=$,P=s,R=k,x=o.Object,D=O("".split),L=P((function(){return!x("z").propertyIsEnumerable(0)}))?function(e){return"String"==R(e)?D(e,""):x(e)}:x,N=o.TypeError,M=function(e){if(null==e)throw N("Can't call method on "+e);return e},B=L,U=M,j=function(e){return B(U(e))},F=function(e){return"function"==typeof e},V=F,G=function(e){return"object"==_typeof$3(e)?null!==e:V(e)},H=o,K=F,z=function(e){return K(e)?e:void 0},W=function(e,t){return arguments.length<2?z(H[e]):H[e]&&H[e][t]},Y=$({}.isPrototypeOf),X=W("navigator","userAgent")||"",Z=o,q=X,Q=Z.process,J=Z.Deno,ee=Q&&Q.versions||J&&J.version,te=ee&&ee.v8;te&&(m=(v=te.split("."))[0]>0&&v[0]<4?1:+(v[0]+v[1])),!m&&q&&(!(v=q.match(/Edge\/(\d+)/))||v[1]>=74)&&(v=q.match(/Chrome\/(\d+)/))&&(m=+v[1]);var re=m,ne=re,ie=s,oe=!!Object.getOwnPropertySymbols&&!ie((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ne&&ne<41})),ae=oe&&!Symbol.sham&&"symbol"==_typeof$3(Symbol.iterator),se=W,ue=F,ce=Y,le=ae,de=o.Object,fe=le?function(e){return"symbol"==_typeof$3(e)}:function(e){var t=se("Symbol");return ue(t)&&ce(t.prototype,de(e))},he=o.String,pe=function(e){try{return he(e)}catch(error){return"Object"}},ge=F,ye=pe,ve=o.TypeError,me=function(e){if(ge(e))return e;throw ve(ye(e)+" is not a function")},_e=me,be=function(e,t){var r=e[t];return null==r?void 0:_e(r)},Ae=f,Ee=F,Se=G,Te=o.TypeError,$e={exports:{}},we=o,Ce=Object.defineProperty,Ie=function(e,t){try{Ce(we,e,{value:t,configurable:!0,writable:!0})}catch(error){we[e]=t}return t},ke=Ie,Oe="__core-js_shared__",Pe=o[Oe]||ke(Oe,{}),Re=Pe;($e.exports=function(e,t){return Re[e]||(Re[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.7",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.7/LICENSE",source:"https://github.com/zloirock/core-js"});var xe=M,De=o.Object,Le=function(e){return De(xe(e))},Ne=Le,Me=$({}.hasOwnProperty),Be=Object.hasOwn||function(e,t){return Me(Ne(e),t)},Ue=$,je=0,Fe=Math.random(),Ve=Ue(1..toString),Ge=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Ve(++je+Fe,36)},He=o,Ke=$e.exports,ze=Be,We=Ge,Ye=oe,Xe=ae,Ze=Ke("wks"),qe=He.Symbol,Qe=qe&&qe.for,Je=Xe?qe:qe&&qe.withoutSetter||We,et=function(e){if(!ze(Ze,e)||!Ye&&"string"!=typeof Ze[e]){var t="Symbol."+e;Ye&&ze(qe,e)?Ze[e]=qe[e]:Ze[e]=Xe&&Qe?Qe(t):Je(t)}return Ze[e]},tt=f,rt=G,nt=fe,it=be,ot=function(e,t){var r,n;if("string"===t&&Ee(r=e.toString)&&!Se(n=Ae(r,e)))return n;if(Ee(r=e.valueOf)&&!Se(n=Ae(r,e)))return n;if("string"!==t&&Ee(r=e.toString)&&!Se(n=Ae(r,e)))return n;throw Te("Can't convert object to primitive value")},at=et,st=o.TypeError,ut=at("toPrimitive"),ct=function(e,t){if(!rt(e)||nt(e))return e;var r,n=it(e,ut);if(n){if(void 0===t&&(t="default"),r=tt(n,e,t),!rt(r)||nt(r))return r;throw st("Can't convert object to primitive value")}return void 0===t&&(t="number"),ot(e,t)},lt=ct,dt=fe,ft=function(e){var t=lt(e,"string");return dt(t)?t:t+""},ht=G,pt=o.document,gt=ht(pt)&&ht(pt.createElement),yt=function(e){return gt?pt.createElement(e):{}},vt=yt,mt=!u&&!s((function(){return 7!=Object.defineProperty(vt("div"),"a",{get:function(){return 7}}).a})),_t=u,bt=f,At=h,Et=_,St=j,Tt=ft,$t=Be,wt=mt,Ct=Object.getOwnPropertyDescriptor;a.f=_t?Ct:function(e,t){if(e=St(e),t=Tt(t),wt)try{return Ct(e,t)}catch(error){}if($t(e,t))return Et(!bt(At.f,e,t),e[t])};var It={},kt=u&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Ot=o,Pt=G,Rt=Ot.String,xt=Ot.TypeError,Dt=function(e){if(Pt(e))return e;throw xt(Rt(e)+" is not an object")},Lt=u,Nt=mt,Mt=kt,Bt=Dt,Ut=ft,jt=o.TypeError,Ft=Object.defineProperty,Vt=Object.getOwnPropertyDescriptor,Gt="enumerable",Ht="configurable",Kt="writable";It.f=Lt?Mt?function(e,t,r){if(Bt(e),t=Ut(t),Bt(r),"function"==typeof e&&"prototype"===t&&"value"in r&&Kt in r&&!r.writable){var n=Vt(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:Ht in r?r.configurable:n.configurable,enumerable:Gt in r?r.enumerable:n.enumerable,writable:!1})}return Ft(e,t,r)}:Ft:function(e,t,r){if(Bt(e),t=Ut(t),Bt(r),Nt)try{return Ft(e,t,r)}catch(error){}if("get"in r||"set"in r)throw jt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var zt=It,Wt=_,Yt=u?function(e,t,r){return zt.f(e,t,Wt(1,r))}:function(e,t,r){return e[t]=r,e},Xt={exports:{}},Zt=u,qt=Be,Qt=Function.prototype,Jt=Zt&&Object.getOwnPropertyDescriptor,er=qt(Qt,"name"),tr={EXISTS:er,PROPER:er&&"something"===function(){}.name,CONFIGURABLE:er&&(!Zt||Zt&&Jt(Qt,"name").configurable)},rr=F,nr=Pe,ir=$(Function.toString);rr(nr.inspectSource)||(nr.inspectSource=function(e){return ir(e)});var or,ar,sr,ur=nr.inspectSource,cr=F,lr=ur,dr=o.WeakMap,fr=cr(dr)&&/native code/.test(lr(dr)),hr=$e.exports,pr=Ge,gr=hr("keys"),yr=function(e){return gr[e]||(gr[e]=pr(e))},vr={},mr=fr,_r=o,br=$,Ar=G,Er=Yt,Sr=Be,Tr=Pe,$r=yr,wr=vr,Cr="Object already initialized",Ir=_r.TypeError,kr=_r.WeakMap;if(mr||Tr.state){var Or=Tr.state||(Tr.state=new kr),Pr=br(Or.get),Rr=br(Or.has),xr=br(Or.set);or=function(e,t){if(Rr(Or,e))throw new Ir(Cr);return t.facade=e,xr(Or,e,t),t},ar=function(e){return Pr(Or,e)||{}},sr=function(e){return Rr(Or,e)}}else{var Dr=$r("state");wr[Dr]=!0,or=function(e,t){if(Sr(e,Dr))throw new Ir(Cr);return t.facade=e,Er(e,Dr,t),t},ar=function(e){return Sr(e,Dr)?e[Dr]:{}},sr=function(e){return Sr(e,Dr)}}var Lr={set:or,get:ar,has:sr,enforce:function(e){return sr(e)?ar(e):or(e,{})},getterFor:function(e){return function(t){var r;if(!Ar(t)||(r=ar(t)).type!==e)throw Ir("Incompatible receiver, "+e+" required");return r}}},Nr=s,Mr=F,Br=Be,Ur=u,jr=tr.CONFIGURABLE,Fr=ur,Vr=Lr.enforce,Gr=Lr.get,Hr=Object.defineProperty,Kr=Ur&&!Nr((function(){return 8!==Hr((function(){}),"length",{value:8}).length})),zr=String(String).split("String"),Wr=Xt.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Br(e,"name")||jr&&e.name!==t)&&Hr(e,"name",{value:t,configurable:!0}),Kr&&r&&Br(r,"arity")&&e.length!==r.arity&&Hr(e,"length",{value:r.arity});try{r&&Br(r,"constructor")&&r.constructor?Ur&&Hr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(error){}var n=Vr(e);return Br(n,"source")||(n.source=zr.join("string"==typeof t?t:"")),e};Function.prototype.toString=Wr((function(){return Mr(this)&&Gr(this).source||Fr(this)}),"toString");var Yr=F,Xr=Yt,Zr=Xt.exports,qr=Ie,Qr=function(e,t,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:t;return Yr(r)&&Zr(r,o,n),n.global?i?e[t]=r:qr(t,r):(n.unsafe?e[t]&&(i=!0):delete e[t],i?e[t]=r:Xr(e,t,r)),e},Jr={},en=Math.ceil,tn=Math.floor,rn=Math.trunc||function(e){var t=+e;return(t>0?tn:en)(t)},nn=function(e){var t=+e;return t!=t||0===t?0:rn(t)},on=nn,an=Math.max,sn=Math.min,un=function(e,t){var r=on(e);return r<0?an(r+t,0):sn(r,t)},cn=nn,ln=Math.min,dn=function(e){return e>0?ln(cn(e),9007199254740991):0},fn=dn,hn=function(e){return fn(e.length)},pn=j,gn=un,yn=hn,vn=function(e){return function(t,r,n){var i,o=pn(t),a=yn(o),s=gn(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},mn={includes:vn(!0),indexOf:vn(!1)},_n=Be,bn=j,An=mn.indexOf,En=vr,Sn=$([].push),Tn=function(e,t){var r,n=bn(e),i=0,o=[];for(r in n)!_n(En,r)&&_n(n,r)&&Sn(o,r);for(;t.length>i;)_n(n,r=t[i++])&&(~An(o,r)||Sn(o,r));return o},$n=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],wn=Tn,Cn=$n.concat("length","prototype");Jr.f=Object.getOwnPropertyNames||function(e){return wn(e,Cn)};var In={};In.f=Object.getOwnPropertySymbols;var kn=W,On=Jr,Pn=In,Rn=Dt,xn=$([].concat),Dn=kn("Reflect","ownKeys")||function(e){var t=On.f(Rn(e)),r=Pn.f;return r?xn(t,r(e)):t},Ln=Be,Nn=Dn,Mn=a,Bn=It,Un=function(e,t,r){for(var n=Nn(t),i=Bn.f,o=Mn.f,a=0;a<n.length;a++){var s=n[a];Ln(e,s)||r&&Ln(r,s)||i(e,s,o(t,s))}},jn=s,Fn=F,Vn=/#|\.prototype\./,Gn=function(e,t){var r=Kn[Hn(e)];return r==Wn||r!=zn&&(Fn(t)?jn(t):!!t)},Hn=Gn.normalize=function(e){return String(e).replace(Vn,".").toLowerCase()},Kn=Gn.data={},zn=Gn.NATIVE="N",Wn=Gn.POLYFILL="P",Yn=Gn,Xn=o,Zn=a.f,qn=Yt,Qn=Qr,Jn=Ie,ei=Un,ti=Yn,ri=function(e,t){var r,n,i,o,a,s=e.target,u=e.global,c=e.stat;if(r=u?Xn:c?Xn[s]||Jn(s,{}):(Xn[s]||{}).prototype)for(n in t){if(o=t[n],i=e.dontCallGetSet?(a=Zn(r,n))&&a.value:r[n],!ti(u?n:s+(c?".":"#")+n,e.forced)&&void 0!==i){if(_typeof$3(o)==_typeof$3(i))continue;ei(o,i)}(e.sham||i&&i.sham)&&qn(o,"sham",!0),Qn(r,n,o,e)}},ni=me,ii=c,oi=$($.bind),ai=function(e,t){return ni(e),void 0===t?e:ii?oi(e,t):function(){return e.apply(t,arguments)}},si=k,ui=Array.isArray||function(e){return"Array"==si(e)},ci={};ci[et("toStringTag")]="z";var li="[object z]"===String(ci),di=o,fi=li,hi=F,pi=k,gi=et("toStringTag"),yi=di.Object,vi="Arguments"==pi(function(){return arguments}()),mi=fi?pi:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(error){}}(t=yi(e),gi))?r:vi?pi(t):"Object"==(n=pi(t))&&hi(t.callee)?"Arguments":n},_i=$,bi=s,Ai=F,Ei=mi,Si=ur,Ti=function(){},$i=[],wi=W("Reflect","construct"),Ci=/^\s*(?:class|function)\b/,Ii=_i(Ci.exec),ki=!Ci.exec(Ti),Oi=function(e){if(!Ai(e))return!1;try{return wi(Ti,$i,e),!0}catch(error){return!1}},Pi=function(e){if(!Ai(e))return!1;switch(Ei(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ki||!!Ii(Ci,Si(e))}catch(error){return!0}};Pi.sham=!0;var Ri=!wi||bi((function(){var e;return Oi(Oi.call)||!Oi(Object)||!Oi((function(){e=!0}))||e}))?Pi:Oi,xi=o,Di=ui,Li=Ri,Ni=G,Mi=et("species"),Bi=xi.Array,Ui=function(e){var t;return Di(e)&&(t=e.constructor,(Li(t)&&(t===Bi||Di(t.prototype))||Ni(t)&&null===(t=t[Mi]))&&(t=void 0)),void 0===t?Bi:t},ji=function(e,t){return new(Ui(e))(0===t?0:t)},Fi=ai,Vi=L,Gi=Le,Hi=hn,Ki=ji,zi=$([].push),Wi=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(u,c,l,d){for(var f,h,p=Gi(u),g=Vi(p),y=Fi(c,l),v=Hi(g),m=0,_=d||Ki,b=t?_(u,v):r||a?_(u,0):void 0;v>m;m++)if((s||m in g)&&(h=y(f=g[m],m,p),e))if(t)b[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:zi(b,f)}else switch(e){case 4:return!1;case 7:zi(b,f)}return o?-1:n||i?i:b}},Yi={forEach:Wi(0),map:Wi(1),filter:Wi(2),some:Wi(3),every:Wi(4),find:Wi(5),findIndex:Wi(6),filterReject:Wi(7)},Xi=s,Zi=re,qi=et("species"),Qi=function(e){return Zi>=51||!Xi((function(){var t=[];return(t.constructor={})[qi]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Ji=Yi.map;ri({target:"Array",proto:!0,forced:!Qi("map")},{map:function(e){return Ji(this,e,arguments.length>1?arguments[1]:void 0)}});var eo=o,to=F,ro=eo.String,no=eo.TypeError,io=$,oo=Dt,ao=function(e){if("object"==_typeof$3(e)||to(e))return e;throw no("Can't set "+ro(e)+" as a prototype")},so=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=io(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(error){}return function(r,n){return oo(r),ao(n),t?e(r,n):r.__proto__=n,r}}():void 0),uo=F,co=G,lo=so,fo=function(e,t,r){var n,i;return lo&&uo(n=t.constructor)&&n!==r&&co(i=n.prototype)&&i!==r.prototype&&lo(e,i),e},ho=$(1..valueOf),po=mi,go=o.String,yo=function(e){if("Symbol"===po(e))throw TypeError("Cannot convert a Symbol value to a string");return go(e)},vo="\t\n\v\f\r                　\u2028\u2029\ufeff",mo=M,_o=yo,bo=$("".replace),Ao="[\t\n\v\f\r                　\u2028\u2029\ufeff]",Eo=RegExp("^"+Ao+Ao+"*"),So=RegExp(Ao+Ao+"*$"),To=function(e){return function(t){var r=_o(mo(t));return 1&e&&(r=bo(r,Eo,"")),2&e&&(r=bo(r,So,"")),r}},$o={start:To(1),end:To(2),trim:To(3)},wo=u,Co=o,Io=$,ko=Yn,Oo=Qr,Po=Be,Ro=fo,xo=Y,Do=fe,Lo=ct,No=s,Mo=Jr.f,Bo=a.f,Uo=It.f,jo=ho,Fo=$o.trim,Vo="Number",Go=Co.Number,Ho=Go.prototype,Ko=Co.TypeError,zo=Io("".slice),Wo=Io("".charCodeAt),Yo=function(e){var t=Lo(e,"number");return"bigint"==typeof t?t:Xo(t)},Xo=function(e){var t,r,n,i,o,a,s,u,c=Lo(e,"number");if(Do(c))throw Ko("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Fo(c),43===(t=Wo(c,0))||45===t){if(88===(r=Wo(c,2))||120===r)return NaN}else if(48===t){switch(Wo(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(a=(o=zo(c,2)).length,s=0;s<a;s++)if((u=Wo(o,s))<48||u>i)return NaN;return parseInt(o,n)}return+c};if(ko(Vo,!Go(" 0o1")||!Go("0b1")||Go("+0x1"))){for(var Zo,qo=function(e){var t=arguments.length<1?0:Go(Yo(e)),r=this;return xo(Ho,r)&&No((function(){jo(r)}))?Ro(Object(t),r,qo):t},Qo=wo?Mo(Go):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Jo=0;Qo.length>Jo;Jo++)Po(Go,Zo=Qo[Jo])&&!Po(qo,Zo)&&Uo(qo,Zo,Bo(Go,Zo));qo.prototype=Ho,Ho.constructor=qo,Oo(Co,Vo,qo,{constructor:!0})}var ea=Tn,ta=$n,ra=Object.keys||function(e){return ea(e,ta)},na=u,ia=$,oa=f,aa=s,sa=ra,ua=In,ca=h,la=Le,da=L,fa=Object.assign,ha=Object.defineProperty,pa=ia([].concat),ga=!fa||aa((function(){if(na&&1!==fa({b:1},fa(ha({},"a",{enumerable:!0,get:function(){ha(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=fa({},e)[r]||sa(fa({},t)).join("")!=n}))?function(e,t){for(var r=la(e),n=arguments.length,i=1,o=ua.f,a=ca.f;n>i;)for(var s,u=da(arguments[i++]),c=o?pa(sa(u),o(u)):sa(u),l=c.length,d=0;l>d;)s=c[d++],na&&!oa(a,u,s)||(r[s]=u[s]);return r}:fa,ya=ga;ri({target:"Object",stat:!0,arity:2,forced:Object.assign!==ya},{assign:ya});var va=s,ma=function(e,t){var r=[][e];return!!r&&va((function(){r.call(null,t||function(){return 1},1)}))},_a=ri,ba=L,Aa=j,Ea=ma,Sa=$([].join),Ta=ba!=Object,$a=Ea("join",",");_a({target:"Array",proto:!0,forced:Ta||!$a},{join:function(e){return Sa(Aa(this),void 0===e?",":e)}});var wa=Yi.forEach,Ca=ma("forEach")?[].forEach:function(e){return wa(this,e,arguments.length>1?arguments[1]:void 0)};ri({target:"Array",proto:!0,forced:[].forEach!=Ca},{forEach:Ca});var Ia=mi,ka=li?{}.toString:function(){return"[object "+Ia(this)+"]"};li||Qr(Object.prototype,"toString",ka,{unsafe:!0});var Oa={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Pa=yt("span").classList,Ra=Pa&&Pa.constructor&&Pa.constructor.prototype,xa=Ra===Object.prototype?void 0:Ra,Da=o,La=Oa,Na=xa,Ma=Ca,Ba=Yt,Ua=function(e){if(e&&e.forEach!==Ma)try{Ba(e,"forEach",Ma)}catch(error){e.forEach=Ma}};for(var ja in La)La[ja]&&Ua(Da[ja]&&Da[ja].prototype);Ua(Na);var Fa={},Va=u,Ga=kt,Ha=It,Ka=Dt,za=j,Wa=ra;Fa.f=Va&&!Ga?Object.defineProperties:function(e,t){Ka(e);for(var r,n=za(t),i=Wa(t),o=i.length,a=0;o>a;)Ha.f(e,r=i[a++],n[r]);return e};var Ya,Xa=W("document","documentElement"),Za=Dt,qa=Fa,Qa=$n,Ja=vr,es=Xa,ts=yt,rs=yr("IE_PROTO"),ns=function(){},is=function(e){return"<script>"+e+"</"+"script>"},os=function(e){e.write(is("")),e.close();var t=e.parentWindow.Object;return e=null,t},as=function(){try{Ya=new ActiveXObject("htmlfile")}catch(error){}var e,t;as="undefined"!=typeof document?document.domain&&Ya?os(Ya):((t=ts("iframe")).style.display="none",es.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(is("document.F=Object")),e.close(),e.F):os(Ya);for(var r=Qa.length;r--;)delete as.prototype[Qa[r]];return as()};Ja[rs]=!0;var ss=Object.create||function(e,t){var r;return null!==e?(ns.prototype=Za(e),r=new ns,ns.prototype=null,r[rs]=e):r=as(),void 0===t?r:qa.f(r,t)},us=et,cs=ss,ls=It.f,ds=us("unscopables"),fs=Array.prototype;null==fs[ds]&&ls(fs,ds,{configurable:!0,value:cs(null)});var hs,ps,gs,ys={},vs=!s((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ms=o,_s=Be,bs=F,As=Le,Es=vs,Ss=yr("IE_PROTO"),Ts=ms.Object,$s=Ts.prototype,ws=Es?Ts.getPrototypeOf:function(e){var t=As(e);if(_s(t,Ss))return t[Ss];var r=t.constructor;return bs(r)&&t instanceof r?r.prototype:t instanceof Ts?$s:null},Cs=s,Is=F,ks=ws,Os=Qr,Ps=et("iterator"),Rs=!1;[].keys&&("next"in(gs=[].keys())?(ps=ks(ks(gs)))!==Object.prototype&&(hs=ps):Rs=!0),(null==hs||Cs((function(){var e={};return hs[Ps].call(e)!==e})))&&(hs={}),Is(hs[Ps])||Os(hs,Ps,(function(){return this}));var xs={IteratorPrototype:hs,BUGGY_SAFARI_ITERATORS:Rs},Ds=It.f,Ls=Be,Ns=et("toStringTag"),Ms=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Ls(e,Ns)&&Ds(e,Ns,{configurable:!0,value:t})},Bs=xs.IteratorPrototype,Us=ss,js=_,Fs=Ms,Vs=ys,Gs=function(){return this},Hs=ri,Ks=f,zs=F,Ws=function(e,t,r,n){var i=t+" Iterator";return e.prototype=Us(Bs,{next:js(+!n,r)}),Fs(e,i,!1),Vs[i]=Gs,e},Ys=ws,Xs=so,Zs=Ms,qs=Yt,Qs=Qr,Js=ys,eu=tr.PROPER,tu=tr.CONFIGURABLE,ru=xs.IteratorPrototype,nu=xs.BUGGY_SAFARI_ITERATORS,iu=et("iterator"),ou="keys",au="values",su="entries",uu=function(){return this},cu=function(e,t,r,n,i,o,a){Ws(r,t,n);var s,u,c,l=function(e){if(e===i&&g)return g;if(!nu&&e in h)return h[e];switch(e){case ou:case au:case su:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[iu]||h["@@iterator"]||i&&h[i],g=!nu&&p||l(i),y="Array"==t&&h.entries||p;if(y&&(s=Ys(y.call(new e)))!==Object.prototype&&s.next&&(Ys(s)!==ru&&(Xs?Xs(s,ru):zs(s[iu])||Qs(s,iu,uu)),Zs(s,d,!0)),eu&&i==au&&p&&p.name!==au&&(tu?qs(h,"name",au):(f=!0,g=function(){return Ks(p,this)})),i)if(u={values:l(au),keys:o?g:l(ou),entries:l(su)},a)for(c in u)(nu||f||!(c in h))&&Qs(h,c,u[c]);else Hs({target:t,proto:!0,forced:nu||f},u);return h[iu]!==g&&Qs(h,iu,g,{name:i}),Js[t]=g,u},lu=j,du=function(e){fs[ds][e]=!0},fu=ys,hu=Lr,pu=It.f,gu=cu,yu=u,vu="Array Iterator",mu=hu.set,_u=hu.getterFor(vu),bu=gu(Array,"Array",(function(e,t){mu(this,{type:vu,target:lu(e),index:0,kind:t})}),(function(){var e=_u(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),Au=fu.Arguments=fu.Array;if(du("keys"),du("values"),du("entries"),yu&&"values"!==Au.name)try{pu(Au,"name",{value:"values"})}catch(error){}var Eu="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Su=Qr,Tu=Y,$u=o.TypeError,wu=function(e,t){if(Tu(t,e))return e;throw $u("Incorrect invocation")},Cu=nn,Iu=dn,ku=o.RangeError,Ou=function(e){if(void 0===e)return 0;var t=Cu(e),r=Iu(t);if(t!==r)throw ku("Wrong length or index");return r},Pu=o.Array,Ru=Math.abs,xu=Math.pow,Du=Math.floor,Lu=Math.log,Nu=Math.LN2,Mu={pack:function(e,t,r){var n,i,o,a=Pu(r),s=8*r-t-1,u=(1<<s)-1,c=u>>1,l=23===t?xu(2,-24)-xu(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=Ru(e))!=e||e===1/0?(i=e!=e?1:0,n=u):(n=Du(Lu(e)/Nu),e*(o=xu(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*xu(2,1-c))*o>=2&&(n++,o/=2),n+c>=u?(i=0,n=u):n+c>=1?(i=(e*o-1)*xu(2,t),n+=c):(i=e*xu(2,c-1)*xu(2,t),n=0));t>=8;)a[f++]=255&i,i/=256,t-=8;for(n=n<<t|i,s+=t;s>0;)a[f++]=255&n,n/=256,s-=8;return a[--f]|=128*d,a},unpack:function(e,t){var r,n=e.length,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=e[u--],l=127&c;for(c>>=7;s>0;)l=256*l+e[u--],s-=8;for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)r=256*r+e[u--],s-=8;if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-1/0:1/0;r+=xu(2,t),l-=a}return(c?-1:1)*r*xu(2,l-t)}},Bu=Le,Uu=un,ju=hn,Fu=function(e){for(var t=Bu(this),r=ju(t),n=arguments.length,i=Uu(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:Uu(o,r);a>i;)t[i++]=e;return t},Vu=ft,Gu=It,Hu=_,Ku=function(e,t,r){var n=Vu(t);n in e?Gu.f(e,n,Hu(0,r)):e[n]=r},zu=un,Wu=hn,Yu=Ku,Xu=o.Array,Zu=Math.max,qu=function(e,t,r){for(var n=Wu(e),i=zu(t,n),o=zu(void 0===r?n:r,n),a=Xu(Zu(o-i,0)),s=0;i<o;i++,s++)Yu(a,s,e[i]);return a.length=s,a},Qu=o,Ju=$,ec=u,tc=Eu,rc=tr,nc=Yt,ic=function(e,t,r){for(var n in t)Su(e,n,t[n],r);return e},oc=s,ac=wu,sc=nn,uc=dn,cc=Ou,lc=Mu,dc=ws,fc=so,hc=Jr.f,pc=It.f,gc=Fu,yc=qu,vc=Ms,mc=rc.PROPER,_c=rc.CONFIGURABLE,bc=Lr.get,Ac=Lr.set,Ec="ArrayBuffer",Sc="DataView",Tc="Wrong index",$c=Qu.ArrayBuffer,wc=$c,Cc=wc&&wc.prototype,Ic=Qu.DataView,kc=Ic&&Ic.prototype,Oc=Object.prototype,Pc=Qu.Array,Rc=Qu.RangeError,xc=Ju(gc),Dc=Ju([].reverse),Lc=lc.pack,Nc=lc.unpack,Mc=function(e){return[255&e]},Bc=function(e){return[255&e,e>>8&255]},Uc=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},jc=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Fc=function(e){return Lc(e,23,4)},Vc=function(e){return Lc(e,52,8)},Gc=function(e,t){pc(e.prototype,t,{get:function(){return bc(this)[t]}})},Hc=function(e,t,r,n){var i=cc(r),o=bc(e);if(i+t>o.byteLength)throw Rc(Tc);var a=bc(o.buffer).bytes,s=i+o.byteOffset,u=yc(a,s,s+t);return n?u:Dc(u)},Kc=function(e,t,r,n,i,o){var a=cc(r),s=bc(e);if(a+t>s.byteLength)throw Rc(Tc);for(var u=bc(s.buffer).bytes,c=a+s.byteOffset,l=n(+i),d=0;d<t;d++)u[c+d]=l[o?d:t-d-1]};if(tc){var zc=mc&&$c.name!==Ec;if(oc((function(){$c(1)}))&&oc((function(){new $c(-1)}))&&!oc((function(){return new $c,new $c(1.5),new $c(NaN),zc&&!_c})))zc&&_c&&nc($c,"name",Ec);else{(wc=function(e){return ac(this,Cc),new $c(cc(e))}).prototype=Cc;for(var Wc,Yc=hc($c),Xc=0;Yc.length>Xc;)(Wc=Yc[Xc++])in wc||nc(wc,Wc,$c[Wc]);Cc.constructor=wc}fc&&dc(kc)!==Oc&&fc(kc,Oc);var Zc=new Ic(new wc(2)),qc=Ju(kc.setInt8);Zc.setInt8(0,2147483648),Zc.setInt8(1,2147483649),!Zc.getInt8(0)&&Zc.getInt8(1)||ic(kc,{setInt8:function(e,t){qc(this,e,t<<24>>24)},setUint8:function(e,t){qc(this,e,t<<24>>24)}},{unsafe:!0})}else Cc=(wc=function(e){ac(this,Cc);var t=cc(e);Ac(this,{bytes:xc(Pc(t),0),byteLength:t}),ec||(this.byteLength=t)}).prototype,kc=(Ic=function(e,t,r){ac(this,kc),ac(e,Cc);var n=bc(e).byteLength,i=sc(t);if(i<0||i>n)throw Rc("Wrong offset");if(i+(r=void 0===r?n-i:uc(r))>n)throw Rc("Wrong length");Ac(this,{buffer:e,byteLength:r,byteOffset:i}),ec||(this.buffer=e,this.byteLength=r,this.byteOffset=i)}).prototype,ec&&(Gc(wc,"byteLength"),Gc(Ic,"buffer"),Gc(Ic,"byteLength"),Gc(Ic,"byteOffset")),ic(kc,{getInt8:function(e){return Hc(this,1,e)[0]<<24>>24},getUint8:function(e){return Hc(this,1,e)[0]},getInt16:function(e){var t=Hc(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Hc(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return jc(Hc(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return jc(Hc(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Nc(Hc(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Nc(Hc(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Kc(this,1,e,Mc,t)},setUint8:function(e,t){Kc(this,1,e,Mc,t)},setInt16:function(e,t){Kc(this,2,e,Bc,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Kc(this,2,e,Bc,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Kc(this,4,e,Uc,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Kc(this,4,e,Uc,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Kc(this,4,e,Fc,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Kc(this,8,e,Vc,t,arguments.length>2?arguments[2]:void 0)}});vc(wc,Ec),vc(Ic,Sc);var Qc={ArrayBuffer:wc,DataView:Ic},Jc=Ri,el=pe,tl=o.TypeError,rl=function(e){if(Jc(e))return e;throw tl(el(e)+" is not a constructor")},nl=Dt,il=rl,ol=et("species"),al=function(e,t){var r,n=nl(e).constructor;return void 0===n||null==(r=nl(n)[ol])?t:il(r)},sl=ri,ul=$,cl=s,ll=Dt,dl=un,fl=dn,hl=al,pl=Qc.ArrayBuffer,gl=Qc.DataView,yl=gl.prototype,vl=ul(pl.prototype.slice),ml=ul(yl.getUint8),_l=ul(yl.setUint8);sl({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:cl((function(){return!new pl(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(vl&&void 0===t)return vl(ll(this),e);for(var r=ll(this).byteLength,n=dl(e,r),i=dl(void 0===t?r:t,r),o=new(hl(this,pl))(fl(i-n)),a=new gl(this),s=new gl(o),u=0;n<i;)_l(s,u++,ml(a,n++));return o}});var bl={exports:{}},Al=et("iterator"),El=!1;try{var Sl=0,Tl={next:function(){return{done:!!Sl++}},return:function(){El=!0}};Tl[Al]=function(){return this},Array.from(Tl,(function(){throw 2}))}catch(error){}var $l,wl,Cl,Il=function(e,t){if(!t&&!El)return!1;var r=!1;try{var n={};n[Al]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(error){}return r},kl=Eu,Ol=u,Pl=o,Rl=F,xl=G,Dl=Be,Ll=mi,Nl=pe,Ml=Yt,Bl=Qr,Ul=It.f,jl=Y,Fl=ws,Vl=so,Gl=et,Hl=Ge,Kl=Pl.Int8Array,zl=Kl&&Kl.prototype,Wl=Pl.Uint8ClampedArray,Yl=Wl&&Wl.prototype,Xl=Kl&&Fl(Kl),Zl=zl&&Fl(zl),ql=Object.prototype,Ql=Pl.TypeError,Jl=Gl("toStringTag"),ed=Hl("TYPED_ARRAY_TAG"),td=Hl("TYPED_ARRAY_CONSTRUCTOR"),rd=kl&&!!Vl&&"Opera"!==Ll(Pl.opera),nd=!1,id={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},od={BigInt64Array:8,BigUint64Array:8},ad=function(e){if(!xl(e))return!1;var t=Ll(e);return Dl(id,t)||Dl(od,t)};for($l in id)(Cl=(wl=Pl[$l])&&wl.prototype)?Ml(Cl,td,wl):rd=!1;for($l in od)(Cl=(wl=Pl[$l])&&wl.prototype)&&Ml(Cl,td,wl);if((!rd||!Rl(Xl)||Xl===Function.prototype)&&(Xl=function(){throw Ql("Incorrect invocation")},rd))for($l in id)Pl[$l]&&Vl(Pl[$l],Xl);if((!rd||!Zl||Zl===ql)&&(Zl=Xl.prototype,rd))for($l in id)Pl[$l]&&Vl(Pl[$l].prototype,Zl);if(rd&&Fl(Yl)!==Zl&&Vl(Yl,Zl),Ol&&!Dl(Zl,Jl))for($l in nd=!0,Ul(Zl,Jl,{get:function(){return xl(this)?this[ed]:void 0}}),id)Pl[$l]&&Ml(Pl[$l],ed,$l);var sd={NATIVE_ARRAY_BUFFER_VIEWS:rd,TYPED_ARRAY_CONSTRUCTOR:td,TYPED_ARRAY_TAG:nd&&ed,aTypedArray:function(e){if(ad(e))return e;throw Ql("Target is not a typed array")},aTypedArrayConstructor:function(e){if(Rl(e)&&(!Vl||jl(Xl,e)))return e;throw Ql(Nl(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(Ol){if(r)for(var i in id){var o=Pl[i];if(o&&Dl(o.prototype,e))try{delete o.prototype[e]}catch(error){try{o.prototype[e]=t}catch(a){}}}Zl[e]&&!r||Bl(Zl,e,r?t:rd&&zl[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(Ol){if(Vl){if(r)for(n in id)if((i=Pl[n])&&Dl(i,e))try{delete i[e]}catch(error){}if(Xl[e]&&!r)return;try{return Bl(Xl,e,r?t:rd&&Xl[e]||t)}catch(error){}}for(n in id)!(i=Pl[n])||i[e]&&!r||Bl(i,e,t)}},isView:function(e){if(!xl(e))return!1;var t=Ll(e);return"DataView"===t||Dl(id,t)||Dl(od,t)},isTypedArray:ad,TypedArray:Xl,TypedArrayPrototype:Zl},ud=o,cd=s,ld=Il,dd=sd.NATIVE_ARRAY_BUFFER_VIEWS,fd=ud.ArrayBuffer,hd=ud.Int8Array,pd=!dd||!cd((function(){hd(1)}))||!cd((function(){new hd(-1)}))||!ld((function(e){new hd,new hd(null),new hd(1.5),new hd(e)}),!0)||cd((function(){return 1!==new hd(new fd(2),1,void 0).length})),gd=G,yd=Math.floor,vd=Number.isInteger||function(e){return!gd(e)&&isFinite(e)&&yd(e)===e},md=nn,_d=o.RangeError,bd=function(e){var t=md(e);if(t<0)throw _d("The argument can't be less than 0");return t},Ad=o.RangeError,Ed=function(e,t){var r=bd(e);if(r%t)throw Ad("Wrong offset");return r},Sd=mi,Td=be,$d=ys,wd=et("iterator"),Cd=function(e){if(null!=e)return Td(e,wd)||Td(e,"@@iterator")||$d[Sd(e)]},Id=f,kd=me,Od=Dt,Pd=pe,Rd=Cd,xd=o.TypeError,Dd=function(e,t){var r=arguments.length<2?Rd(e):t;if(kd(r))return Od(Id(r,e));throw xd(Pd(e)+" is not iterable")},Ld=ys,Nd=et("iterator"),Md=Array.prototype,Bd=function(e){return void 0!==e&&(Ld.Array===e||Md[Nd]===e)},Ud=ai,jd=f,Fd=rl,Vd=Le,Gd=hn,Hd=Dd,Kd=Cd,zd=Bd,Wd=sd.aTypedArrayConstructor,Yd=W,Xd=It,Zd=u,qd=et("species"),Qd=function(e){var t=Yd(e),r=Xd.f;Zd&&t&&!t[qd]&&r(t,qd,{configurable:!0,get:function(){return this}})},Jd=ri,ef=o,tf=f,rf=u,nf=pd,of=sd,af=Qc,sf=wu,uf=_,cf=Yt,lf=vd,df=dn,ff=Ou,hf=Ed,pf=ft,gf=Be,yf=mi,vf=G,mf=fe,_f=ss,bf=Y,Af=so,Ef=Jr.f,Sf=function(e){var t,r,n,i,o,a,s=Fd(this),u=Vd(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,f=Kd(u);if(f&&!zd(f))for(a=(o=Hd(u,f)).next,u=[];!(i=jd(a,o)).done;)u.push(i.value);for(d&&c>2&&(l=Ud(l,arguments[2])),r=Gd(u),n=new(Wd(s))(r),t=0;r>t;t++)n[t]=d?l(u[t],t):u[t];return n},Tf=Yi.forEach,$f=Qd,wf=It,Cf=a,If=fo,kf=Lr.get,Of=Lr.set,Pf=wf.f,Rf=Cf.f,xf=Math.round,Df=ef.RangeError,Lf=af.ArrayBuffer,Nf=Lf.prototype,Mf=af.DataView,Bf=of.NATIVE_ARRAY_BUFFER_VIEWS,Uf=of.TYPED_ARRAY_CONSTRUCTOR,jf=of.TYPED_ARRAY_TAG,Ff=of.TypedArray,Vf=of.TypedArrayPrototype,Gf=of.aTypedArrayConstructor,Hf=of.isTypedArray,Kf="BYTES_PER_ELEMENT",zf="Wrong length",Wf=function(e,t){Gf(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},Yf=function(e,t){Pf(e,t,{get:function(){return kf(this)[t]}})},Xf=function(e){var t;return bf(Nf,e)||"ArrayBuffer"==(t=yf(e))||"SharedArrayBuffer"==t},Zf=function(e,t){return Hf(e)&&!mf(t)&&t in e&&lf(+t)&&t>=0},qf=function(e,t){return t=pf(t),Zf(e,t)?uf(2,e[t]):Rf(e,t)},Qf=function(e,t,r){return t=pf(t),!(Zf(e,t)&&vf(r)&&gf(r,"value"))||gf(r,"get")||gf(r,"set")||r.configurable||gf(r,"writable")&&!r.writable||gf(r,"enumerable")&&!r.enumerable?Pf(e,t,r):(e[t]=r.value,e)};rf?(Bf||(Cf.f=qf,wf.f=Qf,Yf(Vf,"buffer"),Yf(Vf,"byteOffset"),Yf(Vf,"byteLength"),Yf(Vf,"length")),Jd({target:"Object",stat:!0,forced:!Bf},{getOwnPropertyDescriptor:qf,defineProperty:Qf}),bl.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",o="get"+e,a="set"+e,s=ef[i],u=s,c=u&&u.prototype,l={},d=function(e,t){Pf(e,t,{get:function(){return function(e,t){var r=kf(e);return r.view[o](t*n+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var o=kf(e);r&&(i=(i=xf(i))<0?0:i>255?255:255&i),o.view[a](t*n+o.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};Bf?nf&&(u=t((function(e,t,r,i){return sf(e,c),If(vf(t)?Xf(t)?void 0!==i?new s(t,hf(r,n),i):void 0!==r?new s(t,hf(r,n)):new s(t):Hf(t)?Wf(u,t):tf(Sf,u,t):new s(ff(t)),e,u)})),Af&&Af(u,Ff),Tf(Ef(s),(function(e){e in u||cf(u,e,s[e])})),u.prototype=c):(u=t((function(e,t,r,i){sf(e,c);var o,a,s,l=0,f=0;if(vf(t)){if(!Xf(t))return Hf(t)?Wf(u,t):tf(Sf,u,t);o=t,f=hf(r,n);var h=t.byteLength;if(void 0===i){if(h%n)throw Df(zf);if((a=h-f)<0)throw Df(zf)}else if((a=df(i)*n)+f>h)throw Df(zf);s=a/n}else s=ff(t),o=new Lf(a=s*n);for(Of(e,{buffer:o,byteOffset:f,byteLength:a,length:s,view:new Mf(o)});l<s;)d(e,l++)})),Af&&Af(u,Ff),c=u.prototype=_f(Vf)),c.constructor!==u&&cf(c,"constructor",u),cf(c,Uf,u),jf&&cf(c,jf,i);var f=u!=s;l[i]=u,Jd({global:!0,constructor:!0,forced:f,sham:!Bf},l),Kf in u||cf(u,Kf,n),Kf in c||cf(c,Kf,n),$f(i)}):bl.exports=function(){},(0,bl.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var Jf=Le,eh=un,th=hn,rh=Math.min,nh=[].copyWithin||function(e,t){var r=Jf(this),n=th(r),i=eh(e,n),o=eh(t,n),a=arguments.length>2?arguments[2]:void 0,s=rh((void 0===a?n:eh(a,n))-o,n-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in r?r[i]=r[o]:delete r[i],i+=u,o+=u;return r},ih=sd,oh=$(nh),ah=ih.aTypedArray;(0,ih.exportTypedArrayMethod)("copyWithin",(function(e,t){return oh(ah(this),e,t,arguments.length>2?arguments[2]:void 0)}));var sh=Yi.every,uh=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("every",(function(e){return sh(uh(this),e,arguments.length>1?arguments[1]:void 0)}));var ch=f,lh=Fu,dh=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return ch(lh,dh(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var fh=hn,hh=al,ph=sd.TYPED_ARRAY_CONSTRUCTOR,gh=sd.aTypedArrayConstructor,yh=function(e){return gh(hh(e,e[ph]))},vh=function(e,t){for(var r=0,n=fh(t),i=new e(n);n>r;)i[r]=t[r++];return i},mh=yh,_h=Yi.filter,bh=function(e,t){return vh(mh(e),t)},Ah=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("filter",(function(e){var t=_h(Ah(this),e,arguments.length>1?arguments[1]:void 0);return bh(this,t)}));var Eh=Yi.find,Sh=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("find",(function(e){return Eh(Sh(this),e,arguments.length>1?arguments[1]:void 0)}));var Th=Yi.findIndex,$h=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("findIndex",(function(e){return Th($h(this),e,arguments.length>1?arguments[1]:void 0)}));var wh=Yi.forEach,Ch=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("forEach",(function(e){wh(Ch(this),e,arguments.length>1?arguments[1]:void 0)}));var Ih=mn.includes,kh=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("includes",(function(e){return Ih(kh(this),e,arguments.length>1?arguments[1]:void 0)}));var Oh=mn.indexOf,Ph=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("indexOf",(function(e){return Oh(Ph(this),e,arguments.length>1?arguments[1]:void 0)}));var Rh=o,xh=s,Dh=$,Lh=sd,Nh=bu,Mh=et("iterator"),Bh=Rh.Uint8Array,Uh=Dh(Nh.values),jh=Dh(Nh.keys),Fh=Dh(Nh.entries),Vh=Lh.aTypedArray,Gh=Lh.exportTypedArrayMethod,Hh=Bh&&Bh.prototype,Kh=!xh((function(){Hh[Mh].call([1])})),zh=!!Hh&&Hh.values&&Hh[Mh]===Hh.values&&"values"===Hh.values.name,Wh=function(){return Uh(Vh(this))};Gh("entries",(function(){return Fh(Vh(this))}),Kh),Gh("keys",(function(){return jh(Vh(this))}),Kh),Gh("values",Wh,Kh||!zh,{name:"values"}),Gh(Mh,Wh,Kh||!zh,{name:"values"});var Yh=sd.aTypedArray,Xh=sd.exportTypedArrayMethod,Zh=$([].join);Xh("join",(function(e){return Zh(Yh(this),e)}));var qh=c,Qh=Function.prototype,Jh=Qh.apply,ep=Qh.call,tp="object"==("undefined"==typeof Reflect?"undefined":_typeof$3(Reflect))&&Reflect.apply||(qh?ep.bind(Jh):function(){return ep.apply(Jh,arguments)}),rp=tp,np=j,ip=nn,op=hn,ap=ma,sp=Math.min,up=[].lastIndexOf,cp=!!up&&1/[1].lastIndexOf(1,-0)<0,lp=ap("lastIndexOf"),dp=cp||!lp?function(e){if(cp)return rp(up,this,arguments)||0;var t=np(this),r=op(t),n=r-1;for(arguments.length>1&&(n=sp(n,ip(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:up,fp=tp,hp=dp,pp=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return fp(hp,pp(this),t>1?[e,arguments[1]]:[e])}));var gp=Yi.map,yp=yh,vp=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("map",(function(e){return gp(vp(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(yp(e))(t)}))}));var mp=me,_p=Le,bp=L,Ap=hn,Ep=o.TypeError,Sp=function(e){return function(t,r,n,i){mp(r);var o=_p(t),a=bp(o),s=Ap(o),u=e?s-1:0,c=e?-1:1;if(n<2)for(;;){if(u in a){i=a[u],u+=c;break}if(u+=c,e?u<0:s<=u)throw Ep("Reduce of empty array with no initial value")}for(;e?u>=0:s>u;u+=c)u in a&&(i=r(i,a[u],u,o));return i}},Tp={left:Sp(!1),right:Sp(!0)},$p=Tp.left,wp=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return $p(wp(this),e,t,t>1?arguments[1]:void 0)}));var Cp=Tp.right,Ip=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return Cp(Ip(this),e,t,t>1?arguments[1]:void 0)}));var kp=sd.aTypedArray,Op=sd.exportTypedArrayMethod,Pp=Math.floor;Op("reverse",(function(){for(var e,t=this,r=kp(t).length,n=Pp(r/2),i=0;i<n;)e=t[i],t[i++]=t[--r],t[r]=e;return t}));var Rp=o,xp=f,Dp=sd,Lp=hn,Np=Ed,Mp=Le,Bp=s,Up=Rp.RangeError,jp=Rp.Int8Array,Fp=jp&&jp.prototype,Vp=Fp&&Fp.set,Gp=Dp.aTypedArray,Hp=Dp.exportTypedArrayMethod,Kp=!Bp((function(){var e=new Uint8ClampedArray(2);return xp(Vp,e,{length:1,0:3},1),3!==e[1]})),zp=Kp&&Dp.NATIVE_ARRAY_BUFFER_VIEWS&&Bp((function(){var e=new jp(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));Hp("set",(function(e){Gp(this);var t=Np(arguments.length>1?arguments[1]:void 0,1),r=Mp(e);if(Kp)return xp(Vp,this,r,t);var n=this.length,i=Lp(r),o=0;if(i+t>n)throw Up("Wrong length");for(;o<i;)this[t+o]=r[o++]}),!Kp||zp);var Wp=$([].slice),Yp=yh,Xp=Wp,Zp=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("slice",(function(e,t){for(var r=Xp(Zp(this),e,t),n=Yp(this),i=0,o=r.length,a=new n(o);o>i;)a[i]=r[i++];return a}),s((function(){new Int8Array(1).slice()})));var qp=Yi.some,Qp=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("some",(function(e){return qp(Qp(this),e,arguments.length>1?arguments[1]:void 0)}));var Jp=qu,eg=Math.floor,tg=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},rg=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e},ng=function e(t,r){var n=t.length,i=eg(n/2);return n<8?tg(t,r):rg(t,e(Jp(t,0,i),r),e(Jp(t,i),r),r)},ig=X.match(/firefox\/(\d+)/i),og=!!ig&&+ig[1],ag=/MSIE|Trident/.test(X),sg=X.match(/AppleWebKit\/(\d+)\./),ug=!!sg&&+sg[1],cg=$,lg=s,dg=me,fg=ng,hg=og,pg=ag,gg=re,yg=ug,vg=sd.aTypedArray,mg=sd.exportTypedArrayMethod,_g=o.Uint16Array,bg=_g&&cg(_g.prototype.sort),Ag=!(!bg||lg((function(){bg(new _g(2),null)}))&&lg((function(){bg(new _g(2),{})}))),Eg=!!bg&&!lg((function(){if(gg)return gg<74;if(hg)return hg<67;if(pg)return!0;if(yg)return yg<602;var e,t,r=new _g(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(bg(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));mg("sort",(function(e){return void 0!==e&&dg(e),Eg?bg(this,e):fg(vg(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!Eg||Ag);var Sg=dn,Tg=un,$g=yh,wg=sd.aTypedArray;(0,sd.exportTypedArrayMethod)("subarray",(function(e,t){var r=wg(this),n=r.length,i=Tg(e,n);return new($g(r))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,Sg((void 0===t?n:Tg(t,n))-i))}));var Cg=tp,Ig=sd,kg=s,Og=Wp,Pg=o.Int8Array,Rg=Ig.aTypedArray,xg=Ig.exportTypedArrayMethod,Dg=[].toLocaleString,Lg=!!Pg&&kg((function(){Dg.call(new Pg(1))}));xg("toLocaleString",(function(){return Cg(Dg,Lg?Og(Rg(this)):Rg(this),Og(arguments))}),kg((function(){return[1,2].toLocaleString()!=new Pg([1,2]).toLocaleString()}))||!kg((function(){Pg.prototype.toLocaleString.call([1,2])})));var Ng=sd.exportTypedArrayMethod,Mg=s,Bg=$,Ug=o.Uint8Array,jg=Ug&&Ug.prototype||{},Fg=[].toString,Vg=Bg([].join);Mg((function(){Fg.call({})}))&&(Fg=function(){return Vg(this)});var Gg=jg.toString!=Fg;Ng("toString",Fg,Gg);var Hg=Xt.exports,Kg=It,zg=Dt,Wg=function(){var e=zg(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Yg=u,Xg=function(e,t,r){return r.get&&Hg(r.get,t,{getter:!0}),r.set&&Hg(r.set,t,{setter:!0}),Kg.f(e,t,r)},Zg=Wg,qg=s,Qg=RegExp.prototype;Yg&&qg((function(){return"sy"!==Object.getOwnPropertyDescriptor(Qg,"flags").get.call({dotAll:!0,sticky:!0})}))&&Xg(Qg,"flags",{configurable:!0,get:Zg}),ri({global:!0,constructor:!0,forced:!Eu},{DataView:Qc.DataView});var Jg=ri,ey=o,ty=ui,ry=Ri,ny=G,iy=un,oy=hn,ay=j,sy=Ku,uy=et,cy=Wp,ly=Qi("slice"),dy=uy("species"),fy=ey.Array,hy=Math.max;Jg({target:"Array",proto:!0,forced:!ly},{slice:function(e,t){var r,n,i,o=ay(this),a=oy(o),s=iy(e,a),u=iy(void 0===t?a:t,a);if(ty(o)&&(r=o.constructor,(ry(r)&&(r===fy||ty(r.prototype))||ny(r)&&null===(r=r[dy]))&&(r=void 0),r===fy||void 0===r))return cy(o,s,u);for(n=new(void 0===r?fy:r)(hy(u-s,0)),i=0;s<u;s++,i++)s in o&&sy(n,i,o[s]);return n.length=i,n}});var py=$,gy=Qr,yy=Date.prototype,vy="Invalid Date",my="toString",_y=py(yy.toString),by=py(yy.getTime);String(new Date(NaN))!=vy&&gy(yy,my,(function(){var e=by(this);return e==e?_y(this):vy}));var Ay=f,Ey=Be,Sy=Y,Ty=Wg,$y=RegExp.prototype,wy=tr.PROPER,Cy=Qr,Iy=Dt,ky=yo,Oy=s,Py=function(e){var t=e.flags;return void 0!==t||"flags"in $y||Ey(e,"flags")||!Sy($y,e)?t:Ay(Ty,e)},Ry="toString",xy=RegExp.prototype.toString,Dy=Oy((function(){return"/a/b"!=xy.call({source:"a",flags:"b"})})),Ly=wy&&xy.name!=Ry;(Dy||Ly)&&Cy(RegExp.prototype,Ry,(function(){var e=Iy(this);return"/"+ky(e.source)+"/"+ky(Py(e))}),{unsafe:!0});var Ny=$,My=me,By=G,Uy=Be,jy=Wp,Fy=c,Vy=o.Function,Gy=Ny([].concat),Hy=Ny([].join),Ky={},zy=function(e,t,r){if(!Uy(Ky,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";Ky[t]=Vy("C,a","return new C("+Hy(n,",")+")")}return Ky[t](e,r)},Wy=Fy?Vy.bind:function(e){var t=My(this),r=t.prototype,n=jy(arguments,1),i=function(){var r=Gy(n,jy(arguments));return this instanceof i?zy(t,r.length,r):t.apply(e,r)};return By(r)&&(i.prototype=r),i},Yy=ri,Xy=tp,Zy=Wy,qy=rl,Qy=Dt,Jy=G,ev=ss,tv=s,rv=W("Reflect","construct"),nv=Object.prototype,iv=[].push,ov=tv((function(){function e(){}return!(rv((function(){}),[],e)instanceof e)})),av=!tv((function(){rv((function(){}))})),sv=ov||av;function uv(e){return(uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cv(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uv(e)););return e}function lv(){return lv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=cv(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},lv.apply(this,arguments)}function dv(e,t){return(dv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function fv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dv(e,t)}function hv(e){return(hv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pv(e,t){if(t&&("object"===hv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function yv(e,t,r){return(yv=gv()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&dv(i,r.prototype),i}).apply(null,arguments)}function vv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _v(e,t,r){return t&&mv(e.prototype,t),r&&mv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}Yy({target:"Reflect",stat:!0,forced:sv,sham:sv},{construct:function(e,t){qy(e),Qy(t);var r=arguments.length<3?e:qy(arguments[2]);if(av&&!ov)return rv(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return Xy(iv,n,t),new(Xy(Zy,e,n))}var i=r.prototype,o=ev(Jy(i)?i:nv),a=Xy(e,o,t);return Jy(a)?a:o}});var bv=Qd,Av="ArrayBuffer",Ev=Qc.ArrayBuffer;ri({global:!0,constructor:!0,forced:o.ArrayBuffer!==Ev},{ArrayBuffer:Ev}),bv(Av),(0,bl.exports)("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0),(0,bl.exports)("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,bl.exports)("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var Sv=o,Tv=s,$v=$,wv=yo,Cv=$o.trim,Iv=vo,kv=Sv.parseInt,Ov=Sv.Symbol,Pv=Ov&&Ov.iterator,Rv=/^[+-]?0x/i,xv=$v(Rv.exec),Dv=8!==kv(Iv+"08")||22!==kv(Iv+"0x16")||Pv&&!Tv((function(){kv(Object(Pv))}))?function(e,t){var r=Cv(wv(e));return kv(r,t>>>0||(xv(Rv,r)?16:10))}:kv;ri({global:!0,forced:parseInt!=Dv},{parseInt:Dv});var Lv=ri,Nv=o,Mv=s,Bv=ui,Uv=G,jv=Le,Fv=hn,Vv=Ku,Gv=ji,Hv=Qi,Kv=re,zv=et("isConcatSpreadable"),Wv=9007199254740991,Yv="Maximum allowed index exceeded",Xv=Nv.TypeError,Zv=Kv>=51||!Mv((function(){var e=[];return e[zv]=!1,e.concat()[0]!==e})),qv=Hv("concat"),Qv=function(e){if(!Uv(e))return!1;var t=e[zv];return void 0!==t?!!t:Bv(e)};Lv({target:"Array",proto:!0,arity:1,forced:!Zv||!qv},{concat:function(e){var t,r,n,i,o,a=jv(this),s=Gv(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(Qv(o=-1===t?a:arguments[t])){if(u+(i=Fv(o))>Wv)throw Xv(Yv);for(r=0;r<i;r++,u++)r in o&&Vv(s,u,o[r])}else{if(u>=Wv)throw Xv(Yv);Vv(s,u++,o)}return s.length=u,s}});var Jv=ri,em=o,tm=un,rm=nn,nm=hn,im=Le,om=ji,am=Ku,sm=Qi("splice"),um=em.TypeError,cm=Math.max,lm=Math.min,dm=9007199254740991,fm="Maximum allowed length exceeded";function hm(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}Jv({target:"Array",proto:!0,forced:!sm},{splice:function(e,t){var r,n,i,o,a,s,u=im(this),c=nm(u),l=tm(e,c),d=arguments.length;if(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=lm(cm(rm(t),0),c-l)),c+r-n>dm)throw um(fm);for(i=om(u,n),o=0;o<n;o++)(a=l+o)in u&&am(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:delete u[s];for(o=c;o>c-n+r;o--)delete u[o-1]}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:delete u[s];for(o=0;o<r;o++)u[o+l]=arguments[o+2];return u.length=c-n+r,i}});var pm=function(){function e(){vv(this,e)}return _v(e,[{key:"mixIn",value:function(e){return Object.assign(this,e)}},{key:"clone",value:function(){var e=new this.constructor;return Object.assign(e,this),e}}],[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return yv(this,t)}}]),e}(),gm=function(e){fv(r,e);var t=hm(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4*n.length;vv(this,r),e=t.call(this);var o=n;if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),(o instanceof Int8Array||o instanceof Uint8ClampedArray||o instanceof Int16Array||o instanceof Uint16Array||o instanceof Int32Array||o instanceof Uint32Array||o instanceof Float32Array||o instanceof Float64Array)&&(o=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)),o instanceof Uint8Array){for(var a=o.byteLength,s=[],u=0;u<a;u+=1)s[u>>>2]|=o[u]<<24-u%4*8;e.words=s,e.sigBytes=a}else e.words=n,e.sigBytes=i;return e}return _v(r,[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ym;return e.stringify(this)}},{key:"concat",value:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o+=1){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(var s=0;s<i;s+=4)t[n+s>>>2]=r[s>>>2];return this.sigBytes+=i,this}},{key:"clamp",value:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}},{key:"clone",value:function(){var e=lv(uv(r.prototype),"clone",this).call(this);return e.words=this.words.slice(0),e}}],[{key:"random",value:function(e){for(var t,n=[],i=function(e){var t=e,r=987654321,n=4294967295;return function(){var e=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return e/=4294967296,(e+=.5)*(Math.random()>.5?1:-1)}},o=0;o<e;o+=4){var a=i(4294967296*(t||Math.random()));t=987654071*a(),n.push(4294967296*a()|0)}return new r(n,e)}}]),r}(pm),ym={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=1){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new gm(r,t/2)}},vm=function(e){for(var t=e.length,r=[],n=0;n<t;n+=1)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new gm(r,t)},mm=function(e){return vm(unescape(encodeURIComponent(e)))},_m=function(e){fv(r,e);var t=hm(r);function r(){var e;return vv(this,r),(e=t.call(this))._minBufferSize=0,e}return _v(r,[{key:"reset",value:function(){this._data=new gm,this._nDataBytes=0}},{key:"_append",value:function(e){var t=e;"string"==typeof t&&(t=mm(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}},{key:"_process",value:function(e){var t,r=this._data,n=this.blockSize,i=r.words,o=r.sigBytes,a=o/(4*n),s=(a=e?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0))*n,u=Math.min(4*s,o);if(s){for(var c=0;c<s;c+=n)this._doProcessBlock(i,c);t=i.splice(0,s),r.sigBytes-=u}return new gm(t,u)}},{key:"clone",value:function(){var e=lv(uv(r.prototype),"clone",this).call(this);return e._data=this._data.clone(),e}}]),r}(pm),bm=function(e){fv(r,e);var t=hm(r);function r(e){var n;return vv(this,r),(n=t.call(this)).blockSize=16,n.cfg=Object.assign(new pm,e),n.reset(),n}return _v(r,[{key:"reset",value:function(){lv(uv(r.prototype),"reset",this).call(this),this._doReset()}},{key:"update",value:function(e){return this._append(e),this._process(),this}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"_createHelper",value:function(e){return function(t,r){return new e(r).finalize(t)}}},{key:"_createHmacHelper",value:function(e){return function(t,r){return new Am(e,r).finalize(t)}}}]),r}(_m),Am=function(e){fv(r,e);var t=hm(r);function r(e,n){var i;vv(this,r),i=t.call(this);var o=new e;i._hasher=o;var a=n;"string"==typeof a&&(a=mm(a));var s=o.blockSize,u=4*s;a.sigBytes>u&&(a=o.finalize(n)),a.clamp();var c=a.clone();i._oKey=c;var l=a.clone();i._iKey=l;for(var d=c.words,f=l.words,h=0;h<s;h+=1)d[h]^=1549556828,f[h]^=909522486;return c.sigBytes=u,l.sigBytes=u,i.reset(),i}return _v(r,[{key:"reset",value:function(){var e=this._hasher;e.reset(),e.update(this._iKey)}},{key:"update",value:function(e){return this._hasher.update(e),this}},{key:"finalize",value:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}}]),r}(pm),Em=ri,Sm=mn.indexOf,Tm=ma,$m=$([].indexOf),wm=!!$m&&1/$m([1],1,-0)<0,Cm=Tm("indexOf");Em({target:"Array",proto:!0,forced:wm||!Cm},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return wm?$m(this,e,t)||0:Sm(this,e,t)}});var Im={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<r;s+=1)i.push(n.charAt(a>>>6*(3-s)&63));var u=n.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){this._reverseMap=[],n=this._reverseMap;for(var i=0;i<r.length;i+=1)n[r.charCodeAt(i)]=i}var o=r.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return function(e,t,r){for(var n=[],i=0,o=0;o<t;o+=1)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;n[i>>>2]|=a<<24-i%4*8,i+=1}return gm.create(n,i)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function km(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}for(var Om=[],Pm=0;Pm<64;Pm+=1)Om[Pm]=4294967296*Math.abs(Math.sin(Pm+1))|0;var Rm=function(e,t,r,n,i,o,a){var s=e+(t&r|~t&n)+i+a;return(s<<o|s>>>32-o)+t},xm=function(e,t,r,n,i,o,a){var s=e+(t&n|r&~n)+i+a;return(s<<o|s>>>32-o)+t},Dm=function(e,t,r,n,i,o,a){var s=e+(t^r^n)+i+a;return(s<<o|s>>>32-o)+t},Lm=function(e,t,r,n,i,o,a){var s=e+(r^(t|~n))+i+a;return(s<<o|s>>>32-o)+t},Nm=function(e){fv(r,e);var t=km(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,[{key:"_doReset",value:function(){this._hash=new gm([1732584193,4023233417,2562383102,271733878])}},{key:"_doProcessBlock",value:function(e,t){for(var r=e,n=0;n<16;n+=1){var i=t+n,o=e[i];r[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var a=this._hash.words,s=r[t+0],u=r[t+1],c=r[t+2],l=r[t+3],d=r[t+4],f=r[t+5],h=r[t+6],p=r[t+7],g=r[t+8],y=r[t+9],v=r[t+10],m=r[t+11],_=r[t+12],b=r[t+13],A=r[t+14],E=r[t+15],S=a[0],T=a[1],$=a[2],w=a[3];S=Rm(S,T,$,w,s,7,Om[0]),w=Rm(w,S,T,$,u,12,Om[1]),$=Rm($,w,S,T,c,17,Om[2]),T=Rm(T,$,w,S,l,22,Om[3]),S=Rm(S,T,$,w,d,7,Om[4]),w=Rm(w,S,T,$,f,12,Om[5]),$=Rm($,w,S,T,h,17,Om[6]),T=Rm(T,$,w,S,p,22,Om[7]),S=Rm(S,T,$,w,g,7,Om[8]),w=Rm(w,S,T,$,y,12,Om[9]),$=Rm($,w,S,T,v,17,Om[10]),T=Rm(T,$,w,S,m,22,Om[11]),S=Rm(S,T,$,w,_,7,Om[12]),w=Rm(w,S,T,$,b,12,Om[13]),$=Rm($,w,S,T,A,17,Om[14]),T=Rm(T,$,w,S,E,22,Om[15]),S=xm(S,T,$,w,u,5,Om[16]),w=xm(w,S,T,$,h,9,Om[17]),$=xm($,w,S,T,m,14,Om[18]),T=xm(T,$,w,S,s,20,Om[19]),S=xm(S,T,$,w,f,5,Om[20]),w=xm(w,S,T,$,v,9,Om[21]),$=xm($,w,S,T,E,14,Om[22]),T=xm(T,$,w,S,d,20,Om[23]),S=xm(S,T,$,w,y,5,Om[24]),w=xm(w,S,T,$,A,9,Om[25]),$=xm($,w,S,T,l,14,Om[26]),T=xm(T,$,w,S,g,20,Om[27]),S=xm(S,T,$,w,b,5,Om[28]),w=xm(w,S,T,$,c,9,Om[29]),$=xm($,w,S,T,p,14,Om[30]),T=xm(T,$,w,S,_,20,Om[31]),S=Dm(S,T,$,w,f,4,Om[32]),w=Dm(w,S,T,$,g,11,Om[33]),$=Dm($,w,S,T,m,16,Om[34]),T=Dm(T,$,w,S,A,23,Om[35]),S=Dm(S,T,$,w,u,4,Om[36]),w=Dm(w,S,T,$,d,11,Om[37]),$=Dm($,w,S,T,p,16,Om[38]),T=Dm(T,$,w,S,v,23,Om[39]),S=Dm(S,T,$,w,b,4,Om[40]),w=Dm(w,S,T,$,s,11,Om[41]),$=Dm($,w,S,T,l,16,Om[42]),T=Dm(T,$,w,S,h,23,Om[43]),S=Dm(S,T,$,w,y,4,Om[44]),w=Dm(w,S,T,$,_,11,Om[45]),$=Dm($,w,S,T,E,16,Om[46]),T=Dm(T,$,w,S,c,23,Om[47]),S=Lm(S,T,$,w,s,6,Om[48]),w=Lm(w,S,T,$,p,10,Om[49]),$=Lm($,w,S,T,A,15,Om[50]),T=Lm(T,$,w,S,f,21,Om[51]),S=Lm(S,T,$,w,_,6,Om[52]),w=Lm(w,S,T,$,l,10,Om[53]),$=Lm($,w,S,T,v,15,Om[54]),T=Lm(T,$,w,S,u,21,Om[55]),S=Lm(S,T,$,w,g,6,Om[56]),w=Lm(w,S,T,$,E,10,Om[57]),$=Lm($,w,S,T,h,15,Om[58]),T=Lm(T,$,w,S,b,21,Om[59]),S=Lm(S,T,$,w,d,6,Om[60]),w=Lm(w,S,T,$,m,10,Om[61]),$=Lm($,w,S,T,c,15,Om[62]),T=Lm(T,$,w,S,y,21,Om[63]),a[0]=a[0]+S|0,a[1]=a[1]+T|0,a[2]=a[2]+$|0,a[3]=a[3]+w|0}},{key:"_doFinalize",value:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;var i=Math.floor(r/4294967296),o=r;t[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t[14+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,s=a.words,u=0;u<4;u+=1){var c=s[u];s[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return a}},{key:"clone",value:function(){var e=lv(uv(r.prototype),"clone",this).call(this);return e._hash=this._hash.clone(),e}}]),r}(bm);function Mm(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}bm._createHelper(Nm),bm._createHmacHelper(Nm);var Bm=function(e){fv(r,e);var t=Mm(r);function r(e){var n;return vv(this,r),(n=t.call(this)).cfg=Object.assign(new pm,{keySize:4,hasher:Nm,iterations:1},e),n}return _v(r,[{key:"compute",value:function(e,t){for(var r,n=this.cfg,i=n.hasher.create(),o=gm.create(),a=o.words,s=n.keySize,u=n.iterations;a.length<s;){r&&i.update(r),r=i.update(e).finalize(t),i.reset();for(var c=1;c<u;c+=1)r=i.finalize(r),i.reset();o.concat(r)}return o.sigBytes=4*s,o}}]),r}(pm);function Um(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}var jm=function(e){fv(r,e);var t=Um(r);function r(e,n,i){var o;return vv(this,r),(o=t.call(this)).cfg=Object.assign(new pm,i),o._xformMode=e,o._key=n,o.reset(),o}return _v(r,[{key:"reset",value:function(){lv(uv(r.prototype),"reset",this).call(this),this._doReset()}},{key:"process",value:function(e){return this._append(e),this._process()}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"createEncryptor",value:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)}},{key:"createDecryptor",value:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)}},{key:"_createHelper",value:function(e){var t=function(e){return"string"==typeof e?Zm:Ym};return{encrypt:function(r,n,i){return t(n).encrypt(e,r,n,i)},decrypt:function(r,n,i){return t(n).decrypt(e,r,n,i)}}}}]),r}(_m);jm._ENC_XFORM_MODE=1,jm._DEC_XFORM_MODE=2,jm.keySize=4,jm.ivSize=4;var Fm=function(e){fv(r,e);var t=Um(r);function r(e,n){var i;return vv(this,r),(i=t.call(this))._cipher=e,i._iv=n,i}return _v(r,null,[{key:"createEncryptor",value:function(e,t){return this.Encryptor.create(e,t)}},{key:"createDecryptor",value:function(e,t){return this.Decryptor.create(e,t)}}]),r}(pm);function Vm(e,t,r){var n,i=e,o=this._iv;o?(n=o,this._iv=void 0):n=this._prevBlock;for(var a=0;a<r;a+=1)i[t+a]^=n[a]}var Gm=function(e){fv(r,e);var t=Um(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r)}(Fm);Gm.Encryptor=function(e){fv(r,e);var t=Um(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,[{key:"processBlock",value:function(e,t){var r=this._cipher,n=r.blockSize;Vm.call(this,e,t,n),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}]),r}(Gm),Gm.Decryptor=function(e){fv(r,e);var t=Um(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,[{key:"processBlock",value:function(e,t){var r=this._cipher,n=r.blockSize,i=e.slice(t,t+n);r.decryptBlock(e,t),Vm.call(this,e,t,n),this._prevBlock=i}}]),r}(Gm);var Hm={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,i=n<<24|n<<16|n<<8|n,o=[],a=0;a<n;a+=4)o.push(i);var s=gm.create(o,n);e.concat(s)},unpad:function(e){var t=e,r=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=r}},Km=function(e){fv(r,e);var t=Um(r);function r(e,n,i){var o;return vv(this,r),(o=t.call(this,e,n,Object.assign({mode:Gm,padding:Hm},i))).blockSize=4,o}return _v(r,[{key:"reset",value:function(){var e;lv(uv(r.prototype),"reset",this).call(this);var t=this.cfg,n=t.iv,i=t.mode;this._xformMode===this.constructor._ENC_XFORM_MODE?e=i.createEncryptor:(e=i.createDecryptor,this._minBufferSize=1),this._mode=e.call(i,this,n&&n.words),this._mode.__creator=e}},{key:"_doProcessBlock",value:function(e,t){this._mode.processBlock(e,t)}},{key:"_doFinalize",value:function(){var e,t=this.cfg.padding;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e}}]),r}(jm),zm=function(e){fv(r,e);var t=Um(r);function r(e){var n;return vv(this,r),(n=t.call(this)).mixIn(e),n}return _v(r,[{key:"toString",value:function(e){return(e||this.formatter).stringify(this)}}]),r}(pm),Wm={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?gm.create([1398893684,1701076831]).concat(r).concat(t):t).toString(Im)},parse:function(e){var t,r=Im.parse(e),n=r.words;return 1398893684===n[0]&&1701076831===n[1]&&(t=gm.create(n.slice(2,4)),n.splice(0,4),r.sigBytes-=16),zm.create({ciphertext:r,salt:t})}},Ym=function(e){fv(r,e);var t=Um(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,null,[{key:"encrypt",value:function(e,t,r,n){var i=Object.assign(new pm,this.cfg,n),o=e.createEncryptor(r,i),a=o.finalize(t),s=o.cfg;return zm.create({ciphertext:a,key:r,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:o.blockSize,formatter:i.format})}},{key:"decrypt",value:function(e,t,r,n){var i=t,o=Object.assign(new pm,this.cfg,n);return i=this._parse(i,o.format),e.createDecryptor(r,o).finalize(i.ciphertext)}},{key:"_parse",value:function(e,t){return"string"==typeof e?t.parse(e,this):e}}]),r}(pm);Ym.cfg=Object.assign(new pm,{format:Wm});var Xm={execute:function(e,t,r,n){var i=n;i||(i=gm.random(8));var o=Bm.create({keySize:t+r}).compute(e,i),a=gm.create(o.words.slice(t),4*r);return o.sigBytes=4*t,zm.create({key:o,iv:a,salt:i})}},Zm=function(e){fv(r,e);var t=Um(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,null,[{key:"encrypt",value:function(e,t,r,n){var i=Object.assign(new pm,this.cfg,n),o=i.kdf.execute(r,e.keySize,e.ivSize);i.iv=o.iv;var a=Ym.encrypt.call(this,e,t,o.key,i);return a.mixIn(o),a}},{key:"decrypt",value:function(e,t,r,n){var i=t,o=Object.assign(new pm,this.cfg,n);i=this._parse(i,o.format);var a=o.kdf.execute(r,e.keySize,e.ivSize,i.salt);return o.iv=a.iv,Ym.decrypt.call(this,e,i,a.key,o)}}]),r}(Ym);function qm(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}Zm.cfg=Object.assign(Ym.cfg,{kdf:Xm});for(var Qm=[],Jm=[],e_=[],t_=[],r_=[],n_=[],i_=[],o_=[],a_=[],s_=[],u_=[],c_=0;c_<256;c_+=1)u_[c_]=c_<128?c_<<1:c_<<1^283;for(var l_=0,d_=0,f_=0;f_<256;f_+=1){var h_=d_^d_<<1^d_<<2^d_<<3^d_<<4;h_=h_>>>8^255&h_^99,Qm[l_]=h_,Jm[h_]=l_;var p_=u_[l_],g_=u_[p_],y_=u_[g_],v_=257*u_[h_]^16843008*h_;e_[l_]=v_<<24|v_>>>8,t_[l_]=v_<<16|v_>>>16,r_[l_]=v_<<8|v_>>>24,n_[l_]=v_,v_=16843009*y_^65537*g_^257*p_^16843008*l_,i_[h_]=v_<<24|v_>>>8,o_[h_]=v_<<16|v_>>>16,a_[h_]=v_<<8|v_>>>24,s_[h_]=v_,l_?(l_=p_^u_[u_[u_[y_^p_]]],d_^=u_[u_[d_]]):l_=d_=1}var m_=[0,1,2,4,8,16,32,64,128,27,54],__=function(e){fv(r,e);var t=qm(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,[{key:"_doReset",value:function(){var e;if(!this._nRounds||this._keyPriorReset!==this._key){this._keyPriorReset=this._key;var t=this._keyPriorReset,r=t.words,n=t.sigBytes/4;this._nRounds=n+6;var i=4*(this._nRounds+1);this._keySchedule=[];for(var o=this._keySchedule,a=0;a<i;a+=1)a<n?o[a]=r[a]:(e=o[a-1],a%n?n>6&&a%n==4&&(e=Qm[e>>>24]<<24|Qm[e>>>16&255]<<16|Qm[e>>>8&255]<<8|Qm[255&e]):(e=Qm[(e=e<<8|e>>>24)>>>24]<<24|Qm[e>>>16&255]<<16|Qm[e>>>8&255]<<8|Qm[255&e],e^=m_[a/n|0]<<24),o[a]=o[a-n]^e);this._invKeySchedule=[];for(var s=this._invKeySchedule,u=0;u<i;u+=1){var c=i-u;e=u%4?o[c]:o[c-4],s[u]=u<4||c<=4?e:i_[Qm[e>>>24]]^o_[Qm[e>>>16&255]]^a_[Qm[e>>>8&255]]^s_[Qm[255&e]]}}}},{key:"encryptBlock",value:function(e,t){this._doCryptBlock(e,t,this._keySchedule,e_,t_,r_,n_,Qm)}},{key:"decryptBlock",value:function(e,t){var r=e,n=r[t+1];r[t+1]=r[t+3],r[t+3]=n,this._doCryptBlock(r,t,this._invKeySchedule,i_,o_,a_,s_,Jm),n=r[t+1],r[t+1]=r[t+3],r[t+3]=n}},{key:"_doCryptBlock",value:function(e,t,r,n,i,o,a,s){for(var u=e,c=this._nRounds,l=u[t]^r[0],d=u[t+1]^r[1],f=u[t+2]^r[2],h=u[t+3]^r[3],p=4,g=1;g<c;g+=1){var y=n[l>>>24]^i[d>>>16&255]^o[f>>>8&255]^a[255&h]^r[p];p+=1;var v=n[d>>>24]^i[f>>>16&255]^o[h>>>8&255]^a[255&l]^r[p];p+=1;var m=n[f>>>24]^i[h>>>16&255]^o[l>>>8&255]^a[255&d]^r[p];p+=1;var _=n[h>>>24]^i[l>>>16&255]^o[d>>>8&255]^a[255&f]^r[p];p+=1,l=y,d=v,f=m,h=_}var b=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[255&h])^r[p];p+=1;var A=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[h>>>8&255]<<8|s[255&l])^r[p];p+=1;var E=(s[f>>>24]<<24|s[h>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^r[p];p+=1;var S=(s[h>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&f])^r[p];p+=1,u[t]=b,u[t+1]=A,u[t+2]=E,u[t+3]=S}}]),r}(Km);__.keySize=8;var b_=Km._createHelper(__),A_=function(e){var t=ym.parse(e);return zm.create({ciphertext:t})};function E_(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=uv(t);if(r){var i=uv(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return pv(this,e)}}var S_=function(e){fv(r,e);var t=E_(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r)}(Fm);S_.Encryptor=function(e){fv(r,e);var t=E_(r);function r(){return vv(this,r),t.apply(this,arguments)}return _v(r,[{key:"processBlock",value:function(e,t){var r=e,n=this._cipher,i=n.blockSize,o=this._iv,a=this._counter;o&&(this._counter=o.slice(0),a=this._counter,this._iv=void 0);var s=a.slice(0);n.encryptBlock(s,0),a[i-1]=a[i-1]+1|0;for(var u=0;u<i;u+=1)r[t+u]^=s[u]}}]),r}(S_),S_.Decryptor=S_.Encryptor;var T_={pad:function(){},unpad:function(){}},$_=s,w_=o.RegExp,C_=$_((function(){var e=w_("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),I_=C_||$_((function(){return!w_("a","y").sticky})),k_=C_||$_((function(){var e=w_("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),O_={BROKEN_CARET:k_,MISSED_STICKY:I_,UNSUPPORTED_Y:C_},P_=s,R_=o.RegExp,x_=P_((function(){var e=R_(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),D_=s,L_=o.RegExp,N_=D_((function(){var e=L_("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),M_=f,B_=$,U_=yo,j_=Wg,F_=O_,V_=$e.exports,G_=ss,H_=Lr.get,K_=x_,z_=N_,W_=V_("native-string-replace",String.prototype.replace),Y_=RegExp.prototype.exec,X_=Y_,Z_=B_("".charAt),q_=B_("".indexOf),Q_=B_("".replace),J_=B_("".slice),eb=function(){var e=/a/,t=/b*/g;return M_(Y_,e,"a"),M_(Y_,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),tb=F_.BROKEN_CARET,rb=void 0!==/()??/.exec("")[1];(eb||rb||tb||K_||z_)&&(X_=function(e){var t,r,n,i,o,a,s,u=this,c=H_(u),l=U_(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=M_(X_,d,l),u.lastIndex=d.lastIndex,t;var f=c.groups,h=tb&&u.sticky,p=M_(j_,u),g=u.source,y=0,v=l;if(h&&(p=Q_(p,"y",""),-1===q_(p,"g")&&(p+="g"),v=J_(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==Z_(l,u.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",p)),rb&&(r=new RegExp("^"+g+"$(?!\\s)",p)),eb&&(n=u.lastIndex),i=M_(Y_,h?r:u,v),h?i?(i.input=J_(i.input,y),i[0]=J_(i[0],y),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:eb&&i&&(u.lastIndex=u.global?i.index+i[0].length:n),rb&&i&&i.length>1&&M_(W_,i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&f)for(i.groups=a=G_(null),o=0;o<f.length;o++)a[(s=f[o])[0]]=i[s[1]];return i});var nb=X_;ri({target:"RegExp",proto:!0,forced:/./.exec!==nb},{exec:nb});var ib=$,ob=Qr,ab=nb,sb=s,ub=et,cb=Yt,lb=ub("species"),db=RegExp.prototype,fb=function(e,t,r,n){var i=ub(e),o=!sb((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!sb((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[lb]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return t=!0,null},r[i](""),!t}));if(!o||!a||r){var s=ib(/./[i]),u=t(i,""[e],(function(e,t,r,n,i){var a=ib(e),u=t.exec;return u===ab||u===db.exec?o&&!i?{done:!0,value:s(t,r,n)}:{done:!0,value:a(r,t,n)}:{done:!1}}));ob(String.prototype,e,u[0]),ob(db,i,u[1])}n&&cb(db[i],"sham",!0)},hb=$,pb=nn,gb=yo,yb=M,vb=hb("".charAt),mb=hb("".charCodeAt),_b=hb("".slice),bb=function(e){return function(t,r){var n,i,o=gb(yb(t)),a=pb(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=mb(o,a))<55296||n>56319||a+1===s||(i=mb(o,a+1))<56320||i>57343?e?vb(o,a):n:e?_b(o,a,a+2):i-56320+(n-55296<<10)+65536}},Ab={codeAt:bb(!1),charAt:bb(!0)},Eb=Ab.charAt,Sb=function(e,t,r){return t+(r?Eb(e,t).length:1)},Tb=$,$b=Le,wb=Math.floor,Cb=Tb("".charAt),Ib=Tb("".replace),kb=Tb("".slice),Ob=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Pb=/\$([$&'`]|\d{1,2})/g,Rb=f,xb=Dt,Db=F,Lb=k,Nb=nb,Mb=o.TypeError,Bb=function(e,t){var r=e.exec;if(Db(r)){var n=Rb(r,e,t);return null!==n&&xb(n),n}if("RegExp"===Lb(e))return Rb(Nb,e,t);throw Mb("RegExp#exec called on incompatible receiver")},Ub=tp,jb=f,Fb=$,Vb=fb,Gb=s,Hb=Dt,Kb=F,zb=nn,Wb=dn,Yb=yo,Xb=M,Zb=Sb,qb=be,Qb=function(e,t,r,n,i,o){var a=r+e.length,s=n.length,u=Pb;return void 0!==i&&(i=$b(i),u=Ob),Ib(o,u,(function(o,u){var c;switch(Cb(u,0)){case"$":return"$";case"&":return e;case"`":return kb(t,0,r);case"'":return kb(t,a);case"<":c=i[kb(u,1,-1)];break;default:var l=+u;if(0===l)return o;if(l>s){var d=wb(l/10);return 0===d?o:d<=s?void 0===n[d-1]?Cb(u,1):n[d-1]+Cb(u,1):o}c=n[l-1]}return void 0===c?"":c}))},Jb=Bb,eA=et("replace"),tA=Math.max,rA=Math.min,nA=Fb([].concat),iA=Fb([].push),oA=Fb("".indexOf),aA=Fb("".slice),sA="$0"==="a".replace(/./,"$0"),uA=!!/./[eA]&&""===/./[eA]("a","$0"),cA=!Gb((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));Vb("replace",(function(e,t,r){var n=uA?"$":"$0";return[function(e,r){var n=Xb(this),i=null==e?void 0:qb(e,eA);return i?jb(i,e,n,r):jb(t,Yb(n),e,r)},function(e,i){var o=Hb(this),a=Yb(e);if("string"==typeof i&&-1===oA(i,n)&&-1===oA(i,"$<")){var s=r(t,o,a,i);if(s.done)return s.value}var u=Kb(i);u||(i=Yb(i));var c=o.global;if(c){var l=o.unicode;o.lastIndex=0}for(var d=[];;){var f=Jb(o,a);if(null===f)break;if(iA(d,f),!c)break;""===Yb(f[0])&&(o.lastIndex=Zb(a,Wb(o.lastIndex),l))}for(var h,p="",g=0,y=0;y<d.length;y++){for(var v=Yb((f=d[y])[0]),m=tA(rA(zb(f.index),a.length),0),_=[],b=1;b<f.length;b++)iA(_,void 0===(h=f[b])?h:String(h));var A=f.groups;if(u){var E=nA([v],_,m,a);void 0!==A&&iA(E,A);var S=Yb(Ub(i,void 0,E))}else S=Qb(v,a,m,_,A,i);m>=g&&(p+=aA(a,g,m)+S,g=m+v.length)}return p+aA(a,g)}]}),!cA||!sA||uA);var lA=Yi.filter;ri({target:"Array",proto:!0,forced:!Qi("filter")},{filter:function(e){return lA(this,e,arguments.length>1?arguments[1]:void 0)}});var dA=o,fA=s,hA=yo,pA=$o.trim,gA=$("".charAt),yA=dA.parseFloat,vA=dA.Symbol,mA=vA&&vA.iterator,_A=1/yA("\t\n\v\f\r                　\u2028\u2029\ufeff-0")!=-1/0||mA&&!fA((function(){yA(Object(mA))}))?function(e){var t=pA(hA(e)),r=yA(t);return 0===r&&"-"==gA(t,0)?-0:r}:yA;ri({global:!0,forced:parseFloat!=_A},{parseFloat:_A});var bA=nn,AA=yo,EA=M,SA=o.RangeError,TA=ri,$A=o,wA=$,CA=nn,IA=ho,kA=function(e){var t=AA(EA(this)),r="",n=bA(e);if(n<0||n==1/0)throw SA("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},OA=s,PA=$A.RangeError,RA=$A.String,xA=Math.floor,DA=wA(kA),LA=wA("".slice),NA=wA(1..toFixed),MA=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)},BA=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=xA(i/1e7)},UA=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=xA(n/t),n=n%t*1e7},jA=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=RA(e[t]);r=""===r?n:r+DA("0",7-n.length)+n}return r};TA({target:"Number",proto:!0,forced:OA((function(){return"0.000"!==NA(8e-5,3)||"1"!==NA(.9,0)||"1.25"!==NA(1.255,2)||"1000000000000000128"!==NA(0xde0b6b3a7640080,0)}))||!OA((function(){NA({})}))},{toFixed:function(e){var t,r,n,i,o=IA(this),a=CA(e),s=[0,0,0,0,0,0],u="",c="0";if(a<0||a>20)throw PA("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return RA(o);if(o<0&&(u="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*MA(2,69,1))-69)<0?o*MA(2,-t,1):o/MA(2,t,1),r*=4503599627370496,(t=52-t)>0){for(BA(s,0,r),n=a;n>=7;)BA(s,1e7,0),n-=7;for(BA(s,MA(10,n,1),0),n=t-1;n>=23;)UA(s,1<<23),n-=23;UA(s,1<<n),BA(s,1,1),UA(s,2),c=jA(s)}else BA(s,0,r),BA(s,1<<-t,0),c=jA(s)+DA("0",a);return c=a>0?u+((i=c.length)<=a?"0."+DA("0",a-i)+c:LA(c,0,i-a)+"."+LA(c,i-a)):u+c}});var FA,VA,GA,HA,KA="process"==k(o.process),zA=o.TypeError,WA=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),YA=o,XA=tp,ZA=ai,qA=F,QA=Be,JA=s,eE=Xa,tE=Wp,rE=yt,nE=function(e,t){if(e<t)throw zA("Not enough arguments");return e},iE=WA,oE=KA,aE=YA.setImmediate,sE=YA.clearImmediate,uE=YA.process,cE=YA.Dispatch,lE=YA.Function,dE=YA.MessageChannel,fE=YA.String,hE=0,pE={},gE="onreadystatechange";try{FA=YA.location}catch(error){}var yE=function(e){if(QA(pE,e)){var t=pE[e];delete pE[e],t()}},vE=function(e){return function(){yE(e)}},mE=function(e){yE(e.data)},_E=function(e){YA.postMessage(fE(e),FA.protocol+"//"+FA.host)};aE&&sE||(aE=function(e){nE(arguments.length,1);var t=qA(e)?e:lE(e),r=tE(arguments,1);return pE[++hE]=function(){XA(t,void 0,r)},VA(hE),hE},sE=function(e){delete pE[e]},oE?VA=function(e){uE.nextTick(vE(e))}:cE&&cE.now?VA=function(e){cE.now(vE(e))}:dE&&!iE?(HA=(GA=new dE).port2,GA.port1.onmessage=mE,VA=ZA(HA.postMessage,HA)):YA.addEventListener&&qA(YA.postMessage)&&!YA.importScripts&&FA&&"file:"!==FA.protocol&&!JA(_E)?(VA=_E,YA.addEventListener("message",mE,!1)):VA=gE in rE("script")?function(e){eE.appendChild(rE("script")).onreadystatechange=function(){eE.removeChild(this),yE(e)}}:function(e){setTimeout(vE(e),0)});var bE,AE,EE,SE,TE,$E,wE,CE,IE={set:aE,clear:sE},kE=o,OE=/ipad|iphone|ipod/i.test(X)&&void 0!==kE.Pebble,PE=/web0s(?!.*chrome)/i.test(X),RE=o,xE=ai,DE=a.f,LE=IE.set,NE=WA,ME=OE,BE=PE,UE=KA,jE=RE.MutationObserver||RE.WebKitMutationObserver,FE=RE.document,VE=RE.process,GE=RE.Promise,HE=DE(RE,"queueMicrotask"),KE=HE&&HE.value;KE||(bE=function(){var e,t;for(UE&&(e=VE.domain)&&e.exit();AE;){t=AE.fn,AE=AE.next;try{t()}catch(error){throw AE?SE():EE=void 0,error}}EE=void 0,e&&e.enter()},NE||UE||BE||!jE||!FE?!ME&&GE&&GE.resolve?((wE=GE.resolve(void 0)).constructor=GE,CE=xE(wE.then,wE),SE=function(){CE(bE)}):UE?SE=function(){VE.nextTick(bE)}:(LE=xE(LE,RE),SE=function(){LE(bE)}):(TE=!0,$E=FE.createTextNode(""),new jE(bE).observe($E,{characterData:!0}),SE=function(){$E.data=TE=!TE}));var zE=KE||function(e){var t={fn:e,next:void 0};EE&&(EE.next=t),AE||(AE=t,SE()),EE=t},WE=o,YE=function(e){try{return{error:!1,value:e()}}catch(error){return{error:!0,value:error}}},XE=function(){this.head=null,this.tail=null};XE.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var ZE=XE,qE=o.Promise,QE="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&"object"!=("undefined"==typeof Deno?"undefined":_typeof$3(Deno)),JE=o,eS=qE,tS=F,rS=Yn,nS=ur,iS=et,oS=QE,aS=re;eS&&eS.prototype;var sS=iS("species"),uS=!1,cS=tS(JE.PromiseRejectionEvent),lS={CONSTRUCTOR:rS("Promise",(function(){var e=nS(eS),t=e!==String(eS);if(!t&&66===aS)return!0;if(aS>=51&&/native code/.test(e))return!1;var r=new eS((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[sS]=n,!(uS=r.then((function(){}))instanceof n)||!t&&oS&&!cS})),REJECTION_EVENT:cS,SUBCLASSING:uS},dS={},fS=me,hS=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=fS(t),this.reject=fS(r)};dS.f=function(e){return new hS(e)};var pS,gS,yS,vS=ri,mS=KA,_S=o,bS=f,AS=Qr,ES=so,SS=Ms,TS=Qd,$S=me,wS=F,CS=G,IS=wu,kS=al,OS=IE.set,PS=zE,RS=function(e,t){var r=WE.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},xS=YE,DS=ZE,LS=Lr,NS=qE,MS=dS,BS="Promise",US=lS.CONSTRUCTOR,jS=lS.REJECTION_EVENT,FS=lS.SUBCLASSING,VS=LS.getterFor(BS),GS=LS.set,HS=NS&&NS.prototype,KS=NS,zS=HS,WS=_S.TypeError,YS=_S.document,XS=_S.process,ZS=MS.f,qS=ZS,QS=!!(YS&&YS.createEvent&&_S.dispatchEvent),JS="unhandledrejection",eT=function(e){var t;return!(!CS(e)||!wS(t=e.then))&&t},tT=function(e,t){var r,n,i,o=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&aT(t),t.rejection=1),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(WS("Promise-chain cycle")):(n=eT(r))?bS(n,r,u,c):u(r)):c(o)}catch(error){l&&!i&&l.exit(),c(error)}},rT=function(e,t){e.notified||(e.notified=!0,PS((function(){for(var r,n=e.reactions;r=n.get();)tT(r,e);e.notified=!1,t&&!e.rejection&&iT(e)})))},nT=function(e,t,r){var n,i;QS?((n=YS.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),_S.dispatchEvent(n)):n={promise:t,reason:r},!jS&&(i=_S["on"+e])?i(n):e===JS&&RS("Unhandled promise rejection",r)},iT=function(e){bS(OS,_S,(function(){var t,r=e.facade,n=e.value;if(oT(e)&&(t=xS((function(){mS?XS.emit("unhandledRejection",n,r):nT(JS,r,n)})),e.rejection=mS||oT(e)?2:1,t.error))throw t.value}))},oT=function(e){return 1!==e.rejection&&!e.parent},aT=function(e){bS(OS,_S,(function(){var t=e.facade;mS?XS.emit("rejectionHandled",t):nT("rejectionhandled",t,e.value)}))},sT=function(e,t,r){return function(n){e(t,n,r)}},uT=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,rT(e,!0))},cT=function e(t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===r)throw WS("Promise can't be resolved itself");var i=eT(r);i?PS((function(){var n={done:!1};try{bS(i,r,sT(e,n,t),sT(uT,n,t))}catch(error){uT(n,error,t)}})):(t.value=r,t.state=1,rT(t,!1))}catch(error){uT({done:!1},error,t)}}};if(US&&(zS=(KS=function(e){IS(this,zS),$S(e),bS(pS,this);var t=VS(this);try{e(sT(cT,t),sT(uT,t))}catch(error){uT(t,error)}}).prototype,(pS=function(e){GS(this,{type:BS,done:!1,notified:!1,parent:!1,reactions:new DS,rejection:!1,state:0,value:void 0})}).prototype=AS(zS,"then",(function(e,t){var r=VS(this),n=ZS(kS(this,KS));return r.parent=!0,n.ok=!wS(e)||e,n.fail=wS(t)&&t,n.domain=mS?XS.domain:void 0,0==r.state?r.reactions.add(n):PS((function(){tT(n,r)})),n.promise})),gS=function(){var e=new pS,t=VS(e);this.promise=e,this.resolve=sT(cT,t),this.reject=sT(uT,t)},MS.f=ZS=function(e){return e===KS||undefined===e?new gS(e):qS(e)},wS(NS)&&HS!==Object.prototype)){yS=HS.then,FS||AS(HS,"then",(function(e,t){var r=this;return new KS((function(e,t){bS(yS,r,e,t)})).then(e,t)}),{unsafe:!0});try{delete HS.constructor}catch(error){}ES&&ES(HS,zS)}vS({global:!0,constructor:!0,wrap:!0,forced:US},{Promise:KS}),SS(KS,BS,!1),TS(BS);var lT=f,dT=Dt,fT=be,hT=ai,pT=f,gT=Dt,yT=pe,vT=Bd,mT=hn,_T=Y,bT=Dd,AT=Cd,ET=function(e,t,r){var n,i;dT(e);try{if(!(n=fT(e,"return"))){if("throw"===t)throw r;return r}n=lT(n,e)}catch(error){i=!0,n=error}if("throw"===t)throw r;if(i)throw n;return dT(n),r},ST=o.TypeError,TT=function(e,t){this.stopped=e,this.result=t},$T=TT.prototype,wT=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),p=hT(t,l),g=function(e){return n&&ET(n,"normal",e),new TT(!0,e)},y=function(e){return d?(gT(e),h?p(e[0],e[1],g):p(e[0],e[1])):h?p(e,g):p(e)};if(f)n=e;else{if(!(i=AT(e)))throw ST(yT(e)+" is not iterable");if(vT(i)){for(o=0,a=mT(e);a>o;o++)if((s=y(e[o]))&&_T($T,s))return s;return new TT(!1)}n=bT(e,i)}for(u=n.next;!(c=pT(u,n)).done;){try{s=y(c.value)}catch(error){ET(n,"throw",error)}if("object"==_typeof$3(s)&&s&&_T($T,s))return s}return new TT(!1)},CT=qE,IT=lS.CONSTRUCTOR||!Il((function(e){CT.all(e).then(void 0,(function(){}))})),kT=f,OT=me,PT=dS,RT=YE,xT=wT;ri({target:"Promise",stat:!0,forced:IT},{all:function(e){var t=this,r=PT.f(t),n=r.resolve,i=r.reject,o=RT((function(){var r=OT(t.resolve),o=[],a=0,s=1;xT(e,(function(e){var u=a++,c=!1;s++,kT(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise}});var DT=ri,LT=lS.CONSTRUCTOR,NT=qE,MT=W,BT=F,UT=Qr,jT=NT&&NT.prototype;if(DT({target:"Promise",proto:!0,forced:LT,real:!0},{catch:function(e){return this.then(void 0,e)}}),BT(NT)){var FT=MT("Promise").prototype.catch;jT.catch!==FT&&UT(jT,"catch",FT,{unsafe:!0})}var VT=f,GT=me,HT=dS,KT=YE,zT=wT;ri({target:"Promise",stat:!0,forced:IT},{race:function(e){var t=this,r=HT.f(t),n=r.reject,i=KT((function(){var i=GT(t.resolve);zT(e,(function(e){VT(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var WT=f,YT=dS;ri({target:"Promise",stat:!0,forced:lS.CONSTRUCTOR},{reject:function(e){var t=YT.f(this);return WT(t.reject,void 0,e),t.promise}});var XT=Dt,ZT=G,qT=dS,QT=function(e,t){if(XT(e),ZT(t)&&t.constructor===e)return t;var r=qT.f(e);return(0,r.resolve)(t),r.promise},JT=ri,e$=lS.CONSTRUCTOR,t$=QT;W("Promise"),JT({target:"Promise",stat:!0,forced:e$},{resolve:function(e){return t$(this,e)}});var r$=ri,n$=qE,i$=s,o$=W,a$=F,s$=al,u$=QT,c$=Qr,l$=n$&&n$.prototype;if(r$({target:"Promise",proto:!0,real:!0,forced:!!n$&&i$((function(){l$.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=s$(this,o$("Promise")),r=a$(e);return this.then(r?function(r){return u$(t,e()).then((function(){return r}))}:e,r?function(r){return u$(t,e()).then((function(){throw r}))}:e)}}),a$(n$)){var d$=o$("Promise").prototype.finally;l$.finally!==d$&&c$(l$,"finally",d$,{unsafe:!0})}var f$=Le,h$=ra;ri({target:"Object",stat:!0,forced:s((function(){h$(1)}))},{keys:function(e){return h$(f$(e))}});var p$=G,g$=k,y$=et("match"),v$=tp,m$=f,_$=$,b$=fb,A$=function(e){var t;return p$(e)&&(void 0!==(t=e[y$])?!!t:"RegExp"==g$(e))},E$=Dt,S$=M,T$=al,$$=Sb,w$=dn,C$=yo,I$=be,k$=qu,O$=Bb,P$=nb,R$=s,x$=O_.UNSUPPORTED_Y,D$=4294967295,L$=Math.min,N$=[].push,M$=_$(/./.exec),B$=_$(N$),U$=_$("".slice),j$=!R$((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));b$("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=C$(S$(this)),i=void 0===r?D$:r>>>0;if(0===i)return[];if(void 0===e)return[n];if(!A$(e))return m$(t,n,e,i);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(o=m$(P$,d,n))&&!((a=d.lastIndex)>l&&(B$(u,U$(n,l,o.index)),o.length>1&&o.index<n.length&&v$(N$,u,k$(o,1)),s=o[0].length,l=a,u.length>=i));)d.lastIndex===o.index&&d.lastIndex++;return l===n.length?!s&&M$(d,"")||B$(u,""):B$(u,U$(n,l)),u.length>i?k$(u,0,i):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:m$(t,this,e,r)}:t,[function(t,r){var i=S$(this),o=null==t?void 0:I$(t,e);return o?m$(o,t,i,r):m$(n,C$(i),t,r)},function(e,i){var o=E$(this),a=C$(e),s=r(n,o,a,i,n!==t);if(s.done)return s.value;var u=T$(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(x$?"g":"y"),d=new u(x$?"^(?:"+o.source+")":o,l),f=void 0===i?D$:i>>>0;if(0===f)return[];if(0===a.length)return null===O$(d,a)?[a]:[];for(var h=0,p=0,g=[];p<a.length;){d.lastIndex=x$?0:p;var y,v=O$(d,x$?U$(a,p):a);if(null===v||(y=L$(w$(d.lastIndex+(x$?p:0)),a.length))===h)p=$$(a,p,c);else{if(B$(g,U$(a,h,p)),g.length===f)return g;for(var m=1;m<=v.length-1;m++)if(B$(g,v[m]),g.length===f)return g;p=h=y}}return B$(g,U$(a,h)),g}]}),!j$,x$);var F$=Tp.left,V$=re,G$=KA;ri({target:"Array",proto:!0,forced:!ma("reduce")||!G$&&V$>79&&V$<83},{reduce:function(e){var t=arguments.length;return F$(this,e,t,t>1?arguments[1]:void 0)}});var H$=f,K$=Dt,z$=dn,W$=yo,Y$=M,X$=be,Z$=Sb,q$=Bb;fb("match",(function(e,t,r){return[function(t){var r=Y$(this),n=null==t?void 0:X$(t,e);return n?H$(n,t,r):new RegExp(t)[e](W$(r))},function(e){var n=K$(this),i=W$(e),o=r(t,n,i);if(o.done)return o.value;if(!n.global)return q$(n,i);var a=n.unicode;n.lastIndex=0;for(var s,u=[],c=0;null!==(s=q$(n,i));){var l=W$(s[0]);u[c]=l,""===l&&(n.lastIndex=Z$(i,z$(n.lastIndex),a)),c++}return 0===c?null:u}]}));var Q$=tr.PROPER,J$=s,ew=vo,tw=$o.trim;ri({target:"String",proto:!0,forced:function(e){return J$((function(){return!!ew[e]()||"​᠎"!=="​᠎"[e]()||Q$&&ew[e].name!==e}))}("trim")},{trim:function(){return tw(this)}});var rw={ArrayBufferToString:function(e){for(var t="",r=new Uint8Array(e),n=0;n<r.length;n++)t+=String.fromCharCode(r[n]);return t},StringToArrayBuffer:function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},Base64ToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));if(t){for(var n=[],i=0;i<r.length;i++)n.push(r.charCodeAt(i));return new Uint8Array(n).buffer}for(var o="",a=0;a<r.length;a++)o+=("0"+r.charCodeAt(a).toString(16)).substr(-2);return o},HexToBase64:function(e){for(var t="",r=0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return window.btoa(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},findBox:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.type!==t){if(e&&e.subBox){var n=e.subBox.filter((function(e){return e.type===t}));n.length?n.forEach((function(e){return r.push(e)})):e.subBox.forEach((function(e){return rw.findBox(e,t,r)}))}}else r.push(e);return(r=[].concat(r)).length>1?r:r[0]},padStart:function(e,t,r){for(var n=String(r),i=t>>0,o=Math.ceil(i/n.length),a=[],s=String(e);o--;)a.push(n);return a.join("").substring(0,i-s.length)+s},durationConvert:function(e){var t=0,r=0,n=0;return(e=e.slice(e.indexOf("PT")+2)).indexOf("H")>-1&&e.indexOf("M")>-1&&e.indexOf("S")>-1?(t=parseFloat(e.slice(0,e.indexOf("H"))),r=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("M"))),n=parseFloat(e.slice(e.indexOf("M")+1,e.indexOf("S")))):e.indexOf("H")>-1&&e.indexOf("M")>-1&&e.indexOf("S")<0?(t=parseFloat(e.slice(0,e.indexOf("H"))),r=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("M")))):e.indexOf("H")<0&&e.indexOf("M")>-1&&e.indexOf("S")>-1?(r=parseFloat(e.slice(0,e.indexOf("M"))),n=parseFloat(e.slice(e.indexOf("M")+1,e.indexOf("S")))):e.indexOf("H")>-1&&e.indexOf("M")<0&&e.indexOf("S")>-1?(t=parseFloat(e.slice(0,e.indexOf("H"))),n=parseFloat(e.slice(e.indexOf("H")+1,e.indexOf("S")))):e.indexOf("H")<0&&e.indexOf("M")<0&&e.indexOf("S")>-1?n=parseFloat(e.slice(0,e.indexOf("S"))):e.indexOf("H")<0&&e.indexOf("M")>-1&&e.indexOf("S")<0&&(r=parseFloat(e.slice(0,e.indexOf("M")))),3600*t+60*r+n},preFixInterge:function(e,t){return(Array(t).join(0)+e).slice(-t)},toHex:function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.push(rw.padStart(Number(t).toString(16),2,0))})),e},sum:function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e+=t})),e},toUTF8:function(e){for(var t=encodeURIComponent(e),r=unescape(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n.buffer},fromHex:function(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t},fromCharCode:function(e){for(var t="",r=0;r<e.length;r+=16e3){var n=e.subarray(r,r+16e3);t+=String.fromCharCode.apply(null,n)}return t},toBase64:function(e,t){var r=rw.fromCharCode(e);t=void 0===t||t;var n=window.btoa(r).replace(/\+/g,"-").replace(/\//g,"_");return t?n:n.replace(/=*$/,"")},str2hex:function(e){if(""===e)return"";for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t},bufferToString:function(e){return("0"+Number(e).toString(16)).slice(-2).toUpperCase()},stringToBuffer:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e[r]+e[r+1],16));return new Uint8Array(t)}};rw.toHex=function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.push(rw.padStart(Number(t).toString(16),2,0))})),e},rw.formatIV=function(e){var t="";return e.forEach((function(e){t+=rw.bufferToString(e)})),t},rw.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number(e.toFixed(t))},rw.isSogou=function(){return window.navigator.userAgent.toLowerCase().indexOf("metasr")>-1},rw.isEdge=function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("edge")>-1||e.indexOf("edg/")>-1},rw.offInDestroy=function(e,t,r,n){e.once(n,(function i(){e.off(t,r),e.off(n,i)}))},rw.on=function(e,t,r,n){if(n)e.on(t,r),rw.offInDestroy(e,t,r,n);else{e.on(t,(function n(i){r(i),e.off(t,n)}))}},rw.once=function(e,t,r,n){if(n)e.once(t,r),rw.offInDestroy(e,t,r,n);else{e.once(t,(function n(i){r(i),e.off(t,n)}))}},rw.promisePolyfill=function(){Promise.prototype.finally||(Promise.prototype.finally={finally:function(e){var t=function(t){return Promise.resolve(e()).then(t)};return this.then((function(e){return t((function(){return e}))}),(function(e){return t((function(){return Promise.reject(e)}))}))}}.finally)},rw.transformHeaders=function(e,t){var r=Object.assign({},e);return Object.keys(t).forEach((function(n){var i=t[n];e&&e[n]&&(r[i]=e[n],delete r[n])})),r},rw.generateUniqueKey=function(e){var t=e.vid,r=e.start,n=e.end,i=e.mediaType,o=e.definition,a=e.codecType,s=e.format;return r=r||0,n=n||0,a=a||"h264",s=s||"dash",t&&i?o?"".concat(t,"#").concat(i,"#").concat(o,"#").concat(r,"#").concat(n,"#").concat(a,"#").concat(s):"".concat(t,"#").concat(i,"#").concat(r,"#").concat(n,"#").concat(a,"#").concat(s):null},rw.exchangeListUrl=function(e){if(e&&0!==e.length)for(var t=0;t<e.length;t++)rw.exchangeUrl(e[t])},rw.exchangeUrl=function(e){if(e&&e.main_url&&e.backup_url_1){var t=e.main_url,r=e.backup_url_1,n=t.split("?");2===n.length&&-1===r.indexOf("?")?(e.main_url=r+"?"+n[1],e.backup_url_1=n[0]):(e.main_url=r,e.backup_url_1=t)}},rw.validateFragment=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t instanceof ArrayBuffer){try{var n=new Uint8Array(t,4,4),i=String.fromCharCode.apply(null,n);if(2===r.length){var o=r[1]-r[0]+1;if(!(t.byteLength===o))return}if("moof"!==i&&"styp"!==i&&"ftyp"!==i)return!1}catch(e){return!1}return!0}return!1},rw.validateUrlRange=function(e,t){var r=e||[];if(r.length>0)for(var n=0;n<r.length;n++){var i=r[n];if(/([0-9.\-A-Za-z]+)/.test(i)&&t.indexOf(i)>-1)return!0}return!1},rw.isBase64=function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)};var nw,iw,ow,aw,sw=(nw="vodTimestampSalt",iw=function(e){return e.split("").map((function(e){return e.charCodeAt(0)}))},ow=function(e){return("0"+Number(e).toString(16)).substr(-2)},aw=function(e){return iw(nw).reduce((function(e,t){return e^t}),e)},function(e){return e.split("").map(iw).map(aw).map(ow).join("")}),uw=function(e){var t=function(t){return(r=e,r.split("").map((function(e){return e.charCodeAt(0)}))).reduce((function(e,t){return e^t}),t);var r};return function(e){return e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})).map(t).map((function(e){return String.fromCharCode(e)})).join("")}}("vodTimestampSalt");rw.getUnionInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(sw((new Date).getTime().toString()))},rw.checkUnionInfoExpired=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(0===t.indexOf(e)){var n=parseInt(uw(t.slice(e.length))),i=(new Date).getTime()-n;if(i>0&&i<=1e3*r)return!0}return!1},rw.getCookieValue=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.cookie.split(";"),r=0;r<t.length;r++){var n=t[r].trim().split("=");if(n[0]===e)return n[1]}return null};var cw=rw,lw=ri,dw=u,fw=It.f;lw({target:"Object",stat:!0,forced:Object.defineProperty!==fw,sham:!dw},{defineProperty:fw});var hw=o,pw={},gw=et;pw.f=gw;var yw=hw,vw=Be,mw=pw,_w=It.f,bw=function(e){var t=yw.Symbol||(yw.Symbol={});vw(t,e)||_w(t,e,{value:mw.f(e)})};bw("iterator");var Aw=Ab.charAt,Ew=yo,Sw=Lr,Tw=cu,$w="String Iterator",ww=Sw.set,Cw=Sw.getterFor($w);Tw(String,"String",(function(e){ww(this,{type:$w,string:Ew(e),index:0})}),(function(){var e,t=Cw(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Aw(r,n),t.index+=e.length,{value:e,done:!1})}));var Iw=o,kw=Oa,Ow=xa,Pw=bu,Rw=Yt,xw=et,Dw=xw("iterator"),Lw=xw("toStringTag"),Nw=Pw.values,Mw=function(e,t){if(e){if(e[Dw]!==Nw)try{Rw(e,Dw,Nw)}catch(error){e[Dw]=Nw}if(e[Lw]||Rw(e,Lw,t),kw[t])for(var r in Pw)if(e[r]!==Pw[r])try{Rw(e,r,Pw[r])}catch(error){e[r]=Pw[r]}}};for(var Bw in kw)Mw(Iw[Bw]&&Iw[Bw].prototype,Bw);Mw(Ow,"DOMTokenList");var Uw={},jw=k,Fw=j,Vw=Jr.f,Gw=qu,Hw="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Uw.f=function(e){return Hw&&"Window"==jw(e)?function(e){try{return Vw(e)}catch(error){return Gw(Hw)}}(e):Vw(Fw(e))};var Kw=f,zw=W,Ww=et,Yw=Qr,Xw=ri,Zw=o,qw=f,Qw=$,Jw=u,eC=oe,tC=s,rC=Be,nC=Y,iC=Dt,oC=j,aC=ft,sC=yo,uC=_,cC=ss,lC=ra,dC=Jr,fC=Uw,hC=In,pC=a,gC=It,yC=Fa,vC=h,mC=Qr,_C=$e.exports,bC=vr,AC=Ge,EC=et,SC=pw,TC=bw,$C=function(){var e=zw("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=Ww("toPrimitive");t&&!t[n]&&Yw(t,n,(function(e){return Kw(r,this)}),{arity:1})},wC=Ms,CC=Lr,IC=Yi.forEach,kC=yr("hidden"),OC="Symbol",PC=CC.set,RC=CC.getterFor(OC),xC=Object.prototype,DC=Zw.Symbol,LC=DC&&DC.prototype,NC=Zw.TypeError,MC=Zw.QObject,BC=pC.f,UC=gC.f,jC=fC.f,FC=vC.f,VC=Qw([].push),GC=_C("symbols"),HC=_C("op-symbols"),KC=_C("wks"),zC=!MC||!MC.prototype||!MC.prototype.findChild,WC=Jw&&tC((function(){return 7!=cC(UC({},"a",{get:function(){return UC(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=BC(xC,t);n&&delete xC[t],UC(e,t,r),n&&e!==xC&&UC(xC,t,n)}:UC,YC=function(e,t){var r=GC[e]=cC(LC);return PC(r,{type:OC,tag:e,description:t}),Jw||(r.description=t),r},XC=function(e,t,r){e===xC&&XC(HC,t,r),iC(e);var n=aC(t);return iC(r),rC(GC,n)?(r.enumerable?(rC(e,kC)&&e[kC][n]&&(e[kC][n]=!1),r=cC(r,{enumerable:uC(0,!1)})):(rC(e,kC)||UC(e,kC,uC(1,{})),e[kC][n]=!0),WC(e,n,r)):UC(e,n,r)},ZC=function(e,t){iC(e);var r=oC(t),n=lC(r).concat(eI(r));return IC(n,(function(t){Jw&&!qw(qC,r,t)||XC(e,t,r[t])})),e},qC=function(e){var t=aC(e),r=qw(FC,this,t);return!(this===xC&&rC(GC,t)&&!rC(HC,t))&&(!(r||!rC(this,t)||!rC(GC,t)||rC(this,kC)&&this[kC][t])||r)},QC=function(e,t){var r=oC(e),n=aC(t);if(r!==xC||!rC(GC,n)||rC(HC,n)){var i=BC(r,n);return!i||!rC(GC,n)||rC(r,kC)&&r[kC][n]||(i.enumerable=!0),i}},JC=function(e){var t=jC(oC(e)),r=[];return IC(t,(function(e){rC(GC,e)||rC(bC,e)||VC(r,e)})),r},eI=function(e){var t=e===xC,r=jC(t?HC:oC(e)),n=[];return IC(r,(function(e){!rC(GC,e)||t&&!rC(xC,e)||VC(n,GC[e])})),n};eC||(DC=function(){if(nC(LC,this))throw NC("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?sC(arguments[0]):void 0,t=AC(e),r=function e(r){this===xC&&qw(e,HC,r),rC(this,kC)&&rC(this[kC],t)&&(this[kC][t]=!1),WC(this,t,uC(1,r))};return Jw&&zC&&WC(xC,t,{configurable:!0,set:r}),YC(t,e)},mC(LC=DC.prototype,"toString",(function(){return RC(this).tag})),mC(DC,"withoutSetter",(function(e){return YC(AC(e),e)})),vC.f=qC,gC.f=XC,yC.f=ZC,pC.f=QC,dC.f=fC.f=JC,hC.f=eI,SC.f=function(e){return YC(EC(e),e)},Jw&&(UC(LC,"description",{configurable:!0,get:function(){return RC(this).description}}),mC(xC,"propertyIsEnumerable",qC,{unsafe:!0}))),Xw({global:!0,constructor:!0,wrap:!0,forced:!eC,sham:!eC},{Symbol:DC}),IC(lC(KC),(function(e){TC(e)})),Xw({target:OC,stat:!0,forced:!eC},{useSetter:function(){zC=!0},useSimple:function(){zC=!1}}),Xw({target:"Object",stat:!0,forced:!eC,sham:!Jw},{create:function(e,t){return void 0===t?cC(e):ZC(cC(e),t)},defineProperty:XC,defineProperties:ZC,getOwnPropertyDescriptor:QC}),Xw({target:"Object",stat:!0,forced:!eC},{getOwnPropertyNames:JC}),$C(),wC(DC,OC),bC[kC]=!0;var tI=oe&&!!Symbol.for&&!!Symbol.keyFor,rI=ri,nI=W,iI=Be,oI=yo,aI=$e.exports,sI=tI,uI=aI("string-to-symbol-registry"),cI=aI("symbol-to-string-registry");rI({target:"Symbol",stat:!0,forced:!sI},{for:function(e){var t=oI(e);if(iI(uI,t))return uI[t];var r=nI("Symbol")(t);return uI[t]=r,cI[r]=t,r}});var lI=ri,dI=Be,fI=fe,hI=pe,pI=tI,gI=(0,$e.exports)("symbol-to-string-registry");lI({target:"Symbol",stat:!0,forced:!pI},{keyFor:function(e){if(!fI(e))throw TypeError(hI(e)+" is not a symbol");if(dI(gI,e))return gI[e]}});var yI=ri,vI=W,mI=tp,_I=f,bI=$,AI=s,EI=ui,SI=F,TI=G,$I=fe,wI=Wp,CI=oe,II=vI("JSON","stringify"),kI=bI(/./.exec),OI=bI("".charAt),PI=bI("".charCodeAt),RI=bI("".replace),xI=bI(1..toString),DI=/[\uD800-\uDFFF]/g,LI=/^[\uD800-\uDBFF]$/,NI=/^[\uDC00-\uDFFF]$/,MI=!CI||AI((function(){var e=vI("Symbol")();return"[null]"!=II([e])||"{}"!=II({a:e})||"{}"!=II(Object(e))})),BI=AI((function(){return'"\\udf06\\ud834"'!==II("\udf06\ud834")||'"\\udead"'!==II("\udead")})),UI=function(e,t){var r=wI(arguments),n=t;if((TI(t)||void 0!==e)&&!$I(e))return EI(t)||(t=function(e,t){if(SI(n)&&(t=_I(n,this,e,t)),!$I(t))return t}),r[1]=t,mI(II,null,r)},jI=function(e,t,r){var n=OI(r,t-1),i=OI(r,t+1);return kI(LI,e)&&!kI(NI,i)||kI(NI,e)&&!kI(LI,n)?"\\u"+xI(PI(e,0),16):e};II&&yI({target:"JSON",stat:!0,arity:3,forced:MI||BI},{stringify:function(e,t,r){var n=wI(arguments),i=mI(MI?UI:II,null,n);return BI&&"string"==typeof i?RI(i,DI,jI):i}});var FI=In,VI=Le;ri({target:"Object",stat:!0,forced:!oe||s((function(){FI.f(1)}))},{getOwnPropertySymbols:function(e){var t=FI.f;return t?t(VI(e)):[]}});var GI=ri,HI=u,KI=o,zI=$,WI=Be,YI=F,XI=Y,ZI=yo,qI=It.f,QI=Un,JI=KI.Symbol,ek=JI&&JI.prototype;if(HI&&YI(JI)&&(!("description"in ek)||void 0!==JI().description)){var tk={},rk=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:ZI(arguments[0]),t=XI(ek,this)?new JI(e):void 0===e?JI():JI(e);return""===e&&(tk[t]=!0),t};QI(rk,JI),rk.prototype=ek,ek.constructor=rk;var nk="Symbol(test)"==String(JI("test")),ik=zI(ek.toString),ok=zI(ek.valueOf),ak=/^Symbol\((.*)\)[^)]+$/,sk=zI("".replace),uk=zI("".slice);qI(ek,"description",{configurable:!0,get:function(){var e=ok(this),t=ik(e);if(WI(tk,e))return"";var r=nk?uk(t,7,-1):sk(t,ak,"$1");return""===r?void 0:r}}),GI({global:!0,constructor:!0,forced:!0},{Symbol:rk})}var ck,lk={};Object.defineProperty(lk,"__esModule",{value:!0}),lk.default=function(e){for(var t=0,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;t+=l.length}}catch(_){a=!0,s=_}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}var d=new e(t),f=0,h=!0,p=!1,g=void 0;try{for(var y,v=n[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){var m=y.value;d.set(m,f),f+=m.length}}catch(_){p=!0,g=_}finally{try{!h&&v.return&&v.return()}finally{if(p)throw g}}return d};var dk=((ck=lk)&&ck.__esModule?ck:{default:ck}).default,fk=function(){function e(){vv(this,e),this.buffer=new Uint8Array(0)}return _v(e,[{key:"write",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){t?e.buffer=dk(Uint8Array,e.buffer,t):console.error(t)}))}}],[{key:"writeUint16",value:function(e){return new Uint8Array([e>>8&255,255&e])}},{key:"writeUint32",value:function(e){return new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e])}}]),e}(),hk=fk;ri({target:"Array",stat:!0},{isArray:ui});var pk=Math.pow(2,32)-1;function gk(e){if(!Array.isArray(e)){for(var t=[],r="",n=0;n<e.length;n++)n%2&&(r=e[n-1]+e[n],t.push(parseInt(r,16)),r="");return t}return e.map((function(e){return parseInt(e,16)}))}var yk=function(){function e(){vv(this,e)}return _v(e,null,[{key:"type",value:function(e){return new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)])}},{key:"size",value:function(e){return hk.writeUint32(e)}},{key:"extension",value:function(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}},{key:"audioTrak",value:function(t){var r=new hk,n=8,i=e.tkhd({id:t.trackID||2,duration:t.audioDuration,timescale:t.audioTimeScale,width:0,height:0,type:"audio"}),o=t.channelCount,a=t.sampleRate;t.enca&&(o=t.enca.channelCount,a=t.enca.sampleRate);var s=e.mdia({type:"audio",timescale:t.audioTimeScale,duration:t.audioDuration,channelCount:o,sampleRate:a,audioConfig:t.audioConfig,enca:t.enca});return[i,s].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("trak"),i,s),r.buffer}},{key:"videoTrak",value:function(t){var r=new hk,n=8,i=e.tkhd({id:t.trackID||1,duration:t.videoDuration,timescale:t.videoTimeScale,width:t.width,height:t.height,type:"video"}),o=e.mdia({type:"video",timescale:t.videoTimeScale,duration:t.videoDuration,VideoVisualSampleEntry:t.VideoVisualSampleEntry,VideoCodecConfigurationBox:t.VideoCodecConfigurationBox,encv:t.encv});return[i,o].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("trak"),i,o),r.buffer}},{key:"btrt",value:function(){var t=new hk,r=new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]);return t.write(e.size(8+r.byteLength),e.type("btrt"),r),t.buffer}},{key:"dinf",value:function(){var t=new hk;return t.write(e.size(36),e.type("dinf"),e.size(28),e.type("dref"),new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])),t.buffer}},{key:"edts",value:function(t){var r=new hk,n=t.duration,i=t.mediaTime;return r.write(e.size(36),e.type("edts")),r.write(e.size(28),e.type("elst")),r.write(new Uint8Array([0,0,0,1,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,1])),r.buffer}},{key:"enca",value:function(t){var r=new hk,n=t.enca.channelCount,i=t.enca.sampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>8&255,255&i,0,0]),a=e.esds(t.audioConfig),s=e.sinf(t.enca);return r.write(e.size(16+o.byteLength+a.byteLength+s.byteLength),e.type("enca"),o,a,e.size(8+s.byteLength),e.type("sinf"),s),r.buffer}},{key:"encv",value:function(t){var r=new hk,n=t.width,i=t.height,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,255&n,i>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a=new Uint8Array(t.VideoCodecConfigurationBox),s=e.btrt(),u=e.sinf(t.encv),c=e.pasp(t);return r.write(e.size(16+o.byteLength+a.byteLength+s.byteLength+c.byteLength+u.byteLength),e.type("encv"),o,a,s,e.size(8+u.byteLength),e.type("sinf"),u,c),r.buffer}},{key:"esds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[43,146,8,0],r=t.length,n=new hk,i=new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t).concat([6,1,2]));return n.write(e.size(8+i.byteLength),e.type("esds"),i),n.buffer}},{key:"frma",value:function(t){var r=new hk,n=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]);return r.write(e.size(8+n.byteLength),e.type("frma"),n),r.buffer}},{key:"ftyp",value:function(t){var r=new hk;return r.write(e.size(t.size),e.type("ftyp"),new Uint8Array(t.data)),r.buffer}},{key:"hdlr",value:function(t){var r=new hk,n=[0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0];return"audio"===t&&(n.splice.apply(n,[8,4].concat([115,111,117,110])),n.splice.apply(n,[24,13].concat([83,111,117,110,100,72,97,110,100,108,101,114,0]))),r.write(e.size(8+n.length),e.type("hdlr"),new Uint8Array(n)),r.buffer}},{key:"mdat",value:function(t){var r=new hk,n=8;return t.samples.forEach((function(e){n+=e.size})),r.write(e.size(n),e.type("mdat")),t.samples.forEach((function(e){r.write(e.buffer)})),r.buffer}},{key:"mdhd",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,217,20,37,90,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,21,199,0,0]);return r.write(e.size(12+n.byteLength),e.type("mdhd"),e.extension(0,0),n),r.buffer}},{key:"mdia",value:function(t){var r=new hk,n=8,i=e.mdhd(t.timescale),o=e.hdlr(t.type),a=e.minf(t);return[i,o,a].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("mdia"),i,o,a),r.buffer}},{key:"mfhd",value:function(t){var r=new hk,n=null;return 1===t.id?(n=hk.writeUint32(e.videoSequence),e.videoSequence+=1):(n=hk.writeUint32(e.audioSequence),e.audioSequence+=1),r.write(e.size(16),e.type("mfhd"),e.extension(0,0),n),r.buffer}},{key:"minf",value:function(t){var r=new hk,n=8,i="video"===t.type?e.vmhd():e.smhd(),o=e.dinf(),a=e.stbl(t);return[i,o,a].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("minf"),i,o,a),r.buffer}},{key:"moof",value:function(t){var r=new hk,n=8,i=e.mfhd(t),o=e.traf(t);return[i,o].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("moof"),i,o),r.buffer}},{key:"moov",value:function(t){var r=new hk,n=8,i=e.mvhd(t.duration,t.timeScale),o=e.mvex(t.duration,t.timeScale),a=null;if(a=t.videoCodec?e.videoTrak(t):e.audioTrak(t),t.encv){t.pssh||(t.pssh={kid:t.kid});var s=e.pssh(t.pssh);[i,o,a,s].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("moov"),i,o,a,s)}else[i,o,a].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("moov"),i,o,a);return r.buffer}},{key:"mp4a",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),i=e.esds(t.audioConfig);return r.write(e.size(8+n.byteLength+i.byteLength),e.type("mp4a"),n,i),r.buffer}},{key:"mvex",value:function(t,r){var n=new hk,i=hk.writeUint32(t*r);return n.write(e.size(88),e.type("mvex"),e.size(16),e.type("mehd"),e.extension(0,0),i,e.trex1(1),e.trex2(2)),n.buffer}},{key:"mvhd",value:function(t,r){var n=new hk;t*=r;var i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3]);return n.write(e.size(8+i.length),e.type("mvhd"),new Uint8Array(i)),n.buffer}},{key:"pasp",value:function(t){var r=new hk,n=t.pixelRatio[0],i=t.pixelRatio[1],o=new Uint8Array([n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i]);return r.write(e.size(8+o.byteLength),e.type("pasp"),o),r.buffer}},{key:"pssh",value:function(t){var r=new hk,n=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],gk(t.kid),[0,0,0,0]));return r.write(e.size(8+n.byteLength),e.type("pssh"),n),r.buffer}},{key:"saio",value:function(t){var r=new hk,n=12*t.samples.length+141;2===t.id&&t.isAudioEncryption&&(n=149);var i=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n]);return r.write(e.size(8+i.byteLength),e.type("saio"),i),r.buffer}},{key:"saiz",value:function(t){var r=new hk,n=t.samples.length,i=new Uint8Array([0,0,0,0,16,n>>24&255,n>>16&255,n>>8&255,255&n]);return r.write(e.size(8+i.byteLength),e.type("saiz"),i),r.buffer}},{key:"sbgp",value:function(t){var r=new hk,n=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return r.write(e.size(12+n.byteLength),e.type("sbgp"),e.extension(0,0),n),r.buffer}},{key:"schi",value:function(t){var r=new hk,n=new Uint8Array([]),i=e.tenc(t);return r.write(e.size(8+n.byteLength+i.byteLength),e.type("schi"),n,i),r.buffer}},{key:"schm",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]);return r.write(e.size(8+n.byteLength),e.type("schm"),n),r.buffer}},{key:"sdtp",value:function(t){var r=new hk;return r.write(e.size(12+t.samples.length),e.type("sdtp"),e.extension(0,0)),t.samples.forEach((function(e){r.write(new Uint8Array(1===t.id?[e.key?32:16]:[16]))})),r.buffer}},{key:"senc",value:function(t){var r=new hk,n=t.samples.length,i=t.sampleOffset,o=n+i,a=1===t.id?16:8,s=1===t.id?2:0,u=[],c=0;return 1===t.id?(u=t.videoSenc.slice(i,o),c=t.videoSencLength):u=t.audioSenc.slice(i,o),c=c||a*n,r.write(e.size(16+c),e.type("senc"),e.extension(0,s)),r.write(hk.writeUint32(n)),u.forEach((function(e){r.write(hk.writeUint32(e.InitializationVector[0])),r.write(hk.writeUint32(e.InitializationVector[1])),e.subsamples&&e.subsamples.length&&(r.write(hk.writeUint16(e.subsamples.length)),e.subsamples.forEach((function(e){r.write(hk.writeUint16(e.BytesOfClearData)),r.write(hk.writeUint32(e.BytesOfProtectedData))})))})),r.buffer}},{key:"sidx",value:function(t){var r=new hk,n=1===t.id?t.videoTimeScale:t.audioTimeScale,i=t.samples[0].duration,o=i*t.samples.length,a=t.sampleOffset*i,s=8;t.samples.forEach((function(e){s+=e.size}));var u=0;if(1===t.id){var c=0,l=t.samples.length,d=t.sampleOffset,f=l+d,h=t.videoSenc.slice(d,f);1===t.id&&h.forEach((function(e){c+=8,e.subsamples&&e.subsamples.length&&(c+=2,c+=6*e.subsamples.length)})),t.videoSencLength=c,u=s+141+12*t.samples.length+c,t.isAudioEncryption&&!t.isVideoEncryption&&(u=s+12*t.samples.length+84)}else u=s+104+4*t.samples.length,t.isAudioEncryption&&(u=s+169+12*t.samples.length);var p=new Uint8Array([0,0,0,0,0,0,0,255&t.id,n>>24&255,n>>16&255,n>>8&255,255&n,a>>24&255,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,1,0,u>>16&255,u>>8&255,255&u,o>>24&255,o>>16&255,o>>8&255,255&o,144,0,0,0]);return r.write(e.size(8+p.byteLength),e.type("sidx"),p),r.buffer}},{key:"sinf",value:function(t){var r=new hk,n=new Uint8Array([]),i=e.frma(t),o=e.schm(),a=e.schi(t);return r.write(n,i,o,a),r.buffer}},{key:"smhd",value:function(){var t=new hk;return t.write(e.size(16),e.type("smhd"),new Uint8Array([0,0,0,0,0,0,0,0])),t.buffer}},{key:"stbl",value:function(t){var r=new hk,n=8,i=e.stsd(t),o=e.stts(),a=e.stsc(),s=e.stsz(),u=e.stco();return[i,o,a,s,u].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("stbl"),i,o,a,s,u),r.buffer}},{key:"stco",value:function(){var t=new hk,r=new Uint8Array([0,0,0,0,0,0,0,0]);return t.write(e.size(16),e.type("stco"),r),t.buffer}},{key:"stsc",value:function(){var t=new hk,r=new Uint8Array([0,0,0,0,0,0,0,0]);return t.write(e.size(16),e.type("stsc"),r),t.buffer}},{key:"stsd",value:function(t){var r,n=new hk;return r="audio"===t.type?t.enca?e.enca(t):e.mp4a(t):t.encv?e.encv(t):t.VideoVisualSampleEntry,n.write(e.size(16+r.byteLength),e.type("stsd"),e.extension(0,0),new Uint8Array([0,0,0,1]),r),n.buffer}},{key:"stsz",value:function(){var t=new hk,r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);return t.write(e.size(20),e.type("stsz"),r),t.buffer}},{key:"stts",value:function(){var t=new hk,r=new Uint8Array([0,0,0,0,0,0,0,0]);return t.write(e.size(16),e.type("stts"),r),t.buffer}},{key:"styp",value:function(t){var r=new hk,n=new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]);return r.write(e.size(8+n.byteLength),e.type("styp"),n),r.buffer}},{key:"tenc",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,0,0,255&t.default_IsEncrypted,255&t.default_IV_size].concat(gk(t.default_KID)));return r.write(e.size(8+n.byteLength),e.type("tenc"),n),r.buffer}},{key:"tfdt",value:function(t,r){var n=new hk,i=Math.floor(r/(pk+1)),o=Math.floor(r%(pk+1));return t.isVideoEncryption||t.isAudioEncryption?n.write(e.size(16),e.type("tfdt"),e.extension(0,0),hk.writeUint32(o)):n.write(e.size(20),e.type("tfdt"),e.extension(1,0),hk.writeUint32(i),hk.writeUint32(o)),n.buffer}},{key:"tfhd",value:function(t){var r=new hk,n=16,i=t.flags;return 2&i&&(i=t.flags-2),1&i&&(n+=8),8&i&&(n+=4),16&i&&(n+=4),32&i&&(n+=4),r.write(e.size(n),e.type("tfhd")),r.write(hk.writeUint32(i)),r.write(hk.writeUint32(t.track_id)),1&i&&r.write(hk.writeUint64(t.base_data_offset)),8&i&&r.write(hk.writeUint32(t.default_sample_duration)),16&i&&r.write(hk.writeUint32(t.default_sample_size)),32&i&&r.write(hk.writeUint32(t.default_sample_flags)),r.buffer}},{key:"tkhd",value:function(t){var r=new hk,n=t.id,i=t.duration*t.timeScale,o=t.width,a=t.height,s=t.type,u=new Uint8Array([0,0,0,3,0,0,0,0,217,172,236,86,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,"video"===s?1:0,"audio"===s?1:0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,a>>8&255,255&a,0,0]);return r.write(e.size(8+u.byteLength),e.type("tkhd"),u),r.buffer}},{key:"traf",value:function(t){var r=new hk,n=8,i=e.tfhd(t.id),o=e.tfdt(t,t.time);if(t.isVideoEncryption||t.isAudioEncryption)if(t.isVideoEncryption)if(1===t.id){var a=e.saiz(t),s=e.saio(t),u=e.trun1(t),c=e.senc(t);[i,o,a,s,u,c].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,a,s,u,c)}else if(t.isAudioEncryption){var l=e.sbgp(t),d=e.saiz(t),f=e.saio(t),h=e.senc(t),p=e.trun1(t);[i,o,l,d,f,h,p].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,l,d,f,h,p)}else{var g=e.sbgp(t),y=e.trun1(t);[i,o,g,y].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,g,y)}else if(1===t.id){var v=e.trun1(t);[i,o,v].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,v)}else{var m=e.sbgp(t),_=e.saiz(t),b=e.saio(t),A=e.senc(t),E=e.trun1(t);[i,o,m,_,b,A,E].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,m,_,b,A,E)}else{var S=e.sdtp(t),T=e.trun(t,S.byteLength);[i,o,S,T].forEach((function(e){n+=e.byteLength})),r.write(e.size(n),e.type("traf"),i,o,S,T)}return r.buffer}},{key:"trex",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return r.write(e.size(8+n.byteLength),e.type("trex"),n),r.buffer}},{key:"trex1",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]);return r.write(e.size(8+n.byteLength),e.type("trex"),n),r.buffer}},{key:"trex2",value:function(t){var r=new hk,n=new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]);return r.write(e.size(8+n.byteLength),e.type("trex"),n),r.buffer}},{key:"trun",value:function(t,r){var n=t.id,i=1===n?16:12,o=new hk,a=hk.writeUint32(t.samples.length),s=hk.writeUint32(96+i*t.samples.length+r);return o.write(e.size(20+i*t.samples.length),e.type("trun"),e.extension(0,t.flags),a,s),t.samples.forEach((function(e,t){o.write(hk.writeUint32(e.duration)),o.write(hk.writeUint32(e.size)),1===n?(o.write(hk.writeUint32(e.key?33554432:16842752)),o.write(hk.writeUint32(e.offset))):o.write(hk.writeUint32(16777216))})),o.buffer}},{key:"trun1",value:function(t){var r=t.id,n=1===r?12:4,i=new hk,o=hk.writeUint32(t.samples.length),a=null;if(1===t.id){var s=0;1===t.id&&(s=t.videoSencLength),a=hk.writeUint32(12*t.samples.length+s+149),!t.isVideoEncryption&&t.isAudioEncryption&&(a=hk.writeUint32(t.samples.length*n+92))}else{var u=4*t.samples.length+120;t.isAudioEncryption&&(u=12*t.samples.length+177),a=hk.writeUint32(u)}return i.write(e.size(20+n*t.samples.length),e.type("trun"),e.extension(0,t.flags),o,a),t.samples.forEach((function(e){i.write(hk.writeUint32(e.size)),1===r&&(i.write(hk.writeUint32(e.key?33554432:65536)),i.write(hk.writeUint32(e.offset)))})),i.buffer}},{key:"vmhd",value:function(){var t=new hk;return t.write(e.size(20),e.type("vmhd"),new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])),t.buffer}},{key:"av01",value:function(t){var r=new hk,n=t.width,i=t.height,o=e.av1C(t),a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,255&n,i>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s=e.btrt(),u=e.pasp(t);return r.write(e.size(8+a.byteLength+o.byteLength+s.byteLength+u.byteLength),e.type("av01"),a,o,s,u),r.buffer}},{key:"av1C",value:function(t){var r=new hk,n=new Uint8Array(t.av1C);return r.write(e.size(8+n.byteLength),e.type("av1C"),n),r.buffer}},{key:"avc1",value:function(t){var r=new hk,n=t.width,i=t.height,o=e.avcC(t),a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,255&n,i>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s=e.btrt(),u=e.pasp(t);return r.write(e.size(8+a.byteLength+o.byteLength+s.byteLength+u.byteLength),e.type("avc1"),a,o,s,u),r.buffer}},{key:"avcC",value:function(t){var r=new hk,n=t.sps,i=t.pps,o=new Uint8Array([1,n[1],n[2],n[3],255,225].concat([n.length>>>8&255,255&n.length]).concat(n).concat(1).concat([i.length>>>8&255,255&i.length]).concat(i));return r.write(e.size(8+o.byteLength),e.type("avcC"),o),r.buffer}}]),e}();yk.videoSequence=1,yk.audioSequence=1;var vk,mk=yk,_k=function(){function e(){var t,r;vv(this,e);var n=new Promise((function(e,n){t=e,r=n}));return n.resolve=t,n.reject=r,n}return _v(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}();function bk(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ak=_v((function e(t,r,n,i,o,a){vv(this,e),this.type=t,this.codecs=r,this.visualEntryBox=n,this.configurationBox=i,this.types=o,this.logCodeType=a})),Ek="avc",Sk="av1";bk(vk={},Ek,new Ak("avc","avc1.64001E","avc1","avcC",["h264"],"h264")),bk(vk,Sk,new Ak("av1","av01.0.08M.08","av01","av1C",["av1"],"av1"));var Tk={mse:function(){}},$k=self.crypto||self.msCrypto,wk=cw.findBox,Ck=function(e,t,r){var n=null;if(e===Ek&&(n=Ik(t,r)),e===Sk&&(n=function(e,t){var r=Ok(e,t),n=r.width,i=r.height,o=r.pixelRatio,a=r.av1CBox,s=r.videoCodec,u=mk.av01({width:n,height:i,pixelRatio:o,av1C:a.data}),c=mk.av1C({av1C:a.data});return{VideoVisualSampleEntry:u,VideoCodecConfigurationBox:c,videoCodec:s}}(t,r)),!n)throw new Error("".concat(e," not support"));return n},Ik=function(e,t){var r=kk(e,t),n=r.width,i=r.height,o=r.videoCodec,a=r.sps,s=r.pps,u=r.pixelRatio;return{VideoVisualSampleEntry:mk.avc1({sps:a,pps:s,width:n,height:i,pixelRatio:u}),VideoCodecConfigurationBox:mk.avcC({sps:a,pps:s}),videoCodec:o}},kk=function(e,t){var r,n,i,o,a,s=[1,1],u=wk(t,"avcC");"encv"===e.type&&(u=wk(e,"avcC"));var c=wk(t,"tkhd");return u?(i="".concat(e.type,".")+cw.toHex(u.profile,u.profileCompatibility,u.AVCLevelIndication).join(""),o=u.sps,s=[u.spsInfo.par_ratio.width,u.spsInfo.par_ratio.height],u.spsInfo.codec_size&&(r=u.spsInfo.codec_size.width,n=u.spsInfo.codec_size.height),a=u.pps&&u.pps.map((function(e){return Number("0x".concat(e))}))):i="".concat(e.type),c&&!r&&(r=c.width,n=c.height),{width:r,height:n,videoCodec:i,sps:o,pps:a,pixelRatio:s}};var Ok=function(e,t){var r,n,i,o=[1,1],a=wk(t,"av1C");"encv"===e.type&&(r=e.width,n=e.height,a=wk(e,"av1C"));var s=wk(t,"tkhd");return a?(i="".concat(e.type,"."),o=[1,1]):i="".concat(e.type),s&&!r&&(r=s.width,n=s.height),{width:r,height:n,videoCodec:i,pixelRatio:o,av1CBox:a}},Pk={decryptHeader:function(e,t){for(var r=this,n=new hk,i=null,o=null,a=0;a<e.boxes.length;a++){var s=e.boxes[a];if("ftyp"===s.type){o=s;break}}return e.boxes.forEach((function(e){if("moov"===e.type){var a=function(e,t){var r,n,i,o,a,s,u,c,l=wk(e,"mvhd"),d=wk(e,"trak"),f=wk(e,"udta"),h=wk(d,"hdlr"),p=wk(d,"mdhd");if(h&&p){var g=wk(d,"stsd"),y=wk(d,"tkhd"),v=g.subBox[0],m={};if("vide"===h.handleType&&(i=d,o=p.timescale,m=Ck(t,v,d)),"soun"===h.handleType){n=d;var _=wk(d,"esds"),b=wk(d,"mp4a"),A=wk(d,5);a=p.timescale,r=_?"".concat(v.type,".")+cw.toHex(_.subBox[0].subBox[0].typeID)+".".concat(_.subBox[0].subBox[0].subBox[0].type):"".concat(v.type),A&&A.EScode&&(c=A.EScode.map((function(e){return Number("0x".concat(e))}))),b&&(s=b.channelCount,u=b.sampleRate);var E=wk(d,"enca");E&&(s=E.channelCount,u=E.sampleRate)}var S=cw.findBox(d,"stsc"),T=cw.findBox(d,"stsz"),$=cw.findBox(d,"stts"),w=cw.findBox(d,"stco"),C=l.duration;if(0===C){var I=wk(e,"mehd");I&&(C=I.fragment_duration)}return Object.assign({audioCodec:r,audioTrak:n,videoTrak:i,createTime:l.createTime,modifyTime:l.modifyTime,duration:C/l.timeScale,timeScale:l.timeScale,videoTimeScale:o,audioTimeScale:a,pixelRatio:[1,1],channelCount:s,sampleRate:u,audioConfig:c,stsc:S,stsz:T,stts:$,stco:w,udta:f,trackID:y&&y.trackID},m)}}(e,t);if(a.udta){var s=wk(a.udta,"meta");i=s&&s.vid}a.videoCodec?r.videoMeta=a:r.audioMeta=a,n.write(mk.ftyp(o)),n.write(mk.moov(a))}})),{buffer:n.buffer,vid:i}},decryptBody:function(t,r,n,i,o,a){var s=new _k;try{var u=new hk,c=null,l=null;t.boxes.forEach((function(e){if("styp"===e.type||"sidx"===e.type)u.write(mk.size(e.size)),u.write(mk.type(e.type)),u.write(new Uint8Array(e.data));else if("moof"===e.type){c=wk(e,"senc");var t=wk(e,"saio"),d=wk(e,"saiz"),f=wk(e,"tfhd");l=wk(e,"trun");var h=0;c&&c.samples.length?(h=c.data.byteLength+8,t&&t.data&&(h=h+t.data.byteLength+8),d&&d.data&&(h=h+d.data.byteLength+8)):(f&&2&f.flags&&(h=4),c=null);!function e(t){var r=t.size,n=t.type;if("saio"!==n&&"saiz"!==n&&"senc"!==n)if("moof"!==n&&"traf"!==n||(r-=h),"tfhd"===n&&2&f.flags)u.write(mk.tfhd(f));else if(u.write(mk.size(r)),u.write(mk.type(n)),t.subBox&&t.subBox.length)t.subBox.forEach((function(t){e(t)}));else if("trun"===n){var i=new DataView(t.data,0);i.setInt32(8,i.getInt32(8)-h),u.write(new Uint8Array(i.buffer))}else u.write(new Uint8Array(t.data))}(e)}else"mdat"===e.type&&(u.write(mk.size(e.size)),u.write(mk.type(e.type)),c?a?Pk.decryptWithRaw(c,l,e,n,i,o).then((function(e){e?(u.write(e),s.resolve(u.buffer)):s.resolve(null)})):Pk.decryptWithCryptoJsWord(c,l,e,r,n,i).then((function(e){e?(u.write(e),s.resolve(u.buffer)):s.resolve(null)})):(u.write(new Uint8Array(e.data)),s.resolve(u.buffer)))}))}catch(e){Tk.mse("%c dashplayer:mse decrypt body error","color:orange"),s.resolve(null)}return s},decryptWithCryptoJsWord:function(e,t,r,n,i,o){var a=new _k;try{var s=new hk,u=new Uint8Array(r.data);e.samples.forEach((function(e,r){var i=e.InitializationVector;if(e.subsamples&&e.subsamples.length){var o=[],a=[];e.subsamples.forEach((function(e){var t=e.BytesOfClearData+e.BytesOfProtectedData,r=u.slice(0,t);o.push(r.slice(0,e.BytesOfClearData)),a.push(r.slice(e.BytesOfClearData)),u=u.slice(t)}));var c=new hk;c.write.apply(c,a);var l=Pk.decryptWordArray(c.buffer,n,i);o.forEach((function(e,t){var r=a[t].length,n=l.slice(0,r);s.write(e),s.write(n),l=l.slice(r)}))}else{var d=t.samples[r];s.write(Pk.decryptWordArray(u.slice(0,d),n,i)),u=u.slice(d)}}));var c=s.buffer;a.resolve(c)}catch(error){Tk.mse("%c dashplayer:mse decryptWithCryptoJsWord error","color:orange"),a.resolve(null)}return a},decryptWithRaw:function(e,t,r,n,i,o){var a=new _k,s=new hk,u=new Uint8Array(r.data),c=[];return e.samples.forEach((function(e,r){var n=e.InitializationVector;if(e.subsamples&&e.subsamples.length){var i=[],o=[];e.subsamples.forEach((function(e){var t=e.BytesOfClearData+e.BytesOfProtectedData,r=u.slice(0,t);i.push(r.slice(0,e.BytesOfClearData)),o.push(r.slice(e.BytesOfClearData)),u=u.slice(t)})),c.push({iv:n,encodeBuffers:i,encData:o})}else{var a=t.samples[r];c.push({iv:n,encData:[u.slice(0,a)]}),u=u.slice(a)}})),this.decryptSamples(c,s,a,o),a},decryptSamples:function(e,t,n,i){if(e.length>0){var o=e.shift(),a=o.encData,s=new hk;s.write.apply(s,r(a)),Pk.decryptSample(s.buffer,o.iv,i).then((function(r){var s=o.encodeBuffers;if(s){var u=new Uint8Array(r);s.forEach((function(e,r){var n=a[r].length,i=u.slice(0,n);t.write(e),t.write(i),u=u.slice(n)}))}else t.write(new Uint8Array(r));Pk.decryptSamples(e,t,n,i)}),(function(){n.resolve(null),Tk.mse("%c dashplayer:mse decryptSamples err","color:orange")}))}else n.resolve(t.buffer)},decryptSample:function(e,t,r){var n=new Uint8Array(t);return $k.subtle.decrypt({name:"AES-CTR",counter:n.buffer,length:64},r,e)},decrypt:function(e,t,r){var n=ym.parse(t),i=ym.parse(cw.formatIV(r));return b_.decrypt(A_(e),n,{iv:i,mode:S_,padding:T_}).toString()},decryptWordArray:function(e,t,r){var n=ym.parse(t),i=ym.parse(cw.formatIV(r)),o=gm.create(new Uint8Array(e)),a=b_.decrypt(zm.create({ciphertext:o}),n,{iv:i,mode:S_,padding:T_});return Pk.wordArrayToUint8Array(a)},wordArrayToUint8Array:function(e){for(var t=e.sigBytes,r=e.words,n=new Uint8Array(t),i=0,o=0;i!==t;){var a=r[o++];if(n[i++]=(4278190080&a)>>>24,i===t)break;if(n[i++]=(16711680&a)>>>16,i===t)break;if(n[i++]=(65280&a)>>>8,i===t)break;n[i++]=255&a}return n}};onmessage=function(e){var t=this;if("decryptBody"===e.data.method){var r=e.data.args;Pk.decryptBody(r.parsed,r.keyValue,r.isVideo,r.id,r.aeskey,r.useRaw).then((function(r){t.postMessage({method:"decryptBody",id:e.data.id,args:{data:r}})}))}else if("decryptHeader"===e.data.method){var n=Pk.decryptHeader(e.data.args.parsed,e.data.codecsType);this.postMessage({method:"decryptHeader",id:e.data.id,args:{data:n.buffer,vid:n.vid}})}else"log"===e.data.method&&e.data.value&&console.log&&(Tk.mse=console.log)}}()}),null),workerCount=3,Crypto=function(){function e(){_classCallCheck$1(this,e),EventEmitter(this),this.workerList=[],this.bodyId=0,this.isSwitchHeader=!1,this.workerIndex=0,this.init(),this.headerId=0,this.crypto=window.crypto||window.msCrypto,this.aeskey=null}return _createClass$1(e,[{key:"init",value:function(){for(var e=this,t=0;t<workerCount;t++){var r=new WorkerFactory$4;r.onmessage=function(t){e.emit(t.data.method,t.data)},r.postMessage({method:"log",value:LOGOPEN}),this.workerList.push(r)}}},{key:"importKeys",value:function(e){var t=this,r=new ProxyPromise,n=util$1.fromHex(e);return this.crypto.subtle.importKey("raw",n.buffer,{name:"AES-CTR",length:e.length},!1,["decrypt"]).then((function(e){t.aeskey=e,r.resolve()})),r}},{key:"updateHeaderId",value:function(){var e=this.bodyId+1;this.headerId=e,this.bodyId=e}},{key:"destroy",value:function(){this.workerList.forEach((function(e){e.terminate()})),this.workerList=[]}},{key:"decryptHeader",value:function(e,t){var r=this;return this.updateHeaderId(),new Promise((function(n){var i=new Parser(e),o=Math.floor(1e3*Math.random());r.workerList[0]&&r.workerList[0].postMessage({method:"decryptHeader",id:o,codecsType:t,args:{buf:e,parsed:i}});r.on("decryptHeader",(function e(t){t.id===o&&(r.off("decryptHeader",e),n({data:t.args.data,vid:t.args.vid}))}))}))}},{key:"decryptBody",value:function(e,t,r,n){var i=this,o=new Parser(e),a=i.bodyId+1;return i.bodyId=a,new Promise((function(e){i.on("decryptBody",(function t(r){r.id===a&&(i.off("decryptBody",t),e({data:r.args.data,id:a,headerId:i.headerId}))})),i.workerList[i.workerIndex]&&i.workerList[i.workerIndex].postMessage({method:"decryptBody",id:a,args:{parsed:o,keyValue:t,isVideo:r,id:i.workerIndex,aeskey:i.aeskey,useRaw:n}}),i.workerIndex=i.workerIndex+1,i.workerIndex>=workerCount&&(i.workerIndex=0)}))}}]),e}(),Crypto$1=Crypto,createTypedArrayConstructor$4=typedArrayConstructor.exports;createTypedArrayConstructor$4("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var createTypedArrayConstructor$3=typedArrayConstructor.exports;createTypedArrayConstructor$3("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var createTypedArrayConstructor$2=typedArrayConstructor.exports;createTypedArrayConstructor$2("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var createTypedArrayConstructor$1=typedArrayConstructor.exports;createTypedArrayConstructor$1("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var createTypedArrayConstructor=typedArrayConstructor.exports;createTypedArrayConstructor("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var $$E=_export$1,fails$x=fails$1m,$imul=Math.imul,FORCED$6=fails$x((function(){return-5!=$imul(4294967295,5)||2!=$imul.length}));$$E({target:"Math",stat:!0,forced:FORCED$6},{imul:function(e,t){var r=65535,n=+e,i=+t,o=r&n,a=r&i;return 0|o*a+((r&n>>>16)*a+o*(r&i>>>16)<<16>>>0)}});var mathSign=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1},sign=mathSign,abs=Math.abs,pow$1=Math.pow,EPSILON=pow$1(2,-52),EPSILON32=pow$1(2,-23),MAX32=pow$1(2,127)*(2-EPSILON32),MIN32=pow$1(2,-126),roundTiesToEven=function(e){return e+1/EPSILON-1/EPSILON},mathFround=Math.fround||function(e){var t,r,n=abs(e),i=sign(e);return n<MIN32?i*roundTiesToEven(n/MIN32/EPSILON32)*MIN32*EPSILON32:(r=(t=(1+EPSILON32/EPSILON)*n)-(t-n))>MAX32||r!=r?i*(1/0):i*r},$$D=_export$1,fround=mathFround;$$D({target:"Math",stat:!0},{fround:fround});var $$C=_export$1,floor$4=Math.floor,log$2=Math.log,LOG2E=Math.LOG2E;$$C({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-floor$4(log$2(e+.5)*LOG2E):32}});var $$B=_export$1,ceil$1=Math.ceil,floor$3=Math.floor;$$B({target:"Math",stat:!0},{trunc:function(e){return(e>0?floor$3:ceil$1)(e)}});var $$A=_export$1,uncurryThis$z=functionUncurryThis$1,getOwnPropertyDescriptor$4=objectGetOwnPropertyDescriptor$1.f,toLength$5=toLength$g,toString$g=toString$A,notARegExp=notARegexp,requireObjectCoercible$9=requireObjectCoercible$l,correctIsRegExpLogic=correctIsRegexpLogic,un$StartsWith=uncurryThis$z("".startsWith),stringSlice$9=uncurryThis$z("".slice),min$5=Math.min,CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("startsWith"),MDN_POLYFILL_BUG=!(CORRECT_IS_REGEXP_LOGIC||(descriptor=getOwnPropertyDescriptor$4(String.prototype,"startsWith"),!descriptor||descriptor.writable)),descriptor;$$A({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function(e){var t=toString$g(requireObjectCoercible$9(this));notARegExp(e);var r=toLength$5(min$5(arguments.length>1?arguments[1]:void 0,t.length)),n=toString$g(e);return un$StartsWith?un$StartsWith(t,n,r):stringSlice$9(t,r,r+n.length)===n}});var aw$1={exports:{}};!function(t,r){var n,i=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var r,i=void 0!==(t=t||{})?t:{},o={};for(r in i)i.hasOwnProperty(r)&&(o[r]=i[r]);if(i.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var a="";if(document.currentScript&&(a=document.currentScript.src),n&&(a=n),a=0!==a.indexOf("blob:")?a.substr(0,a.lastIndexOf("/")+1):"","object"!==("undefined"==typeof window?"undefined":_typeof$1(window))&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");var s,u=i.print||console.log.bind(console),c=i.printErr||console.warn.bind(console);for(r in o)o.hasOwnProperty(r)&&(i[r]=o[r]);function l(e){l.shown||(l.shown={}),l.shown[e]||(l.shown[e]=1,c(e))}o=null,i.arguments,Object.getOwnPropertyDescriptor(i,"arguments")||Object.defineProperty(i,"arguments",{configurable:!0,get:function(){F("Module.arguments has been replaced with plain arguments_")}}),i.thisProgram,Object.getOwnPropertyDescriptor(i,"thisProgram")||Object.defineProperty(i,"thisProgram",{configurable:!0,get:function(){F("Module.thisProgram has been replaced with plain thisProgram")}}),i.quit,Object.getOwnPropertyDescriptor(i,"quit")||Object.defineProperty(i,"quit",{configurable:!0,get:function(){F("Module.quit has been replaced with plain quit_")}}),g(void 0===i.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),g(void 0===i.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),g(void 0===i.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),g(void 0===i.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),g(void 0===i.read,"Module.read option was removed (modify read_ in JS)"),g(void 0===i.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),g(void 0===i.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),g(void 0===i.setWindowTitle,"Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),Object.getOwnPropertyDescriptor(i,"read")||Object.defineProperty(i,"read",{configurable:!0,get:function(){F("Module.read has been replaced with plain read_")}}),Object.getOwnPropertyDescriptor(i,"readAsync")||Object.defineProperty(i,"readAsync",{configurable:!0,get:function(){F("Module.readAsync has been replaced with plain readAsync")}}),Object.getOwnPropertyDescriptor(i,"readBinary")||Object.defineProperty(i,"readBinary",{configurable:!0,get:function(){F("Module.readBinary has been replaced with plain readBinary")}}),le=function(){F("cannot use the stack before compiled code is ready to run, and has provided stack access")},i.wasmBinary&&(s=i.wasmBinary),Object.getOwnPropertyDescriptor(i,"wasmBinary")||Object.defineProperty(i,"wasmBinary",{configurable:!0,get:function(){F("Module.wasmBinary has been replaced with plain wasmBinary")}}),i.noExitRuntime,Object.getOwnPropertyDescriptor(i,"noExitRuntime")||Object.defineProperty(i,"noExitRuntime",{configurable:!0,get:function(){F("Module.noExitRuntime has been replaced with plain noExitRuntime")}});var d,f={Memory:function(e){return{buffer:new ArrayBuffer(65536*e.initial),grow:function(e){var t=this.buffer,r=fe(e);return g(this.buffer!==t),r}}},Table:function(e){var t=new Array(e.initial);return t.grow=function(e){t.length>=1&&F("Unable to grow wasm table. Use a higher value for RESERVED_FUNCTION_POINTERS or set ALLOW_TABLE_GROWTH."),t.push(null)},t.set=function(e,r){t[e]=r},t.get=function(e){return t[e]},t},Module:function(e){return{}},Instance:function(e,t){var r;return{exports:(r=h,function(e,t,n){var i=t.memory,o=r,a=new e.Int8Array(n);new e.Int16Array(n);var s=new e.Int32Array(n),u=new e.Uint8Array(n);new e.Uint16Array(n);var c=new e.Uint32Array(n);new e.Float32Array(n),new e.Float64Array(n);var l=e.Math.imul;e.Math.fround,e.Math.abs,e.Math.clz32,e.Math.min,e.Math.max,e.Math.floor,e.Math.ceil,e.Math.sqrt,t.abort,e.NaN,e.Infinity;var d=t.emscripten_memcpy_big,f=t.emscripten_resize_heap,h=t.__unlock,p=t.__lock,g=9744;function y(e){var t,r=0;return t=E(),(e=(r=s[388])+e|0)>>>0<=t<<16>>>0||f(0|e)?(s[388]=e,r):(s[256]=48,-1)}function v(e){var t,r=0,n=0,i=0,o=0,a=0,l=0,d=0,f=0,h=0,p=0,v=0,m=0;g=t=g-16|0;e:{t:{r:{n:{i:{o:{a:{s:{u:{c:{l:{if((e|=0)>>>0<=244){if(3&(r=(a=s[261])>>>(e=(l=e>>>0<11?16:e+11&-8)>>>3))){e=(r=s[1092+(o=(n=e+(1&(-1^r))|0)<<3)>>2])+8|0,(0|(i=s[r+8>>2]))!=(0|(o=o+1084|0))?(s[i+12>>2]=o,s[o+8>>2]=i):(v=1044,m=A(n)&a,s[v>>2]=m),n<<=3,s[r+4>>2]=3|n,s[4+(r=r+n|0)>>2]=1|s[r+4>>2];break e}if(l>>>0<=(f=s[263])>>>0)break l;if(r){n=r=(e=(0-(e=(0-(n=2<<e)|n)&r<<e)&e)-1|0)>>>12&16,n|=r=(e>>>=r)>>>5&8,n|=r=(e>>>=r)>>>2&4,r=s[1092+(i=(n=((n|=r=(e>>>=r)>>>1&2)|(r=(e>>>=r)>>>1&1))+(e>>>r)|0)<<3)>>2],(0|(e=s[r+8>>2]))!=(0|(i=i+1084|0))?(s[e+12>>2]=i,s[i+8>>2]=e):(a=A(n)&a,s[261]=a),e=r+8|0,s[r+4>>2]=3|l,o=(n<<=3)-l|0,s[4+(d=r+l|0)>>2]=1|o,s[r+n>>2]=o,f&&(r=1084+((n=f>>>3)<<3)|0,i=s[266],(n=1<<n)&a?n=s[r+8>>2]:(s[261]=n|a,n=r),s[r+8>>2]=i,s[n+12>>2]=i,s[i+12>>2]=r,s[i+8>>2]=n),s[266]=d,s[263]=o;break e}if(!(p=s[262]))break l;for(n=r=(e=(p&0-p)-1|0)>>>12&16,n|=r=(e>>>=r)>>>5&8,n|=r=(e>>>=r)>>>2&4,r=s[1348+(((n|=r=(e>>>=r)>>>1&2)|(r=(e>>>=r)>>>1&1))+(e>>>r)<<2)>>2],i=(-8&s[r+4>>2])-l|0,n=r;(e=s[n+16>>2])||(e=s[n+20>>2]);)i=(n=(o=(-8&s[e+4>>2])-l|0)>>>0<i>>>0)?o:i,r=n?e:r,n=e;if(h=s[r+24>>2],(0|(o=s[r+12>>2]))!=(0|r)){e=s[r+8>>2],s[e+12>>2]=o,s[o+8>>2]=e;break t}if(!(e=s[(n=r+20|0)>>2])){if(!(e=s[r+16>>2]))break c;n=r+16|0}for(;d=n,o=e,(e=s[(n=e+20|0)>>2])||(n=o+16|0,e=s[o+16>>2]););s[d>>2]=0;break t}if(l=-1,!(e>>>0>4294967231)&&(l=-8&(r=e+11|0),f=s[262])){n=0-l|0,a=0,(r>>>=8)&&(a=31,l>>>0>16777215||(a=28+((e=((a=(r<<=i=r+1048320>>>16&8)<<(e=r+520192>>>16&4))<<(r=a+245760>>>16&2)>>>15)-(r|e|i)|0)<<1|l>>>e+21&1)|0));d:{f:{if(i=s[1348+(a<<2)>>2])for(r=l<<(31==(0|a)?0:25-(a>>>1)|0),e=0;;){if(!((d=(-8&s[i+4>>2])-l|0)>>>0>=n>>>0||(o=i,n=d))){n=0,e=i;break f}if(d=s[i+20>>2],i=s[16+((r>>>29&4)+i|0)>>2],e=d?(0|d)==(0|i)?e:d:e,r<<=0!=(0|i),!i)break}else e=0;if(!(e|o)){if(!(e=(0-(e=2<<a)|e)&f))break l;i=r=(e=(e&0-e)-1|0)>>>12&16,i|=r=(e>>>=r)>>>5&8,i|=r=(e>>>=r)>>>2&4,e=s[1348+(((i|=r=(e>>>=r)>>>1&2)|(r=(e>>>=r)>>>1&1))+(e>>>r)<<2)>>2]}if(!e)break d}for(;n=(r=(i=(-8&s[e+4>>2])-l|0)>>>0<n>>>0)?i:n,o=r?e:o,e=(r=s[e+16>>2])||s[e+20>>2];);}if(!(!o|n>>>0>=s[263]-l>>>0)){if(d=s[o+24>>2],(0|o)!=(0|(r=s[o+12>>2]))){e=s[o+8>>2],s[e+12>>2]=r,s[r+8>>2]=e;break r}if(!(e=s[(i=o+20|0)>>2])){if(!(e=s[o+16>>2]))break u;i=o+16|0}for(;a=i,r=e,(e=s[(i=e+20|0)>>2])||(i=r+16|0,e=s[r+16>>2]););s[a>>2]=0;break r}}}if((r=s[263])>>>0>=l>>>0){e=s[266],(n=r-l|0)>>>0>=16?(s[263]=n,i=e+l|0,s[266]=i,s[i+4>>2]=1|n,s[e+r>>2]=n,s[e+4>>2]=3|l):(s[266]=0,s[263]=0,s[e+4>>2]=3|r,s[4+(r=e+r|0)>>2]=1|s[r+4>>2]),e=e+8|0;break e}if((i=s[264])>>>0>l>>>0){r=i-l|0,s[264]=r,n=(e=s[267])+l|0,s[267]=n,s[n+4>>2]=1|r,s[e+4>>2]=3|l,e=e+8|0;break e}if(e=0,n=o=l+47|0,s[379]?r=s[381]:(s[382]=-1,s[383]=-1,s[380]=4096,s[381]=4096,s[379]=t+12&-16^1431655768,s[384]=0,s[372]=0,r=4096),(n=(a=n+r|0)&(d=0-r|0))>>>0<=l>>>0)break e;if((r=s[371])&&(h=(f=s[369])+n|0)>>>0<=f>>>0|h>>>0>r>>>0)break e;if(4&u[1488])break o;l:{d:{if(r=s[267])for(e=1492;;){if((f=s[e>>2])+s[e+4>>2]>>>0>r>>>0&&f>>>0<=r>>>0)break d;if(!(e=s[e+8>>2]))break}if(-1==(0|(r=y(0))))break a;if(a=n,(i=(e=s[380])+-1|0)&r&&(a=(n-r|0)+(r+i&0-e)|0),a>>>0<=l>>>0|a>>>0>2147483646)break a;if((e=s[371])&&(d=(i=s[369])+a|0)>>>0<=i>>>0|d>>>0>e>>>0)break a;if((0|r)!=(0|(e=y(a))))break l;break i}if((a=d&a-i)>>>0>2147483646)break a;if((0|(r=y(a)))==(s[e>>2]+s[e+4>>2]|0))break s;e=r}if(r=e,!(l+48>>>0<=a>>>0|a>>>0>2147483646|-1==(0|e))){if((e=(e=s[381])+(o-a|0)&0-e)>>>0>2147483646)break i;if(-1!=(0|y(e))){a=e+a|0;break i}y(0-a|0);break a}if(-1!=(0|r))break i;break a}o=0;break t}r=0;break r}if(-1!=(0|r))break i}s[372]=4|s[372]}if(n>>>0>2147483646)break n;if((r=y(n))>>>0>=(e=y(0))>>>0|-1==(0|r)|-1==(0|e))break n;if((a=e-r|0)>>>0<=l+40>>>0)break n}e=s[369]+a|0,s[369]=e,e>>>0>c[370]&&(s[370]=e);i:{o:{a:{if(n=s[267]){for(e=1492;;){if(((i=s[e>>2])+(o=s[e+4>>2])|0)==(0|r))break a;if(!(e=s[e+8>>2]))break}break o}for(r>>>0>=(e=s[265])>>>0&&e||(s[265]=r),e=0,s[374]=a,s[373]=r,s[269]=-1,s[270]=s[379],s[376]=0;i=1084+(n=e<<3)|0,s[n+1092>>2]=i,s[n+1096>>2]=i,32!=(0|(e=e+1|0)););i=(e=a+-40|0)-(n=r+8&7?-8-r&7:0)|0,s[264]=i,n=r+n|0,s[267]=n,s[n+4>>2]=1|i,s[4+(e+r|0)>>2]=40,s[268]=s[383];break i}if(!(8&u[e+12|0]|r>>>0<=n>>>0|i>>>0>n>>>0)){s[e+4>>2]=o+a,r=(e=n+8&7?-8-n&7:0)+n|0,s[267]=r,e=(i=s[264]+a|0)-e|0,s[264]=e,s[r+4>>2]=1|e,s[4+(n+i|0)>>2]=40,s[268]=s[383];break i}}r>>>0<(o=s[265])>>>0&&(s[265]=r,o=0),i=r+a|0,e=1492;o:{a:{s:{u:{c:{l:{for(;;){if((0|i)!=s[e>>2]){if(e=s[e+8>>2])continue;break l}break}if(!(8&u[e+12|0]))break c}for(e=1492;;){if((i=s[e>>2])>>>0<=n>>>0&&(o=i+s[e+4>>2]|0)>>>0>n>>>0)break u;e=s[e+8>>2]}}if(s[e>>2]=r,s[e+4>>2]=s[e+4>>2]+a,s[4+(h=(r+8&7?-8-r&7:0)+r|0)>>2]=3|l,e=((r=i+(i+8&7?-8-i&7:0)|0)-h|0)-l|0,d=l+h|0,(0|r)==(0|n)){s[267]=d,e=s[264]+e|0,s[264]=e,s[d+4>>2]=1|e;break a}if(s[266]==(0|r)){s[266]=d,e=s[263]+e|0,s[263]=e,s[d+4>>2]=1|e,s[e+d>>2]=e;break a}if(1==(3&(n=s[r+4>>2]))){p=-8&n;c:if(n>>>0<=255){if(o=n>>>3,n=s[r+8>>2],(0|(i=s[r+12>>2]))==(0|n)){v=1044,m=s[261]&A(o),s[v>>2]=m;break c}s[n+12>>2]=i,s[i+8>>2]=n}else{if(f=s[r+24>>2],(0|(a=s[r+12>>2]))==(0|r))if((l=s[(i=r+20|0)>>2])||(l=s[(i=r+16|0)>>2])){for(;n=i,a=l,(l=s[(i=l+20|0)>>2])||(i=a+16|0,l=s[a+16>>2]););s[n>>2]=0}else a=0;else n=s[r+8>>2],s[n+12>>2]=a,s[a+8>>2]=n;if(f){n=s[r+28>>2];l:{if(s[(i=1348+(n<<2)|0)>>2]==(0|r)){if(s[i>>2]=a,a)break l;v=1048,m=s[262]&A(n),s[v>>2]=m;break c}if(s[f+(s[f+16>>2]==(0|r)?16:20)>>2]=a,!a)break c}s[a+24>>2]=f,(n=s[r+16>>2])&&(s[a+16>>2]=n,s[n+24>>2]=a),(n=s[r+20>>2])&&(s[a+20>>2]=n,s[n+24>>2]=a)}}r=r+p|0,e=e+p|0}if(s[r+4>>2]=-2&s[r+4>>2],s[d+4>>2]=1|e,s[e+d>>2]=e,e>>>0<=255){e=1084+((r=e>>>3)<<3)|0,(n=s[261])&(r=1<<r)?r=s[e+8>>2]:(s[261]=r|n,r=e),s[e+8>>2]=d,s[r+12>>2]=d,s[d+12>>2]=e,s[d+8>>2]=r;break a}if(r=0,(i=e>>>8)&&(r=31,e>>>0>16777215||(r=28+((r=((l=(i<<=o=i+1048320>>>16&8)<<(r=i+520192>>>16&4))<<(i=l+245760>>>16&2)>>>15)-(i|r|o)|0)<<1|e>>>r+21&1)|0)),s[(n=d)+28>>2]=r,s[d+16>>2]=0,s[d+20>>2]=0,n=1348+(r<<2)|0,(i=s[262])&(o=1<<r)){for(i=e<<(31==(0|r)?0:25-(r>>>1)|0),r=s[n>>2];;){if(n=r,(-8&s[r+4>>2])==(0|e))break s;if(r=i>>>29,i<<=1,!(r=s[16+(o=(4&r)+n|0)>>2]))break}s[o+16>>2]=d}else s[262]=i|o,s[n>>2]=d;s[d+24>>2]=n,s[d+12>>2]=d,s[d+8>>2]=d;break a}for(d=(e=a+-40|0)-(i=r+8&7?-8-r&7:0)|0,s[264]=d,i=r+i|0,s[267]=i,s[i+4>>2]=1|d,s[4+(e+r|0)>>2]=40,s[268]=s[383],s[(i=(e=(o+(o+-39&7?39-o&7:0)|0)-47|0)>>>0<n+16>>>0?n:e)+4>>2]=27,e=s[376],s[i+16>>2]=s[375],s[i+20>>2]=e,e=s[374],s[i+8>>2]=s[373],s[i+12>>2]=e,s[375]=i+8,s[374]=a,s[373]=r,s[376]=0,e=i+24|0;s[e+4>>2]=7,r=e+8|0,e=e+4|0,r>>>0<o>>>0;);if((0|n)==(0|i))break i;if(s[i+4>>2]=-2&s[i+4>>2],o=i-n|0,s[n+4>>2]=1|o,s[i>>2]=o,o>>>0<=255){e=1084+((r=o>>>3)<<3)|0,(i=s[261])&(r=1<<r)?r=s[e+8>>2]:(s[261]=r|i,r=e),s[e+8>>2]=n,s[r+12>>2]=n,s[n+12>>2]=e,s[n+8>>2]=r;break i}if(s[n+16>>2]=0,s[n+20>>2]=0,e=0,(i=o>>>8)&&(e=31,o>>>0>16777215||(e=28+((e=((d=(i<<=a=i+1048320>>>16&8)<<(e=i+520192>>>16&4))<<(i=d+245760>>>16&2)>>>15)-(i|e|a)|0)<<1|o>>>e+21&1)|0)),s[(r=n)+28>>2]=e,r=1348+(e<<2)|0,(i=s[262])&(a=1<<e)){for(e=o<<(31==(0|e)?0:25-(e>>>1)|0),r=s[r>>2];;){if(i=r,(0|o)==(-8&s[r+4>>2]))break o;if(r=e>>>29,e<<=1,!(r=s[16+(a=i+(4&r)|0)>>2]))break}s[a+16>>2]=n,s[n+24>>2]=i}else s[262]=i|a,s[r>>2]=n,s[n+24>>2]=r;s[n+12>>2]=n,s[n+8>>2]=n;break i}e=s[n+8>>2],s[e+12>>2]=d,s[n+8>>2]=d,s[d+24>>2]=0,s[d+12>>2]=n,s[d+8>>2]=e}e=h+8|0;break e}e=s[i+8>>2],s[e+12>>2]=n,s[i+8>>2]=n,s[n+24>>2]=0,s[n+12>>2]=i,s[n+8>>2]=e}if(!((e=s[264])>>>0<=l>>>0)){r=e-l|0,s[264]=r,n=(e=s[267])+l|0,s[267]=n,s[n+4>>2]=1|r,s[e+4>>2]=3|l,e=e+8|0;break e}}s[256]=48,e=0;break e}r:if(d){e=s[o+28>>2];n:{if(s[(i=1348+(e<<2)|0)>>2]==(0|o)){if(s[i>>2]=r,r)break n;f=A(e)&f,s[262]=f;break r}if(s[d+(s[d+16>>2]==(0|o)?16:20)>>2]=r,!r)break r}s[r+24>>2]=d,(e=s[o+16>>2])&&(s[r+16>>2]=e,s[e+24>>2]=r),(e=s[o+20>>2])&&(s[r+20>>2]=e,s[e+24>>2]=r)}r:if(n>>>0<=15)e=n+l|0,s[o+4>>2]=3|e,s[4+(e=e+o|0)>>2]=1|s[e+4>>2];else if(s[o+4>>2]=3|l,s[4+(i=o+l|0)>>2]=1|n,s[n+i>>2]=n,n>>>0<=255)e=1084+((r=n>>>3)<<3)|0,(n=s[261])&(r=1<<r)?r=s[e+8>>2]:(s[261]=r|n,r=e),s[e+8>>2]=i,s[r+12>>2]=i,s[i+12>>2]=e,s[i+8>>2]=r;else{e=0,(l=n>>>8)&&(e=31,n>>>0>16777215||(e=28+((e=((d=(l<<=a=l+1048320>>>16&8)<<(e=l+520192>>>16&4))<<(l=d+245760>>>16&2)>>>15)-(l|e|a)|0)<<1|n>>>e+21&1)|0)),s[(r=i)+28>>2]=e,s[i+16>>2]=0,s[i+20>>2]=0,r=1348+(e<<2)|0;n:{if((l=1<<e)&f){for(e=n<<(31==(0|e)?0:25-(e>>>1)|0),l=s[r>>2];;){if((-8&s[(r=l)+4>>2])==(0|n))break n;if(l=e>>>29,e<<=1,!(l=s[16+(a=(4&l)+r|0)>>2]))break}s[a+16>>2]=i}else s[262]=l|f,s[r>>2]=i;s[i+24>>2]=r,s[i+12>>2]=i,s[i+8>>2]=i;break r}e=s[r+8>>2],s[e+12>>2]=i,s[r+8>>2]=i,s[i+24>>2]=0,s[i+12>>2]=r,s[i+8>>2]=e}e=o+8|0;break e}t:if(h){e=s[r+28>>2];r:{if(s[(n=1348+(e<<2)|0)>>2]==(0|r)){if(s[n>>2]=o,o)break r;v=1048,m=A(e)&p,s[v>>2]=m;break t}if(s[h+(s[h+16>>2]==(0|r)?16:20)>>2]=o,!o)break t}s[o+24>>2]=h,(e=s[r+16>>2])&&(s[o+16>>2]=e,s[e+24>>2]=o),(e=s[r+20>>2])&&(s[o+20>>2]=e,s[e+24>>2]=o)}i>>>0<=15?(e=i+l|0,s[r+4>>2]=3|e,s[4+(e=e+r|0)>>2]=1|s[e+4>>2]):(s[r+4>>2]=3|l,s[4+(l=r+l|0)>>2]=1|i,s[i+l>>2]=i,f&&(e=1084+((n=f>>>3)<<3)|0,o=s[266],(n=1<<n)&a?n=s[e+8>>2]:(s[261]=n|a,n=e),s[e+8>>2]=o,s[n+12>>2]=o,s[o+12>>2]=e,s[o+8>>2]=n),s[266]=l,s[263]=i),e=r+8|0}return g=t+16|0,0|e}function m(e){var t=0,r=0,n=0,i=0,o=0,a=0,u=0,l=0,d=0;e:if(e|=0){o=(n=e+-8|0)+(e=-8&(r=s[e+-4>>2]))|0;t:if(!(1&r)){if(!(3&r))break e;if((n=n-(r=s[n>>2])|0)>>>0<c[265])break e;if(e=e+r|0,s[266]==(0|n)){if(3==(3&(r=s[o+4>>2])))return s[263]=e,s[o+4>>2]=-2&r,s[n+4>>2]=1|e,void(s[e+n>>2]=e)}else{if(r>>>0<=255){if(i=s[n+8>>2],r>>>=3,(0|(t=s[n+12>>2]))==(0|i)){l=1044,d=s[261]&A(r),s[l>>2]=d;break t}s[i+12>>2]=t,s[t+8>>2]=i;break t}if(u=s[n+24>>2],(0|n)==(0|(r=s[n+12>>2])))if((t=s[(i=n+20|0)>>2])||(t=s[(i=n+16|0)>>2])){for(;a=i,(t=s[(i=(r=t)+20|0)>>2])||(i=r+16|0,t=s[r+16>>2]););s[a>>2]=0}else r=0;else t=s[n+8>>2],s[t+12>>2]=r,s[r+8>>2]=t;if(!u)break t;i=s[n+28>>2];r:{if(s[(t=1348+(i<<2)|0)>>2]==(0|n)){if(s[t>>2]=r,r)break r;l=1048,d=s[262]&A(i),s[l>>2]=d;break t}if(s[u+(s[u+16>>2]==(0|n)?16:20)>>2]=r,!r)break t}if(s[r+24>>2]=u,(t=s[n+16>>2])&&(s[r+16>>2]=t,s[t+24>>2]=r),!(t=s[n+20>>2]))break t;s[r+20>>2]=t,s[t+24>>2]=r}}if(!(o>>>0<=n>>>0)&&1&(r=s[o+4>>2])){t:{if(!(2&r)){if(s[267]==(0|o)){if(s[267]=n,e=s[264]+e|0,s[264]=e,s[n+4>>2]=1|e,s[266]!=(0|n))break e;return s[263]=0,void(s[266]=0)}if(s[266]==(0|o))return s[266]=n,e=s[263]+e|0,s[263]=e,s[n+4>>2]=1|e,void(s[e+n>>2]=e);e=(-8&r)+e|0;r:if(r>>>0<=255){if(r>>>=3,(0|(t=s[o+8>>2]))==(0|(i=s[o+12>>2]))){l=1044,d=s[261]&A(r),s[l>>2]=d;break r}s[t+12>>2]=i,s[i+8>>2]=t}else{if(u=s[o+24>>2],(0|o)==(0|(r=s[o+12>>2])))if((t=s[(i=o+20|0)>>2])||(t=s[(i=o+16|0)>>2])){for(;a=i,(t=s[(i=(r=t)+20|0)>>2])||(i=r+16|0,t=s[r+16>>2]););s[a>>2]=0}else r=0;else t=s[o+8>>2],s[t+12>>2]=r,s[r+8>>2]=t;if(u){i=s[o+28>>2];n:{if(s[(t=1348+(i<<2)|0)>>2]==(0|o)){if(s[t>>2]=r,r)break n;l=1048,d=s[262]&A(i),s[l>>2]=d;break r}if(s[u+(s[u+16>>2]==(0|o)?16:20)>>2]=r,!r)break r}s[r+24>>2]=u,(t=s[o+16>>2])&&(s[r+16>>2]=t,s[t+24>>2]=r),(t=s[o+20>>2])&&(s[r+20>>2]=t,s[t+24>>2]=r)}}if(s[n+4>>2]=1|e,s[e+n>>2]=e,s[266]!=(0|n))break t;return void(s[263]=e)}s[o+4>>2]=-2&r,s[n+4>>2]=1|e,s[e+n>>2]=e}if(e>>>0<=255)return r=1084+((e>>>=3)<<3)|0,(t=s[261])&(e=1<<e)?e=s[r+8>>2]:(s[261]=e|t,e=r),s[r+8>>2]=n,s[e+12>>2]=n,s[n+12>>2]=r,void(s[n+8>>2]=e);s[n+16>>2]=0,s[n+20>>2]=0,t=0,(i=e>>>8)&&(t=31,e>>>0>16777215||(t=i,t<<=i=i+1048320>>>16&8,t=28+((t=((t<<=u=t+520192>>>16&4)<<(a=t+245760>>>16&2)>>>15)-(a|i|u)|0)<<1|e>>>t+21&1)|0)),s[(r=n)+28>>2]=t,a=1348+(t<<2)|0;t:if((i=s[262])&(r=1<<t)){i=e<<(31==(0|t)?0:25-(t>>>1)|0),r=s[a>>2];r:{for(;;){if(t=r,(-8&s[r+4>>2])==(0|e))break r;if(r=i>>>29,i<<=1,!(r=s[16+(a=t+(4&r)|0)>>2]))break}s[a+16>>2]=n,s[n+12>>2]=n,s[n+24>>2]=t,s[n+8>>2]=n;break t}e=s[t+8>>2],s[e+12>>2]=n,s[t+8>>2]=n,s[n+24>>2]=0,s[n+12>>2]=t,s[n+8>>2]=e}else s[262]=r|i,s[a>>2]=n,s[n+12>>2]=n,s[n+24>>2]=a,s[n+8>>2]=n;if(e=s[269]+-1|0,s[269]=e,!e){for(n=1500;n=(e=s[n>>2])+8|0,e;);s[269]=-1}}}}function _(e){var t,r=0;return c[e+20>>2]<=c[e+28>>2]||(o[s[e+36>>2]](e,0,0),s[e+20>>2])?((r=s[e+4>>2])>>>0<(t=s[e+8>>2])>>>0&&(r=r-t|0,o[s[e+40>>2]](e,r,r>>31,1)),s[e+28>>2]=0,s[e+16>>2]=0,s[e+20>>2]=0,s[e+4>>2]=0,s[e+8>>2]=0,0):-1}function b(e){for(var t=0,r=0;r=t,e;)e&=e-1,t=t+1|0;return r}function A(e){var t;return(-1>>>(t=31&e)&-2)<<t|(-1<<(e=0-e&31)&-2)>>>e}function E(){return n.byteLength/65536|0}return{__wasm_call_ctors:function(){},malloc:v,openBox:function(e,t){e|=0,t|=0;var r,n,i,o=0;return g=r=g-16|0,s[r+12>>2]=0,s[r+8>>2]=0,s[r+4>>2]=0,s[r>>2]=0,function(e,t,r,n,i,o){var c=0,l=0,d=0,f=0,h=0,p=0;if(c=(u[e+2|0]^u[e+1|0]^u[0|e])<<24>>24,s[o>>2]=c+-48,c=47+(t-c|0)|0,s[n>>2]=c,h=r,p=v(c),s[h>>2]=p,l=s[o>>2],d=v(l),s[i>>2]=d,(0|l)>0)for(c=l;;){if(d=(l-c|0)+d|0,l=(t-l|0)+e|0,a[0|d]=u[(t-c|0)+e|0]^u[l+-1|0]^u[l+-2|0],(0|(c=c+-1|0))<1){c=s[n>>2];break}d=s[i>>2],l=s[o>>2]}if((0|c)>0)for(;t=s[r>>2]+f|0,f=f+1|0,a[0|t]=u[f+e|0],(0|f)<s[n>>2];);}(e,t,r+12|0,r+4|0,r+8|0,r),function(e,t){var r=0,n=0,i=0,o=0,s=0,c=0,l=0;if((0|t)>=1)for(i=85,o=250;n=b(r),s=u[0|(c=e+r|0)],l=n,n=1&r,a[0|c]=l+(21+((s^(n?i:o))<<24>>24)|0),o=n?o:s,i=n?s:i,(0|(r=r+1|0))!=(0|t););}(e=s[r+12>>2],t=s[r+4>>2]),n=function(e){var t=0;return(255&(t=e+-48|0))>>>0<=9?t<<24>>24:((e+-97&255)>>>0<26?e+-87|0:-1)<<24>>24}(a[0|e]),s[r>>2]=n,i=v(o=t-n|0),a[i+(o=o+-1|0)|0]=0,(0|o)>=1&&function(e,t,r){var n,i=0;if(r>>>0>=8192)d(0|e,0|t,0|r);else{n=e+r|0;e:if(3&(e^t))if(n>>>0<4)r=e;else if((i=n+-4|0)>>>0<e>>>0)r=e;else for(r=e;a[0|r]=u[0|t],a[r+1|0]=u[t+1|0],a[r+2|0]=u[t+2|0],a[r+3|0]=u[t+3|0],t=t+4|0,(r=r+4|0)>>>0<=i>>>0;);else{t:if((0|r)<1)r=e;else if(3&e)for(r=e;;){if(a[0|r]=u[0|t],t=t+1|0,(r=r+1|0)>>>0>=n>>>0)break t;if(!(3&r))break}else r=e;if(!((e=-4&n)>>>0<64||r>>>0>(i=e+-64|0)>>>0))for(;s[r>>2]=s[t>>2],s[r+4>>2]=s[t+4>>2],s[r+8>>2]=s[t+8>>2],s[r+12>>2]=s[t+12>>2],s[r+16>>2]=s[t+16>>2],s[r+20>>2]=s[t+20>>2],s[r+24>>2]=s[t+24>>2],s[r+28>>2]=s[t+28>>2],s[r+32>>2]=s[t+32>>2],s[r+36>>2]=s[t+36>>2],s[r+40>>2]=s[t+40>>2],s[r+44>>2]=s[t+44>>2],s[r+48>>2]=s[t+48>>2],s[r+52>>2]=s[t+52>>2],s[r+56>>2]=s[t+56>>2],s[r+60>>2]=s[t+60>>2],t=t- -64|0,(r=r- -64|0)>>>0<=i>>>0;);if(r>>>0>=e>>>0)break e;for(;s[r>>2]=s[t>>2],t=t+4|0,(r=r+4|0)>>>0<e>>>0;);}if(r>>>0<n>>>0)for(;a[0|r]=u[0|t],t=t+1|0,(0|n)!=(0|(r=r+1|0)););}}(i,e+1|0,t+(-1^n)|0),m(e),m(s[r+8>>2]),g=r+16|0,0|i},free:m,__errno_location:function(){return 1024},fflush:function e(t){var r=0;if(t|=0)return s[t+76>>2],0|_(t);if(s[260]&&(r=e(s[260])),p(1028),t=s[259])for(;c[t+20>>2]>c[t+28>>2]&&(r=_(t)|r),t=s[t+56>>2];);return h(1028),0|r},setThrew:function(e,t){e|=0,t|=0,s[385]||(s[386]=t,s[385]=e)},stackSave:function(){return 0|g},stackAlloc:function(e){return g=e=g-(e|=0)&-16,0|e},stackRestore:function(e){g=e|=0},__growWasmMemory:function(t){return 0|function(t){t|=0;var r=0|E(),o=r+t|0;if(r<o&&o<65536){var d=new ArrayBuffer(l(o,65536)),f=new e.Int8Array(d);f.set(a),a=f,a=new e.Int8Array(d),new e.Int16Array(d),s=new e.Int32Array(d),u=new e.Uint8Array(d),new e.Uint16Array(d),c=new e.Uint32Array(d),new e.Float32Array(d),new e.Float64Array(d),n=d,i.buffer=d}return r}(0|(t|=0))}}}({Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0,Math:Math},X,d.buffer))}},instantiate:function(e,t){return{then:function(r,n){r({instance:new f.Instance(new f.Module(e,t))})}}},RuntimeError:Error};s=[],"object"!==_typeof$1(f)&&F("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead.");var h=new f.Table({initial:1,maximum:1,element:"anyfunc"}),p=!1;function g(e,t){e||F("Assertion failed: "+t)}var y,v,m,_,b,A="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,r,n){if(!(n>0))return 0;for(var i=r,o=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=o)break;t[r++]=s}else if(s<=2047){if(r+1>=o)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=o)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+3>=o)break;s>=2097152&&l("Invalid Unicode code point 0x"+s.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-i}function S(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}function T(e,t){return e%t>0&&(e+=t-e%t),e}function $(e){y=e,i.HEAP8=v=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=_=new Int32Array(e),i.HEAPU8=m=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=b=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var w=1712;g(!0,"stack must start aligned"),g(!0,"heap must start aligned");var C=8192;i.TOTAL_STACK&&g(C===i.TOTAL_STACK,"the stack size can no longer be determined at runtime");var I=i.TOTAL_MEMORY||65536;function k(){g(!0),b[429]=34821223,b[430]=2310721022,_[0]=1668509029}function O(){var e=b[429],t=b[430];34821223==e&&2310721022==t||F("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+t.toString(16)+" "+e.toString(16)),1668509029!==_[0]&&F("Runtime error: The application has corrupted its heap memory area (address zero)!")}function P(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?i.dynCall_v(r):i.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}Object.getOwnPropertyDescriptor(i,"TOTAL_MEMORY")||Object.defineProperty(i,"TOTAL_MEMORY",{configurable:!0,get:function(){F("Module.TOTAL_MEMORY has been replaced with plain INITIAL_TOTAL_MEMORY")}}),g(I>=C,"TOTAL_MEMORY should be larger than TOTAL_STACK, was "+I+"! (TOTAL_STACK=8192)"),g("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),(d=i.wasmMemory?i.wasmMemory:new f.Memory({initial:I/65536}))&&(y=d.buffer),g((I=y.byteLength)%65536==0),$(y),_[388]=9904,function(){var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian!"}();var R=[],x=[],D=[],L=[],N=!1;g(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),g(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),g(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),g(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var M=0,B=null,U=null,j={};function F(t){throw i.onAbort&&i.onAbort(t),u(t+=""),c(t),p=!0,t="abort("+t+") at "+(n=function(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}(),i.extraStackTrace&&(n+="\n"+i.extraStackTrace()),r=/\b_Z[\w\d_]+/g,n.replace(r,(function(e){var t,r=(t=e,l("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),t);return e===r?e:r+" ["+e+"]"}))),new f.RuntimeError(t);var r,n}i.preloadedImages={},i.preloadedAudios={};var V={error:function(){F("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){V.error()},createDataFile:function(){V.error()},createPreloadedFile:function(){V.error()},createLazyFile:function(){V.error()},open:function(){V.error()},mkdev:function(){V.error()},registerDevice:function(){V.error()},analyzePath:function(){V.error()},loadFilesFromDB:function(){V.error()},ErrnoError:function(){V.error()}};i.FS_createDataFile=V.createDataFile,i.FS_createPreloadedFile=V.createPreloadedFile;var G="data:application/octet-stream;base64,";function H(e){return String.prototype.startsWith?e.startsWith(G):0===e.indexOf(G)}var K,z="aw.wasm";function W(){try{if(s)return new Uint8Array(s);var e=function(e){if(H(e))return function(e){try{for(var t=Y(e),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}catch(i){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(G.length))}(z);if(e)return e;throw"both async and sync fetching of the wasm failed"}catch(t){F(t)}}H(z)||(K=z,z=i.locateFile?i.locateFile(K,a):a+K),x.push({func:function(){ue()}});var Y="function"==typeof atob?atob:function(e){var t,r,n,i,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=s.indexOf(e.charAt(c++))<<2|(i=s.indexOf(e.charAt(c++)))>>4,r=(15&i)<<4|(o=s.indexOf(e.charAt(c++)))>>2,n=(3&o)<<6|(a=s.indexOf(e.charAt(c++))),u+=String.fromCharCode(t),64!==o&&(u+=String.fromCharCode(r)),64!==a&&(u+=String.fromCharCode(n))}while(c<e.length);return u},X={__lock:function(){},__unlock:function(){},emscripten_memcpy_big:function(e,t,r){m.set(m.subarray(t,t+r),e)},emscripten_resize_heap:function(t){var r=v.length;g(t>r);var n=65536,i=2147418112;if(t>i)return c("Cannot enlarge memory, asked to go up to "+t+" bytes, but the limit is "+i+" bytes!"),!1;for(var o=Math.max(r,16777216);o<t;)(o=o<=536870912?T(2*o,n):Math.min(T((3*o+2147483648)/4,n),i))===r&&l("Cannot ask for more memory since we reached the practical limit in browsers (which is just below 2GB), so the request would have failed. Requesting only "+v.length);return function(t){try{return d.grow(t-y.byteLength+65535>>16),$(d.buffer),1}catch(e){console.error("emscripten_realloc_buffer: Attempted to grow heap from "+y.byteLength+" bytes to "+t+" bytes, but got error: "+e)}}(o)?(c("Warning: Enlarging memory arrays, this is not fast! "+[r,o]),!0):(c("Failed to grow the heap from "+r+" bytes to "+o+" bytes, not enough memory!"),!1)},memory:d,table:h},Z=function(){var t,r={env:X,wasi_unstable:X};function n(e,t){var r=e.exports;i.asm=r,function(e){if(M--,i.monitorRunDependencies&&i.monitorRunDependencies(M),e?(g(j[e]),delete j[e]):c("warning: run dependency removed without ID"),0==M&&(null!==B&&(clearInterval(B),B=null),U)){var t=U;U=null,t()}}("wasm-instantiate")}t="wasm-instantiate",M++,i.monitorRunDependencies&&i.monitorRunDependencies(M),t?(g(!j[t]),j[t]=1,null===B&&"undefined"!=typeof setInterval&&(B=setInterval((function(){if(p)return clearInterval(B),void(B=null);var e=!1;for(var t in j)e||(e=!0,c("still waiting on run dependencies:")),c("dependency: "+t);e&&c("(end of list)")}),1e4))):c("warning: run dependency added without ID");var o=i;function a(e){g(i===o,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),o=null,n(e.instance)}function u(e){return(s||"function"!=typeof fetch?new Promise((function(e,t){e(W())})):fetch(z,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+z+"'";return e.arrayBuffer()})).catch((function(){return W()}))).then((function(e){return f.instantiate(e,r)})).then(e,(function(e){c("failed to asynchronously prepare wasm: "+e),F(e)}))}if(i.instantiateWasm)try{return i.instantiateWasm(r,n)}catch(e){return c("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(s||"function"!=typeof f.instantiateStreaming||H(z)||"function"!=typeof fetch)return u(a);fetch(z,{credentials:"same-origin"}).then((function(e){return f.instantiateStreaming(e,r).then(a,(function(e){c("wasm streaming compile failed: "+e),c("falling back to ArrayBuffer instantiation"),u(a)}))}))}(),{}}(),q=Z.__wasm_call_ctors;Z.__wasm_call_ctors=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),q.apply(null,arguments)};var Q=Z.malloc;Z.malloc=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Q.apply(null,arguments)};var J=Z.openBox;Z.openBox=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),J.apply(null,arguments)};var ee=Z.free;Z.free=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ee.apply(null,arguments)};var te=Z.__errno_location;Z.__errno_location=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),te.apply(null,arguments)};var re=Z.fflush;Z.fflush=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),re.apply(null,arguments)};var ne=Z.setThrew;Z.setThrew=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ne.apply(null,arguments)};var ie=Z.stackSave;Z.stackSave=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ie.apply(null,arguments)};var oe=Z.stackAlloc;Z.stackAlloc=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),oe.apply(null,arguments)};var ae=Z.stackRestore;Z.stackRestore=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ae.apply(null,arguments)};var se=Z.__growWasmMemory;Z.__growWasmMemory=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),se.apply(null,arguments)},i.asm=Z;var ue=i.___wasm_call_ctors=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__wasm_call_ctors.apply(null,arguments)},ce=i._malloc=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.malloc.apply(null,arguments)};i._openBox=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.openBox.apply(null,arguments)},i._free=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.free.apply(null,arguments)},i.___errno_location=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__errno_location.apply(null,arguments)},i._fflush=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.fflush.apply(null,arguments)},i._setThrew=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.setThrew.apply(null,arguments)};var le=i.stackSave=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackSave.apply(null,arguments)};i.stackAlloc=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackAlloc.apply(null,arguments)},i.stackRestore=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackRestore.apply(null,arguments)};var de,fe=i.__growWasmMemory=function(){return g(N,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),g(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__growWasmMemory.apply(null,arguments)};function he(e){function t(){de||(de=!0,p||(O(),g(!N),N=!0,P(x),O(),P(D),i.onRuntimeInitialized&&i.onRuntimeInitialized(),g(!i._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function(){if(O(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),L.unshift(e);var e;P(L)}()))}M>0||(k(),function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),R.unshift(e);var e;P(R)}(),M>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),t()}),1)):t(),O()))}if(i.asm=Z,i.intArrayFromString=function(e,t,r){var n=r>0?r:S(e)+1,i=new Array(n),o=E(e,i,0,i.length);return t&&(i.length=o),i},Object.getOwnPropertyDescriptor(i,"intArrayToString")||(i.intArrayToString=function(){F("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"ccall")||(i.ccall=function(){F("'ccall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"cwrap")||(i.cwrap=function(){F("'cwrap' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"setValue")||(i.setValue=function(){F("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getValue")||(i.getValue=function(){F("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"allocate")||(i.allocate=function(){F("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getMemory")||(i.getMemory=function(){F("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"AsciiToString")||(i.AsciiToString=function(){F("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToAscii")||(i.stringToAscii=function(){F("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF8ArrayToString")||(i.UTF8ArrayToString=function(){F("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.UTF8ToString=function(e,t){return e?function(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.subarray&&A)return A.decode(e.subarray(t,i));for(var o="";t<i;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var u=63&e[t++];if(224==(240&a)?a=(15&a)<<12|s<<6|u:(240!=(248&a)&&l("Invalid UTF-8 leading byte 0x"+a.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),a=(7&a)<<18|s<<12|u<<6|63&e[t++]),a<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}(m,e,t):""},Object.getOwnPropertyDescriptor(i,"stringToUTF8Array")||(i.stringToUTF8Array=function(){F("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF8")||(i.stringToUTF8=function(){F("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF8")||(i.lengthBytesUTF8=function(){F("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF16ToString")||(i.UTF16ToString=function(){F("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF16")||(i.stringToUTF16=function(){F("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF16")||(i.lengthBytesUTF16=function(){F("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF32ToString")||(i.UTF32ToString=function(){F("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF32")||(i.stringToUTF32=function(){F("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF32")||(i.lengthBytesUTF32=function(){F("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.allocateUTF8=function(e){var t=S(e)+1,r=ce(t);return r&&E(e,v,r,t),r},Object.getOwnPropertyDescriptor(i,"stackTrace")||(i.stackTrace=function(){F("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPreRun")||(i.addOnPreRun=function(){F("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnInit")||(i.addOnInit=function(){F("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPreMain")||(i.addOnPreMain=function(){F("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnExit")||(i.addOnExit=function(){F("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPostRun")||(i.addOnPostRun=function(){F("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeStringToMemory")||(i.writeStringToMemory=function(){F("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeArrayToMemory")||(i.writeArrayToMemory=function(){F("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeAsciiToMemory")||(i.writeAsciiToMemory=function(){F("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addRunDependency")||(i.addRunDependency=function(){F("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"removeRunDependency")||(i.removeRunDependency=function(){F("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"ENV")||(i.ENV=function(){F("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"FS")||(i.FS=function(){F("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"FS_createFolder")||(i.FS_createFolder=function(){F("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createPath")||(i.FS_createPath=function(){F("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createDataFile")||(i.FS_createDataFile=function(){F("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createPreloadedFile")||(i.FS_createPreloadedFile=function(){F("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createLazyFile")||(i.FS_createLazyFile=function(){F("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createLink")||(i.FS_createLink=function(){F("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createDevice")||(i.FS_createDevice=function(){F("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_unlink")||(i.FS_unlink=function(){F("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"GL")||(i.GL=function(){F("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"dynamicAlloc")||(i.dynamicAlloc=function(){F("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"loadDynamicLibrary")||(i.loadDynamicLibrary=function(){F("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"loadWebAssemblyModule")||(i.loadWebAssemblyModule=function(){F("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getLEB")||(i.getLEB=function(){F("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getFunctionTables")||(i.getFunctionTables=function(){F("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"alignFunctionTables")||(i.alignFunctionTables=function(){F("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"registerFunctions")||(i.registerFunctions=function(){F("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addFunction")||(i.addFunction=function(){F("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"removeFunction")||(i.removeFunction=function(){F("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getFuncWrapper")||(i.getFuncWrapper=function(){F("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"prettyPrint")||(i.prettyPrint=function(){F("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"makeBigInt")||(i.makeBigInt=function(){F("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"dynCall")||(i.dynCall=function(){F("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getCompilerSetting")||(i.getCompilerSetting=function(){F("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackSave")||(i.stackSave=function(){F("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackRestore")||(i.stackRestore=function(){F("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackAlloc")||(i.stackAlloc=function(){F("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"establishStackSpace")||(i.establishStackSpace=function(){F("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"print")||(i.print=function(){F("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"printErr")||(i.printErr=function(){F("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getTempRet0")||(i.getTempRet0=function(){F("'getTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"setTempRet0")||(i.setTempRet0=function(){F("'setTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"callMain")||(i.callMain=function(){F("'callMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"abort")||(i.abort=function(){F("'abort' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.Pointer_stringify=function(e,t){F("this function has been removed - you should use UTF8ToString(ptr, maxBytesToRead) instead!")},Object.getOwnPropertyDescriptor(i,"warnOnce")||(i.warnOnce=function(){F("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.writeStackCookie=k,i.checkStackCookie=O,i.abortStackOverflow=function(e){F("Stack overflow! Attempted to allocate "+e+" bytes on the stack, but stack has only "+(w-le()+e)+" bytes available!")},Object.getOwnPropertyDescriptor(i,"intArrayFromBase64")||(i.intArrayFromBase64=function(){F("'intArrayFromBase64' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"tryParseAsDataURI")||(i.tryParseAsDataURI=function(){F("'tryParseAsDataURI' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"ALLOC_NORMAL")||Object.defineProperty(i,"ALLOC_NORMAL",{configurable:!0,get:function(){F("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_STACK")||Object.defineProperty(i,"ALLOC_STACK",{configurable:!0,get:function(){F("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_DYNAMIC")||Object.defineProperty(i,"ALLOC_DYNAMIC",{configurable:!0,get:function(){F("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_NONE")||Object.defineProperty(i,"ALLOC_NONE",{configurable:!0,get:function(){F("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"calledRun")||Object.defineProperty(i,"calledRun",{configurable:!0,get:function(){F("'calledRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}}),i.then=function(e){if(de)e(i);else{var t=i.onRuntimeInitialized;i.onRuntimeInitialized=function(){t&&t(),e(i)}}return i},U=function e(){de||he(),de||(U=e)},i.run=he,i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return he(),t});t.exports=i}(aw$1);var aw=aw$1.exports,commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},aesGcm={exports:{}};!function(e,t){e.exports=function(){function e(e,r){return"string"==typeof r&&(r=JSON.parse(r)),t(e).then((function(e){return new Promise((function(t,n){window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(r.iv),tagLength:128},e,r.encrypted).then((function(e){return new TextDecoder("utf-8").decode(e)})).then(t).catch((function(e){"OperationError"===String(e)&&(e="Wrong Password."),n(e)}))})).catch((function(e){throw e}))}))}function t(e){return window.crypto.subtle.importKey("raw",e,"AES-GCM",!0,["encrypt","decrypt"])}return{decrypt:e}}()}(aesGcm);var aes4js=aesGcm.exports,sparkMd5={exports:{}};!function(e,t){e.exports=function(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3];n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&i)+t[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&r)+t[3]-1044525330|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&i)+t[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&r)+t[7]-45705983|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&i)+t[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&r)+t[11]-1990404162|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&i)+t[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&r)+t[15]+1236535329|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[1]-165796510|0)<<5|r>>>27)+n|0)&i|n&~i)+t[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|i>>>18)+o|0)&r|o&~r)+t[0]-373897302|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[5]-701558691|0)<<5|r>>>27)+n|0)&i|n&~i)+t[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|i>>>18)+o|0)&r|o&~r)+t[4]-405537848|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[9]+568446438|0)<<5|r>>>27)+n|0)&i|n&~i)+t[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|i>>>18)+o|0)&r|o&~r)+t[8]+1163531501|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&i|n&~i)+t[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&r|o&~r)+t[12]-1926607734|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^i)+t[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^r)+t[14]-35309556|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^i)+t[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^r)+t[10]-1094730640|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^i)+t[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^r)+t[6]+76029189|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^i)+t[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^r)+t[2]-995338651|0)<<23|n>>>9)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+i|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function i(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var t,i,o,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,n(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(l,o),l}function a(e){var t,n,o,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,i(e.subarray(t-64,t)));for(n=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(l,o),l}function s(e){var r,n="";for(r=0;r<4;r+=1)n+=t[e>>8*r+4&15]+t[e>>8*r&15];return n}function u(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function c(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function l(e,t){var r,n=e.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(r=0;r<n;r+=1)o[r]=e.charCodeAt(r);return t?o:i}function d(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function f(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}function h(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function p(){this.reset()}return u(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(r,n){var i,o,a,s,u=this.byteLength,c=t(r,u),l=u;return n!==e&&(l=t(n,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),p.prototype.append=function(e){return this.appendBinary(c(e)),this},p.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)r(this._hash,n(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},p.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=h(r)),this.reset(),r},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},p.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(e,t){var n,i,o,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(r(this._hash,e),a=0;a<16;a+=1)e[a]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=i,e[15]=o,r(this._hash,e)},p.hash=function(e,t){return p.hashBinary(c(e),t)},p.hashBinary=function(e,t){var r=u(o(e));return t?h(r):r},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(e){var t,n=f(this._buff.buffer,e,!0),o=n.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)r(this._hash,i(n.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n[t]<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=h(r)),this.reset(),r},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var e=p.prototype.getState.call(this);return e.buff=d(e.buff),e},p.ArrayBuffer.prototype.setState=function(e){return e.buff=l(e.buff,!0),p.prototype.setState.call(this,e)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(e,t){var r=u(a(new Uint8Array(e)));return t?h(r):r},p}()}(sparkMd5);var SparkMD5=sparkMd5.exports,AwManager=function(){function e(){_classCallCheck$1(this,e)}return _createClass$1(e,[{key:"init",value:function(){var e=this;return new Promise((function(t){e.module={onRuntimeInitialized:function(){t()}},aw(e.module)}))}},{key:"openBox",value:function(e){var t=window.atob(e),r=util$1.str2hex(t),n=this.module._malloc(Number(r.length));this.module.HEAP8.set(r,n);var i=this.module._openBox(Number(n),r.length),o=this.module.UTF8ToString(i);return this.module._free(n),o}},{key:"transformWithUnionInfo",value:function(e,t){return new Promise((function(r,n){var i=util$1.StringToArrayBuffer(SparkMD5.hash(t)),o={encrypted:util$1.Base64ToHex(e,!0),iv:TRANSFORM_IV};aes4js.decrypt(i,o).then((function(e){r(e)}))}))}}]),e}(),$$z=_export$1,repeat$1=stringRepeat$1;$$z({target:"String",proto:!0},{repeat:repeat$1});var GapJump=function(){function e(t,r){_classCallCheck$1(this,e),this.player=t,this.mediaElem=t.video,this.config=r,this.timer=new IntervalTimer$1,this.prevReadyState=this.mediaElem.readyState,this.didFireLargeGap=!1,this.seekingEventReceived=!1,this.segmentAppended=!1,this.onWaitFunc=this._onWaiting.bind(this),this.onPlayFunc=this._onPlay.bind(this),this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),!1!==this.config.useGapJump&&this._start(),this.hasPlayed=!1}return _createClass$1(e,[{key:"_onWaiting",value:function(){this.onGapJump()}},{key:"_onPlay",value:function(){this.hasPlayed=!0}},{key:"_start",value:function(){var e=this;this.mediaElem.addEventListener("waiting",this.onWaitFunc),this.mediaElem.addEventListener("play",this.onPlayFunc),this.timer.repeat((function(){e.onGapJump()}),250)}},{key:"onSegmentAppend",value:function(){this.segmentAppended=!0,this.onGapJump()}},{key:"onSeeking",value:function(){this.seekingEventReceived=!0,this.segmentAppended=!1,this.didFireLargeGap=!1}},{key:"onGapJump",value:function(){if(this.mediaElem.readyState!==HTMLMediaElement.HAVE_NOTHING){if(this.mediaElem.seeking){if(!this.seekingEventReceived)return}else this.seekingEventReceived=!1;if(!this.mediaElem.paused||0===this.mediaElem.currentTime||!this.hasPlayed){this.mediaElem.readyState!==this.prevReadyState&&(this.didFireLargeGap=!1,this.prevReadyState=this.mediaElem.readyState);var t=this.mediaElem.buffered,r=this.config.smallGapLimit||.5,n=this.config.gapDetectionThreshold||.1,i=this.mediaElem.currentTime,o=this._getIndex(t,i,n);if(null!==o&&(0!==o||this.segmentAppended)){var a=t.start(o);if(!(a>this.mediaElem.duration)){var s=a-i,u=s<=r;s<e.BROWSER_GAP_TOLERANCE||u&&(this.mediaElem.currentTime=this.isSafari?a+.1:a,debug$1$1.gap("gapJump gapIndex",o,"isGapSamll",u,"jumpLargeGap",!1,"currentTime",this.mediaElem.currentTime),.08!==a&&this.player&&this.player.emit("log",{type:"oneevent",end_type:"gap",vid:this.config.vid,ext:{video_postion:Math.floor(1e3*a)}}))}}}}}},{key:"_getIndex",value:function(e,t,r){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;for(var n=this._getBuffered(e),i=null,o=0;o<n.length;o++){if(n[o].start>t&&(0===o||n[o-1].end-t<=r)){i=o;break}}return i}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}},{key:"destroy",value:function(){this.mediaElem.removeEventListener("waiting",this.onWaitFunc),this.mediaElem.removeEventListener("play",this.onPlayFunc),this.timer.clear(),this.timer=null}}]),e}();GapJump.BROWSER_GAP_TOLERANCE=.001;var PRELOAD_NEXT$1=PRELOAD_NEXT$2,CHANGE_STATES$1=CHANGE_STATES$2,__DASH__=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_onDestroyAll",(function(){r.player.emit("dashDestroy")})),_defineProperty$1(this,"startProgressTimer",(function(){r._pluginInst.info({msg:"startProgressTimer"});var e=r,t=r.player,n=r.config;if(e&&e.isDashCanUse&&e.dash.mse){var i=0,o=function r(){if(e&&e.isDashCanUse&&e.dash.mse&&e.dash.mse.progressTimer){if(e.handleUrlExpire(),++i*(n.progressTimer||DEFAULT_PROGRESS_TIMER)/1e3>DEFAULT_CHECK_BUFFER_TIME&&(e.clearBuffer&&e.clearBuffer(),i=0),e.errorNeedTryRefresh){if(e.dash.mse.progressErrorTimer)return e.loadData(void 0,e.dashSeeking?MPD_SEEK_TYPE.SEEK:MPD_SEEK_TYPE.NORMAL),void e.isEnded();e.clearProgressTimer(),e.dash.mse.progressErrorTimer=new IntervalTimer$1,e.dash.mse.progressErrorTimer.repeat((function(){r()}),ERROR_REQUEST_TIME)}!e.errorNeedTryRefresh&&e.dash.mse.progressErrorTimer&&(e.clearProgressErrorTimer(),e.startProgressTimer()),n.disableBufferBreakCheck||(t.currentTime-(e.lastCurrentTime||0)>.1||t.paused?1!==e.dashBufferBreak&&2!==e.dashBufferBreak||(debug$1$1.log("视频没有卡死，重置卡死标记"),e.dashBufferBreak=0,clearTimeout(e.dashBufferBreakTimer),e.dashBufferBreakTimer=null):e.dashBufferBreak||(e.dashBufferBreak=1,debug$1$1.log("卡死计时开始！持续".concat(DASH_BUFFER_BREAK,"毫秒则确认卡死")),e.dashBufferBreakTimer=setTimeout((function(){1===e.dashBufferBreak&&(e.dashBufferBreak=2,debug$1$1.log("确认卡死！！！"),e.dash.emit("error",new Errors$1(Errors$1.BUFFERBREAK,Errors$1.BUFFERBREAK_ERROR,{line:1e3,handle:"[DASH] buffer break",msg:"buffer break"}))),e.dashBufferBreakTimer=null}),DASH_BUFFER_BREAK)),e.lastCurrentTime=t.currentTime),e.loadData(void 0,e.dashSeeking?MPD_SEEK_TYPE.SEEK:MPD_SEEK_TYPE.NORMAL),e.isEnded()}};e.dash.mse.progressTimer=new IntervalTimer$1,e.dash.mse.progressTimer.repeat((function(){o()}),n.progressTimer||DEFAULT_PROGRESS_TIMER)}})),_defineProperty$1(this,"_onAutoDescChange",(function(e){var t=e.definition,n=e.reset,i=e.fps,o=e.item;r.updateAutoDefiDesc(t,n,i,o)})),this._pluginInst=t.pluginInst;var n=this._pluginInst,i=n.player,o=n.config;this._minDuration=1/0,this.player=i,this.config=o,this.startTimestamp=(new Date).getTime(),this.lastDefiIdx=void 0,this.__isDashCanUse=!1,this.preloadBufferThreshold=this.config.preloadBufferThreshold||.5,this.abrInstance=null,this.definitions=[];var a=this.config.autoBitrateOpts||{};this.isPlayAutoDefi=ABR.getIsPlayAutoDefi(a),this.isOpenAutoDefi=!!a.isOpenAutoDefi,this.isCurrentAutoDefi=this.isOpenAutoDefi&&this.isPlayAutoDefi,this.bitrateMap={},this.curBitrate=0,this.defiIdMap={},this.definition2item={},this.bandwidth2item={},(this.preloadBufferThreshold<=0||this.preloadBufferThreshold>1)&&(this.preloadBufferThreshold=.5),this.bufferingGoalScale=1,this.curVideoInitSegmentIdx=-1,this.getPlayInfoTimestamp=this.startTimestamp/1e3,o.dashOpts.dynamic_video.dynamic_video_list&&o.dashOpts.dynamic_video.dynamic_video_list.length>0?this.urlExpireTimestamp=o.dashOpts.dynamic_video.dynamic_video_list[0].url_expire||0:o.dashOpts.dynamic_video.dynamic_audio_list&&o.dashOpts.dynamic_video.dynamic_audio_list.length>0&&(this.urlExpireTimestamp=o.dashOpts.dynamic_video.dynamic_audio_list[0].url_expire||0),this.gapJumpInst=new GapJump(i,o),util$1.on(i,"addVideoBufferEnd",(function(){r.gapJumpInst.onSegmentAppend()}),"dashDestroy")}var t;return _createClass$1(e,[{key:"initDash",value:function(e){var t=this;this.dash=e,this.bindPlayInterfaceEvent();var r=this.config;r.dashOpts.dynamic_video.dynamic_video_list.length>0&&(this.initAbr(),r.dashOpts.dynamic_video.dynamic_video_list.sort((function(e,t){return t.vheight-e.vheight})),r.dashOpts.dynamic_video.dynamic_video_list.forEach((function(e,n){e.definition===r.defaultDefinition&&(t.dash.selectedIdx=n)})),this.dashVideoEncrypted=r.dashOpts.dynamic_video.dynamic_video_list.some((function(e){return!!e.kid}))),r.dashOpts.dynamic_video.dynamic_audio_list.length>0&&(this.dashAudioEncrypted=r.dashOpts.dynamic_video.dynamic_audio_list.some((function(e){return!!e.kid})))}},{key:"isDashCanUse",get:function(){return this.__isDashCanUse},set:function(e){this.__isDashCanUse=e}},{key:"bindPlayInterfaceEvent",value:function(){var e=this._pluginInst,t=e.player,r=e.config;util$1.on(t,"DRM_ERROR",(function(){t.emit("playInterfaceInfo",r.dashOpts||{})}),"dashDestroy");util$1.on(t,"NO_MEDIALIST",(function(){t.emit("playInterfaceInfo",r.dashOpts||{})}),"dashDestroy")}},{key:"isEnded",value:function(){var e=this.dash,t=this.player,r=this.mse,n=this.config;if("vod"===e.type)if(t.ended)debug$1$1.log("player.ended === true"),"safari"===sniffer.browser&&(t.pause(),t.emit("ended"));else{var i=n.duration||t.duration||e.mpd.duration;if(t.duration&&(i=Math.min(i,t.duration)),e.mpd.duration&&(i=Math.min(i,e.mpd.duration)),i-this._minDuration<10&&(i=Math.min(i,this._minDuration)),i>0&&i-t.currentTime<DEFAULT_END){var o=this._findRangeForPlaybackTime(t.currentTime)||{start:0,end:0};debug$1$1.log("range",o,"current",t.currentTime,"duration",i);var a=Math.min(o.end,t.duration),s=t.currentTime-a>=0,u=a-t.currentTime<DEFAULT_END;(s||u)&&(debug$1$1.log("isEnded execute, isOver",s,"isClosed",u),r.endOfStream(),this.clearProgressTimer())}}}},{key:"dashDestroy",value:function(){var e=this.player,t=this.dash;for(var r in t&&t.mse&&t.mse.destroy(),t&&t.eme&&(t.eme.emit("destroy"),t.eme.destroy()),t&&e.errorHandler&&(t.abortLoadingTasks(),t.emit("destroy")),t&&t.mpd&&t.mpd.timer&&(clearTimeout(t.mpd.timer),t.mpd.timer=null),this.crypto&&this.crypto.destroy(),t&&t.destroy(),this.clearCheckCanplayTimer(),this.clearProgressTimer(),this.clearProgressErrorTimer(),this.destroyAbr(),this.gapJumpInst&&this.gapJumpInst.destroy(),e&&(this.player.off("destroy",this._onDestroyAll),e.__dash__=null,this._pluginInst.unloadVideo(),"function"==typeof e.video.setMediaKeys&&e.video.setMediaKeys(null)),t)delete t[r];for(var n in this)delete this[n]}},{key:"bindComEvent",value:function(){var e=this;this._lastSeekTime=null;var t=this.player,r=this.config;util$1.on(t,"error",e.clearProgressTimer.bind(e),"dashDestroy"),util$1.on(t,"ended",e.clearProgressTimer.bind(e),"dashDestroy");util$1.on(t,"timeupdate",(function(){e.isDashCanUse&&r.dashOpts&&e.mse&&e.isEnded()}),"dashDestroy");util$1.on(t,"seeking",(function(){if(debug$1$1.log("dash onSeeking"),e.isDashCanUse&&r.dashOpts)if(t.ended)"function"==typeof t.replayFunc&&t.replayFunc();else{var n=r.useDurationBackoff||!1,i=Date.now()/1e3,o=t.duration-t.currentTime<1;n&&o&&(!this._lastSeekTime||this._lastSeekTime<i-1)&&(this._lastSeekTime=i,t.currentTime=t.duration-1),e.dashSeeking=!0,e.gapJumpInst&&e.gapJumpInst.onSeeking()}}),"dashDestroy");util$1.on(t,"seeked",(function(){debug$1$1.log("dash onSeeked"),e.dashSeeking=!1,e.isEnded()}),"dashDestroy"),util$1.on(t,"dashDestroy",e.dashDestroy.bind(this)),t.on("destroy",this._onDestroyAll)}},{key:"getMetaData",value:function(){var e=this,t={};return["video","audio"].forEach((function(r){var n=e.dash.mpd.mediaList[r],i=n[n.selectedIdx];t[r]={bandwidth:i.bandwidth,mimeType:i.mimeType,codecs:i.codecs,definition:i.definition,width:i.width,height:i.height,mediaDuration:i.mediaDuration,timescale:i.timescale}})),t}},{key:"_findRangeForPlaybackTime",value:function(e){var t,r=this.player,n=this.config;if(n.useBuffered2){var i=n.maxHoleDuration;if(!(t=r.buffered2))return;for(var o=0;o<t.length;o++){var a=t.start(o),s=t.end(o);if(e+i>=a&&e<s)return{start:a,end:s}}}else{if(!(t=r.buffered))return;for(var u=0;u<t.length;u++)if(util$1.round(t.start(u))<=util$1.round(e)&&util$1.round(t.end(u))>=util$1.round(e))return{start:util$1.round(t.start(u)),end:util$1.round(t.end(u))}}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MPD_SEEK_TYPE.NORMAL,r=arguments.length>2?arguments[2]:void 0,n=this,i=this.player,o=this.config;if((!n.switching||r)&&n.dash){var a=o.preloadTime||DEFAULT_PRELOAD_TIME;a*=this.bufferingGoalScale;var s,u=n.dash.mpd.mediaList.video;if(u&&u.length>0&&u[u.selectedIdx]){var c=u[u.selectedIdx].bandwidth;c<6e6&&(a*=2),s=u[u.selectedIdx].definition||this.bandwidth2item[c].definition}if(o.dynamicPreloadTimeOpts&&s){var l=o.dynamicPreloadTimeOpts[s];l&&(a=l)}n.preloadTime!==a&&(n.preloadTime=a,debug$1$1.log("maxCacheTimeAudio change",a),i.emit(ABR_EVENTS.MAX_BUFFER_CHANGE,{videoCacheTime:a,audioCacheTime:a})),e||(e=i.currentTime);var d=this._findRangeForPlaybackTime(e),f=i.duration+100;if(d&&d.end&&!n.isCurrentInAbr()){var h=n.dash.mpd.mediaList;["video","audio"].forEach((function(t){if(h[t].length<1)return!0;for(var r=h[t][h[t].selectedIdx].mediaSegments,n=0;n<r.length;n++)if(!(r[n].end<=e||r[n].start>=d.end||r[n].downloaded)&&f>r[n].start){f=r[n].start;break}}))}var p=f<=i.duration?f:d&&Math.ceil(d.end)||Math.floor(e);p>e+a*this.preloadBufferThreshold&&i.emit(PRELOAD_NEXT$1);var g=o.preloadCancelTime;p<e+g&&i.emit("PRELOAD_CANCEL"),p>e+a||n.dash.seek(p,t,r)}}},{key:"startCheckCanplayTimer",value:function(){var e=this,t=this.player,r=this.config;if(t&&e&&!r.disableCanplayCheck){e.checkCanplayTimer=new IntervalTimer$1,e.checkCanplayTimer.repeat((function(){t&&e&&e.isDashCanUse&&e.checkCanplayTimer&&t.errorHandler&&(t.enterIsHide?(debug$1$1.log("视频已起播，重置标记"),e.dashNoCanplay=0,e.clearCheckCanplayTimer()):e.dashNoCanplay||"visible"!==document.visibilityState||(e.dashNoCanplay=1,debug$1$1.log("未起播计时开始！持续".concat(DASH_NO_INITSEGMENT,"毫秒没有获取到init分片则确认没有起播")),e.dashNoCanplayTimer=setTimeout((function(){e.dashNoCanplayTimer=null,1===e.dashNoCanplay&&!1===t.enterIsHide&&(t.dashState!==START_PLAY?(e.dashNoCanplay=2,debug$1$1.log("确认未获取到init分片，没有起播！！！"),e.clearCheckCanplayTimer(),t.errorHandler(new Errors$1(Errors$1.CANPLAY,Errors$1.NO_CANPLAY_ERROR,{line:1021,handle:"[DASH] start play",msg:"start play no canplay"}))):r.disableDashNoCanplayCheck||(debug$1$1.log("未起播计时开始！持续".concat(DASH_NO_CANPLAY-DASH_NO_INITSEGMENT,"毫秒则确认没有起播")),e.dashNoCanplayTimer=setTimeout((function(){e.dashNoCanplayTimer=null,1===e.dashNoCanplay&&!1===t.enterIsHide&&(e.dashNoCanplay=2,debug$1$1.log("确认没有起播！！！"),e.clearCheckCanplayTimer(),t.errorHandler(new Errors$1(Errors$1.CANPLAY,Errors$1.NO_CANPLAY_ERROR,{line:1021,handle:"[DASH] start play",msg:"start play no canplay"})))}),DASH_NO_CANPLAY-DASH_NO_INITSEGMENT)))}),DASH_NO_INITSEGMENT)))}),r.progressTimer||DEFAULT_PROGRESS_TIMER)}}},{key:"clearCheckCanplayTimer",value:function(){var e=this;e&&(e&&e.checkCanplayTimer&&(e.checkCanplayTimer.clear(),e.checkCanplayTimer=null),e.dashNoCanplayTimer&&(clearTimeout(e.dashNoCanplayTimer),e.dashNoCanplayTimer=null,e.dashNoCanplay=void 0))}},{key:"handleUrlExpire",value:function(){this._pluginInst.handleUrlExpire(this)}},{key:"clearBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,r=this.player,n=this.config;if(t.isDashCanUse&&t.mse){debug$1$1.log("clearBuffer");var i=t.dash.mpd.mediaList.video;if(i&&i.length>0&&i[i.selectedIdx].bandwidth<6e6)e&&r.currentTime>12&&(debug$1$1.log("low bandwidth remove buffer initiatively"),t.clearBufferByTime(0,r.currentTime-12));else{r.currentTime>12&&t.clearBufferByTime(0,r.currentTime-12);var o=n.preloadTime||DEFAULT_PRELOAD_TIME;r.currentTime+o+6<r.duration&&t.clearBufferByTime(r.currentTime+o+6,r.duration),e&&r.currentTime+o/2<r.duration&&(debug$1$1.log("high bandwidth remove buffer initiatively"),t.clearBufferByTime(r.currentTime+o/2,r.duration))}}}},{key:"clearBufferByTime",value:function(e,t){var r=this;debug$1$1.log("clearBufferByTime start: ".concat(e," end: ").concat(t)),r.dash.mpd.mediaList.video.length>0&&r.mse.removeBuffer(CONTENT_TYPES.VIDEO,e,t).catch((function(){})),r.dash.mpd.mediaList.audio.length>0&&r.mse.removeBuffer(CONTENT_TYPES.AUDIO,e,t).catch((function(){})),r.dash.mpd.clearBuffer(e,t)}},{key:"clearProgressTimer",value:function(){var e=this;e&&(e.isDashCanUse&&e.dash.mse&&e.dash.mse.progressTimer&&(e.dash.mse.progressTimer.clear(),e.dash.mse.progressTimer=null),e.dashBufferBreakTimer&&(clearTimeout(e.dashBufferBreakTimer),e.dashBufferBreakTimer=null,e.dashBufferBreak=void 0))}},{key:"clearProgressErrorTimer",value:function(){var e=this;e&&e.isDashCanUse&&e.dash.mse&&e.dash.mse.progressErrorTimer&&(e.dash.mse.progressErrorTimer.clear(),e.dash.mse.progressErrorTimer=null)}},{key:"emitMenuResolutionChange",value:function(){var e=this.player;try{var t=this.dash.mpd.mediaList.video;if(t){var r=t[t.selectedIdx],n={width:r.width,height:r.height};e.emit("RESOLUTION_UPDATE",n)}else e.emit("RESOLUTION_UPDATE")}catch(error){e.emit("RESOLUTION_UPDATE")}}},{key:"updateDashType",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=proxyLocalStorage$1.getItem(URL_DASH_TAG),n=DASH_TYPE;e=t||r===n.BACK?n.MAIN:n.BACK,proxyLocalStorage$1.setItem(URL_DASH_TAG,e)}},{key:"changeMainBackUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CHANGE_STATES$1.INIT,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&this._pluginInst){var r=this._pluginInst.config,n=proxyLocalStorage$1.getItem(URL_DASH_TAG),i=!1,o=DASH_TYPE;if((e===CHANGE_STATES$1.INIT&&n===o.BACK||e===CHANGE_STATES$1.ERR)&&(i=!0),debug$1$1.log("curDashType",n,"changeState",e,"needChange",i),i){var a=r.dashOpts.dynamic_video.main_url,s=r.dashOpts.dynamic_video.backup_url_1;r.dashOpts.dynamic_video.main_url=s,r.dashOpts.dynamic_video.backup_url_1=a,util$1.exchangeListUrl(r.dashOpts.dynamic_video.dynamic_video_list),util$1.exchangeListUrl(r.dashOpts.dynamic_video.dynamic_audio_list)}var u=r.dashOpts.dynamic_video.main_url;return this._checkUrlRange(u),r}}},{key:"_checkUrlRange",value:function(e){var t=this._pluginInst.config,r=t.url_range_domains||[],n=util$1.validateUrlRange(r,e);t.useUrlRange=n}},{key:"updateAutoDefiDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.player,o=this.config,a=o.autoBitrateOpts||{},s=a.autoDefiText||"auto";i.emit("ABR_AUTO_DESC_CHANGE",s,t?void 0:e,r,n),t||this._pluginInst.setCurrentDefitionInfos("自动 ".concat(e),n)}},{key:"_startLoadInitSegment",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new ProxyPromise,i=this,o=this.dash,a=this.config,s=o.mpd.mediaList.video,u=s.selectedIdx;return s.every((function(c,l){if(c.id===e){t.abrInstance.updateBitrate(i.defiIdMap[e].bitrate),r&&(t.lastDefiIdx=e),u=l,i.selectedIdx=l,a.defaultDefinition=s[i.selectedIdx].definition,i.switching=!0,o.abortLoadingTasks();var d=s[u].wrapperData;return d?((i.dashVideoEncrypted||i.dashAudioEncrypted)&&!1===a.useEME&&i.crypto&&i.crypto.updateHeaderId(),n.resolve(d)):i._makeInitSegemntRequestWithRetry("video",u).then((function(e){n.resolve(e)})),!1}return!0})),n}},{key:"abrSwitchURL",value:function(e){var t=this;this._pluginInst.info({msg:"abr switch",data:e});var r=this.dash,n=this.player,i=this.config;e=e.split("/")[e.split("/").length-1],this._startLoadInitSegment(e).then((function(e){var o=r.mpd.mediaList.video,a=t._switch(e.newIdx),s=n.getBufferedRange(i.useBuffered2?n.buffered2:n.buffered)[1],u=o[a].mediaSegments.find((function(e){return e.start-s>=0}));if(u){var c=0===s?n.currentTime:(u.start+u.end)/2;t._appendInitSegment("video",e,e.newIdx).then((function(){t.switching=!1,t.loadData(c,MPD_SEEK_TYPE.SEEK)}))}}))}},{key:"_switch",value:function(e){var t=this.dash;t.lastDefaultSampleDuration={};var r=t.mpd.mediaList.video,n=r.selectedIdx;r.selectedIdx=e,this.mse.abort(CONTENT_TYPES.VIDEO),t.abortLoadingTasks(),r[n].mediaSegments.every((function(e){return e.downloaded=SEGMENT_STATE.NO_START,!0}));var i=t.mpd.mediaList.audio;i[i.selectedIdx]&&i[i.selectedIdx].mediaSegments&&i[i.selectedIdx].mediaSegments.forEach((function(e){e.downloaded===SEGMENT_STATE.GOING&&(e.downloaded=SEGMENT_STATE.NO_START)}));return n}},{key:"_handleInitData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.dash,o=new ProxyPromise,a=e instanceof ArrayBuffer;if(a){var s=0===t.length?e:e.slice(t[0],t[1]+1),u=null===r?null:e.slice(r[0],r[1]+1),c=i.mpd.videoCodecType;!1===i.useEME&&this.crypto?this.crypto.decryptHeader(s,c).then((function(t){var r=i.useEME?s:t.data;o.resolve({initSegmentRes:r,data:e,sidxSegmentRes:u,vid:t.vid,headers:n})})):o.resolve({initSegmentRes:s,data:e,sidxSegmentRes:u,vid:null,headers:n})}else;return o}},{key:"_appendInitSegment",value:function(e,t,r){var n=this,i=this.player,o=this.config.duration;this.dash.mpd.duration>0&&(o=this.dash.mpd.duration);var a=new ProxyPromise,s=this.dash.mpd.mediaList[e],u=t.initSegmentRes,c=t.sidxSegmentRes;return t.fromCache||(t.fromCache=!0,s[s.selectedIdx].wrapperData=t,c&&this.dash.mpd.getSidx(c,e,r,o)),this.mse.appendBuffer(e,u).then((function(){n._pluginInst.info({msg:"appendInitSegment",data:{mediaType:e,index:r}}),s[s.selectedIdx].inited=!0,a.resolve(),"video"===e&&(n.curVideoInitSegmentIdx=r)})).catch((function(e){e&&e.message===ERROR_TYPES$1.MSE_OP_FAIL&&i.emit(new Errors$1(Errors$1.MSE,Errors$1.MSE_PARSE_ERROR,{line:800,handle:"[DASH] appendInit",msg:e.message}))})),a}},{key:"_makeInitSegemntRequest",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.dash,o=this.config,a=new ProxyPromise,s=i.mpd&&i.mpd.mediaList[t][r],u=[],c="";if(!s)return a.reject({mediaType:t,index:r,initSegmentRange:u,url:c,rejected:!0}),debug$1$1.log("initSegmentRequest error"),a;u=(s.initSegmentRange||[]).concat();var l="segment_base"===i.mpd.dashType;l&&(u[1]=s.sidxRange[1]),c=s.initSegment,n&&(c="https:"+c,debug$1$1.log("forceHttps:",c));var d="video"===t&&(s.definition||this.bandwidth2item[s.bandwidth].definition);this._checkUrlRange(c);var f={mediaType:t,vid:o.vid,definition:"video"===t?d:void 0,useUrlRange:o.useUrlRange,timeout:-1};return i.getData(c,u,f).then((function(n){var i=n.res,o=n.headers,d=n.status,f=n.readyState;i&&"error"!==i?e._handleInitData(i,s.initSegmentRange,l?s.sidxRange:null,o).then((function(e){e.newIdx=r,e.mediaType=t,e.initSegmentRange=u,a.resolve(e)})):a.reject({mediaType:t,index:r,initSegmentRange:u,url:c,rejected:!0,reason:i,status:d,readyState:f})})).catch((function(e){a.reject({mediaType:t,index:r,initSegmentRange:u,url:c,rejected:!0,status:e&&e.status}),debug$1$1.log("initSegmentRequest error",e)})),a}},{key:"_makeInitSegemntRequestWithRetry",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.handleUrlExpire();var n=this.dash,i=this.player,o=new ProxyPromise;return this._makeInitSegemntRequest(t,r).then((function(t){e._pluginInst.info({msg:"initSegmentRequest succ"}),o.resolve(t)}),(function(a){e._pluginInst.info({msg:"initSegmentRequest fail",data:a});var s=a.url,u=a.status,c=a.readyState;if(a.rejected){if("error"===a.reason&&4===c&&0===u)return void i.emit("MEDIA_EXPIRED",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[403],{line:852,handle:"[DASH] task",msg:"init segment expired",url:s}));var l=403===u?TASK_REQUEST_EXPIRED:TASK_REQUEST_TIMEOUT;n.emit("error",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[u||"timeout"],{line:505,handle:"[DASH] task",msg:l,url:s}))}else e._makeInitSegemntRequest(t,r,!0).then((function(t){e._pluginInst.info({msg:"initSegmentRequest retry succ"}),o.resolve(t)}),(function(t){e._pluginInst.info({msg:"initSegmentRequest retry fail",data:t});var r=t.url,o=t.status,a=t.readyState;if("error"!==t.reason||4!==a||0!==o){var s=403===o?TASK_REQUEST_EXPIRED:TASK_REQUEST_TIMEOUT;n.emit("error",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[o||"timeout"],{line:505,handle:"[DASH] task",msg:s,url:r}))}else i.emit("MEDIA_EXPIRED",new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[403],{line:852,handle:"[DASH] task",msg:"init segment expired",url:r}))}))})),o}},{key:"updateAbrCacheData",value:function(e,t,r){var n=this.dash,i=this.config,o=i.autoBitrateOpts||{},a=n.mpd.mediaList.video,s=r.definition,u=i.definitionText&&i.definitionText[s]||s,c=a[e],l=r.bitrate;this.bitrateMap[l]={url:c.id,definition:s,definitionName:u},this.defiIdMap[c.id]={bitrate:l,definition:s},e===a.length-1&&this.isOpenAutoDefi&&this.definitions.push({name:o.autoDefiText||"auto",url:AUTO_FLAG,selected:t,definition:"自动",fps:void 0})}},{key:"destroyAbr",value:function(){var e=this,t=this.player;e.abrInstance&&(t&&t.off(ABR_EVENTS.UPDATE_AUTO_DESC,this._onAutoDescChange),e.abrInstance.destroy(),e.abrInstance=null)}},{key:"initAbr",value:(t=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this,r=this.player,n=this.config,util$1.on(r,ABR_EVENTS.UPDATE_AUTO_DESC,this._onAutoDescChange,"dashDestroy"),this.bitrateMap={},this.defiIdMap={},i=LOGOPEN,t.abrInstance=new ABR(r,n,0,n.dashOpts.dynamic_video,5e3,{logger:debug$1$1.abr,openLog:i}),util$1.once(r,ABR_EVENTS.ABR_START_PROGRESS,this.startProgressTimer,"dashDestroy"),t.abrInstance.onAbrChange=function(e,n,i,o){var a=t.bitrateMap[e],s=t.bitrateMap[n],u=a.definition,c=s.definition;debug$1$1.abr("abr change prevD:",u,"curDef:"+c),u!==c&&(t.abrSwitchURL(s.url),r.emit("ABR_CHANGE",{prev:u,cur:c,prevName:a.definitionName,curName:s.definitionName,abrInfo:o}))},util$1.on(r,ABR_EVENTS.ABR_CHANGE,t.abrInstance.onAbrChange,"dashDestroy"),t.abrInstance.isCurrentInAbr=this.isCurrentAutoDefi;case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"isCurrentInAbr",value:function(){return!!this.abrInstance&&this.abrInstance.isCurrentInAbr}}]),e}(),__DASH__$1=__DASH__,CHANGE_STATES=CHANGE_STATES$2,DashKernal=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"start",function(){var e=_asyncToGenerator(regenerator.mark((function e(t){var n,i,o,a,s,u;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Date.now(),i=r.__dash__,o=r._pluginInst,a=o.player,s=o.config,a.dashState=PLAYER_START,a.emit("dashStateChange",PLAYER_START),t||(t=a.config.url="anytext"),u=new DASH$1(t,r._pluginInst,i),i.initDash(u),!i.dashVideoEncrypted&&!i.dashAudioEncrypted){e.next=20;break}return debug$1$1.log("加密视频"),s.useEME=isEMESupported(),s.useEME||(i.crypto=new Crypto$1),s.intertrustServerURL&&(s.useEME=!0),u.useEME=s.useEME,i.awManager=new AwManager,e.next=17,i.awManager.init();case 17:r._info({msg:"encrypt video ready useEME ".concat(u.useEME)}),e.next=22;break;case 20:debug$1$1.log("非加密视频"),r._info({msg:" no encrypt video ready"});case 22:return a.dashState=WASM_START,a.emit("dashStateChange",WASM_START),e.next=26,r._onWasmReady({url:t});case 26:r._info({msg:"info player start execute",startMs:n,name:"start",profile:!0});case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_defineProperty$1(this,"_errorHandler",(function(e){var t=r._pluginInst,n=t.player,i=t.config,o=e;if("string"==typeof e){if(n.video.error&&2===n.video.error.code)e=new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES.timeout,{},n);else{var a=n.video.error&&n.video.error.code||0;e=new Errors$1(a>0?Errors$1.MEDIA:Errors$1.OTHER,a,{},n)}e.msg=o,n.video.error&&(e.msg+=";code"+n.video.error.code+"; details: "+n.video.error.message)}if(r._info({msg:"dashKernal error",data:e}),("network"!==e.errorType||!i.disableNetworkError)&&e&&n.dashState!==ERROR_HANDLER){n.dashState=ERROR_HANDLER,e.vid=i.vid,e.url=n.src;var s=r.__dash__,u=s&&s.isCurrentAutoDefi;if(e.errd&&"object"===_typeof$1(e.errd)&&s&&s.dash&&(e.errd.url=s.dash.url,e.url=s.dash.url),e.url&&e.url.indexOf("blob:")>-1&&i.dashOpts&&i.dashOpts.dynamic_video&&(e.url=i.dashOpts.dynamic_video.main_url),e&&e.errorCode===Errors$1.NETWORK_DISCONNECT)n.emit("error",e);else{if(n.emit("DATA_REPORT",e),e&&e.errorCode===Errors$1.CDM_LICENSE_ERROR)return r._pluginInst.destroyKernal(),void n.emit("error",e);if(e&&e.errorCode===Errors$1.MSE_MEDIA_TYPES_NOT_SUPPORTED)r._handleDegradeToMp4(e);else{if(e.segmentExpired||e.msg===TASK_REQUEST_EXPIRED)return s&&s.abrInstance&&"function"==typeof s.abrInstance._stop&&(s.abrInstance._stop(),debug$1$1.abr("error stop","expired",e.segmentExpired,e.ex)),void r._pluginInst.emitExpireEvent(e);if(!e.curReqVideoSegInfo&&s&&(e.curReqVideoSegInfo=JSON.parse(JSON.stringify(s.curReqVideoSegInfo||{}))),e.headers||(e.headers=e.curReqVideoSegInfo.headers||{}),!!i.useBackUrl&&!r._pluginInst._hasUsedBackUrl&&i.dashOpts&&i.dashOpts.dynamic_video&&s){debug$1$1.log("backup replay");var c=s.changeMainBackUrl(CHANGE_STATES.ERR,r._pluginInst._hasUsedBackUrl);return s.updateDashType(),u?c.autoBitrateOpts&&(c.autoBitrateOpts.isPlayAutoDefi=!0):(r.currentDefitionFromPlayer&&(c.defaultDefinition=r.currentDefitionFromPlayer.definition),c.autoBitrateOpts&&(c.autoBitrateOpts.isPlayAutoDefi=!1)),r._pluginInst._hasUsedBackUrl=!0,r._pluginInst.next(n.currentTime,"REPLAY",c,!0),void n.emit("playCatch","dash2dash_backup",e)}s&&s.updateDashType(!0),r._handleDegradeToMp4(e)}}}})),this._pluginInst=t,this._proxyPlayer(),this._initialize()}var t;return _createClass$1(e,[{key:"_proxyPlayer",value:function(){var e=this._pluginInst.player;e.switchURL=this._switchURL.bind(this),e._startInit=this.start,e.dash=!0,e.errorHandler=this._errorHandler}},{key:"_info",value:function(e){this._pluginInst.info(e)}},{key:"_onWasmReady",value:(t=_asyncToGenerator(regenerator.mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f,h,p,g,y=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,n=this._pluginInst,i=n.player,o=n.config,a=this.__dash__,s=a.dash,i.dashState=WASM_READY,i.emit("dashStateChange",WASM_READY),debug$1$1.log("监听到wasm_ready"),this._info({msg:"wasm_ready"}),util$1.on(s,"error",this._errorHandler,"destroy"),a.bindComEvent(),e.prev=10,e.next=13,s.init(r);case 13:if(u=e.sent,debug$1$1.time("initReady cost",(new Date).getTime()-a.startTimestamp),i.dashState=INIT_FINISHED,i.emit("dashStateChange",INIT_FINISHED),debug$1$1.log("dash init完成"),s.mpd.mediaList.video.length>0){for(o.defaultDefinition||(o.defaultDefinition=o.dashOpts.dynamic_video.dynamic_video_list[0].definition,a.lastDefiIdx=0),a.isOpenAutoDefi||(a.isCurrentAutoDefi=!1,a.abrInstance.isCurrentInAbr=!1),c=o.dashOpts.dynamic_video.dynamic_video_list,l=0;l<c.length;l++)d=c[l],a.bandwidth2item[d.bitrate]=d,a.definition2item[d.definition]=d;s.mpd.mediaList.video.sort((function(e,t){return t.height-e.height})),s.mpd.mediaList.video.forEach((function(e,t){var r=a.bandwidth2item[e.bandwidth],n=r.definition,u=!(n!==o.defaultDefinition||a.isOpenAutoDefi&&a.isPlayAutoDefi);a.definitions.push({name:o.definitionText&&o.definitionText[n]||n,url:e.id,selected:u,definition:r.definition,fps:r.fps}),e.frameRate=e.frameRate||r.fps||25;var c=r.bitrate;a.updateAbrCacheData(t,a.isPlayAutoDefi,r),n===o.defaultDefinition&&(i.emit("initialUrl",s.mpd.mediaList.video[t].baseURL),a.curBitrate=c,a.lastDefiIdx=t),u&&y._pluginInst.setCurrentDefitionInfos(r.definition,r)})),(f=a.definitions.some((function(e){return e.selected})))&&void 0!==a.lastDefiIdx||(f||(a.definitions[0].selected=!0,h=a.definitions[0].definition,this._pluginInst.setCurrentDefitionInfos(h,a.definition2item[h])),i.emit("initialUrl",s.mpd.mediaList.video[0].baseURL),a.curBitrate=o.dashOpts.dynamic_video.dynamic_video_list[0].bitrate,a.lastDefiIdx=0),i.emit("resourceReady",a.definitions,o.dashOpts.dynamic_video.dynamic_video_list),a.abrInstance.updateBitrate(a.curBitrate)}this._pluginInst.originStartInit.call(i,u.url),debug$1$1.time("start call cost",(new Date).getTime()-a.startTimestamp),i.dashState=CORE_START,i.emit("dashStateChange",CORE_START),a.startCheckCanplayTimer(),a.isDashCanUse=!0,a.mse=u,a.emitMenuResolutionChange(),"safari"===sniffer.browser&&(util$2.addClass(i.root,"canplay"),p=function(){util$2.removeClass(i.root,"xgplayer-is-enter")},util$1.once(i,"waiting",p)),g=function(){var e=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.emit("dash_start_play"),y._info({msg:"dash_start_play"}),i.dashState=START_PLAY,y._info({msg:"START_PLAY ready"}),i.emit("dashStateChange",START_PLAY),i.emit("playInterfaceInfo",o.dashOpts||{}),e.next=8,a.abrInstance.init(s.mpd.mediaList);case 8:a.abrInstance.execute(),a.isCurrentAutoDefi||debug$1$1.time("onStartPlay cost not abr",(new Date).getTime()-a.startTimestamp),a.startProgressTimer(),console.log("onStartPlay cost",(new Date).getTime()-a.startTimestamp);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),util$1.once(s,"start_play",g),this._info({msg:"START_PLAY dashready"}),i.emit("dashready"),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(10),i.errorHandler(e.t0);case 37:case"end":return e.stop()}}),e,this,[[10,34]])}))),function(e){return t.apply(this,arguments)})},{key:"_initialize",value:function(){if(debug$1$1.log("执行dashKernal"),"object"===("undefined"==typeof WebAssembly?"undefined":_typeof$1(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var e=this._pluginInst,t=e.player,r=e.config;if(r.dashOpts){r.dashOpts.Data&&"TOP"===r.playInfoType&&this._playInfoInit(),r.dashOpts.dynamic_video&&(r.dashOpts.dynamic_video.dynamic_video_list=r.dashOpts.dynamic_video.dynamic_video_list||[],r.dashOpts.dynamic_video.dynamic_audio_list=r.dashOpts.dynamic_video.dynamic_audio_list||[],[r.dashOpts.dynamic_video.dynamic_video_list,r.dashOpts.dynamic_video.dynamic_audio_list].forEach((function(e){e.forEach((function(e){e.bitrate=1e3*parseInt(e.bitrate/1e3,10)}))})));var n=CHANGE_STATES$2,i=new __DASH__$1({pluginInst:this._pluginInst});this.__dash__=i,"safari"===sniffer.browser&&(null==r.useEME&&(r.useEME=isEMESupported()),i.crypto=new Crypto$1),MSE$1.isSupported('video/mp4; codecs="avc1.64001E, mp4a.40.5"')?i.changeMainBackUrl(n.INIT,this._hasUsedBackUrl):t.errorHandler(new Errors$1(Errors$1.MSE,Errors$1.MSE_MEDIA_TYPES_NOT_SUPPORTED))}else console.error("dashOpts in plugin config miss")}}},{key:"_switchURL",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.__dash__,i=this._pluginInst,o=i.config,a=i.player;if((e=e.split("/")[e.split("/").length-1])===AUTO_FLAG)return n.abrInstance.start(),n.isCurrentAutoDefi=!0,n.abrInstance.isCurrentInAbr=!0,void setTimeout((function(){n.abrInstance._onTimeUpdate(null,!0)}));n.isCurrentAutoDefi&&(n.updateAutoDefiDesc("",!0),n.isCurrentAutoDefi=!1,n.abrInstance.isCurrentInAbr=this.isCurrentAutoDefi),r&&n.abrInstance.stop(!0),n._startLoadInitSegment(e,!0).then((function(e){if(n.selectedIdx===e.newIdx){var r=n.dash.mpd.mediaList.video,i=n._switch(e.newIdx),s=a.currentTime,u=null;if(o.nextSegmentSwitch)u=r[i||0].mediaSegments.find((function(e){return e.start-s>6}));else for(var c=r[i||0].mediaSegments,l=c.length-1;l>-1;l--)if(c[l].start<s){u=c[l];break}var d=!1;if(!u){var f=r[i||0].mediaSegments;u=f[f.length-1],d=!0}var h=util$1.round(u.start+1),p=util$1.round(a.getBufferedRange(o.useBuffered2?a.buffered2:a.buffered)[1]);debug$1$1.log("切换清晰度 curTime: ".concat(s," start: ").concat(h," end: ").concat(p));var g=r[r.selectedIdx].definition;t._pluginInst.setCurrentDefitionInfos(g,n.definition2item[g]),n.isCurrentInAbr()||(debug$1$1.log("definitionSwitchTime emit, current",n.selectedIdx),a.emit("definitionSwitchTime",h<s?s+1:h)),p-h>0&&"safari"!==sniffer.browser&&!d&&(debug$1$1.log("removeBuffer: ".concat(h," ").concat(p)),n.mse.removeBuffer(CONTENT_TYPES.VIDEO,o.nextSegmentSwitch?h:u.end,p).catch((function(){}))),n._appendInitSegment("video",e,e.newIdx).then((function(){n.switching=!1,n.loadData((u.start+u.end)/2,MPD_SEEK_TYPE.SEEK),n.emitMenuResolutionChange()}))}else debug$1$1.log("definitionSwitchTime cancel, current:",n.selectedIdx,"self",e.newIdx)}))}},{key:"_playInfoInit",value:function(){var e=this._pluginInst,t=e.config,r=e.playerConfig;t.vid=t.dashOpts.Data.VideoID||t.dashOpts.Data.Vid,r.vid=t.vid,t.duration=t.dashOpts.Data.Duration,t.dashOpts.dynamic_video=t.dashOpts.Data,t.dashOpts.dynamic_video.dynamic_video_list=[],t.dashOpts.dynamic_video.dynamic_audio_list=[],t.dashOpts.dynamic_video.dynamic_type=t.dashOpts.Data.AdaptiveInfo.AdaptiveType,t.dashOpts.dynamic_video.main_url=t.dashOpts.Data.AdaptiveInfo.MainPlayUrl;for(var n=0;n<t.dashOpts.Data.PlayInfoList.length;n++){var i=t.dashOpts.Data.PlayInfoList[n],o={backup_url_1:i.BackupPlayUrl,bitrate:t.dashOpts.Data.VideoID?i.Bitrate:1e3*i.Bitrate,check_info:i.CheckInfo,codec_type:i.Codec,definition:i.Definition,encrypt:!(!i.PlayAuth||!i.PlayAuthID&&!i.PlayAuthId),file_hash:i.FileHash||i.Md5,file_id:i.FileID,index_range:i.IndexRange,init_range:i.InitRange,kid:i.PlayAuthID||i.PlayAuthId,logo_type:i.Logo||i.LogoType,main_url:i.MainPlayUrl,preload_interval:i.PreloadInterval,preload_max_step:i.PreloadMaxStep,preload_min_step:i.PreloadMinStep,preload_size:i.PreloadSize,quality:i.Quality,size:i.Size,spade_a:i.PlayAuth,vheight:i.Height,vtype:i.Format,vwidth:i.Width};"video"===i.MediaType||"video"===i.FileType?t.dashOpts.dynamic_video.dynamic_video_list.push(o):"audio"!==i.MediaType&&"audio"!==i.FileType||t.dashOpts.dynamic_video.dynamic_audio_list.push(o)}}},{key:"_handleDegradeToMp4",value:function(e){var t=this,r=this._pluginInst,n=r.player,i=r.config;if(i.mp4Opts&&!this._hasDegradeMp4){this._hasDegradeMp4=!0,n.dashState=ERROR_CATCHING;var o=i.startTime||n.currentTime||0;setTimeout((function(){t._pluginInst._setStartTime("destroy",o,!0,!1),n.emit("playertypechange"),n.dashState=ERROR_CATCH_FINISHED,n.emit("playCatch","dash2mp4",e),i.defaultFormat="mp4",t._pluginInst.changeKernal(),n.once("canplay",(function(){var e=n.video.play();e&&e.catch((function(){}))}))}),0)}else n.dashState=ERROR_NO_MP4OPTS,n.emit("error",e)}},{key:"abrInstance",get:function(){return this.__dash__.abrInstance}},{key:"destroy",value:function(){var e=this._pluginInst.player;this.__dash__=null,e.switchURL=null,e.errorHandler=null,e.emit("dashDestroy")}},{key:"executeReady",value:function(){var e=this._pluginInst.player;util$1.once(e,"dash_start_play",(function(){e.dashState=NEXT_FINISHED,e.emit("nextEnded")}))}}]),e}(),Mp4Kernal=function(){function e(t){var r=this;_classCallCheck$1(this,e),_defineProperty$1(this,"_errorHandler",(function(e){var t=r._pluginInst.player,n=e;if("string"==typeof e){if(t.video.error&&2===t.video.error.code)e=new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES.timeout,{},t);else{var i=t.video.error&&t.video.error.code||0;e=new Errors$1(Errors$1.MEDIA,i,{},t)}e.msg=n,t.video.error&&(e.msg+=";code"+t.video.error.code+"; details: "+t.video.error.message)}var o=(new Date).getTime()/1e3>=r.urlExpireTimestamp&&r.urlExpireTimestamp>0;r._pluginInst.info({msg:"dash mp4 kernal error happend, url expired ".concat(o),err:e}),o&&t.video.error&&4===t.video.error.code?r._urlExpiredWhenInit||r._mp4CheckExpire():t.emit("error",e)})),_defineProperty$1(this,"_updateMp4Auto",(function(){setTimeout((function(){r._updateMp4AutoDesc()}),0)})),this._url=null,this._pluginInst=t,this._urlExpiredWhenInit=!1,this._initialize()}return _createClass$1(e,[{key:"start",value:function(){var e=this._pluginInst,t=e.config,r=e.player;t.defaultFormat="mp4",this._pluginInst.originStartInit.call(r,this._url),r.errorHandler=this._errorHandler,this._pluginInst.info({msg:"dash mp4 kernal start"})}},{key:"executeReady",value:function(){var e=this._pluginInst.player;e.dashState=NEXT_FINISHED,e.emit("nextEnded")}},{key:"_initialize",value:function(){this._handleMp4Definitions(),this._getMp4Opts();var e=this._pluginInst.player;e.dash=!1,e.emit("resourceReady",this._mp4Definitions||[],[].concat(this._RawMp4Definitions)),this._updateMp4Auto(),this.urlExpireTimestamp&&(this._urlExpiredWhenInit=(new Date).getTime()/1e3>=this.urlExpireTimestamp&&this.urlExpireTimestamp>0,this._mp4CheckExpire())}},{key:"_handleMp4Definitions",value:function(){var e=this,t=this._pluginInst,r=t.player,n=t.config;if(n.mp4Opts){this.mp4AutoItem=null;var i=[].concat(n.mp4Opts.mp4List||[]);i.every((function(e){return!!e.bitrate}))&&i.sort((function(e,t){return t.bitrate-e.bitrate}));var o=n.mp4Opts.isOpenAutoDefi,a=n.mp4Opts.isPlayAutoDefi,s=!1;if(o){var u={};i.forEach((function(e){u[(e.definition||"").toLowerCase()]=e}));for(var c=["720p","480p","360p"],l=null,d=0;d<c.length;d++){var f=u[c[d]];if(f){l=f;break}}if(l){this.mp4AutoItem=l;var h=n.mp4Opts.autoDefiText||"自动",p="".concat(h,"(").concat(l.definition,")");i.push({definition:h,url:AUTO_FLAG,name:p,url_expire:l.url_expire||0,selected:!!a}),s=a}}if(i.length>0){var g=i[0].url,y=i[0].url;i.forEach((function(e){e.definition===n.defaultDefinition&&(g=e.url,y=e.url)})),o&&a&&this.mp4AutoItem&&(g=this.mp4AutoItem.url,y=AUTO_FLAG),this._mp4Url=y,this._url=g}if(!s){for(var v=0;v<i.length;v++){var m=i[v];if(n.defaultDefinition===m.definition){m.selected=!0,s=!0;break}}s||(i[0].selected=!0)}this._mp4Definitions=i.map((function(t){n.defaultDefinition===t.definition&&(e._url=t.url,a||(t.selected=!0));var r=JSON.parse(JSON.stringify(t));return r.name=n.definitionText&&n.definitionText[t.definition]||t.definition,r.url_expire=t.url_expire||0,r})),this._backup_url=this._mp4Definitions[0].backup_url,this._RawMp4Definitions=i;for(var _=!1,b=0;b<i.length;b++){var A=i[b];A.codec_type&&A.vtype&&("h264"===A.codec_type&&"mp4"===A.vtype||(_=!0))}_&&r.emit("log",{type:"oneevent",end_type:MP4_SOURCE_ERR})}}},{key:"_getMp4Opts",value:function(){var e=this._pluginInst.player,t={url:this._mp4Url,realUrl:this._url,mp4Definitions:[].concat(this._mp4Definitions)};return this._getPlayInfoTimestamp=(new Date).getTime()/1e3,t.mp4Definitions&&t.mp4Definitions.length>0&&(this.urlExpireTimestamp=t.mp4Definitions[0].url_expire||0),this._proxyPlayer(),this._destroyMp4AutoHandler(),e.on("canplay",this._updateMp4Auto),this.urlExpireTimestamp&&(this.mp4CheckExpire=this._mp4CheckExpire.bind(this),e.on("timeupdate",this.mp4CheckExpire)),t}},{key:"_proxyPlayer",value:function(){var e=this._pluginInst.player;e.switchURL=this._switchURLMp4.bind(this),e.config.url=this._url}},{key:"_switchURLMp4",value:function(e){var t=this,r=this._pluginInst.player,n=e.split("/")[e.split("/").length-1]===AUTO_FLAG,i=n?this.mp4AutoItem.url:e;r.curTime=r.currentTime;var o=r.paused;this._url=n?AUTO_FLAG:e,r.ended||(r.src=i,util$1.once(r,"canplay",(function(){if(r.currentTime=r.curTime,!o){var e=r.play();void 0!==e&&e&&e.catch((function(e){}))}}))),n?this._setCurrentDefitionInfos("自动 ".concat(this.mp4AutoItem.definition),this.mp4AutoItem):util$1.once(r,"definitionChange",(function(e){for(var r=e.to,n=null,i=t._pluginInst.cnofig,o=0;o<i.mp4Opts.mp4List.length;o++){var a=i.mp4Opts.mp4List[o];if(a.definition===r){n=a;break}}t._setCurrentDefitionInfos("".concat(r),n)}))}},{key:"_mp4CheckExpire",value:function(){this._pluginInst.handleUrlExpire(this,!0)}},{key:"_updateMp4AutoDesc",value:function(){var e=this._pluginInst.player,t=this._url!==AUTO_FLAG||void 0;this.mp4AutoItem&&(e.emit("MP4_AUTO_DESC_CHANGE",JSON.parse(JSON.stringify(this.mp4AutoItem)),!!t||void 0),t||this._setCurrentDefitionInfos(this.mp4AutoItem.definition,this.mp4AutoItem))}},{key:"_setCurrentDefitionInfos",value:function(e,t){this._pluginInst.setCurrentDefitionInfos(e,t)}},{key:"_destroyMp4AutoHandler",value:function(){var e=this._pluginInst.player;e.off("canplay",this._updateMp4Auto),e.off("timeupdate",this._mp4CheckExpire),e.off("error",this._errorSwitchFormat)}},{key:"destroy",value:function(){this._pluginInst.player.errorHandler=null,this._destroyMp4AutoHandler(),this._pluginInst.unloadVideo()}}]),e}();function _createSuper$e(e){var t=_isNativeReflectConstruct$e();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var PRELOAD_NEXT=PRELOAD_NEXT$2,MEDIA_TYPES=MEDIA_TYPES$2,STATS_EVENTS=STATS_EVENTS$2,KERNAL_TYPES={MP4:"mp4",DASH:"dash",VOID:"void"},version$2="3.0.25";function getterMap(e){return{playerVersion:{get:function(){return version$2},configurable:!0},downloadSpeed:{get:function(){return Task$1.currentSpeed},configurable:!0},historyAvspeed:{get:function(){return Task$1.historyAvspeed},configurable:!0},abrInstance:{get:function(){return e.abrInstance},configurable:!0},menuCodeType:{get:function(){return e.menuCodeType},configurable:!0},playerType:{get:function(){return e.playerType},configurable:!0},supportMenus:{get:function(){return e.supportMenus},configurable:!0},CDNUrl:{get:function(){return e.CDNUrl},configurable:!0}}}var DASHPlugin=function(e){_inherits(r,e);var t=_createSuper$e(r);function r(){var e;_classCallCheck$1(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$1(_assertThisInitialized(e=t.call.apply(t,[this].concat(i))),"_hasUsedBackUrl",!1),e}return _createClass$1(r,[{key:"initDashPlayer",value:function(e){var t=this,r=this.config;this._hasTriggerBufferThreshold=!1,this._setArgsFromConfig(),this.lastBuffer="0,0",this._menuCodeType=null,this._setConfigDashType(),util$1.promisePolyfill(),(window.location.href.indexOf("playerInstance=true")>-1||proxyLocalStorage$1.getItem("playerInstance"))&&(void 0===window.dashPlayerInstanceList&&(window.dashPlayerInstanceList=[]),window.dashPlayerInstanceList.push(e)),this.dashPreloader=new DashPreloader(e,r,debug$1$1.preload);this._startBufferCheck(),util$1.on(e,PRELOAD_NEXT,(function(){t.dashPreloader.preloadNext()}),"destroy"),this.changeKernal(!1),window.addEventListener("beforeunload",this.cacheSpeed)}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NEXT",r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.player,o=this.config;this._pausedWhenExpiredRestart=!1,"MEDIA_EXPIRED"===t&&i.paused&&(this._pausedWhenExpiredRestart=!0),i.dashState=NEXT_START;var a=!1;if(i.isSrcVoid||!o.dashOpts&&!o.mp4Opts||i.ended||"MEDIA_EXPIRED"===t||"REPLAY"===t||i.duration&&i.currentTime<i.duration-DEFAULT_END&&(i.emit("logger_next",t),a=!0),this._hasTriggerBufferThreshold=!1,i.emit("next",t),i.emit("playertypechange"),r)for(var s in r)o[s]=r[s];this._setArgsFromConfig(),a&&this._setConfigDashType(),i.config.startTime=e,i.config.startTimeCache=e,i.config.DASHPlugin=r,this._syncParameters(),this.changeKernal(!0,!0),!n&&!i.config.autoplay||this._pausedWhenExpiredRestart||i.once("canplay",(function(){if(i.video){var e=i.video.play();e&&e.catch((function(){}))}})),this._pausedWhenExpiredRestart&&(this._pausedWhenExpiredRestart=!1)}},{key:"_replay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.next(e,"REPLAY")}},{key:"startPlayHandler",value:function(e,t,r){var n=this.config;if(n.dashOpts||n.mp4Opts){var i="NEXT"===t||"REPLAY"===t;this._setStartTime(r,e,i,!0)}}},{key:"beforePlayerInit",value:function(){if(!this._hasExecuteBeforeInit){var e=this.player;this._syncParameters(),e.config.nullUrlStart=!0,BasePlugin.defineGetterOrSetter(e,getterMap(this)),r.unionID&&(e.unionID=r.unionID,r.unionID=void 0),this._proxyPlayer(),this.initDashPlayer(e),this._hasExecuteBeforeInit=!0,e.isReady=!0}}},{key:"info",value:function(e){var t=this.player;STATS_EVENTS&&t.emit(STATS_EVENTS.STATS_INFO,e)}},{key:"resetStat",value:function(){var e=this.player;STATS_EVENTS&&e.emit(STATS_EVENTS.STATS_RESET)}},{key:"_syncParameters",value:function(){var e=this.config,t=this.playerConfig,r=e.vid||t.vid;e.vid=t.vid=r,t.autoBitrateOpts=e.autoBitrateOpts}},{key:"_proxyPlayer",value:function(){var e=this,t=this.player;this._originStartInit=t._startInit,t.getPreloadInfos=this.getPreloadInfos.bind(this),t.useHooks("replay",(function(t){e._replay()}))}},{key:"_setKernalType",value:function(){var e=this.config;e.dashOpts||e.mp4Opts?e.dashOpts&&e.mp4Opts?this._kernalType=e.defaultFormat:e.dashOpts?this._kernalType=KERNAL_TYPES.DASH:this._kernalType=KERNAL_TYPES.MP4:this._kernalType=KERNAL_TYPES.VOID}},{key:"changeKernal",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._setKernalType();var r=this.player;this.destroyKernal();var n=this._kernalType;n===KERNAL_TYPES.VOID?(r.isSrcVoid=!0,r.emit("playOptsVoid"),t&&r.emit("nextEnded")):(r.isSrcVoid=!1,this._setStartTime("destroy",r.config.startTime,!0,!1),n===KERNAL_TYPES.MP4?this._kernal=new Mp4Kernal(this):n===KERNAL_TYPES.DASH&&(this._kernal=new DashKernal(this))),e&&this._kernal&&(this._kernal.start(),t&&this._kernal.executeReady())}},{key:"destroyKernal",value:function(){this._kernal&&(this._kernal.destroy(),this._kernal=null)}},{key:"originStartInit",get:function(){return this._originStartInit}},{key:"_setArgsFromConfig",value:function(){var e=this.config;this._bufferThreshold=e.bufferThreshold}},{key:"setCurrentDefitionInfos",value:function(e,t){var r=t?t.fps:void 0;this._currentDefinition={definiton:e,fps:r,item:t}}},{key:"handleUrlExpire",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.config,i=this.player,o=i.paused,a=(new Date).getTime()/1e3>=e.urlExpireTimestamp&&e.urlExpireTimestamp>0;if(a&&(r||!o)&&n.getServerTime)i.serverTimeDiffPromise=i.serverTimeDiffPromise||n.getServerTime().catch((function(){return 0})),i.serverTimeDiffPromise.then((function(r){if(r&&(i.serverTimeDiff=(new Date).getTime()/1e3-r),(new Date).getTime()/1e3>=e.urlExpireTimestamp+i.serverTimeDiff){e.urlExpireTimestamp=MAX_TIMESTAMP;var n=new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[403]);t.emitExpireEvent(n)}}));else if(a){var s=new Errors$1(Errors$1.NETWORK,Errors$1.NETEORK_ERROR_CODES[403]);this.emitExpireEvent(s)}}},{key:"emitExpireEvent",value:function(e){var t=this.player,r=(new Date).getTime()/1e3;this.emitExpireTimestamp?r-this.emitExpireTimestamp>MIN_EXPIRE_INTERVAL&&(this.emitExpireTimestamp=r,t.emit("MEDIA_EXPIRED",e),this.info({msg:"MEDIA_EXPIRED"})):(this.emitExpireTimestamp=r,t.emit("MEDIA_EXPIRED",e),this.info({msg:"MEDIA_EXPIRED"}))}},{key:"_getCurDashType",value:function(){var e=proxyLocalStorage$1.getItem(URL_DASH_TAG),t=DASH_TYPE;return e===t.BACK?e:t.MAIN}},{key:"_setCurDashType",value:function(){this._initDashType=this._getCurDashType()}},{key:"_setConfigDashType",value:function(){this._setCurDashType();var e=this.playerConfig.vodLogOpts;e&&(e.currentDashType=this._initDashType)}},{key:"addDashPreloader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.dashPreloader?(this._setPreloaderLoadMode(!1),this.dashPreloader.preloadManager.addDashPreloader(e)):console&&console.warn("dashPreloader has destroyed")}},{key:"_setPreloaderLoadMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dashPreloader&&(this.dashPreloader.preloadManager.autoPreload=e)}},{key:"addDashPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.dashPreloader?(this._setPreloaderLoadMode(!1),this.dashPreloader.preloadManager.addDashPreloaderList(e)):console&&console.warn("dashPreloader has destroyed")}},{key:"setCodeInfo",value:function(e){var t=this.playerConfig.vodLogOpts,r=CodecsConfigMap[e],n=CodecsConfigMap[CodecsTypes.AVC],i=n.logCodeType,o=n.codecs;r&&(i=r.logCodeType,o=r.codecs),t&&(t.codec_type=i),this.menuCodeType=o}},{key:"cacheSpeed",value:function(){try{var e=Task$1.historyAvspeed;e>0&&e!==1/0&&proxyLocalStorage$1.setItem(SPPED_CACHE$1,e)}catch(error){}window.removeEventListener("beforeunload",this.cacheSpeed)}},{key:"unloadVideo",value:function(){var e=this.player;try{e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(error){}}},{key:"destroy",value:function(){clearInterval(this._bufferCheckTimer),this.cacheSpeed(),this.destroyKernal()}},{key:"_processPreloadProgress",value:function(e,t){for(var r=this.config,n=["video"],i=0;i<n.length;i++){var o=n[i],a=this.preloadManager.preloadCacheProgress({vid:r.vid,format:"dash",mediaType:o,prelaodType:e.preloadType,bitrate:e.bitrate,set_duration:e.pduration,set_size:e.size,media_type:"video"===o?MEDIA_TYPES.VIDEO:MEDIA_TYPES.AUDIO});a&&t.push(a)}}},{key:"getPreloadInfos",value:function(){var e=this.config;if(this.preloadManager&&this.preloadManager.preloadCacheProgress){var t=this.preloadManager.cachedDatas[e.vid],r=[];if(this._processPreloadProgress(t||{},r),r.length>0){var n={item_num:r.length,items:r},i={preloadInfo:n};return t&&(i.abr=1),debug$1$1.preload("updatePreloadCacheInfo",n),i}}return null}},{key:"_onBufferReachThreshold",value:function(){var e=this.player;if(e.video){for(var t=e.video.buffered,r=0,n=0,i=0;i<t.length&&(r=t.start(i),n=t.end(i),!(r<=e.video.currentTime&&e.video.currentTime<=n));i++);n-e.video.currentTime>=this._bufferThreshold&&!this._hasTriggerBufferThreshold&&(this._hasTriggerBufferThreshold=!0,e.emit("BUFFER_THRESHOLD",n-e.video.currentTime))}}},{key:"_startBufferCheck",value:function(){var e=this,t=this.player;this._bufferCheckTimer=setInterval((function(){if(t.video){for(var r=[],n=0,i=t.video.buffered.length;n<i;n++)r.push([t.video.buffered.start(n),t.video.buffered.end(n)]);r.toString()!==e.lastBuffer&&(e.lastBuffer=r.toString(),e._onBufferReachThreshold())}}),200)}},{key:"_setStartTime",value:function(e,t,r,n){var i=this,o=this.player,a=this.playerConfig,s=this.config;if(t>0||n){var u=!1,c=function(){u||(u=!0,o.currentTime=t,a.startTime=0,r&&t>0&&o.emit("setStartTime"),"mp4"===s.defaultFormat&&i.setCodeInfo(CodecsTypes.AVC))};util$1.once(o,"canplay",c,e),util$1.once(o,"playing",c,e)}}},{key:"preloadManager",get:function(){return this.dashPreloader?this.dashPreloader.preloadManager:null}},{key:"CDNUrl",get:function(){var e=this.config;if(e.dashOpts&&e.dashOpts.dynamic_video){var t=document.createElement("a");return t.href=e.dashOpts.dynamic_video.main_url,t.host}return null}},{key:"playerType",get:function(){return this.config.defaultFormat}},{key:"supportMenus",get:function(){var e="dash"===this.config.defaultFormat;return{speed:e,cdn:e,resolution:e}}},{key:"currentDefitionFromPlayer",get:function(){return this._currentDefinition}},{key:"abrInstance",get:function(){return this._kernal&&this._kernal.abrInstance?this._kernal.abrInstance:null}},{key:"menuCodeType",get:function(){return this._menuCodeType},set:function(e){var t=this.player;this._menuCodeType=e,t.emit("codecsupdate",e)}}],[{key:"pluginName",get:function(){return"DASHPlugin"}},{key:"defaultConfig",get:function(){return{bufferThreshold:10,defaultFormat:"dash",useEME:null,getLicenseUrl:"",intertrustServerURL:null,defaultDefinition:null,cdnHost:null,cdnBucket:null,useGapJump:!0,mediaType:void 0,useDurationBackoff:!1,useBuffered2:!1,maxHoleDuration:.5,preloadTime:50,dynamicPreloadTimeOpts:null,preloadCancelTime:5,progressTimer:1e3,disableCanplayCheck:!0,disableDashNoCanplayCheck:!0,disableBufferBreakCheck:!0,definitionText:null,useUnionInfoDRM:!1,keyTokenExpiredDuration:null,keyToken:null,playDomain:null,defaultSampleDurationCheck:!1,segmentRatio:7.5,preloadBufferThreshold:.5,MaxAppendTimeout:50,nextSegmentSwitch:!1}}},{key:"isEMESupported",value:function(){return isEMESupported()}},{key:"encryptUtils",get:function(){return isSupport$1}},{key:"DashPreloader",get:function(){return DashPreloader}},{key:"updateUnionInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t?t.unionID=e:r.unionID=e,document.cookie="volcvui=".concat(util$1.getUnionInfo(e)),util$1.getCookieValue("volcvui")}}]),r}(BasePlugin),_assign=function(){return(_assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var Hook=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var r=this;e&&t&&"function"==typeof t&&this.on(e,(function n(i){t(i),r.off(e,n)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var r=this._hooks[e].indexOf(t);-1!==r&&this._hooks[e].splice(r,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,r){if(r){if(!e)return;-1!==this._cache.indexOf(r)?this._emit(e,t):(this._hooksCache.hasOwnProperty(r)||(this._hooksCache[r]={}),this._hooksCache[r].hasOwnProperty(e)||(this._hooksCache[r][e]=[]),this._hooksCache[r][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&__spread(this._hooks[e]).forEach((function(e){try{e(t)}catch(r){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),isObject$h=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},isNumber=function(e){return"number"==typeof e&&!isNaN(e)},isString=function(e){return"string"==typeof e},isArray$4=function(e){return Array.isArray(e)},getIndex=(lastEventId=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return lastEventId+=1}),lastEventId,decrypto=function(e,t,r){if("string"==typeof e&&"number"==typeof t&&"number"==typeof r){var n,i=[];r=r<=25?r:r%25;var o=String.fromCharCode(r+97);n=e.split(o);for(var a=0;a<n.length;a++){var s=parseInt(n[a],r);s=1*s^t;var u=String.fromCharCode(s);i.push(u)}return i.join("")}},decodeUrl=function(e){return decrypto(e,64,25)},beforePageUnload=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},getIframeUrl=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}},loadScript=function(e,t,r){var n=document.createElement("script");n.src=e,n.onerror=function(){r(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)},isSupVisChange=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=1)})),e},selfAdjust=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var r,n=Date.now()+t;return r=window.setTimeout((function i(){var o=Date.now()-n;e(),n+=t,r=window.setTimeout(i,Math.max(0,t-o))}),t),function(){window.clearTimeout(r)}},stringify=function(e,t,r){void 0===t&&(t=""),void 0===r&&(r={});var n=e;"/"===(n=n.split("#")[0].split("?")[0])[e.length-1]&&(n=n.substr(0,e.length-1)),n="/"===t[0]?n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var i=Object.keys(r).map((function(e){return e+"="+r[e]})).join("&");return i.length>0?n+"?"+i:n},parseURL=function(e){var t=document.createElement("a");return t.href=e,t},parseUrlQuery=function(e){var t={};try{var r=parseURL(e).search;(r=r.slice(1)).split("&").forEach((function(e){var r,n,i=e.split("=");i.length&&(r=i[0],n=i[1]);try{t[r]=decodeURIComponent(void 0===n?"":n)}catch(o){t[r]=n}}))}catch(n){}return t},hashCode=function(e){for(var t=0,r=0,n=(e+="").length,i=0;i<n;i++)((t=31*t+e.charCodeAt(r++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var js_cookie=createCommonjsModule((function(e,t){var r;r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function i(){}function o(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(r);/^[\{\[]/.test(a)&&(r=a)}catch(c){}r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in o)o[u]&&(s+="; "+u,!0!==o[u]&&(s+="="+o[u].split(";")[0]));return document.cookie=t+"="+r+s}}function a(e,r){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),u=s.slice(1).join("=");r||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var c=t(s[0]);if(u=(n.read||n)(u,c)||t(u),r)try{u=JSON.parse(u)}catch(l){}if(i[c]=u,e===c)break}catch(l){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,r){o(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}((function(){}))},e.exports=r()})),Memory=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e){this.getItem(e)},e.prototype.setCookie=function(e,t){this.setItem(e,t)},e}();function isSupportLS(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}function isSupportSession(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}var local={getItem:function(e){try{var t=localStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(n){}return r||{}}catch(n){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,r)}catch(n){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(t){}},getCookie:function(e,t){try{return js_cookie.get(e,{domain:t||document.domain})}catch(r){return""}},setCookie:function(e,t,r,n){try{var i=n||document.domain,o=+new Date+r;js_cookie.set(e,t,{expires:new Date(o),path:"/",domain:i})}catch(a){}},isSupportLS:isSupportLS()},session={getItem:function(e){try{var t=sessionStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(n){}return r||{}}catch(n){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,r)}catch(n){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(t){}},getCookie:function(e){this.getItem(e)},setCookie:function(e,t){this.setItem(e,t)},isSupportSession:isSupportSession()},Storage=function(){function e(e,t){this._storage=t&&"session"===t?session:!e&&local.isSupportLS?local:new Memory}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,r,n){this._storage.setCookie(e,t,r,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),UTM=function(e,t,r,n){var i=new Storage(!1),o=new Storage(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",u={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var d=!1;for(var f in l)l[f]&&(-1!==c.indexOf(f)?(u.hasOwnProperty("tracer_data")||(u.tracer_data={}),u.tracer_data[f]=l[f]):u[f]=l[f],d=!0);if(d)o.setItem(s,"1"),i.setCookie(a,JSON.stringify(u),n,r);else{var h=i.getCookie(a,r);h&&(u=JSON.parse(h))}o.getItem(s)&&(u.hasOwnProperty("tracer_data")||(u.tracer_data={}),u.tracer_data.$utm_from_url=1)}catch(p){return l}return u},Client=function(){function e(e,t,r){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=r}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,r=document.referrer,n=r?parseURL(r).hostname:"",i=parseUrlQuery(window.location.href),o=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=UTM(this.appid,i,this.domain,this.cookie_expire);var a=this.browser(),s=this.os();return{browser:a.browser,browser_version:a.browser_version,platform:o,os_name:s.os_name,os_version:s.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:t,referrer:r,referrer_host:n,utm:this.utm,latest_data:this.last(r,n)}},e.prototype.last=function(e,t){var r="",n="",i="",o=location.hostname,a=!1;if(e&&t&&o!==t){r=e,n=t,a=!0;var s=parseUrlQuery(e);s.keyword&&(i=s.keyword)}return{$latest_referrer:r,$latest_referrer_host:n,$latest_search_keyword:i,isLast:a}},e.prototype.browser=function(){var e,t,r="",n=""+parseFloat(this.appVersion),i=this.userAgent;return-1!==i.indexOf("Edge")||-1!==i.indexOf("Edg")?(r="Microsoft Edge",-1!==i.indexOf("Edge")?(e=i.indexOf("Edge"),n=i.substring(e+5)):(e=i.indexOf("Edg"),n=i.substring(e+4))):-1!==(e=i.indexOf("MSIE"))?(r="Microsoft Internet Explorer",n=i.substring(e+5)):-1!==(e=i.indexOf("Lark"))?(r="Lark",n=i.substring(e+5,e+11)):-1!==(e=i.indexOf("MetaSr"))?(r="sougoubrowser",n=i.substring(e+7,e+10)):-1!==i.indexOf("MQQBrowser")||-1!==i.indexOf("QQBrowser")?(r="qqbrowser",-1!==i.indexOf("MQQBrowser")?(e=i.indexOf("MQQBrowser"),n=i.substring(e+11,e+15)):-1!==i.indexOf("QQBrowser")&&(e=i.indexOf("QQBrowser"),n=i.substring(e+10,e+17))):-1!==i.indexOf("Chrome")?-1!==(e=i.indexOf("MicroMessenger"))?(r="weixin",n=i.substring(e+15,e+20)):-1!==(e=i.indexOf("360"))?(r="360browser",n=i.substring(i.indexOf("Chrome")+7)):-1!==i.indexOf("baidubrowser")||-1!==i.indexOf("BIDUBrowser")?(-1!==i.indexOf("baidubrowser")?(e=i.indexOf("baidubrowser"),n=i.substring(e+13,e+16)):-1!==i.indexOf("BIDUBrowser")&&(e=i.indexOf("BIDUBrowser"),n=i.substring(e+12,e+15)),r="baidubrowser"):-1!==(e=i.indexOf("xiaomi"))?-1!==i.indexOf("openlanguagexiaomi")?(r="openlanguage xiaomi",n=i.substring(e+7,e+13)):(r="xiaomi",n=i.substring(e-7,e-1)):-1!==(e=i.indexOf("TTWebView"))?(r="TTWebView",n=i.substring(e+10,e+23)):(-1!==(e=i.indexOf("Chrome"))||-1!==(e=i.indexOf("Chrome")))&&(r="Chrome",n=i.substring(e+7)):-1!==i.indexOf("Safari")?-1!==(e=i.indexOf("QQ"))?(r="qqbrowser",n=i.substring(e+10,e+16)):-1!==(e=i.indexOf("Safari"))&&(r="Safari",n=i.substring(e+7),-1!==(e=i.indexOf("Version"))&&(n=i.substring(e+8))):-1!==(e=i.indexOf("Firefox"))?(r="Firefox",n=i.substring(e+8)):-1!==(e=i.indexOf("MicroMessenger"))?(r="weixin",n=i.substring(e+15,e+20)):-1!==(e=i.indexOf("QQ"))&&(r="qqbrowser",n=i.substring(e+3,e+8)),-1!==(t=n.indexOf(";"))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(" "))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(")"))&&(n=n.substring(0,t)),{browser:r,browser_version:n}},e.prototype.os=function(){for(var e="",t="",r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],n=0;n<r.length;n++){var i=r[n];if(i.r.test(this.userAgent)){"Mac OS X"===(e=i.s)&&this.isNewIpad()&&(e="iOS");break}}var o,a,s=function(e,t){var r=e.exec(t);return r&&r[1]?r[1]:""},u=function(e,t){var r=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return r?r.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=s(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=u("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(a=s(/Android ([\.\_\d]+)/,o=this.userAgent))||(a=s(/Android\/([\.\_\d]+)/,o)),t=a,e="android";break;case"iOS":t=this.isNewIpad()?u("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios"}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var r=navigator.userAgent.replace("Mozilla/5.0 (",""),n=r.indexOf(";");t=r.slice(0,n)}}catch(i){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),LOG;LOG={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"};var LOG_URL=LOG,SDK_VERSION="5.0.25",VISUAL_EDITOR_RANGERS="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-editor-rangers.js",VISUAL_AB_CORE="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-core.js",VISUAL_AB_LOADER="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-loader.js",HOT_PIC_URL="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/heatmap-core",VISUAL_URL_INSPECTOR="https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/tester-event-inspector",undef=void 0,date=new Date,timeZoneMin=date.getTimezoneOffset(),timezone=parseInt(""+-timeZoneMin/60,10),tz_offset=60*timeZoneMin,WEBID_URL="/webid",TOB_URL="/tobid",REPORT_URL="/list",COOKIE_EXPIRE=6048e5,ConfigManager=function(){function e(e){this.is_first_time=!0,this.configPersist=!1,this.initConfig=e;var t=new Client(e.app_id,e.cookie_domain||"",e.cookie_expire||COOKIE_EXPIRE).init(),r="__tea_cache_first_"+e.app_id;this.configKey="__tea_cache_config_"+e.app_id,this.sessionStorage=new Storage(!1,"session"),this.localStorage=new Storage(!1,"local"),e.configPersist&&(this.configPersist=!0,this.storage=1===e.configPersist?this.sessionStorage:this.localStorage);var n=this.localStorage.getItem(r);n&&1==n?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(r,"1")),this.envInfo={user:{user_unique_id:undef,user_type:undef,user_id:undef,user_is_auth:undef,user_is_login:undef,device_id:undef,web_id:undef,ip_addr_id:undef},header:{app_id:undef,app_name:undef,app_install_id:undef,install_id:undef,app_package:undef,app_channel:undef,app_version:undef,os_name:t.os_name,os_version:t.os_version,device_model:t.device_model,ab_client:undef,traffic_type:undef,client_ip:undef,device_brand:undef,os_api:undef,access:undef,language:t.language,region:undef,app_language:undef,app_region:undef,ab_version:undef,creative_id:t.utm.creative_id,ad_id:t.utm.ad_id,campaign_id:t.utm.campaign_id,log_type:undef,rnd:undef,platform:t.platform,sdk_version:SDK_VERSION,sdk_lib:"js",province:undef,city:undef,timezone:timezone,tz_offset:tz_offset,tz_name:undef,sim_region:undef,carrier:undef,resolution:t.screen_width+"x"+t.screen_height,browser:t.browser,browser_version:t.browser_version,referrer:t.referrer,referrer_host:t.referrer_host,width:t.screen_width,height:t.screen_height,screen_width:t.screen_width,screen_height:t.screen_height,utm_term:t.utm.utm_term,utm_content:t.utm.utm_content,utm_source:t.utm.utm_source,utm_medium:t.utm.utm_medium,utm_campaign:t.utm.utm_campaign,tracer_data:JSON.stringify(t.utm.tracer_data),custom:{},wechat_unionid:undef,wechat_openid:undef}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.initDomain()}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=decodeUrl(LOG_URL[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.initConfig.report_url||REPORT_URL;break;case"webid":t=WEBID_URL;break;case"tobid":t=TOB_URL}var r="";return this.initConfig.caller&&(r="?sdk_version="+SDK_VERSION+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+r},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(r){if(void 0!==e[r]&&null!==e[r]||t.delete(r),"evtParams"===r)t.evtParams=_assign({},t.evtParams||{},e.evtParams||{});else if("_staging_flag"===r)t.evtParams=_assign({},t.evtParams||{},{_staging_flag:e._staging_flag});else if("reportErrorCallback"===r&&"function"==typeof e[r])t.reportErrorCallback=e[r];else{var n="",i="";if(r.indexOf(".")>-1){var o=r.split(".");n=o[0],i=o[1]}n?"user"===n||"header"===n?t.envInfo[n][i]=e[r]:t.envInfo.header.custom[i]=e[r]:t.envInfo.user.hasOwnProperty(r)?["user_type","ip_addr_id"].indexOf(r)>-1?t.envInfo.user[r]=e[r]?Number(e[r]):e[r]:["user_id","web_id","user_unique_id"].indexOf(r)>-1?t.envInfo.user[r]=e[r]?String(e[r]):e[r]:["user_is_auth","user_is_login"].indexOf(r)>-1?t.envInfo.user[r]=Boolean(e[r]):"device_id"===r&&(t.envInfo.user[r]=e[r]):t.envInfo.header.hasOwnProperty(r)?t.envInfo.header[r]=e[r]:t.envInfo.header.custom[r]=e[r]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:this.envInfo.user.hasOwnProperty(e)?this.envInfo.user[e]:this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(t){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var r=Object.assign(e,t);this.storage.setItem(this.configKey,r)}}catch(n){}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey);return e&&Object.keys(e).length?e:null}catch(t){return null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(r){}},e}(),Logger=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("[instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("[instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("[instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),Types,e;e=Types||(Types={}),e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready";var Types$1=Types,AppBridge=function(){function e(e){this.native=e}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,r){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):r(!1)})):r(!1)}catch(n){console.log("AppLogBridge, error:"+JSON.stringify(n.stack)),r(!1)}}))},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(r){"user_unique_id"===r?t.setUserUniqueId(e[r]):e[r]?t.addHeaderInfo(r,e[r]):t.removeHeaderInfo(r)}))}catch(r){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(t){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(r){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(t){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(t){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(r){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(t){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(t){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(t){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(t){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(t){console.error("profileAppend error")}},e}(),ERROR={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005};function fetch$1(e,t,r,n,i,o,a,s){try{var u=new XMLHttpRequest,c=s||"POST";u.open(c,""+e,!0),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),a&&u.setRequestHeader("X-MCS-AppKey",""+a),n&&(u.withCredentials=!0),u.onload=function(){if(i){var e=null;if(u.responseText){try{e=JSON.parse(u.responseText)}catch(r){e={}}i(e,t)}}},r&&(u.timeout=r,u.ontimeout=function(){o&&o(t,ERROR.TIMEOUT)}),u.onerror=function(){u.abort(),o&&o(t,ERROR.XHR_ON)},u.send(JSON.stringify(t))}catch(l){}}var GIF_URL="/gif",ERROR$1={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},isSupportBeacon=function(){return!(!window.navigator||!window.navigator.sendBeacon)},encodePayload=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(t+="&"+r+"="+encodeURIComponent(JSON.stringify(e[r])));return"&"===t[0]?t.slice(1):t},sendByImg=function(e,t,r,n){try{var i,o=e.match(/\/v\d\//);i=o?o[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(i)[0];if(!a)return void n(e,t,ERROR$1.NO_URL);t.forEach((function(i){var o=encodePayload(i),s=new Image(1,1);s.onload=function(){s=null,r&&r()},s.onerror=function(){s=null,n&&n(e,t,ERROR$1.IMG_ON)},s.src=""+a+GIF_URL+"?"+o}))}catch(s){n&&n(e,t,ERROR$1.IMG_CATCH,s.message)}},request$1=function(e,t,r,n,i,o,a){var s=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===s.indexOf("MSIE 8.0")&&-1===s.indexOf("MSIE 9.0")){if(a)return isSupportBeacon()?void(window.navigator.sendBeacon(e,JSON.stringify(t))?i():o(e,t,ERROR$1.BEACON_FALSE)):void sendByImg(e,t,i,o)}else sendByImg(e,t,i,o);fetch$1(e,t,r,n,i,o)},Event$2=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.cacheStorgae=new Storage(!0),this.localStorage=new Storage(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.collect.on(Types$1.Ready,(function(){r.reportAll(!1)})),this.collect.on(Types$1.ConfigDomain,(function(){r.reportUrl=r.configManager.getUrl("event")})),this.collect.on(Types$1.Event,(function(e){r.event(e)})),this.collect.on(Types$1.BeconEvent,(function(e){r.beconEvent(e)})),this.collect.on(Types$1.CleanEvents,(function(){r.reportAll(!1)})),this.linster()},e.prototype.linster=function(){var e=this;window.addEventListener("unload",(function(){e.reportAll(!0)}),!1),beforePageUnload((function(){e.reportAll(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.reportAll(!0)}),!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var r=__spread(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,r),this.reportTimeout&&clearTimeout(this.reportTimeout),r.length>=this.maxReport)this.report(!1);else{var n=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),n)}}catch(i){}},e.prototype.beconEvent=function(e){var t=__spread(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.destroyInstance||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))},e.prototype.reportBecon=function(){if(!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var r=0;r<e.length;r+=this.eventLimit){var n;n=e.slice(r,r+this.eventLimit);var i=this.split(this.merge(n));this.send(i,t)}else i=this.split(this.merge(e)),this.send(i,t)},e.prototype.merge=function(e){var t=this,r=this.configManager.get(),n=r.header,i=r.user;n.custom=JSON.stringify(n.custom);var o=this.configManager.get("evtParams"),a=e.map((function(e){try{Object.keys(o).length&&(e.params=_assign({},o,e.params));var r=t.localStorage.getItem(t.abKey);return r&&r.uuid&&r.uuid===i.user_unique_id&&t.configManager.getAbVersion()&&(e.ab_sdk_version=t.configManager.getAbVersion()),e.session_id=t.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(n){return e}})),s=JSON.parse(JSON.stringify({events:a,user:i,header:n}));s.local_time=Math.floor(Date.now()/1e3),s.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0;var u=[];return u.push(s),u},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var r=this;e.length&&e.forEach((function(e){try{var n=JSON.parse(JSON.stringify(e));r.config.filter&&((n=r.config.filter(n))||console.warn("filter must return data !!")),r.collect.eventFilter&&n&&((n=r.collect.eventFilter(n))||console.warn("filterEvent api must return data !!"));var i=n||e;r.collect.emit(Types$1.SubmitBefore,i),r.collect.emit(Types$1.SubmitVerify,i),request$1(r.reportUrl,i,r.timeout,r.enable_ttwebid,(function(e,t){e&&0!==e.e?r.collect.emit(Types$1.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}):r.collect.emit(Types$1.SubmitScuess,{eventData:t,res:e})}),(function(e,t){r.configManager.get("reportErrorCallback")(e,t),r.collect.emit(Types$1.SubmitError,{type:"f_net",eventData:e,errorCode:t})}),t),r.collect.emit(Types$1.SubmitAfter,i)}catch(o){console.warn("something error, "+JSON.stringify(o.stack))}}))},e}(),b=function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},localWebId=function(){return b().replace(/-/g,"").slice(0,19)},Token=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new Storage(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(Types$1.ConfigUuid,(function(e){r.setUuid(e)})),this.collect.on(Types$1.ConfigWebId,(function(e){r.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(Types$1.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(Types$1.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:localWebId(),user_unique_id:this.configManager.get("user_unique_id")||localWebId()}):this.remoteWebid()},e.prototype.checkEnv=function(){if(-1!==window.navigator.userAgent.indexOf("miniProgram")){var e=parseUrlQuery(window.location.href);return!(!e||!e.Web_ID||(this.complete({web_id:""+e.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+e.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this;fetch$1(this.configManager.getUrl("webid"),{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},3e3,!1,(function(t){t&&0===t.e?e.complete({web_id:e.configManager.get("web_id")||t.web_id,user_unique_id:e.configManager.get("user_unique_id")||t.web_id}):(e.collect.emit(Types$1.TokenError),console.warn("[]appid: "+e.config.app_id+" webid error, init error~"))}),(function(){e.collect.emit(Types$1.TokenError),console.warn("[]appid: "+e.config.app_id+", get webid error, init error~")}))},e.prototype.complete=function(e){var t=e.web_id,r=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:r}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(Types$1.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",r=this.configManager.get("user_unique_id");(r||t)&&this.configManager.set({user_unique_id:r||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(Types$1.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),r=this.configManager.get("user_unique_id"),n=this.cacheToken&&this.cacheToken.user_unique_id;if(t===r&&t===n)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(Types$1.TokenChange,"uuid"),this.collect.emit(Types$1.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(Types$1.TokenReset))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),r=this.configManager.get("user_unique_id");r&&r!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(Types$1.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(Types$1.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this,t=this.configManager.getUrl("tobid");return new Promise((function(r){fetch$1(t,{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id")},3e4,e.enable_ttwebid,(function(e){e&&0===e.e?r(e.tobid):r("")}),(function(){r("")}))}))},e}(),sessionId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Session=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.storage=new Storage(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(Types$1.SessionReset,(function(){r.resetSessionId()})),this.collect.on(Types$1.SessionResetTime,(function(){r.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:sessionId(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime)},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(){var e={sessionId:sessionId(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),AutoBase=function(e){var t=e.app_id,r=e.channel,n=e.onTokenReady,i=LOG_URL[r]+"/webid",o=new Storage(!1),a="__tea_cache_tokens_"+t,s=o.getItem(a);s&&s.web_id?n(s.web_id):request$1(i,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,(function(e){if(e&&0===e.e){n(e.web_id);var t={web_id:e.web_id,user_unique_id:e.web_id,timestamp:Date.now()};o.setItem(a,t)}else n("")}),(function(){n("")}),!0)},pluginExtendList={autotrack:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/autotrack.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/ab.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/stay.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/route.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/cep.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/tracer.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"}},sdk_type="base";sdk_type="full";var Collector$1=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.sdkReady=!1,this.adapters={},this.name=e,this.hook=new Hook,this.remotePlugin=new Map,this.Types=Types$1,this.adapters.fetch=fetch$1,this.adapters.storage=Storage}return e.usePlugin=function(t,r,n){if(r){for(var i=!1,o=0,a=e.plugins.length;o<a;o++)if(e.plugins[o].name===r){e.plugins[o].plugin=t,e.plugins[o].options=n||{},i=!0;break}i||e.plugins.push({name:r,plugin:t,options:n})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,r){e&&("full"===sdk_type&&pluginExtendList.hasOwnProperty(e)?console.info("your sdk version has "+e+" already ~"):t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:r}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var r=this;this.inited?console.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&isObject$h(t)?t.app_id&&isNumber(t.app_id)?!t.app_key||isString(t.app_key)?(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(console.warn("channel must be `cn`, `sg`,`va` !!!"),t.channel="cn"),this.logger=new Logger(this.name,t.log),this.appBridge=new AppBridge(t.Native),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new ConfigManager(t),this.initConfig=t,this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new Event$2,this.tokenManager=new Token,this.sessionManager=new Session,Promise.all([new Promise((function(e){r.once(Types$1.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){r.once(Types$1.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var n=t.plugin,i=t.options,o=Object.assign(r.initConfig,i),a=new n;return a.apply(r,o),e.push(a),e}),r.pluginInstances)}catch(n){console.log("load plugin error, "+n.message)}r.sdkReady=!0,r.emit(Types$1.Ready),r.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(r.configManager.get("user"))),r.logger.info("appid: "+t.app_id+", sdk is ready, version is "+SDK_VERSION+", you can report now !!!");try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(n){}t.disable_auto_pv&&(r.disableAutoPageView=!0),r.pageView(),r.on(Types$1.TokenChange,(function(e){"webid"===e&&r.pageView(),r.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(r.configManager.get("user")))})),r.on(Types$1.TokenReset,(function(){r.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(r.configManager.get("user")))})),r.on(Types$1.RouteChange,(function(e){e.init||t.disable_route_report||r.pageView()}))})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t),this.emit(Types$1.Init)),this.inited=!0):console.warn("app_key param is error, must be string, please check!"):console.warn("app_id param is error, must be number, please check!"):console.warn("init params error,please check")},e.prototype.config=function(e){if(this.inited)if(e&&isObject$h(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=_assign({},e);if(this.initConfig&&this.initConfig.configPersist){var r=this.configManager.getStore();r&&(t=Object.assign(r,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var n=__rest(t,["web_id","user_unique_id"]);t.hasOwnProperty("web_id")&&this.emit(Types$1.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(Types$1.ConfigUuid,t.user_unique_id),this.configManager.set(n)}else console.warn("config params is error, please check");else console.warn("config must be use after function init")},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(Types$1.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(Types$1.Start),this.bridgeReport&&this.pageView())},e.prototype.event=function(e,t){var r=this;try{if(this.initConfig&&this.initConfig.disable_track_event)return;var n=[];Array.isArray(e)?e.forEach((function(e){n.push(r.processEvent(e[0],e[1]||{}))})):n.push(this.processEvent(e,t)),this.bridgeReport?n.forEach((function(e){var t=e.event,n=e.params;r.appBridge.onEventV3(t,JSON.stringify(n))})):n.length&&(this.emit(Types$1.Event,n),this.emit(Types$1.SessionResetTime))}catch(i){console.warn("something error, please check")}},e.prototype.beconEvent=function(e,t){if(!this.initConfig||!this.initConfig.disable_track_event)if(Array.isArray(e))console.warn("beconEvent not support batch report, please check");else{var r=[];r.push(this.processEvent(e,t||{})),r.length&&(this.emit(Types$1.BeconEvent,r),this.emit(Types$1.SessionResetTime))}},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{var r=e;/^event\./.test(e)&&(r=e.slice(6));var n=t;"object"!=_typeof$3(n)&&(n={}),n.profile?delete n.profile:n.event_index=getIndex();var i=void 0;return n.local_ms?(i=n.local_ms,delete n.local_ms):i=+new Date,{event:r,params:n,local_time_ms:i,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(o){return{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,r){this.hook.emit(e,t,r)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){void 0===e&&(e={});var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+this.configManager.is_first_time},r=_assign({},t,e);this.event("predefine_pageview",r)},e.prototype.clearEventCache=function(){this.emit(Types$1.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=hashCode(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(Types$1.CustomWebId)}},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=hashCode(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(Types$1.CustomWebId)}},e.prototype.resetStayDuration=function(e,t,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===r&&(r=""),this.emit(Types$1.ResetStay,{url_path:e,title:t,url:r},Types$1.Stay)},e.prototype.resetStayParams=function(e,t,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===r&&(r=""),this.emit(Types$1.SetStay,{url_path:e,title:t,url:r},Types$1.Stay)},e.prototype.getToken=function(e,t){var r=this,n=!1,i=function(t){if(!n){n=!0;var i=r.configManager.get().user;return t&&(i.tobid=t,i["diss".split("").reverse().join("")]=t),e(_assign({},i))}},o=function(){r.tokenManager.getTobId().then((function(e){i(e)}))};this.sdkReady?o():(t&&setTimeout((function(){i()}),t),this.on(Types$1.Ready,(function(){o()})))},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(Types$1.ProfileSet,e,Types$1.Profile)},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(Types$1.ProfileSetOnce,e,Types$1.Profile)},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(Types$1.ProfileIncrement,e,Types$1.Profile)},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(Types$1.ProfileUnset,e,Types$1.Profile)},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(Types$1.ProfileAppend,e,Types$1.Profile)},e.prototype.setExternalAbVersion=function(e){this.emit(Types$1.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,Types$1.Ab)},e.prototype.getVar=function(e,t,r){this.emit(Types$1.AbVar,{name:e,defaultValue:t,callback:r},Types$1.Ab)},e.prototype.getABconfig=function(e,t){this.emit(Types$1.AbConfig,{params:e,callback:t},Types$1.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(Types$1.AbVersionChangeOn,e,Types$1.Ab),function(){t.emit(Types$1.AbVersionChangeOff,e,Types$1.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(Types$1.AbVersionChangeOff,e,Types$1.Ab)},e.prototype.openOverlayer=function(){this.emit(Types$1.AbOpenLayer,"",Types$1.Ab)},e.prototype.closeOverlayer=function(){this.emit(Types$1.AbCloseLayer,"",Types$1.Ab)},e.prototype.getAllVars=function(e){this.emit(Types$1.AbAllVars,e,Types$1.Ab)},e.prototype.autoInitializationRangers=function(e){AutoBase(e)},e.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(Types$1.TokenComplete))},e.plugins=[],e}(),STYLE_ID="__rangers_ab_style__";function openOverlayer(){if(!document.getElementById(STYLE_ID)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id=STYLE_ID,r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.appendChild(r)}}function closeOverlayer(){var e=document.getElementById(STYLE_ID);e&&e.parentElement.removeChild(e)}var msgQueueMap={},allowdOrigins=[],addAllowdOrigin=function(e){e.length&&e.forEach((function(e){allowdOrigins.push(e)}))};function dispatchMsg(e,t,r,n){var i=e&&e.source||window.opener||window.parent,o=e&&e.origin||n||"*",a={type:t,payload:r};i.postMessage(JSON.stringify(a),o)}function receiveMsg(e,t){msgQueueMap[e]=msgQueueMap[e]||[],msgQueueMap[e].push(t)}function processMsg(e){if(allowdOrigins.some((function(e){return"*"===e}))||allowdOrigins.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(i){t=void 0}if(!t)return;var r=t.type,n=t.payload;msgQueueMap[r]&&msgQueueMap[r].forEach((function(t){"function"==typeof t&&t(e,n)}))}}function init(e,t){var r=_assign({},e);delete r.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",copyConfig:r,version:t},"*"),window.addEventListener("message",processMsg,!1)}var VISUAL_URL="",isLoaded=!1;function loadEditorScript(e){var t=e.event,r=e.editorUrl;e.collectInstance,e.fromSession,isLoaded||(isLoaded=!0,loadScript(r,(function(){dispatchMsg(t,"abEditorScriptloadSuccess")}),(function(){t&&dispatchMsg(t,"abEditorScriptloadError"),isLoaded=!1})))}function readyToLoadEditor(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{},addAllowdOrigin(["*"]);var r,n="";init(t,SDK_VERSION);var i="";try{var o=window.performance.getEntriesByType("resource");if(o&&o.length&&(o.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(i=e.name)})),i||document.currentScript&&(i=document.currentScript.src),i&&(r=i.split("/"))&&r.length)){n="https:/";for(var a=2;a<r.length&&a!==r.length-1;a++)n=n+"/"+r[a];n+="/visual-ab-core"}}catch(s){}receiveMsg("tea:openVisualABEditor",(function(r){var i=r.data;if("string"==typeof r.data)try{i=JSON.parse(r.data)}catch(s){i=void 0}if(i){var o=i.lang;if(i.appId!==t.app_id)return dispatchMsg(r,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var a=i.version;VISUAL_URL=a&&n?n+(a?"."+a:".1.0.1")+".js?query="+Date.now():VISUAL_AB_CORE+"?query="+Date.now(),window.TEAVisualEditor.lang=o,window.TEAVisualEditor.__ab_domin=t.channel_domain||"",loadEditorScript({event:r,editorUrl:VISUAL_URL,collectInstance:e})}}))}var loadMuiltlink=function(e,t){window.TEAVisualEditor.appId=t.app_id,receiveMsg("tea:openTesterEventInspector",(function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(a){r=void 0}if(r){var n=r.referrer,i=r.lang,o=r.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=o||"",window.TEAVisualEditor.lang=i||"",loadEditorScript({event:t,editorUrl:VISUAL_URL_INSPECTOR+".js?query="+Date.now(),collectInstance:e})}}))},loadVisual=function(e){window.TEAVisualEditor.__ab_config=e,loadScript(VISUAL_AB_LOADER+"?query="+Date.now(),(function(){console.log("load visual render success")}),(function(){console.log("load visual render fail")}))},CallbackType;!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(CallbackType||(CallbackType={}));var STORAGE_EXPRIRE=2592e6,API="/service/2/abtest_config/",DOMAINS={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Ab=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1}return e.prototype.apply=function(e,t){var r=this;if(this.collect=e,this.config=t,this.config.enable_ab_test){var n=t.enable_multilink,i=t.ab_channel_domain,o=t.enable_ab_visual,a=i||decodeUrl(DOMAINS[t.channel||"cn"]),s=e.adapters,u=s.storage,c=s.fetch;this.cacheStorgae=new u(!1),this.fetch=c,this.enable_multilink=n,this.enable_ab_visual=o,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.fetchUrl=""+a+API,this.reportUrl=""+e.configManager.getUrl("event");var l=this.collect.Types;this.types=l,this.collect.on(l.TokenChange,(function(e){"uuid"===e&&r.readyStatus&&(r.clearCache(),r.fetchAB())})),this.collect.on(l.AbVar,(function(e){var t=e.name,n=e.defaultValue,i=e.callback;r.getVar(t,n,i)})),this.collect.on(l.AbAllVars,(function(e){r.getAllVars(e)})),this.collect.on(l.AbConfig,(function(e){var t=e.params,n=e.callback;r.getABconfig(t,n)})),this.collect.on(l.AbExternalVersion,(function(e){r.setExternalAbVersion(e)})),this.collect.on(l.AbVersionChangeOn,(function(e){r.changeListener.set(e,e)})),this.collect.on(l.AbVersionChangeOff,(function(e){r.changeListener.get(e)&&r.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(l.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var r=this.collect.hook._hooksCache[e];if(!Object.keys(r).length)return;var n=function(e){r[e].length&&r[e].forEach((function(r){t.collect.hook.emit(e,r)}))};for(var i in r)n(i)}},e.prototype.loadMode=function(){var e=getIframeUrl(),t="";if(e){var r=e.scenario,n=e.href;r?(this.editMode=!0,t=r):!n||-1===n.indexOf("datatester")&&-1===n.indexOf("visual-editor")||(this.editMode=!0,t="visual-editor")}this.enable_ab_visual&&(readyToLoadEditor(this.collect,this.config),"visual-editor"===t)?this.collect.destoryInstace():this.enable_multilink&&loadMuiltlink(this.collect,this.config)},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,r=e.ab_ext_version,n=e.ab_version_multilink,i=e.data,o=this.checkFromUrl();o?this.mulilinkVersions.push(o):this.mulilinkVersions=n||[],this.extVersions=r||[],this.versions=t||[],this.data=i;var a=this.versions.concat(this.extVersions);this.enable_multilink&&(a=a.concat(this.mulilinkVersions)),this.configVersions(a.join(","))},e.prototype.checkFromUrl=function(){var e=parseUrlQuery(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions,t=e.concat(this.mulilinkVersions);this.configVersions(t.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,r){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof r)throw new Error("callback must be a function");var n={name:e,defaultValue:t,callback:r,type:CallbackType.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(n,e):this.callbacks.push(n)},e.prototype.getRealVar=function(e,t){var r=e.name,n=e.defaultValue,i=e.callback,o=this.data;if(o){if(isObject$h(o[r])){var a=o[r].vid;return"$ab_url"===t?this.mulilinkVersions.includes(a)||this.mulilinkVersions.push(a):this.versions.includes(a)||this.versions.push(a),this.updateVersions(),this.fechEvent(a,t,n),void i(o[r].val)}i(n)}else i(n)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:CallbackType.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype.fechEvent=function(e,t,r){var n=this;try{if(this.config.disable_track_event)return;if(!e)return;var i=this.collect.configManager.get(),o=i.header,a=i.user,s=this.getABCache();if(s&&s.uuid&&s.uuid!==a.user_unique_id)return;var u={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?r:window.location.href}),local_time_ms:Date.now()};o.custom=JSON.stringify(o.custom);var c={events:[u],user:a,header:o};"$ab_url"===t?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):this.fetch(this.reportUrl,[c],2e4):setTimeout((function(){n.fetch(n.reportUrl,[c],2e4)}),16)}catch(l){}},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var r=Object.keys(e);r&&r.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.cacheStorgae.getItem(this.abKey)||t,Date.now()-t.timestamp>=STORAGE_EXPRIRE?(this.cacheStorgae.removeItem(this.abKey),null):e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.cacheStorgae.setItem(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.cacheStorgae.setItem(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[]},e.prototype.openOverlayer=function(e){var t=this;if(openOverlayer(),e)var r=setTimeout((function(){t.closeOverlayer(),clearTimeout(r)}),e)},e.prototype.closeOverlayer=function(){closeOverlayer()},e.prototype.fetchComplete=function(e,t){var r=this;if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var n=[];Object.keys(e).forEach((function(t){var r=e[t].vid;r&&n.push(r)})),this.versions=this.versions.filter((function(e){return n.includes(e)}));var i=e.$ab_url,o=e.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collect.destroyInstance)return;this.getVar("$ab_modification",window.location.href,(function(){loadVisual(o.val)}))}else if(i&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return n.includes(e)}));var a=i.val,s=i.vid;a&&s&&this.getVar("$ab_url",a,(function(){r.editMode||a!==window.location.href&&setTimeout((function(){if(!r.collect.destroyInstance){var e=""+a;e=-1===e.indexOf("http")?"https://"+e:e,parseURL(e).host!==location.host&&(e=e+"&vid="+s),window.location.href=e}}),100)}))}this.closeOverlayer(),this.updateVersions()}this.callbacks.forEach((function(e){return r[e.type===CallbackType.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]},e.prototype.fetchAB=function(e){var t=this,r=window.location.href,n=this.collect.configManager.get();this.fetch(this.fetchUrl,{header:_assign({aid:this.config.app_id},n.user||{},n.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:r})},this.config.ab_timeout||3e3,!1,(function(r){t.fetchStatus="complete",t.refreshFetchStatus;var i=r.data;"success"===r.message?(t.fetchComplete(i,n.user.user_unique_id),e&&e(i)):(t.fetchComplete(null,n.user.user_unique_id),e&&e(null)),t.collect.emit(t.types.AbComplete,i)}),(function(){t.fetchStatus="complete",t.refreshFetchStatus,t.fetchComplete(null,n.user.user_unique_id),e&&e(null),t.collect.emit(t.types.AbComplete,null)}))},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true[\0-ÿ]*":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true[\0-ÿ]*");var r=new RegExp(t,"g");e=e.replace(r,"")}catch(n){}return e},e}(),Et=function(){function e(){}return e.prototype.apply=function(e,t){var r=this,n=e.adapters.fetch;if(t.event_verify_url)if("string"==typeof t.event_verify_url){if(this.url=t.event_verify_url+"/v1/list_test",this.url){var i=e.Types;e.on(i.SubmitBefore,(function(e){n(r.url,e,3e4)}))}}else console.log("please use correct et_test url")},e}(),Alive=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,isObject$h(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration))}return e.prototype.setParams=function(e,t,r){this.set_path=e,this.set_url=r,this.set_title=t},e.prototype.enable=function(e,t,r){this.url_path=e,this.url=r,this.title=t,this.disableCallback=this.enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype.sendEvent=function(e){void 0===e&&(e=!1);var t=e?this.aliveDTime:Date.now()-this.sessionStartTime;t<0||Date.now()-this.pageStartTime>this.maxDuration||(this.collect.beconEvent(this.options.aliveName,_assign({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:t,is_support_visibility_change:isSupVisChange(),startTime:this.sessionStartTime},this.options.params)),this.sessionStartTime=Date.now())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval((function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!0)}),1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent()):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent()},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),r=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),beforePageUnload(r),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",r),window.removeEventListener("pagehide",r)}},e}(),Close=function(){function e(e,t){var r=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?r.activeEndTime=Date.now():"visible"===document.visibilityState&&(r.activeEndTime&&(r.totalTime+=r.activeEndTime-r.activeStartTime,r.activeTimes+=1),r.activeEndTime=void 0,r.activeStartTime=Date.now())},this.beforeunload=function(){if(r.totalTime+=(r.activeEndTime||Date.now())-r.activeStartTime,r.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:r.totalTime,page_title:document.title||location.pathname}))}catch(e){}r.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||864e5,this.pageStartTime=Date.now(),isObject$h(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.resetData()}return e.prototype.setParams=function(e,t,r){this.set_path=e,this.set_url=r,this.set_title=t},e.prototype.enable=function(e,t,r){this.url_path=e,this.url=r,this.title=t,this.disableCallback=this.enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,_assign({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:isSupVisChange()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),r=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),beforePageUnload(r),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",r),window.removeEventListener("pagehide",r)}},e}(),Stay=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new Alive(e,t),this.pageClose=new Close(e,t);var n=this.collect.Types;this.collect.on(n.ResetStay,(function(e){var t=e.url_path,n=e.title,i=e.url;r.resetStayDuration(t,n,i)})),this.collect.on(n.RouteChange,(function(e){e.init||t.disable_route_report||r.resetStayDuration()})),this.collect.on(n.SetStay,(function(e){var t=e.url_path,n=e.title,i=e.url;r.setStayParmas(t,n,i)})),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var r=this.collect.hook._hooksCache[e];if(!Object.keys(r).length)return;var n=function(e){r[e].length&&r[e].forEach((function(r){t.collect.hook.emit(e,r)}))};for(var i in r)n(i)}},e.prototype.enable=function(e,t,r){this.pageAlive.enable(e,t,r),this.pageClose.enable(e,t,r)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===r&&(r=""),this.pageAlive.setParams(e,t,r),this.pageClose.setParams(e,t,r)},e.prototype.reset=function(e,t,r){this.disable(),this.enable(e,t,r)},e.prototype.resetStayDuration=function(e,t,r){this.reset(e,t,r)},e}(),Profile=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var n=e.Types,i=e.adapters.fetch;this.fetch=i,this.cache={},this.collect.on(n.ProfileSet,(function(e){r.setProfile(e)})),this.collect.on(n.ProfileSetOnce,(function(e){r.setOnceProfile(e)})),this.collect.on(n.ProfileUnset,(function(e){r.unsetProfile(e)})),this.collect.on(n.ProfileIncrement,(function(e){r.incrementProfile(e)})),this.collect.on(n.ProfileAppend,(function(e){r.appendProfile(e)})),this.collect.on(n.ProfileClear,(function(){r.cache={}})),this.ready(n.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var r=this.collect.hook._hooksCache[e];if(!Object.keys(r).length)return;var n=function(e){r[e].length&&r[e].forEach((function(r){t.collect.hook.emit(e,r)}))};for(var i in r)n(i)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var r=[];r.push(this.collect.processEvent(e,t));var n=this.collect.eventManager.merge(r);this.fetch(this.reportUrl,n)}catch(i){}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",_assign({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",_assign({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",_assign({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",_assign({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var r in e)"string"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1)?t[r]=e[r]:console.warn("please check the value of param: "+r+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",_assign({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach((function(r){t.cache[r]={val:t.clone(e[r]),timestamp:Date.now()}}))},e.prototype.formatParams=function(e,t){var r=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var n={};for(var i in e)"string"==typeof e[i]||"number"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?n[i]=e[i]:console.warn("please check the value of params:"+i+", must be string,number,Array !!!");var o=Object.keys(n);if(!o.length)return;var a=Date.now();return o.filter((function(n){var i=r.cache[n];return t?!i:!(i&&r.compare(i.val,e[n])&&a-i.timestamp<r.duration)})).reduce((function(e,t){return e[t]=n[t],e}),{})}catch(s){console.log("error")}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(r){return!1}},e.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return e}},e.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),HeartBeat=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=selfAdjust((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var r=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var n=this.collect.Types;this.collect.on(n.SessionReset,(function(){r.process()}))}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),SDK_USE_TYPE="npm",Monitor=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;if(this.collect=e,this.config=t,!this.config.channel_domain){var n=e.adapters.fetch;if(this.fetch=n,!t.disable_track_event&&!t.disable_sdk_monitor){this.url=e.configManager.getUrl("event");var i=this.collect.Types;this.collect.on(i.Ready,(function(){r.sdkOnload()})),this.collect.on(i.SubmitError,(function(e){var t=e.eventData,n=e.errorCode;r.sdkError(t,n)}))}}},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),r=t.header,n=t.user,i=r.app_id,o=r.app_name,a=r.sdk_version,s=n.web_id,u={events:[{event:"onload",params:JSON.stringify({app_id:i,app_name:o||"",sdk_version:a,sdk_type:SDK_USE_TYPE,sdk_config:this.config,sdk_desc:"TOC"}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout((function(){e.fetch(e.url,[u],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(c){}},e.prototype.sdkError=function(e,t){var r=this;try{var n=e[0],i=n.user,o=n.header,a=[];e.forEach((function(e){e.events.forEach((function(e){a.push(e)}))}));var s={events:a.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:o.app_id,app_name:o.app_name||"",error_event:e.event,sdk_version:o.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(o),user:JSON.stringify(i)}),local_time_ms:Date.now()}})),user:{user_unique_id:i.user_unique_id},header:{}};setTimeout((function(){r.fetch(r.url,[s],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(u){}},e}();function isNeedElement(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function getContainer(e){for(var t=e;t&&!isNeedElement(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function getNodeText(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}function getText(e){var t=getContainer(e),r=[];return function e(t){var n=getNodeText(t);if(n&&-1===r.indexOf(n)&&r.push(n),t.childNodes.length>0)for(var i=t.childNodes,o=0;o<i.length;o++)8!==i[o].nodeType&&e(i[o])}(t),r}function getTextSingle(e){var t=getContainer(e),r="";return function e(t){var n=getNodeText(t);if(n&&(r+=n),t.childNodes.length>0)for(var i=t.childNodes,o=0;o<i.length;o++)3===i[o].nodeType&&e(i[o])}(t),r}function ignore(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}var elementLevel=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0},isSVG=function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,r=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,r=!0):t=t.parentElement;return r};function isTrack(e,t){if(1!==e.nodeType)return!1;if(!t.svg&&isSVG(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var r=e;return!("none"===r.style.display||!isNeedElement(r,"container")&&!elementLevel(r))}var Listener=function(){function e(e,t,r){var n=this;this.clickEvent=function(e){isTrack(e.target,n.options)&&n.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){n.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){n.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&n.eventHandel({eventType:"dom",eventName:"beat"},_assign({beat_type:0},e)),n.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=r.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat,this.statistics=!1}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&this.collect.on("route-change",(function(e){var r=e.config,n=e.name;t.getPageViewEvent(r,n)})),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var r=0,n=null;window.addEventListener("scroll",(function(){clearTimeout(n),n=setTimeout(i,500),r=document.documentElement.scrollTop||document.body.scrollTop}));var i=function(){(document.documentElement.scrollTop||document.body.scrollTop)==r&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(a){}try{var o=window.performance&&window.performance.getEntriesByType("paint");o&&o.length?(new PerformanceObserver((function(e){var r=e.getEntries(),n=r[r.length-1],i=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(i),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]}),setTimeout((function(){t.statistics||(t.getPageLoadEvent(o[0].startTime||0),t.statistics=!0)}),2e3)):this.getPageLoadEvent(0)}catch(a){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t=this;try{var r;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(r=setInterval((function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),beforePageUnload((function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(r)}))}catch(n){}},e}(),defaultConfig$1={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Config=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function getPositionData(e){if(e){var t=e.getBoundingClientRect(),r=t.width,n=t.height;return{left:t.left,top:t.top,element_width:r,element_height:n}}}function getEventData(e,t){void 0===e&&(e={}),void 0===t&&(t={});var r=e.clientX,n=e.clientY,i=t.left,o=t.top,a=r-i>=0?r-i:0,s=n-o>=0?n-o:0;return{touch_x:Math.floor(a),touch_y:Math.floor(s)}}function getXpath(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var r=[],n=[];return t.forEach((function(e){var t=getXpathIndex(e),i=t.str,o=t.index;r.unshift(i),n.unshift(o)})),{element_path:"/"+r.join("/"),positions:n}}function getXpathIndex(e){if(null===e)return{str:"",index:0};var t=0,r=e.parentElement;if(r)for(var n=r.children,i=0;i<n.length&&n[i]!==e;i++)n[i].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),isNeedElement(e,"list")?"[]":""].join(""),index:t}}function getElementData(e,t,r){var n={element_path:"",positions:[],texts:[]},i=getPositionData(t),o=getEventData(e,i),a=i.element_width,s=i.element_height,u=o.touch_x,c=o.touch_y,l=getXpath(t),d=l.element_path,f=l.positions,h=getText(t),p=window.performance.timing.navigationStart,g=Date.now()-p,y=f.map((function(e){return""+e})),v=null;window.TEAVisualEditor.getOriginXpath&&(v=window.TEAVisualEditor.getOriginXpath({xpath:d,positions:y})),n.element_path=v&&v.xpath||d,n.positions=v&&v.positions||y,r&&!r.text&&(n.texts=h,n.element_title=getTextSingle(t)),n.element_id=t.getAttribute("id")||"",n.element_class_name=t.getAttribute("class")||"",n.element_type=t.nodeType,n.element_width=Math.floor(a),n.element_height=Math.floor(s),n.touch_x=u,n.touch_y=c,n.page_manual_key="",n.elememt_manual_key="",n.since_page_start_ms=g,n.page_start_ms=p,n.page_path=location.pathname,n.page_host=location.host;var m=getContainer(t);return"A"===m.tagName&&(n.href=m.getAttribute("href")),"IMG"===t.tagName&&(n.src=t.getAttribute("src")),n}function getEventData$1(e,t,r,n){return _assign({event:e},getElementData(t,r,n),{is_html:1,page_key:window.location.href,page_title:document.title})}function getExtraEventData(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(r){return{}}}var EventHandle=function(){function e(e,t){this.ignore={text:!0},this.initConfig=e,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"},t&&!0===t.text&&(this.ignore.text=!1)}return e.prototype.handleEvent=function(e,t){try{if(ignore(e.target))return null;var r="bav2b_click";switch(t){case"click":return getEventData$1(r=this.eventName.click,e,e.target,this.ignore);case"change":return _assign({},getEventData$1(r="bav2b_change",e,e.target),getExtraEventData(r,e.target));case"submit":return getEventData$1(r="bav2b_submit",e,e.target)}}catch(n){return console.error(n),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var r=JSON.parse(t);e.refer_page_duration_ms=r?r.duration:"",e.refer_page_title=r?r.page_title:""}else e.refer_page_duration_ms="",e.refer_page_title="";e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(n){console.log("page event error "+JSON.stringify(n))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var r=e.lcp,n=window.performance.timing,i=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(r||(i>0?i:0)),t.page_start_ms=n.navigationStart}catch(o){console.log("page_statistics event error "+JSON.stringify(o))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(t){console.log("beat event error "+JSON.stringify(t))}return e},e}(),Request=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var r=e.eventSend,n=t.event;delete t.event,r&&"becon"===r?this.collect.beconEvent(n,t):this.collect.event(n,t)},e.prototype.get=function(e,t){var r=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,r)},e.prototype.post=function(e,t){var r=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,r)},e}(),COOKIE_KEY="_TEA_VE_OPEN",COOKIE_KEY_HOST="_TEA_VE_APIHOST",COOKIE_LANG="lang",COOKIE_EDIT_VERISON="_VISUAL_EDITOR_V",COOKIE_EDIT_URL="_VISUAL_EDITOR_U";function checkSession(){return"1"===js_cookie.get(COOKIE_KEY)}function checkSessionHost(){var e=js_cookie.get(COOKIE_KEY_HOST);try{e=JSON.parse(e)}catch(t){}return e}function checkEditUrl(){return js_cookie.get(COOKIE_EDIT_URL)}function setSession(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||js_cookie.get(COOKIE_LANG),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||js_cookie.get(COOKIE_KEY_HOST),r=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||js_cookie.get(COOKIE_EDIT_VERISON),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||js_cookie.get(COOKIE_EDIT_URL),i=+new Date,o=new Date(i+18e5);js_cookie.set(COOKIE_KEY,"1",{expires:o}),js_cookie.set(COOKIE_KEY_HOST,t,{expires:o}),js_cookie.set(COOKIE_EDIT_URL,n,{expires:o}),js_cookie.set(COOKIE_LANG,e,{expires:o}),js_cookie.set(COOKIE_EDIT_VERISON,r||"",{expires:o})}catch(a){console.log("set cookie err")}}var isLoaded$1=!1;function loadEditorScript$1(e){var t=e.event,r=e.editorUrl,n=e.autoTrackInstance;isLoaded$1||(isLoaded$1=!0,loadScript(r,(function(){dispatchMsg(t,"editorScriptloadSuccess"),n.destroy()}),(function(){t&&dispatchMsg(t,"editorScriptloadError"),isLoaded$1=!1})))}function readyToLoadEditor$1(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{};var r="",n=VISUAL_EDITOR_RANGERS+"?query="+Date.now();window.TEAVisualEditor.appId=t.app_id;var i=t.channel_domain,o="";if(addAllowdOrigin(["*"]),i){var a,s="";try{var u=window.performance.getEntriesByType("resource");if(u&&u.length&&(u.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)})),s||document.currentScript&&(s=document.currentScript.src),s&&(a=s.split("/"))&&a.length)){o="https:/";for(var c=2;c<a.length&&c!==a.length-1;c++)o=o+"/"+a[c];if(o&&o.indexOf("/5.0")){var l=o.split("/5.0");o=l[0]||o}}}catch(h){}}if(init(t,SDK_VERSION),checkSession()){var d=checkSessionHost(),f="";d&&(window.TEAVisualEditor.__editor_ajax_domain=d,f=checkEditUrl()),loadEditorScript$1({event:null,editorUrl:f||n,autoTrackInstance:e}),setSession()}else try{receiveMsg("tea:openVisualEditor",(function(t){var a=t.data;if("string"==typeof t.data)try{a=JSON.parse(t.data)}catch(h){a=void 0}if(a){var s=a.referrer,u=a.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),r=n,i){var c=a.version;r=o?o+(c?"/visual-editor-rangers-v"+c:"/visual-editor-rangers-v1.0.0")+".js":n,window.TEAVisualEditor.__editor_verison=c}window.TEAVisualEditor.__editor_url=r,window.TEAVisualEditor.lang=u,loadEditorScript$1({event:t,editorUrl:r,autoTrackInstance:e}),setSession()}})),window.TEAVisualEditor.openAutotrackEditor=function(){loadEditorScript$1({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(h){console.log("receive message error")}try{receiveMsg("tea:openHeatMapCore",(function(t){loadEditorScript$1({event:t,editorUrl:HOT_PIC_URL+".js?query="+Date.now(),autoTrackInstance:e})}))}catch(h){console.log("openHeatMapCore error")}}var defaultOpt={hashTag:!1,impr:!1},AutoTrack=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var r=e.Types;this.ready(r.Autotrack),this.collect.emit(r.AutotrackReady)}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t="object"==_typeof$3(t)?t:{},t=Object.assign(defaultOpt,t),this.destroyed=!1,this.options=t,this.Config=new Config(defaultConfig$1),this.Listener=new Listener(t,this.collect,this.Config),this.EventHandle=new EventHandle(this.config,t),this.Request=new Request(this.collect),this.autoTrackStart=!0,this.init(),readyToLoadEditor$1(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var r=e.eventName;if("click"===r||"change"===r||"submit"===r){var n=this.EventHandle.handleEvent(t,r);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+r+"_event",extra:{methods:"GET"}},n)}else if("page_view"===r||"page_statistics"===r){var i;i="page_view"===r?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},i)}else if("beat"===r){var o=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},o)}}catch(s){console.log("handel dom event error "+JSON.stringify(s))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}(),State$1;!function(e){e.Net="net",e.FailNet="f_net",e.FailData="f_data"}(State$1||(State$1={}));var EventList={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Tracer=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;if(this.ready=t.app_id&&t.enable_tracer&&!t.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var n=this.collect.Types,i=e.adapters.fetch;this.fetch=i,this.collect.on(n.Event,(function(){r.addCount("log")})),this.collect.on(n.SubmitError,(function(e){var t=e.type,n=e.eventDate,i=e.errorCode,o=e.response;r.addErrorCount(n,t,i,o)})),this.listener(),this.collect.emit(n.TracerReady)}},e.prototype.addCount=function(e,t,r){void 0===t&&(t="net"),void 0===r&&(r=1);try{this.tracerCache||(this.tracerCache=new Map);var n=void 0;if(this.tracerCache.has(e))(i=this.tracerCache.get(e)).has(t)?(n=i.get(t).params.count,n++,i.set(t,this.processTracer(n,e,t))):(n=r,i.set(t,this.processTracer(r,e,t)));else{var i=new Map;n=r,i.set(t,this.processTracer(r,e,t)),this.tracerCache.set(e,i)}"net"===t&&n>=this.limit[e]&&this.report(!1)}catch(o){console.log(o)}},e.prototype.addErrorCount=function(e,t,r,n){var i=this;try{if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(n&&n.hasOwnProperty("sc")?this.addCount("log",t,o.length-n.sc):this.addCount("log",t,o.length),this.errorCode[t]=r):o.forEach((function(e){var n="log";for(var o in EventList)if(-1!==EventList[o].indexOf(e.event)){n=o;break}i.addCount(n,t,1),i.errorCode[t]=r})))}}catch(a){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach((function(e){console.log(e),e.forEach((function(e){t.push(e)}))})),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var r=this.collect.eventManager.merge(e);t&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(r)):this.fetch(this.reportUrl,r),this.tracerCache=null}catch(n){}},e.prototype.processTracer=function(e,t,r){var n={count:e,state:r,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:SDK_VERSION};"f_net"!==r&&"f_data"!==r||(n.errorCode=this.errorCode[r]);var i=this.collect.processEvent("applog_trace",n);if(i&&i.event)return delete i.is_bav,i},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.leavePage()})),beforePageUnload((function(){e.leavePage()}))},e.prototype.leavePage=function(){this.report(!0)},e}(),dayjs_min=createCommonjsModule((function(e,t){e.exports=function(){var e="millisecond",t="second",r="minute",n="hour",i="day",o="week",a="month",s="quarter",u="year",c="date",l="Invalid Date",d=/^(\d{4})[-\/]?(\d{1,2})?[-\/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},g={s:p,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+p(n,2,"0")+":"+p(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,a),o=r-i<0,s=t.clone().add(n+(o?-1:1),a);return+(-(n+(r-i)/(o?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:a,y:u,w:o,d:i,D:c,h:n,m:r,s:t,ms:e,Q:s}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",v={};v[y]=h;var m=function(e){return e instanceof E},_=function(e,t,r){var n;if(!e)return y;if("string"==typeof e)v[e]&&(n=e),t&&(v[e]=t,n=e);else{var i=e.name;v[i]=e,n=i}return!r&&n&&(y=n),n||!r&&y},b=function(e,t){if(m(e))return e.clone();var r="object"==_typeof$3(t)?t:{};return r.date=e,r.args=arguments,new E(r)},A=g;A.l=_,A.i=m,A.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function h(e){this.$L=_(e.locale,null,!0),this.parse(e)}var p=h.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(A.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(d);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return A},p.isValid=function(){return!(this.$d.toString()===l)},p.isSame=function(e,t){var r=b(e);return this.startOf(t)<=r&&r<=this.endOf(t)},p.isAfter=function(e,t){return b(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<b(e)},p.$g=function(e,t,r){return A.u(e)?this[t]:this.set(r,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,s){var l=this,d=!!A.u(s)||s,f=A.p(e),h=function(e,t){var r=A.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return d?r:r.endOf(i)},p=function(e,t){return A.w(l.toDate()[e].apply(l.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},g=this.$W,y=this.$M,v=this.$D,m="set"+(this.$u?"UTC":"");switch(f){case u:return d?h(1,0):h(31,11);case a:return d?h(1,y):h(0,y+1);case o:var _=this.$locale().weekStart||0,b=(g<_?g+7:g)-_;return h(d?v-b:v+(6-b),y);case i:case c:return p(m+"Hours",0);case n:return p(m+"Minutes",1);case r:return p(m+"Seconds",2);case t:return p(m+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(o,s){var l,d=A.p(o),f="set"+(this.$u?"UTC":""),h=(l={},l[i]=f+"Date",l[c]=f+"Date",l[a]=f+"Month",l[u]=f+"FullYear",l[n]=f+"Hours",l[r]=f+"Minutes",l[t]=f+"Seconds",l[e]=f+"Milliseconds",l)[d],p=d===i?this.$D+(s-this.$W):s;if(d===a||d===u){var g=this.clone().set(c,1);g.$d[h](p),g.init(),this.$d=g.set(c,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[A.p(e)]()},p.add=function(e,s){var c,l=this;e=Number(e);var d=A.p(s),f=function(t){var r=b(l);return A.w(r.date(r.date()+Math.round(t*e)),l)};if(d===a)return this.set(a,this.$M+e);if(d===u)return this.set(u,this.$y+e);if(d===i)return f(1);if(d===o)return f(7);var h=(c={},c[r]=6e4,c[n]=36e5,c[t]=1e3,c)[d]||1,p=this.$d.getTime()+e*h;return A.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||l;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=A.z(this),o=this.$H,a=this.$m,s=this.$M,u=r.weekdays,c=r.months,d=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].substr(0,o)},h=function(e){return A.s(o%12||12,e,"0")},p=r.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:A.s(s+1,2,"0"),MMM:d(r.monthsShort,s,c,3),MMMM:d(c,s),D:this.$D,DD:A.s(this.$D,2,"0"),d:String(this.$W),dd:d(r.weekdaysMin,this.$W,u,2),ddd:d(r.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(o),HH:A.s(o,2,"0"),h:h(1),hh:h(2),a:p(o,a,!0),A:p(o,a,!1),m:String(a),mm:A.s(a,2,"0"),s:String(this.$s),ss:A.s(this.$s,2,"0"),SSS:A.s(this.$ms,3,"0"),Z:i};return n.replace(f,(function(e,t){return t||g[e]||i.replace(":","")}))},p.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},p.diff=function(e,c,l){var d,f=A.p(c),h=b(e),p=6e4*(h.utcOffset()-this.utcOffset()),g=this-h,y=A.m(this,h);return y=(d={},d[u]=y/12,d[a]=y,d[s]=y/3,d[o]=(g-p)/6048e5,d[i]=(g-p)/864e5,d[n]=g/36e5,d[r]=g/6e4,d[t]=g/1e3,d)[f]||g,l?y:A.a(y)},p.daysInMonth=function(){return this.endOf(a).$D},p.$locale=function(){return v[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=_(e,t,!0);return n&&(r.$L=n),r},p.clone=function(){return A.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},h}(),S=E.prototype;return b.prototype=S,[["$ms",e],["$s",t],["$m",r],["$H",n],["$W",i],["$M",a],["$y",u],["$D",c]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),b.extend=function(e,t){return e.$i||(e(t,E,b),e.$i=!0),b},b.locale=_,b.isDayjs=m,b.unix=function(e){return b(1e3*e)},b.en=v[y],b.Ls=v,b.p={},b}()})),duration=createCommonjsModule((function(e,t){var r,n,i,o,a,s,u,c,l,d,f,h,p,g,y,v,m;e.exports=(a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:s=31536e6,months:u=2592e6,days:o=864e5,hours:i=36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},d=function(e){return e instanceof m},f=function(e,t,r){return new m(e,r,t.$l)},h=function(e){return n.p(e)+"s"},p=function(e){return e<0},g=function(e){return p(e)?Math.ceil(e):Math.floor(e)},y=function(e){return Math.abs(e)},v=function(e,t){return e?p(e)?{negative:!0,format:""+y(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},m=function(){function e(e,t,r){var n=this;if(this.$d={},this.$l=r,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return f(e*l[h(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==_typeof$3(e))return Object.keys(e).forEach((function(t){n.$d[h(t)]=e[t]})),this.calMilliseconds(),this;if("string"==typeof e){var i=e.match(c);if(i){var o=i.slice(2).map((function(e){return Number(e)}));return this.$d.years=o[0],this.$d.months=o[1],this.$d.weeks=o[2],this.$d.days=o[3],this.$d.hours=o[4],this.$d.minutes=o[5],this.$d.seconds=o[6],this.calMilliseconds(),this}}return this}var t=e.prototype;return t.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce((function(t,r){return t+(e.$d[r]||0)*l[r]}),0)},t.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=g(e/s),e%=s,this.$d.months=g(e/u),e%=u,this.$d.days=g(e/o),e%=o,this.$d.hours=g(e/i),e%=i,this.$d.minutes=g(e/6e4),e%=6e4,this.$d.seconds=g(e/1e3),e%=1e3,this.$d.milliseconds=e},t.toISOString=function(){var e=v(this.$d.years,"Y"),t=v(this.$d.months,"M"),r=+this.$d.days||0;this.$d.weeks&&(r+=7*this.$d.weeks);var n=v(r,"D"),i=v(this.$d.hours,"H"),o=v(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3);var s=v(a,"S"),u=e.negative||t.negative||n.negative||i.negative||o.negative||s.negative,c=i.format||o.format||s.format?"T":"",l=(u?"-":"")+"P"+e.format+t.format+n.format+c+i.format+o.format+s.format;return"P"===l||"-P"===l?"P0D":l},t.toJSON=function(){return this.toISOString()},t.format=function(e){var t=e||"YYYY-MM-DDTHH:mm:ss",r={Y:this.$d.years,YY:n.s(this.$d.years,2,"0"),YYYY:n.s(this.$d.years,4,"0"),M:this.$d.months,MM:n.s(this.$d.months,2,"0"),D:this.$d.days,DD:n.s(this.$d.days,2,"0"),H:this.$d.hours,HH:n.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:n.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:n.s(this.$d.seconds,2,"0"),SSS:n.s(this.$d.milliseconds,3,"0")};return t.replace(a,(function(e,t){return t||String(r[e])}))},t.as=function(e){return this.$ms/l[h(e)]},t.get=function(e){var t=this.$ms,r=h(e);return"milliseconds"===r?t%=1e3:t="weeks"===r?g(t/l[r]):this.$d[r],0===t?0:t},t.add=function(e,t,r){var n;return n=t?e*l[h(t)]:d(e)?e.$ms:f(e,this).$ms,f(this.$ms+n*(r?-1:1),this)},t.subtract=function(e,t){return this.add(e,t,!0)},t.locale=function(e){var t=this.clone();return t.$l=e,t},t.clone=function(){return f(this.$ms,this)},t.humanize=function(e){return r().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},t.milliseconds=function(){return this.get("milliseconds")},t.asMilliseconds=function(){return this.as("milliseconds")},t.seconds=function(){return this.get("seconds")},t.asSeconds=function(){return this.as("seconds")},t.minutes=function(){return this.get("minutes")},t.asMinutes=function(){return this.as("minutes")},t.hours=function(){return this.get("hours")},t.asHours=function(){return this.as("hours")},t.days=function(){return this.get("days")},t.asDays=function(){return this.as("days")},t.weeks=function(){return this.get("weeks")},t.asWeeks=function(){return this.as("weeks")},t.months=function(){return this.get("months")},t.asMonths=function(){return this.as("months")},t.years=function(){return this.get("years")},t.asYears=function(){return this.as("years")},e}(),function(e,t,i){r=i,n=i().$utils(),i.duration=function(e,t){var r=i.locale();return f(e,{$l:r},t)},i.isDuration=d;var o=t.prototype.add,a=t.prototype.subtract;t.prototype.add=function(e,t){return d(e)&&(e=e.asMilliseconds()),o.bind(this)(e,t)},t.prototype.subtract=function(e,t){return d(e)&&(e=e.asMilliseconds()),a.bind(this)(e,t)}})}));dayjs_min.extend(duration);var ignoreList=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],moreOP=["and","or","not"],CepRule=function(){function CepRule(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return CepRule.prototype.apply=function(e,t){var r=this;if(this.collect=e,this.config=t,this.config.cep){var n=e.adapters,i=n.fetch,o=n.storage,a=e.Types;this.types=a,this.storage=new o(!1),this.fetch=i,this.configManager=e.configManager,this.url=t.cep_url?""+t.cep_url:e.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=e.configManager.getUrl("event"),this.key="__tea_cep_plan_"+t.app_id,this.quotasKey="__tea_cep_plan_quotas_"+t.app_id,this.isWait=!1,this.eventCache=[],this.test=e.configManager.staging,this.collect.on(a.SubmitAfter,(function(e){r.matchEvent(e)})),this.init()}},CepRule.prototype.init=function(){var e=this,t=!0,r=0,n=0,i=0,o=!1,a=this.storage.getItem(this.key)||{};if(a&&Object.keys(a).length&&(o=!0,r=a.last_update_time,n=a.fetch_interval,i=a.config_version||0,t=Date.now()-r>1e3*n),t){var s=this.configManager.get(),u=s.header,c=s.user;this.fetch(this.url,{header:u,user:c,local_time:Date.now(),config_version:i},1e4,!1,(function(t){t&&0===t.code?(a.fetch_interval=t.fetch_interval,a.data=t.data,a.last_update_time=Date.now(),a.config_version=t.config_version,e.clearQuotas(),e.initState(t.data),e.storage.setItem(e.key,a),t.data.forEach((function(t){e.event("__cep_sdk_onboard",t.plan_id)}))):304!==t.code&&400!==t.code||!o?console.log("code: "+t.code+", request error，please try leater"):(console.log("code: "+t.code+", use old rules~"),a.last_update_time=Date.now(),e.storage.setItem(e.key,a),e.initState(a.data))}),(function(){o?(e.planData=a.data,e.initState(a.data)):(e.support=!1,console.log("request error，please try leater"))}))}else a.last_update_time=Date.now(),this.storage.setItem(this.key,a),console.log("rule still work, use cache"),this.initState(a.data)},CepRule.prototype.initState=function(e){var t=this;e&&e.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=e,e.forEach((function(e){var r=new Map;if(e.pattern&&e.pattern.events){var n=1===e.pattern.events.length;e.pattern.events.forEach((function(e){r.set(e.id,{id:e.id,isMatch:!1,event:null,after:e.after||null,connection:e.connection||null,window:e.window||null,matchTime:0,initTime:Date.now(),singleRule:n})})),t.stateArray.set(e.plan_id,{patternState:r,singleRule:n,pattern:{aid:e.aid,biz_id:e.biz_id,end_time:e.end_time,start_time:e.start_time,web_sdk_version:e.web_sdk_version,stage:e.stage},quotas:e.quotas})}})),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},CepRule.prototype.check=function(e){var t=Date.now();return Date.now()>1e3*e.end_time?(console.log("event rules:"+e.plan_id+" is over"),!1):t<1e3*e.start_time||t>1e3*e.end_time?(console.log("rule:"+e.plan_id+" time error"),!1):(this.staing="testing"===e.staing,!(SDK_VERSION<e.web_sdk_version&&(this.support=!1,console.log("you sdk version is old，please update to "+e.web_sdk_version+" at least"),1)))},CepRule.prototype.dealCache=function(){var e=this;if(this.eventCache.length){var t=1;this.eventCache.forEach((function(r){e.matchEvent(r),t++})),t===this.eventCache.length&&(this.eventCache=[])}},CepRule.prototype.matchEvent=function(e){if(this.support&&(!this.staing||this.test)&&e&&e.length)try{if(!this.cepReady)return void this.eventCache.push(e);var t=e[0],r=t.header,n=t.user,i=t.events;i.length&&i.reverse();for(var o=0;o<i.length;o++){var a=i[o].event;if(-1!==ignoreList.indexOf(a))return!1;this.matchRule(r,n,i[o])}}catch(s){return void console.log(s.message)}},CepRule.prototype.matchRule=function(e,t,r){try{for(var n=0;n<this.planData.length;n++){var i=this.planData[n],o=i.plan_id;if(this.check(i)&&this.checkQuotas(o)&&i.pattern&&i.pattern.events)for(var a=i.pattern.events,s=0;s<a.length;s++)if(this.rule(e,t,r,a[s].condition)){var u=this.stateArray.get(o).patternState,c=u.get(a[s].id);if(this.stateArray.get(o).singleRule){this.changeStatus(o,a[s].id,r),this.publish([r],o,a[s].id);break}if(!c.isMatch){c.after&&u.get(c.after).isMatch?this.changeStatus(o,a[s].id,r):c.after||this.changeStatus(o,a[s].id,r);break}}}this.statusCheck()}catch(l){return void console.log(l.message)}},CepRule.prototype.changeStatus=function(e,t,r){var n=this.stateArray.get(e),i=n.patternState.get(t);i.isMatch=!0,i.event=r,i.matchTime=r.local_time_ms||Date.now(),n.patternState.set(t,i),this.stateArray.set(e,n)},CepRule.prototype.statusCheck=function(){var e,t,r,n;try{for(var i=__values(this.stateArray),o=i.next();!o.done;o=i.next()){var a=__read(o.value,2),s=a[0],u=a[1],c=u.patternState;if(u.isSingle)break;try{for(var l=__values(c),d=l.next();!d.done;d=l.next()){var f=__read(d.value,2),h=f[0],p=f[1];if(p.after&&(!p.after||c.get(p.after).isMatch)){if("NOT_FOLLOWED_BY"===p.connection){p.isMatch?this.reset(s,h):Date.now()-c.get(p.after).matchTime>p.window?this.publish([c.get(p.after).event,p.event],s,h):this.startWait(s,h,p);break}p.isMatch?p.matchTime-c.get(p.after).matchTime<=p.window?this.publish([c.get(p.after).event,p.event],s,h):this.reset(s,h):Date.now()-c.get(p.after).matchTime>p.window?this.reset(s,h):this.startWait(s,h,p);break}}}catch(g){r={error:g}}finally{try{d&&!d.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(y){e={error:y}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},CepRule.prototype.startWait=function(e,t,r){var n=this;try{this.waitArray.get(e)||this.waitArray.set(e,new Map);var i=this.waitArray.get(e);if(!i.get(t)){var o=setTimeout((function(){var i=n.stateArray.get(e).patternState,o=i.get(t);if("NOT_FOLLOWED_BY"===o.connection)!o.isMatch&&i.get(o.after).isMatch||o.matchTime-i.get(o.after).matchTime>r.window?((a=n.waitArray.get(e).get(t)).triggerWait=!0,n.waitArray.set(e,n.waitArray.get(e).set(t,a)),n.publish([i.get(o.after).event],e,t)):n.reset(e,t);else if("FOLLOWED_BY"===o.connection){var a;o.isMatch&&i.get(o.after).isMatch?((a=n.waitArray.get(e).get(t)).triggerWait=!0,n.waitArray.set(e,n.waitArray.get(e).set(t,a)),n.publish([i.get(o.after).event],e,t)):n.reset(e,t)}}),r.window);i.set(t,{waitFn:o,triggerWait:!1}),this.waitArray.set(e,i)}}catch(a){console.log(a.message,a.stack)}},CepRule.prototype.rule=function(e,t,r,n){var i=this;try{var o=r.event,a=r.params;if(a=JSON.parse(a),-1!==moreOP.indexOf(n.op)){if(n.conditions&&n.conditions.length){var s=n.conditions,u=0,c=new Map;c.set(u,{op:n.op,result:void 0,resultList:[],resultKey:[],resultLength:s.length}),function r(n,s){for(var l=0;l<n.length;l++)if(u++,-1!==moreOP.indexOf(n[l].op)&&n[l].hasOwnProperty("conditions"))c.set(u,{op:n[l].op,result:void 0,fatherKey:s,resultList:[],resultKey:[],resultLength:n[l].conditions.length}),r(n[l].conditions,u);else{var d=i.scope(n[l].key),f=d.scope,h=d.key,p=d.key2,g=f?"header"===f?p?JSON.parse(e[p])[h]:e[h]:"user"===f?t[h]:a[h]:o,y=i.calculate(n[l].op,g,n[l].value);c.set(u,{op:n[l].op,result:y,fatherKey:s})}}(s,u);for(var l=c.get(0);void 0===l.result||l.resultList.length<l.resultLength;)c.forEach((function(e,t){if(void 0!==e.result&&void 0!==e.fatherKey){var r=c.get(e.fatherKey);r.resultList.length<r.resultLength&&-1===r.resultKey.indexOf(t)&&(r.resultKey.push(t),r.resultList.push(e.result),c.set(e.fatherKey,r))}})),c.forEach((function(e){e.resultList&&e.resultList.length===e.resultLength&&("and"===e.op&&(e.result=-1===e.resultList.indexOf(!1)),"or"===e.op&&(e.result=-1!==e.resultList.indexOf(!0)))}));return c.get(0).result}return!1}var d=this.scope(n.key),f=d.scope,h=d.key,p=d.key2,g=f?"header"===f?p?JSON.parse(e[p])[h]:e[h]:"user"===f?t[h]:a[h]:o;return this.calculate(n.op,g,n.value)}catch(y){return console.log(y.message),!1}},CepRule.prototype.publish=function(e,t,r){try{var n=this.configManager.get().user,i={biz_id:this.stateArray.get(t).pattern.biz_id,plan_id:t,uid:n.user_id||"",did:n.device_id||"",uuid:n.user_unique_id,events:e,extra:{url:window.location.href}};this.collect.emit("__cep_match",i),(window.opener||window.parent).postMessage({type:"__cep_match",data:i},"*"),this.event("__cep_trigger_sdk",t),this.addQuotas(t),this.reset(t,r),console.log(this.stateArray)}catch(o){return void console.log(o.message)}},CepRule.prototype.addQuotas=function(e){var t=this.stateArray.get(e).quotas;if(t&&t.length){var r=this.storage.getItem(this.quotasKey)||{};r[e]||(r[e]={value:0,lastTime:Date.now()});var n=r[e].value;0===n&&(r[e].lastTime=Date.now()),r[e].value=n+1,this.storage.setItem(this.quotasKey,r)}},CepRule.prototype.checkQuotas=function(e){var t=this.stateArray.get(e).quotas,r=this.storage.getItem(this.quotasKey)||{};if(r[e]||(r[e]={value:0,lastTime:Date.now()}),t&&t.length){var n=t[0].granularity,i=t[0].value;if("per_keyid"!==t[0].type)return!0;var o=this.release(n);return"all"===o?!(r[e].value>=i&&(console.log("plan:"+e+" limit"),1)):Date.now()-r[e].lastTime>=o?(r[e].value=0,r[e].lastTime=Date.now(),this.storage.setItem(this.quotasKey,r),!0):!(r[e].value>=i&&(console.log("plan:"+e+" limit"),1))}return!0},CepRule.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},CepRule.prototype.release=function(e){if("all"===e)return e;var t=dayjs_min.duration(e);return t?t.asMilliseconds():"all"},CepRule.prototype.reset=function(e,t){var r=this.stateArray.get(e);if(r.singleRule){var n=r.patternState.get(t);n.isMatch=!1,n.event=null,n.matchTime=0,n.initTime=Date.now(),r.patternState.set(t,n)}else r.patternState.forEach((function(e){e.isMatch=!1,e.event=null,e.matchTime=0,e.initTime=Date.now()}));this.stateArray.set(e,r);var i=this.waitArray.get(e);i&&i.get(t)&&(clearTimeout(i.get(t).waitFn),i.delete(t))},CepRule.prototype.event=function(e,t){try{var r={event:e,params:JSON.stringify({plan_id:t||"",biz_id:this.stateArray.get(t).pattern.biz_id}),local_time_ms:Date.now()},n=this.configManager.get(),i=n.header,o=n.user;i.custom=JSON.stringify(i.custom);var a={events:[r],user:o,header:i};this.fetch(this.reportUrl,[a])}catch(s){return void console.log(s.message)}},CepRule.prototype.scope=function(e){var t="",r="";if(e.indexOf(".")>-1){var n=e.split(".");t=n[0],e=n[1],"header"===t&&"custom"===e&&(e=n[2],r=n[1])}return{scope:t,key:e,key2:r}},CepRule.prototype.calculate=function(op,paramA,paramB){try{if("="===op)return paramA===paramB;if(-1!==["=","<",">",">=","<=","!="].indexOf(op))return eval(""+paramA+op+paramB);if(-1!==["in","contains"].indexOf(op))return-1!==paramB.indexOf(paramA);if(-1!==["is not null","is null"].indexOf(op))return"is null"===op?null==paramA:null!=paramA;if(-1!==["startswith","endswith"].indexOf(op)){if("startswith"===op)return 0===paramA.indexOf(paramB);var start=paramA.length-paramB.length,str=paramA.substr(start,paramB.length);return str===paramB}}catch(e){return console.log(e.message),!1}},CepRule}(),getLogPluginSpace=function(){return"undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null},pluginObject=getLogPluginSpace(),PluginExtend=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,r){if("sdk"===t)if(pluginExtendList.hasOwnProperty(r)){var n=pluginExtendList[r].object,i=pluginExtendList[r].src[e.channel]+"?query="+Date.now();e.exist(r,n,i)}else console.warn("your"+r+" is not exist，please check plugin name");else"object"==_typeof$3(t)&&(t.src?e.exist(r,t.call,t.src):e.process(r,t.instance,"INSTANCE"))}))}catch(t){console.log("load extend error")}},e.prototype.exist=function(e,t,r){var n=this;pluginObject[t]?this.process(e,pluginObject[t]):this.loadPlugin(e,r,(function(){n.process(e,pluginObject[t]),console.log("load "+e+" success")}),(function(){console.log("load "+e+" error")}))},e.prototype.process=function(e,t,r){try{if(r){var n=new t;n.apply&&n.apply(this.collect,this.config),console.log("excude "+e+" success")}else t&&t(this.collect,this.config)}catch(i){console.log("excude "+e+" error, message:"+i.message)}},e.prototype.loadPlugin=function(e,t,r,n){var i=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(r),o.onerror=function(){n(t)},o.onload=function(){i._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(o)}catch(a){}},e}(),Verify=function(){function e(){this.verifyReady=!1,this.waitTime=5e3,this.cleanStatus=!1}return e.prototype.apply=function(e,t){var r=this;this.collector=e,this.config=t;var n=e.adapters.storage;this.cacheStorgae=new n(!1,"session"),this.eventStorage=[],this.collector.on("submit-verify",(function(e){e&&e.length&&r.eventStore(e[0])})),this.checkCache()},e.prototype.checkCache=function(){var e=this;this.verifyCookieKey="__applog_verify_set_"+this.config.app_id,this.cacheStorgae.getCookie(this.verifyCookieKey);var t=this.cacheStorgae.getItem(this.verifyCookieKey);this.sign=t&&t.sign||"",this.origin=t&&t.origin||"*";var r=setTimeout((function(){e.cleanVerify(),clearTimeout(r),e.collector.off("submit-verify")}),this.waitTime);window.addEventListener("message",(function(t){t&&t.data&&"simulator:verify"===t.data.type&&(clearTimeout(r),e.receMessage(t))}),!0)},e.prototype.receMessage=function(e){if(!this.cleanStatus){var t=e.data;this.verifyReady=!0,this.sign=t.sign,this.origin=e.origin,this.cacheStorgae.setItem(this.verifyCookieKey,JSON.stringify({sign:t.sign,origin:e.origin})),this.eventStorage.length&&this.postVerify(this.eventStorage,t.sign,e.origin)}},e.prototype.eventStore=function(e){this.cleanStatus||(this.verifyReady?this.postVerify(e,this.sign,this.origin):this.eventStorage.push(e))},e.prototype.cleanVerify=function(){this.cleanStatus=!0,this.eventStorage=[]},e.prototype.postVerify=function(e,t,r){try{var n=[];isArray$4(e)?e.forEach((function(e){n.push(e)})):n.push(e);var i={type:"simulator:verify:event",sign:t,pageUrl:window.location.href,events:n};(window.opener||window.parent).postMessage(i,r)}catch(o){console.log("web verify post message error ~")}},e}(),RuotePage=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={}}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var r=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(r.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:location.href,refer_title:document.title||location.pathname,refer_manual_key:""},this.config.autotrack&&"object"==_typeof$3(this.config.autotrack)&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];"function"==typeof history.onpushstate&&history.onpushstate({state:r});var o=t.call.apply(t,__spread([history,r],n)),a=e.getPopStateChangeEventData();return e.lastLocation=stringify(location.href,n[1]),e.sendPv(a,"pushState"),o};var r=history.replaceState;history.replaceState=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var o=r.call.apply(r,__spread([history,t],n)),a=e.getPopStateChangeEventData();return e.lastLocation=stringify(location.href,n[1]),e.sendPv(a),o}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",(function(r){e.lastLocation!==window.location.href&&clearTimeout(t)})),window.addEventListener("popstate",(function(r){e.lastLocation!==window.location.href&&(t=setTimeout((function(){e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)}),10))}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e,t,r=this.storage.getItem(this.cache_key)||{};e=document.referrer?document.referrer:r&&r.refer_key||"";var n=this.storage.getItem("__tea_cache_first_"+this.appid);return t=!n||1!=n,{is_html:1,url:location.href,referrer:e,page_key:location.href,refer_page_key:e,page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:r&&r.refer_manual_key||"",refer_page_title:r&&r.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+t}}catch(i){return{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e}();Collector$1.usePlugin(PluginExtend,"extend"),Collector$1.usePlugin(Ab,"ab"),Collector$1.usePlugin(Stay,"stay"),Collector$1.usePlugin(AutoTrack,"autotrack"),Collector$1.usePlugin(Verify,"verify"),Collector$1.usePlugin(Et,"et"),Collector$1.usePlugin(Profile,"profile"),Collector$1.usePlugin(CepRule,"cep"),Collector$1.usePlugin(HeartBeat,"heartbeat"),Collector$1.usePlugin(Monitor,"monitor"),Collector$1.usePlugin(RuotePage,"route"),Collector$1.usePlugin(Tracer,"tracer"),new Collector$1("default");var Collector$1$1=Collector$1,check=function(e){return e&&e.Math==Math&&e},global$w=check("object"==("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))&&globalThis)||check("object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window)||check("object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self)||check("object"==_typeof$3(commonjsGlobal$1)&&commonjsGlobal$1)||function(){return this}()||Function("return this")(),objectGetOwnPropertyDescriptor={},fails$w=function(e){try{return!!e()}catch(error){return!0}},fails$v=fails$w,descriptors=!fails$v((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),fails$u=fails$w,functionBindNative=!fails$u((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),NATIVE_BIND$3=functionBindNative,call$l=Function.prototype.call,functionCall=NATIVE_BIND$3?call$l.bind(call$l):function(){return call$l.apply(call$l,arguments)},objectPropertyIsEnumerable={},$propertyIsEnumerable$1={}.propertyIsEnumerable,getOwnPropertyDescriptor$3=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$3&&!$propertyIsEnumerable$1.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(e){var t=getOwnPropertyDescriptor$3(this,e);return!!t&&t.enumerable}:$propertyIsEnumerable$1;var createPropertyDescriptor$4=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},NATIVE_BIND$2=functionBindNative,FunctionPrototype$3=Function.prototype,bind$6=FunctionPrototype$3.bind,call$k=FunctionPrototype$3.call,uncurryThis$y=NATIVE_BIND$2&&bind$6.bind(call$k,call$k),functionUncurryThis=NATIVE_BIND$2?function(e){return e&&uncurryThis$y(e)}:function(e){return e&&function(){return call$k.apply(e,arguments)}},uncurryThis$x=functionUncurryThis,toString$f=uncurryThis$x({}.toString),stringSlice$8=uncurryThis$x("".slice),classofRaw$1=function(e){return stringSlice$8(toString$f(e),8,-1)},uncurryThis$w=functionUncurryThis,fails$t=fails$w,classof$a=classofRaw$1,$Object$3=Object,split=uncurryThis$w("".split),indexedObject=fails$t((function(){return!$Object$3("z").propertyIsEnumerable(0)}))?function(e){return"String"==classof$a(e)?split(e,""):$Object$3(e)}:$Object$3,$TypeError$e=TypeError,requireObjectCoercible$8=function(e){if(null==e)throw $TypeError$e("Can't call method on "+e);return e},IndexedObject$2=indexedObject,requireObjectCoercible$7=requireObjectCoercible$8,toIndexedObject$9=function(e){return IndexedObject$2(requireObjectCoercible$7(e))},isCallable$n=function(e){return"function"==typeof e},isCallable$m=isCallable$n,isObject$g=function(e){return"object"==_typeof$3(e)?null!==e:isCallable$m(e)},global$v=global$w,isCallable$l=isCallable$n,aFunction=function(e){return isCallable$l(e)?e:void 0},getBuiltIn$b=function(e,t){return arguments.length<2?aFunction(global$v[e]):global$v[e]&&global$v[e][t]},uncurryThis$v=functionUncurryThis,objectIsPrototypeOf=uncurryThis$v({}.isPrototypeOf),getBuiltIn$a=getBuiltIn$b,engineUserAgent=getBuiltIn$a("navigator","userAgent")||"",global$u=global$w,userAgent$4=engineUserAgent,process$4=global$u.process,Deno$1=global$u.Deno,versions=process$4&&process$4.versions||Deno$1&&Deno$1.version,v8=versions&&versions.v8,match,version$1;v8&&(match=v8.split("."),version$1=match[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version$1&&userAgent$4&&(match=userAgent$4.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=userAgent$4.match(/Chrome\/(\d+)/),match&&(version$1=+match[1])));var engineV8Version=version$1,V8_VERSION$3=engineV8Version,fails$s=fails$w,nativeSymbol=!!Object.getOwnPropertySymbols&&!fails$s((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V8_VERSION$3&&V8_VERSION$3<41})),NATIVE_SYMBOL$6=nativeSymbol,useSymbolAsUid=NATIVE_SYMBOL$6&&!Symbol.sham&&"symbol"==_typeof$3(Symbol.iterator),getBuiltIn$9=getBuiltIn$b,isCallable$k=isCallable$n,isPrototypeOf$7=objectIsPrototypeOf,USE_SYMBOL_AS_UID$1=useSymbolAsUid,$Object$2=Object,isSymbol$7=USE_SYMBOL_AS_UID$1?function(e){return"symbol"==_typeof$3(e)}:function(e){var t=getBuiltIn$9("Symbol");return isCallable$k(t)&&isPrototypeOf$7(t.prototype,$Object$2(e))},$String$4=String,tryToString$6=function(e){try{return $String$4(e)}catch(error){return"Object"}},isCallable$j=isCallable$n,tryToString$5=tryToString$6,$TypeError$d=TypeError,aCallable$7=function(e){if(isCallable$j(e))return e;throw $TypeError$d(tryToString$5(e)+" is not a function")},aCallable$6=aCallable$7,getMethod$6=function(e,t){var r=e[t];return null==r?void 0:aCallable$6(r)},call$j=functionCall,isCallable$i=isCallable$n,isObject$f=isObject$g,$TypeError$c=TypeError,ordinaryToPrimitive$1=function(e,t){var r,n;if("string"===t&&isCallable$i(r=e.toString)&&!isObject$f(n=call$j(r,e)))return n;if(isCallable$i(r=e.valueOf)&&!isObject$f(n=call$j(r,e)))return n;if("string"!==t&&isCallable$i(r=e.toString)&&!isObject$f(n=call$j(r,e)))return n;throw $TypeError$c("Can't convert object to primitive value")},shared$7={exports:{}},global$t=global$w,defineProperty$8=Object.defineProperty,defineGlobalProperty$3=function(e,t){try{defineProperty$8(global$t,e,{value:t,configurable:!0,writable:!0})}catch(error){global$t[e]=t}return t},global$s=global$w,defineGlobalProperty$2=defineGlobalProperty$3,SHARED="__core-js_shared__",store$3=global$s[SHARED]||defineGlobalProperty$2(SHARED,{}),sharedStore=store$3,store$2=sharedStore;(shared$7.exports=function(e,t){return store$2[e]||(store$2[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.24.0",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.0/LICENSE",source:"https://github.com/zloirock/core-js"});var requireObjectCoercible$6=requireObjectCoercible$8,$Object$1=Object,toObject$7=function(e){return $Object$1(requireObjectCoercible$6(e))},uncurryThis$u=functionUncurryThis,toObject$6=toObject$7,hasOwnProperty$2=uncurryThis$u({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(e,t){return hasOwnProperty$2(toObject$6(e),t)},uncurryThis$t=functionUncurryThis,id=0,postfix=Math.random(),toString$e=uncurryThis$t(1..toString),uid$3=function(e){return"Symbol("+(void 0===e?"":e)+")_"+toString$e(++id+postfix,36)},global$r=global$w,shared$6=shared$7.exports,hasOwn$g=hasOwnProperty_1,uid$2=uid$3,NATIVE_SYMBOL$5=nativeSymbol,USE_SYMBOL_AS_UID=useSymbolAsUid,WellKnownSymbolsStore$1=shared$6("wks"),_Symbol$5=global$r.Symbol,symbolFor=_Symbol$5&&_Symbol$5.for,createWellKnownSymbol=USE_SYMBOL_AS_UID?_Symbol$5:_Symbol$5&&_Symbol$5.withoutSetter||uid$2,wellKnownSymbol$k=function(e){if(!hasOwn$g(WellKnownSymbolsStore$1,e)||!NATIVE_SYMBOL$5&&"string"!=typeof WellKnownSymbolsStore$1[e]){var t="Symbol."+e;NATIVE_SYMBOL$5&&hasOwn$g(_Symbol$5,e)?WellKnownSymbolsStore$1[e]=_Symbol$5[e]:WellKnownSymbolsStore$1[e]=USE_SYMBOL_AS_UID&&symbolFor?symbolFor(t):createWellKnownSymbol(t)}return WellKnownSymbolsStore$1[e]},call$i=functionCall,isObject$e=isObject$g,isSymbol$6=isSymbol$7,getMethod$5=getMethod$6,ordinaryToPrimitive=ordinaryToPrimitive$1,wellKnownSymbol$j=wellKnownSymbol$k,$TypeError$b=TypeError,TO_PRIMITIVE=wellKnownSymbol$j("toPrimitive"),toPrimitive$2=function(e,t){if(!isObject$e(e)||isSymbol$6(e))return e;var r,n=getMethod$5(e,TO_PRIMITIVE);if(n){if(void 0===t&&(t="default"),r=call$i(n,e,t),!isObject$e(r)||isSymbol$6(r))return r;throw $TypeError$b("Can't convert object to primitive value")}return void 0===t&&(t="number"),ordinaryToPrimitive(e,t)},toPrimitive$1=toPrimitive$2,isSymbol$5=isSymbol$7,toPropertyKey$4=function(e){var t=toPrimitive$1(e,"string");return isSymbol$5(t)?t:t+""},global$q=global$w,isObject$d=isObject$g,document$3=global$q.document,EXISTS$1=isObject$d(document$3)&&isObject$d(document$3.createElement),documentCreateElement$2=function(e){return EXISTS$1?document$3.createElement(e):{}},DESCRIPTORS$h=descriptors,fails$r=fails$w,createElement$1=documentCreateElement$2,ie8DomDefine=!DESCRIPTORS$h&&!fails$r((function(){return 7!=Object.defineProperty(createElement$1("div"),"a",{get:function(){return 7}}).a})),DESCRIPTORS$g=descriptors,call$h=functionCall,propertyIsEnumerableModule$1=objectPropertyIsEnumerable,createPropertyDescriptor$3=createPropertyDescriptor$4,toIndexedObject$8=toIndexedObject$9,toPropertyKey$3=toPropertyKey$4,hasOwn$f=hasOwnProperty_1,IE8_DOM_DEFINE$1=ie8DomDefine,$getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$g?$getOwnPropertyDescriptor$2:function(e,t){if(e=toIndexedObject$8(e),t=toPropertyKey$3(t),IE8_DOM_DEFINE$1)try{return $getOwnPropertyDescriptor$2(e,t)}catch(error){}if(hasOwn$f(e,t))return createPropertyDescriptor$3(!call$h(propertyIsEnumerableModule$1.f,e,t),e[t])};var objectDefineProperty={},DESCRIPTORS$f=descriptors,fails$q=fails$w,v8PrototypeDefineBug=DESCRIPTORS$f&&fails$q((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),isObject$c=isObject$g,$String$3=String,$TypeError$a=TypeError,anObject$h=function(e){if(isObject$c(e))return e;throw $TypeError$a($String$3(e)+" is not an object")},DESCRIPTORS$e=descriptors,IE8_DOM_DEFINE=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG$1=v8PrototypeDefineBug,anObject$g=anObject$h,toPropertyKey$2=toPropertyKey$4,$TypeError$9=TypeError,$defineProperty$1=Object.defineProperty,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE$1="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$e?V8_PROTOTYPE_DEFINE_BUG$1?function(e,t,r){if(anObject$g(e),t=toPropertyKey$2(t),anObject$g(r),"function"==typeof e&&"prototype"===t&&"value"in r&&WRITABLE in r&&!r[WRITABLE]){var n=$getOwnPropertyDescriptor$1(e,t);n&&n[WRITABLE]&&(e[t]=r.value,r={configurable:CONFIGURABLE$1 in r?r[CONFIGURABLE$1]:n[CONFIGURABLE$1],enumerable:ENUMERABLE in r?r[ENUMERABLE]:n[ENUMERABLE],writable:!1})}return $defineProperty$1(e,t,r)}:$defineProperty$1:function(e,t,r){if(anObject$g(e),t=toPropertyKey$2(t),anObject$g(r),IE8_DOM_DEFINE)try{return $defineProperty$1(e,t,r)}catch(error){}if("get"in r||"set"in r)throw $TypeError$9("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var DESCRIPTORS$d=descriptors,definePropertyModule$6=objectDefineProperty,createPropertyDescriptor$2=createPropertyDescriptor$4,createNonEnumerableProperty$5=DESCRIPTORS$d?function(e,t,r){return definePropertyModule$6.f(e,t,createPropertyDescriptor$2(1,r))}:function(e,t,r){return e[t]=r,e},makeBuiltIn$2={exports:{}},DESCRIPTORS$c=descriptors,hasOwn$e=hasOwnProperty_1,FunctionPrototype$2=Function.prototype,getDescriptor=DESCRIPTORS$c&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn$e(FunctionPrototype$2,"name"),PROPER=EXISTS&&"something"===function(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS$c||DESCRIPTORS$c&&getDescriptor(FunctionPrototype$2,"name").configurable),functionName={EXISTS:EXISTS,PROPER:PROPER,CONFIGURABLE:CONFIGURABLE},uncurryThis$s=functionUncurryThis,isCallable$h=isCallable$n,store$1=sharedStore,functionToString$1=uncurryThis$s(Function.toString);isCallable$h(store$1.inspectSource)||(store$1.inspectSource=function(e){return functionToString$1(e)});var inspectSource$4=store$1.inspectSource,global$p=global$w,isCallable$g=isCallable$n,inspectSource$3=inspectSource$4,WeakMap$2=global$p.WeakMap,nativeWeakMap=isCallable$g(WeakMap$2)&&/native code/.test(inspectSource$3(WeakMap$2)),shared$5=shared$7.exports,uid$1=uid$3,keys$2=shared$5("keys"),sharedKey$3=function(e){return keys$2[e]||(keys$2[e]=uid$1(e))},hiddenKeys$5={},NATIVE_WEAK_MAP=nativeWeakMap,global$o=global$w,uncurryThis$r=functionUncurryThis,isObject$b=isObject$g,createNonEnumerableProperty$4=createNonEnumerableProperty$5,hasOwn$d=hasOwnProperty_1,shared$4=sharedStore,sharedKey$2=sharedKey$3,hiddenKeys$4=hiddenKeys$5,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$4=global$o.TypeError,WeakMap$1=global$o.WeakMap,set$1,get,has,enforce=function(e){return has(e)?get(e):set$1(e,{})},getterFor=function(e){return function(t){var r;if(!isObject$b(t)||(r=get(t)).type!==e)throw TypeError$4("Incompatible receiver, "+e+" required");return r}};if(NATIVE_WEAK_MAP||shared$4.state){var store=shared$4.state||(shared$4.state=new WeakMap$1),wmget=uncurryThis$r(store.get),wmhas=uncurryThis$r(store.has),wmset=uncurryThis$r(store.set);set$1=function(e,t){if(wmhas(store,e))throw new TypeError$4(OBJECT_ALREADY_INITIALIZED);return t.facade=e,wmset(store,e,t),t},get=function(e){return wmget(store,e)||{}},has=function(e){return wmhas(store,e)}}else{var STATE=sharedKey$2("state");hiddenKeys$4[STATE]=!0,set$1=function(e,t){if(hasOwn$d(e,STATE))throw new TypeError$4(OBJECT_ALREADY_INITIALIZED);return t.facade=e,createNonEnumerableProperty$4(e,STATE,t),t},get=function(e){return hasOwn$d(e,STATE)?e[STATE]:{}},has=function(e){return hasOwn$d(e,STATE)}}var internalState={set:set$1,get:get,has:has,enforce:enforce,getterFor:getterFor},fails$p=fails$w,isCallable$f=isCallable$n,hasOwn$c=hasOwnProperty_1,DESCRIPTORS$b=descriptors,CONFIGURABLE_FUNCTION_NAME=functionName.CONFIGURABLE,inspectSource$2=inspectSource$4,InternalStateModule$2=internalState,enforceInternalState$1=InternalStateModule$2.enforce,getInternalState$2=InternalStateModule$2.get,defineProperty$7=Object.defineProperty,CONFIGURABLE_LENGTH=DESCRIPTORS$b&&!fails$p((function(){return 8!==defineProperty$7((function(){}),"length",{value:8}).length})),TEMPLATE=String(String).split("String"),makeBuiltIn$1=makeBuiltIn$2.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!hasOwn$c(e,"name")||CONFIGURABLE_FUNCTION_NAME&&e.name!==t)&&(DESCRIPTORS$b?defineProperty$7(e,"name",{value:t,configurable:!0}):e.name=t),CONFIGURABLE_LENGTH&&r&&hasOwn$c(r,"arity")&&e.length!==r.arity&&defineProperty$7(e,"length",{value:r.arity});try{r&&hasOwn$c(r,"constructor")&&r.constructor?DESCRIPTORS$b&&defineProperty$7(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(error){}var n=enforceInternalState$1(e);return hasOwn$c(n,"source")||(n.source=TEMPLATE.join("string"==typeof t?t:"")),e};Function.prototype.toString=makeBuiltIn$1((function(){return isCallable$f(this)&&getInternalState$2(this).source||inspectSource$2(this)}),"toString");var isCallable$e=isCallable$n,definePropertyModule$5=objectDefineProperty,makeBuiltIn=makeBuiltIn$2.exports,defineGlobalProperty$1=defineGlobalProperty$3,defineBuiltIn$b=function(e,t,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:t;if(isCallable$e(r)&&makeBuiltIn(r,o,n),n.global)i?e[t]=r:defineGlobalProperty$1(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch(error){}i?e[t]=r:definePropertyModule$5.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},objectGetOwnPropertyNames={},ceil=Math.ceil,floor$2=Math.floor,mathTrunc=Math.trunc||function(e){var t=+e;return(t>0?floor$2:ceil)(t)},trunc=mathTrunc,toIntegerOrInfinity$7=function(e){var t=+e;return t!=t||0===t?0:trunc(t)},toIntegerOrInfinity$6=toIntegerOrInfinity$7,max$3=Math.max,min$4=Math.min,toAbsoluteIndex$3=function(e,t){var r=toIntegerOrInfinity$6(e);return r<0?max$3(r+t,0):min$4(r,t)},toIntegerOrInfinity$5=toIntegerOrInfinity$7,min$3=Math.min,toLength$4=function(e){return e>0?min$3(toIntegerOrInfinity$5(e),9007199254740991):0},toLength$3=toLength$4,lengthOfArrayLike$6=function(e){return toLength$3(e.length)},toIndexedObject$7=toIndexedObject$9,toAbsoluteIndex$2=toAbsoluteIndex$3,lengthOfArrayLike$5=lengthOfArrayLike$6,createMethod$3=function(e){return function(t,r,n){var i,o=toIndexedObject$7(t),a=lengthOfArrayLike$5(o),s=toAbsoluteIndex$2(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},arrayIncludes={includes:createMethod$3(!0),indexOf:createMethod$3(!1)},uncurryThis$q=functionUncurryThis,hasOwn$b=hasOwnProperty_1,toIndexedObject$6=toIndexedObject$9,indexOf$1=arrayIncludes.indexOf,hiddenKeys$3=hiddenKeys$5,push$4=uncurryThis$q([].push),objectKeysInternal=function(e,t){var r,n=toIndexedObject$6(e),i=0,o=[];for(r in n)!hasOwn$b(hiddenKeys$3,r)&&hasOwn$b(n,r)&&push$4(o,r);for(;t.length>i;)hasOwn$b(n,r=t[i++])&&(~indexOf$1(o,r)||push$4(o,r));return o},enumBugKeys$3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,enumBugKeys$2=enumBugKeys$3,hiddenKeys$2=enumBugKeys$2.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(e){return internalObjectKeys$1(e,hiddenKeys$2)};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var getBuiltIn$8=getBuiltIn$b,uncurryThis$p=functionUncurryThis,getOwnPropertyNamesModule$1=objectGetOwnPropertyNames,getOwnPropertySymbolsModule$2=objectGetOwnPropertySymbols,anObject$f=anObject$h,concat$1=uncurryThis$p([].concat),ownKeys$6=getBuiltIn$8("Reflect","ownKeys")||function(e){var t=getOwnPropertyNamesModule$1.f(anObject$f(e)),r=getOwnPropertySymbolsModule$2.f;return r?concat$1(t,r(e)):t},hasOwn$a=hasOwnProperty_1,ownKeys$5=ownKeys$6,getOwnPropertyDescriptorModule$2=objectGetOwnPropertyDescriptor,definePropertyModule$4=objectDefineProperty,copyConstructorProperties$2=function(e,t,r){for(var n=ownKeys$5(t),i=definePropertyModule$4.f,o=getOwnPropertyDescriptorModule$2.f,a=0;a<n.length;a++){var s=n[a];hasOwn$a(e,s)||r&&hasOwn$a(r,s)||i(e,s,o(t,s))}},fails$o=fails$w,isCallable$d=isCallable$n,replacement=/#|\.prototype\./,isForced$4=function(e,t){var r=data[normalize(e)];return r==POLYFILL||r!=NATIVE&&(isCallable$d(t)?fails$o(t):!!t)},normalize=isForced$4.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced$4.data={},NATIVE=isForced$4.NATIVE="N",POLYFILL=isForced$4.POLYFILL="P",isForced_1=isForced$4,global$n=global$w,getOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f,createNonEnumerableProperty$3=createNonEnumerableProperty$5,defineBuiltIn$a=defineBuiltIn$b,defineGlobalProperty=defineGlobalProperty$3,copyConstructorProperties$1=copyConstructorProperties$2,isForced$3=isForced_1,_export=function(e,t){var r,n,i,o,a,s=e.target,u=e.global,c=e.stat;if(r=u?global$n:c?global$n[s]||defineGlobalProperty(s,{}):(global$n[s]||{}).prototype)for(n in t){if(o=t[n],i=e.dontCallGetSet?(a=getOwnPropertyDescriptor$2(r,n))&&a.value:r[n],!isForced$3(u?n:s+(c?".":"#")+n,e.forced)&&void 0!==i){if(_typeof$3(o)==_typeof$3(i))continue;copyConstructorProperties$1(o,i)}(e.sham||i&&i.sham)&&createNonEnumerableProperty$3(o,"sham",!0),defineBuiltIn$a(r,n,o,e)}},wellKnownSymbol$i=wellKnownSymbol$k,TO_STRING_TAG$2=wellKnownSymbol$i("toStringTag"),test={};test[TO_STRING_TAG$2]="z";var toStringTagSupport="[object z]"===String(test),TO_STRING_TAG_SUPPORT$2=toStringTagSupport,isCallable$c=isCallable$n,classofRaw=classofRaw$1,wellKnownSymbol$h=wellKnownSymbol$k,TO_STRING_TAG$1=wellKnownSymbol$h("toStringTag"),$Object=Object,CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(error){}},classof$9=TO_STRING_TAG_SUPPORT$2?classofRaw:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=tryGet(t=$Object(e),TO_STRING_TAG$1))?r:CORRECT_ARGUMENTS?classofRaw(t):"Object"==(n=classofRaw(t))&&isCallable$c(t.callee)?"Arguments":n},classof$8=classof$9,$String$2=String,toString$d=function(e){if("Symbol"===classof$8(e))throw TypeError("Cannot convert a Symbol value to a string");return $String$2(e)},objectDefineProperties={},internalObjectKeys=objectKeysInternal,enumBugKeys$1=enumBugKeys$3,objectKeys$2=Object.keys||function(e){return internalObjectKeys(e,enumBugKeys$1)},DESCRIPTORS$a=descriptors,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,definePropertyModule$3=objectDefineProperty,anObject$e=anObject$h,toIndexedObject$5=toIndexedObject$9,objectKeys$1=objectKeys$2;objectDefineProperties.f=DESCRIPTORS$a&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(e,t){anObject$e(e);for(var r,n=toIndexedObject$5(t),i=objectKeys$1(t),o=i.length,a=0;o>a;)definePropertyModule$3.f(e,r=i[a++],n[r]);return e};var getBuiltIn$7=getBuiltIn$b,html$2=getBuiltIn$7("document","documentElement"),anObject$d=anObject$h,definePropertiesModule$1=objectDefineProperties,enumBugKeys=enumBugKeys$3,hiddenKeys$1=hiddenKeys$5,html$1=html$2,documentCreateElement$1=documentCreateElement$2,sharedKey$1=sharedKey$3,GT=">",LT="<",PROTOTYPE$1="prototype",SCRIPT="script",IE_PROTO=sharedKey$1("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e,t=documentCreateElement$1("iframe"),r="java"+SCRIPT+":";return t.style.display="none",html$1.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(scriptTag("document.F=Object")),e.close(),e.F},activeXDocument,_NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch(error){}_NullProtoObject="undefined"!=typeof document?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(activeXDocument);for(var e=enumBugKeys.length;e--;)delete _NullProtoObject[PROTOTYPE$1][enumBugKeys[e]];return _NullProtoObject()};hiddenKeys$1[IE_PROTO]=!0;var objectCreate=Object.create||function(e,t){var r;return null!==e?(EmptyConstructor[PROTOTYPE$1]=anObject$d(e),r=new EmptyConstructor,EmptyConstructor[PROTOTYPE$1]=null,r[IE_PROTO]=e):r=_NullProtoObject(),void 0===t?r:definePropertiesModule$1.f(r,t)},objectGetOwnPropertyNamesExternal={},toPropertyKey$1=toPropertyKey$4,definePropertyModule$2=objectDefineProperty,createPropertyDescriptor$1=createPropertyDescriptor$4,createProperty$4=function(e,t,r){var n=toPropertyKey$1(t);n in e?definePropertyModule$2.f(e,n,createPropertyDescriptor$1(0,r)):e[n]=r},toAbsoluteIndex$1=toAbsoluteIndex$3,lengthOfArrayLike$4=lengthOfArrayLike$6,createProperty$3=createProperty$4,$Array$1=Array,max$2=Math.max,arraySliceSimple=function(e,t,r){for(var n=lengthOfArrayLike$4(e),i=toAbsoluteIndex$1(t,n),o=toAbsoluteIndex$1(void 0===r?n:r,n),a=$Array$1(max$2(o-i,0)),s=0;i<o;i++,s++)createProperty$3(a,s,e[i]);return a.length=s,a},classof$7=classofRaw$1,toIndexedObject$4=toIndexedObject$9,$getOwnPropertyNames$1=objectGetOwnPropertyNames.f,arraySlice$6=arraySliceSimple,windowNames="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return $getOwnPropertyNames$1(e)}catch(error){return arraySlice$6(windowNames)}};objectGetOwnPropertyNamesExternal.f=function(e){return windowNames&&"Window"==classof$7(e)?getWindowNames(e):$getOwnPropertyNames$1(toIndexedObject$4(e))};var wellKnownSymbolWrapped={},wellKnownSymbol$g=wellKnownSymbol$k;wellKnownSymbolWrapped.f=wellKnownSymbol$g;var global$m=global$w,path$1=global$m,path=path$1,hasOwn$9=hasOwnProperty_1,wrappedWellKnownSymbolModule$1=wellKnownSymbolWrapped,defineProperty$6=objectDefineProperty.f,defineWellKnownSymbol$1=function(e){var t=path.Symbol||(path.Symbol={});hasOwn$9(t,e)||defineProperty$6(t,e,{value:wrappedWellKnownSymbolModule$1.f(e)})},call$g=functionCall,getBuiltIn$6=getBuiltIn$b,wellKnownSymbol$f=wellKnownSymbol$k,defineBuiltIn$9=defineBuiltIn$b,symbolDefineToPrimitive=function(){var e=getBuiltIn$6("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=wellKnownSymbol$f("toPrimitive");t&&!t[n]&&defineBuiltIn$9(t,n,(function(e){return call$g(r,this)}),{arity:1})},defineProperty$5=objectDefineProperty.f,hasOwn$8=hasOwnProperty_1,wellKnownSymbol$e=wellKnownSymbol$k,TO_STRING_TAG=wellKnownSymbol$e("toStringTag"),setToStringTag$2=function(e,t,r){e&&!r&&(e=e.prototype),e&&!hasOwn$8(e,TO_STRING_TAG)&&defineProperty$5(e,TO_STRING_TAG,{configurable:!0,value:t})},uncurryThis$o=functionUncurryThis,aCallable$5=aCallable$7,NATIVE_BIND$1=functionBindNative,bind$5=uncurryThis$o(uncurryThis$o.bind),functionBindContext=function(e,t){return aCallable$5(e),void 0===t?e:NATIVE_BIND$1?bind$5(e,t):function(){return e.apply(t,arguments)}},classof$6=classofRaw$1,isArray$3=Array.isArray||function(e){return"Array"==classof$6(e)},uncurryThis$n=functionUncurryThis,fails$n=fails$w,isCallable$b=isCallable$n,classof$5=classof$9,getBuiltIn$5=getBuiltIn$b,inspectSource$1=inspectSource$4,noop=function(){},empty=[],construct=getBuiltIn$5("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec$5=uncurryThis$n(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.exec(noop),isConstructorModern=function(e){if(!isCallable$b(e))return!1;try{return construct(noop,empty,e),!0}catch(error){return!1}},isConstructorLegacy=function(e){if(!isCallable$b(e))return!1;switch(classof$5(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec$5(constructorRegExp,inspectSource$1(e))}catch(error){return!0}};isConstructorLegacy.sham=!0;var isConstructor$2=!construct||fails$n((function(){var e;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern((function(){e=!0}))||e}))?isConstructorLegacy:isConstructorModern,isArray$2=isArray$3,isConstructor$1=isConstructor$2,isObject$a=isObject$g,wellKnownSymbol$d=wellKnownSymbol$k,SPECIES$5=wellKnownSymbol$d("species"),$Array=Array,arraySpeciesConstructor$1=function(e){var t;return isArray$2(e)&&(t=e.constructor,(isConstructor$1(t)&&(t===$Array||isArray$2(t.prototype))||isObject$a(t)&&null===(t=t[SPECIES$5]))&&(t=void 0)),void 0===t?$Array:t},arraySpeciesConstructor=arraySpeciesConstructor$1,arraySpeciesCreate$3=function(e,t){return new(arraySpeciesConstructor(e))(0===t?0:t)},bind$4=functionBindContext,uncurryThis$m=functionUncurryThis,IndexedObject$1=indexedObject,toObject$5=toObject$7,lengthOfArrayLike$3=lengthOfArrayLike$6,arraySpeciesCreate$2=arraySpeciesCreate$3,push$3=uncurryThis$m([].push),createMethod$2=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(u,c,l,d){for(var f,h,p=toObject$5(u),g=IndexedObject$1(p),y=bind$4(c,l),v=lengthOfArrayLike$3(g),m=0,_=d||arraySpeciesCreate$2,b=t?_(u,v):r||a?_(u,0):void 0;v>m;m++)if((s||m in g)&&(h=y(f=g[m],m,p),e))if(t)b[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:push$3(b,f)}else switch(e){case 4:return!1;case 7:push$3(b,f)}return o?-1:n||i?i:b}},arrayIteration={forEach:createMethod$2(0),map:createMethod$2(1),filter:createMethod$2(2),some:createMethod$2(3),every:createMethod$2(4),find:createMethod$2(5),findIndex:createMethod$2(6),filterReject:createMethod$2(7)},$$y=_export,global$l=global$w,call$f=functionCall,uncurryThis$l=functionUncurryThis,DESCRIPTORS$9=descriptors,NATIVE_SYMBOL$4=nativeSymbol,fails$m=fails$w,hasOwn$7=hasOwnProperty_1,isPrototypeOf$6=objectIsPrototypeOf,anObject$c=anObject$h,toIndexedObject$3=toIndexedObject$9,toPropertyKey=toPropertyKey$4,$toString$1=toString$d,createPropertyDescriptor=createPropertyDescriptor$4,nativeObjectCreate=objectCreate,objectKeys=objectKeys$2,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertyNamesExternal=objectGetOwnPropertyNamesExternal,getOwnPropertySymbolsModule$1=objectGetOwnPropertySymbols,getOwnPropertyDescriptorModule$1=objectGetOwnPropertyDescriptor,definePropertyModule$1=objectDefineProperty,definePropertiesModule=objectDefineProperties,propertyIsEnumerableModule=objectPropertyIsEnumerable,defineBuiltIn$8=defineBuiltIn$b,shared$3=shared$7.exports,sharedKey=sharedKey$3,hiddenKeys=hiddenKeys$5,uid=uid$3,wellKnownSymbol$c=wellKnownSymbol$k,wrappedWellKnownSymbolModule=wellKnownSymbolWrapped,defineWellKnownSymbol=defineWellKnownSymbol$1,defineSymbolToPrimitive=symbolDefineToPrimitive,setToStringTag$1=setToStringTag$2,InternalStateModule$1=internalState,$forEach$1=arrayIteration.forEach,HIDDEN=sharedKey("hidden"),SYMBOL="Symbol",PROTOTYPE="prototype",setInternalState$1=InternalStateModule$1.set,getInternalState$1=InternalStateModule$1.getterFor(SYMBOL),ObjectPrototype=Object[PROTOTYPE],$Symbol=global$l.Symbol,SymbolPrototype$1=$Symbol&&$Symbol[PROTOTYPE],TypeError$3=global$l.TypeError,QObject=global$l.QObject,nativeGetOwnPropertyDescriptor$1=getOwnPropertyDescriptorModule$1.f,nativeDefineProperty=definePropertyModule$1.f,nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f,nativePropertyIsEnumerable=propertyIsEnumerableModule.f,push$2=uncurryThis$l([].push),AllSymbols=shared$3("symbols"),ObjectPrototypeSymbols=shared$3("op-symbols"),WellKnownSymbolsStore=shared$3("wks"),USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDescriptor=DESCRIPTORS$9&&fails$m((function(){return 7!=nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=nativeGetOwnPropertyDescriptor$1(ObjectPrototype,t);n&&delete ObjectPrototype[t],nativeDefineProperty(e,t,r),n&&e!==ObjectPrototype&&nativeDefineProperty(ObjectPrototype,t,n)}:nativeDefineProperty,wrap$1=function(e,t){var r=AllSymbols[e]=nativeObjectCreate(SymbolPrototype$1);return setInternalState$1(r,{type:SYMBOL,tag:e,description:t}),DESCRIPTORS$9||(r.description=t),r},$defineProperty=function(e,t,r){e===ObjectPrototype&&$defineProperty(ObjectPrototypeSymbols,t,r),anObject$c(e);var n=toPropertyKey(t);return anObject$c(r),hasOwn$7(AllSymbols,n)?(r.enumerable?(hasOwn$7(e,HIDDEN)&&e[HIDDEN][n]&&(e[HIDDEN][n]=!1),r=nativeObjectCreate(r,{enumerable:createPropertyDescriptor(0,!1)})):(hasOwn$7(e,HIDDEN)||nativeDefineProperty(e,HIDDEN,createPropertyDescriptor(1,{})),e[HIDDEN][n]=!0),setSymbolDescriptor(e,n,r)):nativeDefineProperty(e,n,r)},$defineProperties=function(e,t){anObject$c(e);var r=toIndexedObject$3(t),n=objectKeys(r).concat($getOwnPropertySymbols(r));return $forEach$1(n,(function(t){DESCRIPTORS$9&&!call$f($propertyIsEnumerable,r,t)||$defineProperty(e,t,r[t])})),e},$create=function(e,t){return void 0===t?nativeObjectCreate(e):$defineProperties(nativeObjectCreate(e),t)},$propertyIsEnumerable=function(e){var t=toPropertyKey(e),r=call$f(nativePropertyIsEnumerable,this,t);return!(this===ObjectPrototype&&hasOwn$7(AllSymbols,t)&&!hasOwn$7(ObjectPrototypeSymbols,t))&&(!(r||!hasOwn$7(this,t)||!hasOwn$7(AllSymbols,t)||hasOwn$7(this,HIDDEN)&&this[HIDDEN][t])||r)},$getOwnPropertyDescriptor=function(e,t){var r=toIndexedObject$3(e),n=toPropertyKey(t);if(r!==ObjectPrototype||!hasOwn$7(AllSymbols,n)||hasOwn$7(ObjectPrototypeSymbols,n)){var i=nativeGetOwnPropertyDescriptor$1(r,n);return!i||!hasOwn$7(AllSymbols,n)||hasOwn$7(r,HIDDEN)&&r[HIDDEN][n]||(i.enumerable=!0),i}},$getOwnPropertyNames=function(e){var t=nativeGetOwnPropertyNames(toIndexedObject$3(e)),r=[];return $forEach$1(t,(function(e){hasOwn$7(AllSymbols,e)||hasOwn$7(hiddenKeys,e)||push$2(r,e)})),r},$getOwnPropertySymbols=function(e){var t=e===ObjectPrototype,r=nativeGetOwnPropertyNames(t?ObjectPrototypeSymbols:toIndexedObject$3(e)),n=[];return $forEach$1(r,(function(e){!hasOwn$7(AllSymbols,e)||t&&!hasOwn$7(ObjectPrototype,e)||push$2(n,AllSymbols[e])})),n};NATIVE_SYMBOL$4||($Symbol=function(){if(isPrototypeOf$6(SymbolPrototype$1,this))throw TypeError$3("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?$toString$1(arguments[0]):void 0,t=uid(e),r=function e(r){this===ObjectPrototype&&call$f(e,ObjectPrototypeSymbols,r),hasOwn$7(this,HIDDEN)&&hasOwn$7(this[HIDDEN],t)&&(this[HIDDEN][t]=!1),setSymbolDescriptor(this,t,createPropertyDescriptor(1,r))};return DESCRIPTORS$9&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype,t,{configurable:!0,set:r}),wrap$1(t,e)},SymbolPrototype$1=$Symbol[PROTOTYPE],defineBuiltIn$8(SymbolPrototype$1,"toString",(function(){return getInternalState$1(this).tag})),defineBuiltIn$8($Symbol,"withoutSetter",(function(e){return wrap$1(uid(e),e)})),propertyIsEnumerableModule.f=$propertyIsEnumerable,definePropertyModule$1.f=$defineProperty,definePropertiesModule.f=$defineProperties,getOwnPropertyDescriptorModule$1.f=$getOwnPropertyDescriptor,getOwnPropertyNamesModule.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames,getOwnPropertySymbolsModule$1.f=$getOwnPropertySymbols,wrappedWellKnownSymbolModule.f=function(e){return wrap$1(wellKnownSymbol$c(e),e)},DESCRIPTORS$9&&(nativeDefineProperty(SymbolPrototype$1,"description",{configurable:!0,get:function(){return getInternalState$1(this).description}}),defineBuiltIn$8(ObjectPrototype,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:!0}))),$$y({global:!0,constructor:!0,wrap:!0,forced:!NATIVE_SYMBOL$4,sham:!NATIVE_SYMBOL$4},{Symbol:$Symbol}),$forEach$1(objectKeys(WellKnownSymbolsStore),(function(e){defineWellKnownSymbol(e)})),$$y({target:SYMBOL,stat:!0,forced:!NATIVE_SYMBOL$4},{useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}}),$$y({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$4,sham:!DESCRIPTORS$9},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor}),$$y({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$4},{getOwnPropertyNames:$getOwnPropertyNames}),defineSymbolToPrimitive(),setToStringTag$1($Symbol,SYMBOL),hiddenKeys[HIDDEN]=!0;var NATIVE_SYMBOL$3=nativeSymbol,nativeSymbolRegistry=NATIVE_SYMBOL$3&&!!Symbol.for&&!!Symbol.keyFor,$$x=_export,getBuiltIn$4=getBuiltIn$b,hasOwn$6=hasOwnProperty_1,toString$c=toString$d,shared$2=shared$7.exports,NATIVE_SYMBOL_REGISTRY$1=nativeSymbolRegistry,StringToSymbolRegistry=shared$2("string-to-symbol-registry"),SymbolToStringRegistry$1=shared$2("symbol-to-string-registry");$$x({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY$1},{for:function(e){var t=toString$c(e);if(hasOwn$6(StringToSymbolRegistry,t))return StringToSymbolRegistry[t];var r=getBuiltIn$4("Symbol")(t);return StringToSymbolRegistry[t]=r,SymbolToStringRegistry$1[r]=t,r}});var $$w=_export,hasOwn$5=hasOwnProperty_1,isSymbol$4=isSymbol$7,tryToString$4=tryToString$6,shared$1=shared$7.exports,NATIVE_SYMBOL_REGISTRY=nativeSymbolRegistry,SymbolToStringRegistry=shared$1("symbol-to-string-registry");$$w({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY},{keyFor:function(e){if(!isSymbol$4(e))throw TypeError(tryToString$4(e)+" is not a symbol");if(hasOwn$5(SymbolToStringRegistry,e))return SymbolToStringRegistry[e]}});var NATIVE_BIND=functionBindNative,FunctionPrototype$1=Function.prototype,apply$5=FunctionPrototype$1.apply,call$e=FunctionPrototype$1.call,functionApply="object"==("undefined"==typeof Reflect?"undefined":_typeof$3(Reflect))&&Reflect.apply||(NATIVE_BIND?call$e.bind(apply$5):function(){return call$e.apply(apply$5,arguments)}),uncurryThis$k=functionUncurryThis,arraySlice$5=uncurryThis$k([].slice),$$v=_export,getBuiltIn$3=getBuiltIn$b,apply$4=functionApply,call$d=functionCall,uncurryThis$j=functionUncurryThis,fails$l=fails$w,isArray$1=isArray$3,isCallable$a=isCallable$n,isObject$9=isObject$g,isSymbol$3=isSymbol$7,arraySlice$4=arraySlice$5,NATIVE_SYMBOL$2=nativeSymbol,$stringify=getBuiltIn$3("JSON","stringify"),exec$4=uncurryThis$j(/./.exec),charAt$6=uncurryThis$j("".charAt),charCodeAt$2=uncurryThis$j("".charCodeAt),replace$5=uncurryThis$j("".replace),numberToString=uncurryThis$j(1..toString),tester=/[\uD800-\uDFFF]/g,low=/^[\uD800-\uDBFF]$/,hi=/^[\uDC00-\uDFFF]$/,WRONG_SYMBOLS_CONVERSION=!NATIVE_SYMBOL$2||fails$l((function(){var e=getBuiltIn$3("Symbol")();return"[null]"!=$stringify([e])||"{}"!=$stringify({a:e})||"{}"!=$stringify(Object(e))})),ILL_FORMED_UNICODE=fails$l((function(){return'"\\udf06\\ud834"'!==$stringify("\udf06\ud834")||'"\\udead"'!==$stringify("\udead")})),stringifyWithSymbolsFix=function(e,t){var r=arraySlice$4(arguments),n=t;if((isObject$9(t)||void 0!==e)&&!isSymbol$3(e))return isArray$1(t)||(t=function(e,t){if(isCallable$a(n)&&(t=call$d(n,this,e,t)),!isSymbol$3(t))return t}),r[1]=t,apply$4($stringify,null,r)},fixIllFormed=function(e,t,r){var n=charAt$6(r,t-1),i=charAt$6(r,t+1);return exec$4(low,e)&&!exec$4(hi,i)||exec$4(hi,e)&&!exec$4(low,n)?"\\u"+numberToString(charCodeAt$2(e,0),16):e};$stringify&&$$v({target:"JSON",stat:!0,arity:3,forced:WRONG_SYMBOLS_CONVERSION||ILL_FORMED_UNICODE},{stringify:function(e,t,r){var n=arraySlice$4(arguments),i=apply$4(WRONG_SYMBOLS_CONVERSION?stringifyWithSymbolsFix:$stringify,null,n);return ILL_FORMED_UNICODE&&"string"==typeof i?replace$5(i,tester,fixIllFormed):i}});var $$u=_export,NATIVE_SYMBOL$1=nativeSymbol,fails$k=fails$w,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,toObject$4=toObject$7,FORCED$5=!NATIVE_SYMBOL$1||fails$k((function(){getOwnPropertySymbolsModule.f(1)}));$$u({target:"Object",stat:!0,forced:FORCED$5},{getOwnPropertySymbols:function(e){var t=getOwnPropertySymbolsModule.f;return t?t(toObject$4(e)):[]}});var fails$j=fails$w,wellKnownSymbol$b=wellKnownSymbol$k,V8_VERSION$2=engineV8Version,SPECIES$4=wellKnownSymbol$b("species"),arrayMethodHasSpeciesSupport$4=function(e){return V8_VERSION$2>=51||!fails$j((function(){var t=[];return(t.constructor={})[SPECIES$4]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},$$t=_export,$filter=arrayIteration.filter,arrayMethodHasSpeciesSupport$3=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport$3("filter");$$t({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2},{filter:function(e){return $filter(this,e,arguments.length>1?arguments[1]:void 0)}});var $$s=_export,fails$i=fails$w,toIndexedObject$2=toIndexedObject$9,nativeGetOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,DESCRIPTORS$8=descriptors,FAILS_ON_PRIMITIVES$2=fails$i((function(){nativeGetOwnPropertyDescriptor(1)})),FORCED$4=!DESCRIPTORS$8||FAILS_ON_PRIMITIVES$2;$$s({target:"Object",stat:!0,forced:FORCED$4,sham:!DESCRIPTORS$8},{getOwnPropertyDescriptor:function(e,t){return nativeGetOwnPropertyDescriptor(toIndexedObject$2(e),t)}});var $$r=_export,DESCRIPTORS$7=descriptors,ownKeys$4=ownKeys$6,toIndexedObject$1=toIndexedObject$9,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,createProperty$2=createProperty$4;$$r({target:"Object",stat:!0,sham:!DESCRIPTORS$7},{getOwnPropertyDescriptors:function(e){for(var t,r,n=toIndexedObject$1(e),i=getOwnPropertyDescriptorModule.f,o=ownKeys$4(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&createProperty$2(a,t,r);return a}});var $$q=_export,DESCRIPTORS$6=descriptors,defineProperties=objectDefineProperties.f;$$q({target:"Object",stat:!0,forced:Object.defineProperties!==defineProperties,sham:!DESCRIPTORS$6},{defineProperties:defineProperties});var $$p=_export,DESCRIPTORS$5=descriptors,defineProperty$4=objectDefineProperty.f;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}$$p({target:"Object",stat:!0,forced:Object.defineProperty!==defineProperty$4,sham:!DESCRIPTORS$5},{defineProperty:defineProperty$4});var $TypeError$8=TypeError,MAX_SAFE_INTEGER$2=9007199254740991,doesNotExceedSafeInteger$2=function(e){if(e>MAX_SAFE_INTEGER$2)throw $TypeError$8("Maximum allowed index exceeded");return e},$$o=_export,fails$h=fails$w,isArray=isArray$3,isObject$8=isObject$g,toObject$3=toObject$7,lengthOfArrayLike$2=lengthOfArrayLike$6,doesNotExceedSafeInteger$1=doesNotExceedSafeInteger$2,createProperty$1=createProperty$4,arraySpeciesCreate$1=arraySpeciesCreate$3,arrayMethodHasSpeciesSupport$2=arrayMethodHasSpeciesSupport$4,wellKnownSymbol$a=wellKnownSymbol$k,V8_VERSION$1=engineV8Version,IS_CONCAT_SPREADABLE=wellKnownSymbol$a("isConcatSpreadable"),IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION$1>=51||!fails$h((function(){var e=[];return e[IS_CONCAT_SPREADABLE]=!1,e.concat()[0]!==e})),SPECIES_SUPPORT=arrayMethodHasSpeciesSupport$2("concat"),isConcatSpreadable=function(e){if(!isObject$8(e))return!1;var t=e[IS_CONCAT_SPREADABLE];return void 0!==t?!!t:isArray(e)},FORCED$3=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;$$o({target:"Array",proto:!0,arity:1,forced:FORCED$3},{concat:function(e){var t,r,n,i,o,a=toObject$3(this),s=arraySpeciesCreate$1(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(isConcatSpreadable(o=-1===t?a:arguments[t]))for(i=lengthOfArrayLike$2(o),doesNotExceedSafeInteger$1(u+i),r=0;r<i;r++,u++)r in o&&createProperty$1(s,u,o[r]);else doesNotExceedSafeInteger$1(u+1),createProperty$1(s,u++,o);return s.length=u,s}});var $$n=_export,$map=arrayIteration.map,arrayMethodHasSpeciesSupport$1=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport$1("map");$$n({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1},{map:function(e){return $map(this,e,arguments.length>1?arguments[1]:void 0)}});var $$m=_export,toObject$2=toObject$7,nativeKeys=objectKeys$2,fails$g=fails$w,FAILS_ON_PRIMITIVES$1=fails$g((function(){nativeKeys(1)}));$$m({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$1},{keys:function(e){return nativeKeys(toObject$2(e))}});var uncurryThis$i=functionUncurryThis,defineBuiltIn$7=defineBuiltIn$b,DatePrototype=Date.prototype,INVALID_DATE="Invalid Date",TO_STRING$1="toString",un$DateToString=uncurryThis$i(DatePrototype[TO_STRING$1]),getTime=uncurryThis$i(DatePrototype.getTime);String(new Date(NaN))!=INVALID_DATE&&defineBuiltIn$7(DatePrototype,TO_STRING$1,(function(){var e=getTime(this);return e==e?un$DateToString(this):INVALID_DATE}));var whitespaces$4="\t\n\v\f\r                　\u2028\u2029\ufeff",uncurryThis$h=functionUncurryThis,requireObjectCoercible$5=requireObjectCoercible$8,toString$b=toString$d,whitespaces$3=whitespaces$4,replace$4=uncurryThis$h("".replace),whitespace="["+whitespaces$3+"]",ltrim=RegExp("^"+whitespace+whitespace+"*"),rtrim=RegExp(whitespace+whitespace+"*$"),createMethod$1=function(e){return function(t){var r=toString$b(requireObjectCoercible$5(t));return 1&e&&(r=replace$4(r,ltrim,"")),2&e&&(r=replace$4(r,rtrim,"")),r}},stringTrim={start:createMethod$1(1),end:createMethod$1(2),trim:createMethod$1(3)},global$k=global$w,fails$f=fails$w,uncurryThis$g=functionUncurryThis,toString$a=toString$d,trim$2=stringTrim.trim,whitespaces$2=whitespaces$4,$parseInt$1=global$k.parseInt,_Symbol$4=global$k.Symbol,ITERATOR$4=_Symbol$4&&_Symbol$4.iterator,hex=/^[+-]?0x/i,exec$3=uncurryThis$g(hex.exec),FORCED$2=8!==$parseInt$1(whitespaces$2+"08")||22!==$parseInt$1(whitespaces$2+"0x16")||ITERATOR$4&&!fails$f((function(){$parseInt$1(Object(ITERATOR$4))})),numberParseInt=FORCED$2?function(e,t){var r=trim$2(toString$a(e));return $parseInt$1(r,t>>>0||(exec$3(hex,r)?16:10))}:$parseInt$1,$$l=_export,$parseInt=numberParseInt;$$l({global:!0,forced:parseInt!=$parseInt},{parseInt:$parseInt});var TO_STRING_TAG_SUPPORT$1=toStringTagSupport,classof$4=classof$9,objectToString$2=TO_STRING_TAG_SUPPORT$1?{}.toString:function(){return"[object "+classof$4(this)+"]"},TO_STRING_TAG_SUPPORT=toStringTagSupport,defineBuiltIn$6=defineBuiltIn$b,toString$9=objectToString$2;TO_STRING_TAG_SUPPORT||defineBuiltIn$6(Object.prototype,"toString",toString$9,{unsafe:!0});var anObject$b=anObject$h,regexpFlags$1=function(){var e=anObject$b(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},call$c=functionCall,hasOwn$4=hasOwnProperty_1,isPrototypeOf$5=objectIsPrototypeOf,regExpFlags=regexpFlags$1,RegExpPrototype$3=RegExp.prototype,regexpGetFlags=function(e){var t=e.flags;return void 0!==t||"flags"in RegExpPrototype$3||hasOwn$4(e,"flags")||!isPrototypeOf$5(RegExpPrototype$3,e)?t:call$c(regExpFlags,e)},PROPER_FUNCTION_NAME$1=functionName.PROPER,defineBuiltIn$5=defineBuiltIn$b,anObject$a=anObject$h,$toString=toString$d,fails$e=fails$w,getRegExpFlags$1=regexpGetFlags,TO_STRING="toString",RegExpPrototype$2=RegExp.prototype,n$ToString=RegExpPrototype$2[TO_STRING],NOT_GENERIC=fails$e((function(){return"/a/b"!=n$ToString.call({source:"a",flags:"b"})})),INCORRECT_NAME=PROPER_FUNCTION_NAME$1&&n$ToString.name!=TO_STRING;(NOT_GENERIC||INCORRECT_NAME)&&defineBuiltIn$5(RegExp.prototype,TO_STRING,(function(){var e=anObject$a(this);return"/"+$toString(e.source)+"/"+$toString(getRegExpFlags$1(e))}),{unsafe:!0});var $TypeError$7=TypeError,validateArgumentsLength$2=function(e,t){if(e<t)throw $TypeError$7("Not enough arguments");return e},global$j=global$w,apply$3=functionApply,isCallable$9=isCallable$n,userAgent$3=engineUserAgent,arraySlice$3=arraySlice$5,validateArgumentsLength$1=validateArgumentsLength$2,MSIE=/MSIE .\./.test(userAgent$3),Function$2=global$j.Function,wrap=function(e){return MSIE?function(t,r){var n=validateArgumentsLength$1(arguments.length,1)>2,i=isCallable$9(t)?t:Function$2(t),o=n?arraySlice$3(arguments,2):void 0;return e(n?function(){apply$3(i,this,o)}:i,r)}:e},schedulersFix={setTimeout:wrap(global$j.setTimeout),setInterval:wrap(global$j.setInterval)},$$k=_export,global$i=global$w,setInterval$1=schedulersFix.setInterval;$$k({global:!0,bind:!0,forced:global$i.setInterval!==setInterval$1},{setInterval:setInterval$1});var $$j=_export,global$h=global$w,setTimeout$1=schedulersFix.setTimeout;$$j({global:!0,bind:!0,forced:global$h.setTimeout!==setTimeout$1},{setTimeout:setTimeout$1});var fails$d=fails$w,arrayMethodIsStrict$4=function(e,t){var r=[][e];return!!r&&fails$d((function(){r.call(null,t||function(){return 1},1)}))},$$i=_export,uncurryThis$f=functionUncurryThis,$IndexOf=arrayIncludes.indexOf,arrayMethodIsStrict$3=arrayMethodIsStrict$4,un$IndexOf=uncurryThis$f([].indexOf),NEGATIVE_ZERO=!!un$IndexOf&&1/un$IndexOf([1],1,-0)<0,STRICT_METHOD$3=arrayMethodIsStrict$3("indexOf");$$i({target:"Array",proto:!0,forced:NEGATIVE_ZERO||!STRICT_METHOD$3},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return NEGATIVE_ZERO?un$IndexOf(this,e,t)||0:$IndexOf(this,e,t)}});var $forEach=arrayIteration.forEach,arrayMethodIsStrict$2=arrayMethodIsStrict$4,STRICT_METHOD$2=arrayMethodIsStrict$2("forEach"),arrayForEach=STRICT_METHOD$2?[].forEach:function(e){return $forEach(this,e,arguments.length>1?arguments[1]:void 0)},$$h=_export,forEach$1=arrayForEach;$$h({target:"Array",proto:!0,forced:[].forEach!=forEach$1},{forEach:forEach$1});var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},documentCreateElement=documentCreateElement$2,classList=documentCreateElement("span").classList,DOMTokenListPrototype$1=classList&&classList.constructor&&classList.constructor.prototype,domTokenListPrototype=DOMTokenListPrototype$1===Object.prototype?void 0:DOMTokenListPrototype$1,global$g=global$w,DOMIterables=domIterables,DOMTokenListPrototype=domTokenListPrototype,forEach=arrayForEach,createNonEnumerableProperty$2=createNonEnumerableProperty$5,handlePrototype=function(e){if(e&&e.forEach!==forEach)try{createNonEnumerableProperty$2(e,"forEach",forEach)}catch(error){e.forEach=forEach}};for(var COLLECTION_NAME in DOMIterables)DOMIterables[COLLECTION_NAME]&&handlePrototype(global$g[COLLECTION_NAME]&&global$g[COLLECTION_NAME].prototype);handlePrototype(DOMTokenListPrototype);var isCallable$8=isCallable$n,$String$1=String,$TypeError$6=TypeError,aPossiblePrototype$1=function(e){if("object"==_typeof$3(e)||isCallable$8(e))return e;throw $TypeError$6("Can't set "+$String$1(e)+" as a prototype")},uncurryThis$e=functionUncurryThis,anObject$9=anObject$h,aPossiblePrototype=aPossiblePrototype$1,objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=uncurryThis$e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(error){}return function(r,n){return anObject$9(r),aPossiblePrototype(n),t?e(r,n):r.__proto__=n,r}}():void 0),isCallable$7=isCallable$n,isObject$7=isObject$g,setPrototypeOf$1=objectSetPrototypeOf,inheritIfRequired$2=function(e,t,r){var n,i;return setPrototypeOf$1&&isCallable$7(n=t.constructor)&&n!==r&&isObject$7(i=n.prototype)&&i!==r.prototype&&setPrototypeOf$1(e,i),e},uncurryThis$d=functionUncurryThis,thisNumberValue$2=uncurryThis$d(1..valueOf),DESCRIPTORS$4=descriptors,global$f=global$w,uncurryThis$c=functionUncurryThis,isForced$2=isForced_1,defineBuiltIn$4=defineBuiltIn$b,hasOwn$3=hasOwnProperty_1,inheritIfRequired$1=inheritIfRequired$2,isPrototypeOf$4=objectIsPrototypeOf,isSymbol$2=isSymbol$7,toPrimitive=toPrimitive$2,fails$c=fails$w,getOwnPropertyNames$2=objectGetOwnPropertyNames.f,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,defineProperty$3=objectDefineProperty.f,thisNumberValue$1=thisNumberValue$2,trim$1=stringTrim.trim,NUMBER="Number",NativeNumber=global$f[NUMBER],NumberPrototype=NativeNumber.prototype,TypeError$2=global$f.TypeError,arraySlice$2=uncurryThis$c("".slice),charCodeAt$1=uncurryThis$c("".charCodeAt),toNumeric=function(e){var t=toPrimitive(e,"number");return"bigint"==typeof t?t:toNumber$2(t)},toNumber$2=function(e){var t,r,n,i,o,a,s,u,c=toPrimitive(e,"number");if(isSymbol$2(c))throw TypeError$2("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=trim$1(c),43===(t=charCodeAt$1(c,0))||45===t){if(88===(r=charCodeAt$1(c,2))||120===r)return NaN}else if(48===t){switch(charCodeAt$1(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(a=(o=arraySlice$2(c,2)).length,s=0;s<a;s++)if((u=charCodeAt$1(o,s))<48||u>i)return NaN;return parseInt(o,n)}return+c};if(isForced$2(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1"))){for(var NumberWrapper=function(e){var t=arguments.length<1?0:NativeNumber(toNumeric(e)),r=this;return isPrototypeOf$4(NumberPrototype,r)&&fails$c((function(){thisNumberValue$1(r)}))?inheritIfRequired$1(Object(t),r,NumberWrapper):t},keys$1=DESCRIPTORS$4?getOwnPropertyNames$2(NativeNumber):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),j=0,key;keys$1.length>j;j++)hasOwn$3(NativeNumber,key=keys$1[j])&&!hasOwn$3(NumberWrapper,key)&&defineProperty$3(NumberWrapper,key,getOwnPropertyDescriptor$1(NativeNumber,key));NumberWrapper.prototype=NumberPrototype,NumberPrototype.constructor=NumberWrapper,defineBuiltIn$4(global$f,NUMBER,NumberWrapper,{constructor:!0})}var DESCRIPTORS$3=descriptors,FUNCTION_NAME_EXISTS=functionName.EXISTS,uncurryThis$b=functionUncurryThis,defineProperty$2=objectDefineProperty.f,FunctionPrototype=Function.prototype,functionToString=uncurryThis$b(FunctionPrototype.toString),nameRE=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,regExpExec$2=uncurryThis$b(nameRE.exec),NAME="name";DESCRIPTORS$3&&!FUNCTION_NAME_EXISTS&&defineProperty$2(FunctionPrototype,NAME,{configurable:!0,get:function(){try{return regExpExec$2(nameRE,functionToString(this))[1]}catch(error){return""}}});var $$g=_export,uncurryThis$a=functionUncurryThis,IndexedObject=indexedObject,toIndexedObject=toIndexedObject$9,arrayMethodIsStrict$1=arrayMethodIsStrict$4,un$Join=uncurryThis$a([].join),ES3_STRINGS=IndexedObject!=Object,STRICT_METHOD$1=arrayMethodIsStrict$1("join",",");$$g({target:"Array",proto:!0,forced:ES3_STRINGS||!STRICT_METHOD$1},{join:function(e){return un$Join(toIndexedObject(this),void 0===e?",":e)}});var tryToString$3=tryToString$6,$TypeError$5=TypeError,deletePropertyOrThrow$1=function(e,t){if(!delete e[t])throw $TypeError$5("Cannot delete property "+tryToString$3(t)+" of "+tryToString$3(e))},$$f=_export,toObject$1=toObject$7,toAbsoluteIndex=toAbsoluteIndex$3,toIntegerOrInfinity$4=toIntegerOrInfinity$7,lengthOfArrayLike$1=lengthOfArrayLike$6,doesNotExceedSafeInteger=doesNotExceedSafeInteger$2,arraySpeciesCreate=arraySpeciesCreate$3,createProperty=createProperty$4,deletePropertyOrThrow=deletePropertyOrThrow$1,arrayMethodHasSpeciesSupport=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("splice"),max$1=Math.max,min$2=Math.min;$$f({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT},{splice:function(e,t){var r,n,i,o,a,s,u=toObject$1(this),c=lengthOfArrayLike$1(u),l=toAbsoluteIndex(e,c),d=arguments.length;for(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=min$2(max$1(toIntegerOrInfinity$4(t),0),c-l)),doesNotExceedSafeInteger(c+r-n),i=arraySpeciesCreate(u,n),o=0;o<n;o++)(a=l+o)in u&&createProperty(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:deletePropertyOrThrow(u,s);for(o=c;o>c-n+r;o--)deletePropertyOrThrow(u,o-1)}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:deletePropertyOrThrow(u,s);for(o=0;o<r;o++)u[o+l]=arguments[o+2];return u.length=c-n+r,i}});var global$e=global$w,fails$b=fails$w,uncurryThis$9=functionUncurryThis,toString$8=toString$d,trim=stringTrim.trim,whitespaces$1=whitespaces$4,charAt$5=uncurryThis$9("".charAt),n$ParseFloat=global$e.parseFloat,_Symbol$3=global$e.Symbol,ITERATOR$3=_Symbol$3&&_Symbol$3.iterator,FORCED$1=1/n$ParseFloat(whitespaces$1+"-0")!=-1/0||ITERATOR$3&&!fails$b((function(){n$ParseFloat(Object(ITERATOR$3))})),numberParseFloat=FORCED$1?function(e){var t=trim(toString$8(e)),r=n$ParseFloat(t);return 0===r&&"-"==charAt$5(t,0)?-0:r}:n$ParseFloat,$$e=_export,$parseFloat=numberParseFloat;$$e({global:!0,forced:parseFloat!=$parseFloat},{parseFloat:$parseFloat});var toIntegerOrInfinity$3=toIntegerOrInfinity$7,toString$7=toString$d,requireObjectCoercible$4=requireObjectCoercible$8,$RangeError$1=RangeError,stringRepeat=function(e){var t=toString$7(requireObjectCoercible$4(this)),r="",n=toIntegerOrInfinity$3(e);if(n<0||n==1/0)throw $RangeError$1("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},$$d=_export,uncurryThis$8=functionUncurryThis,toIntegerOrInfinity$2=toIntegerOrInfinity$7,thisNumberValue=thisNumberValue$2,$repeat=stringRepeat,fails$a=fails$w,$RangeError=RangeError,$String=String,floor$1=Math.floor,repeat=uncurryThis$8($repeat),stringSlice$7=uncurryThis$8("".slice),un$ToFixed=uncurryThis$8(1..toFixed),pow=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)},log$1=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},multiply=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=floor$1(i/1e7)},divide=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=floor$1(n/t),n=n%t*1e7},dataToString=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=$String(e[t]);r=""===r?n:r+repeat("0",7-n.length)+n}return r},FORCED=fails$a((function(){return"0.000"!==un$ToFixed(8e-5,3)||"1"!==un$ToFixed(.9,0)||"1.25"!==un$ToFixed(1.255,2)||"1000000000000000128"!==un$ToFixed(0xde0b6b3a7640080,0)}))||!fails$a((function(){un$ToFixed({})}));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}$$d({target:"Number",proto:!0,forced:FORCED},{toFixed:function(e){var t,r,n,i,o=thisNumberValue(this),a=toIntegerOrInfinity$2(e),s=[0,0,0,0,0,0],u="",c="0";if(a<0||a>20)throw $RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return $String(o);if(o<0&&(u="-",o=-o),o>1e-21)if(r=(t=log$1(o*pow(2,69,1))-69)<0?o*pow(2,-t,1):o/pow(2,t,1),r*=4503599627370496,(t=52-t)>0){for(multiply(s,0,r),n=a;n>=7;)multiply(s,1e7,0),n-=7;for(multiply(s,pow(10,n,1),0),n=t-1;n>=23;)divide(s,1<<23),n-=23;divide(s,1<<n),multiply(s,1,1),divide(s,2),c=dataToString(s)}else multiply(s,0,r),multiply(s,1<<-t,0),c=dataToString(s)+repeat("0",a);return c=a>0?u+((i=c.length)<=a?"0."+repeat("0",a-i)+c:stringSlice$7(c,0,i-a)+"."+stringSlice$7(c,i-a)):u+c}});var fails$9=fails$w,global$d=global$w,$RegExp$2=global$d.RegExp,UNSUPPORTED_Y$3=fails$9((function(){var e=$RegExp$2("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),MISSED_STICKY$1=UNSUPPORTED_Y$3||fails$9((function(){return!$RegExp$2("a","y").sticky})),BROKEN_CARET=UNSUPPORTED_Y$3||fails$9((function(){var e=$RegExp$2("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),regexpStickyHelpers={BROKEN_CARET:BROKEN_CARET,MISSED_STICKY:MISSED_STICKY$1,UNSUPPORTED_Y:UNSUPPORTED_Y$3},fails$8=fails$w,global$c=global$w,$RegExp$1=global$c.RegExp,regexpUnsupportedDotAll=fails$8((function(){var e=$RegExp$1(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),fails$7=fails$w,global$b=global$w,$RegExp=global$b.RegExp,regexpUnsupportedNcg=fails$7((function(){var e=$RegExp("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),call$b=functionCall,uncurryThis$7=functionUncurryThis,toString$6=toString$d,regexpFlags=regexpFlags$1,stickyHelpers$2=regexpStickyHelpers,shared=shared$7.exports,create=objectCreate,getInternalState=internalState.get,UNSUPPORTED_DOT_ALL$1=regexpUnsupportedDotAll,UNSUPPORTED_NCG$1=regexpUnsupportedNcg,nativeReplace=shared("native-string-replace",String.prototype.replace),nativeExec=RegExp.prototype.exec,patchedExec=nativeExec,charAt$4=uncurryThis$7("".charAt),indexOf=uncurryThis$7("".indexOf),replace$3=uncurryThis$7("".replace),stringSlice$6=uncurryThis$7("".slice),UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,t=/b*/g;return call$b(nativeExec,e,"a"),call$b(nativeExec,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),UNSUPPORTED_Y$2=stickyHelpers$2.BROKEN_CARET,NPCG_INCLUDED=void 0!==/()??/.exec("")[1],PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y$2||UNSUPPORTED_DOT_ALL$1||UNSUPPORTED_NCG$1;PATCH&&(patchedExec=function(e){var t,r,n,i,o,a,s,u=this,c=getInternalState(u),l=toString$6(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=call$b(patchedExec,d,l),u.lastIndex=d.lastIndex,t;var f=c.groups,h=UNSUPPORTED_Y$2&&u.sticky,p=call$b(regexpFlags,u),g=u.source,y=0,v=l;if(h&&(p=replace$3(p,"y",""),-1===indexOf(p,"g")&&(p+="g"),v=stringSlice$6(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==charAt$4(l,u.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",p)),NPCG_INCLUDED&&(r=new RegExp("^"+g+"$(?!\\s)",p)),UPDATES_LAST_INDEX_WRONG&&(n=u.lastIndex),i=call$b(nativeExec,h?r:u,v),h?i?(i.input=stringSlice$6(i.input,y),i[0]=stringSlice$6(i[0],y),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:UPDATES_LAST_INDEX_WRONG&&i&&(u.lastIndex=u.global?i.index+i[0].length:n),NPCG_INCLUDED&&i&&i.length>1&&call$b(nativeReplace,i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&f)for(i.groups=a=create(null),o=0;o<f.length;o++)a[(s=f[o])[0]]=i[s[1]];return i});var regexpExec$3=patchedExec,$$c=_export,exec$2=regexpExec$3;$$c({target:"RegExp",proto:!0,forced:/./.exec!==exec$2},{exec:exec$2});var uncurryThis$6=functionUncurryThis,defineBuiltIn$3=defineBuiltIn$b,regexpExec$2=regexpExec$3,fails$6=fails$w,wellKnownSymbol$9=wellKnownSymbol$k,createNonEnumerableProperty$1=createNonEnumerableProperty$5,SPECIES$3=wellKnownSymbol$9("species"),RegExpPrototype$1=RegExp.prototype,fixRegexpWellKnownSymbolLogic=function(e,t,r,n){var i=wellKnownSymbol$9(e),o=!fails$6((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!fails$6((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[SPECIES$3]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return t=!0,null},r[i](""),!t}));if(!o||!a||r){var s=uncurryThis$6(/./[i]),u=t(i,""[e],(function(e,t,r,n,i){var a=uncurryThis$6(e),u=t.exec;return u===regexpExec$2||u===RegExpPrototype$1.exec?o&&!i?{done:!0,value:s(t,r,n)}:{done:!0,value:a(r,t,n)}:{done:!1}}));defineBuiltIn$3(String.prototype,e,u[0]),defineBuiltIn$3(RegExpPrototype$1,i,u[1])}n&&createNonEnumerableProperty$1(RegExpPrototype$1[i],"sham",!0)},isObject$6=isObject$g,classof$3=classofRaw$1,wellKnownSymbol$8=wellKnownSymbol$k,MATCH$1=wellKnownSymbol$8("match"),isRegexp=function(e){var t;return isObject$6(e)&&(void 0!==(t=e[MATCH$1])?!!t:"RegExp"==classof$3(e))},isConstructor=isConstructor$2,tryToString$2=tryToString$6,$TypeError$4=TypeError,aConstructor$1=function(e){if(isConstructor(e))return e;throw $TypeError$4(tryToString$2(e)+" is not a constructor")},anObject$8=anObject$h,aConstructor=aConstructor$1,wellKnownSymbol$7=wellKnownSymbol$k,SPECIES$2=wellKnownSymbol$7("species"),speciesConstructor$2=function(e,t){var r,n=anObject$8(e).constructor;return void 0===n||null==(r=anObject$8(n)[SPECIES$2])?t:aConstructor(r)},uncurryThis$5=functionUncurryThis,toIntegerOrInfinity$1=toIntegerOrInfinity$7,toString$5=toString$d,requireObjectCoercible$3=requireObjectCoercible$8,charAt$3=uncurryThis$5("".charAt),charCodeAt=uncurryThis$5("".charCodeAt),stringSlice$5=uncurryThis$5("".slice),createMethod=function(e){return function(t,r){var n,i,o=toString$5(requireObjectCoercible$3(t)),a=toIntegerOrInfinity$1(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=charCodeAt(o,a))<55296||n>56319||a+1===s||(i=charCodeAt(o,a+1))<56320||i>57343?e?charAt$3(o,a):n:e?stringSlice$5(o,a,a+2):i-56320+(n-55296<<10)+65536}},stringMultibyte={codeAt:createMethod(!1),charAt:createMethod(!0)},charAt$2=stringMultibyte.charAt,advanceStringIndex$3=function(e,t,r){return t+(r?charAt$2(e,t).length:1)},call$a=functionCall,anObject$7=anObject$h,isCallable$6=isCallable$n,classof$2=classofRaw$1,regexpExec$1=regexpExec$3,$TypeError$3=TypeError,regexpExecAbstract=function(e,t){var r=e.exec;if(isCallable$6(r)){var n=call$a(r,e,t);return null!==n&&anObject$7(n),n}if("RegExp"===classof$2(e))return call$a(regexpExec$1,e,t);throw $TypeError$3("RegExp#exec called on incompatible receiver")},apply$2=functionApply,call$9=functionCall,uncurryThis$4=functionUncurryThis,fixRegExpWellKnownSymbolLogic$2=fixRegexpWellKnownSymbolLogic,isRegExp$1=isRegexp,anObject$6=anObject$h,requireObjectCoercible$2=requireObjectCoercible$8,speciesConstructor$1=speciesConstructor$2,advanceStringIndex$2=advanceStringIndex$3,toLength$2=toLength$4,toString$4=toString$d,getMethod$4=getMethod$6,arraySlice$1=arraySliceSimple,callRegExpExec=regexpExecAbstract,regexpExec=regexpExec$3,stickyHelpers$1=regexpStickyHelpers,fails$5=fails$w,UNSUPPORTED_Y$1=stickyHelpers$1.UNSUPPORTED_Y,MAX_UINT32=4294967295,min$1=Math.min,$push=[].push,exec$1=uncurryThis$4(/./.exec),push$1=uncurryThis$4($push),stringSlice$4=uncurryThis$4("".slice),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails$5((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));fixRegExpWellKnownSymbolLogic$2("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=toString$4(requireObjectCoercible$2(this)),i=void 0===r?MAX_UINT32:r>>>0;if(0===i)return[];if(void 0===e)return[n];if(!isRegExp$1(e))return call$9(t,n,e,i);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(o=call$9(regexpExec,d,n))&&!((a=d.lastIndex)>l&&(push$1(u,stringSlice$4(n,l,o.index)),o.length>1&&o.index<n.length&&apply$2($push,u,arraySlice$1(o,1)),s=o[0].length,l=a,u.length>=i));)d.lastIndex===o.index&&d.lastIndex++;return l===n.length?!s&&exec$1(d,"")||push$1(u,""):push$1(u,stringSlice$4(n,l)),u.length>i?arraySlice$1(u,0,i):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:call$9(t,this,e,r)}:t,[function(t,r){var i=requireObjectCoercible$2(this),o=null==t?void 0:getMethod$4(t,e);return o?call$9(o,t,i,r):call$9(n,toString$4(i),t,r)},function(e,i){var o=anObject$6(this),a=toString$4(e),s=r(n,o,a,i,n!==t);if(s.done)return s.value;var u=speciesConstructor$1(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(UNSUPPORTED_Y$1?"g":"y"),d=new u(UNSUPPORTED_Y$1?"^(?:"+o.source+")":o,l),f=void 0===i?MAX_UINT32:i>>>0;if(0===f)return[];if(0===a.length)return null===callRegExpExec(d,a)?[a]:[];for(var h=0,p=0,g=[];p<a.length;){d.lastIndex=UNSUPPORTED_Y$1?0:p;var y,v=callRegExpExec(d,UNSUPPORTED_Y$1?stringSlice$4(a,p):a);if(null===v||(y=min$1(toLength$2(d.lastIndex+(UNSUPPORTED_Y$1?p:0)),a.length))===h)p=advanceStringIndex$2(a,p,c);else{if(push$1(g,stringSlice$4(a,h,p)),g.length===f)return g;for(var m=1;m<=v.length-1;m++)if(push$1(g,v[m]),g.length===f)return g;p=h=y}}return push$1(g,stringSlice$4(a,h)),g}]}),!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC,UNSUPPORTED_Y$1);var uncurryThis$3=functionUncurryThis,toObject=toObject$7,floor=Math.floor,charAt$1=uncurryThis$3("".charAt),replace$2=uncurryThis$3("".replace),stringSlice$3=uncurryThis$3("".slice),SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d{1,2})/g,getSubstitution$1=function(e,t,r,n,i,o){var a=r+e.length,s=n.length,u=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==i&&(i=toObject(i),u=SUBSTITUTION_SYMBOLS),replace$2(o,u,(function(o,u){var c;switch(charAt$1(u,0)){case"$":return"$";case"&":return e;case"`":return stringSlice$3(t,0,r);case"'":return stringSlice$3(t,a);case"<":c=i[stringSlice$3(u,1,-1)];break;default:var l=+u;if(0===l)return o;if(l>s){var d=floor(l/10);return 0===d?o:d<=s?void 0===n[d-1]?charAt$1(u,1):n[d-1]+charAt$1(u,1):o}c=n[l-1]}return void 0===c?"":c}))},apply$1=functionApply,call$8=functionCall,uncurryThis$2=functionUncurryThis,fixRegExpWellKnownSymbolLogic$1=fixRegexpWellKnownSymbolLogic,fails$4=fails$w,anObject$5=anObject$h,isCallable$5=isCallable$n,toIntegerOrInfinity=toIntegerOrInfinity$7,toLength$1=toLength$4,toString$3=toString$d,requireObjectCoercible$1=requireObjectCoercible$8,advanceStringIndex$1=advanceStringIndex$3,getMethod$3=getMethod$6,getSubstitution=getSubstitution$1,regExpExec$1=regexpExecAbstract,wellKnownSymbol$6=wellKnownSymbol$k,REPLACE=wellKnownSymbol$6("replace"),max=Math.max,min=Math.min,concat=uncurryThis$2([].concat),push=uncurryThis$2([].push),stringIndexOf$1=uncurryThis$2("".indexOf),stringSlice$2=uncurryThis$2("".slice),maybeToString=function(e){return void 0===e?e:String(e)},REPLACE_KEEPS_$0="$0"==="a".replace(/./,"$0"),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=!!/./[REPLACE]&&""===/./[REPLACE]("a","$0"),REPLACE_SUPPORTS_NAMED_GROUPS=!fails$4((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));fixRegExpWellKnownSymbolLogic$1("replace",(function(e,t,r){var n=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE?"$":"$0";return[function(e,r){var n=requireObjectCoercible$1(this),i=null==e?void 0:getMethod$3(e,REPLACE);return i?call$8(i,e,n,r):call$8(t,toString$3(n),e,r)},function(e,i){var o=anObject$5(this),a=toString$3(e);if("string"==typeof i&&-1===stringIndexOf$1(i,n)&&-1===stringIndexOf$1(i,"$<")){var s=r(t,o,a,i);if(s.done)return s.value}var u=isCallable$5(i);u||(i=toString$3(i));var c=o.global;if(c){var l=o.unicode;o.lastIndex=0}for(var d=[];;){var f=regExpExec$1(o,a);if(null===f)break;if(push(d,f),!c)break;""===toString$3(f[0])&&(o.lastIndex=advanceStringIndex$1(a,toLength$1(o.lastIndex),l))}for(var h="",p=0,g=0;g<d.length;g++){for(var y=toString$3((f=d[g])[0]),v=max(min(toIntegerOrInfinity(f.index),a.length),0),m=[],_=1;_<f.length;_++)push(m,maybeToString(f[_]));var b=f.groups;if(u){var A=concat([y],m,v,a);void 0!==b&&push(A,b);var E=toString$3(apply$1(i,void 0,A))}else E=getSubstitution(y,a,v,m,b,i);v>=p&&(h+=stringSlice$2(a,p,v)+E,p=v+y.length)}return h+stringSlice$2(a,p)}]}),!REPLACE_SUPPORTS_NAMED_GROUPS||!REPLACE_KEEPS_$0||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);var PROPER_FUNCTION_NAME=functionName.PROPER,fails$3=fails$w,whitespaces=whitespaces$4,non="​᠎",stringTrimForced=function(e){return fails$3((function(){return!!whitespaces[e]()||non[e]()!==non||PROPER_FUNCTION_NAME&&whitespaces[e].name!==e}))},$$b=_export,$trim=stringTrim.trim,forcedStringTrimMethod=stringTrimForced;$$b({target:"String",proto:!0,forced:forcedStringTrimMethod("trim")},{trim:function(){return $trim(this)}});var classof$1=classofRaw$1,global$a=global$w,engineIsNode="process"==classof$1(global$a.process),getBuiltIn$2=getBuiltIn$b,definePropertyModule=objectDefineProperty,wellKnownSymbol$5=wellKnownSymbol$k,DESCRIPTORS$2=descriptors,SPECIES$1=wellKnownSymbol$5("species"),setSpecies$2=function(e){var t=getBuiltIn$2(e),r=definePropertyModule.f;DESCRIPTORS$2&&t&&!t[SPECIES$1]&&r(t,SPECIES$1,{configurable:!0,get:function(){return this}})},isPrototypeOf$3=objectIsPrototypeOf,$TypeError$2=TypeError,anInstance$1=function(e,t){if(isPrototypeOf$3(t,e))return e;throw $TypeError$2("Incorrect invocation")},userAgent$2=engineUserAgent,engineIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent$2),global$9=global$w,apply=functionApply,bind$3=functionBindContext,isCallable$4=isCallable$n,hasOwn$2=hasOwnProperty_1,fails$2=fails$w,html=html$2,arraySlice=arraySlice$5,createElement=documentCreateElement$2,validateArgumentsLength=validateArgumentsLength$2,IS_IOS$1=engineIsIos,IS_NODE$2=engineIsNode,set=global$9.setImmediate,clear$1=global$9.clearImmediate,process$3=global$9.process,Dispatch=global$9.Dispatch,Function$1=global$9.Function,MessageChannel=global$9.MessageChannel,String$1=global$9.String,counter=0,queue$1={},ONREADYSTATECHANGE="onreadystatechange",location$1,defer,channel,port;try{location$1=global$9.location}catch(error){}var run=function(e){if(hasOwn$2(queue$1,e)){var t=queue$1[e];delete queue$1[e],t()}},runner=function(e){return function(){run(e)}},listener=function(e){run(e.data)},post=function(e){global$9.postMessage(String$1(e),location$1.protocol+"//"+location$1.host)};set&&clear$1||(set=function(e){validateArgumentsLength(arguments.length,1);var t=isCallable$4(e)?e:Function$1(e),r=arraySlice(arguments,1);return queue$1[++counter]=function(){apply(t,void 0,r)},defer(counter),counter},clear$1=function(e){delete queue$1[e]},IS_NODE$2?defer=function(e){process$3.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel&&!IS_IOS$1?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=bind$3(port.postMessage,port)):global$9.addEventListener&&isCallable$4(global$9.postMessage)&&!global$9.importScripts&&location$1&&"file:"!==location$1.protocol&&!fails$2(post)?(defer=post,global$9.addEventListener("message",listener,!1)):defer=ONREADYSTATECHANGE in createElement("script")?function(e){html.appendChild(createElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(e)}}:function(e){setTimeout(runner(e),0)});var task$1={set:set,clear:clear$1},userAgent$1=engineUserAgent,global$8=global$w,engineIsIosPebble=/ipad|iphone|ipod/i.test(userAgent$1)&&void 0!==global$8.Pebble,userAgent=engineUserAgent,engineIsWebosWebkit=/web0s(?!.*chrome)/i.test(userAgent),global$7=global$w,bind$2=functionBindContext,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,macrotask=task$1.set,IS_IOS=engineIsIos,IS_IOS_PEBBLE=engineIsIosPebble,IS_WEBOS_WEBKIT=engineIsWebosWebkit,IS_NODE$1=engineIsNode,MutationObserver$1=global$7.MutationObserver||global$7.WebKitMutationObserver,document$2=global$7.document,process$2=global$7.process,Promise$1=global$7.Promise,queueMicrotaskDescriptor=getOwnPropertyDescriptor(global$7,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify$1,toggle,node,promise,then;queueMicrotask||(flush=function(){var e,t;for(IS_NODE$1&&(e=process$2.domain)&&e.exit();head;){t=head.fn,head=head.next;try{t()}catch(error){throw head?notify$1():last=void 0,error}}last=void 0,e&&e.enter()},IS_IOS||IS_NODE$1||IS_WEBOS_WEBKIT||!MutationObserver$1||!document$2?!IS_IOS_PEBBLE&&Promise$1&&Promise$1.resolve?(promise=Promise$1.resolve(void 0),promise.constructor=Promise$1,then=bind$2(promise.then,promise),notify$1=function(){then(flush)}):IS_NODE$1?notify$1=function(){process$2.nextTick(flush)}:(macrotask=bind$2(macrotask,global$7),notify$1=function(){macrotask(flush)}):(toggle=!0,node=document$2.createTextNode(""),new MutationObserver$1(flush).observe(node,{characterData:!0}),notify$1=function(){node.data=toggle=!toggle}));var microtask$1=queueMicrotask||function(e){var t={fn:e,next:void 0};last&&(last.next=t),head||(head=t,notify$1()),last=t},global$6=global$w,hostReportErrors$1=function(e,t){var r=global$6.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},perform$3=function(e){try{return{error:!1,value:e()}}catch(error){return{error:!0,value:error}}},Queue$1=function(){this.head=null,this.tail=null};Queue$1.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var queue=Queue$1,global$5=global$w,promiseNativeConstructor=global$5.Promise,engineIsBrowser="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&"object"!=("undefined"==typeof Deno?"undefined":_typeof$3(Deno)),engineIsDeno="object"==("undefined"==typeof Deno?"undefined":_typeof$3(Deno))&&Deno&&"object"==_typeof$3(Deno.version),global$4=global$w,NativePromiseConstructor$3=promiseNativeConstructor,isCallable$3=isCallable$n,isForced$1=isForced_1,inspectSource=inspectSource$4,wellKnownSymbol$4=wellKnownSymbol$k,IS_BROWSER=engineIsBrowser,IS_DENO=engineIsDeno,V8_VERSION=engineV8Version;NativePromiseConstructor$3&&NativePromiseConstructor$3.prototype;var SPECIES=wellKnownSymbol$4("species"),SUBCLASSING=!1,NATIVE_PROMISE_REJECTION_EVENT$1=isCallable$3(global$4.PromiseRejectionEvent),FORCED_PROMISE_CONSTRUCTOR$5=isForced$1("Promise",(function(){var e=inspectSource(NativePromiseConstructor$3),t=e!==String(NativePromiseConstructor$3);if(!t&&66===V8_VERSION)return!0;if(V8_VERSION<51||!/native code/.test(e)){var r=new NativePromiseConstructor$3((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((r.constructor={})[SPECIES]=n,!(SUBCLASSING=r.then((function(){}))instanceof n))return!0}return!t&&(IS_BROWSER||IS_DENO)&&!NATIVE_PROMISE_REJECTION_EVENT$1})),promiseConstructorDetection={CONSTRUCTOR:FORCED_PROMISE_CONSTRUCTOR$5,REJECTION_EVENT:NATIVE_PROMISE_REJECTION_EVENT$1,SUBCLASSING:SUBCLASSING},newPromiseCapability$2={},aCallable$4=aCallable$7,PromiseCapability=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=aCallable$4(t),this.reject=aCallable$4(r)};newPromiseCapability$2.f=function(e){return new PromiseCapability(e)};var $$a=_export,IS_NODE=engineIsNode,global$3=global$w,call$7=functionCall,defineBuiltIn$2=defineBuiltIn$b,setPrototypeOf=objectSetPrototypeOf,setToStringTag=setToStringTag$2,setSpecies$1=setSpecies$2,aCallable$3=aCallable$7,isCallable$2=isCallable$n,isObject$5=isObject$g,anInstance=anInstance$1,speciesConstructor=speciesConstructor$2,task=task$1.set,microtask=microtask$1,hostReportErrors=hostReportErrors$1,perform$2=perform$3,Queue=queue,InternalStateModule=internalState,NativePromiseConstructor$2=promiseNativeConstructor,PromiseConstructorDetection=promiseConstructorDetection,newPromiseCapabilityModule$3=newPromiseCapability$2,PROMISE="Promise",FORCED_PROMISE_CONSTRUCTOR$4=PromiseConstructorDetection.CONSTRUCTOR,NATIVE_PROMISE_REJECTION_EVENT=PromiseConstructorDetection.REJECTION_EVENT,NATIVE_PROMISE_SUBCLASSING=PromiseConstructorDetection.SUBCLASSING,getInternalPromiseState=InternalStateModule.getterFor(PROMISE),setInternalState=InternalStateModule.set,NativePromisePrototype$1=NativePromiseConstructor$2&&NativePromiseConstructor$2.prototype,PromiseConstructor=NativePromiseConstructor$2,PromisePrototype=NativePromisePrototype$1,TypeError$1=global$3.TypeError,document$1=global$3.document,process$1=global$3.process,newPromiseCapability$1=newPromiseCapabilityModule$3.f,newGenericPromiseCapability=newPromiseCapability$1,DISPATCH_EVENT=!!(document$1&&document$1.createEvent&&global$3.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,nativeThen,isThenable=function(e){var t;return!(!isObject$5(e)||!isCallable$2(t=e.then))&&t},callReaction=function(e,t){var r,n,i,o=t.value,a=t.state==FULFILLED,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(t.rejection===UNHANDLED&&onHandleUnhandled(t),t.rejection=HANDLED),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(TypeError$1("Promise-chain cycle")):(n=isThenable(r))?call$7(n,r,u,c):u(r)):c(o)}catch(error){l&&!i&&l.exit(),c(error)}},notify=function(e,t){e.notified||(e.notified=!0,microtask((function(){for(var r,n=e.reactions;r=n.get();)callReaction(r,e);e.notified=!1,t&&!e.rejection&&onUnhandled(e)})))},dispatchEvent=function(e,t,r){var n,i;DISPATCH_EVENT?((n=document$1.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),global$3.dispatchEvent(n)):n={promise:t,reason:r},!NATIVE_PROMISE_REJECTION_EVENT&&(i=global$3["on"+e])?i(n):e===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",r)},onUnhandled=function(e){call$7(task,global$3,(function(){var t,r=e.facade,n=e.value;if(isUnhandled(e)&&(t=perform$2((function(){IS_NODE?process$1.emit("unhandledRejection",n,r):dispatchEvent(UNHANDLED_REJECTION,r,n)})),e.rejection=IS_NODE||isUnhandled(e)?UNHANDLED:HANDLED,t.error))throw t.value}))},isUnhandled=function(e){return e.rejection!==HANDLED&&!e.parent},onHandleUnhandled=function(e){call$7(task,global$3,(function(){var t=e.facade;IS_NODE?process$1.emit("rejectionHandled",t):dispatchEvent(REJECTION_HANDLED,t,e.value)}))},bind$1=function(e,t,r){return function(n){e(t,n,r)}},internalReject=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=REJECTED,notify(e,!0))},internalResolve=function e(t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===r)throw TypeError$1("Promise can't be resolved itself");var i=isThenable(r);i?microtask((function(){var n={done:!1};try{call$7(i,r,bind$1(e,n,t),bind$1(internalReject,n,t))}catch(error){internalReject(n,error,t)}})):(t.value=r,t.state=FULFILLED,notify(t,!1))}catch(error){internalReject({done:!1},error,t)}}};if(FORCED_PROMISE_CONSTRUCTOR$4&&(PromiseConstructor=function(e){anInstance(this,PromisePrototype),aCallable$3(e),call$7(Internal,this);var t=getInternalPromiseState(this);try{e(bind$1(internalResolve,t),bind$1(internalReject,t))}catch(error){internalReject(t,error)}},PromisePrototype=PromiseConstructor.prototype,Internal=function(e){setInternalState(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:new Queue,rejection:!1,state:PENDING,value:void 0})},Internal.prototype=defineBuiltIn$2(PromisePrototype,"then",(function(e,t){var r=getInternalPromiseState(this),n=newPromiseCapability$1(speciesConstructor(this,PromiseConstructor));return r.parent=!0,n.ok=!isCallable$2(e)||e,n.fail=isCallable$2(t)&&t,n.domain=IS_NODE?process$1.domain:void 0,r.state==PENDING?r.reactions.add(n):microtask((function(){callReaction(n,r)})),n.promise})),OwnPromiseCapability=function(){var e=new Internal,t=getInternalPromiseState(e);this.promise=e,this.resolve=bind$1(internalResolve,t),this.reject=bind$1(internalReject,t)},newPromiseCapabilityModule$3.f=newPromiseCapability$1=function(e){return e===PromiseConstructor||e===PromiseWrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)},isCallable$2(NativePromiseConstructor$2)&&NativePromisePrototype$1!==Object.prototype)){nativeThen=NativePromisePrototype$1.then,NATIVE_PROMISE_SUBCLASSING||defineBuiltIn$2(NativePromisePrototype$1,"then",(function(e,t){var r=this;return new PromiseConstructor((function(e,t){call$7(nativeThen,r,e,t)})).then(e,t)}),{unsafe:!0});try{delete NativePromisePrototype$1.constructor}catch(error){}setPrototypeOf&&setPrototypeOf(NativePromisePrototype$1,PromisePrototype)}$$a({global:!0,constructor:!0,wrap:!0,forced:FORCED_PROMISE_CONSTRUCTOR$4},{Promise:PromiseConstructor}),setToStringTag(PromiseConstructor,PROMISE,!1),setSpecies$1(PROMISE);var iterators={},wellKnownSymbol$3=wellKnownSymbol$k,Iterators$1=iterators,ITERATOR$2=wellKnownSymbol$3("iterator"),ArrayPrototype=Array.prototype,isArrayIteratorMethod$1=function(e){return void 0!==e&&(Iterators$1.Array===e||ArrayPrototype[ITERATOR$2]===e)},classof=classof$9,getMethod$2=getMethod$6,Iterators=iterators,wellKnownSymbol$2=wellKnownSymbol$k,ITERATOR$1=wellKnownSymbol$2("iterator"),getIteratorMethod$2=function(e){if(null!=e)return getMethod$2(e,ITERATOR$1)||getMethod$2(e,"@@iterator")||Iterators[classof(e)]},call$6=functionCall,aCallable$2=aCallable$7,anObject$4=anObject$h,tryToString$1=tryToString$6,getIteratorMethod$1=getIteratorMethod$2,$TypeError$1=TypeError,getIterator$1=function(e,t){var r=arguments.length<2?getIteratorMethod$1(e):t;if(aCallable$2(r))return anObject$4(call$6(r,e));throw $TypeError$1(tryToString$1(e)+" is not iterable")},call$5=functionCall,anObject$3=anObject$h,getMethod$1=getMethod$6,iteratorClose$1=function(e,t,r){var n,i;anObject$3(e);try{if(!(n=getMethod$1(e,"return"))){if("throw"===t)throw r;return r}n=call$5(n,e)}catch(error){i=!0,n=error}if("throw"===t)throw r;if(i)throw n;return anObject$3(n),r},bind=functionBindContext,call$4=functionCall,anObject$2=anObject$h,tryToString=tryToString$6,isArrayIteratorMethod=isArrayIteratorMethod$1,lengthOfArrayLike=lengthOfArrayLike$6,isPrototypeOf$2=objectIsPrototypeOf,getIterator=getIterator$1,getIteratorMethod=getIteratorMethod$2,iteratorClose=iteratorClose$1,$TypeError=TypeError,Result=function(e,t){this.stopped=e,this.result=t},ResultPrototype=Result.prototype,iterate$2=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),g=bind(t,l),y=function(e){return n&&iteratorClose(n,"normal",e),new Result(!0,e)},v=function(e){return d?(anObject$2(e),p?g(e[0],e[1],y):g(e[0],e[1])):p?g(e,y):g(e)};if(f)n=e.iterator;else if(h)n=e;else{if(!(i=getIteratorMethod(e)))throw $TypeError(tryToString(e)+" is not iterable");if(isArrayIteratorMethod(i)){for(o=0,a=lengthOfArrayLike(e);a>o;o++)if((s=v(e[o]))&&isPrototypeOf$2(ResultPrototype,s))return s;return new Result(!1)}n=getIterator(e,i)}for(u=f?e.next:n.next;!(c=call$4(u,n)).done;){try{s=v(c.value)}catch(error){iteratorClose(n,"throw",error)}if("object"==_typeof$3(s)&&s&&isPrototypeOf$2(ResultPrototype,s))return s}return new Result(!1)},wellKnownSymbol$1=wellKnownSymbol$k,ITERATOR=wellKnownSymbol$1("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR]=function(){return this},Array.from(iteratorWithReturn,(function(){throw 2}))}catch(error){}var checkCorrectnessOfIteration$1=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var r=!1;try{var n={};n[ITERATOR]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(error){}return r},NativePromiseConstructor$1=promiseNativeConstructor,checkCorrectnessOfIteration=checkCorrectnessOfIteration$1,FORCED_PROMISE_CONSTRUCTOR$3=promiseConstructorDetection.CONSTRUCTOR,promiseStaticsIncorrectIteration=FORCED_PROMISE_CONSTRUCTOR$3||!checkCorrectnessOfIteration((function(e){NativePromiseConstructor$1.all(e).then(void 0,(function(){}))})),$$9=_export,call$3=functionCall,aCallable$1=aCallable$7,newPromiseCapabilityModule$2=newPromiseCapability$2,perform$1=perform$3,iterate$1=iterate$2,PROMISE_STATICS_INCORRECT_ITERATION$1=promiseStaticsIncorrectIteration;$$9({target:"Promise",stat:!0,forced:PROMISE_STATICS_INCORRECT_ITERATION$1},{all:function(e){var t=this,r=newPromiseCapabilityModule$2.f(t),n=r.resolve,i=r.reject,o=perform$1((function(){var r=aCallable$1(t.resolve),o=[],a=0,s=1;iterate$1(e,(function(e){var u=a++,c=!1;s++,call$3(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise}});var $$8=_export,FORCED_PROMISE_CONSTRUCTOR$2=promiseConstructorDetection.CONSTRUCTOR,NativePromiseConstructor=promiseNativeConstructor,getBuiltIn$1=getBuiltIn$b,isCallable$1=isCallable$n,defineBuiltIn$1=defineBuiltIn$b,NativePromisePrototype=NativePromiseConstructor&&NativePromiseConstructor.prototype;if($$8({target:"Promise",proto:!0,forced:FORCED_PROMISE_CONSTRUCTOR$2,real:!0},{catch:function(e){return this.then(void 0,e)}}),isCallable$1(NativePromiseConstructor)){var method=getBuiltIn$1("Promise").prototype.catch;NativePromisePrototype.catch!==method&&defineBuiltIn$1(NativePromisePrototype,"catch",method,{unsafe:!0})}var $$7=_export,call$2=functionCall,aCallable=aCallable$7,newPromiseCapabilityModule$1=newPromiseCapability$2,perform=perform$3,iterate=iterate$2,PROMISE_STATICS_INCORRECT_ITERATION=promiseStaticsIncorrectIteration;$$7({target:"Promise",stat:!0,forced:PROMISE_STATICS_INCORRECT_ITERATION},{race:function(e){var t=this,r=newPromiseCapabilityModule$1.f(t),n=r.reject,i=perform((function(){var i=aCallable(t.resolve);iterate(e,(function(e){call$2(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var $$6=_export,call$1=functionCall,newPromiseCapabilityModule=newPromiseCapability$2,FORCED_PROMISE_CONSTRUCTOR$1=promiseConstructorDetection.CONSTRUCTOR;$$6({target:"Promise",stat:!0,forced:FORCED_PROMISE_CONSTRUCTOR$1},{reject:function(e){var t=newPromiseCapabilityModule.f(this);return call$1(t.reject,void 0,e),t.promise}});var anObject$1=anObject$h,isObject$4=isObject$g,newPromiseCapability=newPromiseCapability$2,promiseResolve$1=function(e,t){if(anObject$1(e),isObject$4(t)&&t.constructor===e)return t;var r=newPromiseCapability.f(e);return(0,r.resolve)(t),r.promise},$$5=_export,getBuiltIn=getBuiltIn$b,FORCED_PROMISE_CONSTRUCTOR=promiseConstructorDetection.CONSTRUCTOR,promiseResolve=promiseResolve$1;getBuiltIn("Promise"),$$5({target:"Promise",stat:!0,forced:FORCED_PROMISE_CONSTRUCTOR},{resolve:function(e){return promiseResolve(this,e)}});var call=functionCall,fixRegExpWellKnownSymbolLogic=fixRegexpWellKnownSymbolLogic,anObject=anObject$h,toLength=toLength$4,toString$2=toString$d,requireObjectCoercible=requireObjectCoercible$8,getMethod=getMethod$6,advanceStringIndex=advanceStringIndex$3,regExpExec=regexpExecAbstract;fixRegExpWellKnownSymbolLogic("match",(function(e,t,r){return[function(t){var r=requireObjectCoercible(this),n=null==t?void 0:getMethod(t,e);return n?call(n,t,r):new RegExp(t)[e](toString$2(r))},function(e){var n=anObject(this),i=toString$2(e),o=r(t,n,i);if(o.done)return o.value;if(!n.global)return regExpExec(n,i);var a=n.unicode;n.lastIndex=0;for(var s,u=[],c=0;null!==(s=regExpExec(n,i));){var l=toString$2(s[0]);u[c]=l,""===l&&(n.lastIndex=advanceStringIndex(i,toLength(n.lastIndex),a)),c++}return 0===c?null:u}]}));var $$4=_export,$some=arrayIteration.some,arrayMethodIsStrict=arrayMethodIsStrict$4,STRICT_METHOD=arrayMethodIsStrict("some");$$4({target:"Array",proto:!0,forced:!STRICT_METHOD},{some:function(e){return $some(this,e,arguments.length>1?arguments[1]:void 0)}});var defineProperty$1=objectDefineProperty.f,proxyAccessor$1=function(e,t,r){r in e||defineProperty$1(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},DESCRIPTORS$1=descriptors,global$2=global$w,uncurryThis$1=functionUncurryThis,isForced=isForced_1,inheritIfRequired=inheritIfRequired$2,createNonEnumerableProperty=createNonEnumerableProperty$5,getOwnPropertyNames$1=objectGetOwnPropertyNames.f,isPrototypeOf$1=objectIsPrototypeOf,isRegExp=isRegexp,toString$1=toString$d,getRegExpFlags=regexpGetFlags,stickyHelpers=regexpStickyHelpers,proxyAccessor=proxyAccessor$1,defineBuiltIn=defineBuiltIn$b,fails$1=fails$w,hasOwn$1=hasOwnProperty_1,enforceInternalState=internalState.enforce,setSpecies=setSpecies$2,wellKnownSymbol=wellKnownSymbol$k,UNSUPPORTED_DOT_ALL=regexpUnsupportedDotAll,UNSUPPORTED_NCG=regexpUnsupportedNcg,MATCH=wellKnownSymbol("match"),NativeRegExp=global$2.RegExp,RegExpPrototype=NativeRegExp.prototype,SyntaxError$1=global$2.SyntaxError,exec=uncurryThis$1(RegExpPrototype.exec),charAt=uncurryThis$1("".charAt),replace$1=uncurryThis$1("".replace),stringIndexOf=uncurryThis$1("".indexOf),stringSlice$1=uncurryThis$1("".slice),IS_NCG=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,re1=/a/g,re2=/a/g,CORRECT_NEW=new NativeRegExp(re1)!==re1,MISSED_STICKY=stickyHelpers.MISSED_STICKY,UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y,BASE_FORCED=DESCRIPTORS$1&&(!CORRECT_NEW||MISSED_STICKY||UNSUPPORTED_DOT_ALL||UNSUPPORTED_NCG||fails$1((function(){return re2[MATCH]=!1,NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||"/a/i"!=NativeRegExp(re1,"i")}))),handleDotAll=function(e){for(var t,r=e.length,n=0,i="",o=!1;n<=r;n++)"\\"!==(t=charAt(e,n))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+charAt(e,++n);return i},handleNCG=function(e){for(var t,r=e.length,n=0,i="",o=[],a={},s=!1,u=!1,c=0,l="";n<=r;n++){if("\\"===(t=charAt(e,n)))t+=charAt(e,++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:exec(IS_NCG,stringSlice$1(e,n+1))&&(n+=2,u=!0),i+=t,c++;continue;case">"===t&&u:if(""===l||hasOwn$1(a,l))throw new SyntaxError$1("Invalid capture group name");a[l]=!0,o[o.length]=[l,c],u=!1,l="";continue}u?l+=t:i+=t}return[i,o]};if(isForced("RegExp",BASE_FORCED)){for(var RegExpWrapper=function(e,t){var r,n,i,o,a,s,u=isPrototypeOf$1(RegExpPrototype,this),c=isRegExp(e),l=void 0===t,d=[],f=e;if(!u&&c&&l&&e.constructor===RegExpWrapper)return e;if((c||isPrototypeOf$1(RegExpPrototype,e))&&(e=e.source,l&&(t=getRegExpFlags(f))),e=void 0===e?"":toString$1(e),t=void 0===t?"":toString$1(t),f=e,UNSUPPORTED_DOT_ALL&&"dotAll"in re1&&(n=!!t&&stringIndexOf(t,"s")>-1)&&(t=replace$1(t,/s/g,"")),r=t,MISSED_STICKY&&"sticky"in re1&&(i=!!t&&stringIndexOf(t,"y")>-1)&&UNSUPPORTED_Y&&(t=replace$1(t,/y/g,"")),UNSUPPORTED_NCG&&(e=(o=handleNCG(e))[0],d=o[1]),a=inheritIfRequired(NativeRegExp(e,t),u?this:RegExpPrototype,RegExpWrapper),(n||i||d.length)&&(s=enforceInternalState(a),n&&(s.dotAll=!0,s.raw=RegExpWrapper(handleDotAll(e),r)),i&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{createNonEnumerableProperty(a,"source",""===f?"(?:)":f)}catch(error){}return a},keys=getOwnPropertyNames$1(NativeRegExp),index$2=0;keys.length>index$2;)proxyAccessor(RegExpWrapper,NativeRegExp,keys[index$2++]);RegExpPrototype.constructor=RegExpWrapper,RegExpWrapper.prototype=RegExpPrototype,defineBuiltIn(global$2,"RegExp",RegExpWrapper,{constructor:!0})}setSpecies("RegExp");var DEBUG$1="undefined"!=typeof window&&window.location.href.indexOf("loggerdebug")>-1;function computeWatchDur(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0,r=0;r<e.length;r++)isNaN(Number(e[r].end))||isNaN(Number(e[r].begin))||e[r].begin<0||e[r].end<0||e[r].end<e[r].begin||(t+=e[r].end-e[r].begin);return t=parseInt(1e3*t,10)}function getHostFromUrl(e){if(null==e||""===e||"string"!=typeof e)return"";var t=e.split("/"),r="";return t.length>3&&t[2]&&(r=t[2]),r}function generateSessionId(t){var r=(new Date).getTime();try{t=parseInt(t)}catch(e){t=0}return r+=t,window.performance&&"function"==typeof window.performance.now&&(r+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"===e?t:3&t|8).toString(16)}))}function isType(e){return function(t){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")}}function getResponseHeaders(e){var t={};if(e instanceof window.XMLHttpRequest)try{e.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift(),i=r.join(": ");t[n]=i}))}catch(error){}return t}function log(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];DEBUG$1&&(t=console).log.apply(t,["[logger]",e].concat(n))}function nowTime(){try{return Math.round(window.performance.now())}catch(error){return(new Date).getTime()}}function curTimestamp(){return(new Date).getTime()}function formatData(e,t){var r={ext:e.ext||{},data:{}};return Object.keys(e).map((function(n){t[n]?r.data[t[n]]=e[n]:"ext"!==n&&(r.ext[n]=e[n])})),r}function getXhr(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,i){try{t||i(new Error("url is undefined"));var o=0,a=0,s={},u=new window.XMLHttpRequest;u.open("get",t),u.onreadystatechange=function(){2===u.readyState&&(s.headers=getResponseHeaders(u),s.connectTime=nowTime()-a,s.status=u.status,s.statusText=u.statusText,o=nowTime()),1===u.readyState&&(a=nowTime())},u.onload=function(){n(s)},u.onprogress=function(e){var t,r=nowTime()-o;r<5&&(r=nowTime()-a),t=parseInt(e.loaded/1e3/(r/1e3),10),s.speed=t,s.costTime=r},u.onerror=function(e){i(e)},u.ontimeout=function(){s.status||(s.status=-2),n(s)},u.onabort=function(){n(s)},u.responseType="arraybuffer",u.timeout=r.timeout||1e4,u.setRequestHeader("Range","bytes=".concat(r.range||"0-1048576")),u.send()}catch(e){i(e)}}))}function checkVideoSrcIsEmpty(e){return!e||window.location.href.indexOf(e)>-1}var KEYMAP={x_response_sinfo:"x-response-sinfo",x_response_cache:"x-response-cache",x_response_cinfo:"x-response-cinfo"};function transformHeader(e){if(!e)return{};var t={};return Object.keys(KEYMAP).map((function(r){if(e[r]||"string"!=typeof KEYMAP[r]){if(!e[r]&&KEYMAP[r]instanceof Array){var n=KEYMAP[r].filter((function(t){return void 0!==e[t]}));n.length>0?t[r]=e[n[0]]:t[r]=""}}else t[r]=e[KEYMAP[r]]||""})),t}function appendData(e,t){return e&&("string"==typeof t||"number"==typeof t)?e+""+t:t}function typeOf(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}function parseTempData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object.keys(t).map((function(n){e[n]="append"===r?appendData(e[n],t[n]):t[n]})),e}function hasClass$1(t,r){if(!t||!r)return!1;try{return Array.prototype.some.call(t.classList,(function(e){return e===r}))}catch(e){var n=t.className&&"object"===_typeof(t.className)?t.getAttribute("class"):t.className;return n&&!!n.match(new RegExp("(\\s|^)"+r+"(\\s|$)"))}}function formatDefinition(e){return"String"===typeOf(e)?e.replace("P","p"):e?"Number"===typeOf(e)?"".concat(e):void 0:""}function toJsonString(t){try{return JSON.stringify(t)}catch(e){return""}}var ENTRIES=[],MAX_COUNT=30;function findPerformanceInfo(t){var r={};try{var n=function(){t=t.replace(/^http:|^https:/,"");for(var e=ENTRIES||[],n=function(n){if(e[n].name.replace(/^http:|^https:/,"")===t)return["domainLookupEnd","domainLookupStart","startTime","requestStart","responseEnd","responseStart","connectStart","connectEnd","fetchStart"].map((function(t){r[t]=Math.round(e[n][t])})),r.url=e[n].name,r.duration=Math.round(e[n].duration),r.domainDuration=r.domainLookupEnd-r.domainLookupStart,r.connectDuration=r.connectEnd-r.connectStart,"break"},i=e.length-1;i>=0;i--){if("break"===n(i))break}return{v:r}}();if("object"===_typeof(n))return n.v}catch(e){return r}}function addPerformaceObserver(){try{new window.PerformanceObserver((function(e,t){var r=e.getEntriesByType("resource");ENTRIES.length>MAX_COUNT&&ENTRIES.splice(0,ENTRIES.length-MAX_COUNT);for(var n=0;n<r.length;n++)ENTRIES.push(r[n])})).observe({entryTypes:["resource"]})}catch(e){console.warn("PerformanceObserver not support",e)}}"undefined"!=typeof window&&addPerformaceObserver();var isSupport=_isLocalStorageUsable();function probeSupport(){try{return"undefined"!=typeof localStorage&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch(e){return!1}}function checkIfLocalStorageThrows(){var t="_localstorage_support_test";try{return window.localStorage.setItem(t,!0),window.localStorage.removeItem(t),!1}catch(e){return!0}}function _isLocalStorageUsable(){return probeSupport()&&!checkIfLocalStorageThrows()}var Strorage=isSupport?window.localStorage:{},LOGKEY="__xgplayerlogkey",LOCAL_LOG={set:function(e){try{var t=this.get();t.push(e),Strorage.setItem(LOGKEY,JSON.stringify(t))}catch(error){}},get:function(){try{var e=Strorage.getItem(LOGKEY);return e=e?JSON.parse(e):[]}catch(error){return[]}},remove:function(){try{Strorage.removeItem(LOGKEY)}catch(error){}},clear:function(){try{Strorage.clear()}catch(error){}}},$$3=_export,DESCRIPTORS=descriptors,global$1=global$w,uncurryThis=functionUncurryThis,hasOwn=hasOwnProperty_1,isCallable=isCallable$n,isPrototypeOf=objectIsPrototypeOf,toString=toString$d,defineProperty=objectDefineProperty.f,copyConstructorProperties=copyConstructorProperties$2,NativeSymbol=global$1.Symbol,SymbolPrototype=NativeSymbol&&NativeSymbol.prototype;if(DESCRIPTORS&&isCallable(NativeSymbol)&&(!("description"in SymbolPrototype)||void 0!==NativeSymbol().description)){var EmptyStringDescriptionStore={},SymbolWrapper=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:toString(arguments[0]),t=isPrototypeOf(SymbolPrototype,this)?new NativeSymbol(e):void 0===e?NativeSymbol():NativeSymbol(e);return""===e&&(EmptyStringDescriptionStore[t]=!0),t};copyConstructorProperties(SymbolWrapper,NativeSymbol),SymbolWrapper.prototype=SymbolPrototype,SymbolPrototype.constructor=SymbolWrapper;var NATIVE_SYMBOL="Symbol(test)"==String(NativeSymbol("test")),symbolToString=uncurryThis(SymbolPrototype.toString),symbolValueOf=uncurryThis(SymbolPrototype.valueOf),regexp=/^Symbol\((.*)\)[^)]+$/,replace=uncurryThis("".replace),stringSlice=uncurryThis("".slice);defineProperty(SymbolPrototype,"description",{configurable:!0,get:function(){var e=symbolValueOf(this),t=symbolToString(e);if(hasOwn(EmptyStringDescriptionStore,e))return"";var r=NATIVE_SYMBOL?stringSlice(t,7,-1):replace(t,regexp,"$1");return""===r?void 0:r}}),$$3({global:!0,constructor:!0,forced:!0},{Symbol:SymbolWrapper})}var RegMap=[{key:"QQBrowser",reg:/(qqbrowser)\/([\d.]+)/},{key:"QIHU360EE",reg:/qihu 360ee/},{key:"QIHU360SE",reg:/qihu 360se/},{key:"2345Explorer",reg:/(2345explorer)\/([\d.]+)/},{key:"Sogou",reg:/(metasr)/},{key:"Wexin",reg:/(micromessenger)\/([\d.]+)/},{key:"Openlanguage",reg:/(openlanguage)\/([\d.]+)/},{key:"NewsArticle",reg:/(newsarticle)\/([\d.]+)/},{key:"VideoArticle",reg:/(videoarticle)\/([\d.]+)/},{key:"Hotsoon",reg:/(live_stream)_([\d.]+)/},{key:"Aweme",reg:/(aweme)_([\d.]+)/},{key:"Lark",reg:/(lark)\/([\d.]+)/},{key:"PlayStation",reg:/(playstation)/},{key:"BingPreview",reg:/(bingpreview)\/([\d.]+)/},{key:"Baiduspider",reg:/(baiduspider-render)\/([\d.]+)/},{key:"YandexBot",reg:/(yandexbot)\/([\d.]+)/},{key:"Chrome",reg:/(chrome)\/([\d.]+)/},{key:"Safari",reg:/(version)\/([\d.]+)\s*(safari)/}],IERegMap=[{key:"Trident",reg:/(rv:)([\d.]+)/},{key:"Trident",reg:/(msie)\s*([\d.]+)/}];function isSupportMP4(){var e=document.createElement("video"),t={isSupport:!1,mime:""};return"function"==typeof e.canPlayType?(["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"].map((function(r){"probably"===e.canPlayType('video/mp4; codecs="'.concat(r,'"'))&&(t.isSupport=!0,t.mime+="||".concat(r))})),t):(e=null,t)}var SPIDER_UA=["Baiduspider","YandexBot"];function checkIsSpider(e,t){var r=!1;return SPIDER_UA.map((function(t){t===e&&(r=!0)})),/(\+http|; http|\(http):\/\/([\w.]+\/?)\S*/.test(t)&&(r=!0),r}function detect(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=e.toLocaleLowerCase();var t=/(iphone)/.test(e)||/(ipad)/.test(e),r=/(android)/.test(e),n=/(windows phone)/.test(e),i=t||r||n,o={isIOS:t,isAndroid:r,isMobile:i,isPC:!i,isPad:/(ipad)/.test(e)},a=isSupportMP4();o.isSupportMP4=a.isSupport,o.mime=a.mime;var s="",u=0,c=[],l=RegMap;/trident/.test(e)&&(l=IERegMap);for(var d=0;d<l.length;d++)if(c=l[d].reg.exec(e)){s=l[d].key,u=c.length>2?c[2]:"";break}if(s)o["is".concat(s)]=!0,o.name=s,o.appVersion=u;else{var f=checkIs360();f&&(o.name="360EE")}if(o.name&&"Trident"!==o.name){var h=/(trident)/.exec(e);h&&(o.name=o.name?"".concat(o.name,"_Trident"):"Trident")}return o.isSpider=checkIsSpider(o.name),o}function checkIs360(){var e=navigator.mimeTypes;if(e){for(var t=0;t<e.length;t++){if(e[t].type&&e[t].type.indexOf("360")>-1)return!0;if(e[t].type&&e[t].type.indexOf("application/vnd.chromium.remoting-viewer")>-1)return!0;if(e[t].description&&e[t].description.indexOf("360")>-1)return!0}return!1}}var Browser="undefined"!=typeof navigator&&detect(navigator.userAgent),defaultConfig={range:"0-1048576",timer:6e4,timeout:15e3},SpeedCheckTask=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),Object.keys(defaultConfig).map((function(e){void 0!==t[e]&&null!==t[e]||(t[e]=defaultConfig[e])})),this.options=t,this._headers={},this.intervalId=null,this.ishangUp=!1,this._data={contentLength:0,statusText:"",status:-1,speed:0,costTime:0,connectTime:0,contentType:""},this.url=[]}return _createClass(e,[{key:"setData",value:function(e,t){var r=this;if(Object.keys(e).map((function(t){"headers"!==t&&(r._data[t]=e[t])})),e.headers&&Object.keys(e.headers).length>0){this._headers=transformHeader(e.headers),e.headers["content-type"]&&(this._data.contentType=e.headers["content-type"]);var n=(e.headers["content-range"]||"").split("/");n&&n.length>1&&(this._data.contentLength=parseInt(n[1]))}}},{key:"contentLength",get:function(){return this._data.length||0}},{key:"trigger",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"start",n=this.options;this.url=e,!this.url||"start"!==r&&(this.ishangUp||this.intervalId)?log("task>>cant`t trigger url",this.ishangUp,this.intervalId):(log("task>>trigger url ",e),this.ishangUp=!0,this.intervalId&&this.clear(),this.intervalId=setTimeout((function(){t.clear()}),"start"===r?500:n.timer),getXhr(this.url,{range:"start"===r?"0-1024":n.range,timeout:n.timeout}).then((function(e){log("getXhr>>check result ",e),t.setData(e||{}),t.ishangUp=!1})).catch((function(e){log("getXhr>>error ",e),t.ishangUp=!1,t._data.status=-1})))}},{key:"url",get:function(){return this.options.url},set:function(e){e&&(this.options.url=e)}},{key:"serverIp",get:function(){return this._headers.x_response_sinfo||""}},{key:"headers",get:function(){return this._headers||{}}},{key:"status",get:function(){return this._data.status||-1}},{key:"speed",get:function(){return this._data.speed}},{key:"clear",value:function(){clearTimeout(this.intervalId),this.intervalId=null}}]),e}(),version="0.11.8";function ownKeys$3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$3(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$3(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}log("logger version is ".concat(version));var isObject$3=isType("Object"),REPORT_EVENTS={ONE_PLAY:"videoplayer_oneplay",ONE_OPERA:"videoplayer_oneopera",ONE_ERROR:"videoplayer_oneerror",ONE_EVENT:"videoplayer_oneevent",ONE_TEMP:"videoplayer_onetemp"},ERROR_TYPES={data:1e3,runtime:1002,parse:1004,network:1003,no_error_handler:9997,custom_error:9998,other:9999,notSupport:1005},ERROR_CODES={1:-499991,2:-499992,3:-499993,4:-499994,5:-499995},PLAYBACK_STATE={STOP:0,PLAYING:1,PAUSE:2,ERROR:3,LOADING:4},LOAD_STATES={UNKNOWN:0,PLAYABLE:1,STALLED:2,ERROR:3},ENDED_TYPE={ERROR:1,NEXT:2,ENDED:3,UNLOAD:4,DESTROY:5,PLAY_CATCH:6},LOGTYPES={RETRY:"error_retry",ONEERROR:"oneerror",ONEEVENT:"oneevent",ONETEMP:"onetemp"},CACHE_FILE_TYPE={NO_CACHE:0,CACHED:1},TEA_ID=1300,LS_KEY="__tea_cache_tokens_".concat(TEA_ID),DEFAULT_INTERVAL=-1,MAX_TIME=432e5,MAX_COST=36e5,COMMON_KEYS=["vtype","tag","subtag","codec_type","device_type"],MIN_WAITIONG=200,MAX_STALL_TIME=6e4,AB_SDK_VERSION="",Collector=null,XGPlayerAppLogger=function(){function t(r,n){var i=this;if(_classCallCheck(this,t),_defineProperty(this,"initializeUrlLog",(function(e){var t=e||"";"String"!==typeOf(t)&&(t=""),i.urlLog={initial_url:t,initial_host:getHostFromUrl(t),initial_ip:""}})),_defineProperty(this,"onMediaFormatError",(function(e){i.onOneEvent({end_type:(e.error_type||"")+"Error"})})),_defineProperty(this,"onDrmTypeChange",(function(e){i.addIfExist("drm_type",{drm_type:e},i._options)})),_defineProperty(this,"onReplayBtnClick",(function(){i.resetLoggerParams()})),_defineProperty(this,"onBeforeDefinitionChange",(function(){i.resLogs.ldst=nowTime(),i._endType="switch"})),_defineProperty(this,"onDefinitionChange",(function(e){var t=e.from,r=e.to;i.changeResolution(t,r,i.resLogs.ldst,"switch"),log("onDefinitionChange from:".concat(t,", to:").concat(r))})),_defineProperty(this,"onDefiChangeSuccess",(function(){log("onDefinitionChangeSuccess"),i.updateVideoSize(),i.triggerTask("start")})),_defineProperty(this,"onAbrChange",(function(e){var t=e.prev,r=e.cur,n=e.abrInfo;if(i.player.abrInstance){var o=i.player.abrInstance.eventInfo;log("abrChange",o),o.last_definition=t,o.now_definition=r,i.abrInfo.abr_event_info.video_switch.push(o),i.changeResolution(t,r,nowTime(),"abr_switch",n)}})),_defineProperty(this,"onAbrPrestallEnd",(function(e){i.abrInfo.abr_user_info.cancel_abr=e?1:0})),_defineProperty(this,"onTimeUpdate",(function(){var e=i.playlogs,t=i.resLogs,r=i.player;if(i.errorLog.try_err_c=0,e.vt||1!==i.startStep||(e.vt=curTimestamp(),log("onTimeUpdate: first frame inited","currentTime11:".concat(r.currentTime," vt-pt:").concat(e.vt-e.pt," vt-nt:").concat(e.vt-e.nt," vt-rt:").concat(e.vt-e.rt)),i.startStep=2),!t.initial_resolution){var n=r.currentDefitionFromPlayer&&r.currentDefitionFromPlayer.definition?r.currentDefitionFromPlayer.definition:r.config.defaultDefinition||r.video.videoHeight+"p"||"";n=formatDefinition(n),t.initial_resolution=n}t.final_resolution||(t.final_resolution=t.initial_resolution);var o=e.played.length;o<1?e.played.push({begin:r.currentTime,end:-1}):e.played[o-1].end=r.currentTime;var a=t.played.length;a<1?t.played.push({begin:r.currentTime,end:-1}):t.played[a-1].end=r.currentTime,i.lastVideoTime=r.currentTime||0,i.updateCurBuffer()})),_defineProperty(this,"onCanplay",(function(){log("onCanplay","this.startStep:".concat(i.startStep," ").concat(curTimestamp())),i.setVt()})),_defineProperty(this,"onLoadeddata",(function(){log("onLoadeddata","this.startStep:".concat(i.startStep," ").concat(curTimestamp())),i.setVt(),i.updateVideoSize()})),_defineProperty(this,"onLoadStart",(function(){var e=checkVideoSrcIsEmpty(i.player.currentSrc);i.triggerTask("start"),log("onLoadStart","this.startStep:".concat(i.startStep," ").concat(curTimestamp()," isSrcEmpty:").concat(e," player.src:").concat(i.player.src)),0!==i.startStep||e||"visible"!==document.visibilityState||i.setPt()})),_defineProperty(this,"onDashStateChange",(function(e){log("onDashStateChange","this.startStep:".concat(i.startStep," ").concat(nowTime()," state:").concat(e));var t=i.playlogs;if(i.startStep<2)switch(e){case"player_start":t.dash_pst=nowTime();break;case"wasm_start":t.dash_wst=nowTime();break;case"wasm_ready":t.dash_wrt=nowTime();break;case"init_finished":t.dash_ift=nowTime();break;case"core_start":t.dash_cst=nowTime();break;case"start_play":t.dash_spt=nowTime()}})),_defineProperty(this,"onMp4StateChange",(function(e){var t=e.state;(i.exInfo.states.length>10||"player_start"===t)&&(i.exInfo.states=[]),i.exInfo.states.push(e)})),_defineProperty(this,"onBufferedChange",(function(){var e=i.player.video&&i.player.video.buffered;if(e){var t=e.length;t>0&&e.end(t-1)+1>i.player.duration&&(i.bft=curTimestamp())}})),_defineProperty(this,"onPlayerInited",(function(){log("player init"),i._playerCreatedTime=curTimestamp(),i.playlogs.rt=curTimestamp()})),_defineProperty(this,"onNotAutoPlay",(function(){log("onNotAutoPlay","autoplay:".concat(i.isAutoplay)),0===i.isAutoplay?i.isAutoplay=2:1===i.isAutoplay&&(i.isAutoplay=3)})),_defineProperty(this,"onDashError",(function(e){e=e||{};var t=i.errorLog;t.last_errors.push(e.errorCode),t.accu_errc++,i.onOneError({errorType:e.errorTypeCode,code:e.errorCode,url:e.url||"",headers:e.headers||{}},0)})),_defineProperty(this,"onPlayerError",(function(e){e=e||{};var t=i.errorLog,r=i.player,n=i.line_app_id;if(log("onPlayerError","this.player.type:".concat(i.player.type," this.player.replayRunning:").concat(i.player.replayRunning," isSupportMP4:").concat(Browser.isSupportMP4," isPC:").concat(Browser.isPC)),log("onPlayerError",e),i.load_state=LOAD_STATES.ERROR,i._endType="error",i.suspendWaitingStatus("onPlayerError"),"dash"!==r.type||!r.replayRunning){if(e.url||(e.url=i.player.currentSrc),(1768===n||9999===n)&&Browser.isPC&&!Browser.isSupportMP4||Browser.isSpider)return t.errc=ERROR_CODES[5],t.errt=ERROR_TYPES.notSupport,i.onOneError({errorType:t.errt,code:t.errc,url:e.url,headers:e.headers||{}},0),void(i._isOnePlayReport=!0);t.errt=e.errorTypeCode||(e.errorType&&ERROR_TYPES[e.errorType]?ERROR_TYPES[e.errorType]:9999),e.errorCode?t.errc=e.errorCode>0&&ERROR_CODES[e.errorCode]?ERROR_CODES[e.errorCode]:e.errorCode:e.code&&(t.errc=e.code>0&&ERROR_CODES[e.code]?ERROR_CODES[e.code]:e.code),t.last_errors.push(t.errc),0===t.fir_errc&&(t.fir_errc=t.errc),i.onOnePlay(ENDED_TYPE.ERROR),i.onOneTemp(ENDED_TYPE.ERROR),i.sendDegradeLog("playCatch_end",i.playlogs.degrade),i.onOneError({errorType:t.errt,code:t.errc,url:e.url,headers:e.headers||{}}),i.sendEventsQueue()}})),_defineProperty(this,"onPlayInterfaceInfo",(function(e){log("onPlayInterfaceInfo",e);var t=i.errorLog,r=i.apiLog,n=i.playlogs;if(e&&Object.keys(e).map((function(t){"code"===t?r.vsc=e[t]:"message"===t?r.vsc_message=e.message||"success，视频可正常播放":r[t]=e[t]})),n.at=e.timestamep||(new Date).getTime(),(!e.error||-9988!==e.error.errc)&&(r.vsc=e.code||10,r.vsc_message=e.message||"success，视频可正常播放",e.error)){var o=e.error;t.errt=1e3,t.errc=o.errc||-9998,t.last_errors.push(o.errc||-9998),0===t.fir_errc&&(t.fir_errc=o.errc||-9998),t.accu_errc++,1===t.accu_errc&&(t.fir_errt=nowTime()),i.onOneError({errorType:1e3,code:o.errc||-9998,url:"",headers:{}})}})),_defineProperty(this,"onProgressEvent",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i.netLog;if(e.speed){var r=e.speed>1e6?Math.floor(e.speed/1e3):e.speed;t.downloadSpeed=r,t.totalSpeed+=r,t.rqCount++}"oversize"!==e.type&&t.requestCount++,e.connectTime&&(t.connectCost=e.connectTime);var n=t.rqCount<7?100:e.costTime>=5e3?20:10;if(!("success"===e.type&&parseInt(100*Math.random(),10)<=n)){var o=findPerformanceInfo(e.cdnUrl),a=e.xhr||{},s=e.type?"progress_".concat(e.type):"progress",u=e.headers;u||(u=getResponseHeaders(a));var c=_objectSpread$3(_objectSpread$3({},u=transformHeader(u)),{},{download_speed:t.downloadSpeed,connect_cost:t.connectCost,c_dur:o.connectDuration||0,d_dur:o.domainDuration||0,r_dur:o.duration||0,rqtt:(new Date).getTime(),x_cache:u.x_response_cache||"",server_ip:u.x_response_sinfo});e.status?t.status=e.status:a&&a instanceof window.XMLHttpRequest&&(t.status=a.status||0),c.status=t.status;var l=e.cdnUrl||e.url;"error"===e.type&&i.merror.cdn.push(_objectSpread$3(_objectSpread$3({costTime:e.costTime,cur_play_pos:e.pos,cdn_url:l,cdn_host:getHostFromUrl(l)},c),u)),i.onOneEvent({costTime:e.costTime,vid:e.vid,end_type:s,cur_play_pos:e.pos,cdn_url:l,cdn_host:getHostFromUrl(l)},c,"error"===e.type?0:2)}})),_defineProperty(this,"onNext",(function(e){if(log("onNext:startStep:",i.startStep),i.startStep>0){if(i._reportInvalidVV(ENDED_TYPE.NEXT))return;i.onOnePlay(ENDED_TYPE.NEXT),i.onOneTemp(ENDED_TYPE.NEXT),i.sendEventsQueue()}i.vtype=null,i.playlogs.lc=0,i.resetLoggerParams()})),_defineProperty(this,"onNextEnded",(function(){var e=i.player,t=i.resLogs,r=formatDefinition(e.config.defaultDefinition||"");t.initial_resolution=r,t.final_resolution=r})),_defineProperty(this,"onXgLogWaiting",(function(e){var t=i.playlogs,r=i.resLogs,n=i.stall;if(i._options.checkByInnerLog&&0===e.type){log("onXgLogWaiting",e);var o=e.endType,a=e.costTime,s=e.start,u={download_speed:i.mp4Speed,avg_speed:i.mp4RealSpeed,mse_op:i.mp4MseOpLength,mp4_load_range:i.mp4LoadSegmentTimeRange,bitrate:i.curBitrate};if("waitingStart"===e.eventType)return i.onOneEvent({costTime:a,end_type:"waitstart"},u,2),void i.appendStallInfo("start",s);if("waitingEnd"===e.eventType){var c=nowTime();log("onXgLogWaiting>>".concat(o,"|costTime:").concat(a,"  vt:").concat(t.vt)),i.appendStallInfo("end",c,o),t.bc++,i.checkInBuffer(i.player.currentTime)?(t.de_bu_acu_t+=a,t.dbc++):(t.nbc++,t.n_bu_acu_t+=a),r.bc++,t.bu_acu_t+=a,r.bu_acu_t+=a,n.stall_end=c,n.stall_last_interval=n.stall_end-n.stall_start,n.stall_acc_time+=n.stall_last_interval,1===n.sc&&(n.first_buf_endt=c),i.onOneEvent({costTime:a,end_type:"waitend"},u,2)}}})),_defineProperty(this,"onSeeking",(function(){if(!checkVideoSrcIsEmpty(i.player.src)){var e=i.resLogs,t=i.playlogs,r=i.player,n=i.seekLog;log("onSeeking","currentTime:".concat(r.currentTime)),0===i.startStep&&i.setPt(),i.suspendWaitingStatus("seek"),i.isSeeking&&i.suspendSeekStatus("seek",!1),i.isSeeking=!0,t.played.push({begin:i.player.currentTime,end:-1}),e.played.push({begin:i.player.currentTime,end:-1}),n.lastSeekStartTime=nowTime(),n.seekBefore=i.lastVideoTime.toString(),n.intervalId=setTimeout((function(){i.isSeeking&&i.suspendSeekStatus("seekTimeout",!0)}),MAX_STALL_TIME)}})),_defineProperty(this,"onSeeked",(function(){checkVideoSrcIsEmpty(i.player.src)||i.isSeeking&&i.suspendSeekStatus("seeked",!0)})),_defineProperty(this,"onPlaying",(function(){i.suspendWaitingStatus("play"),i.load_state=LOAD_STATES.PLAYABLE;var e=nowTime();i.pauseLog.isPausing&&(i.pauseLog.isPausing=!1,i.pauseLog.pause_acu_t+=e-i.pauseLog.pause_start)})),_defineProperty(this,"onPlayCatch",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{errorType:"",errorTypeCode:0,errorCode:0,url:"",headers:{},status:0};if(log("onPlayCatch",e,t),e){var r=i.errorLog,n=i.playlogs,o=i.merror;o.playCatch.push(_objectSpread$3({errc:t.errorCode,errt:t.errorType},t.headers)),i.setBr("playcatch"),r.accu_errc++,r.try_err_c++,r.fir_errc=t.errorCode,t.errorCode&&r.last_errors.push(t.errorCode),i.suspendWaitingStatus("playcatch"),i.sendDegradeLog("playCatch",n.degrade,{cdn_url:t.url}),"mp42dash"===e?i.vtype="DASH_2":"dash2mp4"===e?i.vtype="MP4_2":"dash1mp4"===e&&(i.vtype="MP4_1"),n.degrade=e,i.onOneError({errorType:t.errorTypeCode,code:t.errorCode,url:t.url||"",status:t.httpCode||t.status,headers:t.headers||{},vid:t.vid||i.vid,preload_hit:t.preloadHit||0,preload_cached:t.preloadCached||0,endState:ENDED_TYPE.PLAY_CATCH,costTime:t.costTime,message:t.errorMessage},0)}})),_defineProperty(this,"onMediaExpied",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{errorType:"",errorTypeCode:0,errorCode:0,url:"",headers:{},status:0},t=i.errorLog,r=i.playlogs;log("onMediaExpied",e),i.suspendWaitingStatus("expied"),i.setBr("expied"),t.accu_errc++,t.try_err_c++,t.last_errors.push(e.errorCode),r.at=(new Date).getTime(),i.merror.expied.push(_objectSpread$3({errorType:e.errorTypeCode||e.errorType,code:e.errorCode,url:e.url||"",status:e.status},transformHeader(e.headers||{}))),i.onOneError({errorType:e.errorTypeCode||e.errorType,code:e.errorCode,url:e.url||"",status:e.status,headers:e.headers||{}},0)})),_defineProperty(this,"onLog",(function(e){log("onLog",e);var t=e.type;if(delete e.type,t)switch(t){case LOGTYPES.RETRY:break;case LOGTYPES.ONETEMP:i._templog||(i._templog={}),i._templog=parseTempData(i._templog,e.data,e.action),i._templog.preload_hit&&(i._cacheFile=CACHE_FILE_TYPE.CACHED);break;case LOGTYPES.ONEERROR:var r=i.errorLog;r.accu_errc++,r.try_err_c++,i.setBr("mp4error"),r.last_errors.push(e.code),i.onOneError(e,0);break;case LOGTYPES.ONEEVENT:var n=formatData(e,{costTime:"costTime",vid:"vid",end_type:"end_type",pos:"cur_play_pos",cdnUrl:"cdn_url"});n.ext&&["start","end"].map((function(e){n.ext[e]&&(n.ext["ext_".concat(e)]=n.ext[e],delete n.ext[e])})),i.onOneEvent(n.data,n.ext,2)}})),_defineProperty(this,"onPlay",(function(){log("onPlay","this.startStep :".concat(i.startStep," this.isEnded:").concat(i.isEnded)),i.isEnded&&(i.resetLoggerParams(),i.setPt())})),_defineProperty(this,"onPause",(function(){log("onPause");var e=i.pauseLog;e.isPausing=!0,e.pause_start=nowTime()})),_defineProperty(this,"onWaiting",(function(){var e=i.stall;i._options.checkByInnerLog||(log("onWaiting>","isSeeking:".concat(i.isSeeking," startStep:").concat(i.startStep," intervalId:").concat(e.intervalId)),i.isSeeking||0===i.playlogs.vt||i.inWaitingStart>0||(e.intervalId&&(window.clearTimeout(e.intervalId),e.intervalId=null),i.inWaitingStart=nowTime(),e.intervalId=window.setTimeout((function(){var e=i.stall;log("stall.intervalId>>".concat(e.intervalId," cost: ").concat(nowTime()-i.inWaitingStart)),i._endType="wait",i.load_state=LOAD_STATES.STALLED,i.vtype.indexOf("MP4")>-1&&i.player.currentTime>10&&i.task&&(i.triggerTask("waiting",i.initial_url),i.requestCount++),e.stall_start=i.inWaitingStart,1===e.sc&&(e.first_buf_startt=i.inWaitingStart),window.clearTimeout(e.intervalId),e.intervalId=null,i.startWaitingStatus(i.inWaitingStart,nowTime()-i.inWaitingStart),e.intervalId=setTimeout((function(){i.inWaitingStart>0&&i.suspendWaitingStatus("waitTimeout")}),MAX_STALL_TIME)}),MIN_WAITIONG)))})),_defineProperty(this,"onEnded",(function(){if(i.initial_url){log("onEnded","watchDur:".concat(i.watchDur," vt:").concat(i.vt," pt:").concat(i.pt)),i.isEnded=!0;var e=i.resLogs.df;i.changeResolution(e,e,nowTime(),"leave_switch"),i.onOnePlay(ENDED_TYPE.ENDED),i.sendDegradeLog("playCatch_end",i.playlogs.degrade),i.onOneTemp(ENDED_TYPE.ENDED),i.sendEventsQueue(),i.playlogs.lc++}})),_defineProperty(this,"onUnload",(function(){0!==i.startStep&&i.initial_url&&(i.onOneTemp(ENDED_TYPE.UNLOAD),i.sendDegradeLog("playCatch_end",i.playlogs.degrade),i._reportInvalidVV(ENDED_TYPE.UNLOAD)||(i._options.disableLocalCache?i.onOnePlay(ENDED_TYPE.UNLOAD,!1):i.onOnePlay(ENDED_TYPE.UNLOAD,!0)))})),_defineProperty(this,"onVisibilitychange",(function(){var e=i.playlogs.vt;"visible"===document.visibilityState&&(e||i.setPt())})),_defineProperty(this,"onDestroy",(function(){log("onDestroy:this.startStep:".concat(i.startStep," initial_url:").concat(i.initial_url," ").concat(!!i.initial_url)),console.log(">>>onDestroy",i.startStep>0&&!!i.initial_url),i.onOnePlay(ENDED_TYPE.DESTROY),i.startStep>0&&i.initial_url&&(i.onOneTemp(ENDED_TYPE.DESTROY),i.sendDegradeLog("playCatch_end",i.playlogs.degrade));var e=i.resLogs.df;i.changeResolution(e,e,nowTime(),"leave_switch"),i.sendEventsQueue(),Browser.isPC?window.removeEventListener("beforeunload",i.onUnload):(Browser.isMobile||Browser.isPad)&&window.removeEventListener("pagehide",i.onUnload),document.removeEventListener("visibilitychange",i.onVisibilitychange),i.listeners.forEach((function(e){i.player.off(e.evt,e.handler)})),i.clearTimers(),i.player.off("destroy",i.onDestroy),i.task&&i.task.clear()})),_defineProperty(this,"onOnePlay",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(log("onOnePlay _isOnePlayReport:".concat(i._isOnePlayReport," isLeave: ").concat(t," endState:").concat(e)),!i._isOnePlayReport){var r=i.errorLog,n=i.playlogs,o=i.abrInfo,a=i.resLogs,s=i.player,u=i.apiLog,c=i.pauseLog,l=i.stall,d=i.netLog,f=i.watchDur;i._isOnePlayReport=!0;var h=curTimestamp(),p=0,g=0,y=s.video&&s.video.buffered;if(y){for(var v=y.length,m=0,_=0;_<v;_++)m+=y.end(_)-y.start(_);p=g=1e3*m}var b=i.mp4FFInfo;Object.keys(b).map((function(e){i.exInfo[e]=b[e]}));var A=_objectSpread$3(_objectSpread$3(_objectSpread$3({local_time:(new Date).getTime(),log_type:"video_playq",plugin_exception:0,player_create_exception:"",v:i.vid,initial_url:i.initial_url,initial_host:i.initial_host,initial_ip:i.curHeaders.x_response_sinfo||0,initial_type:i.initial_type},i.curHeaders),{},{initial_resolution:a.initial_resolution,final_resolution:a.final_resolution,pt:i.pt,prepare_start_time:n.nt,prepare_end_time:n.rt||curTimestamp(),vt:i.vt,lt:i.lt,lpt:i.lpt,fvt:i.fvt,nvt:i.nvt,bft:i.bft,sc:i.seekLog.sc,sat:i.seekLog.sat,bc:i.bc,dbc:n.dbc||0,nbc:n.nbc||0,video_net_s:i.videoNetworkState,status:i.curStatus,first_buf_startt:l.first_buf_startt,first_buf_endt:l.first_buf_endt,lc:n.lc,bu_acu_t:i.bu_acu_t>MAX_TIME?0:i.bu_acu_t,de_bu_acu_t:n.de_bu_acu_t||0,n_bu_acu_t:n.n_bu_acu_t||0,pause_acu_t:c.pause_acu_t,cur_play_pos:i.cur_play_pos,load_state:i.load_state,playback_state:i.playback_state,end_state:e,watch_dur:f>MAX_TIME?0:f,switch_resolution_c:i.switchResolutionCount,is_start_play_automatically:i.isAutoplay,start_time:i.start_time,finish:i.finish,errt:r.errt,errc:r.errc,vsc:u.vsc,vsc_message:u.vsc_message,api_str:u.api_str,auth:u.auth||u.logid,width:i.videoWidth,height:i.videoHeight,vd:i.vd,video_length:parseInt(p,10),audio_length:parseInt(g,10),df:i.resolution,lf:a.lf,play_c:0,player_created_t:i.player_created_t,fir_errt:r.fir_errt,fir_errc:r.fir_errc,lv_method:0,ldst:a.ldst,ldet:a.ldet,is_disable_short_seek:0,mute:i.mute,volume:i.volume,download_speed:i.mp4RealSpeed?i.mp4RealSpeed:i.task&&i.task.speed?i.task.speed:d.downloadSpeed,avg_speed:i.mp4Speed?i.mp4Speed:d.rqCount>0?parseInt(d.totalSpeed/d.rqCount,10):0,bitrate:i.curBitrate,preload_state:i.preloadState,preload_hit:i.preLoadData.hit,preload_cached:i.preLoadData.duration||i.preLoadData.byteLength,mdl_req_num:d.requestCount,watingcost:i.watingCost,br:n.br,fbrt:n.fbrt,try_err_c:r.try_err_c,accu_errc:r.accu_errc,dash_pst:i.dash_pst,dash_wst:i.dash_wst,dash_wrt:i.dash_wrt,dash_ift:i.dash_ift,dash_cst:i.dash_cst,dash_spt:i.dash_spt,dash_break:2===s.dashBufferBreak?1:0,merror:toJsonString(i.merror),ex:toJsonString(i.exInfo),bufs:toJsonString(i.buffers.allBuffer),vs:a.vs,vds:a.vds,vps:a.vps},i.buffers.curBuffer),{},{degrade:n.degrade,cache_file:i._cacheFile});if(0!==i.vt&&(A.et=h),s&&s.dashState&&(A.dash_state=s.dashState),["drm_type","dynamic_type","enable_bash"].forEach((function(e){i.addIfExist(e,i._options,A)})),s.abrInstance){var E=s.abrInstance;if(o.abr_general_info=E.generalInfo,o.abr_event_info.video_exit={local_time_ms:(new Date).getTime(),buffer_length:E.bufferLength,internet_speed:E.downloadSpeed,now_bitrate:E.nowBitrate,play_speed:i.player.playbackRate},E.getAbrPlayInfo&&(o.abr_play_info=E.getAbrPlayInfo()),E.getAbrVVStats){var S=E.getAbrVVStats();Object.keys(S).forEach((function(e){A[e]=S[e]}))}}o.abr_init_opts=i.player.config.autoBitrateOpts||{},A.abr_info=toJsonString(i.abrInfo),t?i.reportLog(REPORT_EVENTS.ONE_PLAY,A,t):i.reportLog(REPORT_EVENTS.ONE_PLAY,A)}})),_defineProperty(this,"onOneEvent",(function(e){var t=e.costTime,r=e.vid,n=e.end_type,o=e.cur_play_pos,a=e.cdn_url,s=e.cdn_host,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2?arguments[2]:void 0,l=i.buffers.curBuffer,d=_objectSpread$3({local_time:(new Date).getTime(),v:r||i.vid,cost_time:t,end_type:n||i.end_type,cdn_url:a||i.url,cdn_host:s||"",initial_type:i.initial_type,resolution:i.resolution,play_speed:i.playbackRate,first_frame_interval:nowTime()-i.pt,last_switch_interval:i.getLastInterval("lastSwitchStartTime",i.resLogs,!1),last_seek_interval:i.updateSeekPt(!1),last_event_interval:i.getLastInterval("lastEventTime"),cur_play_pos:o||i.cur_play_pos,video_ready_s:i.videoReadyState,video_seeking:i.videoSeeking,video_paused:i.videoPaused,bufs:toJsonString(i.buffers.allBuffer),retry_count:i.retry_count,at:i.playlogs.at,stay_seconds:parseInt(((new Date).getTime()-i.playlogs.at)/1e3,10),preload_state:i.preloadState,preload_hit:i.preLoadData.hit,preload_cached:i.preLoadData.duration||i.preLoadData.byteLength},l);if("waitstart"===n&&"function"==typeof i._options.getPageFPS){var f=i._options.getPageFPS();d.cur_fps=f.curFPS||0,d.avg_fps=f.avgFPS||0}i.player&&i.player.dashState&&(d.dash_state=i.player.dashState),Object.keys(u).forEach((function(e){d[e]=u[e]})),i.addIfExist("drm_type",i._options,d),i.reportLog(REPORT_EVENTS.ONE_EVENT,d,c)})),_defineProperty(this,"onOneTemp",(function(){if(log("onOneTemp>>",!i._templog),i._templog){var e=i.player,t=i.playlogs,r=i.pauseLog,n=i.errorLog,o=i.resLogs,a=i.watchDur,s=_objectSpread$3(_objectSpread$3(_objectSpread$3({local_time:(new Date).getTime()},i._templog),{},{v:i.vid,initial_type:i.initial_type,pt:i.pt,vt:i.vt,lt:i.lt,fvt:i.fvt,bc:i.bc,bu_acu_t:i.bu_acu_t>MAX_TIME?0:i.bu_acu_t,pause_acu_t:r.pause_acu_t,cur_play_pos:i.cur_play_pos,watch_dur:a>MAX_TIME?0:a,finish:i.finish,errt:n.errt,errc:n.errc,vd:i.vd,df:i.resolution,lf:o.lf,br:t.br,fbrt:t.fbrt,try_err_c:n.try_err_c,accu_errc:n.accu_errc,dash_break:2===e.dashBufferBreak?1:0,bufs:toJsonString(i.buffers.allBuffer),vs:o.vs,vds:o.vds,vps:o.vps},i.buffers.curBuffer),{},{degrade:t.degrade});0!==i.vt&&(s.et=curTimestamp()),["drm_type","dynamic_type","enable_bash"].forEach((function(e){i.addIfExist(e,i._options,s)})),i.reportLog(REPORT_EVENTS.ONE_TEMP,s,0),i._templog=null}})),this.player=r,void 0===this.player||null===this.player)throw new Error("player is ".concat(this.player));if(n&&n.line_app_id){(n.isTask||void 0===n.isTask)&&(this.task=new SpeedCheckTask),this.eventQueue=[],this._instanceCreateTime=(new Date).getTime(),n.codec_type=n.codec_type||"h264",this._options=n,!this._options.maxQueueCount&&(this._options.maxQueueCount=5),this.line_app_id=parseInt(n.line_app_id,10)||0,this.line_user_id=(n.line_user_id||"").toString(),this.version=version,this.sdk_version=version,this.playerCoreVersion=n.playerCoreVersion||"",this.playerVersion=n.playerVersion||n.sdk_version,this.closeSeekLog=n.closeSeekLog||!1,this.start_time=1e3*(n.start_time||0),this.isFullAB=n.isFullAB||!1,this._initial_resolution="",this.__vtype=null,this.__dt="",this.isLowMp4=!1,this.resetLoggerParams();try{this.initializeTracker(),this.sendLocalLog(),this.bindEvt(),log("logger constructor:"+this.player.video)}catch(e){console.log(e)}}else console.warn("player.config.vodLogOpts.line_app_id is necessary for plugin xgVodLogger")}return _createClass(t,[{key:"resetLoggerParams",value:function(){log("resetLoggerParams");var e=this.playlogs?this.playlogs.lc:0;this.playlogs={nt:curTimestamp(),vt:0,rt:this.isEnded?curTimestamp():0,at:0,pt:0,bu_acu_t:0,bc:0,br:0,fbrt:"",dbc:0,de_bu_acu_t:0,nbc:0,n_bu_acu_t:0,played:[{begin:0,end:-1}],dash_pst:0,dash_wst:0,dash_wrt:0,dash_ift:0,dash_cst:0,dash_spt:0,interruptCount:0,degrade:"none",lc:e},this.degradeLog={bu_acu_t:0,bc:0,watch_dur:0,hasSendEnd:!1},this.buffers={allBuffer:[],curBuffer:{buf_diff:0,buf_s_pos:0,buf_e_pos:0,buf_include:0}},this.netLog={downloadSpeed:0,requestCount:0,connectCost:0,totalSpeed:0,rqCount:0,status:0},this.merror={cdn:[],player:[],playCatch:[],expied:[]},this.exInfo={buffer:{},stall:[],states:[]},this._templog=null,this._isOnePlayReport=!1,this.startStep=0,this.bft=0,this.initializeLogDatas(),this.initializeUrlLog()}},{key:"initializeLogDatas",value:function(){this.startStep=0,this.inWaitingStart=0,this.lastVideoTime=0,this._endType="",this._retryCount=0,this.lastOperaTime=DEFAULT_INTERVAL,this.lastEventTime=DEFAULT_INTERVAL,this.seekLog={intervalId:0,lastSeekStartTime:nowTime(),seekBefore:0,sat:0,sc:0},this.resLogs={lastSwitchStartTime:DEFAULT_INTERVAL,switch_count:0,abr_switch_count:0,initial_resolution:"",final_resolution:"",ldst:0,ldet:0,df:"",lf:"",played:[],bc:0,bu_acu_t:0,sc:0,sat:0,buf:0,lbuf:0,lplayed:0,vs:0,vds:0,vps:0,vis:0,bitrate:0},this.apiLog={code:0,message:"",logid:"",api:"",auth:"",error:{}},this.errorLog={accu_errc:0,try_err_c:0,errt:0,errc:0,fir_errt:0,fir_errc:Browser.isSupportMP4?0:1005,last_errors:[]},this.pauseLog={pause_acu_t:0,isPausing:!1,pause_start:0},this.stall={intervalId:0,stall_count:0,first_buf_startt:0,first_buf_endt:0,stall_start:0,stall_end:0,stall_last_interval:0,stall_acc_time:0},this._playerCreatedTime=0,this.load_state=LOAD_STATES.UNKNOWN,this.lv_method=6,this.isSeeking=!1,this.isEnded=!1,this.startStep=0,this.isAutoplay=this.player.config&&this.player.config.autoplay?1:0,this.abrInfo={abr_general_info:{},abr_event_info:{video_switch:[],video_stall:[],video_exit:{}},abr_play_info:{start_play_time_ms:0,is_hint:0,playback_info:{internet_speed_record:[],play_bitrate_record:[],buffer_length_record:[],play_speed_record:[]}},abr_user_info:{cancel_abr:0},abr_init_opts:this.player.config.autoBitrateOpts||{}},this._cacheFile=CACHE_FILE_TYPE.NO_CACHE}},{key:"initSessionId",value:function(){var e="0";try{e=window.localStorage.getItem(LS_KEY).web_id||"0"}catch(error){e="0"}this._sessionId=generateSessionId(e),log("sessionId ".concat(this._sessionId))}},{key:"initializeTracker",value:function(){var e=this._options;if(window.__xgplayer_vod_log__)this.tracker=window.__xgplayer_vod_log__;else{this.tracker=window.__xgplayer_vod_log__=new Collector("tracker");var t=e.channel||"cn",r={app_id:"cn"===(t="va"===t||"sg"===t?t:"cn")?TEA_ID:1300===TEA_ID?323254:TEA_ID,channel:t,log:!1,disable_sdk_monitor:!0};e.channelDomain&&(r.channel_domain=e.channelDomain),r.enable_ab_test=!!e.enableAbTest,this.tracker.init(r)}this.initSessionId();var n=navigator?navigator.hardwareConcurrency:0,i=navigator?navigator.deviceMemory:0;this.commonParams={play_type:0,source_type:"vid",sdk_version:this.sdk_version,pc:this.playerCoreVersion,pv:this.playerVersion,line_app_id:this.line_app_id,line_user_id:this.line_user_id,app_version:e.appVersion||"",platform:Browser.isPad?"pad":Browser.isMobile?"mobile":"pc",cpu_core:Number(n)||0,memory_size:Number(i)||0},log("commonParams ",this.commonParams);var o={evtParams:this.commonParams,disable_auto_pv:!0};log("Browser.name ",Browser.name),!Browser.name||Browser.isChrome||Browser.isSafari||(o.browser=Browser.name,Browser.appVersion&&(o.browser_version=Browser.appVersion)),this.line_user_id&&(o.user_unique_id=this.line_user_id,o.web_id=this.line_user_id),e.referrer&&(o.referrer=e.referrer,o.referrer_host=getHostFromUrl(e.referrer)),this.tracker.config(o),this.tracker.start()}},{key:"resetDefiInfo",value:function(){var e=this.resLogs;e.played=[],e.bc=0,e.bu_acu_t=0,e.sc=0,e.sat=0}},{key:"sendLocalLog",value:function(){var e=this,t=LOCAL_LOG.get();LOCAL_LOG.remove(),t.map((function(t){Object.keys(t).map((function(r){if(log("sendLocalLog",r,t[r]),e.player){e.player.emit("abLog",r,t[r]);var n=e._options.sendLocalCallback;n&&"function"==typeof n&&n(r,t[r])}e._track(r,t[r])}))}))}},{key:"_track",value:function(e,t){"function"==typeof this.tracker?this.tracker(e,t):this.tracker.event(e,t)}},{key:"bindEvt",value:function(){var e=this;this.listeners=[{evt:"play",handler:this.onPlay},{evt:"playing",handler:this.onPlaying},{evt:"pause",handler:this.onPause},{evt:"waiting",handler:this.onWaiting},{evt:"playInterfaceInfo",handler:this.onPlayInterfaceInfo},{evt:"DRM_ERROR",handler:this.onDashError},{evt:"ended",handler:this.onEnded},{evt:"loadeddata",handler:this.onLoadeddata},{evt:"loadstart",handler:this.onLoadStart},{evt:"canplay",handler:this.onCanplay},{evt:"dashStateChange",handler:this.onDashStateChange},{evt:"mp4StateChange",handler:this.onMp4StateChange},{evt:"autoplay was prevented",handler:this.onNotAutoPlay},{evt:"autoplay_was_prevented",handler:this.onNotAutoPlay},{evt:"seeking",handler:this.onSeeking},{evt:"seeked",handler:this.onSeeked},{evt:"complete",handler:this.onPlayerInited},{evt:"timeupdate",handler:this.onTimeUpdate},{evt:"bufferedChange",handler:this.onBufferedChange},{evt:"beforeDefinitionChange",handler:this.onBeforeDefinitionChange},{evt:"definitionChange",handler:this.onDefinitionChange},{evt:"definitionChangeSuccess",handler:this.onDefiChangeSuccess},{evt:"drmTypeChange",handler:this.onDrmTypeChange},{evt:"replayBtnClick",handler:this.onReplayBtnClick},{evt:"initialUrl",handler:this.initializeUrlLog},{evt:"ABR_CHANGE",handler:this.onAbrChange},{evt:"playCatch",handler:this.onPlayCatch},{evt:"MEDIA_EXPIRED",handler:this.onMediaExpied},{evt:"log",handler:this.onLog},{evt:"ABR_PRESTALL_END",handler:this.onAbrPrestallEnd},{evt:"progress_event",handler:this.onProgressEvent},{evt:"logger_next",handler:this.onNext},{evt:"playnext",handler:this.onNext},{evt:"nextEnded",handler:this.onNextEnded},{evt:"media_format_error",handler:this.onMediaFormatError},{evt:"xglog",handler:this.onXgLogWaiting}];var t=this.player.config.errorKey;log(">>>errorKey",t);var r={evt:"error",handler:this.onPlayerError};t&&(r.evt=t),this.listeners.push(r),this.listeners.forEach((function(t){e.player.on(t.evt,t.handler)})),this.bindUnload()}},{key:"addIfExist",value:function(e,t,r){if(isObject$3(t)){var n=t[e];!(null==n)&&(r[e]=n)}}},{key:"changeResolution",value:function(e,t,r,n,i){var o=this.resLogs;e=formatDefinition(e),t=formatDefinition(t),o.ldet=nowTime(),o.df=t,o.lf=e,o.final_resolution=t,o.switch_count++;var a=o.ldet-r,s={bc:o.bc,bu_acu_t:o.bu_acu_t,sc:o.sc,sat:o.sat,watch_dur:computeWatchDur(o.played)};i&&(s.abrInfo=i),this.updateVds(),this.resetDefiInfo(),this._options.closeResolutionLog||this.onOneOperator({costTime:a,operaType:n,stateBefore:e,stateAfter:t},s,0)}},{key:"getLastInterval",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t[e],i=nowTime(),o=n===DEFAULT_INTERVAL?DEFAULT_INTERVAL:i-n;return r&&(t[e]=i),o}},{key:"updateSeekPt",value:function(e){return this.getLastInterval("lastSeekStartTime",this.seekLog,e)}},{key:"_reportInvalidVV",value:function(e){return!!this._isInvaidVV()&&(this.onOneError({endState:e,errorType:9998,code:-1,url:this.player.currentSrc,headers:{}},0),this._isOnePlayReport=!0,!0)}},{key:"_isInvaidVV",value:function(){return 0===this.vt&&-1===this.curStatus}},{key:"bindUnload",value:function(){Browser.isPC?window.addEventListener("beforeunload",this.onUnload):(Browser.isMobile||Browser.isPad)&&window.addEventListener("pagehide",this.onUnload),document.addEventListener("visibilitychange",this.onVisibilitychange),this.player.once("destroy",this.onDestroy)}},{key:"clearTimers",value:function(){var e=this.seekLog,t=this.stall;e.intervalId&&window.clearTimeout(e.intervalId),t.intervalId&&window.clearTimeout(t.intervalId)}},{key:"sendDegradeLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"playCatch",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};log("sendDegradeLog",e,t,r);var n=this.degradeLog;if(!(n.hasSendEnd||"playCatch_end"===e&&"none"===t)){"playCatch_end"===e&&(n.hasSendEnd=!0);var i=this.bu_acu_t-n.bu_acu_t;this.onOneEvent({costTime:this.vd,vid:this.vid,end_type:e,cur_play_pos:this.player.currentTime,cdn_url:r.url},_objectSpread$3({degrade:t,vt:this.vt,pt:this.pt,fvt:this.fvt,bc:this.bc-n.bc,bu_acu_t:i>MAX_TIME?0:i,watch_dur:this.watchDur-n.watch_dur},r),0)}}},{key:"onOneOperator",value:function(e){var t=e.costTime,r=e.operaType,n=e.stateBefore,i=e.stateAfter,o=e.endType,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,u=this.getLastInterval("lastOperaTime"),c={local_time:(new Date).getTime(),v:this.vid,opera_type:r,state_before:n,state_after:i,cost_time:t,end_type:o||this.end_type,cdn_url:this.url,resolution:this.resolution,last_interval:u,bufs:toJsonString(this.buffers.allBuffer),cur_play_pos:this.cur_play_pos,retry_count:this.retry_count};this.player&&this.player.dashState&&(c.dash_state=this.player.dashState),Object.keys(a).forEach((function(e){c[e]=a[e]})),this.addIfExist("drm_type",this._options,c),this.reportLog(REPORT_EVENTS.ONE_OPERA,c,s)}},{key:"onOneError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{errorType:0,code:0,url:"",headers:{},costTime:0,vid:"",message:"",preload_hit:0,preload_cached:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;log("onOneError",e);var r=this.errorLog,n=this.apiLog,i=this.resLogs,o=this.player,a=this.playlogs,s=transformHeader(e.headers||{}),u=_objectSpread$3(_objectSpread$3(_objectSpread$3({v:e.vid||this.vid,video_pos:this.cur_play_pos,local_time:(new Date).getTime(),cost_time:e&&e.costTime?e.costTime:0,errt:e.errorType,errc:e.code,es:this.es,cdn_url:e.url||this.url,bufs:toJsonString(this.buffers.allBuffer),resolution:i.final_resolution,last_errors:r.last_errors.join(";"),vsc:n.vsc,vsc_message:e.message||n.vsc_message,server_ip:s.x_response_sinfo||0,initial_url:this.initial_url,initial_host:this.initial_host},s),{},{cur_play_pos:this.cur_play_pos},this.buffers.curBuffer),{},{degrade:a.degrade,end_state:e.endState||ENDED_TYPE.ERROR,preload_hit:e.preload_hit,preload_cached:e.preload_cached,ex:toJsonString(this.exInfo)});o&&o.dashState&&(u.dash_state=o.dashState),this.addIfExist("drm_type",this._options,u),this.reportLog(REPORT_EVENTS.ONE_ERROR,u,t)}},{key:"reportLog",value:function(e,r,n){var i=this,o=this._options,a=this.player.ABTestTag;!r.player_sessionid&&(r.player_sessionid=this.sessionId),!r.web_url&&(r.web_url=window.location.href),r.user_agent=navigator.userAgent,r.dynamic_type=this.dynamicType;var s="Array"===typeOf(o.absdkVersion)?o.absdkVersion.join(","):o.absdkVersion;r.absdkVersion=s||t.AB_SDK_VERSION,null!=a&&(r.abtest_tag=a);var u=this._options;if(isObject$3(u)&&(COMMON_KEYS.forEach((function(e){i.addIfExist(e,u,r)})),r.vtype=this.vtype),1===n){var c={};return c[e]=r,void LOCAL_LOG.set(c)}2!==n?(this.player&&this.player.emit("abLog",e,r),this._track(e,r)):this.addEventsQueue(e,r)}},{key:"addEventsQueue",value:function(e,t){this.eventQueue.push({event:e,params:t}),this.eventQueue.length>=this._options.maxQueueCount&&this.sendEventsQueue()}},{key:"sendEventsQueue",value:function(){for(;this.eventQueue.length>0;){var e=this.eventQueue.pop();this._track(e.event,e.params)}}},{key:"startWaitingStatus",value:function(e,t){this.onOneEvent({costTime:t,end_type:"waitstart"},{},2),this.appendStallInfo("start",e)}},{key:"triggerTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"start",t=arguments.length>1?arguments[1]:void 0;log("triggerTask>>",e);var r=checkVideoSrcIsEmpty(t=t||this.player.src);!r&&this.vtype.indexOf("MP4")>-1&&this.task&&this.task.trigger(t,e)}},{key:"appendStallInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"start",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=this.exInfo.stall;if("start"===e){n.length>6&&n.splice(0,n.length-6);var i=this.buffers.curBuffer;n.push({start:t,end:-1,endType:"waitstart",cost:0,cur:this.cur_play_pos,buf_s:i.buf_s_pos,buf_e:i.buf_e_pos,buf_i:i.buf_include})}else if("end"===e){var o=n.length-1;if(o<0)return;n[o].end<0&&(n[o].end=t,n[o].endType=r,n[o].cost=t-n[o].start)}log("appendStallInfo",n)}},{key:"suspendWaitingStatus",value:function(e){var t=nowTime(),r=this.playlogs,n=this.resLogs,i=this.stall,o=this.inWaitingStart;if(!(o<=0||this.isSeeking||r.vt<=0)){if(log("suspendWaitingStatus>>".concat(e,"|costTime:").concat(t-o," isSeeking:").concat(this.isSeeking," vt:").concat(r.vt)),this.appendStallInfo("end",t,e),t-o>MIN_WAITIONG){var a=t-this.inWaitingStart;if(r.bc++,this.checkInBuffer(this.player.currentTime)?(r.de_bu_acu_t+=a,r.dbc++):(r.nbc++,r.n_bu_acu_t+=a),n.bc++,r.bu_acu_t+=a,n.bu_acu_t+=a,i.stall_end=t,i.stall_last_interval=i.stall_end-i.stall_start,i.stall_acc_time+=i.stall_last_interval,1===i.sc&&(i.first_buf_endt=t),this.player.abrInstance&&!this.isSeeking&&this.playlogs.vt){var s=this.player.abrInstance;this.abrInfo.abr_event_info.video_stall.push({local_time_ms:(new Date).getTime(),stall_duration:parseFloat((a/1e3).toFixed(2)),buffer_length:s.bufferLength,internet_speed:s.downloadSpeed,now_bitrate:s.nowBitrate,play_speed:this.player.playbackRate,is_abr:s.isCurrentInAbr?1:0})}this.onOneEvent({costTime:a,end_type:e||"wait"},{},2)}this._endType="",this.load_state=LOAD_STATES.PLAYABLE,this.inWaitingStart=0,window.clearTimeout(i.intervalId),i.intervalId=null}}},{key:"suspendSeekStatus",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isSeeking){var r=this.seekLog,n=this.resLogs,i=this.player,o=nowTime()-r.lastSeekStartTime;log("suspendSeekStatus>>","".concat(e," currentTime:").concat(i.currentTime," costTime:").concat(o," sat:").concat(r.sat," resLogs.sat:").concat(n.sat)),r.intervalId&&window.clearTimeout(r.intervalId),r.intervalId=null,this.isSeeking=!1;var a=this._endType="seek",s=r.seekBefore,u=(i.currentTime||0).toString();r.sc++,r.sat+=o>MAX_COST?0:o,n.sc++,n.sat+=o>MAX_COST?0:o,this.updateSeekPt(!0),!this.closeSeekLog&&t&&this.onOneOperator({costTime:o,operaType:a,stateBefore:s,stateAfter:u,endType:e})}}},{key:"setPt",value:function(){var e=this.playlogs;this.startStep=1,!e.pt&&this.player.currentTime&&(this.isSeeking=!0),e.pt||(e.pt=curTimestamp(),log("setPt","init pt :".concat(e.pt,", document.visibilityState:").concat(document.visibilityState)))}},{key:"setVt",value:function(){var e=this.playlogs;1===this.startStep&&(e.vt||(e.vt=curTimestamp(),log("setVt: first frame inited","vt-pt:".concat(e.vt-e.pt," vt-nt:").concat(e.vt-e.nt))),this.startStep=2)}},{key:"setBr",value:function(e){var t=this.playlogs;t.vt>0&&(0===t.br&&(t.fbrt=e||""),t.br++)}},{key:"url",get:function(){var e=this.player;return e&&e.config?e.config.url:""}},{key:"vid",get:function(){var e=this.player;return e&&e.config?e.config.vid:""}},{key:"bc",get:function(){return this.playlogs.bc}},{key:"bu_acu_t",get:function(){return this.playlogs.bu_acu_t}},{key:"pt",get:function(){return this.playlogs.pt||curTimestamp()}},{key:"vt",get:function(){var e=this.playlogs,t=e.vt;return e.pt>0?t:0}},{key:"fvt",get:function(){var e=this.playlogs,t=e.vt,r=e.pt;return t>0&&r>0?parseInt(t-r,10):0}},{key:"nvt",get:function(){var e=this.playlogs,t=e.vt,r=e.nt;return t>0&&r>0?parseInt(t-r,10):0}},{key:"dash_pst",get:function(){return this.playlogs.dash_pst}},{key:"dash_wst",get:function(){return this.playlogs.dash_wst}},{key:"dash_wrt",get:function(){return this.playlogs.dash_wrt}},{key:"dash_ift",get:function(){return this.playlogs.dash_ift}},{key:"dash_cst",get:function(){return this.playlogs.dash_cst}},{key:"dash_spt",get:function(){return this.playlogs.dash_spt}},{key:"vd",get:function(){var e=this.player;return e.duration&&"number"==typeof e.duration&&e.duration>0?parseInt(1e3*e.duration,10):e.config.duration&&"number"==typeof e.config.duration?parseInt(1e3*e.config.duration,10):0}},{key:"cur_play_pos",get:function(){return parseInt(1e3*this.player.currentTime,10)}},{key:"volume",get:function(){return this.player.volume}},{key:"buffer_time",get:function(){var t=0;try{var r=this.player.getBufferedRange();t=r[1]-r[0]}catch(e){t=0}return t}},{key:"player_created_t",get:function(){return this._playerCreatedTime}},{key:"playbackRate",get:function(){return this.player.playbackRate}},{key:"mute",get:function(){return this.player.muted?0:1}},{key:"videoWidth",get:function(){var e=this.player;return e&&e.video?e.video.videoWidth:0}},{key:"videoHeight",get:function(){var e=this.player;return e&&e.video?e.video.videoHeight:0}},{key:"preload",get:function(){var e=this.player;return!(!e||!e.video)&&e.video.preload}},{key:"initial_url",get:function(){var e=this.player.currentSrc;return e.indexOf("blob:")>-1&&this.urlLog.initial_url?this.urlLog.initial_url:checkVideoSrcIsEmpty(e)?"":e}},{key:"initial_host",get:function(){var e=this.player.currentSrc;return e.indexOf("blob:")>-1&&this.urlLog.initial_host?this.urlLog.initial_host:getHostFromUrl(checkVideoSrcIsEmpty(e)?"":e)}},{key:"curHeaders",get:function(){var e=this.player,t=this.task;return e&&e.__dash__&&e.__dash__.curReqVideoSegInfo?transformHeader(e.__dash__.curReqVideoSegInfo.headers||{}):t?t.headers:{}}},{key:"curStatus",get:function(){var e=this.task,t=this.vtype,r=this.netLog;return t.indexOf("MP4")>-1?e?e.status:0:r.status}},{key:"play_type",get:function(){return 0}},{key:"resolution",get:function(){var e=this.player.curDefinition;return e?e.definition+"":this.resLogs.df}},{key:"sessionId",get:function(){return this._sessionId}},{key:"finish",get:function(){return this.isEnded?1:0}},{key:"end_type",get:function(){return this._endType}},{key:"mp4Speed",get:function(){if(!this.player||!this.player.plugins)return 0;var e=this.player.plugins.mp4encryptplayer;return e?e.speed:0}},{key:"mp4RealSpeed",get:function(){if(!this.player||!this.player.plugins)return 0;var e=this.player.plugins.mp4encryptplayer;return e?e.realTimeSpeed:0}},{key:"mp4MseOpLength",get:function(){if(!this.player||!this.player.plugins)return-1;var e=this.player.plugins.mp4encryptplayer;return e?e.opQueueLen||0:-1}},{key:"mp4LoadSegmentTimeRange",get:function(){if(!this.player||!this.player.plugins)return"";var e=this.player.plugins.mp4encryptplayer;return e?e.loadSegmentTimeRange.join(","):""}},{key:"mp4FFInfo",get:function(){if(!this.player||!this.player.plugins)return{};var e=this.player.plugins.mp4encryptplayer;return e&&e.firstFrameTime||{}}},{key:"preLoadData",get:function(){if(!this.player||!this.player.plugins)return[];var e=this.player.plugins.mp4encryptplayer;return e&&e.preLoadData?{hit:1,duration:e.preLoadData.duration,length:e.preLoadData.byteLength}:{hit:0,duration:0,length:0}}},{key:"preloadState",get:function(){if(!this.player||!this.player.plugins)return 0;if(void 0!==this.player.preloadState)return this.player.preloadState||0;var e=this.player.plugins.mp4encryptplayer;return e&&e.preloadState?e.preloadState:0}},{key:"curBitrate",get:function(){var e=this.player,t=e.config,r=e.curDefinition;return r&&r.bitrate?r.bitrate:t.defaultBitrate?t.defaultBitrate:0}},{key:"videoReadyState",get:function(){var e=this.player;return e&&e.video?e.video.readyState:-1}},{key:"videoSeeking",get:function(){var e=this.player;return e&&e.video&&e.video.seeking?1:0}},{key:"videoPaused",get:function(){var e=this.player;return e&&e.video&&e.video.paused?1:0}},{key:"retry_count",get:function(){return this._retryCount}},{key:"switchResolutionCount",get:function(){return this.resLogs.switch_count}},{key:"isError",get:function(){return hasClass$1(this.player.root,"xgpplayer-is-error")}},{key:"isPlaying",get:function(){return hasClass$1(this.player.root,"xgplayer-playing")}},{key:"isStop",get:function(){return hasClass$1(this.player.root,"xgplayer-ended")||hasClass$1(this.player.root,"xgplayer-nostart")}},{key:"isPause",get:function(){return hasClass$1(this.player.root,"xgplayer-pause")}},{key:"isLoading",get:function(){return hasClass$1(this.player.root,"xgplayer-isloading")}},{key:"es",get:function(){return this.isPlaying?"playing":"beforePlay"}},{key:"lt",get:function(){var e=0;return 0===this.vt&&(log("lt init",this.playlogs.lt),e=curTimestamp()),e}},{key:"lpt",get:function(){return this.lt?this.lt-this.pt:0}},{key:"playback_state",get:function(){return this.isError?PLAYBACK_STATE.ERROR:this.isStop?PLAYBACK_STATE.STOP:this.isPause?PLAYBACK_STATE.PAUSE:this.isLoading?PLAYBACK_STATE.LOADING:PLAYBACK_STATE.PLAYING}},{key:"is_start_play_automatically",get:function(){return this.isAutoplay+""}},{key:"watchDur",get:function(){var e=this.player,t=this.playlogs;return e.cumulateTime?e.cumulateTime:computeWatchDur(t.played)}},{key:"vtype",get:function(){return this.__vtype?this.__vtype:this.player.dash?"DASH":"DASH"===this._options.vtype?"MP4":this._options.vtype||"MP4"},set:function(e){this.__vtype=e}},{key:"watingCost",get:function(){if(this.inWaitingStart>0){var e=nowTime()-this.inWaitingStart;return e>MAX_COST?0:e}return 0}},{key:"videoNetworkState",get:function(){var e=this.player;return e&&e.video?e.video.networkState:-1}},{key:"eagleid",get:function(){var e=this.player;return e&&e.__dash__&&e.__dash__.curReqVideoSegInfo?(e.__dash__.curReqVideoSegInfo.headers||{}).eagleid:""}},{key:"initial_type",get:function(){var e=this.player.config||{};return e&&e.vodLogOpts&&void 0!==e.vodLogOpts.currentDashType?parseInt(e.vodLogOpts.currentDashType,10):-1}},{key:"dynamicType",get:function(){var e=this.player;return this.__dt?this.__dt:e&&e.__dash__&&e.__dash__.dash&&e.__dash__.dash.mpd?(this.__dt=e.__dash__.dash.mpd.dashType,this.__dt):""}},{key:"updateCurBuffer",value:function(){var e=this.player,t=e.buffered,r=e.currentTime,n={buf_s_pos:0,buf_e_pos:0,buf_include:0},i=[];if(!t||t.length<1)return n;for(var o=-1,a=-1,s=t.length-1;s>-1;s--){var u=parseInt(1e3*t.start(s),10),c=parseInt(1e3*t.end(s),10);i.push({start:u,end:c}),r>u&&r<c?(n.buf_include=1,n.buf_s_pos=u,n.buf_e_pos=c):r<u&&(o<0||u-r<o)?(o=u-r,a=s):r>c&&(o<0||r-c<o)&&(o=r-c,a=s)}1!==n.buf_include&&a>-1&&(n.buf_s_pos=parseInt(1e3*t.start(a),10),n.buf_e_pos=parseInt(1e3*t.end(a),10)),n.buf_diff=parseInt(1e3*t.end(t.length-1)-1e3*r),this.buffers.allBuffer=i,this.buffers.curBuffer=n}},{key:"checkInBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.player.buffered;if(!r)return!1;e=parseInt(1e3*e,10);for(var n=0;n<r.length;n++){var i=parseInt(1e3*r.start(n),10)+t,o=parseInt(1e3*r.end(n),10)+t;if(e>i&&e<o)return!0}return!1}},{key:"updateVideoSize",value:function(){var e=this._options,t=this.player,r=this.resLogs,n=0,i=0;if(t.__dash__&&t.__dash__.dash&&t.__dash__.dash.mpd.mediaList){var o=t.__dash__.dash.mpd.mediaList.video,a=o[o.selectedIdx];log("updateVideoSize》》videoItem",a),i=a?a.bitrate||a.bandwidth:0,n=a?a.size:0}else{var s=this.player.curDefinition;s?(i=s.bitrate||t.config.bitrate||0,n=parseInt(s.bitrate*t.duration/8,10)):(n=e.videoSize||t.config.videoSize||0,i=e.bitrate||t.config.bitrate||0)}log("updateVideoSize","bitrate:".concat(i,", vs:").concat(n)),n&&(r.vs=n,r.vis=parseInt(n/t.duration,10),r.bitrate=i||r.vis)}},{key:"updateVds",value:function(){var e=this.resLogs,t=this.playlogs,r=this.player;if(0!==e.vis){for(var n=parseInt(computeWatchDur(t.played)/1e3,10),i=r.buffered,o=0,a=0;a<i.length;a++)o+=parseInt(i.end(a)-i.start(a),10);log("updateVds","pdur:".concat(n," bdur:").concat(o," \n         lbuf:").concat(e.lbuf," lplayed:").concat(e.lplayed," bitrate: ").concat(e.bitrate," vis:").concat(e.vis," vs:").concat(e.vs)),e.vps+=parseInt((n-e.lplayed)*e.vis,10),e.vds+=parseInt((o-e.lbuf)*e.vis,10),e.lplayed=n,e.lbuf=o}else log("updateVds","vis:".concat(e.vis))}}],[{key:"TEA_ID",get:function(){return TEA_ID},set:function(e){LS_KEY="__tea_cache_tokens_".concat(TEA_ID=e)}},{key:"AB_SDK_VERSION",get:function(){return AB_SDK_VERSION},set:function(e){AB_SDK_VERSION="Array"===typeOf(e)?e.join(","):e}},{key:"Collector",set:function(e){Collector=e}}]),t}();XGPlayerAppLogger.TEA_ID=1300,XGPlayerAppLogger.Collector=Collector$1$1;var xgVodLogger=function(e){if(e&&e.player){var t=e.player.config.vodLogOpts||{};e.player.vodLogger=new XGPlayerAppLogger(e.player,t),e.player.plugins.xgVodLogger=e.player.vodLogger}else this.vodLogger=new XGPlayerAppLogger(this,this.config.vodLogOpts||{})};xgVodLogger.pluginName="__xgVodLogger",xgVodLogger.playerConfig={},xgVodLogger.Collector=Collector$1$1,xgVodLogger.setABSdkVersion=function(e){XGPlayerAppLogger.AB_SDK_VERSION=e};var index_min$1={exports:{}},require$$0=getAugmentedNamespace(es);!function(e,t){e.exports=function(e){function t(){t=function(){return e};var e={},r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(C){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i,o,a,s,u=t&&t.prototype instanceof f?t:f,c=Object.create(u.prototype),h=new T(n||[]);return c._invoke=(i=e,o=r,a=h,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return{value:void 0,done:!0}}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){var n=A(r,a);if(n){if(n===d)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";var u=l(i,o,a);if("normal"===u.type){if(s=a.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s="completed",a.method="throw",a.arg=u.arg)}}),c}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(C){return{type:"throw",arg:C}}}e.wrap=c;var d={};function f(){}function h(){}function p(){}var g={};u(g,o,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y($([])));v&&v!==r&&n.call(v,o)&&(g=v);var m=p.prototype=f.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(i,o,a,s){var u=l(e[i],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==_typeof$3(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function A(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function $(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:w}}function w(){return{value:void 0,done:!0}}return h.prototype=p,u(m,"constructor",p),u(p,"constructor",h),h.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,u(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},_(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new b(c(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(m),u(m,s,"Generator"),u(m,o,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=$,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:$(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function r(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(DR){return!1}}function c(e,t,r){return(c=u()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&s(i,r.prototype),i}).apply(null,arguments)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==commonjsGlobal$1?commonjsGlobal$1:"undefined"!=typeof self?self:{},p=function(e){return e&&e.Math==Math&&e},g=p("object"==("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))&&globalThis)||p("object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window)||p("object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self)||p("object"==_typeof$3(h)&&h)||function(){return this}()||Function("return this")(),y={},v=function(e){try{return!!e()}catch(t){return!0}},m=!v((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),_=!v((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),b=_,A=Function.prototype.call,E=b?A.bind(A):function(){return A.apply(A,arguments)},S={},T={}.propertyIsEnumerable,$=Object.getOwnPropertyDescriptor,w=$&&!T.call({1:2},1);S.f=w?function(e){var t=$(this,e);return!!t&&t.enumerable}:T;var C,I,k=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},O=_,P=Function.prototype,R=P.bind,x=P.call,D=O&&R.bind(x,x),L=O?function(e){return e&&D(e)}:function(e){return e&&function(){return x.apply(e,arguments)}},N=L,M=N({}.toString),B=N("".slice),U=function(e){return B(M(e),8,-1)},j=v,F=U,V=Object,G=L("".split),H=j((function(){return!V("z").propertyIsEnumerable(0)}))?function(e){return"String"==F(e)?G(e,""):V(e)}:V,K=function(e){return null==e},z=K,W=TypeError,Y=function(e){if(z(e))throw W("Can't call method on "+e);return e},X=H,Z=Y,q=function(e){return X(Z(e))},Q=function(e){return"function"==typeof e},J=Q,ee="object"==("undefined"==typeof document?"undefined":_typeof$3(document))&&document.all,te=void 0===ee&&void 0!==ee?function(e){return"object"==_typeof$3(e)?null!==e:J(e)||e===ee}:function(e){return"object"==_typeof$3(e)?null!==e:J(e)},re=g,ne=Q,ie=function(e){return ne(e)?e:void 0},oe=function(e,t){return arguments.length<2?ie(re[e]):re[e]&&re[e][t]},ae=L({}.isPrototypeOf),se=oe("navigator","userAgent")||"",ue=g,ce=se,le=ue.process,de=ue.Deno,fe=le&&le.versions||de&&de.version,he=fe&&fe.v8;he&&(I=(C=he.split("."))[0]>0&&C[0]<4?1:+(C[0]+C[1])),!I&&ce&&(!(C=ce.match(/Edge\/(\d+)/))||C[1]>=74)&&(C=ce.match(/Chrome\/(\d+)/))&&(I=+C[1]);var pe=I,ge=pe,ye=v,ve=!!Object.getOwnPropertySymbols&&!ye((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ge&&ge<41})),me=ve&&!Symbol.sham&&"symbol"==_typeof$3(Symbol.iterator),_e=oe,be=Q,Ae=ae,Ee=Object,Se=me?function(e){return"symbol"==_typeof$3(e)}:function(e){var t=_e("Symbol");return be(t)&&Ae(t.prototype,Ee(e))},Te=String,$e=function(e){try{return Te(e)}catch(t){return"Object"}},we=Q,Ce=$e,Ie=TypeError,ke=function(e){if(we(e))return e;throw Ie(Ce(e)+" is not a function")},Oe=ke,Pe=K,Re=function(e,t){var r=e[t];return Pe(r)?void 0:Oe(r)},xe=E,De=Q,Le=te,Ne=TypeError,Me={exports:{}},Be=g,Ue=Object.defineProperty,je=function(e,t){try{Ue(Be,e,{value:t,configurable:!0,writable:!0})}catch(r){Be[e]=t}return t},Fe=je,Ve="__core-js_shared__",Ge=g[Ve]||Fe(Ve,{}),He=Ge;(Me.exports=function(e,t){return He[e]||(He[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.25.0",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ke=Y,ze=Object,We=function(e){return ze(Ke(e))},Ye=We,Xe=L({}.hasOwnProperty),Ze=Object.hasOwn||function(e,t){return Xe(Ye(e),t)},qe=L,Qe=0,Je=Math.random(),et=qe(1..toString),tt=function(e){return"Symbol("+(void 0===e?"":e)+")_"+et(++Qe+Je,36)},rt=g,nt=Me.exports,it=Ze,ot=tt,at=ve,st=me,ut=nt("wks"),ct=rt.Symbol,lt=ct&&ct.for,dt=st?ct:ct&&ct.withoutSetter||ot,ft=function(e){if(!it(ut,e)||!at&&"string"!=typeof ut[e]){var t="Symbol."+e;at&&it(ct,e)?ut[e]=ct[e]:ut[e]=st&&lt?lt(t):dt(t)}return ut[e]},ht=E,pt=te,gt=Se,yt=Re,vt=function(e,t){var r,n;if("string"===t&&De(r=e.toString)&&!Le(n=xe(r,e)))return n;if(De(r=e.valueOf)&&!Le(n=xe(r,e)))return n;if("string"!==t&&De(r=e.toString)&&!Le(n=xe(r,e)))return n;throw Ne("Can't convert object to primitive value")},mt=TypeError,_t=ft("toPrimitive"),bt=function(e,t){if(!pt(e)||gt(e))return e;var r,n=yt(e,_t);if(n){if(void 0===t&&(t="default"),r=ht(n,e,t),!pt(r)||gt(r))return r;throw mt("Can't convert object to primitive value")}return void 0===t&&(t="number"),vt(e,t)},At=bt,Et=Se,St=function(e){var t=At(e,"string");return Et(t)?t:t+""},Tt=te,$t=g.document,wt=Tt($t)&&Tt($t.createElement),Ct=function(e){return wt?$t.createElement(e):{}},It=Ct,kt=!m&&!v((function(){return 7!=Object.defineProperty(It("div"),"a",{get:function(){return 7}}).a})),Ot=m,Pt=E,Rt=S,xt=k,Dt=q,Lt=St,Nt=Ze,Mt=kt,Bt=Object.getOwnPropertyDescriptor;y.f=Ot?Bt:function(e,t){if(e=Dt(e),t=Lt(t),Mt)try{return Bt(e,t)}catch(r){}if(Nt(e,t))return xt(!Pt(Rt.f,e,t),e[t])};var Ut={},jt=m&&v((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Ft=te,Vt=String,Gt=TypeError,Ht=function(e){if(Ft(e))return e;throw Gt(Vt(e)+" is not an object")},Kt=m,zt=kt,Wt=jt,Yt=Ht,Xt=St,Zt=TypeError,qt=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,Jt="enumerable",er="configurable",tr="writable";Ut.f=Kt?Wt?function(e,t,r){if(Yt(e),t=Xt(t),Yt(r),"function"==typeof e&&"prototype"===t&&"value"in r&&tr in r&&!r.writable){var n=Qt(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:er in r?r.configurable:n.configurable,enumerable:Jt in r?r.enumerable:n.enumerable,writable:!1})}return qt(e,t,r)}:qt:function(e,t,r){if(Yt(e),t=Xt(t),Yt(r),zt)try{return qt(e,t,r)}catch(n){}if("get"in r||"set"in r)throw Zt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var rr=Ut,nr=k,ir=m?function(e,t,r){return rr.f(e,t,nr(1,r))}:function(e,t,r){return e[t]=r,e},or={exports:{}},ar=m,sr=Ze,ur=Function.prototype,cr=ar&&Object.getOwnPropertyDescriptor,lr=sr(ur,"name"),dr={EXISTS:lr,PROPER:lr&&"something"===function(){}.name,CONFIGURABLE:lr&&(!ar||ar&&cr(ur,"name").configurable)},fr=Q,hr=Ge,pr=L(Function.toString);fr(hr.inspectSource)||(hr.inspectSource=function(e){return pr(e)});var gr,yr,vr,mr=hr.inspectSource,_r=Q,br=g.WeakMap,Ar=_r(br)&&/native code/.test(String(br)),Er=Me.exports,Sr=tt,Tr=Er("keys"),$r=function(e){return Tr[e]||(Tr[e]=Sr(e))},wr={},Cr=Ar,Ir=g,kr=L,Or=te,Pr=ir,Rr=Ze,xr=Ge,Dr=$r,Lr=wr,Nr="Object already initialized",Mr=Ir.TypeError,Br=Ir.WeakMap;if(Cr||xr.state){var Ur=xr.state||(xr.state=new Br),jr=kr(Ur.get),Fr=kr(Ur.has),Vr=kr(Ur.set);gr=function(e,t){if(Fr(Ur,e))throw Mr(Nr);return t.facade=e,Vr(Ur,e,t),t},yr=function(e){return jr(Ur,e)||{}},vr=function(e){return Fr(Ur,e)}}else{var Gr=Dr("state");Lr[Gr]=!0,gr=function(e,t){if(Rr(e,Gr))throw Mr(Nr);return t.facade=e,Pr(e,Gr,t),t},yr=function(e){return Rr(e,Gr)?e[Gr]:{}},vr=function(e){return Rr(e,Gr)}}var Hr={set:gr,get:yr,has:vr,enforce:function(e){return vr(e)?yr(e):gr(e,{})},getterFor:function(e){return function(t){var r;if(!Or(t)||(r=yr(t)).type!==e)throw Mr("Incompatible receiver, "+e+" required");return r}}},Kr=v,zr=Q,Wr=Ze,Yr=m,Xr=dr.CONFIGURABLE,Zr=mr,qr=Hr.enforce,Qr=Hr.get,Jr=Object.defineProperty,en=Yr&&!Kr((function(){return 8!==Jr((function(){}),"length",{value:8}).length})),tn=String(String).split("String"),rn=or.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Wr(e,"name")||Xr&&e.name!==t)&&(Yr?Jr(e,"name",{value:t,configurable:!0}):e.name=t),en&&r&&Wr(r,"arity")&&e.length!==r.arity&&Jr(e,"length",{value:r.arity});try{r&&Wr(r,"constructor")&&r.constructor?Yr&&Jr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var n=qr(e);return Wr(n,"source")||(n.source=tn.join("string"==typeof t?t:"")),e};Function.prototype.toString=rn((function(){return zr(this)&&Qr(this).source||Zr(this)}),"toString");var nn=Q,on=Ut,an=or.exports,sn=je,un=function(e,t,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:t;if(nn(r)&&an(r,o,n),n.global)i?e[t]=r:sn(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch(a){}i?e[t]=r:on.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},cn={},ln=Math.ceil,dn=Math.floor,fn=Math.trunc||function(e){var t=+e;return(t>0?dn:ln)(t)},hn=function(e){var t=+e;return t!=t||0===t?0:fn(t)},pn=hn,gn=Math.max,yn=Math.min,vn=function(e,t){var r=pn(e);return r<0?gn(r+t,0):yn(r,t)},mn=hn,_n=Math.min,bn=function(e){return e>0?_n(mn(e),9007199254740991):0},An=bn,En=function(e){return An(e.length)},Sn=q,Tn=vn,$n=En,wn=function(e){return function(t,r,n){var i,o=Sn(t),a=$n(o),s=Tn(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},Cn={includes:wn(!0),indexOf:wn(!1)},In=Ze,kn=q,On=Cn.indexOf,Pn=wr,Rn=L([].push),xn=function(e,t){var r,n=kn(e),i=0,o=[];for(r in n)!In(Pn,r)&&In(n,r)&&Rn(o,r);for(;t.length>i;)In(n,r=t[i++])&&(~On(o,r)||Rn(o,r));return o},Dn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ln=xn,Nn=Dn.concat("length","prototype");cn.f=Object.getOwnPropertyNames||function(e){return Ln(e,Nn)};var Mn={};Mn.f=Object.getOwnPropertySymbols;var Bn=oe,Un=cn,jn=Mn,Fn=Ht,Vn=L([].concat),Gn=Bn("Reflect","ownKeys")||function(e){var t=Un.f(Fn(e)),r=jn.f;return r?Vn(t,r(e)):t},Hn=Ze,Kn=Gn,zn=y,Wn=Ut,Yn=function(e,t,r){for(var n=Kn(t),i=Wn.f,o=zn.f,a=0;a<n.length;a++){var s=n[a];Hn(e,s)||r&&Hn(r,s)||i(e,s,o(t,s))}},Xn=v,Zn=Q,qn=/#|\.prototype\./,Qn=function(e,t){var r=ei[Jn(e)];return r==ri||r!=ti&&(Zn(t)?Xn(t):!!t)},Jn=Qn.normalize=function(e){return String(e).replace(qn,".").toLowerCase()},ei=Qn.data={},ti=Qn.NATIVE="N",ri=Qn.POLYFILL="P",ni=Qn,ii=g,oi=y.f,ai=ir,si=un,ui=je,ci=Yn,li=ni,di=function(e,t){var r,n,i,o,a,s=e.target,u=e.global,c=e.stat;if(r=u?ii:c?ii[s]||ui(s,{}):(ii[s]||{}).prototype)for(n in t){if(o=t[n],i=e.dontCallGetSet?(a=oi(r,n))&&a.value:r[n],!li(u?n:s+(c?".":"#")+n,e.forced)&&void 0!==i){if(_typeof$3(o)==_typeof$3(i))continue;ci(o,i)}(e.sham||i&&i.sham)&&ai(o,"sham",!0),si(r,n,o,e)}},fi=U,hi=Array.isArray||function(e){return"Array"==fi(e)},pi=TypeError,gi=function(e){if(e>9007199254740991)throw pi("Maximum allowed index exceeded");return e},yi=St,vi=Ut,mi=k,_i=function(e,t,r){var n=yi(t);n in e?vi.f(e,n,mi(0,r)):e[n]=r},bi={};bi[ft("toStringTag")]="z";var Ai="[object z]"===String(bi),Ei=Ai,Si=Q,Ti=U,$i=ft("toStringTag"),wi=Object,Ci="Arguments"==Ti(function(){return arguments}()),Ii=Ei?Ti:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=wi(e),$i))?r:Ci?Ti(t):"Object"==(n=Ti(t))&&Si(t.callee)?"Arguments":n},ki=L,Oi=v,Pi=Q,Ri=Ii,xi=mr,Di=function(){},Li=[],Ni=oe("Reflect","construct"),Mi=/^\s*(?:class|function)\b/,Bi=ki(Mi.exec),Ui=!Mi.exec(Di),ji=function(e){if(!Pi(e))return!1;try{return Ni(Di,Li,e),!0}catch(t){return!1}},Fi=function(e){if(!Pi(e))return!1;switch(Ri(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ui||!!Bi(Mi,xi(e))}catch(t){return!0}};Fi.sham=!0;var Vi=!Ni||Oi((function(){var e;return ji(ji.call)||!ji(Object)||!ji((function(){e=!0}))||e}))?Fi:ji,Gi=hi,Hi=Vi,Ki=te,zi=ft("species"),Wi=Array,Yi=function(e){var t;return Gi(e)&&(t=e.constructor,(Hi(t)&&(t===Wi||Gi(t.prototype))||Ki(t)&&null===(t=t[zi]))&&(t=void 0)),void 0===t?Wi:t},Xi=function(e,t){return new(Yi(e))(0===t?0:t)},Zi=v,qi=pe,Qi=ft("species"),Ji=function(e){return qi>=51||!Zi((function(){var t=[];return(t.constructor={})[Qi]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},eo=di,to=v,ro=hi,no=te,io=We,oo=En,ao=gi,so=_i,uo=Xi,co=Ji,lo=pe,fo=ft("isConcatSpreadable"),ho=lo>=51||!to((function(){var e=[];return e[fo]=!1,e.concat()[0]!==e})),po=co("concat"),go=function(e){if(!no(e))return!1;var t=e[fo];return void 0!==t?!!t:ro(e)};eo({target:"Array",proto:!0,arity:1,forced:!ho||!po},{concat:function(e){var t,r,n,i,o,a=io(this),s=uo(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(go(o=-1===t?a:arguments[t]))for(i=oo(o),ao(u+i),r=0;r<i;r++,u++)r in o&&so(s,u,o[r]);else ao(u+1),so(s,u++,o);return s.length=u,s}});var yo=Ii,vo=Ai?{}.toString:function(){return"[object "+yo(this)+"]"};Ai||un(Object.prototype,"toString",vo,{unsafe:!0});var mo,_o,bo,Ao,Eo="process"==U(g.process),So=Q,To=String,$o=TypeError,wo=L,Co=Ht,Io=function(e){if("object"==_typeof$3(e)||So(e))return e;throw $o("Can't set "+To(e)+" as a prototype")},ko=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=wo(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(n){}return function(r,n){return Co(r),Io(n),t?e(r,n):r.__proto__=n,r}}():void 0),Oo=Ut.f,Po=Ze,Ro=ft("toStringTag"),xo=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Po(e,Ro)&&Oo(e,Ro,{configurable:!0,value:t})},Do=oe,Lo=Ut,No=m,Mo=ft("species"),Bo=function(e){var t=Do(e),r=Lo.f;No&&t&&!t[Mo]&&r(t,Mo,{configurable:!0,get:function(){return this}})},Uo=ae,jo=TypeError,Fo=function(e,t){if(Uo(t,e))return e;throw jo("Incorrect invocation")},Vo=Vi,Go=$e,Ho=TypeError,Ko=function(e){if(Vo(e))return e;throw Ho(Go(e)+" is not a constructor")},zo=Ht,Wo=Ko,Yo=K,Xo=ft("species"),Zo=function(e,t){var r,n=zo(e).constructor;return void 0===n||Yo(r=zo(n)[Xo])?t:Wo(r)},qo=_,Qo=Function.prototype,Jo=Qo.apply,ea=Qo.call,ta="object"==("undefined"==typeof Reflect?"undefined":_typeof$3(Reflect))&&Reflect.apply||(qo?ea.bind(Jo):function(){return ea.apply(Jo,arguments)}),ra=ke,na=_,ia=L(L.bind),oa=function(e,t){return ra(e),void 0===t?e:na?ia(e,t):function(){return e.apply(t,arguments)}},aa=oe("document","documentElement"),sa=L([].slice),ua=TypeError,ca=function(e,t){if(e<t)throw ua("Not enough arguments");return e},la=/(?:ipad|iphone|ipod).*applewebkit/i.test(se),da=g,fa=ta,ha=oa,pa=Q,ga=Ze,ya=v,va=aa,ma=sa,_a=Ct,ba=ca,Aa=la,Ea=Eo,Sa=da.setImmediate,Ta=da.clearImmediate,$a=da.process,wa=da.Dispatch,Ca=da.Function,Ia=da.MessageChannel,ka=da.String,Oa=0,Pa={},Ra="onreadystatechange";try{mo=da.location}catch(EU){}var xa=function(e){if(ga(Pa,e)){var t=Pa[e];delete Pa[e],t()}},Da=function(e){return function(){xa(e)}},La=function(e){xa(e.data)},Na=function(e){da.postMessage(ka(e),mo.protocol+"//"+mo.host)};Sa&&Ta||(Sa=function(e){ba(arguments.length,1);var t=pa(e)?e:Ca(e),r=ma(arguments,1);return Pa[++Oa]=function(){fa(t,void 0,r)},_o(Oa),Oa},Ta=function(e){delete Pa[e]},Ea?_o=function(e){$a.nextTick(Da(e))}:wa&&wa.now?_o=function(e){wa.now(Da(e))}:Ia&&!Aa?(Ao=(bo=new Ia).port2,bo.port1.onmessage=La,_o=ha(Ao.postMessage,Ao)):da.addEventListener&&pa(da.postMessage)&&!da.importScripts&&mo&&"file:"!==mo.protocol&&!ya(Na)?(_o=Na,da.addEventListener("message",La,!1)):_o=Ra in _a("script")?function(e){va.appendChild(_a("script")).onreadystatechange=function(){va.removeChild(this),xa(e)}}:function(e){setTimeout(Da(e),0)});var Ma,Ba,Ua,ja,Fa,Va,Ga,Ha,Ka={set:Sa,clear:Ta},za=g,Wa=/ipad|iphone|ipod/i.test(se)&&void 0!==za.Pebble,Ya=/web0s(?!.*chrome)/i.test(se),Xa=g,Za=oa,qa=y.f,Qa=Ka.set,Ja=la,es=Wa,ts=Ya,rs=Eo,ns=Xa.MutationObserver||Xa.WebKitMutationObserver,is=Xa.document,os=Xa.process,as=Xa.Promise,ss=qa(Xa,"queueMicrotask"),us=ss&&ss.value;us||(Ma=function(){var e,t;for(rs&&(e=os.domain)&&e.exit();Ba;){t=Ba.fn,Ba=Ba.next;try{t()}catch(EU){throw Ba?ja():Ua=void 0,EU}}Ua=void 0,e&&e.enter()},Ja||rs||ts||!ns||!is?!es&&as&&as.resolve?((Ga=as.resolve(void 0)).constructor=as,Ha=Za(Ga.then,Ga),ja=function(){Ha(Ma)}):rs?ja=function(){os.nextTick(Ma)}:(Qa=Za(Qa,Xa),ja=function(){Qa(Ma)}):(Fa=!0,Va=is.createTextNode(""),new ns(Ma).observe(Va,{characterData:!0}),ja=function(){Va.data=Fa=!Fa}));var cs=us||function(e){var t={fn:e,next:void 0};Ua&&(Ua.next=t),Ba||(Ba=t,ja()),Ua=t},ls=g,ds=function(e){try{return{error:!1,value:e()}}catch(EU){return{error:!0,value:EU}}},fs=function(){this.head=null,this.tail=null};fs.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var hs=fs,ps=g.Promise,gs="object"==("undefined"==typeof Deno?"undefined":_typeof$3(Deno))&&Deno&&"object"==_typeof$3(Deno.version),ys=!gs&&!Eo&&"object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&"object"==("undefined"==typeof document?"undefined":_typeof$3(document)),vs=g,ms=ps,_s=Q,bs=ni,As=mr,Es=ft,Ss=ys,Ts=gs,$s=pe;ms&&ms.prototype;var ws=Es("species"),Cs=!1,Is=_s(vs.PromiseRejectionEvent),ks={CONSTRUCTOR:bs("Promise",(function(){var e=As(ms),t=e!==String(ms);if(!t&&66===$s)return!0;if(!$s||$s<51||!/native code/.test(e)){var r=new ms((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((r.constructor={})[ws]=n,!(Cs=r.then((function(){}))instanceof n))return!0}return!t&&(Ss||Ts)&&!Is})),REJECTION_EVENT:Is,SUBCLASSING:Cs},Os={},Ps=ke,Rs=TypeError,xs=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw Rs("Bad Promise constructor");t=e,r=n})),this.resolve=Ps(t),this.reject=Ps(r)};Os.f=function(e){return new xs(e)};var Ds,Ls,Ns,Ms=di,Bs=Eo,Us=g,js=E,Fs=un,Vs=ko,Gs=xo,Hs=Bo,Ks=ke,zs=Q,Ws=te,Ys=Fo,Xs=Zo,Zs=Ka.set,qs=cs,Qs=function(e,t){var r=ls.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},Js=ds,eu=hs,tu=Hr,ru=ps,nu=Os,iu="Promise",ou=ks.CONSTRUCTOR,au=ks.REJECTION_EVENT,su=ks.SUBCLASSING,uu=tu.getterFor(iu),cu=tu.set,lu=ru&&ru.prototype,du=ru,fu=lu,hu=Us.TypeError,pu=Us.document,gu=Us.process,yu=nu.f,vu=yu,mu=!!(pu&&pu.createEvent&&Us.dispatchEvent),_u="unhandledrejection",bu=function(e){var t;return!(!Ws(e)||!zs(t=e.then))&&t},Au=function(e,t){var r,n,i,o=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&wu(t),t.rejection=1),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(hu("Promise-chain cycle")):(n=bu(r))?js(n,r,u,c):u(r)):c(o)}catch(EU){l&&!i&&l.exit(),c(EU)}},Eu=function(e,t){e.notified||(e.notified=!0,qs((function(){for(var r,n=e.reactions;r=n.get();)Au(r,e);e.notified=!1,t&&!e.rejection&&Tu(e)})))},Su=function(e,t,r){var n,i;mu?((n=pu.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),Us.dispatchEvent(n)):n={promise:t,reason:r},!au&&(i=Us["on"+e])?i(n):e===_u&&Qs("Unhandled promise rejection",r)},Tu=function(e){js(Zs,Us,(function(){var t,r=e.facade,n=e.value;if($u(e)&&(t=Js((function(){Bs?gu.emit("unhandledRejection",n,r):Su(_u,r,n)})),e.rejection=Bs||$u(e)?2:1,t.error))throw t.value}))},$u=function(e){return 1!==e.rejection&&!e.parent},wu=function(e){js(Zs,Us,(function(){var t=e.facade;Bs?gu.emit("rejectionHandled",t):Su("rejectionhandled",t,e.value)}))},Cu=function(e,t,r){return function(n){e(t,n,r)}},Iu=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,Eu(e,!0))},ku=function e(t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===r)throw hu("Promise can't be resolved itself");var i=bu(r);i?qs((function(){var n={done:!1};try{js(i,r,Cu(e,n,t),Cu(Iu,n,t))}catch(EU){Iu(n,EU,t)}})):(t.value=r,t.state=1,Eu(t,!1))}catch(EU){Iu({done:!1},EU,t)}}};if(ou&&(fu=(du=function(e){Ys(this,fu),Ks(e),js(Ds,this);var t=uu(this);try{e(Cu(ku,t),Cu(Iu,t))}catch(EU){Iu(t,EU)}}).prototype,(Ds=function(e){cu(this,{type:iu,done:!1,notified:!1,parent:!1,reactions:new eu,rejection:!1,state:0,value:void 0})}).prototype=Fs(fu,"then",(function(e,t){var r=uu(this),n=yu(Xs(this,du));return r.parent=!0,n.ok=!zs(e)||e,n.fail=zs(t)&&t,n.domain=Bs?gu.domain:void 0,0==r.state?r.reactions.add(n):qs((function(){Au(n,r)})),n.promise})),Ls=function(){var e=new Ds,t=uu(e);this.promise=e,this.resolve=Cu(ku,t),this.reject=Cu(Iu,t)},nu.f=yu=function(e){return e===du||void 0===e?new Ls(e):vu(e)},zs(ru)&&lu!==Object.prototype)){Ns=lu.then,su||Fs(lu,"then",(function(e,t){var r=this;return new du((function(e,t){js(Ns,r,e,t)})).then(e,t)}),{unsafe:!0});try{delete lu.constructor}catch(EU){}Vs&&Vs(lu,fu)}Ms({global:!0,constructor:!0,wrap:!0,forced:ou},{Promise:du}),Gs(du,iu,!1),Hs(iu);var Ou={},Pu=Ou,Ru=ft("iterator"),xu=Array.prototype,Du=function(e){return void 0!==e&&(Pu.Array===e||xu[Ru]===e)},Lu=Ii,Nu=Re,Mu=K,Bu=Ou,Uu=ft("iterator"),ju=function(e){if(!Mu(e))return Nu(e,Uu)||Nu(e,"@@iterator")||Bu[Lu(e)]},Fu=E,Vu=ke,Gu=Ht,Hu=$e,Ku=ju,zu=TypeError,Wu=function(e,t){var r=arguments.length<2?Ku(e):t;if(Vu(r))return Gu(Fu(r,e));throw zu(Hu(e)+" is not iterable")},Yu=E,Xu=Ht,Zu=Re,qu=function(e,t,r){var n,i;Xu(e);try{if(!(n=Zu(e,"return"))){if("throw"===t)throw r;return r}n=Yu(n,e)}catch(EU){i=!0,n=EU}if("throw"===t)throw r;if(i)throw n;return Xu(n),r},Qu=oa,Ju=E,ec=Ht,tc=$e,rc=Du,nc=En,ic=ae,oc=Wu,ac=ju,sc=qu,uc=TypeError,cc=function(e,t){this.stopped=e,this.result=t},lc=cc.prototype,dc=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),g=Qu(t,l),y=function(e){return n&&sc(n,"normal",e),new cc(!0,e)},v=function(e){return d?(ec(e),p?g(e[0],e[1],y):g(e[0],e[1])):p?g(e,y):g(e)};if(f)n=e.iterator;else if(h)n=e;else{if(!(i=ac(e)))throw uc(tc(e)+" is not iterable");if(rc(i)){for(o=0,a=nc(e);a>o;o++)if((s=v(e[o]))&&ic(lc,s))return s;return new cc(!1)}n=oc(e,i)}for(u=f?e.next:n.next;!(c=Ju(u,n)).done;){try{s=v(c.value)}catch(EU){sc(n,"throw",EU)}if("object"==_typeof$3(s)&&s&&ic(lc,s))return s}return new cc(!1)},fc=ft("iterator"),hc=!1;try{var pc=0,gc={next:function(){return{done:!!pc++}},return:function(){hc=!0}};gc[fc]=function(){return this},Array.from(gc,(function(){throw 2}))}catch(EU){}var yc=function(e,t){if(!t&&!hc)return!1;var r=!1;try{var n={};n[fc]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(EU){}return r},vc=ps,mc=ks.CONSTRUCTOR||!yc((function(e){vc.all(e).then(void 0,(function(){}))})),_c=E,bc=ke,Ac=Os,Ec=ds,Sc=dc;di({target:"Promise",stat:!0,forced:mc},{all:function(e){var t=this,r=Ac.f(t),n=r.resolve,i=r.reject,o=Ec((function(){var r=bc(t.resolve),o=[],a=0,s=1;Sc(e,(function(e){var u=a++,c=!1;s++,_c(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise}});var Tc=di,$c=ks.CONSTRUCTOR,wc=ps,Cc=oe,Ic=Q,kc=un,Oc=wc&&wc.prototype;if(Tc({target:"Promise",proto:!0,forced:$c,real:!0},{catch:function(e){return this.then(void 0,e)}}),Ic(wc)){var Pc=Cc("Promise").prototype.catch;Oc.catch!==Pc&&kc(Oc,"catch",Pc,{unsafe:!0})}var Rc=E,xc=ke,Dc=Os,Lc=ds,Nc=dc;di({target:"Promise",stat:!0,forced:mc},{race:function(e){var t=this,r=Dc.f(t),n=r.reject,i=Lc((function(){var i=xc(t.resolve);Nc(e,(function(e){Rc(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var Mc=E,Bc=Os;di({target:"Promise",stat:!0,forced:ks.CONSTRUCTOR},{reject:function(e){var t=Bc.f(this);return Mc(t.reject,void 0,e),t.promise}});var Uc=Ht,jc=te,Fc=Os,Vc=function(e,t){if(Uc(e),jc(t)&&t.constructor===e)return t;var r=Fc.f(e);return(0,r.resolve)(t),r.promise},Gc=di,Hc=ks.CONSTRUCTOR,Kc=Vc;oe("Promise"),Gc({target:"Promise",stat:!0,forced:Hc},{resolve:function(e){return Kc(this,e)}});var zc=Ii,Wc=String,Yc=function(e){if("Symbol"===zc(e))throw TypeError("Cannot convert a Symbol value to a string");return Wc(e)},Xc=hn,Zc=Yc,qc=Y,Qc=RangeError,Jc=function(e){var t=Zc(qc(this)),r="",n=Xc(e);if(n<0||n==1/0)throw Qc("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r};di({target:"String",proto:!0},{repeat:Jc});var el=Ht,tl=function(){var e=el(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},rl=v,nl=g.RegExp,il=rl((function(){var e=nl("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),ol=il||rl((function(){return!nl("a","y").sticky})),al={BROKEN_CARET:il||rl((function(){var e=nl("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:ol,UNSUPPORTED_Y:il},sl={},ul=xn,cl=Dn,ll=Object.keys||function(e){return ul(e,cl)},dl=m,fl=jt,hl=Ut,pl=Ht,gl=q,yl=ll;sl.f=dl&&!fl?Object.defineProperties:function(e,t){pl(e);for(var r,n=gl(t),i=yl(t),o=i.length,a=0;o>a;)hl.f(e,r=i[a++],n[r]);return e};var vl,ml=Ht,_l=sl,bl=Dn,Al=wr,El=aa,Sl=Ct,Tl=$r("IE_PROTO"),$l=function(){},wl=function(e){return"<script>"+e+"<\/script>"},Cl=function(e){e.write(wl("")),e.close();var t=e.parentWindow.Object;return e=null,t},Il=function(){try{vl=new ActiveXObject("htmlfile")}catch(EU){}var e,t;Il="undefined"!=typeof document?document.domain&&vl?Cl(vl):((t=Sl("iframe")).style.display="none",El.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(wl("document.F=Object")),e.close(),e.F):Cl(vl);for(var r=bl.length;r--;)delete Il.prototype[bl[r]];return Il()};Al[Tl]=!0;var kl,Ol,Pl=Object.create||function(e,t){var r;return null!==e?($l.prototype=ml(e),r=new $l,$l.prototype=null,r[Tl]=e):r=Il(),void 0===t?r:_l.f(r,t)},Rl=v,xl=g.RegExp,Dl=Rl((function(){var e=xl(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Ll=v,Nl=g.RegExp,Ml=Ll((function(){var e=Nl("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Bl=E,Ul=L,jl=Yc,Fl=tl,Vl=al,Gl=Me.exports,Hl=Pl,Kl=Hr.get,zl=Dl,Wl=Ml,Yl=Gl("native-string-replace",String.prototype.replace),Xl=RegExp.prototype.exec,Zl=Xl,ql=Ul("".charAt),Ql=Ul("".indexOf),Jl=Ul("".replace),ed=Ul("".slice),td=(Ol=/b*/g,Bl(Xl,kl=/a/,"a"),Bl(Xl,Ol,"a"),0!==kl.lastIndex||0!==Ol.lastIndex),rd=Vl.BROKEN_CARET,nd=void 0!==/()??/.exec("")[1];(td||nd||rd||zl||Wl)&&(Zl=function(e){var t,r,n,i,o,a,s,u=this,c=Kl(u),l=jl(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=Bl(Zl,d,l),u.lastIndex=d.lastIndex,t;var f=c.groups,h=rd&&u.sticky,p=Bl(Fl,u),g=u.source,y=0,v=l;if(h&&(p=Jl(p,"y",""),-1===Ql(p,"g")&&(p+="g"),v=ed(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==ql(l,u.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",p)),nd&&(r=new RegExp("^"+g+"$(?!\\s)",p)),td&&(n=u.lastIndex),i=Bl(Xl,h?r:u,v),h?i?(i.input=ed(i.input,y),i[0]=ed(i[0],y),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:td&&i&&(u.lastIndex=u.global?i.index+i[0].length:n),nd&&i&&i.length>1&&Bl(Yl,i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&f)for(i.groups=a=Hl(null),o=0;o<f.length;o++)a[(s=f[o])[0]]=i[s[1]];return i});var id=Zl;di({target:"RegExp",proto:!0,forced:/./.exec!==id},{exec:id});var od=oa,ad=H,sd=We,ud=En,cd=Xi,ld=L([].push),dd=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(u,c,l,d){for(var f,h,p=sd(u),g=ad(p),y=od(c,l),v=ud(g),m=0,_=d||cd,b=t?_(u,v):r||a?_(u,0):void 0;v>m;m++)if((s||m in g)&&(h=y(f=g[m],m,p),e))if(t)b[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:ld(b,f)}else switch(e){case 4:return!1;case 7:ld(b,f)}return o?-1:n||i?i:b}},fd={forEach:dd(0),map:dd(1),filter:dd(2),some:dd(3),every:dd(4),find:dd(5),findIndex:dd(6),filterReject:dd(7)},hd=fd.map;di({target:"Array",proto:!0,forced:!Ji("map")},{map:function(e){return hd(this,e,arguments.length>1?arguments[1]:void 0)}});var pd=We,gd=ll;di({target:"Object",stat:!0,forced:v((function(){gd(1)}))},{keys:function(e){return gd(pd(e))}});var yd=$e,vd=TypeError,md=function(e,t){if(!delete e[t])throw vd("Cannot delete property "+yd(t)+" of "+yd(e))},_d=vn,bd=En,Ad=_i,Ed=Array,Sd=Math.max,Td=function(e,t,r){for(var n=bd(e),i=_d(t,n),o=_d(void 0===r?n:r,n),a=Ed(Sd(o-i,0)),s=0;i<o;i++,s++)Ad(a,s,e[i]);return a.length=s,a},$d=Td,wd=Math.floor,Cd=function e(t,r){var n=t.length,i=wd(n/2);return n<8?Id(t,r):kd(t,e($d(t,0,i),r),e($d(t,i),r),r)},Id=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},kd=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e},Od=Cd,Pd=v,Rd=function(e,t){var r=[][e];return!!r&&Pd((function(){r.call(null,t||function(){return 1},1)}))},xd=se.match(/firefox\/(\d+)/i),Dd=!!xd&&+xd[1],Ld=/MSIE|Trident/.test(se),Nd=se.match(/AppleWebKit\/(\d+)\./),Md=!!Nd&&+Nd[1],Bd=di,Ud=L,jd=ke,Fd=We,Vd=En,Gd=md,Hd=Yc,Kd=v,zd=Od,Wd=Rd,Yd=Dd,Xd=Ld,Zd=pe,qd=Md,Qd=[],Jd=Ud(Qd.sort),ef=Ud(Qd.push),tf=Kd((function(){Qd.sort(void 0)})),rf=Kd((function(){Qd.sort(null)})),nf=Wd("sort"),of=!Kd((function(){if(Zd)return Zd<70;if(!(Yd&&Yd>3)){if(Xd)return!0;if(qd)return qd<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)Qd.push({k:t+n,v:r})}for(Qd.sort((function(e,t){return t.v-e.v})),n=0;n<Qd.length;n++)t=Qd[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));Bd({target:"Array",proto:!0,forced:tf||!rf||!nf||!of},{sort:function(e){void 0!==e&&jd(e);var t=Fd(this);if(of)return void 0===e?Jd(t):Jd(t,e);var r,n,i=[],o=Vd(t);for(n=0;n<o;n++)n in t&&ef(i,t[n]);for(zd(i,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:Hd(t)>Hd(r)?1:-1}}(e)),r=Vd(i),n=0;n<r;)t[n]=i[n++];for(;n<o;)Gd(t,n++);return t}});var af=m,sf=hi,uf=TypeError,cf=Object.getOwnPropertyDescriptor,lf=af&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(EU){return EU instanceof TypeError}}(),df=di,ff=We,hf=vn,pf=hn,gf=En,yf=lf?function(e,t){if(sf(e)&&!cf(e,"length").writable)throw uf("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},vf=gi,mf=Xi,_f=_i,bf=md,Af=Ji("splice"),Ef=Math.max,Sf=Math.min;df({target:"Array",proto:!0,forced:!Af},{splice:function(e,t){var r,n,i,o,a,s,u=ff(this),c=gf(u),l=hf(e,c),d=arguments.length;for(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=Sf(Ef(pf(t),0),c-l)),vf(c+r-n),i=mf(u,n),o=0;o<n;o++)(a=l+o)in u&&_f(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:bf(u,s);for(o=c;o>c-n+r;o--)bf(u,o-1)}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:bf(u,s);for(o=0;o<r;o++)u[o+l]=arguments[o+2];return yf(u,c-n+r),i}});var Tf=di,$f=Cn.indexOf,wf=Rd,Cf=L([].indexOf),If=!!Cf&&1/Cf([1],1,-0)<0,kf=wf("indexOf");Tf({target:"Array",proto:!0,forced:If||!kf},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return If?Cf(this,e,t)||0:$f(this,e,t)}});var Of=ft,Pf=Pl,Rf=Ut.f,xf=Of("unscopables"),Df=Array.prototype;null==Df[xf]&&Rf(Df,xf,{configurable:!0,value:Pf(null)});var Lf,Nf,Mf,Bf=function(e){Df[xf][e]=!0},Uf=!v((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),jf=Ze,Ff=Q,Vf=We,Gf=Uf,Hf=$r("IE_PROTO"),Kf=Object,zf=Kf.prototype,Wf=Gf?Kf.getPrototypeOf:function(e){var t=Vf(e);if(jf(t,Hf))return t[Hf];var r=t.constructor;return Ff(r)&&t instanceof r?r.prototype:t instanceof Kf?zf:null},Yf=v,Xf=Q,Zf=te,qf=Wf,Qf=un,Jf=ft("iterator"),eh=!1;[].keys&&("next"in(Mf=[].keys())?(Nf=qf(qf(Mf)))!==Object.prototype&&(Lf=Nf):eh=!0),(!Zf(Lf)||Yf((function(){var e={};return Lf[Jf].call(e)!==e})))&&(Lf={}),Xf(Lf[Jf])||Qf(Lf,Jf,(function(){return this}));var th={IteratorPrototype:Lf,BUGGY_SAFARI_ITERATORS:eh},rh=th.IteratorPrototype,nh=Pl,ih=k,oh=xo,ah=Ou,sh=function(){return this},uh=function(e,t,r,n){var i=t+" Iterator";return e.prototype=nh(rh,{next:ih(+!n,r)}),oh(e,i,!1),ah[i]=sh,e},ch=di,lh=E,dh=Q,fh=uh,hh=Wf,ph=ko,gh=xo,yh=ir,vh=un,mh=Ou,_h=dr.PROPER,bh=dr.CONFIGURABLE,Ah=th.IteratorPrototype,Eh=th.BUGGY_SAFARI_ITERATORS,Sh=ft("iterator"),Th="keys",$h="values",wh="entries",Ch=function(){return this},Ih=function(e,t,r,n,i,o,a){fh(r,t,n);var s,u,c,l=function(e){if(e===i&&g)return g;if(!Eh&&e in h)return h[e];switch(e){case Th:case $h:case wh:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[Sh]||h["@@iterator"]||i&&h[i],g=!Eh&&p||l(i),y="Array"==t&&h.entries||p;if(y&&(s=hh(y.call(new e)))!==Object.prototype&&s.next&&(hh(s)!==Ah&&(ph?ph(s,Ah):dh(s[Sh])||vh(s,Sh,Ch)),gh(s,d,!0)),_h&&i==$h&&p&&p.name!==$h&&(bh?yh(h,"name",$h):(f=!0,g=function(){return lh(p,this)})),i)if(u={values:l($h),keys:o?g:l(Th),entries:l(wh)},a)for(c in u)(Eh||f||!(c in h))&&vh(h,c,u[c]);else ch({target:t,proto:!0,forced:Eh||f},u);return h[Sh]!==g&&vh(h,Sh,g,{name:i}),mh[t]=g,u},kh=q,Oh=Bf,Ph=Ou,Rh=Hr,xh=Ut.f,Dh=Ih,Lh=m,Nh="Array Iterator",Mh=Rh.set,Bh=Rh.getterFor(Nh),Uh=Dh(Array,"Array",(function(e,t){Mh(this,{type:Nh,target:kh(e),index:0,kind:t})}),(function(){var e=Bh(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),jh=Ph.Arguments=Ph.Array;if(Oh("keys"),Oh("values"),Oh("entries"),Lh&&"values"!==jh.name)try{xh(jh,"name",{value:"values"})}catch(EU){}var Fh=L,Vh=hn,Gh=Yc,Hh=Y,Kh=Fh("".charAt),zh=Fh("".charCodeAt),Wh=Fh("".slice),Yh=function(e){return function(t,r){var n,i,o=Gh(Hh(t)),a=Vh(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=zh(o,a))<55296||n>56319||a+1===s||(i=zh(o,a+1))<56320||i>57343?e?Kh(o,a):n:e?Wh(o,a,a+2):i-56320+(n-55296<<10)+65536}},Xh={codeAt:Yh(!1),charAt:Yh(!0)},Zh=Xh.charAt,qh=Yc,Qh=Hr,Jh=Ih,ep="String Iterator",tp=Qh.set,rp=Qh.getterFor(ep);Jh(String,"String",(function(e){tp(this,{type:ep,string:qh(e),index:0})}),(function(){var e,t=rp(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Zh(r,n),t.index+=e.length,{value:e,done:!1})}));var np={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ip=Ct("span").classList,op=ip&&ip.constructor&&ip.constructor.prototype,ap=op===Object.prototype?void 0:op,sp=g,up=np,cp=ap,lp=Uh,dp=ir,fp=ft,hp=fp("iterator"),pp=fp("toStringTag"),gp=lp.values,yp=function(e,t){if(e){if(e[hp]!==gp)try{dp(e,hp,gp)}catch(EU){e[hp]=gp}if(e[pp]||dp(e,pp,t),up[t])for(var r in lp)if(e[r]!==lp[r])try{dp(e,r,lp[r])}catch(EU){e[r]=lp[r]}}};for(var vp in up)yp(sp[vp]&&sp[vp].prototype,vp);yp(cp,"DOMTokenList");var mp=v,_p=ft("iterator"),bp=!mp((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[_p]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),Ap=or.exports,Ep=Ut,Sp=function(e,t,r){return r.get&&Ap(r.get,t,{getter:!0}),r.set&&Ap(r.set,t,{setter:!0}),Ep.f(e,t,r)},Tp=m,$p=L,wp=E,Cp=v,Ip=ll,kp=Mn,Op=S,Pp=We,Rp=H,xp=Object.assign,Dp=Object.defineProperty,Lp=$p([].concat),Np=!xp||Cp((function(){if(Tp&&1!==xp({b:1},xp(Dp({},"a",{enumerable:!0,get:function(){Dp(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=xp({},e)[r]||Ip(xp({},t)).join("")!=n}))?function(e,t){for(var r=Pp(e),n=arguments.length,i=1,o=kp.f,a=Op.f;n>i;)for(var s,u=Rp(arguments[i++]),c=o?Lp(Ip(u),o(u)):Ip(u),l=c.length,d=0;l>d;)s=c[d++],Tp&&!wp(a,u,s)||(r[s]=u[s]);return r}:xp,Mp=Ht,Bp=qu,Up=oa,jp=E,Fp=We,Vp=function(e,t,r,n){try{return n?t(Mp(r)[0],r[1]):t(r)}catch(EU){Bp(e,"throw",EU)}},Gp=Du,Hp=Vi,Kp=En,zp=_i,Wp=Wu,Yp=ju,Xp=Array,Zp=function(e){var t=Fp(e),r=Hp(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=Up(i,n>2?arguments[2]:void 0));var a,s,u,c,l,d,f=Yp(t),h=0;if(!f||this===Xp&&Gp(f))for(a=Kp(t),s=r?new this(a):Xp(a);a>h;h++)d=o?i(t[h],h):t[h],zp(s,h,d);else for(l=(c=Wp(t,f)).next,s=r?new this:[];!(u=jp(l,c)).done;h++)d=o?Vp(c,i,[u.value,h],!0):u.value,zp(s,h,d);return s.length=h,s},qp=L,Qp=2147483647,Jp=/[^\0-\u007E]/,eg=/[.\u3002\uFF0E\uFF61]/g,tg="Overflow: input needs wider integers to process",rg=RangeError,ng=qp(eg.exec),ig=Math.floor,og=String.fromCharCode,ag=qp("".charCodeAt),sg=qp([].join),ug=qp([].push),cg=qp("".replace),lg=qp("".split),dg=qp("".toLowerCase),fg=function(e){return e+22+75*(e<26)},hg=function(e,t,r){var n=0;for(e=r?ig(e/700):e>>1,e+=ig(e/t);e>455;)e=ig(e/35),n+=36;return ig(n+36*e/(e+38))},pg=function(e){var t,r,n=[],i=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=ag(e,r++);if(i>=55296&&i<=56319&&r<n){var o=ag(e,r++);56320==(64512&o)?ug(t,((1023&i)<<10)+(1023&o)+65536):(ug(t,i),r--)}else ug(t,i)}return t}(e)).length,o=128,a=0,s=72;for(t=0;t<e.length;t++)(r=e[t])<128&&ug(n,og(r));var u=n.length,c=u;for(u&&ug(n,"-");c<i;){var l=Qp;for(t=0;t<e.length;t++)(r=e[t])>=o&&r<l&&(l=r);var d=c+1;if(l-o>ig((Qp-a)/d))throw rg(tg);for(a+=(l-o)*d,o=l,t=0;t<e.length;t++){if((r=e[t])<o&&++a>Qp)throw rg(tg);if(r==o){for(var f=a,h=36;;){var p=h<=s?1:h>=s+26?26:h-s;if(f<p)break;var g=f-p,y=36-p;ug(n,og(fg(p+g%y))),f=ig(g/y),h+=36}ug(n,og(fg(f))),s=hg(a,d,c==u),a=0,c++}}a++,o++}return sg(n,"")},gg=un,yg=function(e,t,r){for(var n in t)gg(e,n,t[n],r);return e},vg=di,mg=g,_g=E,bg=L,Ag=m,Eg=bp,Sg=un,Tg=yg,$g=xo,wg=uh,Cg=Hr,Ig=Fo,kg=Q,Og=Ze,Pg=oa,Rg=Ii,xg=Ht,Dg=te,Lg=Yc,Ng=Pl,Mg=k,Bg=Wu,Ug=ju,jg=ca,Fg=Od,Vg=ft("iterator"),Gg="URLSearchParams",Hg="URLSearchParamsIterator",Kg=Cg.set,zg=Cg.getterFor(Gg),Wg=Cg.getterFor(Hg),Yg=Object.getOwnPropertyDescriptor,Xg=function(e){if(!Ag)return mg[e];var t=Yg(mg,e);return t&&t.value},Zg=Xg("fetch"),qg=Xg("Request"),Qg=Xg("Headers"),Jg=qg&&qg.prototype,ey=Qg&&Qg.prototype,ty=mg.RegExp,ry=mg.TypeError,ny=mg.decodeURIComponent,iy=mg.encodeURIComponent,oy=bg("".charAt),ay=bg([].join),sy=bg([].push),uy=bg("".replace),cy=bg([].shift),ly=bg([].splice),dy=bg("".split),fy=bg("".slice),hy=/\+/g,py=Array(4),gy=function(e){return py[e-1]||(py[e-1]=ty("((?:%[\\da-f]{2}){"+e+"})","gi"))},yy=function(e){try{return ny(e)}catch(EU){return e}},vy=function(e){var t=uy(e,hy," "),r=4;try{return ny(t)}catch(EU){for(;r;)t=uy(t,gy(r--),yy);return t}},my=/[!'()~]|%20/g,_y={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},by=function(e){return _y[e]},Ay=function(e){return uy(iy(e),my,by)},Ey=wg((function(e,t){Kg(this,{type:Hg,iterator:Bg(zg(e).entries),kind:t})}),"Iterator",(function(){var e=Wg(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),Sy=function(e){this.entries=[],this.url=null,void 0!==e&&(Dg(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===oy(e,0)?fy(e,1):e:Lg(e)))};Sy.prototype={type:Gg,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,a,s,u=Ug(e);if(u)for(r=(t=Bg(e,u)).next;!(n=_g(r,t)).done;){if(o=(i=Bg(xg(n.value))).next,(a=_g(o,i)).done||(s=_g(o,i)).done||!_g(o,i).done)throw ry("Expected sequence with length 2");sy(this.entries,{key:Lg(a.value),value:Lg(s.value)})}else for(var c in e)Og(e,c)&&sy(this.entries,{key:c,value:Lg(e[c])})},parseQuery:function(e){if(e)for(var t,r,n=dy(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=dy(t,"="),sy(this.entries,{key:vy(cy(r)),value:vy(ay(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],sy(r,Ay(e.key)+"="+Ay(e.value));return ay(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Ty=function(){Ig(this,$y),Kg(this,new Sy(arguments.length>0?arguments[0]:void 0))},$y=Ty.prototype;if(Tg($y,{append:function(e,t){jg(arguments.length,2);var r=zg(this);sy(r.entries,{key:Lg(e),value:Lg(t)}),r.updateURL()},delete:function(e){jg(arguments.length,1);for(var t=zg(this),r=t.entries,n=Lg(e),i=0;i<r.length;)r[i].key===n?ly(r,i,1):i++;t.updateURL()},get:function(e){jg(arguments.length,1);for(var t=zg(this).entries,r=Lg(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){jg(arguments.length,1);for(var t=zg(this).entries,r=Lg(e),n=[],i=0;i<t.length;i++)t[i].key===r&&sy(n,t[i].value);return n},has:function(e){jg(arguments.length,1);for(var t=zg(this).entries,r=Lg(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){jg(arguments.length,1);for(var r,n=zg(this),i=n.entries,o=!1,a=Lg(e),s=Lg(t),u=0;u<i.length;u++)(r=i[u]).key===a&&(o?ly(i,u--,1):(o=!0,r.value=s));o||sy(i,{key:a,value:s}),n.updateURL()},sort:function(){var e=zg(this);Fg(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=zg(this).entries,n=Pg(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new Ey(this,"keys")},values:function(){return new Ey(this,"values")},entries:function(){return new Ey(this,"entries")}},{enumerable:!0}),Sg($y,Vg,$y.entries,{name:"entries"}),Sg($y,"toString",(function(){return zg(this).serialize()}),{enumerable:!0}),$g(Ty,Gg),vg({global:!0,constructor:!0,forced:!Eg},{URLSearchParams:Ty}),!Eg&&kg(Qg)){var wy=bg(ey.has),Cy=bg(ey.set),Iy=function(e){if(Dg(e)){var t,r=e.body;if(Rg(r)===Gg)return t=e.headers?new Qg(e.headers):new Qg,wy(t,"content-type")||Cy(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Ng(e,{body:Mg(0,Lg(r)),headers:Mg(0,t)})}return e};if(kg(Zg)&&vg({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return Zg(e,arguments.length>1?Iy(arguments[1]):{})}}),kg(qg)){var ky=function(e){return Ig(this,Jg),new qg(e,arguments.length>1?Iy(arguments[1]):{})};Jg.constructor=ky,ky.prototype=Jg,vg({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ky})}}var Oy,Py=di,Ry=m,xy=bp,Dy=g,Ly=oa,Ny=L,My=un,By=Sp,Uy=Fo,jy=Ze,Fy=Np,Vy=Zp,Gy=Td,Hy=Xh.codeAt,Ky=function(e){var t,r,n=[],i=lg(cg(dg(e),eg,"."),".");for(t=0;t<i.length;t++)r=i[t],ug(n,ng(Jp,r)?"xn--"+pg(r):r);return sg(n,".")},zy=Yc,Wy=xo,Yy=ca,Xy={URLSearchParams:Ty,getState:zg},Zy=Hr,qy=Zy.set,Qy=Zy.getterFor("URL"),Jy=Xy.URLSearchParams,ev=Xy.getState,tv=Dy.URL,rv=Dy.TypeError,nv=Dy.parseInt,iv=Math.floor,ov=Math.pow,av=Ny("".charAt),sv=Ny(/./.exec),uv=Ny([].join),cv=Ny(1..toString),lv=Ny([].pop),dv=Ny([].push),fv=Ny("".replace),hv=Ny([].shift),pv=Ny("".split),gv=Ny("".slice),yv=Ny("".toLowerCase),vv=Ny([].unshift),mv="Invalid scheme",_v="Invalid host",bv="Invalid port",Av=/[a-z]/i,Ev=/[\d+-.a-z]/i,Sv=/\d/,Tv=/^0x/i,$v=/^[0-7]+$/,wv=/^\d+$/,Cv=/^[\da-f]+$/i,Iv=/[\0\t\n\r #%/:<>?@[\\\]^|]/,kv=/[\0\t\n\r #/:<>?@[\\\]^|]/,Ov=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,Pv=/[\t\n\r]/g,Rv=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)vv(t,e%256),e=iv(e/256);return uv(t,".")}if("object"==_typeof$3(e)){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=cv(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},xv={},Dv=Fy({},xv,{" ":1,'"':1,"<":1,">":1,"`":1}),Lv=Fy({},Dv,{"#":1,"?":1,"{":1,"}":1}),Nv=Fy({},Lv,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Mv=function(e,t){var r=Hy(e,0);return r>32&&r<127&&!jy(t,e)?e:encodeURIComponent(e)},Bv={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Uv=function(e,t){var r;return 2==e.length&&sv(Av,av(e,0))&&(":"==(r=av(e,1))||!t&&"|"==r)},jv=function(e){var t;return e.length>1&&Uv(gv(e,0,2))&&(2==e.length||"/"===(t=av(e,2))||"\\"===t||"?"===t||"#"===t)},Fv=function(e){return"."===e||"%2e"===yv(e)},Vv={},Gv={},Hv={},Kv={},zv={},Wv={},Yv={},Xv={},Zv={},qv={},Qv={},Jv={},em={},tm={},rm={},nm={},im={},om={},am={},sm={},um={},cm=function e(t,r,n){var i,o,a,s=zy(t);if(r){if(o=this.parse(s))throw rv(o);this.searchParams=null}else{if(void 0!==n&&(i=new e(n,!0)),o=this.parse(s,null,i))throw rv(o);(a=ev(new Jy)).bindURL(this),this.searchParams=a}};cm.prototype={type:"URL",parse:function(e,t,r){var n,i,o,a,s,u=this,c=t||Vv,l=0,d="",f=!1,h=!1,p=!1;for(e=zy(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=fv(e,Ov,"")),e=fv(e,Pv,""),n=Vy(e);l<=n.length;){switch(i=n[l],c){case Vv:if(!i||!sv(Av,i)){if(t)return mv;c=Hv;continue}d+=yv(i),c=Gv;break;case Gv:if(i&&(sv(Ev,i)||"+"==i||"-"==i||"."==i))d+=yv(i);else{if(":"!=i){if(t)return mv;d="",c=Hv,l=0;continue}if(t&&(u.isSpecial()!=jy(Bv,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&Bv[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?c=tm:u.isSpecial()&&r&&r.scheme==u.scheme?c=Kv:u.isSpecial()?c=Xv:"/"==n[l+1]?(c=zv,l++):(u.cannotBeABaseURL=!0,dv(u.path,""),c=am)}break;case Hv:if(!r||r.cannotBeABaseURL&&"#"!=i)return mv;if(r.cannotBeABaseURL&&"#"==i){u.scheme=r.scheme,u.path=Gy(r.path),u.query=r.query,u.fragment="",u.cannotBeABaseURL=!0,c=um;break}c="file"==r.scheme?tm:Wv;continue;case Kv:if("/"!=i||"/"!=n[l+1]){c=Wv;continue}c=Zv,l++;break;case zv:if("/"==i){c=qv;break}c=om;continue;case Wv:if(u.scheme=r.scheme,i==Oy)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=Gy(r.path),u.query=r.query;else if("/"==i||"\\"==i&&u.isSpecial())c=Yv;else if("?"==i)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=Gy(r.path),u.query="",c=sm;else{if("#"!=i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=Gy(r.path),u.path.length--,c=om;continue}u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=Gy(r.path),u.query=r.query,u.fragment="",c=um}break;case Yv:if(!u.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,c=om;continue}c=qv}else c=Zv;break;case Xv:if(c=Zv,"/"!=i||"/"!=av(d,l+1))continue;l++;break;case Zv:if("/"!=i&&"\\"!=i){c=qv;continue}break;case qv:if("@"==i){f&&(d="%40"+d),f=!0,o=Vy(d);for(var g=0;g<o.length;g++){var y=o[g];if(":"!=y||p){var v=Mv(y,Nv);p?u.password+=v:u.username+=v}else p=!0}d=""}else if(i==Oy||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(f&&""==d)return"Invalid authority";l-=Vy(d).length+1,d="",c=Qv}else d+=i;break;case Qv:case Jv:if(t&&"file"==u.scheme){c=nm;continue}if(":"!=i||h){if(i==Oy||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(u.isSpecial()&&""==d)return _v;if(t&&""==d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=im,t)return;continue}"["==i?h=!0:"]"==i&&(h=!1),d+=i}else{if(""==d)return _v;if(a=u.parseHost(d))return a;if(d="",c=em,t==Jv)return}break;case em:if(!sv(Sv,i)){if(i==Oy||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()||t){if(""!=d){var m=nv(d,10);if(m>65535)return bv;u.port=u.isSpecial()&&m===Bv[u.scheme]?null:m,d=""}if(t)return;c=im;continue}return bv}d+=i;break;case tm:if(u.scheme="file","/"==i||"\\"==i)c=rm;else{if(!r||"file"!=r.scheme){c=om;continue}if(i==Oy)u.host=r.host,u.path=Gy(r.path),u.query=r.query;else if("?"==i)u.host=r.host,u.path=Gy(r.path),u.query="",c=sm;else{if("#"!=i){jv(uv(Gy(n,l),""))||(u.host=r.host,u.path=Gy(r.path),u.shortenPath()),c=om;continue}u.host=r.host,u.path=Gy(r.path),u.query=r.query,u.fragment="",c=um}}break;case rm:if("/"==i||"\\"==i){c=nm;break}r&&"file"==r.scheme&&!jv(uv(Gy(n,l),""))&&(Uv(r.path[0],!0)?dv(u.path,r.path[0]):u.host=r.host),c=om;continue;case nm:if(i==Oy||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&Uv(d))c=om;else if(""==d){if(u.host="",t)return;c=im}else{if(a=u.parseHost(d))return a;if("localhost"==u.host&&(u.host=""),t)return;d="",c=im}continue}d+=i;break;case im:if(u.isSpecial()){if(c=om,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=Oy&&(c=om,"/"!=i))continue}else u.fragment="",c=um;else u.query="",c=sm;break;case om:if(i==Oy||"/"==i||"\\"==i&&u.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(s=yv(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"==i||"\\"==i&&u.isSpecial()||dv(u.path,"")):Fv(d)?"/"==i||"\\"==i&&u.isSpecial()||dv(u.path,""):("file"==u.scheme&&!u.path.length&&Uv(d)&&(u.host&&(u.host=""),d=av(d,0)+":"),dv(u.path,d)),d="","file"==u.scheme&&(i==Oy||"?"==i||"#"==i))for(;u.path.length>1&&""===u.path[0];)hv(u.path);"?"==i?(u.query="",c=sm):"#"==i&&(u.fragment="",c=um)}else d+=Mv(i,Lv);break;case am:"?"==i?(u.query="",c=sm):"#"==i?(u.fragment="",c=um):i!=Oy&&(u.path[0]+=Mv(i,xv));break;case sm:t||"#"!=i?i!=Oy&&("'"==i&&u.isSpecial()?u.query+="%27":u.query+="#"==i?"%23":Mv(i,xv)):(u.fragment="",c=um);break;case um:i!=Oy&&(u.fragment+=Mv(i,Dv))}l++}},parseHost:function(e){var t,r,n;if("["==av(e,0)){if("]"!=av(e,e.length-1))return _v;if(!(t=function(e){var t,r,n,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return av(e,d)};if(":"==f()){if(":"!=av(e,1))return;d+=2,l=++c}for(;f();){if(8==c)return;if(":"!=f()){for(t=r=0;r<4&&sv(Cv,f());)t=16*t+nv(f(),16),d++,r++;if("."==f()){if(0==r)return;if(d-=r,c>6)return;for(n=0;f();){if(i=null,n>0){if(!("."==f()&&n<4))return;d++}if(!sv(Sv,f()))return;for(;sv(Sv,f());){if(o=nv(f(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++n&&4!=n||c++}if(4!=n)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(gv(e,1,-1))))return _v;this.host=t}else if(this.isSpecial()){if(e=Ky(e),sv(Iv,e))return _v;if(null===(t=function(e){var t,r,n,i,o,a,s,u=pv(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(i=u[n]))return e;if(o=10,i.length>1&&"0"==av(i,0)&&(o=sv(Tv,i)?16:8,i=gv(i,8==o?1:2)),""===i)a=0;else{if(!sv(10==o?wv:8==o?$v:Cv,i))return e;a=nv(i,o)}dv(r,a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=ov(256,5-t))return null}else if(a>255)return null;for(s=lv(r),n=0;n<r.length;n++)s+=r[n]*ov(256,3-n);return s}(e)))return _v;this.host=t}else{if(sv(kv,e))return _v;for(t="",r=Vy(e),n=0;n<r.length;n++)t+=Mv(r[n],xv);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return jy(Bv,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&Uv(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=Rv(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+uv(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw rv(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new lm(e.path[0]).origin}catch(EU){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+Rv(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(zy(e)+":",Vv)},getUsername:function(){return this.username},setUsername:function(e){var t=Vy(zy(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Mv(t[r],Nv)}},getPassword:function(){return this.password},setPassword:function(e){var t=Vy(zy(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Mv(t[r],Nv)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?Rv(e):Rv(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Qv)},getHostname:function(){var e=this.host;return null===e?"":Rv(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Jv)},getPort:function(){var e=this.port;return null===e?"":zy(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=zy(e))?this.port=null:this.parse(e,em))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+uv(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,im))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=zy(e))?this.query=null:("?"==av(e,0)&&(e=gv(e,1)),this.query="",this.parse(e,sm)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=zy(e))?("#"==av(e,0)&&(e=gv(e,1)),this.fragment="",this.parse(e,um)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var lm=function(e){var t=Uy(this,dm),r=Yy(arguments.length,1)>1?arguments[1]:void 0,n=qy(t,new cm(e,!1,r));Ry||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},dm=lm.prototype,fm=function(e,t){return{get:function(){return Qy(this)[e]()},set:t&&function(e){return Qy(this)[t](e)},configurable:!0,enumerable:!0}};if(Ry&&(By(dm,"href",fm("serialize","setHref")),By(dm,"origin",fm("getOrigin")),By(dm,"protocol",fm("getProtocol","setProtocol")),By(dm,"username",fm("getUsername","setUsername")),By(dm,"password",fm("getPassword","setPassword")),By(dm,"host",fm("getHost","setHost")),By(dm,"hostname",fm("getHostname","setHostname")),By(dm,"port",fm("getPort","setPort")),By(dm,"pathname",fm("getPathname","setPathname")),By(dm,"search",fm("getSearch","setSearch")),By(dm,"searchParams",fm("getSearchParams")),By(dm,"hash",fm("getHash","setHash"))),My(dm,"toJSON",(function(){return Qy(this).serialize()}),{enumerable:!0}),My(dm,"toString",(function(){return Qy(this).serialize()}),{enumerable:!0}),tv){var hm=tv.createObjectURL,pm=tv.revokeObjectURL;hm&&My(lm,"createObjectURL",Ly(hm,tv)),pm&&My(lm,"revokeObjectURL",Ly(pm,tv))}Wy(lm,"URL"),Py({global:!0,constructor:!0,forced:!xy,sham:!Ry},{URL:lm});var gm=L,ym=un,vm=id,mm=v,_m=ft,bm=ir,Am=_m("species"),Em=RegExp.prototype,Sm=function(e,t,r,n){var i=_m(e),o=!mm((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!mm((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[Am]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return t=!0,null},r[i](""),!t}));if(!o||!a||r){var s=gm(/./[i]),u=t(i,""[e],(function(e,t,r,n,i){var a=gm(e),u=t.exec;return u===vm||u===Em.exec?o&&!i?{done:!0,value:s(t,r,n)}:{done:!0,value:a(r,t,n)}:{done:!1}}));ym(String.prototype,e,u[0]),ym(Em,i,u[1])}n&&bm(Em[i],"sham",!0)},Tm=Xh.charAt,$m=function(e,t,r){return t+(r?Tm(e,t).length:1)},wm=L,Cm=We,Im=Math.floor,km=wm("".charAt),Om=wm("".replace),Pm=wm("".slice),Rm=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,xm=/\$([$&'`]|\d{1,2})/g,Dm=E,Lm=Ht,Nm=Q,Mm=U,Bm=id,Um=TypeError,jm=function(e,t){var r=e.exec;if(Nm(r)){var n=Dm(r,e,t);return null!==n&&Lm(n),n}if("RegExp"===Mm(e))return Dm(Bm,e,t);throw Um("RegExp#exec called on incompatible receiver")},Fm=ta,Vm=E,Gm=L,Hm=Sm,Km=v,zm=Ht,Wm=Q,Ym=K,Xm=hn,Zm=bn,qm=Yc,Qm=Y,Jm=$m,e_=Re,t_=function(e,t,r,n,i,o){var a=r+e.length,s=n.length,u=xm;return void 0!==i&&(i=Cm(i),u=Rm),Om(o,u,(function(o,u){var c;switch(km(u,0)){case"$":return"$";case"&":return e;case"`":return Pm(t,0,r);case"'":return Pm(t,a);case"<":c=i[Pm(u,1,-1)];break;default:var l=+u;if(0===l)return o;if(l>s){var d=Im(l/10);return 0===d?o:d<=s?void 0===n[d-1]?km(u,1):n[d-1]+km(u,1):o}c=n[l-1]}return void 0===c?"":c}))},r_=jm,n_=ft("replace"),i_=Math.max,o_=Math.min,a_=Gm([].concat),s_=Gm([].push),u_=Gm("".indexOf),c_=Gm("".slice),l_="$0"==="a".replace(/./,"$0"),d_=!!/./[n_]&&""===/./[n_]("a","$0");Hm("replace",(function(e,t,r){var n=d_?"$":"$0";return[function(e,r){var n=Qm(this),i=Ym(e)?void 0:e_(e,n_);return i?Vm(i,e,n,r):Vm(t,qm(n),e,r)},function(e,i){var o=zm(this),a=qm(e);if("string"==typeof i&&-1===u_(i,n)&&-1===u_(i,"$<")){var s=r(t,o,a,i);if(s.done)return s.value}var u=Wm(i);u||(i=qm(i));var c=o.global;if(c){var l=o.unicode;o.lastIndex=0}for(var d=[];;){var f=r_(o,a);if(null===f)break;if(s_(d,f),!c)break;""===qm(f[0])&&(o.lastIndex=Jm(a,Zm(o.lastIndex),l))}for(var h,p="",g=0,y=0;y<d.length;y++){for(var v=qm((f=d[y])[0]),m=i_(o_(Xm(f.index),a.length),0),_=[],b=1;b<f.length;b++)s_(_,void 0===(h=f[b])?h:String(h));var A=f.groups;if(u){var E=a_([v],_,m,a);void 0!==A&&s_(E,A);var S=qm(Fm(i,void 0,E))}else S=t_(v,a,m,_,A,i);m>=g&&(p+=c_(a,g,m)+S,g=m+v.length)}return p+c_(a,g)}]}),!!Km((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!l_||d_);var f_=E,h_=Ht,p_=K,g_=bn,y_=Yc,v_=Y,m_=Re,__=$m,b_=jm;Sm("match",(function(e,t,r){return[function(t){var r=v_(this),n=p_(t)?void 0:m_(t,e);return n?f_(n,t,r):new RegExp(t)[e](y_(r))},function(e){var n=h_(this),i=y_(e),o=r(t,n,i);if(o.done)return o.value;if(!n.global)return b_(n,i);var a=n.unicode;n.lastIndex=0;for(var s,u=[],c=0;null!==(s=b_(n,i));){var l=y_(s[0]);u[c]=l,""===l&&(n.lastIndex=__(i,g_(n.lastIndex),a)),c++}return 0===c?null:u}]}));var A_="\t\n\v\f\r                　\u2028\u2029\ufeff",E_=Y,S_=Yc,T_=L("".replace),$_="[\t\n\v\f\r                　\u2028\u2029\ufeff]",w_=RegExp("^"+$_+$_+"*"),C_=RegExp($_+$_+"*$"),I_=function(e){return function(t){var r=S_(E_(t));return 1&e&&(r=T_(r,w_,"")),2&e&&(r=T_(r,C_,"")),r}},k_={start:I_(1),end:I_(2),trim:I_(3)},O_=g,P_=v,R_=L,x_=Yc,D_=k_.trim,L_=A_,N_=O_.parseInt,M_=O_.Symbol,B_=M_&&M_.iterator,U_=/^[+-]?0x/i,j_=R_(U_.exec),F_=8!==N_(L_+"08")||22!==N_(L_+"0x16")||B_&&!P_((function(){N_(Object(B_))}))?function(e,t){var r=D_(x_(e));return N_(r,t>>>0||(j_(U_,r)?16:10))}:N_;di({global:!0,forced:parseInt!=F_},{parseInt:F_});var V_=Np;di({target:"Object",stat:!0,arity:2,forced:Object.assign!==V_},{assign:V_});var G_="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,H_=hn,K_=bn,z_=RangeError,W_=function(e){if(void 0===e)return 0;var t=H_(e),r=K_(t);if(t!==r)throw z_("Wrong length or index");return r},Y_=Array,X_=Math.abs,Z_=Math.pow,q_=Math.floor,Q_=Math.log,J_=Math.LN2,eb=We,tb=vn,rb=En,nb=function(e){for(var t=eb(this),r=rb(t),n=arguments.length,i=tb(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:tb(o,r);a>i;)t[i++]=e;return t},ib=g,ob=L,ab=m,sb=G_,ub=dr,cb=ir,lb=yg,db=v,fb=Fo,hb=hn,pb=bn,gb=W_,yb={pack:function(e,t,r){var n,i,o,a=Y_(r),s=8*r-t-1,u=(1<<s)-1,c=u>>1,l=23===t?Z_(2,-24)-Z_(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=X_(e))!=e||e===1/0?(i=e!=e?1:0,n=u):(n=q_(Q_(e)/J_),e*(o=Z_(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*Z_(2,1-c))*o>=2&&(n++,o/=2),n+c>=u?(i=0,n=u):n+c>=1?(i=(e*o-1)*Z_(2,t),n+=c):(i=e*Z_(2,c-1)*Z_(2,t),n=0));t>=8;)a[f++]=255&i,i/=256,t-=8;for(n=n<<t|i,s+=t;s>0;)a[f++]=255&n,n/=256,s-=8;return a[--f]|=128*d,a},unpack:function(e,t){var r,n=e.length,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=e[u--],l=127&c;for(c>>=7;s>0;)l=256*l+e[u--],s-=8;for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)r=256*r+e[u--],s-=8;if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-1/0:1/0;r+=Z_(2,t),l-=a}return(c?-1:1)*r*Z_(2,l-t)}},vb=Wf,mb=ko,_b=cn.f,bb=Ut.f,Ab=nb,Eb=Td,Sb=xo,Tb=ub.PROPER,$b=ub.CONFIGURABLE,wb=Hr.get,Cb=Hr.set,Ib="ArrayBuffer",kb="DataView",Ob="Wrong index",Pb=ib.ArrayBuffer,Rb=Pb,xb=Rb&&Rb.prototype,Db=ib.DataView,Lb=Db&&Db.prototype,Nb=Object.prototype,Mb=ib.Array,Bb=ib.RangeError,Ub=ob(Ab),jb=ob([].reverse),Fb=yb.pack,Vb=yb.unpack,Gb=function(e){return[255&e]},Hb=function(e){return[255&e,e>>8&255]},Kb=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},zb=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Wb=function(e){return Fb(e,23,4)},Yb=function(e){return Fb(e,52,8)},Xb=function(e,t){bb(e.prototype,t,{get:function(){return wb(this)[t]}})},Zb=function(e,t,r,n){var i=gb(r),o=wb(e);if(i+t>o.byteLength)throw Bb(Ob);var a=wb(o.buffer).bytes,s=i+o.byteOffset,u=Eb(a,s,s+t);return n?u:jb(u)},qb=function(e,t,r,n,i,o){var a=gb(r),s=wb(e);if(a+t>s.byteLength)throw Bb(Ob);for(var u=wb(s.buffer).bytes,c=a+s.byteOffset,l=n(+i),d=0;d<t;d++)u[c+d]=l[o?d:t-d-1]};if(sb){var Qb=Tb&&Pb.name!==Ib;if(db((function(){Pb(1)}))&&db((function(){new Pb(-1)}))&&!db((function(){return new Pb,new Pb(1.5),new Pb(NaN),1!=Pb.length||Qb&&!$b})))Qb&&$b&&cb(Pb,"name",Ib);else{(Rb=function(e){return fb(this,xb),new Pb(gb(e))}).prototype=xb;for(var Jb,eA=_b(Pb),tA=0;eA.length>tA;)(Jb=eA[tA++])in Rb||cb(Rb,Jb,Pb[Jb]);xb.constructor=Rb}mb&&vb(Lb)!==Nb&&mb(Lb,Nb);var rA=new Db(new Rb(2)),nA=ob(Lb.setInt8);rA.setInt8(0,2147483648),rA.setInt8(1,2147483649),!rA.getInt8(0)&&rA.getInt8(1)||lb(Lb,{setInt8:function(e,t){nA(this,e,t<<24>>24)},setUint8:function(e,t){nA(this,e,t<<24>>24)}},{unsafe:!0})}else xb=(Rb=function(e){fb(this,xb);var t=gb(e);Cb(this,{bytes:Ub(Mb(t),0),byteLength:t}),ab||(this.byteLength=t)}).prototype,Lb=(Db=function(e,t,r){fb(this,Lb),fb(e,xb);var n=wb(e).byteLength,i=hb(t);if(i<0||i>n)throw Bb("Wrong offset");if(i+(r=void 0===r?n-i:pb(r))>n)throw Bb("Wrong length");Cb(this,{buffer:e,byteLength:r,byteOffset:i}),ab||(this.buffer=e,this.byteLength=r,this.byteOffset=i)}).prototype,ab&&(Xb(Rb,"byteLength"),Xb(Db,"buffer"),Xb(Db,"byteLength"),Xb(Db,"byteOffset")),lb(Lb,{getInt8:function(e){return Zb(this,1,e)[0]<<24>>24},getUint8:function(e){return Zb(this,1,e)[0]},getInt16:function(e){var t=Zb(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Zb(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return zb(Zb(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return zb(Zb(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Vb(Zb(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Vb(Zb(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){qb(this,1,e,Gb,t)},setUint8:function(e,t){qb(this,1,e,Gb,t)},setInt16:function(e,t){qb(this,2,e,Hb,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){qb(this,2,e,Hb,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){qb(this,4,e,Kb,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){qb(this,4,e,Kb,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){qb(this,4,e,Wb,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){qb(this,8,e,Yb,t,arguments.length>2?arguments[2]:void 0)}});Sb(Rb,Ib),Sb(Db,kb);var iA={ArrayBuffer:Rb,DataView:Db},oA=Bo,aA="ArrayBuffer",sA=iA.ArrayBuffer;di({global:!0,constructor:!0,forced:g.ArrayBuffer!==sA},{ArrayBuffer:sA}),oA(aA);var uA=di,cA=L,lA=v,dA=Ht,fA=vn,hA=bn,pA=Zo,gA=iA.ArrayBuffer,yA=iA.DataView,vA=yA.prototype,mA=cA(gA.prototype.slice),_A=cA(vA.getUint8),bA=cA(vA.setUint8);uA({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:lA((function(){return!new gA(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(mA&&void 0===t)return mA(dA(this),e);for(var r=dA(this).byteLength,n=fA(e,r),i=fA(void 0===t?r:t,r),o=new(pA(this,gA))(hA(i-n)),a=new yA(this),s=new yA(o),u=0;n<i;)bA(s,u++,_A(a,n++));return o}});var AA,EA,SA,TA={exports:{}},$A=G_,wA=m,CA=g,IA=Q,kA=te,OA=Ze,PA=Ii,RA=$e,xA=ir,DA=un,LA=Ut.f,NA=ae,MA=Wf,BA=ko,UA=ft,jA=tt,FA=Hr.enforce,VA=Hr.get,GA=CA.Int8Array,HA=GA&&GA.prototype,KA=CA.Uint8ClampedArray,zA=KA&&KA.prototype,WA=GA&&MA(GA),YA=HA&&MA(HA),XA=Object.prototype,ZA=CA.TypeError,qA=UA("toStringTag"),QA=jA("TYPED_ARRAY_TAG"),JA="TypedArrayConstructor",eE=$A&&!!BA&&"Opera"!==PA(CA.opera),tE=!1,rE={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},nE={BigInt64Array:8,BigUint64Array:8},iE=function e(t){var r=MA(t);if(kA(r)){var n=VA(r);return n&&OA(n,JA)?n.TypedArrayConstructor:e(r)}},oE=function(e){if(!kA(e))return!1;var t=PA(e);return OA(rE,t)||OA(nE,t)};for(AA in rE)(SA=(EA=CA[AA])&&EA.prototype)?FA(SA).TypedArrayConstructor=EA:eE=!1;for(AA in nE)(SA=(EA=CA[AA])&&EA.prototype)&&(FA(SA).TypedArrayConstructor=EA);if((!eE||!IA(WA)||WA===Function.prototype)&&(WA=function(){throw ZA("Incorrect invocation")},eE))for(AA in rE)CA[AA]&&BA(CA[AA],WA);if((!eE||!YA||YA===XA)&&(YA=WA.prototype,eE))for(AA in rE)CA[AA]&&BA(CA[AA].prototype,YA);if(eE&&MA(zA)!==YA&&BA(zA,YA),wA&&!OA(YA,qA))for(AA in tE=!0,LA(YA,qA,{get:function(){return kA(this)?this[QA]:void 0}}),rE)CA[AA]&&xA(CA[AA],QA,AA);var aE={NATIVE_ARRAY_BUFFER_VIEWS:eE,TYPED_ARRAY_TAG:tE&&QA,aTypedArray:function(e){if(oE(e))return e;throw ZA("Target is not a typed array")},aTypedArrayConstructor:function(e){if(IA(e)&&(!BA||NA(WA,e)))return e;throw ZA(RA(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(wA){if(r)for(var i in rE){var o=CA[i];if(o&&OA(o.prototype,e))try{delete o.prototype[e]}catch(EU){try{o.prototype[e]=t}catch(a){}}}YA[e]&&!r||DA(YA,e,r?t:eE&&HA[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(wA){if(BA){if(r)for(n in rE)if((i=CA[n])&&OA(i,e))try{delete i[e]}catch(EU){}if(WA[e]&&!r)return;try{return DA(WA,e,r?t:eE&&WA[e]||t)}catch(EU){}}for(n in rE)!(i=CA[n])||i[e]&&!r||DA(i,e,t)}},getTypedArrayConstructor:iE,isView:function(e){if(!kA(e))return!1;var t=PA(e);return"DataView"===t||OA(rE,t)||OA(nE,t)},isTypedArray:oE,TypedArray:WA,TypedArrayPrototype:YA},sE=g,uE=v,cE=yc,lE=aE.NATIVE_ARRAY_BUFFER_VIEWS,dE=sE.ArrayBuffer,fE=sE.Int8Array,hE=!lE||!uE((function(){fE(1)}))||!uE((function(){new fE(-1)}))||!cE((function(e){new fE,new fE(null),new fE(1.5),new fE(e)}),!0)||uE((function(){return 1!==new fE(new dE(2),1,void 0).length})),pE=te,gE=Math.floor,yE=Number.isInteger||function(e){return!pE(e)&&isFinite(e)&&gE(e)===e},vE=hn,mE=RangeError,_E=function(e){var t=vE(e);if(t<0)throw mE("The argument can't be less than 0");return t},bE=RangeError,AE=function(e,t){var r=_E(e);if(r%t)throw bE("Wrong offset");return r},EE=oa,SE=E,TE=Ko,$E=We,wE=En,CE=Wu,IE=ju,kE=Du,OE=aE.aTypedArrayConstructor,PE=Q,RE=te,xE=ko,DE=function(e,t,r){var n,i;return xE&&PE(n=t.constructor)&&n!==r&&RE(i=n.prototype)&&i!==r.prototype&&xE(e,i),e},LE=di,NE=g,ME=E,BE=m,UE=hE,jE=aE,FE=iA,VE=Fo,GE=k,HE=ir,KE=yE,zE=bn,WE=W_,YE=AE,XE=St,ZE=Ze,qE=Ii,QE=te,JE=Se,eS=Pl,tS=ae,rS=ko,nS=cn.f,iS=function(e){var t,r,n,i,o,a,s=TE(this),u=$E(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,f=IE(u);if(f&&!kE(f))for(a=(o=CE(u,f)).next,u=[];!(i=SE(a,o)).done;)u.push(i.value);for(d&&c>2&&(l=EE(l,arguments[2])),r=wE(u),n=new(OE(s))(r),t=0;r>t;t++)n[t]=d?l(u[t],t):u[t];return n},oS=fd.forEach,aS=Bo,sS=Ut,uS=y,cS=DE,lS=Hr.get,dS=Hr.set,fS=Hr.enforce,hS=sS.f,pS=uS.f,gS=Math.round,yS=NE.RangeError,vS=FE.ArrayBuffer,mS=vS.prototype,_S=FE.DataView,bS=jE.NATIVE_ARRAY_BUFFER_VIEWS,AS=jE.TYPED_ARRAY_TAG,ES=jE.TypedArray,SS=jE.TypedArrayPrototype,TS=jE.aTypedArrayConstructor,$S=jE.isTypedArray,wS="BYTES_PER_ELEMENT",CS="Wrong length",IS=function(e,t){TS(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},kS=function(e,t){hS(e,t,{get:function(){return lS(this)[t]}})},OS=function(e){var t;return tS(mS,e)||"ArrayBuffer"==(t=qE(e))||"SharedArrayBuffer"==t},PS=function(e,t){return $S(e)&&!JE(t)&&t in e&&KE(+t)&&t>=0},RS=function(e,t){return t=XE(t),PS(e,t)?GE(2,e[t]):pS(e,t)},xS=function(e,t,r){return t=XE(t),!(PS(e,t)&&QE(r)&&ZE(r,"value"))||ZE(r,"get")||ZE(r,"set")||r.configurable||ZE(r,"writable")&&!r.writable||ZE(r,"enumerable")&&!r.enumerable?hS(e,t,r):(e[t]=r.value,e)};BE?(bS||(uS.f=RS,sS.f=xS,kS(SS,"buffer"),kS(SS,"byteOffset"),kS(SS,"byteLength"),kS(SS,"length")),LE({target:"Object",stat:!0,forced:!bS},{getOwnPropertyDescriptor:RS,defineProperty:xS}),TA.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",o="get"+e,a="set"+e,s=NE[i],u=s,c=u&&u.prototype,l={},d=function(e,t){hS(e,t,{get:function(){return e=t,(r=lS(this)).view[o](e*n+r.byteOffset,!0);var e,r},set:function(e){return i=t,o=e,s=lS(this),r&&(o=(o=gS(o))<0?0:o>255?255:255&o),void s.view[a](i*n+s.byteOffset,o,!0);var i,o,s},enumerable:!0})};bS?UE&&(u=t((function(e,t,r,i){return VE(e,c),cS(QE(t)?OS(t)?void 0!==i?new s(t,YE(r,n),i):void 0!==r?new s(t,YE(r,n)):new s(t):$S(t)?IS(u,t):ME(iS,u,t):new s(WE(t)),e,u)})),rS&&rS(u,ES),oS(nS(s),(function(e){e in u||HE(u,e,s[e])})),u.prototype=c):(u=t((function(e,t,r,i){VE(e,c);var o,a,s,l=0,f=0;if(QE(t)){if(!OS(t))return $S(t)?IS(u,t):ME(iS,u,t);o=t,f=YE(r,n);var h=t.byteLength;if(void 0===i){if(h%n)throw yS(CS);if((a=h-f)<0)throw yS(CS)}else if((a=zE(i)*n)+f>h)throw yS(CS);s=a/n}else s=WE(t),o=new vS(a=s*n);for(dS(e,{buffer:o,byteOffset:f,byteLength:a,length:s,view:new _S(o)});l<s;)d(e,l++)})),rS&&rS(u,ES),c=u.prototype=eS(SS)),c.constructor!==u&&HE(c,"constructor",u),fS(c).TypedArrayConstructor=u,AS&&HE(c,AS,i);var f=u!=s;l[i]=u,LE({global:!0,constructor:!0,forced:f,sham:!bS},l),wS in u||HE(u,wS,n),wS in c||HE(c,wS,n),aS(i)}):TA.exports=function(){},(0,TA.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var DS=We,LS=vn,NS=En,MS=md,BS=Math.min,US=[].copyWithin||function(e,t){var r=DS(this),n=NS(r),i=LS(e,n),o=LS(t,n),a=arguments.length>2?arguments[2]:void 0,s=BS((void 0===a?n:LS(a,n))-o,n-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in r?r[i]=r[o]:MS(r,i),i+=u,o+=u;return r},jS=aE,FS=L(US),VS=jS.aTypedArray;(0,jS.exportTypedArrayMethod)("copyWithin",(function(e,t){return FS(VS(this),e,t,arguments.length>2?arguments[2]:void 0)}));var GS=fd.every,HS=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("every",(function(e){return GS(HS(this),e,arguments.length>1?arguments[1]:void 0)}));var KS=bt,zS=TypeError,WS=nb,YS=function(e){var t=KS(e,"number");if("number"==typeof t)throw zS("Can't convert number to bigint");return BigInt(t)},XS=Ii,ZS=E,qS=v,QS=aE.aTypedArray,JS=aE.exportTypedArrayMethod,eT=L("".slice);JS("fill",(function(e){var t=arguments.length;QS(this);var r="Big"===eT(XS(this),0,3)?YS(e):+e;return ZS(WS,this,r,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),qS((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})));var tT=En,rT=Zo,nT=aE.aTypedArrayConstructor,iT=aE.getTypedArrayConstructor,oT=function(e){return nT(rT(e,iT(e)))},aT=function(e,t){for(var r=0,n=tT(t),i=new e(n);n>r;)i[r]=t[r++];return i},sT=oT,uT=fd.filter,cT=function(e,t){return aT(sT(e),t)},lT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("filter",(function(e){var t=uT(lT(this),e,arguments.length>1?arguments[1]:void 0);return cT(this,t)}));var dT=fd.find,fT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("find",(function(e){return dT(fT(this),e,arguments.length>1?arguments[1]:void 0)}));var hT=fd.findIndex,pT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("findIndex",(function(e){return hT(pT(this),e,arguments.length>1?arguments[1]:void 0)}));var gT=fd.forEach,yT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("forEach",(function(e){gT(yT(this),e,arguments.length>1?arguments[1]:void 0)}));var vT=Cn.includes,mT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("includes",(function(e){return vT(mT(this),e,arguments.length>1?arguments[1]:void 0)}));var _T=Cn.indexOf,bT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("indexOf",(function(e){return _T(bT(this),e,arguments.length>1?arguments[1]:void 0)}));var AT=g,ET=v,ST=L,TT=aE,$T=Uh,wT=ft("iterator"),CT=AT.Uint8Array,IT=ST($T.values),kT=ST($T.keys),OT=ST($T.entries),PT=TT.aTypedArray,RT=TT.exportTypedArrayMethod,xT=CT&&CT.prototype,DT=!ET((function(){xT[wT].call([1])})),LT=!!xT&&xT.values&&xT[wT]===xT.values&&"values"===xT.values.name,NT=function(){return IT(PT(this))};RT("entries",(function(){return OT(PT(this))}),DT),RT("keys",(function(){return kT(PT(this))}),DT),RT("values",NT,DT||!LT,{name:"values"}),RT(wT,NT,DT||!LT,{name:"values"});var MT=aE.aTypedArray,BT=aE.exportTypedArrayMethod,UT=L([].join);BT("join",(function(e){return UT(MT(this),e)}));var jT=ta,FT=q,VT=hn,GT=En,HT=Rd,KT=Math.min,zT=[].lastIndexOf,WT=!!zT&&1/[1].lastIndexOf(1,-0)<0,YT=HT("lastIndexOf"),XT=WT||!YT?function(e){if(WT)return jT(zT,this,arguments)||0;var t=FT(this),r=GT(t),n=r-1;for(arguments.length>1&&(n=KT(n,VT(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:zT,ZT=ta,qT=XT,QT=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return ZT(qT,QT(this),t>1?[e,arguments[1]]:[e])}));var JT=fd.map,e$=oT,t$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("map",(function(e){return JT(t$(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(e$(e))(t)}))}));var r$=ke,n$=We,i$=H,o$=En,a$=TypeError,s$=function(e){return function(t,r,n,i){r$(r);var o=n$(t),a=i$(o),s=o$(o),u=e?s-1:0,c=e?-1:1;if(n<2)for(;;){if(u in a){i=a[u],u+=c;break}if(u+=c,e?u<0:s<=u)throw a$("Reduce of empty array with no initial value")}for(;e?u>=0:s>u;u+=c)u in a&&(i=r(i,a[u],u,o));return i}},u$={left:s$(!1),right:s$(!0)},c$=u$.left,l$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return c$(l$(this),e,t,t>1?arguments[1]:void 0)}));var d$=u$.right,f$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return d$(f$(this),e,t,t>1?arguments[1]:void 0)}));var h$=aE.aTypedArray,p$=aE.exportTypedArrayMethod,g$=Math.floor;p$("reverse",(function(){for(var e,t=this,r=h$(t).length,n=g$(r/2),i=0;i<n;)e=t[i],t[i++]=t[--r],t[r]=e;return t}));var y$=g,v$=E,m$=aE,_$=En,b$=AE,A$=We,E$=v,S$=y$.RangeError,T$=y$.Int8Array,$$=T$&&T$.prototype,w$=$$&&$$.set,C$=m$.aTypedArray,I$=m$.exportTypedArrayMethod,k$=!E$((function(){var e=new Uint8ClampedArray(2);return v$(w$,e,{length:1,0:3},1),3!==e[1]})),O$=k$&&m$.NATIVE_ARRAY_BUFFER_VIEWS&&E$((function(){var e=new T$(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));I$("set",(function(e){C$(this);var t=b$(arguments.length>1?arguments[1]:void 0,1),r=A$(e);if(k$)return v$(w$,this,r,t);var n=this.length,i=_$(r),o=0;if(i+t>n)throw S$("Wrong length");for(;o<i;)this[t+o]=r[o++]}),!k$||O$);var P$=oT,R$=sa,x$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("slice",(function(e,t){for(var r=R$(x$(this),e,t),n=P$(this),i=0,o=r.length,a=new n(o);o>i;)a[i]=r[i++];return a}),v((function(){new Int8Array(1).slice()})));var D$=fd.some,L$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("some",(function(e){return D$(L$(this),e,arguments.length>1?arguments[1]:void 0)}));var N$=L,M$=v,B$=ke,U$=Od,j$=Dd,F$=Ld,V$=pe,G$=Md,H$=aE.aTypedArray,K$=aE.exportTypedArrayMethod,z$=g.Uint16Array,W$=z$&&N$(z$.prototype.sort),Y$=!(!W$||M$((function(){W$(new z$(2),null)}))&&M$((function(){W$(new z$(2),{})}))),X$=!!W$&&!M$((function(){if(V$)return V$<74;if(j$)return j$<67;if(F$)return!0;if(G$)return G$<602;var e,t,r=new z$(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(W$(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));K$("sort",(function(e){return void 0!==e&&B$(e),X$?W$(this,e):U$(H$(this),(t=e,function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}));var t}),!X$||Y$);var Z$=bn,q$=vn,Q$=oT,J$=aE.aTypedArray;(0,aE.exportTypedArrayMethod)("subarray",(function(e,t){var r=J$(this),n=r.length,i=q$(e,n);return new(Q$(r))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,Z$((void 0===t?n:q$(t,n))-i))}));var ew=ta,tw=aE,rw=v,nw=sa,iw=g.Int8Array,ow=tw.aTypedArray,aw=tw.exportTypedArrayMethod,sw=[].toLocaleString,uw=!!iw&&rw((function(){sw.call(new iw(1))}));aw("toLocaleString",(function(){return ew(sw,uw?nw(ow(this)):ow(this),nw(arguments))}),rw((function(){return[1,2].toLocaleString()!=new iw([1,2]).toLocaleString()}))||!rw((function(){iw.prototype.toLocaleString.call([1,2])})));var cw=aE.exportTypedArrayMethod,lw=v,dw=L,fw=g.Uint8Array,hw=fw&&fw.prototype||{},pw=[].toString,gw=dw([].join);lw((function(){pw.call({})}))&&(pw=function(){return gw(this)});var yw=hw.toString!=pw;cw("toString",pw,yw),(0,TA.exports)("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0),(0,TA.exports)("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,TA.exports)("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var vw=E,mw=Ze,_w=ae,bw=tl,Aw=RegExp.prototype,Ew=function(e){var t=e.flags;return void 0!==t||"flags"in Aw||mw(e,"flags")||!_w(Aw,e)?t:vw(bw,e)},Sw=dr.PROPER,Tw=un,$w=Ht,ww=Yc,Cw=v,Iw=Ew,kw="toString",Ow=RegExp.prototype.toString,Pw=Cw((function(){return"/a/b"!=Ow.call({source:"a",flags:"b"})})),Rw=Sw&&Ow.name!=kw;(Pw||Rw)&&Tw(RegExp.prototype,kw,(function(){var e=$w(this);return"/"+ww(e.source)+"/"+ww(Iw(e))}),{unsafe:!0});var xw=di,Dw=hi,Lw=Vi,Nw=te,Mw=vn,Bw=En,Uw=q,jw=_i,Fw=ft,Vw=sa,Gw=Ji("slice"),Hw=Fw("species"),Kw=Array,zw=Math.max;xw({target:"Array",proto:!0,forced:!Gw},{slice:function(e,t){var r,n,i,o=Uw(this),a=Bw(o),s=Mw(e,a),u=Mw(void 0===t?a:t,a);if(Dw(o)&&(r=o.constructor,(Lw(r)&&(r===Kw||Dw(r.prototype))||Nw(r)&&null===(r=r[Hw]))&&(r=void 0),r===Kw||void 0===r))return Vw(o,s,u);for(n=new(void 0===r?Kw:r)(zw(u-s,0)),i=0;s<u;s++,i++)s in o&&jw(n,i,o[s]);return n.length=i,n}});var Ww=di,Yw=H,Xw=q,Zw=Rd,qw=L([].join),Qw=Yw!=Object,Jw=Zw("join",",");Ww({target:"Array",proto:!0,forced:Qw||!Jw},{join:function(e){return qw(Xw(this),void 0===e?",":e)}});var eC,tC,rC,nC=te,iC=U,oC=ft("match"),aC=function(e){var t;return nC(e)&&(void 0!==(t=e[oC])?!!t:"RegExp"==iC(e))},sC=ta,uC=E,cC=L,lC=Sm,dC=Ht,fC=K,hC=aC,pC=Y,gC=Zo,yC=$m,vC=bn,mC=Yc,_C=Re,bC=Td,AC=jm,EC=id,SC=v,TC=al.UNSUPPORTED_Y,$C=4294967295,wC=Math.min,CC=[].push,IC=cC(/./.exec),kC=cC(CC),OC=cC("".slice),PC=!SC((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));lC("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=mC(pC(this)),i=void 0===r?$C:r>>>0;if(0===i)return[];if(void 0===e)return[n];if(!hC(e))return uC(t,n,e,i);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(o=uC(EC,d,n))&&!((a=d.lastIndex)>l&&(kC(u,OC(n,l,o.index)),o.length>1&&o.index<n.length&&sC(CC,u,bC(o,1)),s=o[0].length,l=a,u.length>=i));)d.lastIndex===o.index&&d.lastIndex++;return l===n.length?!s&&IC(d,"")||kC(u,""):kC(u,OC(n,l)),u.length>i?bC(u,0,i):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:uC(t,this,e,r)}:t,[function(t,r){var i=pC(this),o=fC(t)?void 0:_C(t,e);return o?uC(o,t,i,r):uC(n,mC(i),t,r)},function(e,i){var o=dC(this),a=mC(e),s=r(n,o,a,i,n!==t);if(s.done)return s.value;var u=gC(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(TC?"g":"y"),d=new u(TC?"^(?:"+o.source+")":o,l),f=void 0===i?$C:i>>>0;if(0===f)return[];if(0===a.length)return null===AC(d,a)?[a]:[];for(var h=0,p=0,g=[];p<a.length;){d.lastIndex=TC?0:p;var y,v=AC(d,TC?OC(a,p):a);if(null===v||(y=wC(vC(d.lastIndex+(TC?p:0)),a.length))===h)p=yC(a,p,c);else{if(kC(g,OC(a,h,p)),g.length===f)return g;for(var m=1;m<=v.length-1;m++)if(kC(g,v[m]),g.length===f)return g;p=h=y}}return kC(g,OC(a,h)),g}]}),!PC,TC),function(e,t,r){function n(e,t){var r=parseInt(e.slice(t,t+2),16);return r>>>7==0?[1,r]:r>>>6==2?(r=(63&r)<<8,[2,r+=parseInt(e.slice(t+2,t+4),16)]):(r=(63&r)<<16,[3,r+=parseInt(e.slice(t+2,t+6),16)])}var i,o=0,a=[],s=[],u=parseInt(e.slice(0,8),16),c=parseInt(e.slice(8,16),16);if(1213091658!==u||1077891651!==c)throw new Error("mhe");if(0!==parseInt(e.slice(16,18),16))throw new Error("ve");for(i=0;i<4;++i)o+=(3&parseInt(e.slice(24+2*i,26+2*i),16))<<2*i;var l=parseInt(e.slice(32,40),16),d=2*parseInt(e.slice(48,56),16);for(i=56;i<d+56;i+=2)a.push(parseInt(e.slice(i,i+2),16));var f=d+56,h=parseInt(e.slice(f,f+4),16);for(f+=4,i=0;i<h;++i){var p=n(e,f);f+=2*p[0];for(var g="",y=0;y<p[1];++y){var v=n(e,f);g+=String.fromCharCode(o^v[1]),f+=2*v[0]}s.push(g)}t.p=null,function e(t,r,n,i,o){var u,c,l,d,f,h=-1,p=[],g=[0,null],y=null,v=[r];for(c=Math.min(r.length,n),l=0;l<c;++l)v.push(r[l]);v.p=i;for(var m=[];;)try{var _=a[t++];if(_<40)if(_<20)if(_<11)_<5?_<3?p[++h]=null:3===_?(u=a[t++],p[++h]=u<<24>>24):(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=u<<16>>16):_<7?5===_?(u=((u=((u=a[t++])<<8)+a[t++])<<8)+a[t++],p[++h]=(u<<8)+a[t++]):(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=+s[u]):7===_?(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=s[u]):p[++h]=void 0;else if(_<14)_<12?p[++h]=o:12===_?(u=(a[t]<<8)+a[t+1],t+=2,h=h-u+1,c=p.slice(h,h+u),p[h]=c):p[++h]={};else if(_<18)if(14===_)u=(a[t]<<8)+a[t+1],t+=2,c=s[u],l=p[h--],p[h][c]=l;else{for(c=a[t++],l=a[t++],d=v;c>0;--c)d=d.p;p[++h]=d[l]}else 18===_?(u=(a[t]<<8)+a[t+1],t+=2,c=s[u],p[h]=p[h][c]):(c=p[h--],p[h]=p[h][c]);else if(_<27)if(_<23)if(_<21){for(c=a[t++],l=a[t++],d=v;c>0;--c)d=d.p;d[l]=p[h--]}else 21===_?(u=(a[t]<<8)+a[t+1],t+=2,c=s[u],l=p[h--],d=p[h--],l[c]=d):(c=p[h--],l=p[h--],d=p[h--],l[c]=d);else if(_<25)if(23===_){for(c=a[t++],l=a[t++],d=v,d=v;c>0;--c)d=d.p;p[++h]=d,p[++h]=l}else c=p[h--],p[h]+=c;else 25===_?(c=p[h--],p[h]-=c):(c=p[h--],p[h]*=c);else _<35?_<29?27===_?(c=p[h--],p[h]/=c):(c=p[h--],p[h]%=c):29===_?p[h]=-p[h]:(c=p[h--],l=p[h--],p[++h]=l[c]++):_<38?35===_?(c=p[h--],p[h]=p[h]==c):(c=p[h--],p[h]=p[h]===c):38===_?(c=p[h--],p[h]=p[h]!==c):(c=p[h--],p[h]=p[h]<c);else if(_<58)_<48?_<44?_<41?(c=p[h--],p[h]=p[h]<=c):41===_?(c=p[h--],p[h]=p[h]>c):(c=p[h--],p[h]=p[h]<<c):_<46?44===_?(c=p[h--],p[h]=p[h]>>c):(c=p[h--],p[h]=p[h]>>>c):46===_?(c=p[h--],p[h]=p[h]&c):(c=p[h--],p[h]=p[h]|c):_<52?_<50?48===_?p[h]=~p[h]:(c=p[h--],p[h]=p[h]^c):50===_?p[h]=!p[h]:(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,p[h]?--h:t+=u):_<55?52===_?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,p[h]?t+=u:--h):(c=p[h--],(l=p[h--])[c]=p[h]):55===_?(c=p[h--],p[h]=p[h]instanceof c):p[h]=void 0;else if(_<66)if(_<61)_<59?p[h]=_typeof$3(p[h]):59===_?(u=a[t++],c=p[h--],(l=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)})._v=[c,u,v],l._u=e,p[++h]=l):(u=a[t++],c=p[h--],(d=[l=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)}]).p=v,l._v=[c,u,d],l._u=e,p[++h]=l);else if(_<64)61===_?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=m[m.length-1])[1]=t+u):(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=m[m.length-1])&&!c[1]?(c[0]=3,c.push(t)):m.push([1,0,t]),t+=u);else{if(64===_)throw c=p[h--];if(l=(c=m.pop())[0],d=g[0],1===l)t=c[1];else if(0===l)if(0===d)t=c[1];else{if(1!==d)throw g[1];if(!y)return g[1];t=y[1],o=y[2],v=y[3],m=y[4],p[++h]=g[1],g=[0,null],y=y[0]}else t=c[2],c[0]=0,m.push(c)}else if(_<71)if(_<68)if(66===_){for(c=p[h--],l=null;d=m.pop();)if(2===d[0]||3===d[0]){l=d;break}if(l)g=[1,c],t=l[2],l[0]=0,m.push(l);else{if(!y)return c;t=y[1],o=y[2],v=y[3],m=y[4],p[++h]=c,g=[0,null],y=y[0]}}else h-=u=a[t++],l=p.slice(h+1,h+u+1),c=p[h--],d=p[h--],c._u===e?(c=c._v,y=[y,t,o,v,m],t=c[0],null==d&&(d=function(){return this}()),o=d,(v=[l].concat(l)).length=Math.min(c[1],u)+1,v.p=c[2],m=[]):p[++h]=c.apply(d,l);else if(68===_){for(u=a[t++],d=[void 0],f=u;f>0;--f)d[f]=p[h--];l=p[h--],c=Function.bind.apply(l,d),p[++h]=new c}else t+=2+(u=(u=(a[t]<<8)+a[t+1])<<16>>16);else _<73?71===_?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=p[h--])||(t+=u)):(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,c=p[h--],p[h]===c&&(--h,t+=u)):73===_?--h:(c=p[h],p[++h]=c)}catch(b){for(g=[0,null];(u=m.pop())&&!u[0];);if(!u){e:for(;y;){for(c=y[4];u=c.pop();)if(u[0])break e;y=y[0]}if(!y)throw b;t=y[1],o=y[2],v=y[3],m=y[4],y=y[0]}1===(c=u[0])?(t=u[2],u[0]=0,m.push(u),p[++h]=b):2===c?(t=u[2],u[0]=0,m.push(u),g=[3,b]):(t=u[3],u[0]=2,m.push(u),p[++h]=b)}}(l,[],0,t,r)}("484e4f4a403f52430022100c4da72e45000042f7ef7143780000488a050000003e3b0014000105000000403c0011000115000111000112000214000205000000843c0111000215000405000000923c0011000215000611000142084211000012000014000111040011000144011400020300140003110003110001274700161100001100031311000211000316170003214945ffe00211041b0b1100024302421104014a1200030b1100014302420b12000544001400011104014a1200031100010b4302491100014205000001123b021400020211021a11000211000143024905000002653c0111000215001011000212000214000305000003803c01110003150013050000039b3c0111000315001505000004813c0011000315001405000004ce3c0011000315000611000242110001030038254700060c00001400011100020300382547000c03041100011200001a1400021101014a1200070b43013400010b1400031100011400041100041103023733000c1103031100044401170004354911000411030437340007110004110305373400071100041103063734000711000411030737340007110004110308373400071100041103093734000711000411030a3734000711000411030b3733001b11030311000412000811000412000911000412000a440317000435491100041103033747006f11000412000a1400050c000014000603001400071100071100052747003811000611000703022d1311000411000713031811000703041c03081a192b2f11000611000703022d3549110007030118170007354945ffbe11000611000307000b354911000511000307000c354945001611000111000307000b354911000211000307000c3549110003420c000014000205000002e23c011400030300140005110005110001274700520211000306000e11000434000911040c4a12001043001a4301140006053ade67b70211000643001a17000435491100024a12001106000e0211000643001a03002f430149110005030418170005354945ffa4110202110002110001440242110001140002053ade68b114000306000d14000405000002fe3b00420500009069050000ffff1101032e1a11010303102c181101042e1701033549044650050000ffff1101022e1a11010203102c181101042e170102354911010303102b110102181101042e14000111000106000e1b170001354911000106000f18170001354911000111070c4a120010430006000f29470005030145000303011d1a42110001030038254700061103031400011100014a1200120b4301420b12000b14000211000112000b1400030b12000c14000411000112000c1400050b4a12001443004911000403041c47007003001400061100061100052747005e11000311000603022d13031811000603041c03081a192d0400ff2e1400071100021100041100061803022d1311000703181100041100061803041c03081a192b2f1100021100041100061803022d3549110006030118170006354945ff9845003503001400081100081100052747002611000311000803022d131100021100041100081803022d16110008030418170008354945ffd00b12000c110005180b07000c35490b420b12000b1400010b12000c14000211000111000203022d1306000d032011000203041c03081a192b2e11000111000203022d354911040c4a12001611000203041b4301110001070000354908421102011200021200064a1200070b43011400010b12000b4a1200170300430111000107000b35491100014211000112000b14000211000112000c1400030c000014000403001400051100051100032747005c11000211000503022d13031811000503041c03081a192d0400ff2e1400061100044a12001111000603042d4a120013031043014301491100044a120011030f1100062e4a12001303104301430149110005030118170005354945ff9a1100044a1200180700194301421100011200001400020c000014000303001400041100041100022747004711000311000403032d130211030d1100014a12001a1100040302430203104302031811000403081c03041a192b2f11000311000403032d3549110004030218170004354945ffaf11020211000311000203021b44024211000112000b14000211000112000c1400030c000014000403001400051100051100032747004211000211000503022d13031811000503041c03081a192d0400ff2e1400061100044a12001111030e4a12001c1100064301430149110005030118170005354945ffb41100044a1200180700194301421100011200001400020c000014000303001400041100041100022747004111000311000403022d130400ff1100014a12001d11000443012e031811000403041c03081a192b2f11000311000403022d3549110004030118170004354945ffb51102021100031100024402423e000d14000211031107001e440140413d001a0211030f021103101102044a120012110001430143014301424108421102044a12001b021103120211031311000143014301430142050000077e3b001400020211021a110002110001430249110002120002140003050000079f3c0011000315002205000007b43c0111000315002405000007f73c0111000315002a05000008d43c00110003150006110002421101014a1200070b43013400010b1700013549030011000107001f35491100014211030244000b070020354903000b070021354908421100011400020700231100023a233300101103054a12001b110002430117000235490b1200204a1200151100024301490b12002111000212000c180b070021354908420b1200201400030b12002514000411000312000b14000511000312000c14000611000603041100041a1b14000711000147000f11040c4a120016110007430145001611040c4a12002603001100072f0b12001f19030043021400071100071100041a14000811040c4a12002703041100081a1100064302140009110008470051030014000a11000a1100082747001d0b4a12002811000511000a43024911000a1100041817000a354945ffd91100054a12002903001100084302170002354911000312000c1100091911000307000c35491103021100021100094402421102011200021200064a1200070b43011400010b1200204a120006430011000107002035491100014205000009623b011400020211021a11000211000143024905000009a63c0111000215002d05000009c03c0111000215002e11000212000214000305000009dd3c0011000315002205000009f83c011100031500300500000a0d3c0111000315002c110002421101014a1200070b43013400010b1700023549031011000207002535491103014a1200031102014400110001430211000207002b35491100024a1200224300491100024205000009ae3b024211010111000244014a12002c11000143014205000009c83b024211040811010111000244024a12002c1100014301421102011200021200224a1200070b4301490b4a12002f43004908420b4a1200241100014301490b4a12002a4300490b4211000133000a0b4a1200241100014301490b4a1200314300420500000a713b021400020211021a1100021100014302491100021200021400030500000b963c001100031500220500000bb73c011100031500300500000bc73c0111000315002c110002421101014a1200070b43013400010b14000311000144001400041100041100031500321100021400050700231100053a233300101102054a12001b1100054301170005354911000412002514000603041100061a14000711000512000c110007293300101100044a12002c110002430117000535491100054a1200144300491100054a12000643001400081100081100031500331100054a120006430014000911000911000315003411000812000b14000a11000912000b14000b030014000c11000c1100062747003811000a11000c13055c5c5c5c3111000a11000c354911000b11000c1305363636363111000b11000c354911000c03011817000c354945ffbe11000711000807000c354911000711000907000c35491100034a120022430049110003420b1200321400011100014a1200224300491100014a1200300b12003443014908420b1200324a1200301100014301490b420b1200321400021100024a12002c11000143011400031100024a1200224300491100024a12002c0b1200334a12000643004a12001511000343014301420c0000140004030014000503001400061100061100022747008611000603041c47006f1100031100014a12001d11000603011943011311000603041c03021a2b1100031100014a12001d110006430113030611000603041c03021a192d2f14000711000411000503022d13110007031811000503041c03081a192b2f11000411000503022d35491100050301181700053549110006030118170006354945ff701102024a12000111000411000543024211000112000b14000211000112000c1400030b1200351400041100014a1200144300490c00001400050300140006110006110003274700c711000211000603022d13031811000603041c03081a192d0400ff2e03102b11000211000603011803022d13031811000603011803041c03081a192d0400ff2e03082b2f11000211000603021803022d13031811000603021803041c03081a192d0400ff2e2f140007030014000811000803042733000f1100060600361100081a18110003274700311100054a1200111100044a12003711000703060303110008191a2d033f2e4301430149110008030118170008354945ffb4110006030318170006354945ff2f1100044a1200370340430114000911000947001c11000512000003041c4700101100054a12001111000943014945ffe41100054a1200180700194301421100011200001400020b1200351400030b120038140004110004324700450c00000b07003835490b12003817000435490300140005110005110003120000274700211100051100041100034a12001d110005430116110005030118170005354945ffd21100034a120037034043011400061100064700211100014a120039110006430114000703011d110007263300071100071700023549021102091100011100021100044303421100011100021100032e110002301100042e2f1811000518110007181400081100081100062b1100080320110006192d2f11000218421100011100021100042e110003110004302e2f1811000518110007181400081100081100062b1100080320110006192d2f110002184211000111000211000331110004311811000518110007181400081100081100062b1100080320110006192d2f1100021842110001110003110002110004302f311811000518110007181400081100081100062b1100080320110006192d2f11000218420500000fbf3b001400020211021a1100021100014302491100021200021400030500000fd13c0011000315002f0500000fef3c021100031500280500001a213c001100031500310500001b773c00110003150006110002421101014a12003d0b11000043023400010b42110302056745230106003e06003f05103254760c000444010b1500400842110001140003030014000411000403102747004e11000211000418140005110001110005131400060500ff00ff11000603082b11000603182d2f2e06004111000603182b11000603082d2f2e2f11000311000516110004030118170004354945ffa90b12004012000b14000711000311000203001813140008110003110002030118131400091100031100020302181314000a1100031100020303181314000b1100031100020304181314000c1100031100020305181314000d1100031100020306181314000e1100031100020307181314000f1100031100020308181314001011000311000203091813140011110003110002030a1813140012110003110002030b1813140013110003110002030c1813140014110003110002030d1813140015110003110002030e1813140016110003110002030f181314001711000703001314001811000703011314001911000703021314001a11000703031314001b0211030d11001811001911001a11001b110008030711030b030013430717001835490211030d11001b11001811001911001a110009030c11030b030113430717001b35490211030d11001a11001b11001811001911000a031111030b030213430717001a35490211030d11001911001a11001b11001811000b031611030b030313430717001935490211030d11001811001911001a11001b11000c030711030b030413430717001835490211030d11001b11001811001911001a11000d030c11030b030513430717001b35490211030d11001a11001b11001811001911000e031111030b030613430717001a35490211030d11001911001a11001b11001811000f031611030b030713430717001935490211030d11001811001911001a11001b110010030711030b030813430717001835490211030d11001b11001811001911001a110011030c11030b030913430717001b35490211030d11001a11001b110018110019110012031111030b030a13430717001a35490211030d11001911001a11001b110018110013031611030b030b13430717001935490211030d11001811001911001a11001b110014030711030b030c13430717001835490211030d11001b11001811001911001a110015030c11030b030d13430717001b35490211030d11001a11001b110018110019110016031111030b030e13430717001a35490211030d11001911001a11001b110018110017031611030b030f13430717001935490211030e11001811001911001a11001b110009030511030b031013430717001835490211030e11001b11001811001911001a11000e030911030b031113430717001b35490211030e11001a11001b110018110019110013030e11030b031213430717001a35490211030e11001911001a11001b110018110008031411030b031313430717001935490211030e11001811001911001a11001b11000d030511030b031413430717001835490211030e11001b11001811001911001a110012030911030b031513430717001b35490211030e11001a11001b110018110019110017030e11030b031613430717001a35490211030e11001911001a11001b11001811000c031411030b031713430717001935490211030e11001811001911001a11001b110011030511030b031813430717001835490211030e11001b11001811001911001a110016030911030b031913430717001b35490211030e11001a11001b11001811001911000b030e11030b031a13430717001a35490211030e11001911001a11001b110018110010031411030b031b13430717001935490211030e11001811001911001a11001b110015030511030b031c13430717001835490211030e11001b11001811001911001a11000a030911030b031d13430717001b35490211030e11001a11001b11001811001911000f030e11030b031e13430717001a35490211030e11001911001a11001b110018110014031411030b031f13430717001935490211030f11001811001911001a11001b11000d030411030b032013430717001835490211030f11001b11001811001911001a110010030b11030b032113430717001b35490211030f11001a11001b110018110019110013031011030b032213430717001a35490211030f11001911001a11001b110018110016031711030b032313430717001935490211030f11001811001911001a11001b110009030411030b032413430717001835490211030f11001b11001811001911001a11000c030b11030b032513430717001b35490211030f11001a11001b11001811001911000f031011030b032613430717001a35490211030f11001911001a11001b110018110012031711030b032713430717001935490211030f11001811001911001a11001b110015030411030b032813430717001835490211030f11001b11001811001911001a110008030b11030b032913430717001b35490211030f11001a11001b11001811001911000b031011030b032a13430717001a35490211030f11001911001a11001b11001811000e031711030b032b13430717001935490211030f11001811001911001a11001b110011030411030b032c13430717001835490211030f11001b11001811001911001a110014030b11030b032d13430717001b35490211030f11001a11001b110018110019110017031011030b032e13430717001a35490211030f11001911001a11001b11001811000a031711030b032f13430717001935490211031011001811001911001a11001b110008030611030b033013430717001835490211031011001b11001811001911001a11000f030a11030b033113430717001b35490211031011001a11001b110018110019110016030f11030b033213430717001a35490211031011001911001a11001b11001811000d031511030b033313430717001935490211031011001811001911001a11001b110014030611030b033413430717001835490211031011001b11001811001911001a11000b030a11030b033513430717001b35490211031011001a11001b110018110019110012030f11030b033613430717001a35490211031011001911001a11001b110018110009031511030b033713430717001935490211031011001811001911001a11001b110010030611030b033813430717001835490211031011001b11001811001911001a110017030a11030b033913430717001b35490211031011001a11001b11001811001911000e030f11030b033a13430717001a35490211031011001911001a11001b110018110015031511030b033b13430717001935490211031011001811001911001a11001b11000c030611030b033c13430717001835490211031011001b11001811001911001a110013030a11030b033d13430717001b35490211031011001a11001b11001811001911000a030f11030b033e13430717001a35490211031011001911001a11001b110018110011031511030b033f13430717001935491100070300131100181803002f110007030035491100070301131100191803002f1100070301354911000703021311001a1803002f1100070302354911000703031311001b1803002f1100070303354908420b12002014000111000112000b14000203080b1200211a140003030811000112000c1a14000411000211000403052d13040080031811000403201c192b2f11000211000403052d354911040c4a12004211000306000e1b43011400051100031400060500ff00ff11000503082b11000503182d2f2e06004111000503182b11000503082d2f2e2f110002030f11000403401803092d03042b1835490500ff00ff11000603082b11000603182d2f2e06004111000603182b11000603082d2f2e2f110002030e11000403401803092d03042b18354903041100021200000301181a11000107000c35490b4a12002a4300490b12004014000711000712000b14000803001400091100090304274700441100081100091314000a0500ff00ff11000a03082b11000a03182d2f2e06004111000a03182b11000a03082d2f2e2f11000811000916110009030118170009354945ffb3110007421102011200021200064a1200070b43011400010b1200404a12000643001100010700403549110001420500001bd13b011400020211021a1100021100014302491100021200021400030500001c123c02110003150046110002421101014a1200070b43013400010b17000235491103014a12000311020144000d03040e00431102110e004403010e0045110001430311000207002b3549110002420b12002b1400041100041200444a12000143001400051103024a120001430014000611000612000b1400071100041200431400081100041200451400091100071200001100082747007f11000333000c1100054a1200301100034301491100054a12003011000143014a12002c110002430117000335491100054a120022430049030114000a11000a110009274700291100054a12002c110003430117000335491100054a12002243004911000a03011817000a354945ffcd1100064a12001511000343014945ff7403041100081a11000607000c3549110006420500001d5f3b031400020211021a1100021100014302490500001daf3c0211000215004a0500001dc13c0211000215004c0500001dd33c0111000215002d1100021200021400030500001e403c001100031500220500001e5b3c0111000315004f0500001e6e3c0111000315002c110002421101014a1200070b43013400010b17000435491103014a1200031102014400110003430211000407002b3549110001110004070047354911000211000407004835491100044a120022430049110004420b4a1200010b1200491100011100024303420b4a1200010b12004b1100011100024303420500001df33c011400020d0500001e083c030e004d0500001e243c030e004e420700231100013a2347000611051d45000311051b420211020211000243014a12004d1102011100011100021100034304420211020211000243014a12004e1102011100011100021100034304421102011200021200224a1200070b4301490b4a12002f43004908420b4a1200241100014301490b4a12002a43004211000133000a0b4a1200241100014301490b4a1200314300420500001ebc3b021400020211021a1100021100014302490500001ee93c0211000215004a0500001efa3c0211000215004c110002421101014a1200070b43013400010b170003354911000111000307005135491100021100030700523549110003420b1200534a1200011100011100024302420b1200544a1200011100011100024302421100011400040b12005214000611000647001311000617000535490300380b070052354500080b120055170005354903001400071100071100032747002d11000411000211000718131100051100071331110004110002110007183549110007030118170007354945ffc908420500001f933b001400020211021a110002110001430249110002421101014a12003d0b11000043023400010b420500001fd63b001400020211021a1100021100014302491100021200021400030500001fe83c02110003150057110002421101014a12003d0b11000043023400010b420b1200511400031100031200251400041103154a1200070b1100011100021100044304491100034a1200561100011100024302491100014a1200171100021100021100041843020b0700553549084205000020683b001400020211021a110002110001430249110002120002140003050000207a3c02110003150057110002421101014a12003d0b11000043023400010b420b1200511400031100031200251400041100014a1200171100021100021100041843021400051100034a1200581100011100024302491103154a1200070b1100011100021100044304491100050b0700553549084203041100021a14000311000311000112000c1100031c1914000411000403182b11000403102b2f11000403082b2f1100042f1400050c000014000603001400071100071100042747001b1100064a120011110005430149110007030418170007354945ffdb1102024a12000111000611000443021400081100014a12001511000843014908421100011400020400ff11000212000b11000212000c03011903022d132e14000311000212000c1100031911000207000c3549084205000021d43b031400020211021a11000211000143024911000212000214000305000022143c00110003150022050000229a3c0211000315002805000022ad3c00110003150031110002421101014a1200070b1100011100021103014a1200030d1102160e005b1102170e005c110003430243043400010b170004354903041100040700253549110004421102011200021200224a1200070b4301490b12002b14000211000212005d14000311000212005b1400040b1200470b1200051200492547000d11000412004a1700013545001211000412004c170001354903010b07001f35491100014a1200071100040b11000333000611000312000b43030b07005e35491100010b12005e07005f354908420b12005e4a12005711000111000243024908420b12002b12005c1400020b1200470b120005120049254700231100024a1200590b1200200b1200254302490b4a12002a03003243011700013545001b0b4a12002a030032430117000135491100024a12005a11000143014911000142050000233a3b011400020211021a110002110001430249110002120002140003050000235e3c01110003150013110002421101014a1200070b43013400010b17000235491100024a120004110001430149110002421100013400040b1200604a1200120b43014211000112006114000311000112006214000411000447002b1102024a1200010553616c740565645f5f0c000243014a12001511000443014a120015110003430145000311000317000235491100024a12001311020a43014211020a4a12001b110001430114000311000312000b1400040553616c741100040300132533000c0565645f5f110004030113253300391102024a1200011100044a120017030203044302430117000235491100044a1200290300030443024911000312000c03101911000307000c35491102194a1200010d1100030e00611100020e006243014205000024913b001400020211021a11000211000143024905000024a33c0411000215004d050000252f3c0411000215004e050000257c3c02110002150066110002421101014a12003d0b11000043023400010b421104014a12000311030144000b12002b11000443031400051100014a12004a11000311000543021400061100064a12002c110002430114000711000612002b1400081103194a1200010d1100070e00611100030e006311000812005d0e005d1100010e006411000812005b0e005b11000812005c0e005c1100061200250e00251100051200650e00604301421100021400051104014a12000311030144000b12002b11000443031400060b4a12006611000511000612006543021400051100014a12004c11000311000643024a12002c1100051200614301420700231100013a234700101100024a12001b1100010b43024500031100014211000414000511000534000f1102024a1200100308430117000535491102124a1200010d110002110003180e004343014a12004611000111000543021400061102024a12000111000612000b4a120017110002430103041100031a430214000703041100021a11000607000c35491102194a1200010d1100060e00631100070e005d1100050e0062430142050000265b3b001400020211021a110002110001430249050000266d3c0411000215004d05000026df3c0411000215004e110002421101014a12003d0b11000043023400010b421104014a12000311030144000b12002b11000443031400051100051200684a120067110003110001120043110001120050430314000611000612005d11000515005d11031b12004d4a1200070b11000111000211000612006311000543051400071100074a120004110006430149110007421100021400051104014a12000311030144000b12002b11000443031400060b4a12006611000511000612006543021400051100061200684a120067110003110001120043110001120050110005120062430414000711000712005d11000615005d11031b12004e4a1200070b11000111000511000712006311000643054205000027b53b001400020211021a11000211000143024911000212000214000305000027c73c0011000315002f0500002a123c021100031500560500002a353c021100031500580500002ac03c0811000315006d110002421101014a12003d0b11000043023400010b420b1200693300090b12006a0b1200482547000208420b1200480b15006a0b12006a14000211000212000b14000311000212000c03041b1400041100040306180b15006903040b1200690301181a1400050c00000b15006b0b12006b1400060300140007110007110005274701211100071100042747001111000311000713110006110007354500f71100061100070301191317000135491100071100041c47005a11000403062933000a1100071100041c03042333004111031e11000103182d1303182b11031e11000103102d0400ff2e1303102b2f11031e11000103082d0400ff2e1303082b2f11031e0400ff1100012e132f1700013545006d11000103082b11000103182d2f170001354911031e11000103182d1303182b11031e11000103102d0400ff2e1303102b2f11031e11000103082d0400ff2e1303082b2f11031e0400ff1100012e132f17000135491100011103321100071100041b03002f1303182b3117000135491100061100071100041913110001311100061100073549110007030118170007354945fed50c00000b15006c0b12006c14000803001400091100091100052747009e1100051100091914000a11000903041c47000a11000611000a1345000a11000611000a03041913170001354911000903042734000611000a03042847000611000145004411032411031e11000103182d131311032511031e11000103102d0400ff2e13133111032611031e11000103082d0400ff2e13133111032711031e0400ff1100012e1313311100081100093549110009030118170009354945ff5808420b4a12006d1100011100020b12006b11032011032111032211032311031e43084908421100011400031100031100020301181314000411000311000203031813110003110002030118354911000411000311000203031835490b4a12006d1100031100020b12006c11032411032511032611032711031f430849110003110002030118131700043549110003110002030318131100031100020301183549110004110003110002030318354908421100011400090b12006914000a110009110002131100030300133114000b110009110002030118131100030301133114000c110009110002030218131100030302133114000d110009110002030318131100030303133114000e030414000f030114001011001011000a2747015611000411000b03182d1311000511000c03102d0400ff2e133111000611000d03082d0400ff2e13311100070400ff11000e2e133111000311000f133114001111000f03011817000f354911000411000c03182d1311000511000d03102d0400ff2e133111000611000e03082d0400ff2e13311100070400ff11000b2e133111000311000f133114001211000f03011817000f354911000411000d03182d1311000511000e03102d0400ff2e133111000611000b03082d0400ff2e13311100070400ff11000c2e133111000311000f133114001311000f03011817000f354911000411000e03182d1311000511000b03102d0400ff2e133111000611000c03082d0400ff2e13311100070400ff11000d2e133111000311000f133114001411000f03011817000f354911001117000b354911001217000c354911001317000d354911001417000e3549110010030118170010354945fea011000811000b03182d1303182b11000811000c03102d0400ff2e1303102b2f11000811000d03082d0400ff2e1303082b2f1100080400ff11000e2e132f11000311000f133114001511000f03011817000f354911000811000c03182d1303182b11000811000d03102d0400ff2e1303102b2f11000811000e03082d0400ff2e1303082b2f1100080400ff11000b2e132f11000311000f133114001611000f03011817000f354911000811000d03182d1303182b11000811000e03102d0400ff2e1303102b2f11000811000b03082d0400ff2e1303082b2f1100080400ff11000c2e132f11000311000f133114001711000f03011817000f354911000811000e03182d1303182b11000811000b03102d0400ff2e1303102b2f11000811000c03082d0400ff2e1303082b2f1100080400ff11000d2e132f11000311000f133114001811000f03011817000f3549110015110009110002354911001611000911000203011835491100171100091100020302183549110018110009110002030318354908421101054a12001b11000243011400041101054a12001b110003430114000511010a4a12001b110001430114000611010a4a12001211000643011400071101344a12004e1100071100040d1100050e005d43034a1200131101054301420700231100013a234700591100014a12006e07006f430114000203021100021200002547003c1100020300131400031100034a120070031043011400040d1100040e005d1100041100034a120070030003104302180e00631100020301130e007142024202421102021100011200004401140002110203110002440114000303001400041100041100011200002747001b1100014a12001d110004430111000311000416170004214945ffd8110002421102024a120072110001430133000a110001120008170001354911020e12001c4a12003d0211020311000144014302421102031200021200174700121100014a120017110002110003430245001d1102031102001200021200174a12000711000111000211000343034401420500002fa33b021400011100011200021400020500002fb73c0211000215004e110001421100010b07007335491100020b070074354908420b1200734a12004e0d0700750e00760b1200740e005d11000211000143034211000112000a14000211000233001711021411000112000844014a12007711000203011943011400031100034700150211013711000103001100021100031943034500031100014205000030763b00140001110001120002140002050000312b3c01110002150080050000318a3c0011000215007e05000033e53c0111000215008405000036d13c0111000215008505000036f93c0311000215004e1100014203000301030203040308031003200340040080031b03360c000b0b070078354911030904010044011103090401004401110309040100440111030904010044010c00040b070079354911030904010044011103090401004401110309040100440111030904010044010c00040b07007a354911030904010044010b07007b354911030904010044010b07007c3549110309030044010b070063354903000b07007d354903000b07004335490b4a12007e43004908421104024a120072110001430133000a1100011200081700013549110414110001440114000211040903044401140003030014000411000403042747001e1100024a12007f03041100041a430111000311000416170004214945ffd9110003420b12007b1400010b12007c1400020b1200791400031100030300131400041100030301131400051100030302131400061100030303131400070b12007a14000811000803001314000911000803011314000a11000803021314000b11000803031314000c110409040100440114000d030014000e030014000f0300140010030017001035491100100401002747002c1100100400802747000911001003012b45000a11001003012b04011b3111000d11001016170010214945ffca030017001035491100100401002747018d11000f11000f03012b3111000f03022b3111000f03032b3111000f03042b3114001111001103082d0400ff1100112e31036331170011354911001111000111000e354911000e110002110011354911000d11000e1314001211000d1100121314001311000d1100131314001404010111000d110011131a05010101001100111a3114001511001503182b11001503082d2f11000411000e354911001503102b11001503102d2f11000511000e354911001503082b11001503182d2f11000611000e354911001511000711000e354905010101011100141a05000100011100131a310401011100121a31050101010011000e1a31170015354911001503182b11001503082d2f110009110011354911001503102b11001503102d2f11000a110011354911001503082b11001503182d2f11000b110011354911001511000c110011354911000e47003211001211000d11000d11000d110014110012311313133117000e354911000f11000d11000d11000f13133117000f3545000a030117000f3517000e3549170010214945fe6908420b4a120080110001430114000203003214000303001400041100041100021200002733000311000347001d110002110004130b12006311000413251700033549170004214945ffd011000347000208421100020b1500631100021200000b0700433514000503041100052633000603061100052633000603081100052647000d1104110700811100051844014003041100050306180301181a0b07007d3514000611040911000644010b0700823514000911040911000644010b0700833514000a0b12007b14000b0b12007814000c0b12007a14000d11000d03001314000e11000d03011314000f11000d03021314001011000d0303131400110300170007354911000711000627470122110007110005274700151100021100071311000911000735170012354500fa11001217001335491100071100051c03002347007011001303082b11001303182d2f170013354911000b11001303182d1303182b11000b11001303102d0400ff2e1303102b2f11000b11001303082d0400ff2e1303082b2f11000b0400ff1100132e132f170013354911001311000c1100071100051b03002f1303182b311700133545005711000503062933000a1100071100051c03042333004111000b11001303182d1303182b11000b11001303102d0400ff2e1303102b2f11000b11001303082d0400ff2e1303082b2f11000b0400ff1100132e132f170013354911000911000711000519131100133103002d170012351100091100073549170007214945fed403001700083549110008110006274700ac11000611000819170007354903031100082e47000a1100091100071345000a11000911000703041913170013354911000803042734000611000703042847000611001345004411000e11000b11001303182d131311000f11000b11001303102d0400ff2e13133111001011000b11001303082d0400ff2e13133111001111000b0400ff1100132e13133111000a110008354911000a1100081303002d11000a1100083549170008214945ff4a084211000103182b050000ff001100012e03082b2f0500ff00001100012e03082c2f11000103182d2f420b1200430306181400040b1200831400050b12007c1400060b12007a14000711000703001314000811000703011314000911000703021314000a11000703031314000b0b4a120080110003430114000c11000c03001314000d11000c03011314000e11000c03021314000f11000c030313140010110408110001440114001111040811001112000044011400120b120085140021110002110011120000274703a10211002111001111000213430117001b35490211002111001111000203011813430117001c35490211002111001111000203021813430117001d35490211002111001111000203031813430117001e354911001b11000503001331170017354911001e11000503011331170018354911001d11000503021331170019354911001c1100050303133117001a3549030417001f3549030117002035491100201100042747014011000811001703182d1311000911001803102c0400ff2e133111000a11001903082c0400ff2e133111000b0400ff11001a2e133111000511001f1331170013354911000811001803182d1311000911001903102c0400ff2e133111000a11001a03082c0400ff2e133111000b0400ff1100172e133111000511001f0301181331170014354911000811001903182d1311000911001a03102c0400ff2e133111000a11001703082c0400ff2e133111000b0400ff1100182e133111000511001f0302181331170015354911000811001a03182d1311000911001703102c0400ff2e133111000a11001803082c0400ff2e133111000b0400ff1100192e133111000511001f0303181331170016354911001317001735491100141700183549110015170019354911001617001a354911001f03041817001f3549170020214945feb611000611001703182d1303182b11000611001803102c0400ff2e1303102b3111000611001903082c0400ff2e1303082b311100060400ff11001a2e133111000511001f1331170013354911000611001803182d1303182b11000611001903102c0400ff2e1303102b3111000611001a03082c0400ff2e1303082b311100060400ff1100172e133111000511001f0301181331170014354911000611001903182d1303182b11000611001a03102c0400ff2e1303102b3111000611001703082c0400ff2e1303082b311100060400ff1100182e133111000511001f0302181331170015354911000611001a03182d1303182b11000611001703102c0400ff2e1303102b3111000611001803082c0400ff2e1303082b311100060400ff1100192e133111000511001f030318133117001635490211002111001311000d31430111001211000235490211002111001611000e31430111001211000203011835490211002111001511000f314301110012110002030218354902110021110014110010314301110012110002030318354911001b17000d354911001c17000e354911001d17000f354911001e1700103549110002030418170002354945fc52110012120008420500003b663b021400011100011200021400020500003b7a3c00110002150084110001421100010b07007335491100020b070063354908420b1200734a1200860700870b1200630d0700750e007603013207004d07004e0c00024305421102031100011200001100021200001844011400031100034a1200881100014301491100034a120088110002110001120000430249110003420500003c773b021400011100011200021400020500003d783c001100021500970500003d803c001100021500980500003dc13c001100021500220500003de63c01110002150099020500003e443b00430011000215004e0500003f433c0311000215009f02050000401b3b0043001100021500a2050000415d3c041100021500aa05000041833c011100021500a605000041d23c011100021500a411000142110002030038254700040d450003110002140003110003120089140004110004030038254700060300324500031100041400050300320b07008a3549020b0700733549020b07008b3549020b0700633549020b07008c3549020b07008d3549020b07008e3549020b07008f35491100010b07009035491100050b070089354911000547002f3e0004140007413d00251103151200911400061100063300141100061200733400061100061200920b0700733549410700931100011200943a2347002f030132110001120094263400040b1200733400181103164a1200950700964301490300320b1200900700943545000d0b120073320b120090070094354908420b120090120094420b12008f140001110001324700090b4a1200224300384211040311000144011400020b4a1200224300490b12008947000c02110339110002430145000311000242020b07008f3549020b07008e3549020b07008d35490b12008b330006020b07008b354908420211041e0211033611000143014301140002110002470024021103350211041d11000212007111000212006311000212005d4303430114000345001e1104024a1200721100014301470009110001120008450003110001140003110003420500003f353b03140002021103190211031843004a12009a0500003e6e3c0343014301140001110002420211051843004a12009b0500003e863c011101000b43034203014700a811000112009c11000107009d3503004800140304480062030548007f07009e4800794945007f0b1200901200943247000b030411000115009c4500690b4a12009f11070311020144011102021102034303490b4a12009843001402041100014a1200a00700a1110204470009110204120008450001024302421100014a1200a00700a10b4a1200a2110703110201440111020211020343034302421100014a1200a343004245ff5308421101014a12003d0b1100004302420b4a12009911000243011400040b12008e1400050b12008f1400060b12008d1400070b4a1200a40700a54301491100073300170211033d11000711000143021700013549020b07008d35490b4a1200a6110001430114000811000812000032470002024211000533000711000517000335490b12008b14000911000934000e11033a44000b07008b3517000935491100094a12008411000443014911000614000a1100094a12004e110008120008030011000343030b07008f35490211033711000803101d43021200080b07008e354911000a3400010242050000414f3b03140002021103190211031843004a12009a05000040453c0343014301140001110002420b1400040211051843004a12009b05000040613c011101000b430342030147009d11000112009c11000107009d35030048000f030248007907009e480073494500790b4a120099110202430117020535490b12007317020635491100014a1200a00700a10b120063110205253300040b12008c3400191102050b070063354911063b11020611020544020b07008c35490b12008c4a12008443004a1200a705000041053b0105000041393b0143024302421100014a1200a343004245ff5e0842110306324700121108174a1200a81108110700a9440143014211073811030611030344024a12004e1103011200081100014302421103044a1200aa1100011103011103051103034304421101014a12003d0b1100004302420300320b12009007009435490300320b07008a35490b4a12009f11000211000311000443034211000114000211000112000011000112000003101c1914000311000311000112000026330024021103371100010300110003430317000235490211033711000111000343020b07008d3549110002420b12008a3300080301320b07008a35490842050000420b3b011400011100011200021400020205000042193b00430011000215004e1100014211023e11000144010b1500ab084205000042e93b03140002021103190211031843004a12009a05000042433c0343014301140001110002420211051843004a12009b050000425b3c011101000b430342030147008711000112009c11000107009d35030048001903024800300305480049030648005907009e48005349450059030211000115009c0b1200ab4a12004e1102011102021102034303421100011200ac14020411020447000b030511000115009c4500230700ad401100014a1200a00700a111070311020444014302421100014a1200a343004245ff7408421101014a12003d0b1100004302420500001f0b3b031400150500002e073b0314011d0500002e633b0114011e0500002ec93b011400350500002f133b011400360500002f433b031400370500002fd63b011400390500003b9f3b0214003d0205000000003b0043001400010205000000ad3b0111000143011400020d05000004f93c010e001205000005893c010e001b1400030d05000005fd3c010e001205000006733c010e001b1400040d05000006de3c010e0012050000070d3c010e001b1400050205000007263b0111000143011400060205000008fd3b011100064301140007020500000a263b0111000143011400080500000c043c031400090d0500000cb43c010e00120500000df03c010e001b07003a0e003514000a0c000014000b030014000c11000c03402747003406000e11010c4a12003b11010c4a12003c11000c030118430143011a03002f11000b11000c1611000c03011817000c354945ffc30500000e983c0714000d0500000ece3c0714000e0500000f043c0714000f0500000f353c07140010020500000f673b011100074301140011020500001ba03b011100014301140012020500001ced3b01110006430114001303011100130700493549030211001307004b35490304110013070043354903041100130700503549020500001e873b011100014301140014020500001f783b011100144301140016020500001fa53b01110016430111001607005335490205000020373b01110016430111001607005435490d05000020cf3c020e005905000021553c010e005a1400170205000021893b0111001343011400180205000023093b0111000143011400190d05000023703c010e001205000023c83c010e001b14001a02050000244f3b01110001430114001b1101014a12000311000144000d11001a0e0065430211001b15002b0d050000259b3c040e006714001c0205000026263b0111001b430114001d1101014a12000311001b12002b0d11001c0e0068430211001d15002b0c000014001e0c000014001f0c00001400200c00001400210c00001400220c00001400230c00001400240c00001400250c00001400260c00001400270c00001400280300140029110029040100274700321100290400802747000911002903012b45000a11002903012b04011b3111002811002916110029030118170029354945ffc4030014002a030014002b030014002c11002c0401002747019711002b11002b03012b3111002b03022b3111002b03032b3111002b03042b3114002d11002d03082d0400ff11002d2e3103633117002d354911002d11001e11002a354911002a11001f11002d354911002811002a1314002e11002811002e1314002f11002811002f1314003004010111002811002d131a050101010011002d1a3114003111003103182b11003103082d2f11002011002a354911003103102b11003103102d2f11002111002a354911003103082b11003103182d2f11002211002a354911003111002311002a354905010101011100301a050001000111002f1a3104010111002e1a31050101010011002a1a31170031354911003103182b11003103082d2f11002411002d354911003103102b11003103102d2f11002511002d354911003103082b11003103182d2f11002611002d354911003111002711002d354911002a47003211002e11002811002811002811003011002e311313133117002a354911002b11002811002811002b13133117002b3545000e030117002b354911002b17002a354911002c03011817002c354945fe5f03000301030203040308031003200340040080031b03360c000b14003202050000275d3b01110018430114003303081100331500431100184a12002d1100334301140034020500002f7f3b00430014003802050000301e3b00430014003a020500003b423b00430014003b031014003c020500003bd83b00430014003e0205000041e43b00430014011c084200ae060108030a1905060e1f080c1908091d1f02190219141d08060c1e1e040a030500041524030b0e02031e191f180e19021f050e01020308040e0c0101060f180b0b081f0a0f141908220b0b1e08190a0f1419082108030a1905051a021f091e081e040a2f1419081e0a595f5459545b5a5f54580a595f5459545b5a5f545b035d4358061f0c03090200041d181e05091e191f04030a040b140819023e191f04030a050e010c001d060e02030e0c19040e080401051e01040e08040702040300061e180f1e191f051d0c1f1e080c0b1f02002e050c1f2e0209080a0e050c1f2e0209082c1914200c010b021f0008094d38392b40554d090c190c0e320004032f180b0b081f3e0417080532090c190c0b3203290c190c2f1419081e051f081e0819061e191f04030a07320c1d1d080309090f01020e063e04170803000c15030004030f3209023d1f020e081e1e2f01020e06061e1d01040e0808321d1f020e081e1e030e0b0a080b04030c010417080d320e1f080c19082508011d081f11320e1f080c190825000c0e2508011d081f083209023f081e081906181d090c19080b3209022b04030c010417080732050c1e05081f0532022608140532042608140432000c1d045d435a58060e050c1f2c190b321f081b081f1e08200c1d070403090815220b412c2f2e29282b2a25242726212023223d3c3f3e39383b3a3534370c0f0e09080b0a05040706010003021d1c1f1e19181b1a1514175d5c5f5e59585b5a5554464250030c0f1e031e0403050c1d1d01140a595d5f5e5f5e5e595c5a0a5f585b5f5e555e5c5d5f0532050c1e050a595f5a555f58585e5b5d050b0102021f070608143e04170806050c1e05081f0a0419081f0c190402031e070e02001d1819080a32150b021f002002090804320608140f3228232e32352b223f2032202229280f0e1f080c190828030e1f141d19021f0f3229282e32352b223f2032202229280f0e1f080c190829080e1f141d19021f0708030e1f141d190709080e1f141d19071d1f020e081e1e06041b3e04170807320e041d05081f0332041b0928030e1f141d19021f0929080e1f141d19021f0a321d1f081b2f01020e060c08030e1f141d192f01020e060c1d1f020e081e1e2f01020e060c09080e1f141d192f01020e06031d0c090518031d0c090400020908071d0c090904030a02041b0532000209080932320e1f080c19021f090b021f000c1919081f0a0e041d05081f19081519041e0c011903060814090c010a021f04190500060b021f000c1906321d0c1f1e08070815080e1819080306090b0832033f021803091e0e320608143d1f04021f3f081e08190c320608143e0e0508091801080f3204031b2608143e0e0508091801080d3209022e1f141d192f01020e06051e1d0104190157091e180f1e191f04030a0708030e290c190c06041e3b04081a061e180f190108050c081e243b072c283e402e2f2e04030c0008080a08193804031955041f0e0203061e180f2004150904031b3e180f200415041e2f02150704031b3e2f021506061e3f021a1e0904030419390c0f0108090a0819380403195e5f1818040319552c1f1f0c143902380403195e5f2c1f1f0c14321524031b0c0104094d0c081e4d0608144d1e041708500b0608143e0e0508091801080e04031b2608143e0e0508091801080908151d0c0309260814160308191a021f06390225021e19221f09081f3e1a0c1d0904001d021f19260814031f0c1a031e0819121f0800021b083d262e3e5a3d0c090904030a0a01020a28030c0f010809111e020b191a0c1f0829080e1f141d19081f0a0b0c1e192c081e2608140d1f08000c040309081f290c190c090e181f1f080319243b0d0e181f1f0803193f081e180119060e02030b040a060e1f141d19020c1a080f0604193e180f190108070f020201080c031108030c0f01083e020b191a0c1f082c283e0301020a4a2918084d19024d1905084d1e0419180c190402034d19050c194d08031b4d0902034a194d1e181d1d021f194d0e1f141d1902414d0b0c01010f0c0e064d19024d071e4d09080e1f141d1906041e3e14030e050b01181e05111d1f041b0c190826081429080e1f141d1904000c1f06041a1f0c1d0403081519041d1f081b030803090f1e020b191a0c1f0829080e1f141d19060c0f1f181d19061f0819181f03101a080f2e1f141d190229080e1f141d19041e19021d0701020a22030e080e273e4d2c283e4d09080e1f141d190d0a08193b0c0104092e051803060419050803061f0807080e191a1a080f4d0e1f141d19024d0302194d04030419040c01041708091002033a080f2e1f141d1902281f1f021f0a3209080e1f141d19081f041e0803190f09080e1f141d194d0b0c0401181f08",{0:Array,1:Object,2:ArrayBuffer,3:Uint8Array,4:Int8Array,5:Uint8ClampedArray,6:Int16Array,7:Uint16Array,8:Int32Array,9:Uint32Array,10:Float32Array,11:Float64Array,12:Math,13:parseInt,14:String,15:decodeURIComponent,get 16(){return escape},17:Error,get 18(){return unescape},19:encodeURIComponent,20:DataView,get 21(){return self},get 22(){return console},23:Promise,get 24(){return t},get 25(){return n},get 26(){return a},get 27(){return c},get 28(){return eC},set 28(e){eC=e},get 29(){return tC},set 29(e){tC=e},get 30(){return rC},set 30(e){rC=e}},globalThis);var RC,xC,DC,LC,NC,MC={exports:{}};RC=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,xC=/^(?=([^\/?#]*))\1([^]*)$/,DC=/(?:\/|^)\.(?=\/)/g,LC=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,MC.exports=NC={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=NC.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=NC.normalizePath(n.path),NC.buildURLFromParts(n)}var i=NC.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=NC.normalizePath(i.path),NC.buildURLFromParts(i)):t;var o=NC.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var a=xC.exec(o.path);o.netLoc=a[1],o.path=a[2]}o.netLoc&&!o.path&&(o.path="/");var s={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(s.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var u=o.path,c=u.substring(0,u.lastIndexOf("/")+1)+i.path;s.path=NC.normalizePath(c)}else s.path=o.path,i.params||(s.params=o.params,i.query||(s.query=o.query));return null===s.path&&(s.path=r.alwaysNormalize?NC.normalizePath(i.path):i.path),NC.buildURLFromParts(s)},parseURL:function(e){var t=RC.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(DC,"");e.length!==(e=e.replace(LC,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};var BC=MC.exports,UC=di,jC=m,FC=Ut.f;UC({target:"Object",stat:!0,forced:Object.defineProperty!==FC,sham:!jC},{defineProperty:FC});var VC=di,GC=m,HC=sl.f;VC({target:"Object",stat:!0,forced:Object.defineProperties!==HC,sham:!GC},{defineProperties:HC});var KC=Gn,zC=q,WC=y,YC=_i;di({target:"Object",stat:!0,sham:!m},{getOwnPropertyDescriptors:function(e){for(var t,r,n=zC(e),i=WC.f,o=KC(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&YC(a,t,r);return a}});var XC={},ZC=U,qC=q,QC=cn.f,JC=Td,eI="object"==("undefined"==typeof window?"undefined":_typeof$3(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];XC.f=function(e){return eI&&"Window"==ZC(e)?function(e){try{return QC(e)}catch(EU){return JC(eI)}}(e):QC(qC(e))};var tI={},rI=ft;tI.f=rI;var nI=g,iI=Ze,oI=tI,aI=Ut.f,sI=function(e){var t=nI.Symbol||(nI.Symbol={});iI(t,e)||aI(t,e,{value:oI.f(e)})},uI=E,cI=oe,lI=ft,dI=un,fI=di,hI=g,pI=E,gI=L,yI=m,vI=ve,mI=v,_I=Ze,bI=ae,AI=Ht,EI=q,SI=St,TI=Yc,$I=k,wI=Pl,CI=ll,II=cn,kI=XC,OI=Mn,PI=y,RI=Ut,xI=sl,DI=S,LI=un,NI=Me.exports,MI=wr,BI=tt,UI=ft,jI=tI,FI=sI,VI=function(){var e=cI("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=lI("toPrimitive");t&&!t[n]&&dI(t,n,(function(e){return uI(r,this)}),{arity:1})},GI=xo,HI=Hr,KI=fd.forEach,zI=$r("hidden"),WI="Symbol",YI=HI.set,XI=HI.getterFor(WI),ZI=Object.prototype,qI=hI.Symbol,QI=qI&&qI.prototype,JI=hI.TypeError,ek=hI.QObject,tk=PI.f,rk=RI.f,nk=kI.f,ik=DI.f,ok=gI([].push),ak=NI("symbols"),sk=NI("op-symbols"),uk=NI("wks"),ck=!ek||!ek.prototype||!ek.prototype.findChild,lk=yI&&mI((function(){return 7!=wI(rk({},"a",{get:function(){return rk(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=tk(ZI,t);n&&delete ZI[t],rk(e,t,r),n&&e!==ZI&&rk(ZI,t,n)}:rk,dk=function(e,t){var r=ak[e]=wI(QI);return YI(r,{type:WI,tag:e,description:t}),yI||(r.description=t),r},fk=function e(t,r,n){t===ZI&&e(sk,r,n),AI(t);var i=SI(r);return AI(n),_I(ak,i)?(n.enumerable?(_I(t,zI)&&t[zI][i]&&(t[zI][i]=!1),n=wI(n,{enumerable:$I(0,!1)})):(_I(t,zI)||rk(t,zI,$I(1,{})),t[zI][i]=!0),lk(t,i,n)):rk(t,i,n)},hk=function(e,t){AI(e);var r=EI(t),n=CI(r).concat(vk(r));return KI(n,(function(t){yI&&!pI(pk,r,t)||fk(e,t,r[t])})),e},pk=function(e){var t=SI(e),r=pI(ik,this,t);return!(this===ZI&&_I(ak,t)&&!_I(sk,t))&&(!(r||!_I(this,t)||!_I(ak,t)||_I(this,zI)&&this[zI][t])||r)},gk=function(e,t){var r=EI(e),n=SI(t);if(r!==ZI||!_I(ak,n)||_I(sk,n)){var i=tk(r,n);return!i||!_I(ak,n)||_I(r,zI)&&r[zI][n]||(i.enumerable=!0),i}},yk=function(e){var t=nk(EI(e)),r=[];return KI(t,(function(e){_I(ak,e)||_I(MI,e)||ok(r,e)})),r},vk=function(e){var t=e===ZI,r=nk(t?sk:EI(e)),n=[];return KI(r,(function(e){!_I(ak,e)||t&&!_I(ZI,e)||ok(n,ak[e])})),n};vI||(qI=function(){if(bI(QI,this))throw JI("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?TI(arguments[0]):void 0,t=BI(e),r=function e(r){this===ZI&&pI(e,sk,r),_I(this,zI)&&_I(this[zI],t)&&(this[zI][t]=!1),lk(this,t,$I(1,r))};return yI&&ck&&lk(ZI,t,{configurable:!0,set:r}),dk(t,e)},LI(QI=qI.prototype,"toString",(function(){return XI(this).tag})),LI(qI,"withoutSetter",(function(e){return dk(BI(e),e)})),DI.f=pk,RI.f=fk,xI.f=hk,PI.f=gk,II.f=kI.f=yk,OI.f=vk,jI.f=function(e){return dk(UI(e),e)},yI&&(rk(QI,"description",{configurable:!0,get:function(){return XI(this).description}}),LI(ZI,"propertyIsEnumerable",pk,{unsafe:!0}))),fI({global:!0,constructor:!0,wrap:!0,forced:!vI,sham:!vI},{Symbol:qI}),KI(CI(uk),(function(e){FI(e)})),fI({target:WI,stat:!0,forced:!vI},{useSetter:function(){ck=!0},useSimple:function(){ck=!1}}),fI({target:"Object",stat:!0,forced:!vI,sham:!yI},{create:function(e,t){return void 0===t?wI(e):hk(wI(e),t)},defineProperty:fk,defineProperties:hk,getOwnPropertyDescriptor:gk}),fI({target:"Object",stat:!0,forced:!vI},{getOwnPropertyNames:yk}),VI(),GI(qI,WI),MI[zI]=!0;var mk=ve&&!!Symbol.for&&!!Symbol.keyFor,_k=di,bk=oe,Ak=Ze,Ek=Yc,Sk=Me.exports,Tk=mk,$k=Sk("string-to-symbol-registry"),wk=Sk("symbol-to-string-registry");_k({target:"Symbol",stat:!0,forced:!Tk},{for:function(e){var t=Ek(e);if(Ak($k,t))return $k[t];var r=bk("Symbol")(t);return $k[t]=r,wk[r]=t,r}});var Ck=di,Ik=Ze,kk=Se,Ok=$e,Pk=mk,Rk=(0,Me.exports)("symbol-to-string-registry");Ck({target:"Symbol",stat:!0,forced:!Pk},{keyFor:function(e){if(!kk(e))throw TypeError(Ok(e)+" is not a symbol");if(Ik(Rk,e))return Rk[e]}});var xk=di,Dk=oe,Lk=ta,Nk=E,Mk=L,Bk=v,Uk=hi,jk=Q,Fk=te,Vk=Se,Gk=sa,Hk=ve,Kk=Dk("JSON","stringify"),zk=Mk(/./.exec),Wk=Mk("".charAt),Yk=Mk("".charCodeAt),Xk=Mk("".replace),Zk=Mk(1..toString),qk=/[\uD800-\uDFFF]/g,Qk=/^[\uD800-\uDBFF]$/,Jk=/^[\uDC00-\uDFFF]$/,eO=!Hk||Bk((function(){var e=Dk("Symbol")();return"[null]"!=Kk([e])||"{}"!=Kk({a:e})||"{}"!=Kk(Object(e))})),tO=Bk((function(){return'"\\udf06\\ud834"'!==Kk("\udf06\ud834")||'"\\udead"'!==Kk("\udead")})),rO=function(e,t){var r=Gk(arguments),n=t;if((Fk(t)||void 0!==e)&&!Vk(e))return Uk(t)||(t=function(e,t){if(jk(n)&&(t=Nk(n,this,e,t)),!Vk(t))return t}),r[1]=t,Lk(Kk,null,r)},nO=function(e,t,r){var n=Wk(r,t-1),i=Wk(r,t+1);return zk(Qk,e)&&!zk(Jk,i)||zk(Jk,e)&&!zk(Qk,n)?"\\u"+Zk(Yk(e,0),16):e};Kk&&xk({target:"JSON",stat:!0,arity:3,forced:eO||tO},{stringify:function(e,t,r){var n=Gk(arguments),i=Lk(eO?rO:Kk,null,n);return tO&&"string"==typeof i?Xk(i,qk,nO):i}});var iO=Mn,oO=We;di({target:"Object",stat:!0,forced:!ve||v((function(){iO.f(1)}))},{getOwnPropertySymbols:function(e){var t=iO.f;return t?t(oO(e)):[]}});var aO=L,sO=ke,uO=te,cO=Ze,lO=sa,dO=_,fO=Function,hO=aO([].concat),pO=aO([].join),gO={},yO=function(e,t,r){if(!cO(gO,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";gO[t]=fO("C,a","return new C("+pO(n,",")+")")}return gO[t](e,r)},vO=dO?fO.bind:function(e){var t=sO(this),r=t.prototype,n=lO(arguments,1),i=function r(){var i=hO(n,lO(arguments));return this instanceof r?yO(t,i.length,i):t.apply(e,i)};return uO(r)&&(i.prototype=r),i},mO=di,_O=ta,bO=vO,AO=Ko,EO=Ht,SO=te,TO=Pl,$O=v,wO=oe("Reflect","construct"),CO=Object.prototype,IO=[].push,kO=$O((function(){function e(){}return!(wO((function(){}),[],e)instanceof e)})),OO=!$O((function(){wO((function(){}))})),PO=kO||OO;function RO(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(EU){return void r(EU)}s.done?t(u):Promise.resolve(u).then(n,i)}function xO(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){RO(o,n,i,a,s,"next",e)}function s(e){RO(o,n,i,a,s,"throw",e)}a(void 0)}))}}function DO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function LO(e,t,r){return t&&DO(e.prototype,t),r&&DO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BO(e,t){return(BO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function UO(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BO(e,t)}function jO(e){return(jO="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)})(e)}function FO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VO(e,t){if(t&&("object"===jO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return FO(e)}function GO(e){return(GO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HO(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(DR){return!1}}function KO(e,t,r){return(KO=HO()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&BO(i,r.prototype),i}).apply(null,arguments)}function zO(e){var t="function"==typeof Map?new Map:void 0;return zO=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return KO(e,arguments,GO(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),BO(n,e)},zO(e)}mO({target:"Reflect",stat:!0,forced:PO,sham:PO},{construct:function(e,t){AO(e),EO(t);var r=arguments.length<3?e:AO(arguments[2]);if(OO&&!kO)return wO(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return _O(IO,n,t),new(_O(bO,e,n))}var i=r.prototype,o=TO(SO(i)?i:CO),a=_O(e,o,t);return SO(a)?a:o}});var WO={exports:{}},YO={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(YO),function(e){var t=YO.exports.default;function r(){e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var i,o,a,s,u=t&&t.prototype instanceof p?t:p,c=Object.create(u.prototype),l=new w(n||[]);return c._invoke=(i=e,o=r,a=l,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return{value:void 0,done:!0}}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){var n=S(r,a);if(n){if(n===h)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";var u=f(i,o,a);if("normal"===u.type){if(s=a.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s="completed",a.method="throw",a.arg=u.arg)}}),c}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(k){return{type:"throw",arg:k}}}n.wrap=d;var h={};function p(){}function g(){}function y(){}var v={};l(v,s,(function(){return this}));var m=Object.getPrototypeOf,_=m&&m(m(C([])));_&&_!==i&&o.call(_,s)&&(v=_);var b=y.prototype=p.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,r){function n(i,a,s,u){var c=f(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==t(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;this._invoke=function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}}function S(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function $(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:I}}function I(){return{value:void 0,done:!0}}return g.prototype=y,l(b,"constructor",y),l(y,"constructor",g),g.displayName=l(y,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},n.awrap=function(e){return{__await:e}},A(E.prototype),l(E.prototype,u,(function(){return this})),n.AsyncIterator=E,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var a=new E(d(e,t,r,i),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(b),l(b,c,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},n.values=C,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach($),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),$(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;$(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(WO);var XO=WO.exports(),ZO=XO;try{regeneratorRuntime=XO}catch(SU){"object"==("undefined"==typeof globalThis?"undefined":_typeof$3(globalThis))?globalThis.regeneratorRuntime=XO:Function("r","regeneratorRuntime = r")(XO)}var qO=fd.forEach,QO=Rd("forEach")?[].forEach:function(e){return qO(this,e,arguments.length>1?arguments[1]:void 0)},JO=g,eP=np,tP=ap,rP=QO,nP=ir,iP=function(e){if(e&&e.forEach!==rP)try{nP(e,"forEach",rP)}catch(EU){e.forEach=rP}};for(var oP in eP)eP[oP]&&iP(JO[oP]&&JO[oP].prototype);function aP(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.used=!1,r.resolve=function(){return r.used=!0,e.apply(void 0,arguments)},r.reject=function(){return r.used=!0,t.apply(void 0,arguments)},r}iP(tP);var sP,uP=function(){function e(){MO(this,e)}return LO(e,null,[{key:"start",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&e.start(0)<0?0:e.start(0):0}},{key:"end",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1):0}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(EU){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var o=r.length;if(o&&t){var a=r[o-1],s=a[1];if(e.start(n)-s<=t){var u=e.end(n);u>s&&(a[1]=u)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"length",value:function(e){return e&&e.length?e.reduce((function(e,t){return e+(t[1]-t[0])}),0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,o=0,a=0,s=0,u=0,c=0,l=0,d=e.buffers(t,n),f=0,h=d.length;f<h;f++){var p=d[f];if(r+n>=p[0]&&r<p[1])i=p[0],o=p[1],a=f;else{if(r+n<p[0]){s=p[0],u=p[1];break}r+n>p[1]&&(c=p[0],l=p[1])}}return{start:i,end:o,index:a,buffers:d,nextStart:s,nextEnd:u,prevStart:c,prevEnd:l,currentTime:r,behind:r-i,remaining:o?o-r:0,length:e.length&&e.length(d)}}}]),e}();function cP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=GO(e);if(t){var i=GO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return VO(this,r)}}var lP="manifest",dP="network",fP="network_timeout",hP="demux",pP="remux",gP="media",yP="other",vP={FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",OPTION:"OPTION"},mP=(NO(sP={},lP,{HLS:1100}),NO(sP,dP,2100),NO(sP,fP,2101),NO(sP,hP,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400}),NO(sP,pP,{FMP4:4100,MP4:4200}),NO(sP,gP,{MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202}),NO(sP,yP,8e3),sP),_P=function(e){UO(r,e);var t=cP(r);function r(e,n,i,o,a){var s;return MO(this,r),(s=t.call(this,a||(null==i?void 0:i.message))).errorType=e===fP?dP:e,s.originError=i,s.ext=o,s.errorCode=mP[e][n]||mP[e],s.errorMessage=s.message,s.errorCode||(s.errorType=yP,s.errorCode=mP[s.errorType]),s}return LO(r,null,[{key:"create",value:function(e,t,n,i,o){return e instanceof r?e:(e instanceof Error&&(n=e,e=""),e||(e=yP),new r(e,t,n,i,o))}},{key:"network",value:function(e){var t;return new r(null!=e&&e.isTimeout?fP:dP,e,null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e||null===(t=e.response)||void 0===t?void 0:t.status})}}]),r}(zO(Error)),bP="undefined"!=typeof window?window.MediaSource||window.WebKitMediaSource:null,AP=function(){function e(t){var r=this;MO(this,e),NO(this,"media",null),NO(this,"mediaSource",null),NO(this,"_openPromise",aP()),NO(this,"_queue",Object.create(null)),NO(this,"_sourceBuffer",Object.create(null)),NO(this,"_onSBUpdateEnd",(function(e){var t=r._queue[e];if(t){var n=t.shift();n&&(n.promise.resolve(),r._startQueue(e))}})),NO(this,"_onSBUpdateError",(function(e,t){var n=r._queue[e];if(n){var i=n[0];i&&i.promise.reject(new _P(gP,vP.MSE_APPEND_BUFFER,t))}})),t&&this.bindMedia(t)}var t,r,n;return LO(e,[{key:"isOpened",get:function(){var e;return"open"===(null===(e=this.mediaSource)||void 0===e?void 0:e.readyState)}},{key:"duration",get:function(){var e;return(null===(e=this.mediaSource)||void 0===e?void 0:e.duration)||-1}},{key:"updateDuration",value:function(e){var t=this;return this._enqueueBlockingOp((function(){t.mediaSource&&(t.mediaSource.duration=e)}))}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource;t.addEventListener("sourceopen",(function r(){t.removeEventListener("sourceopen",r),e._openPromise.resolve()})),this._openPromise=aP()}return this._openPromise}},{key:"bindMedia",value:(n=xO(ZO.mark((function e(t){var r,n,i=this;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mediaSource&&!this.media){e.next=3;break}return e.next=3,this.unbindMedia();case 3:if(t&&bP){e.next=5;break}throw new Error("Param media or MediaSource does not exist");case 5:return this.media=t,r=this.mediaSource=new bP,t.src=URL.createObjectURL(r),n=function e(){r.removeEventListener("sourceopen",e),URL.revokeObjectURL(t.src),i._openPromise.resolve()},r.addEventListener("sourceopen",n),e.abrupt("return",this._openPromise);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unbindMedia",value:(r=xO(ZO.mark((function e(){var t,r=this;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),t=this.mediaSource){if(Object.keys(this._queue).forEach((function(e){var t=r._queue[e];t&&t.forEach((function(e){return e.promise.resolve}))})),"open"===t.readyState)try{t.endOfStream()}catch(EU){}Object.keys(this._sourceBuffer).forEach((function(e){try{t.removeSourceBuffer(r._sourceBuffer[e])}catch(EU){}}))}if(this.media){this.media.removeAttribute("src");try{this.media.load()}catch(EU){}this.media=null}this.mediaSource=null,this._openPromise=aP(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"createSource",value:function(e,t){if(!this._sourceBuffer[e]&&this.mediaSource){var r;try{r=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(EU){throw new _P(gP,vP.MSE_ADD_SB,EU)}r.mimeType=t,r.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),r.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var r=this._sourceBuffer[e];return this.mediaSource&&r&&r.mimeType!==t&&"function"==typeof r.changeType?this._enqueueOp((function(){r.changeType(t)})):Promise.resolve()}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t){var r=this;return t&&t.byteLength&&this._sourceBuffer[e]?this._enqueueOp(e,(function(){r.mediaSource&&r._sourceBuffer[e].appendBuffer(t)})):Promise.resolve()}},{key:"remove",value:function(e,t,r){var n=this;if(1!==Object.keys(this._sourceBuffer).length)return this._enqueueOp(e,(function(){if(n.mediaSource){var i=n._sourceBuffer[e];t>=r||!i?n._onSBUpdateEnd(e):i.remove(t,r)}}))}},{key:"clearBuffer",value:function(e,t){var r,n=this;return Object.keys(this._sourceBuffer).forEach((function(i){r=n._enqueueOp(i,(function(){n.mediaSource&&n._sourceBuffer[i].remove(e,t)}))})),r}},{key:"clearAllBuffer",value:function(){var e,t=this;return Object.keys(this._sourceBuffer).forEach((function(r){e=t._enqueueOp(r,(function(){if(t.mediaSource){var e=t._sourceBuffer[r];e.remove(0,uP.end(uP.get(e)))}}))})),e}},{key:"endOfStream",value:function(e){var t=this;return this.mediaSource&&"open"===this.mediaSource.readyState?this._enqueueBlockingOp((function(){var r=t.mediaSource;r&&"open"===r.readyState&&(e?r.endOfStream(e):r.endOfStream())})):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(e,t){var r=this.mediaSource;e<0||t<e||null==r||!r.setLiveSeekableRange||"open"!==r.readyState||r.setLiveSeekableRange(e,t)}},{key:"buffered",value:function(e){return uP.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return uP.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return uP.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t){if(!this.mediaSource)return Promise.resolve();var r=this._queue[e]=this._queue[e]||[],n={exec:t,promise:aP()};return r.push(n),1===r.length&&this._startQueue(e),n.promise}},{key:"_enqueueBlockingOp",value:(t=xO(ZO.mark((function e(t){var r,n,i=this;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaSource){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if((r=Object.keys(this._sourceBuffer)).length){e.next=5;break}return e.abrupt("return",t());case 5:return n=[],r.forEach((function(e){var t=i._queue[e],r=aP();n.push(r),t.push({exec:function(){return r.resolve()},promise:r}),1===t.length&&i._startQueue(e)})),e.abrupt("return",Promise.all(n).then((function(){try{return t()}finally{r.forEach((function(e){var t=i._queue[e],r=i._sourceBuffer[e];null==t||t.shift(),r&&r.updating||i._startQueue(e)}))}})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var r=t[0];if(r)try{r.exec()}catch(EU){r.promise.reject(new _P(gP,vP.MSE_OTHER,EU)),t.shift(),this._startQueue(e)}}}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(!bP)return!1;try{return bP.isTypeSupported(e)}catch(EU){return!1}}}]),e}();NO(AP,"VIDEO","video"),NO(AP,"AUDIO","audio");var EP=di,SP=ps,TP=v,$P=oe,wP=Q,CP=Zo,IP=Vc,kP=un,OP=SP&&SP.prototype;if(EP({target:"Promise",proto:!0,real:!0,forced:!!SP&&TP((function(){OP.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=CP(this,$P("Promise")),r=wP(e);return this.then(r?function(r){return IP(t,e()).then((function(){return r}))}:e,r?function(r){return IP(t,e()).then((function(){throw r}))}:e)}}),wP(SP)){var PP=$P("Promise").prototype.finally;OP.finally!==PP&&kP(OP,"finally",PP,{unsafe:!0})}var RP="fetch",xP="xhr",DP="arraybuffer",LP="text",NP="json";function MP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=GO(e);if(t){var i=GO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return VO(this,r)}}var BP=function(e){UO(r,e);var t=MP(r);function r(e,n,i,o){var a;return MO(this,r),NO(FO(a=t.call(this,o)),"retryCount",0),NO(FO(a),"isTimeout",!1),NO(FO(a),"loaderType",RP),NO(FO(a),"startTime",0),NO(FO(a),"endTime",0),a.url=e,a.request=n,a.response=i,a}return r}(zO(Error)),UP=fd.filter;di({target:"Array",proto:!0,forced:!Ji("filter")},{filter:function(e){return UP(this,e,arguments.length>1?arguments[1]:void 0)}});var jP=We,FP=Wf,VP=Uf;di({target:"Object",stat:!0,forced:v((function(){FP(1)})),sham:!VP},{getPrototypeOf:function(e){return FP(jP(e))}});var GP=Object.prototype.toString;function HP(e){if("[object Object]"!==GP.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function KP(e){if(e&&null!=e[0]&&(0!==e[0]||null!=e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function zP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function WP(e,t){if(e){if(!t)return e;var r,n=Object.keys(t).map((function(e){if(null!=(r=t[e]))return Array.isArray(r)?e+="[]":r=[r],r.map((function(t){var r,n;return r=t,"[object Date]"===GP.call(r)?t=t.toISOString():null!==(n=t)&&"object"===jO(n)&&(t=JSON.stringify(t)),"".concat(zP(e),"=").concat(zP(t))})).join("&")})).filter(Boolean).join("&");if(n){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}}function YP(e,t,r,n,i,o){return n=null!=n?parseFloat(n):null,r=parseInt(r||"0",10),isNaN(r)&&(r=0),{data:e,response:t,contentLength:r,age:n,startTime:i,firstByteTime:o,endTime:Date.now()}}var XP=function(){function e(){MO(this,e),NO(this,"_abortController",null),NO(this,"_timeoutTimer",null),NO(this,"_reader",null),NO(this,"_response",null),NO(this,"_aborted",!1)}var t;return LO(e,[{key:"load",value:function(e){var t,r=this,n=e.url,i=e.timeout,o=e.responseType,a=e.onProgress,s=e.onTimeout,u=e.range,c=e.transformResponse,l=e.request,d=e.params,f=e.method,h=e.headers,p=e.body,g=e.mode,y=e.credentials,v=e.cache,m=e.redirect,_=e.referrer,b=e.referrerPolicy;this._aborted=!1,this._abortController="undefined"!=typeof AbortController&&new AbortController;var A={method:f,headers:h,body:p,mode:g,credentials:y,cache:v,redirect:m,referrer:_,referrerPolicy:b,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal},E=!1;clearTimeout(this._timeoutTimer),n=WP(n,d);var S=KP(u);S&&((h=l?l.headers:A.headers=A.headers||new Headers)instanceof Headers?h.append("Range",S):h.Range=S),i&&(this._timeoutTimer=setTimeout((function(){if(E=!0,r.cancel(),s){var e=new BP(n,A);e.isTimeout=!0,s(e)}}),i));var T,$=Date.now();return fetch(l||n,l?void 0:A).then((T=xO(ZO.mark((function e(t){var i,s;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(r._timeoutTimer),r._response=t,!r._aborted){e.next=4;break}return e.abrupt("return");case 4:if(c&&(t=c(t,n)||t),t.ok){e.next=7;break}throw new BP(n,A,t,"bad network response");case 7:if(i=Date.now(),o!==LP){e.next=14;break}return e.next=11,t.text();case 11:s=e.sent,e.next=28;break;case 14:if(o!==NP){e.next=20;break}return e.next=17,t.json();case 17:s=e.sent,e.next=28;break;case 20:if(!a){e.next=24;break}r._loadChunk(t,a),e.next=28;break;case 24:return e.next=26,t.arrayBuffer();case 26:s=e.sent,s=new Uint8Array(s);case 28:return e.abrupt("return",YP(s,t,t.headers.get("Content-Length"),t.headers.get("age"),$,i));case 29:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)})).catch((function(e){if(clearTimeout(r._timeoutTimer),!r._aborted||E)throw(e=e instanceof BP?e:new BP(n,A)).startTime=$,e.endTime=Date.now(),e.isTimeout=E,e}))}},{key:"cancel",value:(t=xO(ZO.mark((function e(){return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._aborted){e.next=2;break}return e.abrupt("return");case 2:if(this._aborted=!0,!this._response){e.next=13;break}if(e.prev=4,!this._reader){e.next=8;break}return e.next=8,this._reader.cancel();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:this._response=this._reader=null;case 13:if(this._abortController){try{this._abortController.abort()}catch(EU){}this._abortController=null}case 14:case"end":return e.stop()}}),e,this,[[4,10]])}))),function(){return t.apply(this,arguments)})},{key:"_loadChunk",value:function(e,t){var r,n,i,o,a=this,s=this._reader=e.body.getReader(),u=(o=xO(ZO.mark((function o(){return ZO.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=Date.now(),o.prev=1,o.next=4,s.read();case 4:r=o.sent,i=Date.now(),o.next=13;break;case 8:return o.prev=8,o.t0=o.catch(1),i=Date.now(),t(void 0,!0,{startTime:n,endTime:i},e),o.abrupt("return");case 13:if(!a._aborted){o.next=16;break}return t(void 0,!0,{startTime:n,endTime:i},e),o.abrupt("return");case 16:t(r.value,r.done,{startTime:n,endTime:i},e),r.done||u();case 18:case"end":return o.stop()}}),o,null,[[1,8]])}))),function(){return o.apply(this,arguments)});u()}}],[{key:"isSupported",value:function(){return!("undefined"==typeof fetch)}}]),e}(),ZP=di,qP=v,QP=q,JP=y.f,eR=m,tR=qP((function(){JP(1)}));function rR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nR(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rR(Object(r),!0).forEach((function(t){NO(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rR(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({loaderType:RP,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:LP,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0},e)}function iR(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}ZP({target:"Object",stat:!0,forced:!eR||tR,sham:!eR},{getOwnPropertyDescriptor:function(e,t){return JP(QP(e),t)}});var oR=m,aR=dr.EXISTS,sR=L,uR=Ut.f,cR=Function.prototype,lR=sR(cR.toString),dR=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,fR=sR(dR.exec);oR&&!aR&&uR(cR,"name",{configurable:!0,get:function(){try{return fR(dR,lR(this))[1]}catch(EU){return""}}});var hR=Zp;di({target:"Array",stat:!0,forced:!yc((function(e){Array.from(e)}))},{from:hR});var pR=di,gR=m,yR=g,vR=L,mR=Ze,_R=Q,bR=ae,AR=Yc,ER=Ut.f,SR=Yn,TR=yR.Symbol,$R=TR&&TR.prototype;if(gR&&_R(TR)&&(!("description"in $R)||void 0!==TR().description)){var wR={},CR=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:AR(arguments[0]),t=bR($R,this)?new TR(e):void 0===e?TR():TR(e);return""===e&&(wR[t]=!0),t};SR(CR,TR),CR.prototype=$R,$R.constructor=CR;var IR="Symbol(test)"==String(TR("test")),kR=vR($R.valueOf),OR=vR($R.toString),PR=/^Symbol\((.*)\)[^)]+$/,RR=vR("".replace),xR=vR("".slice);ER($R,"description",{configurable:!0,get:function(){var e=kR(this);if(mR(wR,e))return"";var t=OR(e),r=IR?xR(t,7,-1):RR(t,PR,"$1");return""===r?void 0:r}}),pR({global:!0,constructor:!0,forced:!0},{Symbol:CR})}sI("iterator");var DR,LR=dr.PROPER,NR=v,MR=A_,BR=k_.trim;function UR(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return jR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jR(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function jR(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}di({target:"String",proto:!0,forced:(DR="trim",NR((function(){return!!MR[DR]()||"​᠎"!=="​᠎"[DR]()||LR&&MR[DR].name!==DR})))},{trim:function(){return BR(this)}});var FR=function(){function e(){MO(this,e),NO(this,"_xhr",null),NO(this,"_aborted",!1),NO(this,"_timeoutTimer",null)}return LO(e,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer);var r=e.url,n=e.params,i=e.timeout,o=e.responseType,a=e.onTimeout,s=e.transformResponse,u=e.onProgress,c=e.method,l=e.credentials,d=e.body,f=e.headers,h=e.range,p=e.request,g=!1;r=WP(r,n);var y=Date.now();return new Promise((function(e,n){var v=t._xhr=new XMLHttpRequest;v.open(c||"GET",r,!0),v.responseType=o,v.withCredentials="include"===l||"same-origin"===l;var m=KP(h);m&&((f=f||{}).Range=m),f&&Object.keys(f).forEach((function(e){v.setRequestHeader(e,f[e])})),i&&(t._timeoutTimer=setTimeout((function(){if(g=!0,t.cancel(),a){var e=new BP(r,p);e.isTimeout=!0,a(e)}}),i)),v.onerror=function(e){return n(e)},v.onreadystatechange=function(){if(v.readyState>=2){clearTimeout(t._timeoutTimer);var i=Date.now();if(4===v.readyState){if(v.onreadystatechange=null,t._aborted)return;var o=v.status,a={ok:o>=200&&o<300,status:o,statusText:v.statusText,url:v.responseURL,headers:t._getHeaders(v),body:v.response};if(s&&(a=s(a,r)||a),!a.ok)return n(new BP(r,p,a,"bad network response"));var c=v.responseType===DP,l=c?new Uint8Array(v.response):v.response;u&&u(c?l:void 0,!0,{startTime:y,endTime:Date.now()},a),e(YP(l,a,a.headers["content-length"],a.headers.age,y,i))}}},v.send(d)})).catch((function(e){if(clearTimeout(t._timeoutTimer),!t._aborted||g)throw(e=e instanceof BP?e:new BP(r,p)).startTime=y,e.endTime=Date.now(),e.isTimeout=g,e}))}},{key:"cancel",value:function(){if(!this._aborted)return this._aborted=!0,this._xhr?this._xhr.cancel():void 0}},{key:"_getHeaders",value:function(e){var t,r={},n=UR(e.getAllResponseHeaders().trim().split("\r\n"));try{for(n.s();!(t=n.n()).done;){var i=t.value.split(": ");r[i[0].toLowerCase()]=i.slice(1).join(": ")}}catch(o){n.e(o)}finally{n.f()}return r}}],[{key:"isSupported",value:function(){return"undefined"!=typeof XMLHttpRequest}}]),e}(),VR=["retry","retryDelay","onRetryError","transformError"],GR=function(){function e(t,r){MO(this,e),this.promise=aP(),this.alive=!!r.onProgress,this._loaderType=t,this._loader=t===RP?new XP:new FR,this._config=r,this._retryCount=0,this._retryTimer=null,this._canceled=!1}var t;return LO(e,[{key:"exec",value:function(){var e,t=this,r=this._config,n=r.retry,i=r.retryDelay,o=r.onRetryError,a=r.transformError,s=iR(r,VR),u=(e=xO(ZO.mark((function e(){var r,c;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t._loader.load(s);case 3:r=e.sent,t.promise.resolve(r),e.next=22;break;case 7:if(e.prev=7,e.t0=e.catch(0),!t._canceled){e.next=11;break}return e.abrupt("return");case 11:if(e.t0.loaderType=t._loaderType,e.t0.retryCount=t._retryCount,c=e.t0,a&&(c=a(c)||c),o&&t._retryCount>0&&o(c,t._retryCount,n),t._retryCount++,!(t._retryCount<=n)){e.next=21;break}return clearTimeout(t._retryTimer),t._retryTimer=setTimeout(u,i),e.abrupt("return");case 21:t.promise.reject(c);case 22:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return e.apply(this,arguments)});return u(),this.promise}},{key:"cancel",value:(t=xO(ZO.mark((function e(){return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,e.abrupt("return",this._loader.cancel());case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function HR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if((t=t.filter(Boolean)).length<2)return t[0];var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),i=0;return t.forEach((function(e){n.set(e,i),i+=e.byteLength})),n}function KR(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}var zR=function(){function e(t){MO(this,e),NO(this,"type",RP),NO(this,"_queue",[]),NO(this,"_alive",[]),NO(this,"_currentTask",null),this._config=nR(t),this._config.loaderType!==xP&&XP.isSupported()||(this.type=xP)}var t;return LO(e,[{key:"isFetch",value:function(){return this.type===RP}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?t=e:t.url=e||t.url||this._config.url,(t=Object.assign({},this._config,t)).params&&(t.params=Object.assign({},t.params)),t.headers&&HP(t.headers)&&(t.headers=Object.assign({},t.headers)),t.body&&HP(t.body)&&(t.body=Object.assign({},t.body)),t.transformRequest&&(t=t.transformRequest(t)||t);var r=new GR(this.type,t);return this._queue.push(r),1===this._queue.length&&this._processTask(),r.promise}},{key:"cancel",value:(t=xO(ZO.mark((function e(){var t;return ZO.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map((function(e){return e.cancel()})).concat(this._alive.map((function(e){return e.cancel()}))),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,KR();case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;this._currentTask=this._queue.shift(),this._currentTask&&(this._currentTask.alive&&this._alive.push(this._currentTask),this._currentTask.exec().catch((function(){})).finally((function(){e._processTask()})))}}],[{key:"isFetchSupport",value:function(){return XP.isSupported()}}]),e}(),WR={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT"},YR=function(){function e(t){MO(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]")}return LO(e,[{key:"debug",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).debug.apply(t,[this._prefix].concat(n))}}},{key:"log",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).log.apply(t,[this._prefix].concat(n))}}},{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}},{key:"error",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).error.apply(t,[this._prefix].concat(n))}}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();NO(YR,"disabled",!0);var XR=function(){function e(){MO(this,e),NO(this,"_prevCurrentTime",0)}return LO(e,[{key:"do",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(e){var i=e.currentTime,o=0;if(this._prevCurrentTime===i){var a=uP.info(uP.get(e),i);if(!a.buffers.length)return;r&&a.nextStart||a.nextStart&&a.nextStart-i<t?o=a.nextStart+.1:a.end&&a.end-i>n&&!e.seeking&&(o=i+.1)}this._prevCurrentTime=i,o&&i!==o&&(e.currentTime=o)}}}]),e}(),ZR={exports:{}},qR=v((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),QR=v,JR=te,ex=U,tx=qR,rx=Object.isExtensible,nx=QR((function(){rx(1)}))||tx?function(e){return!!JR(e)&&(!tx||"ArrayBuffer"!=ex(e))&&(!rx||rx(e))}:rx,ix=!v((function(){return Object.isExtensible(Object.preventExtensions({}))})),ox=di,ax=L,sx=wr,ux=te,cx=Ze,lx=Ut.f,dx=cn,fx=XC,hx=nx,px=ix,gx=!1,yx=tt("meta"),vx=0,mx=function(e){lx(e,yx,{value:{objectID:"O"+vx++,weakData:{}}})},_x=ZR.exports={enable:function(){_x.enable=function(){},gx=!0;var e=dx.f,t=ax([].splice),r={};r[yx]=1,e(r).length&&(dx.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===yx){t(n,i,1);break}return n},ox({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:fx.f}))},fastKey:function(e,t){if(!ux(e))return"symbol"==_typeof$3(e)?e:("string"==typeof e?"S":"P")+e;if(!cx(e,yx)){if(!hx(e))return"F";if(!t)return"E";mx(e)}return e[yx].objectID},getWeakData:function(e,t){if(!cx(e,yx)){if(!hx(e))return!0;if(!t)return!1;mx(e)}return e[yx].weakData},onFreeze:function(e){return px&&gx&&hx(e)&&!cx(e,yx)&&mx(e),e}};sx[yx]=!0;var bx=di,Ax=g,Ex=L,Sx=ni,Tx=un,$x=ZR.exports,wx=dc,Cx=Fo,Ix=Q,kx=K,Ox=te,Px=v,Rx=yc,xx=xo,Dx=DE,Lx=Ut.f,Nx=Pl,Mx=yg,Bx=oa,Ux=Fo,jx=K,Fx=dc,Vx=Ih,Gx=Bo,Hx=m,Kx=ZR.exports.fastKey,zx=Hr.set,Wx=Hr.getterFor,Yx={getConstructor:function(e,t,r,n){var i=e((function(e,i){Ux(e,o),zx(e,{type:t,index:Nx(null),first:void 0,last:void 0,size:0}),Hx||(e.size=0),jx(i)||Fx(i,e[n],{that:e,AS_ENTRIES:r})})),o=i.prototype,a=Wx(t),s=function(e,t,r){var n,i,o=a(e),s=u(e,t);return s?s.value=r:(o.last=s={index:i=Kx(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=s),n&&(n.next=s),Hx?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},u=function(e,t){var r,n=a(e),i=Kx(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return Mx(o,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,Hx?e.size=0:this.size=0},delete:function(e){var t=this,r=a(t),n=u(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),Hx?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=a(this),n=Bx(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),Mx(o,r?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),Hx&&Lx(o,"size",{get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=Wx(t),o=Wx(n);Vx(e,t,(function(e,t){zx(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),Gx(t)}};!function(e,t,r){var n=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),o=n?"set":"add",a=Ax[e],s=a&&a.prototype,u=a,c={},l=function(e){var t=Ex(s[e]);Tx(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!Ox(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return i&&!Ox(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!Ox(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(Sx(e,!Ix(a)||!(i||s.forEach&&!Px((function(){(new a).entries().next()})))))u=r.getConstructor(t,e,n,o),$x.enable();else if(Sx(e,!0)){var d=new u,f=d[o](i?{}:-0,1)!=d,h=Px((function(){d.has(1)})),p=Rx((function(e){new a(e)})),g=!i&&Px((function(){for(var e=new a,t=5;t--;)e[o](t,t);return!e.has(-0)}));p||((u=t((function(e,t){Cx(e,s);var r=Dx(new a,e,u);return kx(t)||wx(t,r[o],{that:r,AS_ENTRIES:n}),r}))).prototype=s,s.constructor=u),(h||g)&&(l("delete"),l("has"),n&&l("get")),(g||f)&&l(o),i&&s.clear&&delete s.clear}c[e]=u,bx({global:!0,constructor:!0,forced:u!=a},c),xx(u,e),i||r.setStrong(u,e,n)}("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),Yx);var Xx=function(){function e(t){var r=this;MO(this,e),NO(this,"_seiSet",new Set),this.emitter=t,t.on(WR.SEI,(function(e){e&&r._seiSet.add(e)}))}return LO(e,[{key:"throw",value:function(e){var t=this;if(null!=e&&this._seiSet.size){var r=e-.2,n=e+.2,i=[];this._seiSet.forEach((function(e){e.time>=r&&e.time<=n&&i.push(e)})),i.forEach((function(e){t._seiSet.delete(e),t.emitter.emit(WR.SEI_IN_TIME,e)}))}}},{key:"reset",value:function(){this._seiSet.clear()}}]),e}(),Zx=function(){function e(){MO(this,e),NO(this,"_chunkSpeeds",[]),NO(this,"_speeds",[])}return LO(e,[{key:"addRecord",value:function(e,t){e&&t&&(this._speeds.push(8e3*e/t),this._speeds=this._speeds.slice(-3))}},{key:"addChunkRecord",value:function(e,t){e&&t&&(this._chunkSpeeds.push(8e3*e/t),this._chunkSpeeds=this._chunkSpeeds.slice(-10))}},{key:"getAvgSpeed",value:function(){return this._chunkSpeeds.length||this._speeds.length?this._speeds.length?this._speeds.reduce((function(e,t){return e+t}))/this._speeds.length:this._chunkSpeeds.reduce((function(e,t){return e+t}))/this._chunkSpeeds.length:0}},{key:"getLatestSpeed",value:function(){return this._chunkSpeeds.length||this._speeds.length?this._speeds.length?this._speeds[this._speeds.length-1]:this._chunkSpeeds[this._chunkSpeeds.length-1]:0}},{key:"reset",value:function(){this._chunkSpeeds=[],this._speeds=[]}}]),e}(),qx=di,Qx=fd.find,Jx=Bf,eD="find",tD=!0;eD in[]&&Array(1).find((function(){tD=!1})),qx({target:"Array",proto:!0,forced:tD},{find:function(e){return Qx(this,e,arguments.length>1?arguments[1]:void 0)}}),Jx(eD);var rD={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(rD);var nD=rD.exports,iD=Cn.includes,oD=Bf;di({target:"Array",proto:!0,forced:v((function(){return!Array(1).includes()}))},{includes:function(e){return iD(this,e,arguments.length>1?arguments[1]:void 0)}}),oD("includes");var aD=aC,sD=TypeError,uD=ft("match"),cD=di,lD=function(e){if(aD(e))throw sD("The method doesn't accept regular expressions");return e},dD=Y,fD=Yc,hD=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[uD]=!1,"/./"[e](t)}catch(n){}}return!1},pD=L("".indexOf);cD({target:"String",proto:!0,forced:!hD("includes")},{includes:function(e){return!!~pD(fD(dD(this)),fD(lD(e)),arguments.length>1?arguments[1]:void 0)}});var gD=g.isFinite;di({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&gD(e)}});var yD=L(1..valueOf),vD=m,mD=g,_D=L,bD=ni,AD=un,ED=Ze,SD=DE,TD=ae,$D=Se,wD=bt,CD=v,ID=cn.f,kD=y.f,OD=Ut.f,PD=yD,RD=k_.trim,xD="Number",DD=mD.Number,LD=DD.prototype,ND=mD.TypeError,MD=_D("".slice),BD=_D("".charCodeAt),UD=function(e){var t=wD(e,"number");return"bigint"==typeof t?t:jD(t)},jD=function(e){var t,r,n,i,o,a,s,u,c=wD(e,"number");if($D(c))throw ND("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=RD(c),43===(t=BD(c,0))||45===t){if(88===(r=BD(c,2))||120===r)return NaN}else if(48===t){switch(BD(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(a=(o=MD(c,2)).length,s=0;s<a;s++)if((u=BD(o,s))<48||u>i)return NaN;return parseInt(o,n)}return+c};if(bD(xD,!DD(" 0o1")||!DD("0b1")||DD("+0x1"))){for(var FD,VD=function e(t){var r=arguments.length<1?0:DD(UD(t)),n=this;return TD(LD,n)&&CD((function(){PD(n)}))?SD(Object(r),n,e):r},GD=vD?ID(DD):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),HD=0;GD.length>HD;HD++)ED(DD,FD=GD[HD])&&!ED(VD,FD)&&OD(VD,FD,kD(DD,FD));VD.prototype=LD,LD.constructor=VD,AD(mD,xD,VD,{constructor:!0})}var KD="video",zD="audio",WD="metadata",YD="avc",XD="hevc",ZD="aac",qD="g7110a",QD="g7110m",JD="LARGE_AV_SHIFT",eL="LARGE_VIDEO_GAP",tL="LARGE_VIDEO_GAP_BETWEEN_CHUNK",rL="LARGE_AUDIO_GAP",nL="AUDIO_FILLED",iL="AUDIO_DROPPED",oL="undefined"!=typeof window,aL=oL&&navigator.userAgent.toLocaleLowerCase(),sL=oL&&/^((?!chrome|android).)*safari/.test(aL),uL=oL&&aL.includes("firefox"),cL=oL&&aL.includes("android"),lL=function(){function e(){MO(this,e)}return LO(e,null,[{key:"getRateIndexByRate",value:function(t){return e.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,r){for(var n=t.length,i=0;i+2<n&&(255!==t[i]||240!=(246&t[i+1]));)i++;if(!(i>=n)){var o=i,a=[],s=(60&t[i+2])>>>2,u=e.FREQ[s];if(!u)throw new Error("Invalid sampling index: ".concat(s));for(var c,l,d=1+((192&t[i+2])>>>6),f=(1&t[i+2])<<2|(192&t[i+3])>>>6,h=e._getConfig(s,f,d),p=h.config,g=h.codec,y=0,v=e.getFrameDuration(u);i+7<n;)if(255===t[i]&&240==(246&t[i+1])){if(n-i<(l=(3&t[i+3])<<11|t[i+4]<<3|(224&t[i+5])>>5))break;c=2*(1&~t[i+1]),a.push({pts:r+y*v,data:t.subarray(i+7+c,i+l)}),y++,i+=l}else i++;return{skip:o,remaining:i>=n?void 0:t.subarray(i),frames:a,samplingFrequencyIndex:s,sampleRate:u,objectType:d,channelCount:f,codec:g,config:p,originCodec:"mp4a.40.".concat(d)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var r=t[0]>>>3,n=(7&t[0])<<1|t[1]>>>7,i=(120&t[1])>>>3,o=e.FREQ[n];if(!o)throw new Error("Invalid sampling index: ".concat(n));var a=e._getConfig(n,i,r);return{samplingFrequencyIndex:n,sampleRate:o,objectType:r,channelCount:i,config:a.config,codec:a.codec,originCodec:"mp4a.40.".concat(r)}}}},{key:"getFrameDuration",value:function(e){return 1024*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4)/e}},{key:"_getConfig",value:function(e,t,r){var n,i,o=[];return uL?e>=6?(n=5,i=e-3):(n=2,i=e):cL?(n=2,i=e):(n=2===r||5===r?r:5,i=e,e>=6?i=e-3:1===t&&(n=2,i=e)),o[0]=n<<3,o[0]|=(14&e)>>1,o[1]=(1&e)<<7,o[1]|=t<<3,5===n&&(o[1]|=(14&i)>>1,o[2]=(1&i)<<7,o[2]|=8,o[3]=0),{config:o,codec:"mp4a.40.".concat(n)}}},{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}();NO(lL,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var dL=function e(t,r,n){MO(this,e),NO(this,"duration",1024),NO(this,"flag",{dependsOn:2,isNonSyncSample:0}),this.originPts=this.pts=this.dts=t,this.data=r,this.size=r.byteLength,n&&(this.duration=n)};function fL(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t.filter(Boolean);var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),i=0;return t.forEach((function(e){n.set(e,i),i+=e.byteLength})),n}var hL=Math.pow(2,32);function pL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<8)+(e[t+1]||0)}function gL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]||0)}function yL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return gL(e,t)*hL+gL(e,t+4)}function vL(e){for(var t,r="avc1.",n=0;n<3;n++)(t=e[n].toString(16)).length<2&&(t="0".concat(t)),r+=t;return r}var mL=function(){function e(t){MO(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]")}return LO(e,[{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();NO(mL,"disabled",!0);var _L=function(){function e(){MO(this,e)}return LO(e,null,[{key:"parseAnnexB",value:function(e){for(var t=e.length,r=2,n=0;null!=e[r]&&1!==e[r];)r++;if((n=2+ ++r)>=t)return[];for(var i=[];n<t;)switch(e[n]){case 0:if(0!==e[n-1]){n+=2;break}if(0!==e[n-2]){n++;break}r!==n-2&&i.push(e.subarray(r,n-2));do{n++}while(1!==e[n]&&n<t);n=(r=n+1)+2;break;case 1:if(0!==e[n-1]||0!==e[n-2]){n+=3;break}r!==n-2&&i.push(e.subarray(r,n-2)),n=(r=n+1)+2;break;default:n+=3}return r<t&&i.push(e.subarray(r)),i}},{key:"parseAvcC",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!(e.length<4)){for(var r,n=e.length,i=[],o=0;o+t<n;)if(r=gL(e,o),3===t&&(r>>>=8),o+=t,r){if(o+r>n)break;i.push(e.subarray(o,o+r)),o+=r}return i}}},{key:"parseSEI",value:function(e){for(var t=e.length,r=1,n=0,i=0,o="";255===e[r];)n+=255,r++;for(n+=e[r++];255===e[r];)i+=255,r++;if(i+=e[r++],5===n&&t>r+16)for(var a=0;a<16;a++)o+=e[r].toString(16),r++;return{payload:e.subarray(r),type:n,size:i,uuid:o}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(!r.length)return e;var i=t-r.length,o=new Uint8Array(i),a=0;for(n=0;n<i;a++,n++)a===r[0]&&(a++,r.shift()),o[n]=e[a];return o}}]),e}(),bL=function(){function e(t){if(MO(this,e),NO(this,"_bytesAvailable",void 0),NO(this,"_bitsAvailable",0),NO(this,"_word",0),!t)throw new Error("ExpGolomb data params is required");this._data=t,this._bytesAvailable=t.byteLength,this._bytesAvailable&&this._loadWord()}return LO(e,[{key:"_loadWord",value:function(){var e=this._data.byteLength-this._bytesAvailable,t=Math.min(4,this._bytesAvailable);if(0===t)throw new Error("No bytes available");var r=new Uint8Array(4);r.set(this._data.subarray(e,e+t)),this._word=new DataView(r.buffer).getUint32(0),this._bitsAvailable=8*t,this._bytesAvailable-=t}},{key:"skipBits",value:function(e){if(this._bitsAvailable>e)this._word<<=e,this._bitsAvailable-=e;else{e-=this._bitsAvailable;var t=Math.floor(e/8);e-=8*t,this._bytesAvailable-=t,this._loadWord(),this._word<<=e,this._bitsAvailable-=e}}},{key:"readBits",value:function(e){if(e>32)throw new Error("Cannot read more than 32 bits");var t=Math.min(this._bitsAvailable,e),r=this._word>>>32-t;return this._bitsAvailable-=t,this._bitsAvailable>0?this._word<<=t:this._bytesAvailable>0&&this._loadWord(),(t=e-t)>0&&this._bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this._bitsAvailable;++e)if(0!=(this._word&2147483648>>>e))return this._word<<=e,this._bitsAvailable-=e,e;return this._loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r}}]),e}(),AL=function(){function e(){MO(this,e)}return LO(e,null,[{key:"parseHEVCDecoderConfigurationRecord",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t.length<23)){r=r||{};for(var n,i,o,a,s,u=1+(3&t[21]),c=[],l=[],d=[],f=23,h=t[22],p=0;p<h;p++){o=63&t[f],a=t[f+1]<<8|t[f+2],f+=3;for(var g=0;g<a;g++)if(s=t[f]<<8|t[f+1],f+=2,s){switch(o){case 32:var y=t.subarray(f,f+s);n||(n=e.parseVPS(_L.removeEPB(y),r)),d.push(y);break;case 33:var v=t.subarray(f,f+s);i||(i=e.parseSPS(_L.removeEPB(v),r)),c.push(v);break;case 34:l.push(t.subarray(f,f+s))}f+=s}}return{hvcC:r,sps:i,spsArr:c,ppsArr:l,vpsArr:d,nalUnitSize:u}}}},{key:"parseVPS",value:function(t,r){r=r||{};var n=new bL(t);n.readUByte(),n.readUByte(),n.readBits(12);var i=n.readBits(3);return r.numTemporalLayers=Math.max(r.numTemporalLayers||0,i+1),n.readBits(17),e._parseProfileTierLevel(n,i,r),r}},{key:"parseSPS",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=r||{};var n=new bL(t);n.readUByte(),n.readUByte(),n.readBits(4);var i=n.readBits(3);r.numTemporalLayers=Math.max(i+1,r.numTemporalLayers||0),r.temporalIdNested=n.readBits(1),e._parseProfileTierLevel(n,i,r),n.readUEG();var o=r.chromaFormatIdc=n.readUEG(),a=420;o<=3&&(a=[0,420,422,444][o]);var s=0;3===o&&(s=n.readBits(1));var u,c,l,d,f=n.readUEG(),h=n.readUEG(),p=n.readBits(1);return 1===p&&(u=n.readUEG(),c=n.readUEG(),l=n.readUEG(),d=n.readUEG()),r.bitDepthLumaMinus8=n.readUEG(),r.bitDepthChromaMinus8=n.readUEG(),1===p&&(f-=(1!==o&&2!==o||0!==s?1:2)*(c+u),h-=(1===o&&0===s?2:1)*(d+l)),{codec:"hev1.1.6.L93.B0",width:f,height:h,chromaFormat:a,hvcC:r}}},{key:"_parseProfileTierLevel",value:function(e,t,r){var n=r.generalTierFlag||0;r.generalProfileSpace=e.readBits(2),r.generalTierFlag=Math.max(e.readBits(1),n),r.generalProfileIdc=Math.max(e.readBits(5),r.generalProfileIdc||0),r.generalProfileCompatibilityFlags=e.readBits(32),r.generalConstraintIndicatorFlags=[e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8)];var i=e.readBits(8);n<r.generalTierFlag?r.generalLevelIdc=i:r.generalLevelIdc=Math.max(i,r.generalLevelIdc||0);for(var o=[],a=[],s=0;s<t;s++)o[s]=e.readBits(1),a[s]=e.readBits(1);t>0&&e.readBits(2*(8-t));for(var u=0;u<t;u++)0!==o[u]&&(e.readBits(2),e.readBits(1),e.readBits(5),e.readBits(16),e.readBits(16),e.readBits(4),e.readBits(16),e.readBits(16),e.readBits(12)),0!==a[u]&&e.readBits(8)}}]),e}(),EL=function(){function e(){MO(this,e)}return LO(e,null,[{key:"parseAVCDecoderConfigurationRecord",value:function(t){if(!(t.length<7)){for(var r,n,i=1+(3&t[4]),o=[],a=[],s=6,u=31&t[5],c=0;c<u;c++)if(n=t[s]<<8|t[s+1],s+=2,n){var l=t.subarray(s,s+n);s+=n,o.push(l),r||(r=e.parseSPS(_L.removeEPB(l)))}var d,f=t[s];s++;for(var h=0;h<f;h++)d=t[s]<<8|t[s+1],s+=2,d&&(a.push(t.subarray(s,s+d)),s+=d);return{sps:r,spsArr:o,ppsArr:a,nalUnitSize:i}}}},{key:"parseSPS",value:function(e){var t=new bL(e);t.readUByte();var r=t.readUByte(),n=t.readUByte(),i=t.readUByte();t.skipUEG();var o=420;if(100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||144===r){var a=t.readUEG();if(a<=3&&(o=[0,420,422,444][a]),3===a&&t.skipBits(1),t.skipUEG(),t.skipUEG(),t.skipBits(1),t.readBool())for(var s=3!==a?8:12,u=0;u<s;u++)t.readBool()&&(u<6?t.skipScalingList(16):t.skipScalingList(64))}t.skipUEG();var c=t.readUEG();if(0===c)t.readUEG();else if(1===c){t.skipBits(1),t.skipUEG(),t.skipUEG();for(var l=t.readUEG(),d=0;d<l;d++)t.skipUEG()}t.skipUEG(),t.skipBits(1);var f=t.readUEG(),h=t.readUEG(),p=t.readBits(1);0===p&&t.skipBits(1),t.skipBits(1);var g,y,v,m,_,b=0,A=0,E=0,S=0;if(t.readBool()&&(b=t.readUEG(),A=t.readUEG(),E=t.readUEG(),S=t.readUEG()),t.readBool()){if(t.readBool())switch(t.readUByte()){case 1:g=[1,1];break;case 2:g=[12,11];break;case 3:g=[10,11];break;case 4:g=[16,11];break;case 5:g=[40,33];break;case 6:g=[24,11];break;case 7:g=[20,11];break;case 8:g=[32,11];break;case 9:g=[80,33];break;case 10:g=[18,11];break;case 11:g=[15,11];break;case 12:g=[64,33];break;case 13:g=[160,99];break;case 14:g=[4,3];break;case 15:g=[3,2];break;case 16:g=[2,1];break;case 255:g=[t.readUByte()<<8|t.readUByte(),t.readUByte()<<8|t.readUByte()]}if(t.readBool()&&t.readBool(),t.readBool()&&(t.readBits(4),t.readBool()&&t.readBits(24)),t.readBool()&&(t.readUEG(),t.readUEG()),t.readBool()){var T=t.readBits(32),$=t.readBits(32);y=t.readBool(),_=(v=$)/(m=2*T)}}return{codec:vL(e.subarray(1,4)),profileIdc:r,profileCompatibility:n,levelIdc:i,chromaFormat:o,width:Math.ceil(16*(f+1)-2*(b+A)),height:(2-p)*(h+1)*16-(p?2:4)*(E+S),sarRatio:g,fpsNum:v,fpsDen:m,fps:_,fixedFrame:y}}}]),e}(),SL=function(){function e(t,r,n){MO(this,e),NO(this,"flag",{}),NO(this,"keyframe",!1),NO(this,"gopId",0),NO(this,"duration",0),NO(this,"size",0),NO(this,"units",[]),NO(this,"chromaFormat",420),this.originPts=this.pts=t,this.originDts=this.dts=r,n&&(this.units=n)}return LO(e,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),e}();function TL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=GO(e);if(t){var i=GO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return VO(this,r)}}var $L=function(e){UO(r,e);var t=TL(r);function r(){return MO(this,r),t.apply(this,arguments)}return r}((function e(t,r){MO(this,e),NO(this,"time",0),this.data=t,this.originPts=this.pts=r})),wL=function(){function e(){MO(this,e),NO(this,"id",3),NO(this,"type",WD),NO(this,"timescale",0),NO(this,"flvScriptSamples",[]),NO(this,"seiSamples",[])}return LO(e,[{key:"exist",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length||!this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length)}}]),e}(),CL=function(){function e(){MO(this,e),NO(this,"id",1),NO(this,"type",KD),NO(this,"codecType",YD),NO(this,"pid",-1),NO(this,"hvcC",void 0),NO(this,"codec",""),NO(this,"timescale",0),NO(this,"formatTimescale",0),NO(this,"sequenceNumber",0),NO(this,"baseMediaDecodeTime",0),NO(this,"baseDts",0),NO(this,"duration",0),NO(this,"warnings",[]),NO(this,"samples",[]),NO(this,"pps",[]),NO(this,"sps",[]),NO(this,"vps",[]),NO(this,"fpsNum",0),NO(this,"fpsDen",0),NO(this,"sarRatio",[]),NO(this,"width",0),NO(this,"height",0),NO(this,"nalUnitSize",4),NO(this,"present",!1),NO(this,"ext",void 0)}return LO(e,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"exist",value:function(){return!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}}]),e}(),IL=function(){function e(){MO(this,e),NO(this,"id",2),NO(this,"type",zD),NO(this,"codecType",ZD),NO(this,"pid",-1),NO(this,"codec",""),NO(this,"sequenceNumber",0),NO(this,"sampleDuration",0),NO(this,"timescale",0),NO(this,"formatTimescale",0),NO(this,"baseMediaDecodeTime",0),NO(this,"duration",0),NO(this,"warnings",[]),NO(this,"samples",[]),NO(this,"baseDts",0),NO(this,"sampleSize",16),NO(this,"sampleRate",0),NO(this,"channelCount",0),NO(this,"objectType",0),NO(this,"sampleRateIndex",0),NO(this,"config",[]),NO(this,"present",!1),NO(this,"ext",void 0)}return LO(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===ZD)}},{key:"hasSample",value:function(){return!!this.samples.length}}]),e}();function kL(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OL(e,t){if(e){if("string"==typeof e)return kL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kL(e,t):void 0}}function PL(e){return function(e){if(Array.isArray(e))return kL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||OL(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var RL=9e4,xL=45e4,DL=9e4,LL=function(){function e(t,r,n){MO(this,e),this.videoTrack=t,this.audioTrack=r,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=!1,this._videoTimestampBreak=!1,this._lastAudioExceptionGapDot=0,this._lastAudioExceptionOverlapDot=0,this._lastAudioExceptionLargeGapDot=0}return LO(e,[{key:"fix",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Math.round(9e4*t);var i=this.videoTrack,o=this.audioTrack,a=i.samples,s=o.samples;if(a.length||s.length){var u=a[0],c=s[0],l=0;if(a.length&&s.length&&(l=u.dts-c.pts),this._baseDtsInited||this._calculateBaseDts(this.audioTrack,this.videoTrack),r&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=t),!n){this._videoNextDts=l>0?t+l:t,this._audioNextPts=l>0?t:t-l;var d=u?u.dts-this._baseDts-this._videoNextDts:0,f=c?c.pts-this._baseDts-this._audioNextPts:0;Math.abs(d||f)>DL&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=t)}if(this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(o),this._fixVideo(i),this.metadataTrack.exist()){var h=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/h}))}i.samples.length&&(i.baseMediaDecodeTime=i.samples[0].dts),o.samples.length&&(o.baseMediaDecodeTime=o.samples[0].pts*o.timescale/9e4)}}},{key:"_fixVideo",value:function(e){var t=this,r=e.samples;if(r.length){if(r.forEach((function(e){e.dts-=t._baseDts,e.pts-=t._baseDts})),void 0===this._videoNextDts){var n=r[0];this._videoNextDts=n.dts}var i,o,a=r.length,s=0,u=r[0],c=r[1],l=this._videoNextDts-u.dts;if(Math.abs(l)>45e3&&(u.dts+=l,u.pts+=l,this._videoNextDts-=l,e.warnings.push({type:tL,nextDts:this._videoNextDts,firstSampleDts:u.dts,nextSampleDts:null===(i=r[1])||void 0===i?void 0:i.dts,sampleDuration:l}),c&&Math.abs(c.dts-u.dts)>DL&&(this._videoTimestampBreak=!0,r.forEach((function(e,t){0!==t&&(e.dts+=l,e.pts+=l)})))),e.fpsNum&&e.fpsDen)o=e.timescale*(e.fpsDen/e.fpsNum);else{var d=e.samples[0],f=e.samples[a-1];o=1===a?9e3:Math.floor((f.dts-d.dts)/(a-1))}for(var h=0;h<a;h++){var p=r[h].dts,g=r[h+1];if((s=h<a-1?g.dts-p:r[h-1]?p-r[h-1].dts:o)>DL||s<0){this._videoTimestampBreak=!0,s=this._audioTimestampBreak?o:s;var y=this._audioNextPts||0;g&&g.dts>y&&(s=o),e.warnings.push({type:eL,time:p/e.timescale,dts:p,originDts:r[h].originDts,nextDts:this._videoNextDts,sampleDuration:s,refSampleDuration:o})}r[h].duration=s,this._videoNextDts+=s}}}},{key:"_fixAudio",value:function(e){var t=this,r=e.samples;r.length&&(r.forEach((function(e){e.pts-=t._baseDts,e.dts=e.pts})),this._doFixAudioInternal(e,r,9e4))}},{key:"_calculateBaseDts",value:function(e,t){var r=e.samples,n=t.samples;if(!r.length&&!n.length)return!1;var i=1/0,o=1/0;r.length&&(e.baseDts=i=r[0].pts),n.length&&(t.baseDts=o=n[0].dts),this._baseDts=Math.min(i,o);var a=o-i;return Number.isFinite(a)&&Math.abs(a)>45e3&&t.warnings.push({type:JD,videoBaseDts:o,audioBasePts:i,baseDts:this._baseDts,delta:a}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){if(this._baseDtsInited&&this._videoTimestampBreak&&this._audioTimestampBreak){if(!this._calculateBaseDts(this.audioTrack,this.videoTrack))return;this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts),this._audioLastSample=null,this._videoLastSample=null,this._videoTimestampBreak=!1,this._audioTimestampBreak=!1}}},{key:"_doFixAudioInternal",value:function(e,t,r){e.sampleDuration||(e.sampleDuration=lL.getFrameDuration(e.timescale,r));var n=e.sampleDuration;if(void 0===this._audioNextPts){var i=t[0];this._audioNextPts=i.pts}for(var o=0;o<t.length;o++){var a=this._audioNextPts,s=t[o],u=s.pts-a;if(!this._audioTimestampBreak&&u>=3*n&&u<=RL&&!sL){var c=lL.getSilentFrame(e.codec,e.channelCount)||t[0].data.subarray(),l=Math.floor(u/n);Math.abs(s.pts-this._lastAudioExceptionGapDot)>xL&&(this._lastAudioExceptionGapDot=s.pts),e.warnings.push({type:nL,pts:s.pts,originPts:s.originPts,count:l,nextPts:a,refSampleDuration:n});for(var d=0;d<l;d++){var f=new dL(Math.floor(a),c);f.originPts=Math.floor(this._baseDts+a),t.splice(o,0,f),this._audioNextPts+=n,o++}o--}else u<=-3*n&&u>=-9e4?(Math.abs(s.pts-this._lastAudioExceptionOverlapDot)>xL&&(this._lastAudioExceptionOverlapDot=s.pts,e.warnings.push({type:iL,pts:s.pts,originPts:s.originPts,nextPts:a,refSampleDuration:n})),t.splice(o,1),o--):(Math.abs(u)>=RL&&(this._audioTimestampBreak=!0,Math.abs(s.pts-this._lastAudioExceptionLargeGapDot)>xL&&(this._lastAudioExceptionLargeGapDot=s.pts,e.warnings.push({type:rL,time:s.pts/1e3,pts:s.pts,originPts:s.originPts,nextPts:a,sampleDuration:u,refSampleDuration:n}))),s.dts=s.pts=a,this._audioNextPts+=n)}}}]),e}(),NL=new mL("TsDemuxer"),ML=function(){function e(t,r,n){MO(this,e),NO(this,"_pmtId",-1),NO(this,"_remainingPacketData",null),NO(this,"_videoPesData",[]),NO(this,"_audioPesData",[]),NO(this,"_gopId",0),this.videoTrack=t||new CL,this.audioTrack=r||new IL,this.metadataTrack=n||new wL,this._fixer=new LL(this.videoTrack,this.audioTrack,this.metadataTrack)}return LO(e,[{key:"demux",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.audioTrack,i=this.videoTrack,o=this.metadataTrack;t&&(this._pmtId=-1,i.reset(),n.reset(),o.reset()),!r||t?(this._remainingPacketData=null,this._videoPesData=[],this._audioPesData=[]):(i.samples=[],n.samples=[],o.seiSamples=[],i.warnings=[],n.warnings=[],this._remainingPacketData&&(e=fL(this._remainingPacketData,e),this._remainingPacketData=null));var a=e.length,s=a%188;s&&(this._remainingPacketData=e.subarray(a-s),a-=s);for(var u=i.pid,c=n.pid,l=0;l<a;l+=188){if(71!==e[l])throw new Error("TS packet did not start with 0x47");var d=!!(64&e[l+1]),f=((31&e[l+1])<<8)+e[l+2],h=void 0;if((48&e[l+3])>>4>1){if((h=l+5+e[l+4])===l+188)continue}else h=l+4;switch(f){case 0:d&&(h+=e[h]+1),this._pmtId=(31&e[h+10])<<8|e[h+11];break;case this._pmtId:d&&(h+=e[h]+1);var p=h+3+((15&e[h+1])<<8|e[h+2])-4;for(h+=12+((15&e[h+10])<<8|e[h+11]);h<p;){var g=(31&e[h+1])<<8|e[h+2];switch(e[h]){case 15:n.pid=c=g;break;case 27:if(-1!==u)break;i.codecType=YD,i.pid=u=g;break;case 36:if(-1!==u)break;i.codecType=XD,i.pid=u=g;break;default:NL.warn("Unsupported stream. type: ".concat(e[h],", pid: ").concat(g))}h+=5+((15&e[h+3])<<8|e[h+4])}break;case u:d&&this._videoPesData.length&&this._parseVideoData(),this._videoPesData.push(e.subarray(h,l+188));break;case c:d&&this._audioPesData.length&&this._parseAudioData(),this._audioPesData.push(e.subarray(h,l+188));break;case 17:case 8191:break;default:NL.warn("Unknown pid: ".concat(f))}}return this._parseVideoData(),this._parseAudioData(),n.formatTimescale=i.formatTimescale=i.timescale=o.timescale=9e4,n.timescale=n.sampleRate||0,{videoTrack:i,audioTrack:n,metadataTrack:o}}},{key:"fix",value:function(e,t,r){return this._fixer.fix(e,t,r),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(e,t,r,n){return this.demux(e,t,r),this.fix(n,t,r)}},{key:"_parseVideoData",value:function(){if(this._videoPesData.length){var t=e._parsePES(fL.apply(void 0,PL(this._videoPesData)));if(t){var r=_L.parseAnnexB(t.data);r?this._createVideoSample(r,t.pts,t.dts):NL.warn("Cannot parse avc units",t),this._videoPesData=[]}else NL.warn("Cannot parse video pes",this._videoPesData)}}},{key:"_createVideoSample",value:function(e,t,r){var n=this;if(e.length){var i=this.videoTrack,o=i.codecType===XD,a=new SL(t,r);e.forEach((function(e){var s=o?e[0]>>>1&63:31&e[0];switch(s){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!o&&5!==s||o&&5===s)break;a.setToKeyframe(),n._gopId++;break;case 6:case 39:case 40:if(!o&&6!==s||o&&6===s)break;return void n.metadataTrack.seiSamples.push(new $L(_L.parseSEI(_L.removeEPB(e)),t));case 32:if(!o)break;if(!i.vps.length){var u=AL.parseVPS(_L.removeEPB(e),i.hvcC);i.hvcC=i.hvcC||u,i.vps=[e]}break;case 7:case 33:if(!o&&7!==s||o&&7===s)break;if(!i.sps.length){var c=_L.removeEPB(e),l=o?AL.parseSPS(c,i.hvcC):EL.parseSPS(c);i.sps=[e],i.hvcC=i.hvcC||l.hvcC,i.codec=l.codec,i.width=l.width,i.height=l.height,i.sarRatio=l.sarRatio,i.fpsNum=l.fpsNum,i.fpsDen=l.fpsDen}break;case 8:case 34:if(!o&&8!==s||o&&8===s)break;i.pps.length||(i.pps=[e]);break;case 9:case 35:if(!o&&9!==s||o&&9===s)break;a.gopId=n._gopId,a.units.length&&(n._pushVideoSample(i,a),a=n.prevAvcSample=new SL(t,r))}a.units.push(e)})),a.gopId=this._gopId,this._pushVideoSample(i,a)}}},{key:"_pushVideoSample",value:function(e,t){if(t.units.length){if(null==t.pts){NL.warn("Video sample no pts",t);var r=e.samples[e.samples.length-1];r?(t.pts=r.pts,t.dts=r.dts):NL.warn("Drop video sample",t)}null!=t.pts&&e.samples.push(t)}}},{key:"_parseAudioData",value:function(){if(this._audioPesData.length){var t=e._parsePES(fL.apply(void 0,PL(this._audioPesData)));t?(this._parseAacData(t),this._audioPesData=[]):NL.warn("Cannot parse audio pes",this._audioPesData)}}},{key:"_parseAacData",value:function(e){var t=this.audioTrack,r=e.pts;if(null==r){if(NL.warn("AAC pes not pts",t),!t.samples.length||!t.sampleRate)return;r=t.samples[t.samples.length-1].pts+lL.getFrameDuration(t.sampleRate)}var n,i=lL.parseADTS(e.data,r);i?(t.codec=i.codec,t.channelCount=i.channelCount,t.sampleRate=i.sampleRate,t.objectType=i.objectType,t.sampleRateIndex=i.samplingFrequencyIndex,t.config=i.config,(n=t.samples).push.apply(n,PL(i.frames.map((function(e){return new dL(e.pts,e.data)})))),i.skip&&NL.warn("Skip aac adts ".concat(i.skip," bits")),i.remaining&&NL.warn("Remaining aac adts ".concat(i.remaining," bits"))):NL.warn("Cannot parse aac adts",e)}}],[{key:"probe",value:function(e){return!!e.length&&71===e[0]&&71===e[188]&&71===e[376]}},{key:"_parsePES",value:function(e){var t=e[8];if(!(null==t||e.length<t+9)&&1==(e[0]<<16|e[1]<<8|e[2])){var r=(e[4]<<8)+e[5];if(!(r&&r>e.length-6)){var n,i,o=e[7];return 192&o&&(n=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&o?n-(i=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>54e5&&(n=i):i=n),{data:e.subarray(9+t),pts:n,dts:i}}}}}]),e}(),BL=L,UL=bn,jL=Yc,FL=Y,VL=BL(Jc),GL=BL("".slice),HL=Math.ceil,KL=function(e){return function(t,r,n){var i,o,a=jL(FL(t)),s=UL(r),u=a.length,c=void 0===n?" ":jL(n);return s<=u||""==c?a:((o=VL(c,HL((i=s-u)/c.length))).length>i&&(o=GL(o,0,i)),e?a+o:o+a)}},zL={start:KL(!1),end:KL(!0)},WL=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(se),YL=zL.start;di({target:"String",proto:!0,forced:WL},{padStart:function(e){return YL(this,e,arguments.length>1?arguments[1]:void 0)}});var XL=m,ZL=Sp,qL=tl,QL=v,JL=g.RegExp,eN=JL.prototype;XL&&QL((function(){var e=!0;try{JL(".","d")}catch(EU){e=!1}var t={},r="",n=e?"dgimsy":"gimsy",i=function(e,n){Object.defineProperty(t,e,{get:function(){return r+=n,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(eN,"flags").get.call(t)!==n||r!==n}))&&ZL(eN,"flags",{configurable:!0,get:qL});var tN=function(){function e(){MO(this,e)}return LO(e,null,[{key:"findBox",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if(!t)return i;for(var o=0,a="",s=0;t.length>7;){if(o=gL(t),a=String.fromCharCode.apply(null,t.subarray(4,8)),s=8,1===o?(o=yL(t,8),s+=8):o||(o=t.length),!r[0]||a===r[0]){var u=t.subarray(0,o);if(!(r.length<2))return e.findBox(u.subarray(s),r.slice(1),n+s);i.push({start:n,size:o,headerSize:s,type:a,data:u})}n+=o,t=t.subarray(o)}return i}},{key:"moov",value:function(t){return oN(t,!1,(function(t,r,n){t.mvhd=e.mvhd(e.findBox(r,["mvhd"],n)[0]),t.trak=e.findBox(r,["trak"],n).map((function(t){return e.trak(t)}))}))}},{key:"mvhd",value:function(e){return oN(e,!0,(function(e,t){var r=0;1===e.version?(e.timescale=gL(t,16),e.duration=yL(t,20),r+=28):(e.timescale=gL(t,8),e.duration=gL(t,12),r+=16),e.nextTrackId=gL(t,r+76)}))}},{key:"trak",value:function(t){return oN(t,!1,(function(t,r,n){t.tkhd=e.tkhd(e.findBox(r,["tkhd"],n)[0]),t.mdia=e.mdia(e.findBox(r,["mdia"],n)[0])}))}},{key:"tkhd",value:function(e){return oN(e,!0,(function(e,t){var r=0;1===e.version?(e.trackId=gL(t,16),e.duration=yL(t,24),r+=32):(e.trackId=gL(t,8),e.duration=gL(t,16),r+=20),e.width=gL(t,r+52),e.height=gL(t,r+56)}))}},{key:"mdia",value:function(t){return oN(t,!1,(function(t,r,n){t.mdhd=e.mdhd(e.findBox(r,["mdhd"],n)[0]),t.hdlr=e.hdlr(e.findBox(r,["hdlr"],n)[0]),t.minf=e.minf(e.findBox(r,["minf"],n)[0])}))}},{key:"mdhd",value:function(e){return oN(e,!0,(function(e,t){var r=0;1===e.version?(e.timescale=gL(t,16),e.duration=yL(t,20),r+=28):(e.timescale=gL(t,8),e.duration=gL(t,12),r+=16);var n=pL(t,r);e.language=String.fromCharCode(96+(n>>10&31),96+(n>>5&31),96+(31&n))}))}},{key:"hdlr",value:function(e){return oN(e,!0,(function(e,t){0===e.version&&(e.handlerType=String.fromCharCode.apply(null,t.subarray(4,8)))}))}},{key:"minf",value:function(t){return oN(t,!1,(function(t,r,n){t.vmhd=e.vmhd(e.findBox(r,["vmhd"],n)[0]),t.smhd=e.smhd(e.findBox(r,["smhd"],n)[0]),t.stbl=e.stbl(e.findBox(r,["stbl"],n)[0])}))}},{key:"vmhd",value:function(e){return oN(e,!0,(function(e,t){e.graphicsmode=pL(t),e.opcolor=[pL(t,2),pL(t,4),pL(t,6)]}))}},{key:"smhd",value:function(e){return oN(e,!0,(function(e,t){e.balance=pL(t)}))}},{key:"stbl",value:function(t){return oN(t,!1,(function(t,r,n){t.stsd=e.stsd(e.findBox(r,["stsd"],n)[0]),t.stts=e.stts(e.findBox(r,["stts"],n)[0]),t.ctts=e.ctts(e.findBox(r,["ctts"],n)[0]),t.stsc=e.stsc(e.findBox(r,["stsc"],n)[0]),t.stsz=e.stsz(e.findBox(r,["stsz"],n)[0]),t.stco=e.stco(e.findBox(r,["stco"],n)[0]),t.stss=e.stss(e.findBox(r,["stss"],n)[0])}))}},{key:"stsd",value:function(t){return oN(t,!0,(function(t,r,n){t.entryCount=gL(r),t.entries=e.findBox(r.subarray(4),[],n+4).map((function(t){switch(t.type){case"avc1":case"avc2":case"avc3":case"avc4":return e.avc1(t);case"hvc1":case"hev1":return e.hvc1(t);case"mp4a":return e.mp4a(t);case"alaw":case"ulaw":return e.alaw(t)}})).filter(Boolean)}))}},{key:"avc1",value:function(t){return oN(t,!1,(function(t,r,n){var i=nN(t,r),o=r.subarray(i);n+=i,t.avcC=e.avcC(e.findBox(o,["avcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])}))}},{key:"avcC",value:function(e){return oN(e,!1,(function(e,t){e.configurationVersion=t[0],e.AVCProfileIndication=t[1],e.profileCompatibility=t[2],e.AVCLevelIndication=t[3],e.codec=vL([t[1],t[2],t[3]]),e.lengthSizeMinusOne=3&t[4],e.spsLength=31&t[5],e.sps=[];for(var r=6,n=0;n<e.spsLength;n++){var i=pL(t,r);r+=2,e.sps.push(t.subarray(r,r+i)),r+=i}e.ppsLength=t[r],r+=1,e.pps=[];for(var o=0;o<e.ppsLength;o++){var a=pL(t,r);r+=2,e.pps.push(t.subarray(r,r+=a)),r+=a}}))}},{key:"hvc1",value:function(t){return oN(t,!1,(function(t,r,n){var i=nN(t,r),o=r.subarray(i);n+=i,t.hvcC=e.hvcC(e.findBox(o,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])}))}},{key:"hvcC",value:function(e){return oN(e,!1,(function(t,r){t.data=e.data,t.codec="hev1.1.6.L93.B0",t.configurationVersion=r[0];var n=r[1];t.generalProfileSpace=n>>6,t.generalTierFlag=(32&n)>>5,t.generalProfileIdc=31&n,t.generalProfileCompatibility=gL(r,2),t.generalConstraintIndicatorFlags=r.subarray(6,12),t.generalLevelIdc=r[12],t.avgFrameRate=pL(r,19),t.numOfArrays=r[22],t.vps=[],t.sps=[],t.pps=[];for(var i=23,o=0,a=0,s=0,u=0;u<t.numOfArrays;u++){o=63&r[i],a=pL(r,i+1),i+=3;for(var c,l=[],d=0;d<a;d++)s=pL(r,i),i+=2,l.push(r.subarray(i,i+s)),i+=s;if(32===o)(c=t.vps).push.apply(c,l);else if(33===o){var f;(f=t.sps).push.apply(f,l)}else if(34===o){var h;(h=t.pps).push.apply(h,l)}}}))}},{key:"pasp",value:function(e){return oN(e,!1,(function(e,t){e.hSpacing=gL(t),e.vSpacing=gL(t,4)}))}},{key:"mp4a",value:function(t){return oN(t,!1,(function(t,r,n){var i=iN(t,r);t.esds=e.esds(e.findBox(r.subarray(i),["esds"],n+i)[0])}))}},{key:"esds",value:function(e){return oN(e,!0,(function(e,t){e.codec="mp4a.";for(var r=0,n=0,i=0,o=0;t.length;){for(o=t[r=0],n=t[r+1],r+=2;128&n;)i=(127&n)<<7,n=t[r],r+=1;if(i+=127&n,3===o)t=t.subarray(r+3);else{if(4!==o){if(5===o){var a=e.config=t.subarray(r,r+i),s=(248&a[0])>>3;return 31===s&&a.length>=2&&(s=32+((7&a[0])<<3)+((224&a[1])>>5)),e.objectType=s,void(e.codec+=s.toString(16))}return}e.codec+=(t[r].toString(16)+".").padStart(3,"0"),t=t.subarray(r+13)}}}))}},{key:"alaw",value:function(e){return oN(e,!1,(function(e,t){iN(e,t)}))}},{key:"stts",value:function(e){return oN(e,!0,(function(e,t){for(var r=gL(t),n=[],i=4,o=0;o<r;o++)n.push({count:gL(t,i),delta:gL(t,i+4)}),i+=8;e.entryCount=r,e.entries=n}))}},{key:"ctts",value:function(e){return oN(e,!0,(function(e,t){var r=gL(t),n=[],i=4;if(1===e.version)for(var o=0;o<r;o++)n.push({count:gL(t,i),offset:gL(t,i+4)}),i+=8;else for(var a=0;a<r;a++)n.push({count:gL(t,i),offset:-(1+~gL(t,i+4))}),i+=8;e.entryCount=r,e.entries=n}))}},{key:"stsc",value:function(e){return oN(e,!0,(function(e,t){for(var r=gL(t),n=[],i=4,o=0;o<r;o++)n.push({firstChunk:gL(t,i),samplesPerChunk:gL(t,i+4),sampleDescriptionIndex:gL(t,i+8)}),i+=12;e.entryCount=r,e.entries=n}))}},{key:"stsz",value:function(e){return oN(e,!0,(function(e,t){var r=gL(t),n=gL(t,4),i=[];if(!r)for(var o=8,a=0;a<n;a++)i.push(gL(t,o)),o+=4;e.sampleSize=r,e.sampleCount=n,e.entrySizes=i}))}},{key:"stco",value:function(e){return oN(e,!0,(function(e,t){for(var r=gL(t),n=[],i=4,o=0;o<r;o++)n.push(gL(t,i)),i+=4;e.entryCount=r,e.entries=n}))}},{key:"stss",value:function(e){return oN(e,!0,(function(e,t){for(var r=gL(t),n=[],i=4,o=0;o<r;o++)n.push(gL(t,i)),i+=4;e.entryCount=r,e.entries=n}))}},{key:"moof",value:function(t){return oN(t,!1,(function(t,r,n){t.mfhd=e.mfhd(e.findBox(r,["mfhd"],n)[0]),t.traf=e.findBox(r,["traf"],n).map((function(t){return e.traf(t)}))}))}},{key:"mfhd",value:function(e){return oN(e,!0,(function(e,t){e.sequenceNumber=gL(t)}))}},{key:"traf",value:function(t){return oN(t,!1,(function(t,r,n){t.tfhd=e.tfhd(e.findBox(r,["tfhd"],n)[0]),t.tfdt=e.tfdt(e.findBox(r,["tfdt"],n)[0]),t.trun=e.trun(e.findBox(r,["trun"],n)[0])}))}},{key:"tfhd",value:function(e){return oN(e,!0,(function(e,t){var r=e.flags,n=t.length;e.trackId=gL(t);var i=4;n>i&&1&r&&(e.baseDataOffset=yL(t,i),i+=8),n>i&&2&r&&(e.sampleDescriptionIndex=gL(t,i),i+=4),n>i&&8&r&&(e.defaultSampleDuration=gL(t,i),i+=4),n>i&&10&r&&(e.defaultSampleSize=gL(t,i),i+=4),n>i&&32&r&&(e.defaultSampleFlags=gL(t,i),i+=4)}))}},{key:"trun",value:function(e){return oN(e,!0,(function(e,t){var r=e.version,n=e.flags,i=t.length,o=e.sampleCount=gL(t),a=4;if(i>a&&1&n&&(e.dataOffset=-(1+~gL(t,a)),a+=4),i>a&&4&n&&(e.firstSampleFlags=gL(t,a),a+=4),e.samples=[],i>a)for(var s,u=0;u<o;u++)s={},256&n&&(s.duration=gL(t,a),a+=4),512&n&&(s.size=gL(t,a),a+=4),1024&n&&(s.flags=gL(t,a),a+=4),2048&n&&(s.cts=r?-(1+~gL(t,a+4)):gL(t,a),a+=4),e.samples.push(s)}))}},{key:"tfdt",value:function(e){return oN(e,!0,(function(e,t){1===e.version?e.baseMediaDecodeTime=yL(t):e.baseMediaDecodeTime=gL(t)}))}},{key:"probe",value:function(t){return!!e.findBox(t,["ftyp"])}},{key:"moovToTrack",value:function(e,t,r){var n,i,o=e.trak;if(o&&o.length){var a=o.find((function(e){var t,r;return"vide"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)})),s=o.find((function(e){var t,r;return"soun"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)}));if(a&&t){var u,c=t;null!=(null===(u=a.tkhd)||void 0===u?void 0:u.trackId)&&(c.id=a.tkhd.trackId),c.timescale=c.formatTimescale=a.mdia.mdhd.timescale,c.duration=a.mdia.mdhd.duration;var l=a.mdia.minf.stbl.stsd.entries[0];if(c.width=l.width,c.height=l.height,l.pasp&&(c.sarRatio=[l.pasp.hSpacing,l.pasp.vSpacing]),l.hvcC)c.codecType=XD,c.codec=l.hvcC.codec,c.vps=l.hvcC.vps,c.sps=l.hvcC.sps,c.pps=l.hvcC.pps,c.hvcC=l.hvcC.data;else{if(!l.avcC)throw new Error("unknown video stsd entry");c.codec=l.avcC.codec,c.sps=l.avcC.sps,c.pps=l.avcC.pps}c.present=!0}if(s&&r){var d,f=r;null!=(null===(d=s.tkhd)||void 0===d?void 0:d.trackId)&&(f.id=s.tkhd.trackId),f.timescale=f.formatTimescale=s.mdia.mdhd.timescale,f.duration=s.mdia.mdhd.duration;var h=s.mdia.minf.stbl.stsd.entries[0];switch(f.sampleSize=h.sampleSize,f.sampleRate=h.sampleRate,f.channelCount=h.channelCount,f.present=!0,h.type){case"alaw":f.codecType=f.codec=qD,f.sampleRate=8e3;break;case"ulaw":f.codecType=f.codec=QD,f.sampleRate=8e3;break;default:f.sampleDuration=lL.getFrameDuration(f.sampleRate,f.timescale),f.sampleRateIndex=lL.getRateIndexByRate(f.sampleRate),f.objectType=(null===(n=h.esds)||void 0===n?void 0:n.objectType)||2,h.esds&&(f.config=Array.from(h.esds.config)),f.codec=(null===(i=h.esds)||void 0===i?void 0:i.codec)||"mp4a.40.2"}}return{videoTrack:t,audioTrack:r}}}},{key:"evaluateDefaultDuration",value:function(e,t,r){var n,i=null==t||null===(n=t.samples)||void 0===n?void 0:n.length;return i?1024*i/t.timescale*e.timescale/r:1024}},{key:"moofToSamples",value:function(t,r,n){var i={};return t.mfhd&&(r&&(r.sequenceNumber=t.mfhd.sequenceNumber),n&&(n.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach((function(t){var o=t.tfhd,a=t.tfdt,s=t.trun;if(o&&s){a&&(r&&r.id===o.trackId&&(r.baseMediaDecodeTime=a.baseMediaDecodeTime),n&&n.id===o.trackId&&(n.baseMediaDecodeTime=a.baseMediaDecodeTime));var u=o.defaultSampleSize||0,c=o.defaultSampleDuration||e.evaluateDefaultDuration(r,n,s.samples.length||s.sampleCount),l=s.dataOffset||0,d=0,f=-1;if(!s.samples.length&&s.sampleCount){i[o.trackId]=[];for(var h=0;h<s.sampleCount;h++)i[o.trackId].push({offset:l,dts:d,duration:c,size:u}),d+=c,l+=u}else i[o.trackId]=s.samples.map((function(e,t){return(e={offset:l,dts:d,pts:d+(e.cts||0),duration:e.duration||c,size:e.size||u,gopId:f,keyframe:0===t||null!=e.flags&&(65536&e.flags)>>>0!=65536}).keyframe&&(f++,e.gopId=f),d+=e.duration,l+=e.size,e}))}})),i}},{key:"moovToSamples",value:function(e){var t=e.trak;if(t&&t.length){var r=t.find((function(e){var t,r;return"vide"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)})),n=t.find((function(e){var t,r;return"soun"===(null===(t=e.mdia)||void 0===t||null===(r=t.hdlr)||void 0===r?void 0:r.handlerType)}));if(r||n){var i,o;if(r){var a,s,u=null===(a=r.mdia)||void 0===a||null===(s=a.minf)||void 0===s?void 0:s.stbl;if(!u)return;var c=u.stts,l=u.stsc,d=u.stsz,f=u.stco,h=u.stss,p=u.ctts;if(!(c&&l&&d&&f&&h))return;i=rN(c,l,d,f,p,h)}if(n){var g,y,v,m=null===(g=n.mdia)||void 0===g||null===(y=g.minf)||void 0===y?void 0:y.stbl;if(!m)return;var _=null===(v=n.mdia.mdhd)||void 0===v?void 0:v.timescale,b=m.stts,A=m.stsc,E=m.stsz,S=m.stco;if(!(_&&b&&A&&E&&S))return;o=rN(b,A,E,S)}return{videoSamples:i,audioSamples:o}}}}}]),e}();function rN(e,t,r,n,i,o){var a,s,u,c=[],l=null==i?void 0:i.entries,d=t.entries,f=n.entries,h=r.entrySizes,p=null==o?void 0:o.entries;p&&(a={},p.forEach((function(e){a[e-1]=!0}))),l&&(s=[],l.forEach((function(e){for(var t=e.count,r=e.offset,n=0;n<t;n++)s.push(r)})));var g=-1,y=0,v=0,m=0,_=0,b=0,A=d[0].samplesPerChunk,E=d[1]?d[1].firstChunk-1:1/0;return e.entries.forEach((function(e){for(var t=e.count,n=e.delta,i=0;i<t;i++)u={dts:y,duration:n,size:h[v]||r.sampleSize,offset:f[m]+b,index:v},p&&(u.keyframe=a[v],u.keyframe&&g++,u.gopId=g),s&&s[v]&&(u.pts=u.dts+s[v]),c.push(u),y+=n,++v<A?b+=u.size:(m++,b=0,m>=E&&(_++,E=d[_+1]?d[_+1].firstChunk-1:1/0),A+=d[_].samplesPerChunk)})),c}function nN(e,t){return e.dataReferenceIndex=pL(t,6),e.width=pL(t,24),e.height=pL(t,26),e.horizresolution=gL(t,28),e.vertresolution=gL(t,32),e.frameCount=pL(t,40),e.depth=pL(t,74),78}function iN(e,t){return e.dataReferenceIndex=pL(t,6),e.channelCount=pL(t,16),e.sampleSize=pL(t,18),e.sampleRate=gL(t,24)/65536,28}function oN(e,t,r){if(e){if(e.size!==e.data.length)throw new Error("box ".concat(e.type," size !== data.length"));var n={start:e.start,size:e.size,headerSize:e.headerSize,type:e.type};return t&&(n.version=e.data[e.headerSize],n.flags=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<16)+(e[t+1]<<8)+(e[t+2]||0)}(e.data,e.headerSize+1),n.headerSize+=4),r(n,e.data.subarray(n.headerSize),n.start+n.headerSize),n}}var aN=function(){function e(t,r,n){MO(this,e),this.videoTrack=t||new CL,this.audioTrack=r||new IL,this.metadataTrack=n||new wL}return LO(e,[{key:"demux",value:function(e,t){var r=this.videoTrack,n=this.audioTrack,i=r.exist(),o=n.exist();if(r.samples=[],n.samples=[],t){if(!o){var a=tN.findBox(t,["moov"])[0];if(!a)throw new Error("cannot found moov box");tN.moovToTrack(tN.moov(a),null,n)}var s=tN.findBox(t,["moof"])[0];if(s){var u=tN.moofToSamples(tN.moof(s),null,n)[n.id],c=n.baseMediaDecodeTime;if(u){var l=s.start;u.map((function(e){e.offset+=l;var r=t.subarray(e.offset,e.offset+e.size);n.samples.push(new dL(e.dts+c,r,e.duration))}))}}}if(e){if(!i&&!o){var d=tN.findBox(e,["moov"])[0];if(!d)throw new Error("cannot found moov box");tN.moovToTrack(tN.moov(d),r,n)}var f=tN.findBox(e,["moof"])[0];if(f){var h,p=tN.moofToSamples(tN.moof(f),r,n),g=r.baseMediaDecodeTime,y=n.baseMediaDecodeTime,v=f.start;Object.keys(p).forEach((function(t){r.id==t?p[t].map((function(t){t.offset+=v;var n=new SL((t.pts||t.dts)+g,t.dts+g);n.duration=t.duration,n.gopId=t.gopId,t.keyframe&&n.setToKeyframe();for(var i=e.subarray(t.offset,t.offset+t.size),o=0,a=i.length-1;o<a;)h=gL(i,o),o+=4,n.units.push(i.subarray(o,o+h)),o+=h;r.samples.push(n)})):n.id==t&&p[t].map((function(t){t.offset+=v;var r=e.subarray(t.offset,t.offset+t.size);n.samples.push(new dL(t.dts+y,r,t.duration))}))}))}}return{videoTrack:r,audioTrack:n,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}}],[{key:"probe",value:function(e){return tN.probe(e)}}]),e}();function sN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,t)||OL(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var uN=Math.pow(2,32)-1,cN=function(){function e(){MO(this,e)}return LO(e,null,[{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=8+(r=r.filter(Boolean)).reduce((function(e,t){return e+t.byteLength}),0),o=new Uint8Array(i);o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=255&i,o.set(e,4);var a=8;return r.forEach((function(e){o.set(e,a),a+=e.byteLength})),o}},{key:"ftyp",value:function(t){return t.find((function(e){return e.type===KD&&e.codecType===XD}))?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){return fL(e.ftyp(t),e.moov(t))}},{key:"moov",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(PL(t.map((function(t){return e.trak(t)}))),[e.mvex(t)]))}},{key:"mvhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]))}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===KD?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.STTS,e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){return e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t.type===KD?e.avc1hev1(t):e.mp4a(t))}},{key:"avc1hev1",value:function(t){var r=t.codecType===XD,n=r?e.types.hvc1:e.types.avc1,i=r?e.hvcC(t):e.avcC(t),o=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i];return t.sarRatio&&t.sarRatio.length>1&&o.push(e.pasp(t.sarRatio)),e.box.apply(e,[n].concat(o))}},{key:"avcC",value:function(t){var r,n=[],i=[];return t.sps.forEach((function(e){r=e.byteLength,n.push(r>>>8&255),n.push(255&r),n.push.apply(n,PL(e))})),t.pps.forEach((function(e){r=e.byteLength,i.push(r>>>8&255),i.push(255&r),i.push.apply(i,PL(e))})),e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(i)))}},{key:"hvcC",value:function(t){var r=t.hvcC;if(r instanceof ArrayBuffer)return r;var n,i=t.vps,o=t.sps,a=t.pps;if(r){var s=r.generalProfileCompatibilityFlags,u=r.generalConstraintIndicatorFlags,c=(i.length&&1)+(o.length&&1)+(a.length&&1);n=[1,r.generalProfileSpace<<6|r.generalTierFlag<<5|r.generalProfileIdc,s>>>24,s>>>16,s>>>8,s,u[0],u[1],u[2],u[3],u[4],u[5],r.generalLevelIdc,240,0,252,252|r.chromaFormatIdc,248|r.bitDepthLumaMinus8,248|r.bitDepthChromaMinus8,0,0,r.numTemporalLayers<<3|r.temporalIdNested<<2|3,c];var l=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,PL(e))};i.length&&(n.push(160,0,i.length),i.forEach(l)),o.length&&(n.push(161,0,o.length),o.forEach(l)),a.length&&(n.push(162,0,a.length),a.forEach(l))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var r=sN(t,2),n=r[0],i=r[1];return e.box(e.types.pasp,new Uint8Array([n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var r=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+r,0,0,0,4,15+r,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([r]).concat(t).concat([6,1,2])))}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat(PL(t.map((function(t){return e.trex(t.id)})))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"moof",value:function(t,r){return e.box.apply(e,[e.types.moof,e.mfhd(t)].concat(PL(r.map((function(t){return e.traf(t)})))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){return e.box(e.types.traf,e.tfhd(t.id),e.tfdt(t.baseMediaDecodeTime),e.trun(t.samples,76))}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t){var r=Math.floor(t/(uN+1)),n=Math.floor(t%(uN+1));return e.box(e.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"trun",value:function(t,r){var n=t.length,i=12+16*n;r+=8+i;var o=new Uint8Array(i);o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var a=0;a<n;a++){var s=t[a],u=s.duration,c=s.size,l=s.flag,d=void 0===l?{}:l,f=s.cts,h=void 0===f?0:f;o.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|(null==d.dependsOn?1:d.dependsOn),d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|(null==d.isNonSyncSample?1:d.isNonSyncSample),61440&d.degradationPriority,15&d.degradationPriority,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a)}return e.box(e.types.trun,o)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(PL(t.map((function(t){return e.trackMP4(t)})))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===KD?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var r=t.ext,n=[e.stsd(t),e.stts(r.stts),e.stsc(r.stsc),e.stsz(r.stsz),e.stco(r.stco)];return r.stss.length&&n.push(e.stss(r.stss)),r.ctts.length&&n.push(e.ctts(r.ctts)),e.box.apply(e,[e.types.stbl].concat(n))}},{key:"stts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach((function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8})),e.box(e.types.stts,fL(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsc",value:function(t){var r=t.length,n=new Uint8Array(12*r),i=0;return t.forEach((function(e){var t=e.firstChunk,r=e.samplesPerChunk,o=e.sampleDescIndex;n.set([t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,o>>24,o>>16&255,o>>8&255,255&o],i),i+=12})),e.box(e.types.stsc,fL(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsz",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stsz,fL(new Uint8Array([0,0,0,0,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stco",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stco,fL(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stss",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4})),e.box(e.types.stss,fL(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"ctts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach((function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8})),e.box(e.types.ctts,fL(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}}]),e}();NO(cN,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trun","trex","tkhd","vmhd","smhd","ctts","stss"].reduce((function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e}),Object.create(null))),NO(cN,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),NO(cN,"FTYPAVC1",cN.box(cN.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),NO(cN,"FTYPHEV1",cN.box(cN.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),NO(cN,"DINF",cN.box(cN.types.dinf,cN.box(cN.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),NO(cN,"VMHD",cN.box(cN.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),NO(cN,"SMHD",cN.box(cN.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),NO(cN,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),NO(cN,"STTS",cN.box(cN.types.stts,cN.StblTable)),NO(cN,"STSC",cN.box(cN.types.stsc,cN.StblTable)),NO(cN,"STSZ",cN.box(cN.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),NO(cN,"STCO",cN.box(cN.types.stco,cN.StblTable));var lN,dN=/Chrome\/([^.]+)/.exec(navigator.userAgent),fN=dN&&Number(dN[1])<50,hN=function(){function e(t,r){MO(this,e),this.videoTrack=t,this.audioTrack=r}return LO(e,[{key:"remux",value:function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.videoTrack,a=this.audioTrack,s=o.exist(),u=a.exist();return i&&(s&&(e=cN.initSegment([this.videoTrack])),u&&(t=cN.initSegment([this.audioTrack]))),s&&o.hasSample()&&(r=this._remuxVideo()),u&&a.hasSample()&&(n=this._remuxAudio()),o.samples=[],a.samples=[],{videoInitSegment:e,audioInitSegment:t,videoSegment:r,audioSegment:n}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack,t=e.samples;fN&&(t[0].flag={dependsOn:2,isNonSyncSample:0});var r=0;t.forEach((function(e){r+=e.units.reduce((function(e,t){return e+t.byteLength}),0),r+=4*e.units.length}));for(var n,i=new Uint8Array(r),o=new DataView(i.buffer),a=function(e,r,a,s){s=t[e];var u=0;s.units.forEach((function(e){o.setUint32(a,e.byteLength),a+=4,i.set(e,a),a+=e.byteLength,u+=4+e.byteLength})),s.size=u,c=a,n=s},s=0,u=t.length,c=0;s<u;s++)a(s,0,c,n);return fL(cN.moof(this.videoTrack.sequenceNumber++,[e]),cN.mdat(i))}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=cN.moof(this.audioTrack.sequenceNumber++,[e]),r=new Uint8Array(e.samples.reduce((function(e,t){return e+t.size}),0));return e.samples.reduce((function(e,t){return r.set(t.data,e),e+t.size}),0),fL(t,cN.mdat(r))}}]),e}(),pN=Object.defineProperty,gN=Object.defineProperties,yN=Object.getOwnPropertyDescriptors,vN=Object.getOwnPropertySymbols,mN=Object.prototype.hasOwnProperty,_N=Object.prototype.propertyIsEnumerable,bN=function(e,t,r){return t in e?pN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},AN=(lN=function(e,t){for(var r in t||(t={}))mN.call(t,r)&&bN(e,r,t[r]);if(vN)for(var n,i=f(vN(t));!(n=i()).done;)r=n.value,_N.call(t,r)&&bN(e,r,t[r]);return e}({},WR),gN(lN,yN({STREAM_PARSED:"core.streamparsed"}))),EN=Object.defineProperty,SN=Object.defineProperties,TN=Object.getOwnPropertyDescriptors,$N=Object.getOwnPropertySymbols,wN=Object.prototype.hasOwnProperty,CN=Object.prototype.propertyIsEnumerable,IN=function(e,t,r){return t in e?EN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r};function kN(e){var t,r=(null==e?void 0:e.media)||document.createElement("video");return t=function(e,t){for(var r in t||(t={}))wN.call(t,r)&&IN(e,r,t[r]);if($N)for(var n,i=f($N(t));!(n=i()).done;)r=n.value,CN.call(t,r)&&IN(e,r,t[r]);return e}({maxPlaylistSize:50,retryCount:3,retryDelay:1e3,loadTimeout:1e4,preloadTime:30,softDecode:!1,bufferBehind:10,maxJumpDistance:3,startTime:0},e),SN(t,TN({media:r}))}function ON(e,t,r){return Math.min(Math.max(e,t),r)}var PN=u$.left,RN=pe,xN=Eo;di({target:"Array",proto:!0,forced:!Rd("reduce")||!xN&&RN>79&&RN<83},{reduce:function(e){var t=arguments.length;return PN(this,e,t,t>1?arguments[1]:void 0)}});var DN=di,LN=fd.findIndex,NN=Bf,MN="findIndex",BN=!0;MN in[]&&Array(1).findIndex((function(){BN=!1})),DN({target:"Array",proto:!0,forced:BN},{findIndex:function(e){return LN(this,e,arguments.length>1?arguments[1]:void 0)}}),NN(MN);var UN=Object.defineProperty,jN=function(e,t,r){return n=e,i="symbol"!=_typeof$3(t)?t+"":t,o=r,i in n?UN(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,r;var n,i,o},FN=function(){function e(e,t){jN(this,"live"),jN(this,"id",0),jN(this,"bitrate",0),jN(this,"width",0),jN(this,"height",0),jN(this,"name",""),jN(this,"url",""),jN(this,"audioCodec",""),jN(this,"videoCodec",""),jN(this,"textCodec",""),jN(this,"startCC",0),jN(this,"endCC",0),jN(this,"startSN",0),jN(this,"endSN",-1),jN(this,"totalDuration",0),jN(this,"targetDuration",0),jN(this,"snDiff",null),jN(this,"segments",[]),jN(this,"audioStreams",[]),jN(this,"currentAudioStream",null),this.update(e,t)}var t=e.prototype;return t.clearOldSegment=function(e,t){return this.currentAudioStream&&this._clearSegments(this.currentAudioStream,e,t),this._clearSegments(this,e,t)},t.getAudioSegment=function(e){if(e&&this.currentAudioStream){var t=e.sn-this.snDiff;return this.currentAudioStream.segments.find((function(e){return e.sn===t}))}},t.update=function(e,t){this.url=e.url,Array.isArray(e.segments)?(null==this.live&&(this.live=e.live),this._updateSegments(e,this),this.startCC=e.startCC,this.endCC=e.endCC,this.startSN=e.startSN,this.endSN=e.endSN||-1,this.totalDuration=e.totalDuration,this.targetDuration=e.targetDuration,this.live=e.live,t&&this.currentAudioStream&&Array.isArray(t.segments)&&(this._updateSegments(t,this.currentAudioStream),null==this.snDiff&&e.segments.length&&t.segments.length&&(this.snDiff=e.segments[0].sn-t.segments[0].sn))):(this.id=e.id,this.bitrate=e.bitrate,this.width=e.width,this.height=e.height,this.name=e.name,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.textCodec=e.textCodec,this.audioStreams=e.audioStreams,!this.currentAudioStream&&this.audioStreams.length&&(this.currentAudioStream=this.audioStreams.find((function(e){return e.default}))||this.audioStreams[0]))},t._clearSegments=function(e,t){for(var r=0,n=this.segments,i=0,o=n.length;i<o;i++)if(n[i].end>=e){r=i;break}return r>t&&(r=t),r&&(this.segments=this.segments.slice(r),this.currentAudioStream&&(this.currentAudioStream.segments=this.currentAudioStream.segments.slice(r))),t-r},t._updateSegments=function(e,t){var r=t.segments;if(this.live){var n=r[r.length-1],i=(null==n?void 0:n.sn)||-1;if(i<e.endSN&&e.segments.length){var o=e.segments.findIndex((function(e){return e.sn===i})),a=o<0?e.segments:e.segments.slice(o+1);if(r.length&&a.length){var s=n.end;a.forEach((function(e){e.start=s,s=e.end}));var u=(null==n?void 0:n.cc)||-1;u>a[0].cc&&a.forEach((function(e){return e.cc+=u}))}t.segments=r.concat(a)}}else t.segments=e.segments},o(e,[{key:"lastSegment",get:function(){if(this.segments.length)return this.segments[this.segments.length-1]}},{key:"segmentDuration",get:function(){var e;return this.targetDuration||(null==(e=this.segments[0])?void 0:e.duration)||0}},{key:"liveEdge",get:function(){return this.endTime}},{key:"endTime",get:function(){var e;return(null==(e=this.lastSegment)?void 0:e.end)||0}}]),e}(),VN=Object.defineProperty,GN=function(e,t,r){return n=e,i="symbol"!=_typeof$3(t)?t+"":t,o=r,i in n?VN(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,r;var n,i,o},HN=function(){function e(e){GN(this,"streams",[]),GN(this,"currentStream",null),GN(this,"dvrWindow",0),GN(this,"_segmentPointer",-1),this.hls=e}var t=e.prototype;return t.getAudioSegment=function(e){var t;return null==(t=this.currentStream)?void 0:t.getAudioSegment(e)},t.moveSegmentPointer=function(e){var t;null==e&&(e=this._segmentPointer+1),this._segmentPointer=ON(e,-1,null==(t=this.currentSegments)?void 0:t.length)},t.reset=function(){this.streams=[],this.currentStream=null,this.dvrWindow=0,this._segmentPointer=-1},t.getSegmentByIndex=function(e){var t;return null==(t=this.currentSegments)?void 0:t[e]},t.setNextSegmentByIndex=function(e){void 0===e&&(e=0),this._segmentPointer=e-1},t.findSegmentIndexByTime=function(e){var t=this.currentSegments;if(t){for(var r,n=0,i=t.length;n<i;n++)if(e>=(r=t[n]).start&&e<r.end)return n;var o=t[t.length-1];if(Math.abs(e-o.end)<.2)return t.length-1}},t.upsertPlaylist=function(e,t){var r=this;if(e){if(e.isMaster)this.streams.length=e.streams.length,e.streams.filter((function(e){return e.url})).forEach((function(e,t){r.streams[t]?r.streams[t].update(e):r.streams[t]=new FN(e)})),this.currentStream=this.streams[0];else if(Array.isArray(e.segments)){var n=this.currentStream;n?n.update(e,t):(this.reset(),this.currentStream=this.streams[0]=new FN(e,t))}this.currentStream&&this.hls.isLive&&!this.dvrWindow&&(this.dvrWindow=this.currentSegments.reduce((function(e,t){return e+t.duration}),0))}},t.clearOldSegment=function(e){void 0===e&&(e=50);var t=this.currentStream;if(this.dvrWindow&&t){var r=t.endTime-this.dvrWindow;r<=0||t.segments.length<=e||(this._segmentPointer=t.clearOldSegment(r,this._segmentPointer))}},o(e,[{key:"lastSegment",get:function(){var e;return null==(e=this.currentStream)?void 0:e.lastSegment}},{key:"currentSegment",get:function(){var e;return null==(e=this.currentSegments)?void 0:e[this._segmentPointer]}},{key:"nextSegment",get:function(){var e;return null==(e=this.currentSegments)?void 0:e[this._segmentPointer+1]}},{key:"currentSegments",get:function(){var e;return null==(e=this.currentStream)?void 0:e.segments}},{key:"liveEdge",get:function(){var e;return null==(e=this.currentStream)?void 0:e.liveEdge}},{key:"seekRange",get:function(){var e=this.currentSegments;if(e&&e.length)return[e[0].start,e[e.length-1].end]}},{key:"isEmpty",get:function(){var e;return!(null==(e=this.currentSegments)?void 0:e.length)}},{key:"isLive",get:function(){var e;return null==(e=this.currentStream)?void 0:e.live}}]),e}(),KN=function(){function e(){var e=window.crypto||window.msCrypto;this.subtle=e&&(e.subtle||e.webkitSubtle),this.externalDecryptor=null}var r,i=e.prototype;return i.decrypt=function(e,t){if(e||t){var r=[];return e&&(r[0]=this._decryptSegment(e)),t&&(r[1]=this._decryptSegment(t)),Promise.all(r)}},i._decryptSegment=(r=n(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.data,!r.key){e.next=5;break}return e.next=4,this._decryptData(r.data,r.key,r.keyIv);case 4:n=e.sent;case 5:if(r.map){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",HR(r.map,n));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)}),i._decryptData=function(){var e=n(t().mark((function e(r,n,i){var o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.externalDecryptor){e.next=6;break}return e.next=3,this.externalDecryptor.decrypt(r,n,i);case 3:return e.abrupt("return",e.sent);case 6:if(this.subtle){e.next=8;break}throw new Error("crypto is not defined");case 8:return e.next=10,this.subtle.importKey("raw",n,{name:"AES-CBC"},!1,["encrypt","decrypt"]);case 10:return o=e.sent,e.t0=Uint8Array,e.next=14,this.subtle.decrypt({name:"AES-CBC",iv:i},o,r);case 14:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),e}(),zN=Object.defineProperty,WN=Object.defineProperties,YN=Object.getOwnPropertyDescriptors,XN=Object.getOwnPropertySymbols,ZN=Object.prototype.hasOwnProperty,qN=Object.prototype.propertyIsEnumerable,QN=function(e,t,r){return t in e?zN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},JN=function(e,t){for(var r in t||(t={}))ZN.call(t,r)&&QN(e,r,t[r]);if(XN)for(var n,i=f(XN(t));!(n=i()).done;)r=n.value,qN.call(t,r)&&QN(e,r,t[r]);return e},eM=function(e,t){return WN(e,YN(t))},tM=new YR("Transmuxer"),rM=function(){function e(e,t,r){this.hls=e,this._demuxer=t?new aN:new ML,this._isMP4=t,r&&(this._remuxer=new hN(this._demuxer.videoTrack,this._demuxer.audioTrack))}var t=e.prototype;return t.transmux=function(e,t,r,n,i,o){var a=this._demuxer;try{this._isMP4?a.demux(e,t):a.demuxAndFix(HR(e,t),r,n,i)}catch(EU){throw new _P(hP,vP.HLS,EU)}var s=a.videoTrack,u=a.audioTrack,c=a.metadataTrack;if(this._fireEvents(s,u,c,r),!this._remuxer)return[s,u];try{var l=this._remuxer.remux(o),d=l.videoInitSegment,f=l.videoSegment,h=l.audioInitSegment,p=l.audioSegment,g=HR(d,f),y=HR(h,p);return[g?{codec:s.codec,data:g}:void 0,y?{codec:u.codec,data:y}:void 0]}catch(EU){throw new _P(pP,vP.FMP4,EU)}},t._fireEvents=function(e,t,r,n){var i=this;tM.debug(e.samples,t.samples),n&&(e.exist()&&this.hls.emit(AN.METADATA_PARSED,{type:"video",meta:{codec:e.codec,timescale:e.timescale,width:e.width,height:e.height,sarRatio:e.sarRatio,baseDts:e.baseDts}}),t.exist()&&this.hls.emit(AN.METADATA_PARSED,{type:"audio",meta:{codec:t.codec,channelCount:t.channelCount,sampleRate:t.sampleRate,timescale:t.timescale,baseDts:t.baseDts}}),tM.debug("discontinuity",e,t)),e.warnings.forEach((function(e){var t;switch(e.type){case JD:t=AN.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case eL:t=AN.LARGE_VIDEO_DTS_GAP_DETECT;break;case tL:t=AN.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT}t&&i.hls.emit(AN.STREAM_EXCEPTION,eM(JN({},e),{type:t})),tM.warn("video exception",e)})),t.warnings.forEach((function(e){var t;switch(e.type){case rL:t=AN.LARGE_AUDIO_DTS_GAP_DETECT;break;case nL:t=AN.AUDIO_GAP_DETECT;break;case iL:t=AN.AUDIO_OVERLAP_DETECT}t&&i.hls.emit(AN.STREAM_EXCEPTION,eM(JN({},e),{type:t})),tM.warn("audio exception",e)})),e.samples.forEach((function(e){e.keyframe&&i.hls.emit(AN.KEYFRAME,{pts:e.pts})})),r.seiSamples.forEach((function(e){i.hls.emit(AN.SEI,eM(JN({},e),{originPts:e.originPts/90,sei:{code:e.data.type,content:e.data.payload,dts:e.pts}}))}))},e}(),nM=Object.defineProperty,iM=function(e,t,r){return n=e,i="symbol"!=_typeof$3(t)?t+"":t,o=r,i in n?nM(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,r;var n,i,o},oM=new YR("BufferService"),aM=function(){function e(e){iM(this,"_decryptor",new KN),iM(this,"_transmuxer",null),iM(this,"_mse",null),iM(this,"_softVideo",null),iM(this,"_sourceCreated",!1),iM(this,"_needInitSegment",!0),iM(this,"_directAppend",!1),this.hls=e,e.config.softDecode?this._softVideo=e.media:(this._mse=new AP,this._mse.bindMedia(e.media)),e.config.decryptor&&(this._decryptor.externalDecryptor=e.config.decryptor)}var r,i=e.prototype;return i.updateDuration=(r=n(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oM.debug("update duration",r),!this._mse){e.next=9;break}if(this._mse.isOpened){e.next=5;break}return e.next=5,this._mse.open();case 5:return e.next=7,this._mse.updateDuration(r);case 7:e.next=10;break;case 9:this._softVideo&&(this._softVideo.duration=r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)}),i.createSource=function(e,t,r,n){if(!this._sourceCreated){var i=e||t;if(i){if(ML.probe(i))this._transmuxer||(this._transmuxer=new rM(this.hls,!1,!this._softVideo));else{if(!tN.probe(i))throw new _P(yP,null,null,null,"unsupported stream");if(this._softVideo)this._transmuxer||(this._transmuxer=new rM(this.hls,!0));else{this._directAppend=!0;var o=!1;e&&!r&&tN.findBox(e,["moov","trak"]).forEach((function(e){var t,i=tN.findBox(e.data,["trak","mdia","minf","stbl","stsd"])[0];if(i){var a=tN.stsd(i).entries[0];a&&(a.hvcC?r=a.hvcC.codec||"hev1.1.6.L93.B0":a.avcC?r=a.avcC.codec:(a.sampleRate||a.esds)&&(n=(null==(t=a.esds)?void 0:t.codec)||"mp4a.40.2",o=!0))}})),t&&!n&&tN.findBox(t,["moov","trak","mdia","minf","stbl","stsd"]).forEach((function(e){var t=tN.stsd(e).entries[0];t&&t.esds&&(n=t.esds.codec)})),e&&!r&&(r="avc1.42e01e"),t&&!n&&(n="mp4a.40.2"),o&&(r+=", "+n,n=""),this._createMseSource(r,n)}}this._softVideo&&(this._sourceCreated=!0)}}},i.appendBuffer=function(){var e=n(t().mark((function e(r,n,i,o,a){var s,u,c,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==r?void 0:r.length)||(null==n?void 0:n.length)){e.next=2;break}return e.abrupt("return");case 2:if(!this._directAppend){e.next=7;break}return s=[],r&&s.push(this._mse.append(AP.VIDEO,r)),n&&s.push(this._mse.append(AP.AUDIO,n)),e.abrupt("return",Promise.all(s));case 7:if(u=this._transmuxer.transmux(r,n,i,o,a,this._needInitSegment||i),c=u[0],l=u[1],!this._softVideo){e.next=12;break}this._softVideo.appendBuffer(c,l),e.next=20;break;case 12:if(!this._mse){e.next=20;break}return this._sourceCreated||this._createMseSource(null==c?void 0:c.codec,null==l?void 0:l.codec),this._needInitSegment=!1,d=this._mse,s=[],c&&s.push(d.append(AP.VIDEO,c.data)),l&&s.push(d.append(AP.AUDIO,l.data)),e.abrupt("return",Promise.all(s));case 20:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),i.evictBuffer=function(){var e=n(t().mark((function e(r){var n,i,o,a=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.hls.media,this._mse&&n&&r&&!(r<0)){e.next=3;break}return e.abrupt("return");case 3:if(i=n.currentTime,!((o=i-r)<=0)){e.next=7;break}return e.abrupt("return");case 7:if(!(uP.start(uP.get(n))+1>=o)){e.next=10;break}return e.abrupt("return");case 10:return e.abrupt("return",this._mse.clearBuffer(0,o).then((function(){return a.hls.emit(WR.REMOVE_BUFFER,{removeEnd:o})})));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.clearAllBuffer=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=2;break}return e.abrupt("return",this._mse.clearAllBuffer());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.decryptBuffer=function(e,t){return this._decryptor.decrypt(e,t)},i.reset=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=5;break}return e.next=3,this._mse.unbindMedia();case 3:return e.next=5,this._mse.bindMedia(this.hls.media);case 5:this._transmuxer=null,this._sourceCreated=!1,this._needInitSegment=!0,this._directAppend=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.endOfStream=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=5;break}if(!this._sourceCreated){e.next=5;break}return e.next=4,this._mse.endOfStream();case 4:this.hls.emit(WR.BUFFEREOS);case 5:this._softVideo&&this._softVideo.endOfStream();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.setLiveSeekableRange=function(){var e=n(t().mark((function e(r,n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._mse&&this._mse.setLiveSeekableRange(r,n);case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),i.destroy=function(){var e=n(t().mark((function e(){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._mse,this._mse=null,this._softVideo=null,!r){e.next=6;break}return e.next=6,r.unbindMedia();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._createMseSource=function(e,t){oM.debug("create mse source, videoCodec="+e+", audioCodec="+t);var r=this._mse;r&&(e&&(r.createSource(AP.VIDEO,"video/mp4;codecs="+e),this._sourceCreated=!0),t&&(r.createSource(AP.AUDIO,"audio/mp4;codecs="+t),this._sourceCreated=!0),this.hls.emit(WR.SOURCEBUFFER_CREATED))},o(e,[{key:"baseDts",get:function(){var e,t,r;return null==(r=null==(t=null==(e=this._transmuxer)?void 0:e._demuxer)?void 0:t._fixer)?void 0:r._baseDts}}]),e}(),sM=Object.defineProperty,uM=function(e,t,r){return n=e,i="symbol"!=_typeof$3(t)?t+"":t,o=r,i in n?sM(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,r;var n,i,o},cM=function(){uM(this,"version",0),uM(this,"streams",[]),uM(this,"isMaster",!0)},lM=function(){uM(this,"id",0),uM(this,"url",""),uM(this,"default",!1),uM(this,"group",""),uM(this,"name",""),uM(this,"lang",""),uM(this,"channels",0),uM(this,"segments",[])},dM=function(){uM(this,"id",0),uM(this,"bitrate",0),uM(this,"width",0),uM(this,"height",0),uM(this,"name",""),uM(this,"url",""),uM(this,"audioCodec",""),uM(this,"videoCodec",""),uM(this,"textCodec",""),uM(this,"audioGroup",""),uM(this,"audioStreams",[])},fM=function(){uM(this,"version",0),uM(this,"url",""),uM(this,"type",""),uM(this,"startCC",0),uM(this,"endCC",0),uM(this,"startSN",0),uM(this,"endSN",0),uM(this,"totalDuration",0),uM(this,"targetDuration",0),uM(this,"live",!0),uM(this,"segments",[])},hM=function(){function e(){uM(this,"sn",0),uM(this,"cc",0),uM(this,"url",""),uM(this,"title",""),uM(this,"start",0),uM(this,"duration",0),uM(this,"key",null),uM(this,"byteRange",null),uM(this,"isInitSegment",!1),uM(this,"initSegment",null),uM(this,"isLast",!1)}return e.prototype.setByteRange=function(e,t){this.byteRange=[0];var r=e.split("@");1===r.length&&t&&t.byteRange?(this.byteRange[0]=t.byteRange[1]||0,this.byteRange[0]&&(this.byteRange[0]+=1)):this.byteRange[0]=parseInt(r[1]),this.byteRange[1]=this.byteRange[0]+parseInt(r[0])-1},o(e,[{key:"end",get:function(){return this.start+this.duration}}]),e}(),pM=function(){function e(t){uM(this,"method",""),uM(this,"url",""),uM(this,"iv",null),uM(this,"keyFormat",""),uM(this,"keyFormatVersions",""),t instanceof e&&(this.method=t.method,this.url=t.url,this.keyFormat=t.keyFormat,this.keyFormatVersions=t.keyFormatVersions,t.iv&&(this.iv=new Uint8Array(t.iv)))}var t=e.prototype;return t.clone=function(t){var r=new e(this);return null!=t&&r.setIVFromSN(t),r},t.setIVFromSN=function(e){if(!this.iv&&"AES-128"===this.method&&"number"==typeof e&&this.url){this.iv=new Uint8Array(16);for(var t=12;t<16;t++)this.iv[t]=e>>8*(15-t)&255}},e}(),gM=/^#(EXT[^:]*)(?::(.*))?$/,yM=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,vM=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,mM=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function _M(e){var t=e.match(gM);if(t&&t[1])return[t[1].replace("EXT-X-",""),t[2]]}function bM(e){for(var t={},r=yM.exec(e);r;)t[r[1]]=r[2]||r[3],r=yM.exec(e);return t}function AM(e,t){if(!t||!e||vM.test(e))return e;var r=mM.exec(t);return r?"/"===e[0]?r[1]+e:r[1]+r[2]+e:e}var EM={audio:[/^mp4a/,/^vorbis$/,/^opus$/,/^flac$/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function SM(e,t){var r=EM[e];if(r&&t&&t.length)for(var n=0;n<r.length;n++)for(var i=0;i<t.length;i++)if(r[n].test(t[i]))return t[i]}var TM=g,$M=v,wM=Yc,CM=k_.trim,IM=L("".charAt),kM=TM.parseFloat,OM=TM.Symbol,PM=OM&&OM.iterator,RM=1/kM("\t\n\v\f\r                　\u2028\u2029\ufeff-0")!=-1/0||PM&&!$M((function(){kM(Object(PM))}))?function(e){var t=CM(wM(e)),r=kM(t);return 0===r&&"-"==IM(t,0)?-0:r}:kM;di({global:!0,forced:parseFloat!=RM},{parseFloat:RM});var xM=function(){function e(){}return e.parse=function(t,r){if(void 0===t&&(t=""),!t.includes("#EXTM3U"))throw new Error("Invalid m3u8 file");var n=t.split(/[\r\n]/).map((function(e){return e.trim()})).filter(Boolean);return e.isMediaPlaylist(t)?function(e,t){var r=new fM;r.url=t;for(var n,i=new hM,o=null,a=null,s=0,u=0,c=0,l=0;n=e[l++];)if("#"===n[0]){var d=_M(n);if(d){var f=d[0],h=d[1];switch(f){case"VERSION":r.version=parseInt(h);break;case"PLAYLIST-TYPE":r.type=null==h?void 0:h.toUpperCase();break;case"TARGETDURATION":r.targetDuration=parseFloat(h);break;case"ENDLIST":var p=r.segments[r.segments.length-1];p&&(p.isLast=!0),r.live=!1;break;case"MEDIA-SEQUENCE":u=r.startSN=parseInt(h);break;case"DISCONTINUITY-SEQUENCE":c=r.startCC=parseInt(h);break;case"DISCONTINUITY":c++;break;case"BYTERANGE":i.setByteRange(h,r.segments[r.segments.length-1]);break;case"EXTINF":var g=h.split(","),y=g[0],v=g[1];i.start=s,i.duration=parseFloat(y),s+=i.duration,i.title=v;break;case"KEY":var m=bM(h);if("NONE"===m.METHOD){a=null;break}if("AES-128"!==m.METHOD)throw new Error("encrypt "+m.METHOD+"/"+m.KEYFORMAT+" is not supported");if((a=new pM).method=m.METHOD,a.url=/^blob:/.test(m.URI)?m.URI:AM(m.URI,t),a.keyFormat=m.KEYFORMAT||"identity",a.keyFormatVersions=m.KEYFORMATVERSIONS,m.IV){var _=m.IV.slice(2);_=(1&_.length?"0":"")+_,a.iv=new Uint8Array(_.length/2);for(var b=0,A=_.length/2;b<A;b++)a.iv[b]=parseInt(_.slice(2*b,2*b+2),16)}break;case"MAP":var E=bM(h);i.url=AM(E.URI,t),E.BYTERANGE&&i.setByteRange(E.BYTERANGE),i.isInitSegment=!0,i.sn=0,a&&(i.key=a.clone(0)),o=i,i=new hM}}}else i.sn=u,i.cc=c,i.url=AM(n,t),a&&(i.key=a.clone(u)),o&&(i.initSegment=o),r.segments.push(i),i=new hM,u++;var S=r.segments[r.segments.length-1];return S&&(r.endSN=S.sn),r.totalDuration=s,r.endCC=c,r}(n,r):function(e,t){for(var r,n=new cM,i=0,o=[];r=e[i++];){var a=_M(r);if(a){var s=a[0],u=a[1];if("VERSION"===s)n.version=parseInt(u);else if("MEDIA"===s&&u){var c=bM(u);if("AUDIO"===c.TYPE&&c.URI){var l=new lM;l.url=AM(c.URI,t),l.default="YES"===c.DEFAULT,l.group=c["GROUP-ID"],l.name=c.NAME,l.lang=c.LANGUAGE,c.CHANNELS&&(l.channels=Number(c.CHANNELS.split("/")[0]),isNaN(l.channels)&&(l.channels=0)),o.push(l)}}else if("STREAM-INF"===s&&u){var d=new dM,f=bM(u);if(d.bitrate=parseInt(f["AVERAGE-BANDWIDTH"]||f.BANDWIDTH),d.name=f.NAME,d.url=AM(e[i++],t),f.RESOLUTION){var h=f.RESOLUTION.split("x"),p=h[0],g=h[1];d.width=parseInt(p),d.height=parseInt(g)}if(f.CODECS){var y=f.CODECS.split(/[ ,]+/).filter(Boolean);d.videoCodec=SM("video",y),d.audioCodec=SM("audio",y),d.textCodec=SM("text",y)}d.audioGroup=f.AUDIO,n.streams.push(d)}}}return n.streams.forEach((function(e,t){e.id=t})),o.length&&(o.forEach((function(e,t){e.id=t})),n.streams.forEach((function(e){e.audioGroup&&(e.audioStreams=o.filter((function(t){return t.group===e.audioGroup})))}))),n}(n,r)},e.isMediaPlaylist=function(e){return e.includes("#EXTINF:")||e.includes("#EXT-X-TARGETDURATION:")},e}(),DM=Object.defineProperty,LM=Object.defineProperties,NM=Object.getOwnPropertyDescriptors,MM=Object.getOwnPropertySymbols,BM=Object.prototype.hasOwnProperty,UM=Object.prototype.propertyIsEnumerable,jM=function(e,t,r){return t in e?DM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},FM=function(e,t){for(var r in t||(t={}))BM.call(t,r)&&jM(e,r,t[r]);if(MM)for(var n,i=f(MM(t));!(n=i()).done;)r=n.value,UM.call(t,r)&&jM(e,r,t[r]);return e},VM=function(e,t){return LM(e,NM(t))},GM=function(){function e(e){var t,r=this;jM(this,"symbol"!=_typeof$3(t="_onLoaderRetry")?t+"":t,(function(e,t){r.hls.emit(AN.LOAD_RETRY,{error:_P.network(e),retryTime:t})})),this.hls=e,this._timer=null;var n=this.hls.config,i=n.retryCount,o=n.retryDelay,a=n.loadTimeout,s=n.fetchOptions;this._loader=new zR(VM(FM({},s),{responseType:"text",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry})),this._audioLoader=new zR(VM(FM({},s),{responseType:"text",retry:i,retryDelay:o,timeout:a,onRetryError:this._onLoaderRetry}))}var r,i=e.prototype;return i.load=(r=n(t().mark((function e(r,n){var i,o,a,s,u,c,l,d,f;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[this._loader.load(r)],n&&i.push(this._audioLoader.load(n)),e.prev=2,e.next=5,Promise.all(i);case 5:if(s=e.sent,u=s[0],c=s[1],u){e.next=10;break}return e.abrupt("return",[]);case 10:o=u.data,a=null==c?void 0:c.data,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(2),_P.network(e.t0);case 17:l=this.hls.config.onPreM3U8Parse,e.prev=18,l&&(o=l(o)||o,a&&(a=l(a,!0)||a)),d=xM.parse(o,r),a&&(f=xM.parse(a,n)),e.next=27;break;case 24:throw e.prev=24,e.t1=e.catch(18),new _P(lP,vP.HLS);case 27:return d&&(d.isMaster?this.hls.emit(AN.HLS_MANIFEST_LOADED,{playlist:d}):this.hls.emit(AN.HLS_LEVEL_LOADED,{playlist:d})),e.abrupt("return",[d,f]);case 29:case"end":return e.stop()}}),e,this,[[2,14],[18,24]])}))),function(e,t){return r.apply(this,arguments)}),i.poll=function(e,r,i,o){var a=this;clearTimeout(this._timer),o=o||3e3;var s,u=(s=n(t().mark((function n(){var s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return clearTimeout(a._timer),t.next=3,a.load(e,r);case 3:if((s=t.sent)[0]){t.next=6;break}return t.abrupt("return");case 6:i(s[0],s[1]),a._timer=setTimeout(u,o);case 8:case"end":return t.stop()}}),n)}))),function(){return s.apply(this,arguments)});this._timer=setTimeout(u,o)},i.stopPoll=function(){return clearTimeout(this._timer),this.cancel()},i.cancel=function(){return Promise.all([this._loader.cancel(),this._audioLoader.cancel()])},e}(),HM=Object.defineProperty,KM=Object.defineProperties,zM=Object.getOwnPropertyDescriptors,WM=Object.getOwnPropertySymbols,YM=Object.prototype.hasOwnProperty,XM=Object.prototype.propertyIsEnumerable,ZM=function(e,t,r){return t in e?HM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},qM=function(e,t){for(var r in t||(t={}))YM.call(t,r)&&ZM(e,r,t[r]);if(WM)for(var n,i=f(WM(t));!(n=i()).done;)r=n.value,XM.call(t,r)&&ZM(e,r,t[r]);return e},QM=function(e,t){return KM(e,zM(t))},JM=function(e,t,r){return ZM(e,"symbol"!=_typeof$3(t)?t+"":t,r),r},eB=function(){function e(e){var t=this;JM(this,"_emitOnLoaded",(function(e,r){var n=e.endTime-e.startTime;t._bandwidthService.addRecord(e.contentLength,n),t.hls.emit(WR.SPEED,{time:n,byteLength:e.contentLength,url:r}),t.hls.emit(WR.LOAD_COMPLETE,{url:r,elapsed:n||0});var i=e.response,o=e.firstByteTime,a=e.startTime;t.hls.emit(WR.TTFB,{url:r,responseUrl:i.url,elapsed:o-a}),t.hls.emit(WR.LOAD_RESPONSE_HEADERS,{headers:i.headers})})),JM(this,"_onLoaderRetry",(function(e,r){t.hls.emit(WR.LOAD_RETRY,{error:_P.network(e),retryTime:r})})),this.hls=e,this._bandwidthService=new Zx,this._mapCache={},this._keyCache={};var r=this.hls.config,n=r.retryCount,i=r.retryDelay,o=r.loadTimeout,a=r.fetchOptions;this._segmentLoader=new zR(QM(qM({},a),{responseType:"arraybuffer",retry:n,retryDelay:i,timeout:o,onRetryError:this._onLoaderRetry})),this._audioSegmentLoader=new zR(QM(qM({},a),{responseType:"arraybuffer",retry:n,retryDelay:i,timeout:o,onRetryError:this._onLoaderRetry})),this._keyLoader=new zR(QM(qM({},a),{responseType:"arraybuffer",retry:n,retryDelay:i,timeout:o,onRetryError:this._onLoaderRetry}))}var r,i=e.prototype;return i.speedInfo=function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}},i.load=function(e,t,r,n){void 0===n&&(n=r);var i=[];return e&&(i[0]=this.loadVideoSegment(e,r)),t&&(i[1]=this.loadAudioSegment(t,n)),Promise.all(i)},i.loadVideoSegment=function(e,t){return this._loadSegment(this._segmentLoader,e,t)},i.loadAudioSegment=function(e,t){return this._loadSegment(this._audioSegmentLoader,e,t)},i._loadSegment=(r=n(t().mark((function e(r,n,i){var o,a,s,u,c,l,d,f,h,p,g,y,v,m,_=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=[],this.hls.emit(WR.LOAD_START,{url:n.url}),h[0]=r.load(n.url),i&&n.initSegment&&(p=n.initSegment.url,(u=this._mapCache[p])||(this.hls.emit(WR.LOAD_START,{url:p}),h[1]=r.load(p).then((function(e){e&&(Object.keys(_._mapCache)>30&&(_._mapCache={}),u=_._mapCache[p]=e.data,_._emitOnLoaded(e,p))}))),(g=null==(o=n.initSegment.key)?void 0:o.url)&&(f=n.initSegment.key.iv,(d=this._keyCache[g])||(this.hls.emit(WR.LOAD_START,{url:g}),h[2]=this._keyLoader.load(g).then((function(e){e&&(d=_._keyCache[g]=e.data,_._emitOnLoaded(e,g))}))))),(y=null==(a=n.key)?void 0:a.url)&&(l=n.key.iv,(c=this._keyCache[y])||(this.hls.emit(WR.LOAD_START,{url:y}),h[3]=this._keyLoader.load(y).then((function(e){e&&(c=_._keyCache[y]=e.data,_._emitOnLoaded(e,y))})))),e.next=8,Promise.all(h);case 8:if(v=e.sent,m=v[0]){e.next=12;break}return e.abrupt("return");case 12:return s=m.data,this._emitOnLoaded(m,n.url),e.abrupt("return",{data:s,map:u,key:c,mapKey:d,keyIv:l,mapKeyIv:f});case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)}),i.reset=function(){this._mapCache={},this._keyCache={},this._bandwidthService.reset()},i.cancel=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._keyLoader.cancel(),this._segmentLoader.cancel(),this._audioSegmentLoader.cancel()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),tB=Object.defineProperty,rB=function(e,t,r){return n=e,i="symbol"!=_typeof$3(t)?t+"":t,o=r,i in n?tB(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,r;var n,i,o},nB=new YR("hls"),iB=function(e){function r(i){var o,a;return o=e.call(this)||this,rB(l(o),"version",r.version),rB(l(o),"media",null),rB(l(o),"config",null),rB(l(o),"_manifestLoader",null),rB(l(o),"_segmentLoader",null),rB(l(o),"_playlist",null),rB(l(o),"_bufferService",null),rB(l(o),"_gapService",null),rB(l(o),"_seiService",null),rB(l(o),"_prevSegSn",null),rB(l(o),"_prevSegCc",null),rB(l(o),"_tickTimer",null),rB(l(o),"_tickInterval",500),rB(l(o),"_segmentProcessing",!1),rB(l(o),"_reloadOnPlay",!1),rB(l(o),"_loadM3U8",(a=n(t().mark((function e(r){var n,i,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,o._manifestLoader.load(r);case 4:i=e.sent,n=i[0],e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),o._emitError(_P.create(e.t0));case 11:if(n){e.next=13;break}return e.abrupt("return");case 13:if(o._playlist.upsertPlaylist(n),!n.isMaster){e.next=17;break}return e.next=17,o._refreshM3U8();case 17:if(o.emit(AN.STREAM_PARSED),!o.isLive){e.next=23;break}o._bufferService.setLiveSeekableRange(0,4294967295),n.isMaster||o._pollM3U8(r),e.next=27;break;case 23:return e.next=25,o._bufferService.updateDuration(o._playlist.currentStream.totalDuration);case 25:(a=o.config.startTime)&&(o.media.currentTime=a,o._playlist.setNextSegmentByIndex(o._playlist.findSegmentIndexByTime(a)||0));case 27:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return a.apply(this,arguments)})),rB(l(o),"_loadSegment",n(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o._segmentProcessing&&o.media){e.next=2;break}return e.abrupt("return");case 2:if(r=o.media.currentTime,n=o._playlist.currentSegment,o._playlist.nextSegment&&!(n&&n.end-r>=o.config.preloadTime)){e.next=7;break}return e.abrupt("return");case 7:return e.abrupt("return",o._loadSegmentDirect());case 8:case"end":return e.stop()}}),e)})))),rB(l(o),"_onPlay",n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(o._disconnectTimer),!o._reloadOnPlay){e.next=6;break}o._reloadOnPlay=!1,o.replay(!0),e.next=9;break;case 6:return e.next=8,o._loadSegment();case 8:o._startTick();case 9:case"end":return e.stop()}}),e)})))),rB(l(o),"_onPause",(function(){if(o.isLive){if(!o._reloadOnPlay){var e=o.config.disconnectTime;if(null==e&&(e=o._playlist.dvrWindow),!isFinite(e))return;clearTimeout(o._disconnectTimer),o._disconnectTimer=setTimeout((function(){o._reloadOnPlay=!0,o._clear()}),e||0)}}else o._stopTick()})),rB(l(o),"_onSeeking",n(t().mark((function e(){var r,n,i,a,s,u,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.media){e.next=2;break}return e.abrupt("return");case 2:if(r=o.media.currentTime,!(n=o._playlist.seekRange)){e.next=9;break}if(i=ON(r,n[0]+.1,n[1]-.1),!(Math.abs(r-i)>=.1)){e.next=9;break}return o.media.currentTime=i,e.abrupt("return");case 9:if(!(a=o._playlist.currentSegment)){e.next=14;break}if(!((s=uP.info(uP.get(o.media),r,.1)).end&&s.end>=a.end)){e.next=14;break}return e.abrupt("return");case 14:if(u=o._playlist.findSegmentIndexByTime(r),c=o._playlist.getSegmentByIndex(u),null!=u&&c&&(!o._segmentProcessing||c!==o._playlist.nextSegment)){e.next=18;break}return e.abrupt("return");case 18:return nB.debug("seek to",r,c),o._playlist.setNextSegmentByIndex(u),o._stopTick(),e.next=23,o._segmentLoader.cancel();case 23:return e.next=25,o._loadSegmentDirect();case 25:o._startTick();case 26:case"end":return e.stop()}}),e)})))),rB(l(o),"_onTimeupdate",(function(){if(o.media){var e=o.config;if(e.isLive&&e.maxLatency&&e.targetLatency&&o.media){var t=o._playlist.liveEdge;if(!t)return;var r=t-o.media.currentTime;r>=e.maxLatency&&(nB.debug("latency jump",r),o.media.currentTime=t-e.targetLatency)}o._seiService.throw(o.media.currentTime)}})),rB(l(o),"_tick",(function(){if(o.media){o._startTick();var e=o.media;uP.end(uP.get(e))<.1||!e.readyState||(!(t=e)||t.paused||t.ended||0===t.playbackRate||0===t.readyState?e.readyState<2&&o._gapService&&o._gapService.do(e,o.config.maxJumpDistance,o.isLive):(o._loadSegment(),o._gapService&&o._gapService.do(e,o.config.maxJumpDistance,o.isLive)))}var t})),o.config=i=kN(i),o.media=o.config.media,o._manifestLoader=new GM(l(o)),o._segmentLoader=new eB(l(o)),o._playlist=new HN(l(o)),o._bufferService=new aM(l(o)),o._seiService=new Xx(l(o)),i.softDecode||(o._gapService=new XR),o.media.addEventListener("play",o._onPlay),o.media.addEventListener("pause",o._onPause),o.media.addEventListener("seeking",o._onSeeking),o.media.addEventListener("timeupdate",o._onTimeupdate),o}a(r,e);var i,s=r.prototype;return s.speedInfo=function(){return this._segmentLoader.speedInfo()},s.bufferInfo=function(e){var t;return void 0===e&&(e=.1),uP.info(uP.get(this.media),null==(t=this.media)?void 0:t.currentTime,e)},s.playbackQuality=function(){return function(e){if(!e)return{};if("function"==typeof e.getVideoPlaybackQuality){var t=e.getVideoPlaybackQuality();return{droppedVideoFrames:t.droppedVideoFrames||t.corruptedVideoFrames,totalVideoFrames:t.totalVideoFrames,creationTime:t.creationTime}}return{droppedVideoFrames:e.webkitDroppedFrameCount,totalVideoFrames:e.webkitDecodedFrameCount,creationTime:performance.now()}}(this.media)},s.load=(i=n(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r&&(this.config.url=r),r=this.config.url,e.next=4,this._reset();case 4:if(r&&(r=r.trim()),r){e.next=7;break}throw this._emitError(new _P(yP,vP.OPTION,null,null,"m3u8 url is missing"));case 7:return e.next=9,this._loadM3U8(r);case 9:return e.next=11,this._loadSegment();case 11:this._startTick();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)}),s.replay=function(){var e=n(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.startTime=0,!this.config.softDecode){e.next=5;break}this.load(),e.next=7;break;case 5:return e.next=7,this.load();case 7:return this._reloadOnPlay=!1,e.abrupt("return",this.media.play(!r));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.switchURL=function(){var e=n(t().mark((function e(r,n){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=0),this.config.startTime=n,e.prev=2,!this.config.softDecode){e.next=7;break}e.t0=this.load(r),e.next=10;break;case 7:return e.next=9,this.load(r);case 9:e.t0=e.sent;case 10:i=e.t0,e.next=17;break;case 13:throw e.prev=13,e.t1=e.catch(2),this.emit(AN.SWITCH_URL_FAILED,e.t1),e.t1;case 17:return this._reloadOnPlay=!1,i&&this.emit(AN.SWITCH_URL_SUCCESS,{url:r}),e.abrupt("return",this.media.play(!0));case 20:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(t,r){return e.apply(this,arguments)}}(),s.switchStream=function(){var e=n(t().mark((function e(r,n){var i,o,a,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),i=this.currentStream,o=this.streams,i&&i.id!==r&&o&&!(o.length<2)){e.next=5;break}return e.abrupt("return");case 5:if(a=o.find((function(e){return e.id===r}))){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,e.next=11,this._clear();case 11:if(!n){e.next=14;break}return e.next=14,this._bufferService.clearAllBuffer();case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(8),this._emitError(_P.create(e.t0));case 19:if(i.currentAudioStream&&a.audioStreams.length>2&&(s=i.currentAudioStream.id,a.currentAudioStream=a.audioStreams.find((function(e){return e.id===s}))||a.currentAudioStream),this._playlist.currentStream=a,e.prev=21,!this.isLive&&a.segments.length){e.next=25;break}return e.next=25,this._refreshM3U8();case 25:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,e.next=29,this._loadSegmentDirect();case 29:e.next=35;break;case 31:throw e.prev=31,e.t1=e.catch(21),this._playlist.currentStream=i,e.t1;case 35:return this._startTick(),e.abrupt("return",a);case 37:case"end":return e.stop()}}),e,this,[[8,16],[21,31]])})));return function(t,r){return e.apply(this,arguments)}}(),s.switchAudioStream=function(){var e=n(t().mark((function e(r,n){var i,o,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),i=this.currentStream){e.next=4;break}return e.abrupt("return");case 4:if((o=i.currentAudioStream)&&o.id!==r&&!(i.audioStreams.length<2)){e.next=7;break}return e.abrupt("return");case 7:if(a=i.audioStreams.find((function(e){return e.id===r}))){e.next=10;break}return e.abrupt("return");case 10:return e.prev=10,e.next=13,this._clear();case 13:if(!n){e.next=16;break}return e.next=16,this._bufferService.clearAllBuffer();case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(10),this._emitError(_P.create(e.t0));case 21:if(i.currentAudioStream=a,e.prev=22,!this.isLive&&a.segments.length){e.next=26;break}return e.next=26,this._refreshM3U8();case 26:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,e.next=30,this._loadSegmentDirect();case 30:e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(22),i.currentAudioStream=o,e.t1;case 36:return this._startTick(),e.abrupt("return",a);case 38:case"end":return e.stop()}}),e,this,[[10,18],[22,32]])})));return function(t,r){return e.apply(this,arguments)}}(),s.destroy=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.media){e.next=2;break}return e.abrupt("return");case 2:return this.removeAllListeners(),this._playlist.reset(),this._segmentLoader.reset(),this._seiService.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("pause",this._onPause),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),e.next=12,Promise.all([this._clear(),this._bufferService.destroy()]);case 12:this.media=null;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.isSupported=function(){return AP.isSupported()||!!WebAssembly},r.enableLogger=function(){YR.enable(),mL.enable()},r.disableLogger=function(){YR.disable(),mL.disable()},s._refreshM3U8=function(){var e,t=this,r=this._playlist.currentStream;if(!r||!r.url)throw this._emitError(_P.create(null,null,new Error("m3u8 url is not defined")));var n=r.url,i=null==(e=r.currentAudioStream)?void 0:e.url;return this._manifestLoader.load(n,i).then((function(e){var r=e[0],o=e[1];r&&(t._playlist.upsertPlaylist(r,o),t.isLive&&t._pollM3U8(n,i))})).catch((function(e){throw t._emitError(_P.create(e))}))},s._pollM3U8=function(e,t){var r,n=this,i=this._playlist.isEmpty;this._manifestLoader.poll(e,t,(function(e,t){n._playlist.upsertPlaylist(e,t),e&&i&&!n._playlist.isEmpty&&n._loadSegment(),i&&(i=n._playlist.isEmpty)}),1e3*((null==(r=this._playlist.lastSegment)?void 0:r.duration)||0))},s._loadSegmentDirect=function(){var e=n(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._playlist.nextSegment){e.next=3;break}return e.abrupt("return");case 3:return n=!1,this._segmentProcessing=!0,e.prev=5,e.next=8,this._reqAndBufferSegment(r,this._playlist.getAudioSegment(r));case 8:n=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),this._emitError(_P.create(e.t0));case 14:return e.prev=14,this._segmentProcessing=!1,e.finish(14);case 17:return n&&(this._playlist.moveSegmentPointer(),r.isLast?this._end():this._loadSegment()),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this,[[5,11,14,17]])})));return function(){return e.apply(this,arguments)}}(),s._reqAndBufferSegment=function(){var e=n(t().mark((function e(r,n){var i,o,a,s,u,c,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r?r.cc:n.cc,a=this._prevSegCc!==o,e.next=4,this._segmentLoader.load(r,n,a);case 4:if((s=e.sent)[0]){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(i=this._bufferService).decryptBuffer.apply(i,s);case 9:if(u=e.sent){e.next=12;break}return e.abrupt("return");case 12:return c=r?r.sn:n.sn,l=r?r.start:n.start,d=this._playlist.currentStream,this._bufferService.createSource(u[0],u[1],null==d?void 0:d.videoCodec,null==d?void 0:d.audioCodec),e.next=18,this._bufferService.appendBuffer(u[0],u[1],a,this._prevSegSn===c-1,l);case 18:return e.next=20,this._bufferService.evictBuffer(this.config.bufferBehind);case 20:return this._prevSegCc=o,this._prevSegSn=c,e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),s._clear=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._disconnectTimer),this._stopTick(),e.next=4,Promise.all([this._segmentLoader.cancel(),this._manifestLoader.stopPoll()]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s._reset=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._reloadOnPlay=!1,this._prevSegSn=null,this._prevSegCc=null,this._playlist.reset(),this._segmentLoader.reset(),this._seiService.reset(),e.next=8,this._clear();case 8:return e.abrupt("return",this._bufferService.reset());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s._end=function(){this._clear(),this._bufferService.endOfStream()},s._stopTick=function(){clearTimeout(this._tickTimer)},s._startTick=function(){this._stopTick(),this._tickTimer=setTimeout(this._tick,this._tickInterval)},s._emitError=function(e,t){var r;return void 0===t&&(t=!0),nB.table(e),nB.error(e),nB.error(null==(r=this.media)?void 0:r.error),this.emit(AN.ERROR,e),t&&this._end(),this._seiService.reset(),e},o(r,[{key:"isLive",get:function(){return this._playlist.isLive}},{key:"streams",get:function(){return this._playlist.streams}},{key:"currentStream",get:function(){return this._playlist.currentStream}},{key:"baseDts",get:function(){var e;return null==(e=this._bufferService)?void 0:e.baseDts}}]),r}(nD),oB=iB;rB(oB,"version","3.0.0-next.11");try{localStorage.getItem("xgd")?oB.enableLogger():oB.disableLogger()}catch(EU){}var aB=Object.defineProperty,sB=Object.defineProperties,uB=Object.getOwnPropertyDescriptors,cB=Object.getOwnPropertySymbols,lB=Object.prototype.hasOwnProperty,dB=Object.prototype.propertyIsEnumerable,fB=function(e,t,r){return t in e?aB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},hB=function(e,t,r){return fB(e,"symbol"!=_typeof$3(t)?t+"":t,r),r},pB=function(){function e(e,t){var r=this;hB(this,"_opts",null),hB(this,"_plugin",null),hB(this,"_onLowDecode",(function(){var e,t,n,i,o,a,s=r._opts,u=s.media,c=s.innerDegrade;null==(t=null==(e=r._plugin)?void 0:e.player)||t.emit("lowdecode",u.degradeInfo),null==(i=null==(n=r._plugin)?void 0:n.player)||i.emit("core_event",(o=function(e,t){for(var r in t||(t={}))lB.call(t,r)&&fB(e,r,t[r]);if(cB)for(var n,i=f(cB(t));!(n=i()).done;)r=n.value,dB.call(t,r)&&fB(e,r,t[r]);return e}({},u.degradeInfo),a={eventName:AN.LOWDECODE},sB(o,uB(a)))),1===c&&r._degrade(u.src)})),hB(this,"_degrade",(function(e){var t=r._plugin.player,n=t.video;if(!n||"MVideo"===n.TAG){var i=t.video.degradeVideo;t.video=i,n.degrade(e),e&&(t.config.url=e);var o=t.root.firstChild;"MVideo"===o.TAG&&t.root.replaceChild(i,o);var a=r._plugin.constructor.pluginName.toLowerCase();t.unRegisterPlugin(a),t.once("canplay",(function(){t.play()}))}})),hB(this,"forceDegradeToVideo",(function(e){1===r._opts.innerDegrade&&r._degrade(e)})),this._opts=e,this._plugin=t,this._init()}var t=e.prototype;return t._init=function(){var e=this._opts,t=e.media,r=e.preloadTime,n=e.innerDegrade,i=e.isLive;t&&(i||!t.setPlayMode?(n&&t.setAttribute("innerdegrade",n),r&&t.setAttribute("preloadtime",r),this._bindEvents()):t.setPlayMode("VOD"))},t._bindEvents=function(){this._opts.media.addEventListener("lowdecode",this._onLowDecode)},t.destroy=function(){var e,t;null==(t=null==(e=this._opts)?void 0:e.media)||t.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null},e}(),gB=Object.defineProperty,yB=Object.defineProperties,vB=Object.getOwnPropertyDescriptors,mB=Object.getOwnPropertySymbols,_B=Object.prototype.hasOwnProperty,bB=Object.prototype.propertyIsEnumerable,AB=function(e,t,r){return t in e?gB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},EB=function(e,t){for(var r in t||(t={}))_B.call(t,r)&&AB(e,r,t[r]);if(mB)for(var n,i=f(mB(t));!(n=i()).done;)r=n.value,bB.call(t,r)&&AB(e,r,t[r]);return e},SB=function(e,t,r){return AB(e,"symbol"!=_typeof$3(t)?t+"":t,r),r},TB=function(t){function r(){var e;return e=t.apply(this,arguments)||this,SB(l(e),"hls",null),SB(l(e),"pluginExtension",null),SB(l(e),"destroy",(function(){var t;e.hls&&(e.hls.destroy(),e.hls=null),null==(t=e.pluginExtension)||t.destroy(),e.pluginExtension=null})),SB(l(e),"_onSwitchURL",(function(t){e.hls&&(e.player.config.url=t,e.hls.switchURL(t).catch((function(e){})))})),SB(l(e),"_onDefinitionChange",(function(t){var r=t.to;e.hls&&e.hls.switchURL(r).catch((function(e){}))})),e}a(r,t);var n=r.prototype;return n.beforePlayerInit=function(){var t,r=this,n=this.player.config;this.hls&&this.hls.destroy(),this.player.switchURL=this._onSwitchURL;var i=n.hls||{};i.innerDegrade=i.innerDegrade||n.innerDegrade,null==i.disconnectTime&&(i.disconnectTime=0),this.hls=new oB(EB({softDecode:this.softDecode,isLive:n.isLive,media:this.player.video,startTime:n.startTime,url:n.url},i)),this.softDecode||e.BasePlugin.defineGetterOrSetter(this.player,{url:{get:function(){var e,t;return null==(t=null==(e=r.hls)?void 0:e.media)?void 0:t.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new pB(EB({isLive:n.isLive,media:this.player.video},i),this),this.player.forceDegradeToVideo=function(){var e,t;return null==(t=r.pluginExtension)?void 0:(e=t).forceDegradeToVideo.apply(e,arguments)}),n.isLive&&(null==(t=this.player)||t.useHooks("replay",(function(){var e;return null==(e=r.hls)?void 0:e.replay()}))),this.on(e.Events.URL_CHANGE,this._onSwitchURL),this.on(e.Events.DESTROY,this.destroy),this._transError(),this._transCoreEvent(WR.TTFB),this._transCoreEvent(WR.LOAD_START),this._transCoreEvent(WR.LOAD_RESPONSE_HEADERS),this._transCoreEvent(WR.LOAD_COMPLETE),this._transCoreEvent(WR.LOAD_RETRY),this._transCoreEvent(WR.SOURCEBUFFER_CREATED),this._transCoreEvent(WR.REMOVE_BUFFER),this._transCoreEvent(WR.BUFFEREOS),this._transCoreEvent(WR.KEYFRAME),this._transCoreEvent(WR.METADATA_PARSED),this._transCoreEvent(WR.SEI),this._transCoreEvent(WR.SEI_IN_TIME),this._transCoreEvent(WR.SPEED),this._transCoreEvent(WR.HLS_MANIFEST_LOADED),this._transCoreEvent(AN.STREAM_PARSED),this._transCoreEvent(WR.HLS_LEVEL_LOADED),this._transCoreEvent(WR.STREAM_EXCEPTION),this._transCoreEvent(WR.SWITCH_URL_SUCCESS),this._transCoreEvent(WR.SWITCH_URL_FAILED),n.url&&this.hls.load(n.url).catch((function(e){}))},r.isSupported=function(e){return oB.isSupported(e)},n._transError=function(){var t=this;this.hls.on(AN.ERROR,(function(r){t.player&&t.player.emit(e.Events.ERROR,new e.Errors(t.player,r))}))},n._transCoreEvent=function(e){var t=this;this.hls.on(e,(function(r){var n;t.player&&t.player.emit("core_event",(n=EB({},r),yB(n,vB({eventName:e}))))}))},o(r,[{key:"core",get:function(){return this.hls}},{key:"version",get:function(){var e;return null==(e=this.hls)?void 0:e.version}},{key:"softDecode",get:function(){var e,t,r=null==(t=null==(e=this.player)?void 0:e.config)?void 0:t.mediaType;return!!r&&"video"!==r}}],[{key:"pluginName",get:function(){return"hls"}}]),r}(e.BasePlugin);SB(TB,"Hls",oB),SB(TB,"EVENT",AN);var $B=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof$3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,r){var n=r(12)("wks"),i=r(13),o=r(0).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,r){var n=r(4);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)};e.exports=function(e){return"object"===(void 0===e?"undefined":n(e))?null!==e:"function"==typeof e}},function(e,t,r){var n=r(6);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){e.exports=!r(15)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,r){var n=r(3),i=r(26),o=r(27),a=Object.defineProperty;t.f=r(7)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(s){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){e.exports=!1},function(e,t,r){var n=r(8),i=r(1)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(2),i=r(0),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(10)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,r){var n=r(9),i=r(28);e.exports=r(7)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,r){var n=r(4),i=r(0).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(0),i=r(14),o=r(18),a=r(13)("src"),s=r(29),u=(""+s).split("toString");r(2).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(c&&(o(r,a)||i(r,a,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,r){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,r){e.exports={}},function(e,t,r){var n,i,o,a=r(5),s=r(38),u=r(39),c=r(16),l=r(0),d=l.process,f=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,g=l.Dispatch,y=0,v={},m=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},_=function(e){m.call(e.data)};f&&h||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++y]=function(){s("function"==typeof e?e:Function(e),t)},n(y),y},h=function(e){delete v[e]},"process"==r(8)(d)?n=function(e){d.nextTick(a(m,e,1))}:g&&g.now?n=function(e){g.now(a(m,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",_,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,r){var n=r(6);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t,r){e.exports=r(23)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),r(24);var n,i=(n=r(48))&&n.__esModule?n:{default:n};t.default={url:i.default},e.exports=t.default},function(e,t,r){var n,i,o,a,s=r(10),u=r(0),c=r(5),l=r(11),d=r(25),f=r(4),h=r(6),p=r(30),g=r(31),y=r(37),v=r(20).set,m=r(40)(),_=r(21),b=r(41),A=r(42),E=r(43),S=u.TypeError,T=u.process,$=T&&T.versions,w=$&&$.v8||"",C=u.Promise,I="process"==l(T),k=function(){},O=i=_.f,P=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(1)("species")]=function(e){e(k,k)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==w.indexOf("6.6")&&-1===A.indexOf("Chrome/66")}catch(n){}}(),R=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},x=function(e,t){if(!e._n){e._n=!0;var r=e._c;m((function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&N(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(S("Promise-chain cycle")):(o=R(r))?o.call(r,u,c):u(r)):c(n)}catch(d){l&&!a&&l.exit(),c(d)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){v.call(u,(function(){var t,r,n,i=e._v,o=L(e);if(o&&(t=b((function(){I?T.emit("unhandledRejection",i,e):(r=u.onunhandledrejection)?r({promise:e,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=I||L(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){v.call(u,(function(){var t;I?T.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},M=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},B=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(r=R(t))?m((function(){var i={_w:n,_d:!1};try{r.call(t,c(e,i,1),c(M,i,1))}catch(o){M.call(i,o)}})):(n._v=t,n._s=1,x(n,!1))}catch(i){M.call({_w:n,_d:!1},i)}}};P||(C=function(e){p(this,C,"Promise","_h"),h(e),n.call(this);try{e(c(B,this,1),c(M,this,1))}catch(t){M.call(this,t)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(C.prototype,{then:function(e,t){var r=O(y(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=I?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&x(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=c(B,e,1),this.reject=c(M,e,1)},_.f=O=function(e){return e===C||e===a?new o(e):i(e)}),d(d.G+d.W+d.F*!P,{Promise:C}),r(45)(C,"Promise"),r(46)("Promise"),a=r(2).Promise,d(d.S+d.F*!P,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!P),"Promise",{resolve:function(e){return E(s&&this===a?C:this,e)}}),d(d.S+d.F*!(P&&r(47)((function(e){C.all(e).catch(k)}))),"Promise",{all:function(e){var t=this,r=O(t),n=r.resolve,i=r.reject,o=b((function(){var r=[],o=0,a=1;g(e,!1,(function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,r[s]=e,--a||n(r))}),i)})),--a||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=O(t),n=r.reject,i=b((function(){g(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},function(e,t,r){var n=r(0),i=r(2),o=r(14),a=r(17),s=r(5),u=function e(t,r,u){var c,l,d,f,h=t&e.F,p=t&e.G,g=t&e.P,y=t&e.B,v=p?n:t&e.S?n[r]||(n[r]={}):(n[r]||{}).prototype,m=p?i:i[r]||(i[r]={}),_=m.prototype||(m.prototype={});for(c in p&&(u=r),u)d=((l=!h&&v&&void 0!==v[c])?v:u)[c],f=y&&l?s(d,n):g&&"function"==typeof d?s(Function.call,d):d,v&&a(v,c,d,t&e.U),m[c]!=d&&o(m,c,f),g&&_[c]!=d&&(_[c]=d)};n.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,r){e.exports=!r(7)&&!r(15)((function(){return 7!=Object.defineProperty(r(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(4);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){e.exports=r(12)("native-function-to-string",Function.toString)},function(e,t,r){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(5),i=r(32),o=r(33),a=r(3),s=r(34),u=r(36),c={},l={},d=e.exports=function(e,t,r,d,f){var h,p,g,y,v=f?function(){return e}:u(e),m=n(r,d,t?2:1),_=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(h=s(e.length);h>_;_++)if((y=t?m(a(p=e[_])[0],p[1]):m(e[_]))===c||y===l)return y}else for(g=v.call(e);!(p=g.next()).done;)if((y=i(g,m,p.value,t))===c||y===l)return y};d.BREAK=c,d.RETURN=l},function(e,t,r){var n=r(3);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(a){var o=e.return;throw void 0!==o&&n(o.call(e)),a}}},function(e,t,r){var n=r(19),i=r(1)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(35),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,r){var n=r(11),i=r(1)("iterator"),o=r(19);e.exports=r(2).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(3),i=r(6),o=r(1)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[o])?t:i(r)}},function(e,t,r){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(0).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(0),i=r(20).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,u="process"==r(8)(a);e.exports=function(){var e,t,r,c=function(){var n,i;for(u&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(o){throw e?r():t=void 0,o}}t=void 0,n&&n.enter()};if(u)r=function(){a.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);r=function(){l.then(c)}}else r=function(){i.call(n,c)};else{var d=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),r=function(){f.data=d=!d}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){e.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},function(e,t,r){var n=r(0).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){var n=r(3),i=r(4),o=r(21);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){var n=r(17);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(9).f,i=r(18),o=r(1)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(0),i=r(9),o=r(7),a=r(1)("species");e.exports=function(e){var t=n[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(1)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(s){}return r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)};t.default=function(e,t,r){if(e&&t){var i=void 0;try{i=(0,o.getUri)(e,t,r)}catch(s){return Promise.reject(s.message)}return new a.default({type:"json",method:"GET",url:i}).then((function(e){return e&&e.response?"string"==typeof e.response?JSON.parse(e.response).Result:"object"===n(e.response)?e.response.Result:e.response:e}))}return Promise.reject("vid, host and token can't be empty")};var i,o=r(49),a=(i=r(51))&&i.__esModule?i:{default:i};e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUri=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{e=JSON.parse((0,n.decode)(e))}catch(s){throw new Error("base64 decode error: "+s.message)}var i=[];for(var o in r)i.push(o+"="+r[o]);var a=(/^http/.test(t)?t:"//"+t)+"?"+e.GetPlayInfoToken+"&ssl=true";return i.length>0&&(a+="&"+i.join("&")),a};var n=r(50)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(e){var t,r,n,i,o,a,s,u=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(a=e.length,o=0,s="";o<a;){do{t=u[255&e.charCodeAt(o++)]}while(o<a&&-1===t);if(-1===t)break;do{r=u[255&e.charCodeAt(o++)]}while(o<a&&-1===r);if(-1===r)break;s+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(o++)))return s;n=u[n]}while(o<a&&-1===n);if(-1===n)break;s+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(i=255&e.charCodeAt(o++)))return s;i=u[i]}while(o<a&&-1===i);if(-1===i)break;s+=String.fromCharCode((3&n)<<6|i)}return s}},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,i=t.method,o=void 0===i?"GET":i,a=(t.type,t.data),s=void 0===a?{}:a,u=t.headers,c=void 0===u?{}:u;return n(this,e),new Promise((function(e,t){var n=new window.XMLHttpRequest,i=o.toUpperCase(),a=[];for(var u in s)a.push(u+"="+s[u]);if("GET"!==i)throw new Error("xhr "+i+" is not supported");for(var l in n.open(i,""+r,!0),n.responseType="",c)n.setRequestHeader(l,""+c[l]);n.send(),n.onload=function(){200===n.status||206===n.status?e(n):t(n)},n.onerror=function(){t(n)},n.ontimeout=function(){t(n)}}))},e.exports=t.default}]);function wB(e,t){return CB.apply(this,arguments)}function CB(){return(CB=n(t().mark((function e(r,n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){$B.url(r,n).then((function(t){var r=[],n=t.Data||t;n&&n.PlayInfoList&&n.PlayInfoList.length>0?(r=n.PlayInfoList,e({videoList:r,rawData:t})):(console.error("HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHECK THE TOKEN."),e({videoList:[],rawData:t}))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function IB(e){if(e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var t=0;e.every((function(r,n){return e[0].Bitrate===r.Bitrate&&(t=n,!0)})),t>0&&e.splice(t)}return e}function kB(e,t,r){if(r||(r=[]),e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var n=0;e.every((function(t,r){return e[0].Bitrate===t.Bitrate&&(n=r,!0)})),n>0&&e.splice(n)}e.map((function(e){var t,n,i={name:e.Definition||"标清",definition:e.Definition,url:e.MainPlayUrl||e.src,backupUrl:e.BackupPlayUrl,bitrate:e.Bitrate,size:e.size},o=function(e){for(var t=0;t<r.length;t++)if(e.Definition.toLocaleLowerCase()===r[t].definition.toLocaleLowerCase())return t;return-1}(e);return o>=0?(t=i,(n=r[o])||(n=t),Object.keys(t).map((function(e){n[e]=t[e]}))):r.push(i),{name:e.Definition||"标清",text:e.Definition,definition:e.Definition,url:e.MainPlayUrl||e.src,backupUrl:e.BackupPlayUrl,bitrate:e.Bitrate,size:e.size,selected:!1}}));var i=-1;if(t)for(var o=0;o<e.length;o++)e[o].Definition.toLocaleLowerCase()===t.toLocaleLowerCase()&&(i=o);return i<0&&(i=0),r[i]&&(r[i].selected=!0),{index:i,list:r}}var OB,PB={getBrowserVersion:function(){var e=navigator.userAgent;if(e.toLowerCase().indexOf("mobile")>-1)return"Unknown";if(e.indexOf("Firefox")>-1)return"Firefox "+e.match(/firefox\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Edge")>-1)return"Edge "+e.match(/edge\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("rv:11")>-1)return"IE 11";if(e.indexOf("Opera")>-1||e.indexOf("OPR")>-1){if(e.indexOf("Opera")>-1)return"Opera "+e.match(/opera\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("OPR")>-1)return"Opera "+e.match(/opr\/[\d.]+/gi)[0].match(/[\d]+/)[0]}else{if(e.indexOf("Chrome")>-1)return"Chrome "+e.match(/chrome\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Safari")>-1)return"Safari "+e.match(/safari\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(!(e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1))return"Unknown";if(e.indexOf("MSIE")>-1)return"IE "+e.match(/msie [\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Trident")>-1){var t=e.match(/trident\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"IE "+(parseInt(t)+4)}}},parseUrl:function(e){var t=e.split("?")[1],r={};return t&&t.split("&").forEach((function(e){e=e.split("="),r[e[0]]=decodeURIComponent(e[1])})),r},isBase64:function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)},isRelativeURL:function(e){return!/^(?:[a-z]+:)?\/\//.test(e)},getAbsoluteURL:function(e){var t=new Image;return t.src=e,t.src},checkMediaSourceSupport:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported},offInDestroy:function(e,t,r,n){e.once(n,(function i(){e.off(t,r),e.off(n,i)}))},on:function(e,t,r,n){n?(e.on(t,r),PB.offInDestroy(e,t,r,n)):e.on(t,(function n(i){r(i),e.off(t,n)}))},once:function(e,t,r,n){n?(e.once(t,r),PB.offInDestroy(e,t,r,n)):e.once(t,(function n(i){r(i),e.off(t,n)}))},isMobile:function(){var e=!1;return navigator.userAgent.toLocaleLowerCase().indexOf("ipad")>-1?(navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform||!PB.checkMediaSourceSupport())&&(e=!0):navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform&&!PB.checkMediaSourceSupport()&&(e=!0),e}},RB=function(){function e(){this.timeID=null,this.func=null}var t=e.prototype;return t.repeat=function(e,t){var r=this;null===this.func&&(this.func=e),this.func===e&&(this.timeID=setTimeout((function(){e(),r.repeat(e,t)}),t))},t.clear=function(){clearTimeout(this.timeID)},e}(),xB=Ut.f,DB=m,LB=g,NB=L,MB=ni,BB=DE,UB=ir,jB=cn.f,FB=ae,VB=aC,GB=Yc,HB=Ew,KB=al,zB=function(e,t,r){r in e||xB(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},WB=un,YB=v,XB=Ze,ZB=Hr.enforce,qB=Bo,QB=Dl,JB=Ml,eU=ft("match"),tU=LB.RegExp,rU=tU.prototype,nU=LB.SyntaxError,iU=NB(rU.exec),oU=NB("".charAt),aU=NB("".replace),sU=NB("".indexOf),uU=NB("".slice),cU=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,lU=/a/g,dU=/a/g,fU=new tU(lU)!==lU,hU=KB.MISSED_STICKY,pU=KB.UNSUPPORTED_Y,gU=DB&&(!fU||hU||QB||JB||YB((function(){return dU[eU]=!1,tU(lU)!=lU||tU(dU)==dU||"/a/i"!=tU(lU,"i")})));if(MB("RegExp",gU)){for(var yU=function e(t,r){var n,i,o,a,s,u,c=FB(rU,this),l=VB(t),d=void 0===r,f=[],h=t;if(!c&&l&&d&&t.constructor===e)return t;if((l||FB(rU,t))&&(t=t.source,d&&(r=HB(h))),t=void 0===t?"":GB(t),r=void 0===r?"":GB(r),h=t,QB&&"dotAll"in lU&&(i=!!r&&sU(r,"s")>-1)&&(r=aU(r,/s/g,"")),n=r,hU&&"sticky"in lU&&(o=!!r&&sU(r,"y")>-1)&&pU&&(r=aU(r,/y/g,"")),JB&&(t=(a=function(e){for(var t,r=e.length,n=0,i="",o=[],a={},s=!1,u=!1,c=0,l="";n<=r;n++){if("\\"===(t=oU(e,n)))t+=oU(e,++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:iU(cU,uU(e,n+1))&&(n+=2,u=!0),i+=t,c++;continue;case">"===t&&u:if(""===l||XB(a,l))throw new nU("Invalid capture group name");a[l]=!0,o[o.length]=[l,c],u=!1,l="";continue}u?l+=t:i+=t}return[i,o]}(t))[0],f=a[1]),s=BB(tU(t,r),c?this:rU,e),(i||o||f.length)&&(u=ZB(s),i&&(u.dotAll=!0,u.raw=e(function(e){for(var t,r=e.length,n=0,i="",o=!1;n<=r;n++)"\\"!==(t=oU(e,n))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+oU(e,++n);return i}(t),n)),o&&(u.sticky=!0),f.length&&(u.groups=f)),t!==h)try{UB(s,"source",""===h?"(?:)":h)}catch(EU){}return s},vU=jB(tU),mU=0;vU.length>mU;)zB(yU,tU,vU[mU++]);rU.constructor=yU,yU.prototype=rU,WB(LB,"RegExp",yU,{constructor:!0})}qB("RegExp"),function(e,t,r){function n(e,t){var r=parseInt(e.slice(t,t+2),16);return r>>>7==0?[1,r]:r>>>6==2?(r=(63&r)<<8,[2,r+=parseInt(e.slice(t+2,t+4),16)]):(r=(63&r)<<16,[3,r+=parseInt(e.slice(t+2,t+6),16)])}var i,o=0,a=[],s=[],u=parseInt(e.slice(0,8),16),c=parseInt(e.slice(8,16),16);if(1213091658!==u||1077891651!==c)throw new Error("mhe");if(0!==parseInt(e.slice(16,18),16))throw new Error("ve");for(i=0;i<4;++i)o+=(3&parseInt(e.slice(24+2*i,26+2*i),16))<<2*i;var l=parseInt(e.slice(32,40),16),d=2*parseInt(e.slice(48,56),16);for(i=56;i<d+56;i+=2)a.push(parseInt(e.slice(i,i+2),16));var f=d+56,h=parseInt(e.slice(f,f+4),16);for(f+=4,i=0;i<h;++i){var p=n(e,f);f+=2*p[0];for(var g="",y=0;y<p[1];++y){var v=n(e,f);g+=String.fromCharCode(o^v[1]),f+=2*v[0]}s.push(g)}t.p=null,function e(t,r,n,i,o){var u,c,l,d,f,h=-1,p=[],g=null,y=[r];for(c=Math.min(r.length,n),l=0;l<c;++l)y.push(r[l]);y.p=i;for(var v=[];;)try{var m=a[t++];if(m<37)if(m<8)m<2?p[++h]=0===m:m<5?p[++h]=null:5===m?(u=((u=((u=a[t++])<<8)+a[t++])<<8)+a[t++],p[++h]=(u<<8)+a[t++]):(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=s[u]);else if(m<18)if(8===m)p[++h]=void 0;else{for(c=a[t++],l=a[t++],d=y;c>0;--c)d=d.p;p[++h]=d[l]}else if(m<20)u=(a[t]<<8)+a[t+1],t+=2,c=s[u],p[h]=p[h][c];else if(20===m){for(c=a[t++],l=a[t++],d=y;c>0;--c)d=d.p;d[l]=p[h--]}else c=p[h--],p[h]+=c;else if(m<67)if(m<58)37===m?(c=p[h--],p[h]=p[h]===c):(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,p[h]?--h:t+=u);else if(m<59)p[h]=_typeof$3(p[h]);else if(59===m)u=a[t++],c=p[h--],(l=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)})._v=[c,u,y],l._u=e,p[++h]=l;else{for(c=p[h--],l=null;d=v.pop();)if(2===d[0]||3===d[0]){l=d;break}if(l)t=l[2],l[0]=0,v.push(l);else{if(!g)return c;t=g[1],o=g[2],y=g[3],v=g[4],p[++h]=c,g=g[0]}}else if(m<69)if(67===m)h-=u=a[t++],l=p.slice(h+1,h+u+1),c=p[h--],d=p[h--],c._u===e?(c=c._v,g=[g,t,o,y,v],t=c[0],null==d&&(d=function(){return this}()),o=d,(y=[l].concat(l)).length=Math.min(c[1],u)+1,y.p=c[2],v=[]):p[++h]=c.apply(d,l);else{for(u=a[t++],d=[void 0],f=u;f>0;--f)d[f]=p[h--];l=p[h--],c=Function.bind.apply(l,d),p[++h]=new c}else m<71?t+=2+(u=(u=(a[t]<<8)+a[t+1])<<16>>16):71===m?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=p[h--])||(t+=u)):(c=p[h],p[++h]=c)}catch(_){for(;(u=v.pop())&&!u[0];);if(!u){e:for(;g;){for(c=g[4];u=c.pop();)if(u[0])break e;g=g[0]}if(!g)throw _;t=g[1],o=g[2],y=g[3],v=g[4],g=g[0]}1===(c=u[0])?(t=u[2],u[0]=0,v.push(u),p[++h]=_):2===c?(t=u[2],u[0]=0,v.push(u)):(t=u[3],u[0]=2,v.push(u),p[++h]=_)}}(l,[],0,t,r)}("484e4f4a403f52430031142852d42249000000a9c0ecc79d000000cd001400021102024a12000211000143014700191100014a12000305000000993b021100024302140002450069021102030700040211020411010143014a120005110203070006070007440207000843024a120005110203070009070007440207000a43021807000b1843011400031100013a07000c254700181100034a12000d1101024a12000e1100014301430145000101140002110002421100013300090211030511000243014205000000003b011401051101001200001200011400011101011200001200011400020842000f0912100d160d161b120708160d3116100b0c05070b11231010031b06100706170107013c071007120e03010714394c48495d3c46191f4a4b1e393e3f3e4d3e3e3f0105033e46442f160d3116100b0c051e4a04170c01160b0d0c4b4c485d4a5d5f3e3e3e4a4b1e42040d10424c495d4a5d5f3e3e3e3f4b0546534c485d01460804170c01160b0d0c04160711160401030e0e",{0:Object,1:Function,2:Array,3:RegExp,4:String,get 5(){return OB},set 5(e){OB=e}},globalThis);var _U=function(e){var t=e.url,r=e.method,n=void 0===r?"GET":r,i=e.type,o=e.timeout,a=void 0===o?1e4:o,s=e.data,u=void 0===s?{}:s,c=e.xhrSetup,l=e.cache,d=void 0===l||l;return new Promise((function(e,r){var o=new window.XMLHttpRequest,s=n.toUpperCase(),l=[];if("GET"!==s&&"POST"!==s)throw new Error("XHR "+s+" is not allowed");for(var f in i&&(o.responseType=i),a&&(o.timeout=a),u)Object.prototype.hasOwnProperty(u,f)&&l.push("k="+u[f]);if(o.onload=function(){200===o.status||206===o.status?e(o):r(o)},o.onerror=function(){r(o)},o.ontimeout=function(){r(o)},o.onabort=function(){r(o)},"GET"===s&&!d){var h=/\?/gi.test(t)?"&":"?";t+=h+"_="+(new Date).getTime()}if(o.open(s,""+t,!0),c)try{c(o,t)}catch(p){console.error("xhr setup failure: "+(p.stack||p.message))}switch(s){case"POST":o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(l.join("&"));break;case"GET":o.send()}}))};function bU(e,t,r){function n(e,t){var r=parseInt(e.slice(t,t+2),16);return r>>>7==0?[1,r]:r>>>6==2?(r=(63&r)<<8,[2,r+=parseInt(e.slice(t+2,t+4),16)]):(r=(63&r)<<16,[3,r+=parseInt(e.slice(t+2,t+6),16)])}var i,o=0,a=[],s=[],u=parseInt(e.slice(0,8),16),c=parseInt(e.slice(8,16),16);if(1213091658!==u||1077891651!==c)throw new Error("mhe");if(0!==parseInt(e.slice(16,18),16))throw new Error("ve");for(i=0;i<4;++i)o+=(3&parseInt(e.slice(24+2*i,26+2*i),16))<<2*i;var l=parseInt(e.slice(32,40),16),d=2*parseInt(e.slice(48,56),16);for(i=56;i<d+56;i+=2)a.push(parseInt(e.slice(i,i+2),16));var f=d+56,h=parseInt(e.slice(f,f+4),16);for(f+=4,i=0;i<h;++i){var p=n(e,f);f+=2*p[0];for(var g="",y=0;y<p[1];++y){var v=n(e,f);g+=String.fromCharCode(o^v[1]),f+=2*v[0]}s.push(g)}return t.p=null,function e(t,r,n,i,o){var u,c,l,d,f,h=-1,p=[],g=[0,null],y=null,v=[r];for(c=Math.min(r.length,n),l=0;l<c;++l)v.push(r[l]);v.p=i;for(var m=[];;)try{var _=a[t++];if(_<37)if(_<12)_<4?_<2?p[++h]=0===_:2===_?p[++h]=null:(u=a[t++],p[++h]=u<<24>>24):_<7?4===_?(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=u<<16>>16):(u=((u=((u=a[t++])<<8)+a[t++])<<8)+a[t++],p[++h]=(u<<8)+a[t++]):_<8?(u=(a[t]<<8)+a[t+1],t+=2,p[++h]=s[u]):p[++h]=8===_?void 0:o;else if(_<18)if(_<14)12===_?(u=(a[t]<<8)+a[t+1],t+=2,h=h-u+1,c=p.slice(h,h+u),p[h]=c):p[++h]={};else if(14===_)u=(a[t]<<8)+a[t+1],t+=2,c=s[u],l=p[h--],p[h][c]=l;else{for(c=a[t++],l=a[t++],d=v;c>0;--c)d=d.p;p[++h]=d[l]}else if(_<20)18===_?(u=(a[t]<<8)+a[t+1],t+=2,c=s[u],p[h]=p[h][c]):(c=p[h--],p[h]=p[h][c]);else if(_<21){for(c=a[t++],l=a[t++],d=v;c>0;--c)d=d.p;d[l]=p[h--]}else 21===_?(u=(a[t]<<8)+a[t+1],t+=2,c=s[u],l=p[h--],d=p[h--],l[c]=d):(c=p[h--],p[h]+=c);else if(_<62)_<51?_<41?37===_?(c=p[h--],p[h]=p[h]===c):(c=p[h--],p[h]=p[h]!==c):41===_?(c=p[h--],p[h]=p[h]>c):p[h]=!p[h]:_<59?51===_?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,p[h]?--h:t+=u):(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,p[h]?t+=u:--h):_<60?(u=a[t++],c=p[h--],(l=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)})._v=[c,u,v],l._u=e,p[++h]=l):60===_?(u=a[t++],c=p[h--],(d=[l=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)}]).p=v,l._v=[c,u,d],l._u=e,p[++h]=l):(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=m[m.length-1])[1]=t+u);else if(_<68)if(_<66)if(62===_)u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=m[m.length-1])&&!c[1]?(c[0]=3,c.push(t)):m.push([1,0,t]),t+=u;else if(l=(c=m.pop())[0],d=g[0],1===l)t=c[1];else if(0===l)if(0===d)t=c[1];else{if(1!==d)throw g[1];if(!y)return g[1];t=y[1],o=y[2],v=y[3],m=y[4],p[++h]=g[1],g=[0,null],y=y[0]}else t=c[2],c[0]=0,m.push(c);else if(66===_){for(c=p[h--],l=null;d=m.pop();)if(2===d[0]||3===d[0]){l=d;break}if(l)g=[1,c],t=l[2],l[0]=0,m.push(l);else{if(!y)return c;t=y[1],o=y[2],v=y[3],m=y[4],p[++h]=c,g=[0,null],y=y[0]}}else h-=u=a[t++],l=p.slice(h+1,h+u+1),c=p[h--],d=p[h--],c._u===e?(c=c._v,y=[y,t,o,v,m],t=c[0],null==d&&(d=function(){return this}()),o=d,(v=[l].concat(l)).length=Math.min(c[1],u)+1,v.p=c[2],m=[]):p[++h]=c.apply(d,l);else if(_<71)if(68===_){for(u=a[t++],d=[void 0],f=u;f>0;--f)d[f]=p[h--];l=p[h--],c=Function.bind.apply(l,d),p[++h]=new c}else t+=2+(u=(u=(a[t]<<8)+a[t+1])<<16>>16);else _<73?(u=(u=(a[t]<<8)+a[t+1])<<16>>16,t+=2,(c=p[h--])||(t+=u)):73===_?--h:(c=p[h],p[++h]=c)}catch(b){for(g=[0,null];(u=m.pop())&&!u[0];);if(!u){e:for(;y;){for(c=y[4];u=c.pop();)if(u[0])break e;y=y[0]}if(!y)throw b;t=y[1],o=y[2],v=y[3],m=y[4],y=y[0]}1===(c=u[0])?(t=u[2],u[0]=0,m.push(u),p[++h]=b):2===c?(t=u[2],u[0]=0,m.push(u),g=[3,b]):(t=u[3],u[0]=2,m.push(u),p[++h]=b)}}(l,[],0,t,r)}var AU=function(r){function i(){for(var i,o,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return(i=r.call.apply(r,[this].concat(s))||this)._onSwitchURL=(o=n(t().mark((function r(n){var o,a,s,u;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=l(i),a=o.player,s=a.currentTime,u=a.paused,a.config.url=n,e.Util.addClass(a.root,"xgplayer-is-enter"),PB.once(a,"playing",(function(){e.Util.removeClass(a.root,"xgplayer-is-enter")})),PB.once(a,"canplay",(function(){a.currentTime=s,a.play()})),t.next=9,i._start(n);case 9:return t.abrupt("return",new Promise((function(t){var r=function(){a.currentTime=s,u?a.once("canplay",(function(){a.pause(),t()})):t()};PB.isMobile()&&(e.Sniffer.os.isAndroid?a.once("timeupdate",(function(){r()})):a.once("canplay",(function(){r()})),a.play())})));case 10:case"end":return t.stop()}}),r)}))),function(e){return o.apply(this,arguments)}),i}a(i,r);var s,u,c,d,f=i.prototype;return f.beforePlayerInit=function(){var e=this,t=this.config,n=this.player,i=n.config,o=PB.isMobile();this.__startInit=null,this.__playNext=null,this.onTimeupdate=this.onTimeupdate.bind(this),this.browser=PB.getBrowserVersion(),this.isNativeMode=!0,this._errReqCount=0,this._curDefinitionIndex=0,this.hls=null,this.getUrlTime=(new Date).getTime()/1e3,this.hlsOpts=t.hlsOpts||{},t.hlsLoadAsync=!1,i.hls||(i.hls={}),i.hls.fetchOptions||(i.hls.fetchOptions={}),o||void 0!==t.useHls&&!t.useHls||(this.isNativeMode=!1,this.register()),n.playNext=this.playNext.bind(this),this.isNativeMode||i.hls.decryptor||(i.hls.decryptor=new eC({enableSoftwareAES:this.hlsOpts.enableSoftwareAES})),t.netAllowCredentials&&(i.hls.fetchOptions.credentials="include"),t.checkHlsOffline&&PB.on(this,"timeupdate",this.onTimeupdate,"destroy"),this.hlsTimer=new RB,this.hlsTimer.repeat((function(){e.onRepeat()}),t.checkExpireInterval),this._proxyPlayerStartInit(),this._checkNativeCode()?r.prototype.beforePlayerInit.call(this):this.player.switchURL=this._onSwitchURL},f.destroy=function(){r.prototype.destroy.call(this),this.hlsTimer&&(this.hlsTimer.clear(),this.hlsTimer=null),this.player._startInit=this.__startInit,this.player.playNext=this.__playNext,this._playOriginalUrl=null},f.log=function(){var e;this.player.logInfo&&(e=this.player).logInfo.apply(e,arguments)},f._checkNativeCode=function(){var e=this.player,t=self.MediaSource||self.WebKitMediaSource,r=self.SourceBuffer,n=!1;if(t&&r){var i=[];r&&i.push(r),t&&i.push(t),OB(i)?n=!0:e.emit("error",{msg:"MediaSource or SourceBuffer hijack",errorCode:-9995})}return n},f._proxyPlayerStartInit=function(){var e=this;this.__startInit=this.player._startInit,this.__playNext=this.player.playNext,this.player._startInit=function(){e._start()}},f._start=(s=n(t().mark((function e(r){var n,i,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=null),r){e.next=8;break}return e.next=4,this._getRawManifestUrl();case 4:if((n=e.sent).url){e.next=7;break}throw new Error("no service url");case 7:r=n.url;case 8:return this._playOriginalUrl=this.player.config.url=r,e.next=11,this._getTransformManifestUrl(r);case 11:i=e.sent,o=this.player.config.url=i.url,this.isNativeMode||this.hls.load(o),this.__startInit.call(this.player,o);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)}),f._getRawManifestUrl=(u=n(t().mark((function e(){var r,n,i,o,a,s,u,c,l=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.config,n=this.playerConfig,i=r.vid,o=r.playAuthToken,a=r.playDomain,s=r.testUrl,u=r.testUrlExpire,c={url:r.url||n.url,playAuthToken:o,vid:i,playDomain:a,testUrl:s,testUrlExpire:u},e.abrupt("return",new Promise((function(e,t){c.url&&(/\.(mp3|m4a)/.test(c.url)||/(mp3|m4a)/.test(c.type))||c.url?(l.emit("can_start"),e({url:c.url})):(o||c.vid)&&l._playByToken(o,a,e,t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),f._playByToken=(c=n(t().mark((function e(r,n,i,o){var a,s,u,c,l,d,f,h,p,g,y,v;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.player,s=this.config,e.next=3,wB(r,n);case 3:u=e.sent,c=u.videoList,l=u.rawData,this.emit("get_play_info",l),c&&c.length>0&&(c[0].MainPlayUrl||c[0].src)?(IB(c),this.getUrlTime=(new Date).getTime()/1e3,d=a.config.definition||{},f=d.defaultDefinition||a.config.defaultDefinition,c[0].Format,c[0].UrlExpire&&(this.urlExpireTimestamp=s.testUrlExpire||c[0].UrlExpire),h=kB(c,f,d.list),this._curDefinitionIndex=h.index,p=h.list[h.index],g=p.url,a.emit("resourceReady",h.list),c[0]&&c[0].type&&/(mp3|m4a|mp4)/.test(c[0].type),this.emit("can_start"),i({url:g})):(y=l||{ResponseMetadata:{Error:{CodeN:0,Message:""},RequestId:""}},this.emit("playInterfaceInfo",{code:y.ResponseMetadata.Error.CodeN,message:y.ResponseMetadata.Error.Message,logid:y.ResponseMetadata.RequestId}),v={msg:"HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHECK THE TOKEN.",errorCode:-9998},this.emit("error",v),o(v));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return c.apply(this,arguments)}),f._getTransformManifestUrl=(d=n(t().mark((function e(r){var n=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){n._loadSource(r,(function(t){if(t.length)e({url:t});else{var r=new FileReader;r.onload=function(){e({url:r.result})},r.readAsDataURL(t)}}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),f.playNext=function(t){var r=this,n=this.player,i=n.paused;n.pause(),n.hasStart=!1,n._startInit=this.__startInit,n.playNext=this.__playNext,Object.keys(t).map((function(n){n.toLocaleLowerCase()===r.pluginName.toLocaleLowerCase()?"Object"===e.Util.typeOf(t[n])&&Object.keys(t[n]).map((function(e){r.config[e]=t[n][e]})):r.playerConfig[n]=t[n]})),t.url||(this.playerConfig.url=null),this._errReqCount=0,this._curDefinitionIndex=0,this.getUrlTime=(new Date).getTime()/1e3,this.playerConfig.autoplay="boolean"==typeof t.autoplay?t.autoplay:!i,this._start(null)},f._processRetData=function(e,t,r,n){if(e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var i=0;e.every((function(t,r){return e[0].Bitrate===t.Bitrate&&(i=r,!0)})),i>0&&e.splice(i)}},f.onTimeupdate=function(){this.hls&&this.player.video&&!this.player.video.videoHeight?(this.hls.hlsOfflineCount=void 0===this.hls.hlsOfflineCount?1:this.hls.hlsOfflineCount+1,this.hls.hlsOfflineCount>3&&(this.pause(),this.emit("error",{msg:"OFFLINE",errorCode:-9997}),this.onError())):this.hls&&(this.hls.hlsOfflineCount=0)},f.onRepeat=function(){var e=this,t=this.config,r=this.player;t.expireDetectType.indexOf("getUrlTime")>-1&&this.getUrlTime&&r.duration&&(new Date).getTime()/1e3>this.getUrlTime+3300+r.duration&&(this.getUrlTime=0,this.emitExpireEvent()),t.expireDetectType.indexOf("xhrStatus")>-1&&this._playOriginalUrl&&Math.random()<1/7.5&&new _U({url:this._playOriginalUrl,xhrSetup:function(e,r){t.netAllowCredentials&&(e.withCredentials=!0)}}).catch((function(t){t&&void 0!==t.status&&(e.hls.hlsExpireCount=void 0===e.hls.hlsExpireCount?1:e.hls.hlsExpireCount+1,e.hls.hlsExpireCount>3&&(e.hls.hlsExpireCount=0,e.emitExpireEvent()))})),t.expireDetectType.indexOf("urlExpire")>-1&&this.urlExpireTimestamp&&(new Date).getTime()/1e3>=this.urlExpireTimestamp&&(this.urlExpireTimestamp=5e9,this.emitExpireEvent())},f.emitExpireEvent=function(){var e=this.player,t=(new Date).getTime()/1e3;e.emitExpireTimestamp?t-e.emitExpireTimestamp>300&&(e.emitExpireTimestamp=t,e.emit("MEDIA_EXPIRED")):(e.emitExpireTimestamp=t,e.emit("MEDIA_EXPIRED"))},f._updateM3U8=function e(t,r,n){return bU("484e4f4a403f5243001b0717f641e99d00000045ad3081810000022e11020a07001b44014a12001c11000443014700131100021100031807001d18110004184245001c1100021100031807001d181102054a12001e1101071100044302184208420b1200001400010b1200011200020700032647000f1101014a12000411010743011401073e004014000c11010112000534000611010112000634000611010112000714000311000344001400021100024a1200081101074301491100024a1200094300140002413d00161101021101070c00010d07000a0e000b4402140002411101034a12000c11000243011400041101084a12000d11010a07000e440107000f110004180700101843021401081101044a12001111000112000112001243014700151101044a12001311000112000112001243014500091100011200011200121400051100054a12001411010a070015440143013400030c000014000611000547001f11000612001603012947000d110006030113070017184500030700184500030700181400071101084a12000d11010a07001907001a440205000000003b0443021401083e004014000d11010112000534000611010112000634000611010112000714000911000944001400081100084a1200081101084301491100084a1200094300140008413d00161101021101080c00010d07001f0e000b4402140008411101044a120020430014000a11000a4700131101093300090211010911000843014945001f1101034a12000c110008430114000b1101093300090211010911000b4301490842002106263a372f332406353938303f310a3133221d332f022f26330302190604372239340b143a393414233f3a323324110133341d3f22143a393414233f3a3233240e1b392c143a393414233f3a3233240637262633383207313322143a39340922332e22793e223b3a04222f26330f35243337223319343c33352203041a072433263a3735330e7a03041f6b747e0d08740b7d7f74067a03041f6b7401740d3f2504333a37223f203303041a0323243a0e313322173425393a23223303041a053b3722353e207e7e3e2222262a3e222226257f6c690a790a79787d7f0a790a217d0a780a217d063a333831223e0179003a7e75130e021f18106c7f7e0a327d0a78690a327c7f7e696c7a7e696c0d080a242a0a380b7c7f7e696c0a242a0a387f7c7f7e787c7e6977757f7f0131147e3e2222262a3e222226257f690a6c690a790a790422332522027a5c1034233f3a32173425393a23223303041a153726263a3f3537223f3938792e7b3b26333103041a083f251b39343f3a33",{get 0(){return e},get 1(){return window},get 2(){return Blob},get 3(){return URL},get 4(){return PB},get 5(){return BC},6:arguments,7:t,8:r,9:n,10:RegExp},this)},f._loadSource=function e(t,r){return bU("484e4f4a403f5243000c1f081b2e9ba50000034abf1ccd6d000003961102031200044700070011000115000508421100011200081400021100024a12000911020c07000a440143014700d41100024a12000911020c07000b440143010301131400031102024a12000c110003430114000411000433000611000412000d47008e11010312000e07000f254700561102024a12001011010312001143014700121102034a12001211010312001143014500061101031200111400050700131101031200143400030700151807001618110005180700171811000412000d1814000345002b1101031200183400030700150700191811000412000d1807001a18110103120011340003070015181400030d1100030e001b1100020e001c4245001611020b33000f0211020b11010212000112000343014908421100013234000711000112001b32470002084211000112001b14000211000112001c14000305000002183c0114000411010112000112001133002511010112000112000e07000f2547000c110101120001120014450009110101120001120018470073110101120026070027264700341102010d1100020e00030700280e0029010e002a44014a12000705000003063b0143014a12002b05000003123b0143014945002f11020844001400051100054a12002d07002e1100024302491100054a12002f43004905000003243b001100051500314500251101011200011200324700191101014a12002511010112000112003211000311020b43034908423e00351400090d1104024a120010110001120008430147000911000112000845000f1104034a12001d11000112000843010e001e140002413d009b1104044a12001f110001120008430114000211030112000112000e07000f2547001211000212002012002111000215001e45006611030447004b11000212001e14000302110405110003430114000411000412002214000511000412002314000611000412002414000702110406110005110006110007430314000811000811000215001e1104034a12001d11000212001e430111000215001e411103014a12002511000212001e11020311040b43034908420211010411000143014908421103074a12002c07002c11000143024908421101051200300400c82534000a1101051200300400ce2547000a0211010411010543014908420b1400010b1200001400020b1200011400030b1200021400041101010d11010a0e000305000000003c010e000644014a12000705000000123b0143014a120007050000011b3b0143014908420033060b171a021e09061814151d121c0c1208351a0f120d1e36141f1e030e091713151e0f3a1717140c38091e1f1e150f121a17080f0c120f1338091e1f1e150f121a170808031309281e0f0e0b040f131e150c091e080b1415081e2f1e030f05161a0f181315583e232f562356303e224153270c5046270c5052500e572e293246595320255926505259080b1a09081e2e0917021a100a1c1e0f301e022f020b1e032f342b081208391a081e4d4f08101e022f14101e15041a0f14190254540a0b171a023f14161a1215000144125d28140e09181e46111a090d12085d3a104609101e023f14161a12152254101f08541a0b12540d4854101e02084408140e09181e46111a090d12085d1a1046075d0f14101e154606101e022e091703180f0304190f141a041f1a0f1a050b1a09081e06291e080e170f09281e18091e0f301e02071e15183f1a0f1a03101e0202120d0b240e0b1f1a0f1e36482e43071909140c081e0905323e5b4a4a040f1e030f040f020b1e05181a18131e05181a0f1813051e0909140904140b1e15031c1e0f04081e151f06080f1a0f0e0806141517141a1f08101e022d1a170e1e",{get 0(){return e},get 1(){return _U},get 2(){return PB},get 3(){return window},4:JSON,get 5(){return rC},get 6(){return tC},get 7(){return console},get 8(){return XMLHttpRequest},9:arguments,10:t,11:r,12:RegExp},this)},f.register=function(){var e=this.player;e.once("playing",(function(){var t=!1,r=e.video.querySelector("track");r&&("hidden"===r.track.mode&&(t=!0),r.track.mode="hidden",e.video.removeChild(r)),e.config.textTrack&&e.config.textTrack.length>0&&e.config.textTrack.some((function(r){if(r.src&&r.label&&r.default){var n=document.createElement("track");return n.src=r.src,n.kind=r.kind,n.label=r.label,n.srclang=r.srclang,n.default=!0,e.video.appendChild(n),t&&(n.track.mode="hidden"),!0}}))}))},o(i,[{key:"versionNum",get:function(){return this.version&&this.version[0]&&parseInt(this.version[0])}}],[{key:"pluginName",get:function(){return"EncryptHlsPlugin"}},{key:"defaultConfig",get:function(){return{expireDetectType:[],hlsOpts:{},checkExpireInterval:400,type:"",playAuthToken:"",vid:"",checkHlsOffline:!1}}},{key:"version",get:function(){return"4.0.0"}}]),i}(TB);return AU.isSupported=function(e){e=e||navigator.userAgent.toLocaleLowerCase();var t=/(iphone)/.test(e)||/(ipad)/.test(e),r=/(android)/.test(e),n=/(windows phone)/.test(e),i=!(t||r||n),o=/(quark)/.test(e);return i||r?!(!window.MediaSource||!window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')):!!t&&!o&&!(e.indexOf("iphone os 11_4")>-1||e.indexOf("iphone os 11_2")>-1)},AU}(require$$0)}(index_min$1);var EncryptHlsPlugin=getDefaultExportFromCjs(index_min$1.exports),lib={},parser$1={},grammar$2={exports:{}},grammar$1=grammar$2.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(grammar$1).forEach((function(e){grammar$1[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))})),function(e){var t=function(e){return String(Number(e))===e?Number(e):e},r=function(e,r,n){var i=e.name&&e.names;e.push&&!r[e.push]?r[e.push]=[]:i&&!r[e.name]&&(r[e.name]={});var o=e.push?{}:i?r[e.name]:r;!function(e,r,n,i){if(i&&!n)r[i]=t(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(r[n[o]]=t(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&r[e.push].push(o)},n=grammar$2.exports,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach((function(e){var t=e[0],i=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(n[t]||[]).length;s+=1){var u=n[t][s];if(u.reg.test(i))return r(u,a,i)}})),t.media=o,t};var o=function(e,r){var n=r.split(/=(.+)/,2);return 2===n.length?e[n[0]]=t(n[1]):1===n.length&&r.length>1&&(e[n[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var r=[],n=e.split(" ").map(t),i=0;i<n.length;i+=3)r.push({component:n[i],ip:n[i+1],port:n[i+2]});return r},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var r,n=!1;return"~"!==e[0]?r=t(e):(r=t(e.substring(1,e.length)),n=!0),{scid:r,paused:n}}))}))}}(parser$1);var grammar=grammar$2.exports,formatRegExp=/%[sdv%]/g,format=function(e){var t=1,r=arguments,n=r.length;return e.replace(formatRegExp,(function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},makeLine=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?n.push(r[t.name][o]):n.push(r[t.names[i]])}else n.push(r[t.name]);return format.apply(null,n)},defaultOuterOrder=["v","o","s","i","u","e","p","c","b","t","r","z","a"],defaultInnerOrder=["i","c","b","a"],writer$1=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||defaultOuterOrder,n=t.innerOrder||defaultInnerOrder,i=[];return r.forEach((function(t){grammar[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(makeLine(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(makeLine(t,r,e))}))}))})),e.media.forEach((function(e){i.push(makeLine("m",grammar.m[0],e)),n.forEach((function(t){grammar[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(makeLine(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(makeLine(t,r,e))}))}))}))})),i.join("\r\n")+"\r\n"},parser=parser$1,writer=writer$1;function ownKeys$2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$2(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function getOption(e){return _objectSpread$2({retryCount:0,retryDelay:1e3,loadTimeout:5e3,stallInterval:300},e)}function _getStatByType(e,t,r){var n;return t.forEach((function(t){t.type!==e||r&&t.kind!==r||(n=t)})),n}function _getStats(e){var t;return e.forEach((function(r){"stream"===r.type&&(t=r.trackIds.map((function(t){var r=e.get(t),n=_getStatByType("inbound-rtp",e,r.kind),i=e.get(null==n?void 0:n.codecId);return{type:r.kind,track:r,inboundRtp:n,codec:i,transport:_getStatByType("transport",e),localCandidate:_getStatByType("local-candidate",e),remoteCandidate:_getStatByType("remote-candidate",e)}})))})),t}function getStats(e){return new Promise((function(t){var r;null===(r=e.getStats(null,(function(e){t(_getStats(e))})))||void 0===r||r.then((function(e){t(_getStats(e))}))})).catch((function(e){}))}function ownKeys$1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper$d(e){var t=_isNativeReflectConstruct$d();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}lib.write=writer,lib.parse=parser.parse,lib.parseParams=parser.parseParams,lib.parseFmtpConfig=parser.parseFmtpConfig,lib.parsePayloads=parser.parsePayloads,lib.parseRemoteCandidates=parser.parseRemoteCandidates,lib.parseImageAttributes=parser.parseImageAttributes,lib.parseSimulcastStreamList=parser.parseSimulcastStreamList;var logger$1=new Logger$2("rts"),Rts=function(e){_inherits(n,e);var t,r=_createSuper$d(n);function n(e){var t;return _classCallCheck$1(this,n),_defineProperty$1(_assertThisInitialized(t=r.call(this)),"_url",""),_defineProperty$1(_assertThisInitialized(t),"_pc",null),_defineProperty$1(_assertThisInitialized(t),"_audioTransceicer",null),_defineProperty$1(_assertThisInitialized(t),"_videoTransceicer",null),_defineProperty$1(_assertThisInitialized(t),"_mediaStream",null),_defineProperty$1(_assertThisInitialized(t),"_media",null),_defineProperty$1(_assertThisInitialized(t),"_opts",null),_defineProperty$1(_assertThisInitialized(t),"_loader",null),_defineProperty$1(_assertThisInitialized(t),"_retry",0),_defineProperty$1(_assertThisInitialized(t),"_startPlayed",!1),_defineProperty$1(_assertThisInitialized(t),"_lastTimeupdateTs",0),_defineProperty$1(_assertThisInitialized(t),"_onTrack",(function(e){logger$1.log("addTrack: ",e.track),t["_".concat(e.track.kind)]=e.track,t._mediaStream||(t._mediaStream=new MediaStream,t._media.srcObject=t._mediaStream),t._mediaStream.addTrack(e.track)})),_defineProperty$1(_assertThisInitialized(t),"_mockWaitingByTimeupdate",(function(){var e;if("connected"===(null===(e=t._pc)||void 0===e?void 0:e.connectionState)){t._lastTimeupdateTs||getStats(t._pc).then((function(e){logger$1.log("tracks stats:",e),e.forEach((function(e){return t.emit(EVENT.METADATA_PARSED,e)}))})).catch((function(){}));var r=performance.now();t._lastTimeupdateTs||(t._lastTimeupdateTs=r),r-t._lastTimeupdateTs>t._opts.stallInterval&&t.emit("waiting"),t._lastTimeupdateTs=r}})),_defineProperty$1(_assertThisInitialized(t),"_onLoaderRetry",(function(e,r){t.emit(EVENT.LOAD_RETRY,{error:StreamingError.network(e),retryTime:r})})),t._opts=getOption(e),t._media=t._opts.media,t._loader=new NetLoader(_objectSpread$1(_objectSpread$1({},e.fetchOptions),{},{responseType:"json",method:"POST",retry:t._opts.retryCount,retryDelay:t._opts.retryDelay,timeout:t._opts.loadTimeout,onRetryError:t._onLoaderRetry})),t._retry=t._opts.retryCount,t._bindMediaEvent(),t}return _createClass$1(n,[{key:"pc",get:function(){return this._pc}},{key:"getStats",value:function(){return getStats(this._pc)}},{key:"load",value:function(e){this._disconnect(),this._lastTimeupdateTs=0,this._url=e,this._pc=new RTCPeerConnection,this._bindRTCEvents(),this._connect(e)}},{key:"switchURL",value:function(e){this._startPlayed=!0,this.load(e||this._url)}},{key:"_bindRTCEvents",value:function(){var e=this,t=this._pc;t.addEventListener("track",this._onTrack),t.addEventListener("connectionstatechange",(function(){if(logger$1.log("onconnectionstatechange:",t.connectionState),"disconnected"!==t.connectionState&&"failed"!==t.connectionState||e.emit("waiting"),"failed"===t.connectionState){if(0===e._retry)return void e._emitError(StreamingError.network(new Error("rtc connect failed")));e._retry--,e.load(e._url)}"connected"===t.connectionState&&e._startPlayed&&e._media.play()}))}},{key:"_bindMediaEvent",value:function(){this._media.addEventListener("timeupdate",this._mockWaitingByTimeupdate)}},{key:"_connect",value:(t=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,i,o,a,s,u;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._pc,r=/Gecko/.test(navigator.userAgent)&&/Firefox/.test(navigator.userAgent),!t.addTransceiver){e.next=10;break}return this._audioTransceicer=t.addTransceiver("audio",{direction:"recvonly"}),this._videoTransceicer=t.addTransceiver("video",{direction:"recvonly"}),e.next=7,t.createOffer();case 7:n=e.sent,e.next=13;break;case 10:return e.next=12,t.createOffer({iceRestart:!0,offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 12:n=e.sent;case 13:return logger$1.log("local offer"),logger$1.log(n.sdp),(i=lib.parse(n.sdp)).media.filter((function(e){return"audio"===e.type})).forEach((function(e){var t;if(r){var n=null===(t=e.rtp.filter((function(e){return"opus"===e.codec}))[0])||void 0===t?void 0:t.payload;n&&e.fmtp.forEach((function(e){e.payload===n&&(e.config="minptime=10;useinbandfec=1")}))}})),n.sdp=lib.write(i),logger$1.log("local offer modified:\n",n.sdp),e.next=21,t.setLocalDescription(n);case 21:return e.prev=21,e.next=24,this._loader.load(this._url,{body:JSON.stringify({sessionId:"sessionId",version:"1.0-html",localSdp:n})});case 24:if(a=e.sent,200===(null==(s=null==a?void 0:a.data)?void 0:s.code)){e.next=28;break}throw new Error("code: ".concat(null==s?void 0:s.code,", message:").concat(null==s?void 0:s.message));case 28:logger$1.log("answer:"),logger$1.log(null===(o=s.remoteSdp)||void 0===o?void 0:o.sdp),(u=lib.parse(s.remoteSdp.sdp)).media.forEach((function(e){e.fingerprint.hash=e.fingerprint.hash.toUpperCase()})),s.remoteSdp.sdp=lib.write(u),logger$1.log("answer modified:\n",s.remoteSdp.sdp),this._pc.setRemoteDescription(s.remoteSdp),e.next=40;break;case 37:e.prev=37,e.t0=e.catch(21),this._emitError(StreamingError.network(e.t0));case 40:case"end":return e.stop()}}),e,this,[[21,37]])}))),function(){return t.apply(this,arguments)})},{key:"_disconnect",value:function(){var e;null===(e=this._pc)||void 0===e||e.close(),this._pc=null,this._audioTransceicer=null,this._videoTransceicer=null,this._mediaStream=null}},{key:"_emitError",value:function(e){this.emit(EVENT.ERROR,e)}},{key:"destroy",value:function(){var e;this._disconnect(),null===(e=this._media)||void 0===e||e.removeEventListener("timeupdate",this._mockWaitingByTimeupdate),this._media&&(this._media.srcObject=null),this._loader=null,this._media=null}}],[{key:"enableLogger",value:function(){Logger$2.enable()}},{key:"disableLogger",value:function(){Logger$2.disable()}}]),n}(EventEmitter$1);try{localStorage.getItem("xgd")?Rts.enableLogger():Rts.disableLogger()}catch(error){}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty$1(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper$c(e){var t=_isNativeReflectConstruct$c();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var RtsPlugin$1=function(t){_inherits(n,t);var r=_createSuper$c(n);function n(){var e;_classCallCheck$1(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return _defineProperty$1(_assertThisInitialized(e=r.call.apply(r,[this].concat(i))),"_rts",null),_defineProperty$1(_assertThisInitialized(e),"_rtsOpts",null),_defineProperty$1(_assertThisInitialized(e),"_init",(function(){var t;null===(t=e._rts)||void 0===t||t.destroy();var r=e.player.config,n=r.rts||{};e._rtsOpts=n,e._rts=new Rts(_objectSpread({media:e.player.video},n)),e._rts.load(r.url)})),_defineProperty$1(_assertThisInitialized(e),"_onSwitchURL",(function(t){e._rts&&(e.player.config.url=t,e._rts.switchURL(t))})),_defineProperty$1(_assertThisInitialized(e),"_onDefinitionChange",(function(t){var r=t.to;e._rts&&e._rts.switchURL(r)})),e}return _createClass$1(n,[{key:"pc",get:function(){var e;return null===(e=this._rts)||void 0===e?void 0:e.pc}},{key:"core",get:function(){return this._rts}},{key:"beforePlayerInit",value:function(){var t,r,n=this;this._init(),this.player.switchURL=this._onSwitchURL,null===(t=this.player)||void 0===t||t.useHooks("replay",(function(){var e;return null===(e=n._rts)||void 0===e?void 0:e.switchURL()})),null===(r=this.player)||void 0===r||r.useHooks("play",(function(){var e;return null===(e=n._rts)||void 0===e?void 0:e.switchURL()})),this.on(URL_CHANGE,this._onSwitchURL),this.on(DEFINITION_CHANGE,this._onDefinitionChange),this.on(DESTROY,this.destroy),this._transEvent(),this._transCoreEvent(EVENT.METADATA_PARSED);try{BasePlugin.defineGetterOrSetter(this.player,{__url:{get:function(){try{return URL.createObjectURL(new MediaSource)}catch(e){var t,r;null!==(t=n.player)&&void 0!==t&&null!==(r=t.video)&&void 0!==r&&r.srcObject||(n.player.video.srcObject=new MediaStream)}}}})}catch(e){}}},{key:"_transEvent",value:function(){var e=this;this._rts.on(EVENT.ERROR,(function(t){if(e.player){var r=e._rtsOpts,n=r.backupConstruct,i=r.backupURL;if(i){var o=e.player;o.emit("core_event",_objectSpread(_objectSpread({},{url:o.config.url,code:t.errorCode,message:t.errorMessage}),{},{eventName:"core.degrade"})),o.emit("degrade",{url:o.config.url,code:t.errorCode,message:t.errorMessage}),o.unRegisterPlugin("rts"),e._rts=null,o.rts=null,o.config.url=i,n?(o.registerPlugin(n).beforePlayerInit(),setTimeout((function(){o.video.src=o.url}))):o.video.src=i}else e.player.emit(ERROR$2,new Errors$2(e.player,t))}})),this._rts.on("waiting",(function(){var t;null===(t=e.player)||void 0===t||t.emit("waiting")}))}},{key:"_transCoreEvent",value:function(e){var t=this;this._rts.on(e,(function(r){t.player&&t.player.emit("core_event",_objectSpread(_objectSpread({},r),{},{eventName:e}))}))}},{key:"destroy",value:function(){var e;null===(e=this._rts)||void 0===e||e.destroy()}}],[{key:"pluginName",get:function(){return"rts"}}]),n}(BasePlugin),RtsPlugin=RtsPlugin$1,playerMap={flv:FlvPlugin,hls:HlsPlugin},RtmPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){return _classCallCheck$3(this,r),t.apply(this,arguments)}return _createClass$3(r,[{key:"beforeCreate",value:function(e){var t=(e.player.config.rtm||{}).backupStreamType;e.player.config.rts=lodash.exports.assign({},e.player.config.rtm,{backupConstruct:playerMap[t]})}},{key:"afterCreate",value:function(){var e=this.player;e.on("degrade",(function(){e.unRegisterPlugin("rtm")}))}}],[{key:"pluginName",get:function(){return"rtm"}}]),r}(RtsPlugin),SDKEvents=function(e){return e.PLAYER_CREATED_FINISH="player_create_finish",e.PLAYER_REBUILD="player_rebuild",e}(SDKEvents||{}),PluginEvents=function(e){return e.DANMU_CHANGE="danmu_change",e.TIME_SHIFT_CHANGE="time_shift_change",e.AI_SUBTITLE_LANG_CHANGE="ai_subtitle_lang_change",e.AI_SUBTITLE_MATCH="ai_subtitle_match",e.CANCEL_UNMUTE="cancel_unmute",e.REFRESH_CLICK="refresh_click",e.PLAY_BACKUP_CHANGE="play_backup_change",e.PLAY_BACKUP_CHANGE_FINISH="play_backup_change_finish",e.PLAY_ERROR_BUTTON_CLICK="play_error_button_click",e.PlAY_URL_CHANGE="play_url_change",e.SHOW_PLAY_ERROR="show_play_error",e.PLAYER_EXTEND_BUTTON="player_extend_button",e.LONG_WAITING="long_waiting",e.OFTEN_WAITING="often_waiting",e.DEFINITION_DEMOTE="definition_demote",e.LARKWINDOW_CHANGE="larkWindow_change",e.PANEL_MODE_CHANGE="panel_mode_change",e.INNER_DEFINITION_CHANGE="inner_definition_change",e.LINE_CHANGE="line_change",e.GET_PLAY_URL_ERR="get_play_url_err",e.MEDIA_EXPIRED="MEDIA_EXPIRED",e}(PluginEvents||{}),Event$1=Object.freeze(Object.defineProperty({__proto__:null,SDKEvents:SDKEvents,PluginEvents:PluginEvents},Symbol.toStringTag,{value:"Module"})),MultilinePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.playerData=n.playerConfig.playerData,n}return _createClass$3(r,[{key:"beforeCreate",value:function(e){var t=e.player.config.playerData,r=t.getLineList(),n=t.current.lineId;Array.isArray(r)&&r.length>0&&(e.config.list=r.map((function(t){return t.text=e.player.i18n[t.lineTextKey]||t.lineTextKey,t}))),e.config.defaultLine=n}},{key:"afterCreate",value:function(){_get$2(_getPrototypeOf$2(r.prototype),"afterCreate",this).call(this),this.config.list.length<2&&this.hide()}},{key:"afterPlayerInit",value:function(){}},{key:"renderItemList",value:function(){var e=this,t=this.config,n=t.list,i=t.defaultLine,o=0,a=n.map((function(t,r){var n,a={lineId:t.lineId||"",showText:e.i18n[t.lineTextKey]||t.lineTextKey,isCurrent:!1,selected:!1};return util$2.isUndefined(t.lineId)||(null===(n=t.lineId)||void 0===n?void 0:n.toString())!==(null==i?void 0:i.toString())||(a.isCurrent=!0,a.selected=!0,o=r),a}));_get$2(_getPrototypeOf$2(r.prototype),"renderItemList",this).call(this,a,o)}},{key:"onItemClick",value:function(e,t){this.player.emit(PluginEvents.LINE_CHANGE,{from:this.playerData.current.lineId,to:t.to.lineId}),this.playerData.current.lineId=t.to.lineId,this.player.emit(SDKEvents.PLAYER_REBUILD)}}],[{key:"pluginName",get:function(){return"sdkMultilinePlugin"}},{key:"defaultConfig",get:function(){return{position:Plugin.POSITIONS.CONTROLS_RIGHT,index:4,list:[],defaultLine:0,className:"xgplayer-multiline",hidePortrait:!1,isShowIcon:!0}}}]),r}(OptionsIcon),DefinitionPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.playerData=n.playerConfig.playerData,n.dataMonitoring(),n}return _createClass$3(r,[{key:"registerLanguageTexts",value:function(){return{switching:{jp:"に切り替える",en:"Switching to",zh:"正在切换至","zh-hk":"正在切換至"}}}},{key:"beforeCreate",value:function(e){var t=this,r=e.player.config.playerData,n=r.current,i=n.lineId,o=n.definition,a=r.getDefinitionListByLineId(i);Array.isArray(a)&&a.length>0&&(e.config.list=a.map((function(r){return r.text||(r.text=t.getShowText(e.player.i18n,r)),r}))),e.config.defaultDefinition=o}},{key:"dataMonitoring",value:function(){var e=this;MyProxy$1.subscribeProperty(this.playerData.current,"definition",(function(t,r){if(t!==r&&e.player){var n,i,o=e.config.list,a=null===(n=(void 0===o?[]:o).filter((function(e){return e.definition===r})))||void 0===n||null===(i=n[0])||void 0===i?void 0:i.url;e.player.changeDefinition({definition:r,url:a}),e.player.emit(PluginEvents.INNER_DEFINITION_CHANGE,{from:t,to:r,url:a}),e.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:a,from:PluginEvents.INNER_DEFINITION_CHANGE}),e.renderItemList(r),setTimeout((function(){e.player.paused&&e.player.play()}),1e3)}}))}},{key:"showToast",value:function(e){var t,r=null===(t=this.player)||void 0===t?void 0:t.getPlugin("sdkToastPlugin");if(r){var n=e.showText;r.add("".concat(this.langText.switching).concat(n,"..."),2e3,!0)}}},{key:"afterCreate",value:function(){_get$2(_getPrototypeOf$2(r.prototype),"afterCreate",this).call(this),this.config.list.length<2&&this.hide()}},{key:"afterPlayerInit",value:function(){}},{key:"getShowText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return e[t.definitionTextKey]||t.definitionTextKey||t.definition}},{key:"renderItemList",value:function(e){var t=this,n=this.config,i=n.list,o=n.defaultDefinition,a=0,s=i.map((function(r,n){var i={url:r.url,definition:r.definition||"",showText:t.getShowText(t.i18n,r),isCurrent:!1,selected:!1},s="string"==typeof e?r.definition===e:r.definition===o;return!util$2.isUndefined(r.definition)&&s&&(i.isCurrent=!0,i.selected=!0,a=n),i}));_get$2(_getPrototypeOf$2(r.prototype),"renderItemList",this).call(this,s,a)}},{key:"onItemClick",value:function(e,t){this.showToast(t.to),this.playerData.current.definition=t.to.definition}}],[{key:"pluginName",get:function(){return"sdkDefinitionPlugin"}},{key:"defaultConfig",get:function(){return{position:Plugin.POSITIONS.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0}}}]),r}(OptionsIcon),UnmutePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).state={isSupportAutoplay:!0,showUnmuteBt:!1},n}return _createClass$3(r,[{key:"beforePlayerInit",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"afterCreate",value:function(){this.initEvents()}},{key:"registerLanguageTexts",value:function(){return{unmute:{jp:"ミュートを解除する",en:"Click to unmute",zh:"点击取消静音","zh-hk":"點擊取消靜音"}}}},{key:"updateLang",value:function(){this.renderUnmuteBt()}},{key:"initEvents",value:function(){this.player.once("autoplay_was_prevented",this.handleAutoplayPrevented.bind(this)),this.player.once("autoplay_started",this.handleAutoplayStart.bind(this)),this.player.once("volumechange",this.handleVolumechange.bind(this))}},{key:"handleAutoplayPrevented",value:function(){console.log("静音自动启播失败"),this.state.isSupportAutoplay=!1,this.player.muted=!1}},{key:"handleAutoplayStart",value:function(){this.state.isSupportAutoplay?(this.state.showUnmuteBt=!0,this.renderUnmuteBt()):this.player.muted=!1}},{key:"handleVolumechange",value:function(){this.state.showUnmuteBt=!1,this.renderUnmuteBt(),this.player.paused&&this.player.play()}},{key:"renderUnmuteBt",value:function(){var e=this.root;if(e&&(e.innerHTML="",this.state.showUnmuteBt)){var t=this.langText.unmute,r=util$2.createDom("div",t,void 0,"xgplayer-unmute-bt");e.appendChild(r),this.bind(".xgplayer-unmute-bt","click",this.cancelUnmute.bind(this))}}},{key:"cancelUnmute",value:function(){this.player.muted=!1,this.state.showUnmuteBt=!1,this.renderUnmuteBt(),this.player.emit(PluginEvents.CANCEL_UNMUTE)}},{key:"destroy",value:function(){this.player.off("autoplay_was_prevented",this.handleAutoplayPrevented.bind(this)),this.player.off("autoplay_started",this.handleAutoplayStart.bind(this)),this.player.off("volumechange",this.handleVolumechange.bind(this))}},{key:"render",value:function(){return'<div class="xgplayer-unmute"></div>'}}],[{key:"pluginName",get:function(){return"sdkUnmutePlugin"}},{key:"defaultConfig",get:function(){return{position:Plugin.POSITIONS.ROOT}}}]),r}(Plugin);function refreshSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2.488a7.48 7.48 0 00-4.154 1.253.908.908 0 101.005 1.512 5.695 5.695 0 018.844 4.746h-.908a.33.33 0 00-.264.528l1.816 2.422a.33.33 0 00.529 0l1.815-2.422A.33.33 0 0018.42 10h-.908A7.511 7.511 0 0010 2.49zM2.489 10a7.511 7.511 0 0011.665 6.26.908.908 0 00-1.005-1.513A5.695 5.695 0 014.305 10h.908a.33.33 0 00.264-.528L3.66 7.05a.33.33 0 00-.528 0L1.317 9.47a.33.33 0 00.264.53h.908z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function isObject$2(e){var t=_typeof$3(e);return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject$2,freeGlobal$1="object"==_typeof$3(commonjsGlobal$1)&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,_freeGlobal=freeGlobal$1,freeGlobal=_freeGlobal,freeSelf="object"==("undefined"==typeof self?"undefined":_typeof$3(self))&&self&&self.Object===Object&&self,root$2=freeGlobal||freeSelf||Function("return this")(),_root=root$2,root$1=_root,now$1=function(){return root$1.Date.now()},now_1=now$1,reWhitespace=/\s/;function trimmedEndIndex$1(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var _trimmedEndIndex=trimmedEndIndex$1,trimmedEndIndex=_trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim$1(e){return e?e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,""):e}var _baseTrim=baseTrim$1,root=_root,_Symbol2=root.Symbol,_Symbol$2=_Symbol2,_Symbol$1=_Symbol$2,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty,nativeObjectToString$1=objectProto$1.toString,symToStringTag$1=_Symbol$1?_Symbol$1.toStringTag:void 0;function getRawTag$1(t){var r=hasOwnProperty$1.call(t,symToStringTag$1),n=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var i=!0}catch(e){}var o=nativeObjectToString$1.call(t);return i&&(r?t[symToStringTag$1]=n:delete t[symToStringTag$1]),o}var _getRawTag=getRawTag$1,objectProto=Object.prototype,nativeObjectToString=objectProto.toString;function objectToString$1(e){return nativeObjectToString.call(e)}var _objectToString=objectToString$1,_Symbol=_Symbol$2,getRawTag=_getRawTag,objectToString=_objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag$1(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}var _baseGetTag=baseGetTag$1;function isObjectLike$1(e){return null!=e&&"object"==_typeof$3(e)}var isObjectLike_1=isObjectLike$1,baseGetTag=_baseGetTag,isObjectLike=isObjectLike_1,symbolTag="[object Symbol]";function isSymbol$1(e){return"symbol"==_typeof$3(e)||isObjectLike(e)&&baseGetTag(e)==symbolTag}var isSymbol_1=isSymbol$1,baseTrim=_baseTrim,isObject$1=isObject_1,isSymbol=isSymbol_1,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject$1(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$1(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_1=toNumber$1,isObject=isObject_1,now=now_1,toNumber=toNumber_1,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce$1(e,t,r){var n,i,o,a,s,u,c=0,l=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function h(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function p(e){return c=e,s=setTimeout(y,t),l?h(e):a}function g(e){var r=e-u;return void 0===u||r>=t||r<0||d&&e-c>=o}function y(){var e=now();if(g(e))return v(e);s=setTimeout(y,function(e){var r=t-(e-u);return d?nativeMin(r,o-(e-c)):r}(e))}function v(e){return s=void 0,f&&n?h(e):(n=i=void 0,a)}function m(){var e=now(),r=g(e);if(n=arguments,i=this,u=e,r){if(void 0===s)return p(u);if(d)return clearTimeout(s),s=setTimeout(y,t),h(u)}return void 0===s&&(s=setTimeout(y,t)),a}return t=toNumber(t)||0,isObject(r)&&(l=!!r.leading,o=(d="maxWait"in r)?nativeMax(toNumber(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),m.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=u=i=s=void 0},m.flush=function(){return void 0===s?a:v(now())},m}var debounce_1=debounce$1,POSITIONS$7=Plugin.POSITIONS,RefreshPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){return _classCallCheck$3(this,r),t.apply(this,arguments)}return _createClass$3(r,[{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.refresh),this.initEvents()}},{key:"registerIcons",value:function(){return{refresh:{icon:refreshSVG$1,class:"xgplayer-refresh-svg"}}}},{key:"registerLanguageTexts",value:function(){return{refresh:{jp:"リフレッシュ",en:"Refresh",zh:"刷新","zh-hk":"刷新"}}}},{key:"initEvents",value:function(){this.handleRefresh=debounce_1(this.handleRefresh.bind(this),200);var e="mobile"===sniffer.device?"touchend":"click";this.bind(e,this.handleRefresh),this.show()}},{key:"handleRefresh",value:function(e){var t=this.player;t&&(e.preventDefault(),e.stopPropagation(),t.addClass("xgplayer-is-enter"),t.pause(),t.emit(PluginEvents.REFRESH_CLICK),setTimeout((function(){t&&t.retry(),t.once("canplay",(function(){t.removeClass("xgplayer-is-enter")}))})))}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.handleRefresh)}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-refresh">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="refresh">'.concat(this.langText.refresh,"</div>\n    </xg-icon>\n    ")}}],[{key:"pluginName",get:function(){return"refresh"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$7.CONTROLS_LEFT,index:1}}}]),r}(Plugin);function MoreIconSVG(){return(new DOMParser).parseFromString('<svg width="18" height="18" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.75 11C5.75 11.9665 4.9665 12.75 4 12.75C3.0335 12.75 2.25 11.9665 2.25 11C2.25 10.0335 3.0335 9.25 4 9.25C4.9665 9.25 5.75 10.0335 5.75 11ZM13.25 11C13.25 11.9665 12.4665 12.75 11.5 12.75C10.5335 12.75 9.75 11.9665 9.75 11C9.75 10.0335 10.5335 9.25 11.5 9.25C12.4665 9.25 13.25 10.0335 13.25 11ZM19 12.75C19.9665 12.75 20.75 11.9665 20.75 11C20.75 10.0335 19.9665 9.25 19 9.25C18.0335 9.25 17.25 10.0335 17.25 11C17.25 11.9665 18.0335 12.75 19 12.75Z" fill="white"/>\n</svg>\n',"image/svg+xml").firstChild}var MoreButtonPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).panel=null,n.panelContainer=null,n}return _createClass$3(r,[{key:"beforePlayerInit",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"afterCreate",value:function(){this.renderMoreIcon()}},{key:"updateLang",value:function(e){if(this.panelContainer){var t=this.panelContainer.querySelectorAll(".panel-icon-bt-text"),r=this.getAndSplitList().extraList;t.forEach((function(t){var n,i,o=Number(t.getAttribute("plugin-index"));null!==(n=r[o])&&void 0!==n&&null!==(i=n.textTips)&&void 0!==i&&i[e]&&(t.innerHTML=r[o].textTips[e])}))}}},{key:"registerIcons",value:function(){return{more:{icon:MoreIconSVG,class:"xgplayer-more-svg"}}}},{key:"getAndSplitList",value:function(){var e,t,r,n,i,o=(null!==(e=this.player.config.ignores)&&void 0!==e?e:[]).map((function(e){return e.toLowerCase()})),a=this.config.iconPlugins.filter((function(e){return!o.includes(e.pluginName.toLowerCase())}));return a.length>this.config.maxShowNum+1?(n=a.slice(0,this.config.maxShowNum),i=a.slice(-(a.length-this.config.maxShowNum))):n=_toConsumableArray$2(a),{list:null!==(t=n)&&void 0!==t?t:[],extraList:null!==(r=i)&&void 0!==r?r:[]}}},{key:"children",value:function(){var e=this,t=this.getAndSplitList().list,r={};return t.forEach((function(t){r[t.pluginName]={plugin:t,options:{root:e.root}}})),r}},{key:"renderMoreIcon",value:function(){var e=this,t=this.getAndSplitList().extraList;if(0!==t.length){var r=this.root,n=util$2.createDom("div","",{},"xgplayer-icon");n.appendChild(this.icons.more),n.addEventListener("click",(function(){e.renderPanel(t)}));var i=util$2.createDom("xg-icon","",{"data-index":0},"xgplayer-more");i.appendChild(n),r.appendChild(i)}}},{key:"renderPanel",value:function(e){var t=this;this.panelContainer||(this.panelContainer=util$2.createDom("div","",{},"panel-content"),e.forEach((function(e,r){var n,i,o=util$2.createDom("div","",{},"panel-icon-bt"),a=util$2.createDom("div","",{},"panel-icon-svg");o.appendChild(a),t.registerExtraPlugin(e,a);var s="zh-cn"===t.player.lang?"zh":t.player.lang,u=null!==(n=null===(i=e.textTips)||void 0===i?void 0:i[s])&&void 0!==n?n:e.pluginName;o.appendChild(util$2.createDom("span",u,{"plugin-index":r},"panel-icon-bt-text")),t.panelContainer.appendChild(o)}))),this.player.panel.showPanel(this.panelContainer)}},{key:"registerExtraPlugin",value:function(e,t){this.player.registerPlugin({plugin:e,options:{root:t}})}},{key:"destroy",value:function(){}},{key:"render",value:function(){return'<div class="xgplayer-rightTop-iconList"></div>'}}],[{key:"pluginName",get:function(){return"MoreButtonPlugin"}},{key:"defaultConfig",get:function(){return{position:Plugin.POSITIONS.ROOT_TOP,iconPlugins:[],maxShowNum:2}}}]),r}(Plugin);function ErrorImg(){return(new DOMParser).parseFromString('<svg width="150" height="162" viewBox="0 0 150 162" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M127.718 112.831H6.13675C4.19663 112.831 2.25651 108.974 2.90322 104.475C3.54993 99.9761 8.07687 99.9761 13.8972 99.9761C11.9571 97.4052 9.37028 88.4069 15.8373 81.3369C22.3044 74.2668 25.5379 74.2668 34.5918 75.5526C33.9451 63.9837 47.526 34.4178 77.2744 35.0605C107.023 35.7032 116.077 54.3421 119.957 63.3404C129.011 62.6976 147.765 66.554 149.706 87.1214C151.258 103.575 135.694 111.117 127.718 112.831Z" fill="#F1F4F8"/>\n<path d="M44.9346 91.6022L43.6782 99.8032" stroke="#D0D6E0" stroke-width="2" stroke-linecap="round"/>\n<path d="M47.3545 125.695L48.6109 117.494" stroke="#D0D6E0" stroke-width="2" stroke-linecap="round"/>\n<path d="M31.5347 97.7378L38.7295 101.869" stroke="#D0D6E0" stroke-width="2" stroke-linecap="round"/>\n<path d="M60.7544 119.559L53.5595 115.428" stroke="#D0D6E0" stroke-width="2" stroke-linecap="round"/>\n<path d="M69.6755 44.5318L138.35 26.0209C139.115 25.8148 139.804 26.5367 139.563 27.2909L121.081 85.1146C120.982 85.4243 120.739 85.6665 120.429 85.7641L52.0645 107.28C51.2996 107.521 50.5766 106.809 50.8062 106.04L68.9776 45.2111C69.0768 44.879 69.3409 44.622 69.6755 44.5318Z" fill="#D0D6E0" stroke="#D0D6E0" stroke-width="4" stroke-linecap="round"/>\n<path d="M83.1285 52.7415C91.6454 54.3438 107.322 62.0019 101.894 79.8155" stroke="white" stroke-width="3" stroke-linecap="round"/>\n<path d="M84.138 62.3385C88.3894 63.1384 96.2148 66.9611 93.5053 75.8531" stroke="white" stroke-width="3" stroke-linecap="round"/>\n<ellipse cx="83.6417" cy="71.98" rx="3.08443" ry="3.07025" transform="rotate(12.6375 83.6417 71.98)" fill="white"/>\n<path d="M43.4699 110.358C39.5425 109.114 30.6316 108.203 26.4077 114.511C21.1278 122.397 36.5031 152.755 2.11053 160.141" stroke="#D0D6E0" stroke-width="2" stroke-linecap="round"/>\n</svg>\n',"image/svg+xml").firstChild}var ErrorPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.state={showError:!1,retryTimes:0,idx:0},n.playerData=e.player.config.playerData,n}return _createClass$3(r,[{key:"afterCreate",value:function(){this.initEvents()}},{key:"registerLanguageTexts",value:function(){return{clickButton:{jp:"リフレッシュ",en:"Refresh",zh:"刷新","zh-hk":"刷新"},errorTips:{jp:"再生中にエラーが発生しました。[更新]をクリックして試してください",en:"An error occurred while playing, click refresh to try",zh:"播放发生错误，点击刷新试试吧","zh-hk":"播放發生錯誤，點擊刷新試試吧"}}}},{key:"registerIcons",value:function(){return{errorImg:{icon:ErrorImg,class:"xgplayer-error-svg"}}}},{key:"updateLang",value:function(){if(this.$errorDom){var e=this.$errorDom.querySelector(".xgplayer-error-tips");if(e){var t,r,n=null!==(t=null===(r=this.config.errorTipsText)||void 0===r?void 0:r[this.lang])&&void 0!==t?t:this.langText.errorTips;e.innerHTML=n}var i=this.$errorDom.querySelector(".xgplayer-error-button");i&&(i.innerHTML=this.langText.clickButton)}}},{key:"initEvents",value:function(){this.player.on(ERROR$2,this.handleError.bind(this)),this.playerData.isLive&&(this.player.on(ENDED,this.handleEnd.bind(this)),this.player.on(PluginEvents.REFRESH_CLICK,this.closeError.bind(this)))}},{key:"handleError",value:function(){this.player&&this.player.pause(),this.config.isNeedDemoteBack?(this.state.showError=!1,this.changeMainOrBackup()):this.state.showError=!0,this.renderError()}},{key:"handleEnd",value:function(){this.player&&this.player.pause(),this.config.isNeedDemoteBack&&this.changeMainOrBackup()}},{key:"getRetryList",value:function(){var e,t=this.playerData.getCurrentStreams()[0];return[null==t?void 0:t.url].concat(_toConsumableArray$2(null!==(e=null==t?void 0:t.backUrlList)&&void 0!==e?e:[]))}},{key:"changeMainOrBackup",value:function(){var e=this,t=this.getRetryList(),r=this.config.retryLoopNum*t.length,n=(t.indexOf(this.player.config.url)+1)%t.length;this.state.idx=n;var i=t[n];if(!i||this.state.retryTimes===r)return this.state.retryTimes===r&&this.player.emit(PluginEvents.PLAY_BACKUP_CHANGE_FINISH),this.state.showError=!0,this.renderError(),void this.resetTimes();this.player.once("canplay",(function(){e.state.retryTimes=0})),console.log("重试第".concat(this.state.retryTimes,"次"),i),this.player.emit(PluginEvents.PLAY_BACKUP_CHANGE,{currentUrl:this.player.config.url,nextUrl:i,retryTimes:this.state.retryTimes}),this.changeUrl(i),this.state.retryTimes=this.state.retryTimes+1}},{key:"changeUrl",value:function(e){this.player.config.url=e,this.player.switchURL(e,!1),this.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:e,from:PluginEvents.PLAY_BACKUP_CHANGE})}},{key:"resetTimes",value:function(){this.state.retryTimes=0,this.state.idx=0}},{key:"renderError",value:function(){var e=this.root;e&&(e.innerHTML="",e.style.display="none",this.state.showError&&(this.player.emit(PluginEvents.SHOW_PLAY_ERROR),e.style.display="block",e.appendChild(this.getErrorDom())))}},{key:"getErrorDom",value:function(){if(!this.$errorDom){if(this.$errorDom=util$2.createDom("div","",void 0,"xgplayer-error-cover"),this.config.errorImg){var e=util$2.createDom("div","",void 0,"xgplayer-error-img");e.appendChild(this.icons.errorImg),this.$errorDom.appendChild(e)}if(this.config.errorTips){var t,r,n=null!==(t=null===(r=this.config.errorTipsText)||void 0===r?void 0:r[this.lang])&&void 0!==t?t:this.langText.errorTips,i=util$2.createDom("div",n,void 0,"xgplayer-error-tips");this.$errorDom.appendChild(i)}if(this.config.isNeedRefreshButton){var o=util$2.createDom("div",this.langText.clickButton,void 0,"xgplayer-error-button");this.bind(".xgplayer-error-button","click",this.handleButtonClick.bind(this)),this.$errorDom.appendChild(o)}}return this.$errorDom}},{key:"handleButtonClick",value:function(){var e,t;null===(e=this.player)||void 0===e||e.emit(PluginEvents.PLAY_ERROR_BUTTON_CLICK),null===(t=this.player)||void 0===t||t.retry(),this.closeError()}},{key:"closeError",value:function(){this.state.showError=!1,this.renderError()}},{key:"destroy",value:function(){this.player.off(ERROR$2,this.handleError.bind(this)),this.playerData.isLive&&this.player.off(ENDED,this.handleEnd.bind(this))}},{key:"render",value:function(){return'<xgplayer-error class="xgplayer-error"></xgplayer-error>'}}],[{key:"pluginName",get:function(){return"sdkErrorPlugin"}},{key:"defaultConfig",get:function(){return{errorImg:!0,errorTips:!0,isNeedRefreshButton:!0,isNeedDemoteBack:!1,retryLoopNum:1,errorTipsText:null,position:Plugin.POSITIONS.ROOT}}}]),r}(Plugin);function danmuActiveSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 4.106h-13a.3.3 0 00-.3.3v11.186a.3.3 0 00.3.3h7.111v1.7H3.5a2 2 0 01-2-2V4.406a2 2 0 012-2h13a2 2 0 012 2V10h-1.7V4.406a.3.3 0 00-.3-.3zM6 7.722c0-.42.34-.76.76-.76h6.58a.76.76 0 110 1.52H6.76a.76.76 0 01-.76-.76zm0 3.037c0-.42.34-.759.76-.759h3.543a.76.76 0 110 1.519H6.76a.76.76 0 01-.76-.76z" fill="#fff"/><circle cx="15.1" cy="14.201" r="3.4" fill="#3370FF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13.185 13.756a.5.5 0 01.707 0l.866.866 1.78-1.78a.5.5 0 11.707.707l-2.133 2.134a.5.5 0 01-.707 0l-1.22-1.22a.5.5 0 010-.707z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function Default(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 4.106h-13a.3.3 0 00-.3.3v11.186a.3.3 0 00.3.3h7.111v1.7H3.5a2 2 0 01-2-2V4.406a2 2 0 012-2h13a2 2 0 012 2V10h-1.7V4.406a.3.3 0 00-.3-.3zM6 7.722c0-.42.34-.76.76-.76h6.58a.76.76 0 110 1.52H6.76a.76.76 0 01-.76-.76zm0 3.037c0-.42.34-.759.76-.759h3.543a.76.76 0 110 1.519H6.759a.76.76 0 01-.759-.76zm7.202 2.303a2.2 2.2 0 003.011 3.011l-3.011-3.01zm3.915 1.992a2.2 2.2 0 00-2.896-2.896l2.896 2.896zm1.383-.879a3.4 3.4 0 11-6.8 0 3.4 3.4 0 016.8 0z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function resetIcon(){return(new DOMParser).parseFromString('<svg fill="none" stroke="currentColor" stroke-width="4" viewBox="0 0 48 48" width="1em" height="1em"\n    class="arco-icon arco-icon-refresh">\n    <path\n        d="M38.837 18C36.463 12.136 30.715 8 24 8 15.163 8 8 15.163 8 24s7.163 16 16 16c7.455 0 13.72-5.1 15.496-12M40 8v10H30">\n    </path>\n</svg>',"image/svg+xml").firstChild}function ownerDocument(e){return e&&e.ownerDocument||document}function activeElement(t){void 0===t&&(t=ownerDocument());try{var r=t.activeElement;return r&&r.nodeName?r:null}catch(e){return t.body}}function hasClass(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}function addClass(e,t){e.classList?e.classList.add(t):hasClass(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),optionsSupported=!1,onceSupported=!1;try{var options={get passive(){return optionsSupported=!0},get once(){return onceSupported=optionsSupported=!0}};canUseDOM&&(window.addEventListener("test",options,options),window.removeEventListener("test",options,!0))}catch(e){}function addEventListener(e,t,r,n){if(n&&"boolean"!=typeof n&&!onceSupported){var i=n.once,o=n.capture,a=r;!onceSupported&&i&&(a=r.__once||function e(n){this.removeEventListener(t,e,o),r.call(this,n)},r.__once=a),e.addEventListener(t,a,optionsSupported?n:o)}e.addEventListener(t,r,n)}function ownerWindow(e){var t=ownerDocument(e);return t&&t.defaultView||window}function getComputedStyle(e,t){return ownerWindow(e).getComputedStyle(e,t)}var rUpper=/([A-Z])/g;function hyphenate(e){return e.replace(rUpper,"-$1").toLowerCase()}var msPattern=/^ms-/;function hyphenateStyleName(e){return hyphenate(e).replace(msPattern,"-ms-")}var supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function isTransform(e){return!(!e||!supportedTransforms.test(e))}function style(e,t){var r="",n="";if("string"==typeof t)return e.style.getPropertyValue(hyphenateStyleName(t))||getComputedStyle(e).getPropertyValue(hyphenateStyleName(t));Object.keys(t).forEach((function(i){var o=t[i];o||0===o?isTransform(i)?n+=i+"("+o+") ":r+=hyphenateStyleName(i)+": "+o+";":e.style.removeProperty(hyphenateStyleName(i))})),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function removeEventListener(e,t,r,n){var i=n&&"boolean"!=typeof n?n.capture:n;e.removeEventListener(t,r,i),r.__once&&e.removeEventListener(t,r.__once,i)}function listen(e,t,r,n){return addEventListener(e,t,r,n),function(){removeEventListener(e,t,r,n)}}function triggerEvent(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!0),e){var i=document.createEvent("HTMLEvents");i.initEvent(t,r,n),e.dispatchEvent(i)}}function parseDuration(e){var t=style(e,"transitionDuration")||"",r=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*r}function emulateTransitionEnd(e,t,r){void 0===r&&(r=5);var n=!1,i=setTimeout((function(){n||triggerEvent(e,"transitionend",!0)}),t+r),o=listen(e,"transitionend",(function(){n=!0}),{once:!0});return function(){clearTimeout(i),o()}}function transitionEnd(e,t,r,n){null==r&&(r=parseDuration(e)||0);var i=emulateTransitionEnd(e,r,n),o=listen(e,"transitionend",t);return function(){i(),o()}}var reset={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function _animate(e){var t=e.node,r=e.properties,n=e.duration,i=void 0===n?200:n,o=e.easing,a=e.callback,s=[],u={},c="";Object.keys(r).forEach((function(e){var t=r[e];isTransform(e)?c+=e+"("+t+") ":(u[e]=t,s.push(hyphenate(e)))})),c&&(u.transform=c,s.push("transform")),i>0&&(u.transition=s.join(", "),u["transition-duration"]=i/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=o||"linear");var l=transitionEnd(t,(function(e){e.target===e.currentTarget&&(style(t,reset),a&&a.call(this,e))}),i);return t.clientLeft,style(t,u),{cancel:function(){l(),style(t,reset)}}}function animate(e,t,r,n,i){if(!("nodeType"in e))return _animate(e);if(!t)throw new Error("must include properties to animate");return"function"==typeof n&&(i=n,n=""),_animate({node:e,properties:t,duration:r,easing:n,callback:i})}var prev=(new Date).getTime();function fallback(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-prev)),n=setTimeout(e,r);return prev=t,n}var vendors=["","webkit","moz","o","ms"],cancelMethod="clearTimeout",rafImpl=fallback,getKey=function(e,t){return e+(e?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};canUseDOM&&vendors.some((function(e){var t=getKey(e,"request");return t in window&&(cancelMethod=getKey(e,"cancel"),rafImpl=function(e){return window[t](e)}),!!rafImpl}));var cancel=function(e){"function"==typeof window[cancelMethod]&&window[cancelMethod](e)},request=rafImpl,matchesImpl;function attribute(e,t,r){if(e){if(void 0===r)return e.getAttribute(t);r||""===r?e.setAttribute(t,String(r)):e.removeAttribute(t)}}function childElements(e){return e?Array.from(e.children):[]}function clear(e){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}return null}function matches(e,t){if(!matchesImpl){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;matchesImpl=function(e,t){return n.call(e,t)}}return matchesImpl(e,t)}function closest(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(matches(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}function contains(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}var toArray$1=Function.prototype.bind.call(Function.prototype.call,[].slice);function childNodes(e){return e?toArray$1(e.childNodes):[]}var toArray=Function.prototype.bind.call(Function.prototype.call,[].slice);function qsa(e,t){return toArray(e.querySelectorAll(t))}function filterEvents(e,t){return function(r){var n=r.currentTarget,i=r.target;qsa(n,e).some((function(e){return contains(e,i)}))&&t.call(this,r)}}function isDocument(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function isWindow(e){return"window"in e&&e.window===e?e:isDocument(e)&&e.defaultView||!1}function getscrollAccessor(e){var t="pageXOffset"===e?"scrollLeft":"scrollTop";return function(r,n){var i=isWindow(r);if(void 0===n)return i?i[e]:r[t];i?i.scrollTo(i[e],n):r[t]=n}}var scrollLeft=getscrollAccessor("pageXOffset"),scrollTop=getscrollAccessor("pageYOffset");function offset(e){var t=ownerDocument(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return n&&contains(n,e)?(void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect()),r={top:r.top+scrollTop(n)-(n.clientTop||0),left:r.left+scrollLeft(n)-(n.clientLeft||0),width:r.width,height:r.height}):r}function height(e,t){var r=isWindow(e);return r?r.innerHeight:t?e.clientHeight:offset(e).height}function insertAfter(e,t){return e&&t&&t.parentNode?(t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),e):null}var regExpInputs=/^(?:input|select|textarea|button)$/i;function isInput(e){return!!e&&regExpInputs.test(e.nodeName)}function isVisible(e){return!!e&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function collectSiblings(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);for(var n=[];e;e=e.nextElementSibling)if(e!==t){if(r&&matches(e,r))break;n.push(e)}return n}function nextUntil(e,t){return collectSiblings(e,e,t)}var isHTMLElement=function(e){return!!e&&"offsetParent"in e};function offsetParent(e){for(var t=ownerDocument(e),r=e&&e.offsetParent;isHTMLElement(r)&&"HTML"!==r.nodeName&&"static"===style(r,"position");)r=r.offsetParent;return r||t.documentElement}function collectElements(e,t){var r=null,n=[];for(r=e?e[t]:null;r&&9!==r.nodeType;)n.push(r),r=r[t]||null;return n}function parents(e){return collectElements(e,"parentElement")}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends.apply(this,arguments)}var nodeName=function(e){return e.nodeName&&e.nodeName.toLowerCase()},size;function position(e,t){var r,n={top:0,left:0};if("fixed"===style(e,"position"))r=e.getBoundingClientRect();else{var i=t||offsetParent(e);r=offset(e),"html"!==nodeName(i)&&(n=offset(i));var o=String(style(i,"borderTopWidth")||0);n.top+=parseInt(o,10)-scrollTop(i)||0;var a=String(style(i,"borderLeftWidth")||0);n.left+=parseInt(a,10)-scrollLeft(i)||0}var s=String(style(e,"marginTop")||0),u=String(style(e,"marginLeft")||0);return _extends({},r,{top:r.top-n.top-(parseInt(s,10)||0),left:r.left-n.left-(parseInt(u,10)||0)})}function prepend(e,t){return e&&t?(t.firstElementChild?t.insertBefore(e,t.firstElementChild):t.appendChild(e),e):null}function remove(e){return e&&e.parentNode?(e.parentNode.removeChild(e),e):null}function replaceClassName(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function removeClass(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=replaceClassName(e.className,t):e.setAttribute("class",replaceClassName(e.className&&e.className.baseVal||"",t))}function scrollbarSize(e){if((!size&&0!==size||e)&&canUseDOM){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),size=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return size}function scrollParent(e,t){var r=style(e,"position"),n="absolute"===r,i=e.ownerDocument;if("fixed"===r)return i||document;for(;(e=e.parentNode)&&!isDocument(e);){var o=n&&"static"===style(e,"position"),a=(style(e,"overflow")||"")+(style(e,"overflow-y")||"")+style(e,"overflow-x");if(!o&&(/(auto|scroll)/.test(a)&&(t||height(e)<e.scrollHeight)))return e}return i||document}function scrollTo(e,t){var r=offset(e),n={top:0,left:0};if(e){var i=t||scrollParent(e),o=isWindow(i),a=scrollTop(i),s=height(i,!0);o||(n=offset(i));var u=(r={top:r.top-n.top,left:r.left-n.left,height:r.height,width:r.width}).height,c=r.top+(o?0:a),l=c+u;a=a>c?c:l>a+s?l-s:a;var d=request((function(){return scrollTop(i,a)}));return function(){return cancel(d)}}}function siblings(e){return collectSiblings(e&&e.parentElement?e.parentElement.firstElementChild:null,e)}var regExpNbspEntity=/&nbsp;/gi,regExpNbspHex=/\xA0/g,regExpSpaces=/\s+([^\s])/gm;function text(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n="";return e&&(n=(e.textContent||"").replace(regExpNbspEntity," ").replace(regExpNbspHex," "),t&&(n=n.trim()),r&&(n=n.replace(regExpSpaces," $1"))),n}function toggleClass(e,t){e.classList?e.classList.toggle(t):hasClass(e,t)?removeClass(e,t):addClass(e,t)}function getWidth(e,t){var r=isWindow(e);return r?r.innerWidth:t?e.clientWidth:offset(e).width}var helpers={addEventListener:addEventListener,removeEventListener:removeEventListener,triggerEvent:triggerEvent,animate:animate,filter:filterEvents,listen:listen,style:style,getComputedStyle:getComputedStyle,attribute:attribute,activeElement:activeElement,ownerDocument:ownerDocument,ownerWindow:ownerWindow,requestAnimationFrame:request,cancelAnimationFrame:cancel,matches:matches,height:height,width:getWidth,offset:offset,offsetParent:offsetParent,position:position,contains:contains,scrollbarSize:scrollbarSize,scrollLeft:scrollLeft,scrollParent:scrollParent,scrollTo:scrollTo,scrollTop:scrollTop,querySelectorAll:qsa,closest:closest,addClass:addClass,removeClass:removeClass,hasClass:hasClass,toggleClass:toggleClass,transitionEnd:transitionEnd,childNodes:childNodes,childElements:childElements,nextUntil:nextUntil,parents:parents,siblings:siblings,clear:clear,insertAfter:insertAfter,isInput:isInput,isVisible:isVisible,prepend:prepend,remove:remove,text:text},Slider=function(){function e(t,r){_classCallCheck$3(this,e),this.ticks=[],this.range=[0,100],this.currentValue=0,this.currentTick={name:"",val:0,renderVal:0},this.buttonStatus=1,this.startClientX=0,this.wrapperWidth=1,this.wrapperLeft=0,this.handleChange=function(){},this.parent=t,this.ticks=r.ticks,this.itemProps=r,this.sliderTitle=document.createElement("div"),this.sliderTitle.innerHTML=r.name,this.sliderContent=document.createElement("div"),this.sliderValue=document.createElement("div"),this.wrapper=document.createElement("div"),this.inner=document.createElement("div"),this.button=document.createElement("div"),helpers.addClass(this.wrapper,"wrapper"),helpers.addClass(this.parent,"xg-player-slider"),helpers.addClass(this.sliderContent,"line-slider"),helpers.addClass(this.sliderTitle,"line-title"),helpers.addClass(this.sliderValue,"line-value"),this.renderTicks(),this.rendInner(),this.parent.appendChild(this.sliderTitle),this.parent.appendChild(this.sliderContent),this.parent.appendChild(this.sliderValue),this.sliderContent.appendChild(this.wrapper),this.bindEvents(),this.setValue(r.defaultValue)}return _createClass$3(e,[{key:"renderTicks",value:function(){var e=this.wrapper,t=document.createElement("div");helpers.addClass(t,"ticks");for(var r=1;r<this.ticks.length-1;r++){var n=this.ticks[r],i=document.createElement("div");helpers.addClass(i,"tick"),helpers.style(i,{left:n.val+"%"}),t.appendChild(i)}e.appendChild(t)}},{key:"rendInner",value:function(){var e=this.wrapper,t=this.inner;helpers.addClass(t,"inner");var r=this.button;helpers.addClass(r,"button"),e.appendChild(t),e.appendChild(r)}},{key:"bindEvents",value:function(){helpers.addEventListener(this.wrapper,"click",this.onClick.bind(this)),helpers.addEventListener(this.button,"touchstart",this.onTouchStart.bind(this)),helpers.addEventListener(this.button,"touchmove",lodash.exports.throttle(this.onTouchmove.bind(this),30)),helpers.addEventListener(this.button,"touchend",this.onTouchend.bind(this)),helpers.addEventListener(this.button,"touchcancel",this.onTouchend.bind(this))}},{key:"setValue",value:function(e){var t=this;if(e>this.range[1]||e<this.range[0])return!1;this.currentTick=this.getCurrentTick(e),this.currentValue=this.currentTick.val;var r=this.currentValue+"%";return setTimeout((function(){helpers.style(t.inner,{width:r}),helpers.style(t.button,{left:r})})),this.sliderValue.innerHTML=this.currentTick.name,this.handleChange(this.currentValue),!0}},{key:"renderText",value:function(e){var t=this;this.ticks=e.ticks,this.itemProps=e,this.sliderTitle.innerHTML=e.name,this.currentTick=this.ticks.filter((function(e){return e.val===t.currentValue}))[0],this.sliderValue.innerHTML=this.currentTick.name}},{key:"onChange",value:function(e){this.handleChange=e}},{key:"getCurrentTick",value:function(e){for(var t=0;t<this.ticks.length-1;t++)if(this.ticks[t].val<=e&&this.ticks[t+1].val>=e)return e-this.ticks[t].val>this.ticks[t+1].val-e?this.ticks[t+1]:this.ticks[t];return this.ticks[0]}},{key:"onMousedown",value:function(e){this.startClientX=e.clientX,this.onStart()}},{key:"onTouchStart",value:function(e){e.stopPropagation(),this.startClientX=e.touches[0].clientX,this.onStart()}},{key:"onStart",value:function(){this.buttonStatus=2;var e=helpers.offset(this.wrapper);this.wrapperWidth=e.width,this.wrapperLeft=e.left}},{key:"onMousemove",value:function(e){if(2===this.buttonStatus){var t=e.clientX-this.startClientX;this.onMove(t)}}},{key:"onTouchmove",value:function(e){e.stopPropagation();var t=e.touches[0].clientX-this.startClientX;this.onMove(t)}},{key:"onMove",value:function(e){var t=this.startClientX+e;if(!(t-this.wrapperLeft<0||t-this.wrapperLeft>this.wrapperWidth)){this.startClientX=this.startClientX+e;var r=(this.startClientX-this.wrapperLeft)*(this.range[1]-this.range[0])/this.wrapperWidth;helpers.style(this.inner,{width:r+"%"}),helpers.style(this.button,{left:r+"%"})}}},{key:"onMouseup",value:function(e){console.log("mouse up",e.clientX),this.onEnd()}},{key:"onTouchend",value:function(){this.onEnd()}},{key:"onEnd",value:function(){this.buttonStatus=3;var e=(this.startClientX-this.wrapperLeft)*(this.range[1]-this.range[0])/this.wrapperWidth;this.setValue(e)}},{key:"onClick",value:function(e){e.stopPropagation();var t=helpers.offset(this.wrapper);this.wrapperWidth=t.width,this.wrapperLeft=t.left;var r=(e.clientX-this.wrapperLeft)*(this.range[1]-this.range[0])/this.wrapperWidth;this.setValue(r)}}]),e}(),zh={danmuSwitch:"弹幕开关",danmuSetting:"弹幕设置",openDanmu:"打开弹幕",reset:"重置",opacity:"不透明度",area:"显示区域",speed:"弹幕速度",fontSize:"字体大小",danmuMask:"智能挡板",screen0:"1/4屏",screen1:"半屏",screen2:"3/4屏",screen3:"全屏",opacity0:"0",opacity1:"1/3",opacity2:"2/3",opacity3:"1",speed0:"0.25",speed1:"0.5",speed2:"正常",speed3:"1.25",speed4:"1.5",speed5:"2",fontSize0:"极小",fontSize1:"适中",fontSize2:"极大"},en={danmuSwitch:"Barrage switch",danmuSetting:"Barrage settings",openDanmu:"Open Barrage",reset:"Reset",opacity:"Opacity",area:"Display  area",speed:"Barrage speed",fontSize:"Font size",danmuMask:"Intelligent blocking",screen0:"1/4 screen",screen1:"Half screen",screen2:"3/4 screen",screen3:"Full screen",opacity0:"0",opacity1:"1/3",opacity2:"2/3",opacity3:"1",speed0:"0.25",speed1:"0.5",speed2:"Normal",speed3:"1.25",speed4:"1.5",speed5:"2",fontSize0:"Minimal",fontSize1:"Moderate",fontSize2:"Great"},jp=en,zhHK={danmuSwitch:"彈幕開關",danmuSetting:"彈幕設置",openDanmu:"打開彈幕",reset:"重置",opacity:"不透明度",area:"顯示區域",speed:"彈幕速度",fontSize:"字體大小",danmuMask:"智能擋板",screen0:"1/4屏",screen1:"半屏",screen2:"3/4屏",screen3:"全屏",opacity0:"0",opacity1:"1/3",opacity2:"2/3",opacity3:"1",speed0:"0.25",speed1:"0.5",speed2:"正常",speed3:"1.25",speed4:"1.5",speed5:"2",fontSize0:"極小",fontSize1:"適中",fontSize2:"極大"},lang={zh:zh,"zh-cn":zh,en:en,jp:jp,"zh-hk":zhHK},State=function(){function e(t){_classCallCheck$3(this,e),this.curLang="en",this._defaultConfig={opacity:99,area:99,fontSize:50,speed:40,active:!1,usePanel:!0,danmuItems:[],maskConfig:{maskUrl:"",maskOffset:0,interval:200},maskActive:!1,external:[]},Object.assign(this._defaultConfig,t)}return _createClass$3(e,[{key:"updateLang",value:function(e){this.curLang=e,this.curLangMap=lang[e]||lang.en;var t=this.curLangMap;this.sliderItemsProps=[{key:"opacity",name:t.opacity,defaultValue:99,ticks:[{name:t.opacity0,val:0,renderVal:0},{name:t.opacity1,val:33,renderVal:.33},{name:t.opacity2,val:66,renderVal:.66},{name:t.opacity3,val:99,renderVal:1}]},{key:"area",name:t.area,defaultValue:99,ticks:[{name:t.screen0,val:0,renderVal:1/4},{name:t.screen1,val:33,renderVal:.5},{name:t.screen2,val:66,renderVal:3/4},{name:t.screen3,val:99,renderVal:1}]},{key:"speed",name:t.speed,defaultValue:40,ticks:[{name:t.speed0,val:0,renderVal:1/4},{name:t.speed1,val:20,renderVal:.5},{name:t.speed2,val:40,renderVal:1},{name:t.speed3,val:60,renderVal:5/4},{name:t.speed4,val:80,renderVal:1.5},{name:t.speed5,val:100,renderVal:2}]},{key:"fontSize",name:t.fontSize,defaultValue:50,ticks:[{name:t.fontSize0,val:0,renderVal:14},{name:t.fontSize1,val:50,renderVal:16},{name:t.fontSize2,val:100,renderVal:20}]}],this._defaultConfig.external.forEach((function(t){t.name=t.lang[e]||t.lang.en}))}},{key:"getConfig",value:function(){return this._defaultConfig}},{key:"updateConfig",value:function(e){Object.assign(this._defaultConfig,e)}},{key:"updateComments",value:function(e){this._defaultConfig.danmuItems=e}},{key:"getRenderVal",value:function(e,t){var r=this.sliderItemsProps.find((function(t){return t.key===e}))||this.sliderItemsProps[0];return(r.ticks.find((function(e){return e.val===t}))||r.ticks[0]).renderVal}}]),e}(),dist$2={exports:{}};!function(e,t){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof$3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n={createDom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach((function(t){var n=t,o=r[t];"video"===e||"audio"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)})),i},hasClass:function(e,t){return e.classList?Array.prototype.some.call(e.classList,(function(e){return e===t})):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){e.classList?t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach((function(t){t&&e.classList.add(t)})):n.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){e.classList?t.split(/\s+/g).forEach((function(t){e.classList.remove(t)})):n.hasClass(e,t)&&t.split(/\s+/g).forEach((function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}))},toggleClass:function(e,t){t.split(/\s+/g).forEach((function(t){n.hasClass(e,t)?n.removeClass(e,t):n.addClass(e,t)}))},findDom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments[1],r=void 0;try{r=e.querySelector(t)}catch(n){t.startsWith("#")&&(r=e.getElementById(t.slice(1)))}return r},deepCopy:function(e,t){if("Object"===n.typeOf(t)&&"Object"===n.typeOf(e))return Object.keys(t).forEach((function(r){"Object"!==n.typeOf(t[r])||t[r]instanceof Node?"Array"===n.typeOf(t[r])?e[r]="Array"===n.typeOf(e[r])?e[r].concat(t[r]):t[r]:e[r]=t[r]:e[r]?n.deepCopy(e[r],t[r]):e[r]=t[r]})),e},typeOf:function(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]},copyDom:function(e){if(e&&1===e.nodeType){var t=document.createElement(e.tagName);return Array.prototype.forEach.call(e.attributes,(function(e){t.setAttribute(e.name,e.value)})),e.innerHTML&&(t.innerHTML=e.innerHTML),t}return""},formatTime:function(e){var t=Math.floor(e);return 1e3*t+(e-t)},offInDestroy:function(e,t,r,n){e.once(n,(function i(){e.off(t,r),e.off(n,i)}))},on:function(e,t,r,i){i?(e.on(t,r),n.offInDestroy(e,t,r,i)):e.on(t,(function n(i){r(i),e.off(t,n)}))},style:function(e,t,r){var n=e.style;try{n[t]=r}catch(i){n.setProperty(t,r)}}};t.default=n,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(26))&&n.__esModule?n:{default:n},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"setLogger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.logger=new o.default(e+".js")}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){var n=r(19)();e.exports=function(e){return e!==n&&null!==e}},function(e,t,r){e.exports=function(e){return null!=e}},function(e,t,r){e.exports=r(5)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(6))&&n.__esModule?n:{default:n};r(34),t.default=i.default,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(7)),o=d(r(1)),a=d(r(27)),s=d(r(31)),u=d(r(0)),c=r(32),l=r(33);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.setLogger("danmu"),r.logger&&r.logger.info("danmu.js version: "+c.version);var n=r;if(n.config=u.default.deepCopy({overlap:!1,area:{start:0,end:1},live:!1,comments:[],direction:"r2l",needResizeObserver:!1},e),n.hideArr=[],n.domObj=new s.default,(0,i.default)(n),n.config.comments.forEach((function(e){e.duration=e.duration?e.duration:5e3,e.mode||(e.mode="scroll")})),!n.config.container||1!==n.config.container.nodeType)return n.emit("error","container id can't be empty"),f(r,!1);if(n.container=n.config.container,n.config.containerStyle){var o=n.config.containerStyle;Object.keys(o).forEach((function(e){n.container.style[e]=o[e]}))}return n.live=n.config.live,n.player=n.config.player,n.direction=n.config.direction,u.default.addClass(n.container,"danmu"),n.bulletBtn=new a.default(n),n.isReady=!0,n.emit("ready"),r.logger&&r.logger.info("ready"),r.addResizeObserver(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"addResizeObserver",value:function(){var e=this;this.config.needResizeObserver&&(0,l.addObserver)(this.container,(function(){e.logger&&e.logger.info("needResizeObserver"),e.resize()}))}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.bulletBtn.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.bulletBtn.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.bulletBtn.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.bulletBtn.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.bulletBtn.main.clear()}},{key:"destroy",value:function(){for(var e in(0,l.unObserver)(this.container),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn.destroy(),this.domObj.destroy(),this)delete this[e];this.emit("destroy")}},{key:"sendComment",value:function(e){this.logger&&this.logger.info("sendComment: "+(e.txt||"[DOM Element]")),e.duration||(e.duration=15e3),e&&e.id&&e.duration&&(e.el||e.txt)&&(e.duration=e.duration?e.duration:5e3,e.style||(e.style={opacity:void 0,fontSize:void 0}),e.style&&(this.opacity&&this.opacity!==e.style.opacity&&(e.style.opacity=this.opacity),this.fontSize&&this.fontSize!==e.style.fontSize&&(e.style.fontSize=this.fontSize)),e.prior||e.realTime?(this.bulletBtn.main.data.unshift(e),e.realTime&&(this.bulletBtn.main.readData(),this.bulletBtn.main.dataHandle())):this.bulletBtn.main.data.push(e))}},{key:"setCommentID",value:function(e,t){var r=this;this.logger&&this.logger.info("setCommentID: oldID "+e+" newID "+t);var n=this.container.getBoundingClientRect();e&&t&&(this.bulletBtn.main.data.some((function(r){return r.id===e&&(r.id=t,!0)})),this.bulletBtn.main.queue.some((function(i){return i.id===e&&(i.id=t,i.pauseMove(n),"paused"!==r.bulletBtn.main.status&&i.startMove(n),!0)})))}},{key:"setCommentDuration",value:function(e,t){var r=this;this.logger&&this.logger.info("setCommentDuration: id "+e+" duration "+t);var n=this.container.getBoundingClientRect();e&&t&&(t=t||5e3,this.bulletBtn.main.data.some((function(r){return r.id===e&&(r.duration=t,!0)})),this.bulletBtn.main.queue.some((function(i){return i.id===e&&(i.duration=t,i.pauseMove(n),"paused"!==r.bulletBtn.main.status&&i.startMove(n),!0)})))}},{key:"setCommentLike",value:function(e,t){this.logger&&this.logger.info("setCommentLike: id "+e+" like "+t);var r=this.container.getBoundingClientRect();e&&t&&(this.bulletBtn.main.data.some((function(r){return r.id===e&&(r.like=t,!0)})),this.bulletBtn.main.queue.some((function(n){return n.id===e&&(n.pauseMove(r),n.setLikeDom(t.el,t.style),"paused"!==n.danmu.bulletBtn.main.status&&n.startMove(r),!0)})))}},{key:"restartComment",value:function(e){this.logger&&this.logger.info("restartComment: id "+e),this.mouseControl=!1;var t=this.container.getBoundingClientRect();e&&this.bulletBtn.main.queue.some((function(r){return r.id===e&&("paused"!==r.danmu.bulletBtn.main.status?r.startMove(t,!0):r.status="paused",!0)}))}},{key:"freezeComment",value:function(e){this.logger&&this.logger.info("freezeComment: id "+e),this.mouseControl=!0;var t=this.container.getBoundingClientRect();e&&this.bulletBtn.main.queue.some((function(r){return r.id===e&&(r.status="forcedPause",r.pauseMove(t),r.el&&r.el.style&&u.default.style(r.el,"zIndex",10),!0)}))}},{key:"removeComment",value:function(e){this.logger&&this.logger.info("removeComment: id "+e),e&&(this.bulletBtn.main.queue.some((function(t){return t.id===e&&(t.remove(),!0)})),this.bulletBtn.main.data=this.bulletBtn.main.data.filter((function(t){return t.id!==e})))}},{key:"updateComments",value:function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.bulletBtn.main.data=[]),this.bulletBtn.main.data=this.bulletBtn.main.data.concat(e)}},{key:"setAllDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll",t=arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.logger&&this.logger.info("setAllDuration: mode "+e+" duration "+t+" force "+r);var n=this.container.getBoundingClientRect();t&&(t=t||5e3,r&&(this.bulletBtn.main.forceDuration=t),this.bulletBtn.main.data.forEach((function(r){e===r.mode&&(r.duration=t)})),this.bulletBtn.main.queue.forEach((function(r){e===r.mode&&(r.duration=t,r.pauseMove(n),"paused"!==r.danmu.bulletBtn.main.status&&r.startMove(n))})))}},{key:"setOpacity",value:function(e){this.logger&&this.logger.info("setOpacity: opacity "+e),this.container.style.opacity=e}},{key:"setFontSize",value:function(e,t){var r=this;this.logger&&this.logger.info("setFontSize: size "+e+" channelSize "+t),this.fontSize=e+"px",e&&(this.bulletBtn.main.data.forEach((function(e){e.style&&(e.style.fontSize=r.fontSize)})),this.bulletBtn.main.queue.forEach((function(e){e.options.style||(e.options.style={}),e.options.style.fontSize=r.fontSize,e.setFontSize(r.fontSize),t&&(e.top=e.channel_id[0]*t,e.topInit())}))),t&&(this.config.channelSize=t,this.bulletBtn.main.channel.resize(!0))}},{key:"setArea",value:function(e){this.logger&&this.logger.info("setArea: area "+e),this.config.area=e,this.bulletBtn.main.channel.resize(!0)}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode "+e),this.hideArr.indexOf(e)<0&&this.hideArr.push(e),this.bulletBtn.main.queue.filter((function(t){return e===t.mode||"color"===e&&t.color})).forEach((function(e){return e.remove()}))}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode "+e);var t=this.hideArr.indexOf(e);t>-1&&this.hideArr.splice(t,1)}},{key:"setDirection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction "+e),this.emit("changeDirection",e)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}}]),t}(o.default);t.default=h,e.exports=t.default},function(e,t,r){var n,i,o,a,s,u,c,l=r(8),d=r(25),f=Function.prototype.apply,h=Function.prototype.call,p=Object.create,g=Object.defineProperty,y=Object.defineProperties,v=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var r,i;return d(t),i=this,n.call(this,e,r=function(){o.call(i,e,r),f.call(t,this,arguments)}),r.__eeOnceListener__=t,this},s={on:n=function(e,t){var r;return d(t),v.call(this,"__ee__")?r=this.__ee__:(r=m.value=p(null),g(this,"__ee__",m),m.value=null),r[e]?"object"==_typeof$3(r[e])?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:i,off:o=function(e,t){var r,n,i,o;if(d(t),!v.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"==_typeof$3(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},emit:a=function(e){var t,r,n,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==_typeof$3(i)){for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;n=i[t];++t)f.call(n,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];f.call(i,this,o)}}},u={on:l(n),once:l(i),off:l(o),emit:l(a)},c=y({},u),e.exports=t=function(e){return null==e?p(c):y(Object(e),u)},t.methods=s},function(e,t,r){var n=r(3),i=r(9),o=r(13),a=r(21),s=r(22);(e.exports=function(e,t){var r,i,u,c,l;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],n(e)?(r=s.call(e,"c"),i=s.call(e,"e"),u=s.call(e,"w")):(r=u=!0,i=!1),l={value:t,configurable:r,enumerable:i,writable:u},c?o(a(c),l):l}).gs=function(e,t,r){var u,c,l,d;return"string"!=typeof e?(l=r,r=t,t=e,e=null):l=arguments[3],n(t)?i(t)?n(r)?i(r)||(l=r,r=void 0):r=void 0:(l=t,t=r=void 0):t=void 0,n(e)?(u=s.call(e,"c"),c=s.call(e,"e")):(u=!0,c=!1),d={get:t,set:r,configurable:u,enumerable:c},l?o(a(l),d):d}},function(e,t,r){var n=r(10),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!n(e)&&!i.test(o.call(e))}},function(e,t,r){var n=r(11);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(t){return!1}return!n(e)}},function(e,t,r){var n=r(12);e.exports=function(e){if(!n(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(t){return!1}}},function(e,t,r){var n=r(3),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!n(e)&&hasOwnProperty.call(i,_typeof$3(e))}},function(e,t,r){e.exports=r(14)()?Object.assign:r(15)},function(e,t,r){e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,r){var n=r(16),i=r(20),o=Math.max;e.exports=function(e,t){var r,a,s,u=o(arguments.length,2);for(e=Object(i(e)),s=function(n){try{e[n]=t[n]}catch(i){r||(r=i)}},a=1;a<u;++a)n(t=arguments[a]).forEach(s);if(void 0!==r)throw r;return e}},function(e,t,r){e.exports=r(17)()?Object.keys:r(18)},function(e,t,r){e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,r){var n=r(2),i=Object.keys;e.exports=function(e){return i(n(e)?Object(e):e)}},function(e,t,r){e.exports=function(){}},function(e,t,r){var n=r(2);e.exports=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,r){var n=r(2),i=Array.prototype.forEach,o=Object.create,a=function(e,t){var r;for(r in e)t[r]=e[r]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){n(e)&&a(Object(e),t)})),t}},function(e,t,r){e.exports=r(23)()?String.prototype.contains:r(24)},function(e,t,r){var n="razdwatrzy";e.exports=function(){return"function"==typeof n.contains&&!0===n.contains("dwa")&&!1===n.contains("foo")}},function(e,t,r){var n=String.prototype.indexOf;e.exports=function(e){return n.call(this,e,arguments[1])>-1}},function(e,t,r){e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i="undefined"!=typeof window&&window.location.href.indexOf("danmu-debug")>-1,o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.constructorName=t||""}return n(e,[{key:"info",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];i&&(t=console).log.apply(t,["[Danmu Log]["+this.constructorName+"]",e].concat(n))}}]),e}();t.default=o,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(1)),o=s(r(0)),a=s(r(28));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.setLogger("control"),r.danmu=e,r.main=new a.default(e),e.config.defaultOff||r.main.start(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"createSwitch",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=o.default.createDom("dk-switch",'<span class="txt">弹</span>',{},"danmu-switch "+(e?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)delete this[e]}}]),t}(i.default);t.default=u,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(1)),o=u(r(29)),a=u(r(30)),s=u(r(0));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.setLogger("main"),r.danmu=e,r.container=e.container,r.channel=new o.default(e),r.data=[].concat(e.config.comments),r.playedData=[],r.queue=[],r.timer=null,r.retryTimer=null,r.retryStatus="normal",r.interval=e.config.interval||2e3,r.status="idle",s.default.on(e,"bullet_remove",r.updateQueue.bind(r),"destroy");var n=r;return s.default.on(r.danmu,"changeDirection",(function(e){n.danmu.direction=e}),"destroy"),r.nums=0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),clearTimeout(this.dataHandleTimer),this.channel.destroy(),this.data=[],this)delete this[e]}},{key:"updateQueue",value:function(e){this.logger&&this.logger.info("updateQueue");var t=this;t.queue.some((function(r,n){return r.id===e.bullet.id&&(t.queue.splice(n,1),!0)})),t.data.some((function(t,r){return t.id===e.bullet.id&&(t.hasAttached=!1,!0)}))}},{key:"init",value:function(e,t){t.logger&&t.logger.info("init"),t||(t=this),t.retryStatus="normal",t.data.sort((function(e,t){return e.start-t.start})),t.retryTimer||function e(){"closed"===t.status&&"stop"===t.retryStatus||("playing"===t.status&&(t.readData(),t.dataHandle()),"stop"===t.retryStatus&&"paused"!==t.status||(t.dataHandleTimer=setTimeout((function(){e()}),t.interval-1e3)))}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.status="playing",this.queue=[],this.container.innerHTML="",this.channel.resetWithCb(this.init,this)}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.status="closed",this.retryTimer=null,this.retryStatus="stop",this.channel.reset(),this.queue=[],this.container.innerHTML=""}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel.reset(),this.data=[],this.queue=[],this.container.innerHTML=""}},{key:"play",value:function(){var e=this;this.logger&&this.logger.info("play"),this.status="playing";var t=this.channel.channels,r=this.danmu.container.getBoundingClientRect();t&&t.length>0&&["scroll","top","bottom"].forEach((function(n){e.queue.forEach((function(e){e.startMove(r),e.resized=!0}));for(var i=0;i<t.length;i++)t[i].queue[n].forEach((function(e){e.resized=!1}))}))}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.status="paused";var e=this.channel.channels,t=this.danmu.container.getBoundingClientRect();e&&e.length>0&&this.queue.forEach((function(e){e.pauseMove(t)}))}},{key:"dataHandle",value:function(){var e=this;"paused"!==this.status&&"closed"!==this.status&&e.queue.length&&e.queue.forEach((function(t){"waiting"===t.status&&t.startMove(e.channel.containerPos)}))}},{key:"readData",value:function(){var e=this,t=this.danmu;if(t.isReady){var r=0;t.player&&t.player.currentTime&&(r=s.default.formatTime(t.player.currentTime));var n=void 0,i=e.interval,o=e.channel,u=void 0;t.player?(u=e.data.filter((function(t){return!t.start&&e.danmu.hideArr.indexOf(t.mode)<0&&(!t.color||e.danmu.hideArr.indexOf("color")<0)&&(t.start=r),e.danmu.hideArr.indexOf(t.mode)<0&&(!t.color||e.danmu.hideArr.indexOf("color")<0)&&t.start-i<=r&&r<=t.start+i})),t.live&&(e.data=[])):0===(u=e.data.splice(0,1)).length&&(u=e.playedData.splice(0,1)),u.length>0&&u.forEach((function(r){if(e.forceDuration&&e.forceDuration!=r.duration&&(r.duration=e.forceDuration),(n=new a.default(t,r))&&!n.bulletCreateFail)if(r.hasAttached){for(var i in n.detach(),n)delete n[i];n=null,r.hasAttached=!1,r.noDiscard&&(r.prior?e.data.unshift(r):e.data.push(r))}else if(n.attach(),r.hasAttached=!0,o.addBullet(n).result)e.queue.push(n),e.nums++,n.topInit();else{for(var s in n.detach(),n)delete n[s];n=null,r.hasAttached=!1,r.noDiscard&&(r.prior?e.data.unshift(r):e.data.push(r))}}))}}}]),t}(i.default);t.default=c,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=a(r(1)),o=a(r(0));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.setLogger("channel"),r.danmu=e,r.reset(!0);var n=r;return o.default.on(r.danmu,"bullet_remove",(function(e){n.removeBullet(e.bullet)}),"destroy"),r.direction=e.direction,o.default.on(r.danmu,"changeDirection",(function(e){n.direction=e}),"destroy"),r.containerPos=r.danmu.container.getBoundingClientRect(),r.containerWidth=r.containerPos.width,r.containerHeight=r.containerPos.height,r.containerLeft=r.containerPos.left,r.containerRight=r.containerPos.right,o.default.on(r.danmu,"channel_resize",(function(){n.containerPos=n.danmu.container.getBoundingClientRect(),n.resizing||(n.containerWidth=n.containerPos.width,n.containerHeight=n.containerPos.height,n.containerLeft=n.containerPos.left,n.containerRight=n.containerPos.right,n.resize(!0))}),"destroy"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.logger&&this.logger.info("destroy"),clearTimeout(this.resizeTimer),this.channels=[],this)delete this[e]}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger&&this.logger.info("resize");var t=this.danmu.container,r=this;r.resizing||(r.resizing=!0,this.resizeTimer=setTimeout((function(){r.danmu.bulletBtn.main.data&&r.danmu.bulletBtn.main.data.forEach((function(e){e.bookChannelId&&(delete e.bookChannelId,r.logger&&r.logger.info("resize导致"+e.id+"号优先弹幕预定取消"))})),r.logger&&r.logger.info("resize导致所有轨道恢复正常使用");var n=t.getBoundingClientRect();r.width=n.width,r.height=n.height,r.danmu.config.area&&r.danmu.config.area.start>=0&&r.danmu.config.area.end>=r.danmu.config.area.start&&("b2t"===r.direction?r.width=r.width*(r.danmu.config.area.end-r.danmu.config.area.start):r.height=r.height*(r.danmu.config.area.end-r.danmu.config.area.start)),r.container=t;var i=r.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),o=void 0;o="b2t"===r.direction?Math.floor(r.width/i):Math.floor(r.height/i);for(var a=[],s=0;s<o;s++)a[s]={id:s,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(r.channels&&r.channels.length<=a.length){for(var u=function(t){a[t]={id:t,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach((function(n){r.channels[t].queue[n].forEach((function(i){i.el&&(a[t].queue[n].push(i),i.resized||(i.pauseMove(r.containerPos,e),"paused"!==i.danmu.bulletBtn.main.status&&i.startMove(r.containerPos),i.resized=!0))}))})),r.channels[t].queue.bottom.forEach((function(n){if(n.el){if(a[t+a.length-r.channels.length].queue.bottom.push(n),n.channel_id[0]+n.channel_id[1]-1===t){var o=[].concat(n.channel_id);n.channel_id=[o[0]-r.channels.length+a.length,o[1]],n.top=n.channel_id[0]*i,r.danmu.config.area&&r.danmu.config.area.start&&(n.top+=r.containerHeight*r.danmu.config.area.start),n.topInit()}n.resized||(n.pauseMove(r.containerPos,e),"paused"!==n.danmu.bulletBtn.main.status&&n.startMove(r.containerPos),n.resized=!0)}}))},c=0;c<r.channels.length;c++)u(c);for(var l=function(e){["scroll","top","bottom"].forEach((function(t){a[e].queue[t].forEach((function(e){e.resized=!1}))}))},d=0;d<a.length;d++)l(d);r.channels=a,"b2t"===r.direction?r.channelWidth=i:r.channelHeight=i}else if(r.channels&&r.channels.length>a.length){for(var f=function(t){a[t]={id:t,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach((function(n){if("top"===n&&t>Math.floor(a.length/2));else if("bottom"===n&&t<=Math.floor(a.length/2));else{var o="bottom"===n?t-a.length+r.channels.length:t;r.channels[o].queue[n].forEach((function(s,u){if(s.el){if(a[t].queue[n].push(s),"bottom"===n&&s.channel_id[0]+s.channel_id[1]-1===o){var c=[].concat(s.channel_id);s.channel_id=[c[0]-r.channels.length+a.length,c[1]],s.top=s.channel_id[0]*i,r.danmu.config.area&&r.danmu.config.area.start&&(s.top+=r.containerHeight*r.danmu.config.area.start),s.topInit()}s.pauseMove(r.containerPos,e),"paused"!==s.danmu.bulletBtn.main.status&&s.startMove(r.containerPos),s.resized||(s.resized=!0)}r.channels[o].queue[n].splice(u,1)}))}}))},h=0;h<a.length;h++)f(h);for(var p=function(e){["scroll","top","bottom"].forEach((function(t){a[e].queue[t].forEach((function(e){e.resized=!1}))}))},g=0;g<a.length;g++)p(g);r.channels=a,"b2t"===r.direction?r.channelWidth=i:r.channelHeight=i}r.resizing=!1}),10))}},{key:"addBullet",value:function(e){var t=this,r=this.danmu,n=this.channels,i=void 0,o=void 0,a=void 0;if("b2t"===t.direction?(o=this.channelWidth,a=Math.ceil(e.width/o)):(i=this.channelHeight,a=Math.ceil(e.height/i)),a>n.length)return{result:!1,message:"exceed channels.length, occupy="+a+",channelsSize="+n.length};for(var s=!0,u=void 0,c=-1,l=0,d=n.length;l<d;l++)if(n[l].queue[e.mode].some((function(t){return t.id===e.id})))return{result:!1,message:"exsited, channelOrder="+l+",danmu_id="+e.id};if("scroll"===e.mode)for(var f=0,h=n.length-a;f<=h;f++){s=!0;for(var p=f;p<f+a;p++){if((u=n[p]).operating.scroll){s=!1;break}if(u.bookId.scroll&&u.bookId.scroll!==e.id){s=!1;break}u.operating.scroll=!0;var g=u.queue.scroll[0];if(g){var y=g.el.getBoundingClientRect();if("b2t"===t.direction){if(y.bottom>t.containerPos.bottom){s=!1,u.operating.scroll=!1;break}}else if(y.right>t.containerPos.right){s=!1,u.operating.scroll=!1;break}var v,m=void 0,_=void 0,b=void 0,A=void 0;if("b2t"===t.direction?(_=(y.top-t.containerPos.top+y.height)/(m=(t.containerPos.height+y.height)/g.duration),b=t.containerPos.height,A=(t.containerPos.height+e.height)/e.duration):(_=(y.left-t.containerPos.left+y.width)/(m=(t.containerPos.width+y.width)/g.duration),b=t.containerPos.width,A=(t.containerPos.width+e.width)/e.duration),v=b/A,r.config.bOffset||(r.config.bOffset=0),m<A&&_+r.config.bOffset>v){s=!1,u.operating.scroll=!1;break}}u.operating.scroll=!1}if(s){c=f;break}}else if("top"===e.mode)for(var E=0,S=n.length-a;E<=S;E++){s=!0;for(var T=E;T<E+a;T++){if(T>Math.floor(n.length/2)){s=!1;break}if((u=n[T]).operating[e.mode]){s=!1;break}if((u.bookId[e.mode]||e.prior)&&u.bookId[e.mode]!==e.id){s=!1;break}if(u.operating[e.mode]=!0,u.queue[e.mode].length>0){s=!1,u.operating[e.mode]=!1;break}u.operating[e.mode]=!1}if(s){c=E;break}}else if("bottom"===e.mode)for(var $=n.length-a;$>=0;$--){s=!0;for(var w=$;w<$+a;w++){if(w<=Math.floor(n.length/2)){s=!1;break}if((u=n[w]).operating[e.mode]){s=!1;break}if((u.bookId[e.mode]||e.prior)&&u.bookId[e.mode]!==e.id){s=!1;break}if(u.operating[e.mode]=!0,u.queue[e.mode].length>0){s=!1,u.operating[e.mode]=!1;break}u.operating[e.mode]=!1}if(s){c=$;break}}if(-1!==c){for(var C=c,I=c+a;C<I;C++)(u=n[C]).operating[e.mode]=!0,u.queue[e.mode].unshift(e),e.prior&&(delete u.bookId[e.mode],t.logger&&t.logger.info(C+"号轨道恢复正常使用")),u.operating[e.mode]=!1;return e.prior&&(t.logger&&t.logger.info(e.id+"号优先弹幕运行完毕"),delete e.bookChannelId,r.player&&r.bulletBtn.main.data.some((function(t){return t.id===e.id&&(delete t.bookChannelId,!0)}))),e.channel_id=[c,a],"b2t"===t.direction?(e.top=c*o,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerWidth*t.danmu.config.area.start)):(e.top=c*i,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerHeight*t.danmu.config.area.start)),{result:e,message:"success"}}if(e.options.realTime){var k=0,O=-1,P=null;if(t.danmu.bulletBtn.main.queue.forEach((function(e,r){!e.prior&&!e.options.realTime&&e.el&&e.el.getBoundingClientRect().left>t.containerPos.right&&e.start>=k&&(k=e.start,O=r,P=e)})),P){P.remove(),t.removeBullet(P),t.danmu.bulletBtn.main.queue.splice(O,1),e.channel_id=P.channel_id;for(var R=P.channel_id[0],x=P.channel_id[0]+P.channel_id[1];R<x;R++)(u=n[R]).operating[e.mode]=!0,u.queue[e.mode].unshift(e),e.prior&&delete u.bookId[e.mode],u.operating[e.mode]=!1;return e.top=P.top,t.danmu.config.area&&t.danmu.config.area.start&&(e.top+=t.containerHeight*t.danmu.config.area.start),{result:e,message:"success"}}}if(e.prior)if(e.bookChannelId||t.danmu.live)r.player&&r.bulletBtn.main.data.some((function(r){return r.id===e.id&&(t.logger&&t.logger.info(e.id+"号优先弹幕将于2秒后再次请求注册"),r.start+=2e3,!0)}));else{c=-1;for(var D=0,L=n.length-a;D<=L;D++){s=!0;for(var N=D;N<D+a;N++)if(n[N].bookId[e.mode]){s=!1;break}if(s){c=D;break}}if(-1!==c){for(var M=c;M<c+a;M++)n[M].bookId[e.mode]=e.id,t.logger&&t.logger.info(M+"号轨道被"+e.id+"号优先弹幕预定");r.player&&r.bulletBtn.main.data.some((function(r){return r.id===e.id&&(t.logger&&t.logger.info(e.id+"号优先弹幕将于2秒后再次请求注册"),r.start+=2e3,r.bookChannelId=[c,a],t.logger&&t.logger.info(e.id+"号优先弹幕预定了"+c+"~"+(c+a-1)+"号轨道"),!0)}))}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(e){this.logger&&this.logger.info("removeBullet "+(e.options.txt||"[DOM Element]"));for(var t=this.channels,r=e.channel_id,n=void 0,i=r[0],o=r[0]+r[1];i<o;i++)if(n=t[i]){n.operating[e.mode]=!0;var a=-1;n.queue[e.mode].some((function(t,r){return t.id===e.id&&(a=r,!0)})),a>-1&&n.queue[e.mode].splice(a,1),n.operating[e.mode]=!1}e.options.loop&&this.danmu.bulletBtn.main.playedData.push(e.options)}},{key:"resetArea",value:function(){this.logger&&this.logger.info("resetArea");var e=this.danmu.container,t=this,r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.danmu.config.area&&t.danmu.config.area.start>=0&&t.danmu.config.area.end>=t.danmu.config.area.start&&("b2t"===t.direction?t.width=t.width*(t.danmu.config.area.end-t.danmu.config.area.start):t.height=t.height*(t.danmu.config.area.end-t.danmu.config.area.start)),t.container=e;var n=t.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),i=void 0;i="b2t"===t.direction?Math.floor(t.width/n):Math.floor(t.height/n);for(var o=[],a=0;a<i;a++)o[a]={id:a,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(t.channels&&t.channels.length<=o.length){for(var s=function(e){o[e]={id:e,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach((function(r){t.channels[e].queue[r].forEach((function(n){n.el&&(o[e].queue[r].push(n),n.resized||(n.pauseMove(t.containerPos,!1),n.startMove(t.containerPos),n.resized=!0))}))})),t.channels[e].queue.bottom.forEach((function(r){if(r.el){if(o[e+o.length-t.channels.length].queue.bottom.push(r),r.channel_id[0]+r.channel_id[1]-1===e){var i=[].concat(r.channel_id);r.channel_id=[i[0]-t.channels.length+o.length,i[1]],r.top=r.channel_id[0]*n,t.danmu.config.area&&t.danmu.config.area.start&&(r.top+=t.containerHeight*t.danmu.config.area.start),r.topInit()}r.resized||(r.pauseMove(t.containerPos,!1),r.startMove(t.containerPos),r.resized=!0)}}))},u=0;u<t.channels.length;u++)s(u);for(var c=function(e){["scroll","top","bottom"].forEach((function(t){o[e].queue[t].forEach((function(e){e.resized=!1}))}))},l=0;l<o.length;l++)c(l);t.channels=o,"b2t"===t.direction?t.channelWidth=n:t.channelHeight=n}else if(t.channels&&t.channels.length>o.length){for(var d=function(e){o[e]={id:e,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach((function(r){if("top"===r&&e>Math.floor(o.length/2));else if("bottom"===r&&e<=Math.floor(o.length/2));else{var i="bottom"===r?e-o.length+t.channels.length:e;t.channels[i].queue[r].forEach((function(a,s){if(a.el){if(o[e].queue[r].push(a),"bottom"===r&&a.channel_id[0]+a.channel_id[1]-1===i){var u=[].concat(a.channel_id);a.channel_id=[u[0]-t.channels.length+o.length,u[1]],a.top=a.channel_id[0]*n,t.danmu.config.area&&t.danmu.config.area.start&&(a.top+=t.containerHeight*t.danmu.config.area.start),a.topInit()}a.resized||(a.pauseMove(t.containerPos,!1),a.startMove(t.containerPos),a.resized=!0)}t.channels[i].queue[r].splice(s,1)}))}}))},f=0;f<o.length;f++)d(f);for(var h=function(e){["scroll","top","bottom"].forEach((function(t){o[e].queue[t].forEach((function(e){e.resized=!1}))}))},p=0;p<o.length;p++)h(p);t.channels=o,"b2t"===t.direction?t.channelWidth=n:t.channelHeight=n}}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger&&this.logger.info("reset");var t=this.danmu.container,r=this;function n(){var e=t.getBoundingClientRect();r.width=e.width,r.height=e.height,r.danmu.config.area&&r.danmu.config.area.start>=0&&r.danmu.config.area.end>=r.danmu.config.area.start&&("b2t"===r.direction?r.width=r.width*(r.danmu.config.area.end-r.danmu.config.area.start):r.height=r.height*(r.danmu.config.area.end-r.danmu.config.area.start)),r.container=t;var n=r.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),i=void 0;i="b2t"===r.direction?Math.floor(r.width/n):Math.floor(r.height/n);for(var o=[],a=0;a<i;a++)o[a]={id:a,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};r.channels=o,"b2t"===r.direction?r.channelWidth=n:r.channelHeight=n}r.danmu.bulletBtn&&r.danmu.bulletBtn.main&&r.danmu.bulletBtn.main.queue.forEach((function(e){e.pauseMove(r.containerPos),e.remove()})),r.channels&&r.channels.length>0&&["scroll","top","bottom"].forEach((function(e){for(var t=0;t<r.channels.length;t++)r.channels[t].queue[e].forEach((function(e){e.pauseMove(r.containerPos),e.remove()}))})),r.danmu.bulletBtn&&r.danmu.bulletBtn.main&&r.danmu.bulletBtn.main.data&&r.danmu.bulletBtn.main.data.forEach((function(e){e.hasAttached=!1})),e?this.resetTimer=setTimeout(n,200):n()}},{key:"resetWithCb",value:function(e,t){this.logger&&this.logger.info("resetWithCb");var r=this.danmu.container,n=this;n.channels&&n.channels.length>0&&["scroll","top","bottom"].forEach((function(e){for(var t=0;t<n.channels.length;t++)n.channels[t].queue[e].forEach((function(e){e.pauseMove(n.containerPos),e.remove()}))}));var i=r.getBoundingClientRect();n.width=i.width,n.height=i.height,n.danmu.config.area&&n.danmu.config.area.start>=0&&n.danmu.config.area.end>=n.danmu.config.area.start&&("b2t"===n.direction?n.width=n.width*(n.danmu.config.area.end-n.danmu.config.area.start):n.height=n.height*(n.danmu.config.area.end-n.danmu.config.area.start)),n.container=r;var o=n.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),a=void 0;a="b2t"===n.direction?Math.floor(n.width/o):Math.floor(n.height/o);for(var s=[],u=0;u<a;u++)s[u]={id:u,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};n.channels=s,n.channelHeight=o,e&&e(!0,t)}}]),t}(i.default);t.default=s,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=a(r(1)),o=a(r(0));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof$3(t)&&"function"!=typeof t?e:t}var u=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.setLogger("bullet"),n.danmu=e,n.options=r,n.duration=r.duration,n.moveV=r.moveV,n.id=r.id,n.container=e.container,n.start=r.start,n.prior=r.prior,n.color=r.color,n.bookChannelId=r.bookChannelId,n.direction=e.direction,n.reuseDOM=!0;var i=n,a=void 0;if(n.domObj=e.domObj,r.el&&1===r.el.nodeType){if(r.el.parentNode)return s(n,{bulletCreateFail:!0});if(e.config.disableCopyDOM)a=r.el,n.reuseDOM=!1;else{a=n.domObj.use();var u=o.default.copyDom(r.el);r.eventListeners&&r.eventListeners.length>0&&r.eventListeners.forEach((function(e){u.addEventListener(e.event,e.listener,e.useCapture||!1)})),a.appendChild(u)}}else(a=n.domObj.use()).textContent=r.txt;if(n.onChangeDirection=function(e){i.direction=e},n.danmu.on("changeDirection",n.onChangeDirection),r.style){var c=r.style;Object.keys(c).forEach((function(e){o.default.style(a,e,c[e])}))}"top"===r.mode||"bottom"===r.mode?n.mode=r.mode:n.mode="scroll",n.el=a,r.like&&r.like.el&&n.setLikeDom(r.like.el,r.like.style),n.status="waiting";var l=n.container.getBoundingClientRect(),d=Math.floor(Math.random()*(l.width/10>100?200:l.width/10));r.realTime&&(d=0);var f=l.width+d+"px";return o.default.style(n.el,"left",f),n.containerPos=l,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof$3(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"attach",value:function(){if(this.container.appendChild(this.el),this.elPos=this.el.getBoundingClientRect(),"b2t"===this.direction?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV){var e=this.containerPos;this.duration=(e.width+this.width)/this.moveV*1e3}this.danmu.config&&this.danmu.config.mouseControl&&(this.mouseoverFunWrapper=this.mouseoverFun.bind(this),this.el.addEventListener("mouseover",this.mouseoverFunWrapper,!1)),this.danmu.config&&this.danmu.config.mouseEnterControl&&(this.mouseEnterFunWrapper=this.mouseoverFun.bind(this),this.el.addEventListener("mouseenter",this.mouseEnterFunWrapper,!1))}},{key:"mouseoverFun",value:function(e){this.danmu&&this.danmu.mouseControl&&this.danmu.config.mouseControlPause||"waiting"===this.status||"end"===this.status||this.danmu&&this.danmu.emit("bullet_hover",{bullet:this,event:e})}},{key:"detach",value:function(){this.el&&(this.danmu.config&&this.danmu.config.mouseControl&&this.el.removeEventListener("mouseover",this.mouseoverFunWrapper,!1),this.danmu.config&&this.danmu.config.mouseEnterControl&&this.el.removeEventListener("mouseenter",this.mouseEnterFunWrapper,!1),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.reuseDOM&&this.domObj.unuse(this.el),this.el=null),this.danmu.off("changeDirection",this.onChangeDirection)}},{key:"topInit",value:function(){if(this.logger&&this.logger.info("topInit #"+(this.options.txt||"[DOM Element]")+"#"),"b2t"===this.direction){var e=this.containerPos;o.default.style(this.el,"transformOrigin","left top"),o.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+e.height+"px) translateZ(0px) rotate(90deg)"),o.default.style(this.el,"transition","transform 0s linear 0s")}else o.default.style(this.el,"top",this.top+"px")}},{key:"pauseMove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.logger&&this.logger.info("pauseMove #"+(this.options.txt||"[DOM Element]")+"#");var r=this;if("paused"!==this.status&&("forcedPause"!==r.status&&(this.status="paused"),clearTimeout(r.removeTimer),this.el))if(o.default.style(this.el,"willChange","auto"),"scroll"===this.mode){if(t){var n=((new Date).getTime()-r.moveTime)/1e3*this.moveV,i=0;i=r.moveMoreS-n>=0?"b2t"===this.direction?(r.moveMoreS-n)/r.moveContainerHeight*e.height:(r.moveMoreS-n)/r.moveContainerWidth*e.width:r.moveMoreS-n,"b2t"===this.direction?o.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+i+"px) translateZ(0px) rotate(90deg)"):o.default.style(this.el,"left",i+"px")}else"b2t"===this.direction?o.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+(this.el.getBoundingClientRect().top-e.top)+"px) translateZ(0px) rotate(90deg)"):o.default.style(this.el,"left",this.el.getBoundingClientRect().left-e.left+"px");"b2t"===this.direction||o.default.style(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),o.default.style(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+(new Date).getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(e,t){this.logger&&this.logger.info("startMove #"+(this.options.txt||"[DOM Element]")+"#");var r=this;if(r.hasMove||(r.danmu.emit("bullet_start",r),r.hasMove=!0),("forcedPause"!==r.status||t)&&this.el&&"start"!==this.status)if(this.status="start",o.default.style(this.el,"willChange","transform"),"scroll"===this.mode)if("b2t"===this.direction){this.moveV=(e.height+this.height)/this.duration*1e3;var n=(r.el.getBoundingClientRect().bottom-e.top)/this.moveV;o.default.style(this.el,"transition","transform "+n+"s linear 0s"),this.startMoveTimer=setTimeout((function(){r.el&&(o.default.style(r.el,"transform","translateX(-"+r.top+"px) translateY(-"+r.height+"px) translateZ(0px) rotate(90deg)"),r.moveTime=(new Date).getTime(),r.moveMoreS=r.el.getBoundingClientRect().top-e.top,r.moveContainerHeight=e.height,r.removeTimer=setTimeout(u,1e3*n))}),20)}else{var i=this.el.getBoundingClientRect();this.moveV=(e.width+this.width)/this.duration*1e3;var a=(i.right-e.left)/this.moveV;o.default.style(this.el,"transition","transform "+a+"s linear 0s"),this.startMoveTimer=setTimeout((function(){if(r.el){var t=r.el.getBoundingClientRect(),n=(t.right-e.left)/a;t.right>e.left&&n>r.moveV-1&&n<r.moveV+1?(o.default.style(r.el,"transform","translateX(-"+(t.right-e.left)+"px) translateY(0px) translateZ(0px)"),r.moveTime=(new Date).getTime(),r.moveMoreS=t.left-e.left,r.moveContainerWidth=e.width,r.removeTimer=setTimeout(u,1e3*a)):(r.status="end",r.remove())}}),0)}else{o.default.style(this.el,"left","50%"),o.default.style(this.el,"margin","0 0 0 -"+this.width/2+"px"),this.pastDuration||(this.pastDuration=1);var s=this.duration>=this.pastDuration?this.duration-this.pastDuration:0;this.removeTimer=setTimeout(u,s),this.startTime=(new Date).getTime()}function u(){if(r.el)if("scroll"===r.mode){var e=r.containerPos,t=r.el.getBoundingClientRect();"b2t"===r.direction?t&&t.bottom<=e.top+100?(r.status="end",r.remove()):(r.pauseMove(e),"paused"!==r.danmu.bulletBtn.main.status&&r.startMove(e)):t&&t.right<=e.left+100?(r.status="end",r.remove()):(r.pauseMove(e),"paused"!==r.danmu.bulletBtn.main.status&&r.startMove(e))}else r.status="end",r.remove()}}},{key:"remove",value:function(){this.logger&&this.logger.info("remove #"+(this.options.txt||"[DOM Element]")+"#"),this.removeTimer&&clearTimeout(this.removeTimer),this.startMoveTimer&&clearTimeout(this.startMoveTimer),this.el&&this.el.parentNode&&(o.default.style(this.el,"willChange","auto"),this.detach(),this.options.el&&1===this.options.el.nodeType&&this.danmu.config.disableCopyDOM&&o.default.style(this.options.el,"transform","none"),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(e){this.el&&(this.el.style.fontSize=e)}},{key:"setLikeDom",value:function(e,t){if(e&&(Object.keys(t).forEach((function(r){e.style[r]=t[r]})),e.className="danmu-like",this.el)){var r=this.el.querySelector(".danmu-like");r&&this.el.removeChild(r),this.el.innerHTML=""+this.el.innerHTML+e.outerHTML}return e}}]),t}(i.default);t.default=u,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(0))&&n.__esModule?n:{default:n},a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t={initDOM:function(){return document.createElement("div")},initSize:10},this.init(t)}return i(e,[{key:"init",value:function(e){this.idleList=[],this.usingList=[],this._id=0,this.options=e,this._expand(e.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var e=this.idleList.shift();return this.usingList.push(e),e}},{key:"unuse",value:function(e){var t=this.usingList.indexOf(e);t<0||(this.usingList.splice(t,1),e.innerHTML="",e.textcontent="",this.clearElementStyle(e),this.idleList.push(e))}},{key:"_expand",value:function(e){for(var t=0;t<e;t++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var e=0;e<this.idleList.length;e++)this.idleList[e].innerHTML="",this.idleList[e].textcontent="",this.clearElementStyle(this.idleList[e]);for(var t=0;t<this.usingList.length;t++)this.usingList[t].innerHTML="",this.usingList[t].textcontent="",this.clearElementStyle(this.usingList[t]);for(var r in this)delete this[r]}},{key:"clearElementStyle",value:function(e){var t="undefined"!=typeof window?window.navigator.userAgent:null;t&&(t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1?o.default.style(e,"transform","none"):e.setAttribute("style",""))}}]),e}();t.default=a,e.exports=t.default},function(e){e.exports=JSON.parse('{"version":"0.6.3"}')},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=new(function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__handlers=[],window.ResizeObserver)try{this.observer=new window.ResizeObserver((function(e){var r=(new Date).getTime();r-t.timeStampe<200||(t.timeStampe=r,t.__trigger(e))})),this.timeStampe=(new Date).getTime()}catch(r){}}return n(e,[{key:"addObserver",value:function(e,t){if(this.observer){this.observer&&this.observer.observe(e);for(var r=this.__handlers,n=-1,i=0;i<r.length;i++)r[i]&&e===r[i].target&&(n=i);n>-1?this.__handlers[n].handler.push(t):this.__handlers.push({target:e,handler:[t]})}}},{key:"unObserver",value:function(e){var t=-1;this.__handlers.map((function(r,n){e===r.target&&(t=n)})),this.observer&&this.observer.unobserve(e),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(e){for(var t=this.__handlers,r=0;r<t.length;r++)if(t[r]&&e===t[r].target){t[r].handler&&t[r].handler.map((function(e){try{e()}catch(t){console.error(t)}}));break}}},{key:"__trigger",value:function(e){var t=this;e.map((function(e){t.__runHandler(e.target)}))}}]),e}());t.addObserver=function(e,t){i.addObserver(e,t)},t.unObserver=function(e,t){i.unObserver(e,t)},t.destroyObserver=function(e,t){i.destroyObserver(e,t)}},function(e,t,r){var n=r(35);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(37)(n,i),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(36)(!1)).push([e.i,".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#ffffff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}\n",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(a).concat([o]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(e,t,r){var n,i,o,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),u=function(e){return document.querySelector(e)},c=(o={},function(e){if("function"==typeof e)return e();if(void 0===o[e]){var t=u.call(this,e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(r){t=null}o[e]=t}return o[e]}),l=null,d=0,f=[],h=r(38);function p(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=a[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(b(n.parts[o],t))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(b(n.parts[o],t));a[n.id]={id:n.id,refs:1,parts:s}}}}function g(e,t){for(var r=[],n={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};n[a]?n[a].parts.push(s):r.push(n[a]={id:a,parts:[s]})}return r}function y(e,t){var r=c(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=f[f.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),f.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=_typeof$3(e.insertAt)||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=c(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,i)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),_(t,e.attrs),y(e,t),t}function _(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function b(e,t){var r,n,i,o,a,s;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var u=d++;r=l||(l=m(t)),n=S.bind(null,r,u,!1),i=S.bind(null,r,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=t,s=document.createElement("link"),void 0===a.attrs.type&&(a.attrs.type="text/css"),a.attrs.rel="stylesheet",_(s,a.attrs),y(a,s),r=s,n=$.bind(null,r,t),i=function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),n=T.bind(null,r),i=function(){v(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=("undefined"==typeof document?"undefined":_typeof$3(document)))throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==_typeof$3(t.attrs)?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=g(e,t);return p(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var o=r[i];(s=a[o.id]).refs--,n.push(s)}for(e&&p(g(e,t),t),i=0;i<n.length;i++){var s;if(0===(s=n[i]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete a[s.id]}}}};var A,E=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function S(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=E(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function T(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function $(e,t,r){var n=r.css,i=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(n=h(n)),i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}}])}(dist$2);var DanmuJs=getDefaultExportFromCjs(dist$2.exports),NormalSpeed=1e4,Container=function(){function e(t){_classCallCheck$3(this,e),this.state=t,this.root=util$2.createDom("xg-danmu"),helpers.addClass(this.root,"xgplayer-danmu-container")}var t;return _createClass$3(e,[{key:"initDanmuContainer",value:function(){var e=this.state.getConfig(),t=e.opacity,r=void 0===t?1:t,n=e.fontSize,i=void 0===n?16:n,o=e.area,a=void 0===o?1:o,s=e.danmuItems,u=void 0===s?[]:s,c=e.active,l=e.speed,d=void 0===l?40:l,f=(c?u:[]).map((function(e){return!e.style&&(e.style={}),e})),h={container:this.root,comments:f,live:!1,area:{start:0,end:this.state.getRenderVal("area",a)}};this.danmuJs=new DanmuJs(h),this.setOpacity(this.state.getRenderVal("opacity",r)),this.setFontSize(this.state.getRenderVal("fontSize",i)),this.setSpeed(this.state.getRenderVal("speed",d))}},{key:"start",value:function(){this.danmuJs.start()}},{key:"pause",value:function(){this.danmuJs.pause()}},{key:"play",value:function(){this.danmuJs.play()}},{key:"stop",value:function(){this.danmuJs.stop()}},{key:"resize",value:function(){this.danmuJs.resize()}},{key:"sendDanmu",value:function(e){this.state.getConfig().active&&this.danmuJs.sendComment(e)}},{key:"clear",value:function(){this.danmuJs.clear()}},{key:"setProperty",value:function(e,t){return"opacity"===e?this.setOpacity(this.state.getRenderVal(e,t)):"area"===e?this.setArea(this.state.getRenderVal(e,t)):"speed"===e?this.setSpeed(this.state.getRenderVal(e,t)):"fontSize"===e?this.setFontSize(this.state.getRenderVal(e,t)):void 0}},{key:"setOpacity",value:function(e){this.danmuJs.setOpacity(e)}},{key:"setFontSize",value:function(e){this.danmuJs.setFontSize(e)}},{key:"setArea",value:function(e){this.danmuJs.setArea({start:0,end:this.state.getRenderVal("area",e)})}},{key:"setSpeed",value:function(e){this.danmuJs.setAllDuration("scroll",NormalSpeed/e)}},{key:"destroy",value:(t=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.danmuJs){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.danmuJs.stop();case 4:return e.next=6,this.danmuJs.destroy();case 6:this.danmuJs=null,this.root.parentNode.removeChild(this.root),this.root=null;case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Panel=function(){function e(t){_classCallCheck$3(this,e),this.state=t,this.root=document.createElement("div"),helpers.addClass(this.root,"panel-box"),helpers.addEventListener(this.root,"click",(function(e){e.stopPropagation()}))}return _createClass$3(e,[{key:"destroy",value:function(){this.root.parentNode&&this.root.parentNode.removeChild(this.root),this.root=null}}]),e}(),Switch=function(){function e(t){_classCallCheck$3(this,e),this.callback=function(){},this.key=t.key,this.name=t.name,this.value=t.value,this.root=document.createElement("div"),helpers.addClass(this.root,"xg-player-switch-wrapper"),this.render()}return _createClass$3(e,[{key:"render",value:function(){var e=this;if(!this.root.childNodes.length){var t=document.createElement("div");this.$left=t,helpers.addClass(t,"left"),t.innerHTML=this.name;var r=document.createElement("div");this.$right=r,helpers.addClass(r,"right"),r.innerHTML='<label class="switch">\n    <input type="checkbox">\n    <span class="slider round"></span>\n  </label>',this.root.appendChild(t),this.root.appendChild(r);var n=this.$right.querySelector("input");helpers.addEventListener(this.$right,"click",debounce_1((function(t){t.stopPropagation(),e.value=!e.value,e.value?null==n||n.setAttribute("checked","checked"):null==n||n.removeAttribute("checked"),e.callback(e.value)}),50))}var i=this.$right.querySelector("input");this.value?null==i||i.setAttribute("checked","checked"):i.removeAttribute("checked"),i.checked=this.value}},{key:"renderName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$left.innerHTML=e}},{key:"onChange",value:function(e){this.callback=e}}]),e}(),dist$1={exports:{}};!function(e,t){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof$3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=10)}([function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=_typeof$3(r))throw new TypeError(r+"must be non-object");for(var n in r)i(r,n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},a={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(n)},function(e,t,r){var n=r(23)();e.exports=function(e){return e!==n&&null!==e}},function(e,t,r){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){var n,i,o,a,s,u,c,l=r(12),d=r(29),f=Function.prototype.apply,h=Function.prototype.call,p=Object.create,g=Object.defineProperty,y=Object.defineProperties,v=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var r,i;return d(t),i=this,n.call(this,e,r=function(){o.call(i,e,r),f.call(t,this,arguments)}),r.__eeOnceListener__=t,this},s={on:n=function(e,t){var r;return d(t),v.call(this,"__ee__")?r=this.__ee__:(r=m.value=p(null),g(this,"__ee__",m),m.value=null),r[e]?"object"==_typeof$3(r[e])?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:i,off:o=function(e,t){var r,n,i,o;if(d(t),!v.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"==_typeof$3(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},emit:a=function(e){var t,r,n,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==_typeof$3(i)){for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;n=i[t];++t)f.call(n,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];f.call(i,this,o)}}},u={on:l(n),once:l(i),off:l(o),emit:l(a)},c=y({},u),e.exports=t=function(e){return null==e?p(c):y(Object(e),u)},t.methods=s},function(e,t,r){e.exports=function(e){return null!=e}},function(e,t,r){e.exports=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,r,i){var o=n,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},function(e,t,r){var n=r(0),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(c){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function u(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,i,o,a,s=e.length,u=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),u+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(u),a=0,o=0;a<u;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return u(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,i,o,s=t||e.length,c=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)c[n++]=i;else if((o=a[i])>4)c[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&e[r++],o--;o>1?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return u(c,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},function(e,t,r){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){e.exports=r(11)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=h(r(3)),o=h(r(30)),a=h(r(31)),s=h(r(32)),u=r(33),c=h(r(34)),l=h(r(43)),d=h(r(44)),f=r(46);function h(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,i.default)(this),this.url=t.url,this.player=t.player,this.aheadTime=parseFloat(localStorage.getItem("danmuMaskAheadTime"))||t.aheadTime||0,this.originStart=parseFloat(t.originStart)||0,this.interval=parseFloat(localStorage.getItem("danmuMaskInterval"))||t.interval||a.default.DEFAULT_INTERVAL,this.metaDataAreaLength=a.default.VERSION_LENGTH+a.default.INDEX_LENGTH+a.default.RESERVE_LENGTH,(0,u.log)("DanmuMask NPM Version: ",f.version),(0,u.log)("DanmuMask Config: ",t),this.searchFrameWorker=new d.default,this.searchFrameWorker.onmessage=function(e){if("searchResult"===e.data.method){var t=e.data.args;r.setDanmuMask(t.svgData||"")}else if("getData"===e.data.method){var n=e.data.args;r.getData(r.url,n.range).then((function(e){r.parseSvgData(n.index,e),r.searchFrameWorker.postMessage({method:"updateDataListItem",args:{index:n.index,key:"download",value:!0}})}))}}}return n(e,[{key:"init",value:function(){var e=this;(0,u.log)("DanmuMask init");var t=this;this.dataList=[],this.danmuEl=this.player.root.querySelector("xg-danmu"),this.danmuEl||(this.danmuEl=this.player.root.querySelector("xg-bullet")),this.danmuEl.style["-webkit-mask-position"]="center",this.danmuEl.style["-webkit-box-direction"]="normal",this.danmuEl.style["-webkit-mask-size"]="100% 100%";var r=this.player.root.getBoundingClientRect();this.containerWidth=r.width,this.containerHeight=r.height,this.getData(this.url,[0,this.metaDataAreaLength-1]).then((function(r){var n=new s.default(r);e.protocolVersion=n.readUint8(),e.indexAreaByteLength=n.readBigEnd(4),(0,u.log)("DanmuMask this.protocolVersion: ",e.protocolVersion),(0,u.log)("DanmuMask this.indexAreaByteLength: ",e.indexAreaByteLength),e.dataAreaBase=0,e.getData(e.url,[e.metaDataAreaLength,e.metaDataAreaLength+e.indexAreaByteLength-1]).then((function(r){var n=new s.default(r);e.indexByteStep=8,e.indexCount=e.indexAreaByteLength/e.indexByteStep;for(var i=n.readBigEnd(8)+e.dataAreaBase,o=void 0,c=0;c<e.indexCount;c++)o=c<e.indexCount-1?n.readBigEnd(8)+e.dataAreaBase:0,e.dataList.push({idx:c,timeStart:c*a.default.DURATION_STEP,timeEnd:(c+1)*a.default.DURATION_STEP,dataStart:i,dataEnd:o-1,download:!1,currentFrame:-1}),i=o;e.searchFrameWorker.postMessage({method:"updateData",args:{dataList:e.dataList,indexCount:e.indexCount}}),e.player.stopDanmuMaskTimer=function(){(0,u.log)("DanmuMask stopDanmuMaskTimer"),t.timer&&(t.timer.clear(),t.timer=null)},e.player.startDanmuMaskTimer=function(){(0,u.log)("DanmuMask startDanmuMaskTimer"),t.timer||(t.timer=new l.default,t.timer.repeat(t.timeupdateFunc.bind(t),t.interval))},e.player.onDanmuMaskSeeked=function(){e.searchFrameWorker.postMessage({method:"onDanmuMaskSeeked"})},t.player.startDanmuMaskTimer(),["ended","pause","error"].forEach((function(r){e.player.on(r,t.player.stopDanmuMaskTimer)})),["play","playing"].forEach((function(r){e.player.on(r,t.player.startDanmuMaskTimer)})),e.player.on("seeked",t.player.onDanmuMaskSeeked)}))}))}},{key:"timeupdateFunc",value:function(){var e=this.player.currentTime+this.originStart-this.aheadTime;this.searchFrameWorker.postMessage({method:"searchFrame",args:{currentTime:e}})}},{key:"getData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this;return new Promise((function(n){var i=new o.default(e,t,n);i.once("error",(function(e){r.player.emit("error",e)})),i.once("progress_event",(function(e){r.player.emit("progress_event",e)}))}))}},{key:"setContainerSize",value:function(e,t){(0,u.log)("DanmuMask setContainerSize: ",e,t),this.containerWidth=e,this.containerHeight=t}},{key:"setDanmuMask",value:function(e){if((0,u.log)("DanmuMask setDanmuMask"),e){var t=this.player.video;this.containerWidth/this.containerHeight>=t.videoWidth/t.videoHeight?(this.topRatio=0,this.bottomRatio=100,this.leftRatio=100*(1-t.videoWidth*this.containerHeight/t.videoHeight/this.containerWidth)/2,this.rightRatio=100-this.leftRatio):(this.topRatio=100*(1-t.videoHeight*this.containerWidth/t.videoWidth/this.containerHeight)/2,this.bottomRatio=100-this.topRatio,this.leftRatio=0,this.rightRatio=100);var r="linear-gradient(rgb(0, 0, 0), rgb(0, 0, 0) "+this.topRatio+"%, rgba(0, 0, 0, 0) "+this.topRatio+"%), linear-gradient(rgba(0, 0, 0, 0) "+this.bottomRatio+"%, rgb(0, 0, 0) "+this.bottomRatio+"%, rgb(0, 0, 0)), linear-gradient(to right, rgb(0, 0, 0), rgb(0, 0, 0) "+this.leftRatio+"%, rgba(0, 0, 0, 0) "+this.leftRatio+"%), linear-gradient(to right, rgba(0, 0, 0, 0) "+this.rightRatio+"%, rgb(0, 0, 0) "+this.rightRatio+'%, rgb(0, 0, 0)),url("data:image/svg+xml;base64,'+e+'")';this.danmuEl.style["-webkit-mask-image"]=r,this.danmuEl.style["mask-image"]=r}else{var n="linear-gradient(rgb(0, 0, 0), rgb(0, 0, 0) 0%, rgba(0, 0, 0) 0%), linear-gradient(rgba(0, 0, 0) 100%, rgb(0, 0, 0) 100%, rgb(0, 0, 0)), linear-gradient(to right, rgb(0, 0, 0), rgb(0, 0, 0) 0%, rgba(0, 0, 0) 0%), linear-gradient(to right, rgba(0, 0, 0) 100%, rgb(0, 0, 0) 100%, rgb(0, 0, 0))";this.danmuEl.style["-webkit-mask-image"]=n,this.danmuEl.style["mask-image"]=n}}},{key:"parseSvgData",value:function(e,t){try{var r=c.default.inflate(t);(0,u.log)("DanmuMask output: ",r);for(var n=new s.default(r.buffer),i=[];n.position<r.byteLength-1;){var o={};o.dataPts=n.readBigEnd(8),o.dataSvgLength=n.readBigEnd(4),o.dataSvgBase64="";for(var a=0;a<o.dataSvgLength;a++)o.dataSvgBase64+=String.fromCharCode(n.readUint8());o.dataSvgBase64=window.btoa(o.dataSvgBase64),i.push(o)}this.searchFrameWorker.postMessage({method:"updateDataListItem",args:{index:e,key:"data",value:r}}),this.searchFrameWorker.postMessage({method:"updateDataListItem",args:{index:e,key:"frameList",value:i}}),(0,u.log)("DanmuMask frameList: ",i)}catch(l){(0,u.log)("DanmuMask zlib inflate error: ",l)}}},{key:"destroy",value:function(){var e=this;(0,u.log)("DanmuMask destroy"),this.player&&"function"==typeof this.player.off&&(["ended","pause","error"].forEach((function(t){e.player.stopDanmuMaskTimer&&e.player.off(t,e.player.stopDanmuMaskTimer)})),["play","playing"].forEach((function(t){e.player.startDanmuMaskTimer&&e.player.off(t,e.player.startDanmuMaskTimer)})),this.player.onDanmuMaskSeeked&&this.player.off("seeked",this.player.onDanmuMaskSeeked)),this.timer&&this.timer.clear(),this.searchFrameWorker&&this.searchFrameWorker.terminate(),this.setDanmuMask()}}]),e}();t.default=p,e.exports=t.default},function(e,t,r){var n=r(4),i=r(13),o=r(17),a=r(25),s=r(26);(e.exports=function(e,t){var r,i,u,c,l;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],n(e)?(r=s.call(e,"c"),i=s.call(e,"e"),u=s.call(e,"w")):(r=u=!0,i=!1),l={value:t,configurable:r,enumerable:i,writable:u},c?o(a(c),l):l}).gs=function(e,t,r){var u,c,l,d;return"string"!=typeof e?(l=r,r=t,t=e,e=null):l=arguments[3],n(t)?i(t)?n(r)?i(r)||(l=r,r=void 0):r=void 0:(l=t,t=r=void 0):t=void 0,n(e)?(u=s.call(e,"c"),c=s.call(e,"e")):(u=!0,c=!1),d={get:t,set:r,configurable:u,enumerable:c},l?o(a(l),d):d}},function(e,t,r){var n=r(14),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!n(e)&&!i.test(o.call(e))}},function(e,t,r){var n=r(15);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(t){return!1}return!n(e)}},function(e,t,r){var n=r(16);e.exports=function(e){if(!n(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(t){return!1}}},function(e,t,r){var n=r(4),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!n(e)&&hasOwnProperty.call(i,_typeof$3(e))}},function(e,t,r){e.exports=r(18)()?Object.assign:r(19)},function(e,t,r){e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,r){var n=r(20),i=r(24),o=Math.max;e.exports=function(e,t){var r,a,s,u=o(arguments.length,2);for(e=Object(i(e)),s=function(n){try{e[n]=t[n]}catch(i){r||(r=i)}},a=1;a<u;++a)n(t=arguments[a]).forEach(s);if(void 0!==r)throw r;return e}},function(e,t,r){e.exports=r(21)()?Object.keys:r(22)},function(e,t,r){e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,r){var n=r(1),i=Object.keys;e.exports=function(e){return i(n(e)?Object(e):e)}},function(e,t,r){e.exports=function(){}},function(e,t,r){var n=r(1);e.exports=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,r){var n=r(1),i=Array.prototype.forEach,o=Object.create,a=function(e,t){var r;for(r in e)t[r]=e[r]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){n(e)&&a(Object(e),t)})),t}},function(e,t,r){e.exports=r(27)()?String.prototype.contains:r(28)},function(e,t,r){var n="razdwatrzy";e.exports=function(){return"function"==typeof n.contains&&!0===n.contains("dwa")&&!1===n.contains("foo")}},function(e,t,r){var n=String.prototype.indexOf;e.exports=function(e){return n.call(this,e,arguments[1])>-1}},function(e,t,r){e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n=r(3))&&n.__esModule?n:{default:n};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];a(this,e),(0,o.default)(this);var i=this;if(i.url=t,i.on=!1,i.range=r,e.queue.some((function(e){return e.url===t&&JSON.stringify(e.range)===JSON.stringify(r)})))n("repeat");else{var s=new XMLHttpRequest;s.target=i,s.responseType="arraybuffer",s.open("get",t),r&&r.length>1&&(i.range=r,i.id=r.join("-"),s.setRequestHeader("Range","bytes="+r[0]+"-"+(r[1]||""))),s.onload=function(){200===s.status||206===s.status?n&&n instanceof Function&&n(s.response):n&&n instanceof Function?n("Not Found"):i.emit("error"),s.target.remove()},s.onerror=function(){n(!1),s.target.remove()},s.onabort=function(){s.target.remove()},i.xhr=s,e.queue.push(i),i.update()}}return i(e,[{key:"cancel",value:function(){this.xhr.abort()}},{key:"remove",value:function(){var t=this;e.queue.filter((function(r,n){return r.url===t.url&&JSON.stringify(r.range)===JSON.stringify(t.range)&&(e.queue.splice(n,1),!0)})),this.update()}},{key:"update",value:function(){var t=e.queue,r=t.filter((function(e){return e.on})),n=t.filter((function(e){return!e.on})),i=e.limit-r.length;n.forEach((function(e,t){t<i&&e.run()}))}},{key:"run",value:function(){1===this.xhr.readyState?(this.on=!0,this.xhr.send()):this.remove()}}],[{key:"clear",value:function(){e.queue.forEach((function(e){e.on&&e.cancel()})),e.queue.length=0}}]),e}();s.queue=[],s.limit=4,window.Task=s,t.default=s,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return n(e,[{key:"init",value:function(){this.VERSION_LENGTH=1,this.INDEX_LENGTH=4,this.RESERVE_LENGTH=4,this.DURATION_STEP=10,this.DEFAULT_INTERVAL=30}}]),e}());t.default=i,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof ArrayBuffer&&(this.buffer=t,this.dataview=new DataView(t),this.dataview.position=0)}return n(e,[{key:"skip",value:function(t){for(var r=Math.floor(t/4),n=t%4,i=0;i<r;i++)e.readByte(this.dataview,4);n>0&&e.readByte(this.dataview,n)}},{key:"readUint8",value:function(){return e.readByte(this.dataview,1)}},{key:"readUint16",value:function(){return e.readByte(this.dataview,2)}},{key:"readUint32",value:function(){return e.readByte(this.dataview,4)}},{key:"readUint64",value:function(){return e.readByte(this.dataview,8)}},{key:"readInt8",value:function(){return e.readByte(this.dataview,1,!0)}},{key:"readInt16",value:function(){return e.readByte(this.dataview,2,!0)}},{key:"readInt32",value:function(){return e.readByte(this.dataview,4,!0)}},{key:"readLittleEnd",value:function(t){for(var r=0,n=0;n<t;n++)r+=Math.pow(256,n)*e.readByte(this.dataview,1);return r}},{key:"readBigEnd",value:function(t){for(var r=0,n=0;n<t;n++)r+=Math.pow(256,t-n-1)*e.readByte(this.dataview,1);return r}},{key:"position",set:function(e){this.dataview.position=e},get:function(){return this.dataview.position}}],[{key:"readByte",value:function(e,t,r){var n=void 0;switch(t){case 1:n=r?e.getInt8(e.position):e.getUint8(e.position);break;case 2:n=r?e.getInt16(e.position):e.getUint16(e.position);break;case 3:if(r)throw"not supported for readByte 3";n=e.getUint8(e.position)<<16,n|=e.getUint8(e.position+1)<<8,n|=e.getUint8(e.position+2);break;case 4:n=r?e.getInt32(e.position):e.getUint32(e.position);break;case 8:n=e.getUint32(e.position)<<32,n|=e.getUint32(e.position+4);break;default:n=""}return e.position+=t,n}}]),e}();t.default=i,e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){var t;if(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];console&&(t=console).log.apply(t,[e].concat(i))}};var n=t.LOGOPEN=window.location.search.indexOf("log=true")>-1},function(e,t,r){var n={};(0,r(0).assign)(n,r(35),r(38),r(9)),e.exports=n},function(e,t,r){var n=r(36),i=r(0),o=r(7),a=r(2),s=r(8),u=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var l;if(l="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,l)))throw new Error(a[r]);this._dict_set=!0}}function l(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}c.prototype.push=function(e,t){var r,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===u.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(r=n.deflate(s,a))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),s.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=c,t.deflate=l,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,l(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,l(e,t)}},function(e,t,r){var n,i=r(0),o=r(37),a=r(5),s=r(6),u=r(2);function c(e,t){return e.msg=u[t],t}function l(e){return(e<<1)-(e>4?9:0)}function d(e){for(var t=e.length;--t>=0;)e[t]=0}function f(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function h(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,f(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function g(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function y(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,l=e.w_mask,d=e.prev,f=e.strstart+258,h=c[o+a-1],p=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===p&&c[r+a-1]===h&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<f);if(n=258-(f-o),o=f-258,n>a){if(e.match_start=t,a=n,n>=s)break;h=c[o+a-1],p=c[o+a]}}}while((t=d[t&l])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead}function v(e){var t,r,n,o,u,c,l,d,f,h,p=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-262)){i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=p?n-p:0}while(--r);t=r=p;do{n=e.prev[--t],e.prev[t]=n>=p?n-p:0}while(--r);o+=p}if(0===e.strm.avail_in)break;if(c=e.strm,l=e.window,d=e.strstart+e.lookahead,f=o,h=void 0,(h=c.avail_in)>f&&(h=f),r=0===h?0:(c.avail_in-=h,i.arraySet(l,c.input,c.next_in,h,d),1===c.state.wrap?c.adler=a(c.adler,l,h,d):2===c.state.wrap&&(c.adler=s(c.adler,l,h,d)),c.next_in+=h,c.total_in+=h,h),e.lookahead+=r,e.lookahead+e.insert>=3)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+3-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function m(e,t){for(var r,n;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=y(e,r)),e.match_length>=3)if(n=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var r,n,i;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=y(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(h(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=o._tr_tally(e,0,e.window[e.strstart-1]))&&h(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function b(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):c(e,-2)}function S(e){var t,r=E(e);return 0===r&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function T(e,t,r,n,o,a){if(!e)return-2;var s=1;if(-1===t&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>9||8!==r||n<8||n>15||t<0||t>9||a<0||a>4)return c(e,-2);8===n&&(n=9);var u=new A;return e.state=u,u.strm=e,u.wrap=s,u.gzhead=null,u.w_bits=n,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=a,u.method=r,S(e)}n=[new b(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,h(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(h(e,!1),e.strm.avail_out),1)})),new b(4,4,8,4,m),new b(4,5,16,8,m),new b(4,6,32,32,m),new b(4,4,16,16,_),new b(8,16,32,32,_),new b(8,16,128,128,_),new b(8,32,128,256,_),new b(32,128,258,1024,_),new b(32,258,258,4096,_)],t.deflateInit=function(e,t){return T(e,t,8,15,8,0)},t.deflateInit2=T,t.deflateReset=S,t.deflateResetKeep=E,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var r,i,a,u;if(!e||!e.state||t>5||t<0)return e?c(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return c(e,0===e.avail_out?-5:-2);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,p(i,31),p(i,139),p(i,8),i.gzhead?(p(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),p(i,255&i.gzhead.time),p(i,i.gzhead.time>>8&255),p(i,i.gzhead.time>>16&255),p(i,i.gzhead.time>>24&255),p(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),p(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(p(i,255&i.gzhead.extra.length),p(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(p(i,0),p(i,0),p(i,0),p(i,0),p(i,0),p(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),p(i,3),i.status=113);else{var y=8+(i.w_bits-8<<4)<<8;y|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(y|=32),y+=31-y%31,i.status=113,g(i,y),0!==i.strstart&&(g(i,e.adler>>>16),g(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),f(e),a=i.pending,i.pending!==i.pending_buf_size));)p(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),f(e),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,p(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),f(e),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,p(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&f(e),i.pending+2<=i.pending_buf_size&&(p(i,255&e.adler),p(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(f(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&l(t)<=l(r)&&4!==t)return c(e,-5);if(666===i.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var m=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=258){if(v(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+258;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=258-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==m&&4!==m||(i.status=666),1===m||3===m)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===m&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(d(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),f(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(p(i,255&e.adler),p(i,e.adler>>8&255),p(i,e.adler>>16&255),p(i,e.adler>>24&255),p(i,255&e.total_in),p(i,e.total_in>>8&255),p(i,e.total_in>>16&255),p(i,e.total_in>>24&255)):(g(i,e.adler>>>16),g(i,65535&e.adler)),f(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?c(e,-2):(e.state=null,113===t?c(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var r,n,o,s,u,c,l,f,h=t.length;if(!e||!e.state)return-2;if(2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return-2;for(1===s&&(e.adler=a(e.adler,t,h,0)),r.wrap=0,h>=r.w_size&&(0===s&&(d(r.head),r.strstart=0,r.block_start=0,r.insert=0),f=new i.Buf8(r.w_size),i.arraySet(f,t,h-r.w_size,r.w_size,0),t=f,h=r.w_size),u=e.avail_in,c=e.next_in,l=e.input,e.avail_in=h,e.next_in=0,e.input=t,v(r);r.lookahead>=3;){n=r.strstart,o=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--o);r.strstart=n,r.lookahead=2,v(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=c,e.input=l,e.avail_in=u,r.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){var n=r(0);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);i(c);var l=new Array(60);i(l);var d=new Array(512);i(d);var f=new Array(256);i(f);var h=new Array(29);i(h);var p,g,y,v=new Array(30);function m(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function b(e){return e<256?d[e]:d[256+(e>>>7)]}function A(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,A(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function S(e,t,r){E(e,r[2*t],r[2*t+1])}function T(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function $(e,t,r){var n,i,o=new Array(16),a=0;for(n=1;n<=15;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=T(o[s]++,s))}}function w(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?A(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function I(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function k(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&I(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!I(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function O(e,t,r){var n,i,s,u,c=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===n?S(e,i,t):(S(e,(s=f[i])+256+1,t),0!==(u=o[s])&&E(e,i-=h[s],u),S(e,s=b(--n),r),0!==(u=a[s])&&E(e,n-=v[s],u))}while(c<e.last_lit);S(e,256,t)}function P(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)k(e,o,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],k(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,k(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(o=u[2*u[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,g++),u[2*n+1]=o,n>c||(e.bl_count[o]++,a=0,n>=h&&(a=f[n-h]),s=u[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(l[2*n+1]+a)));if(0!==g){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(e,t),$(o,c,e.bl_count)}function R(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<u&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4))}function x(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<u&&i===a)){if(s<c)do{S(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(S(e,i,e.bl_tree),s--),S(e,16,e.bl_tree),E(e,s-3,2)):s<=10?(S(e,17,e.bl_tree),E(e,s-3,3)):(S(e,18,e.bl_tree),E(e,s-11,7));s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4)}}i(v);var D=!1;function L(e,t,r,i){var o,a,s,u;E(e,0+(i?1:0),3),a=t,s=r,u=!0,C(o=e),u&&(A(o,s),A(o,~s)),n.arraySet(o.pending_buf,o.window,a,s,o.pending),o.pending+=s}t._tr_init=function(e){D||(function(){var e,t,r,n,i,u=new Array(16);for(r=0,n=0;n<28;n++)for(h[n]=r,e=0;e<1<<o[n];e++)f[r++]=n;for(f[r-1]=n,i=0,n=0;n<16;n++)for(v[n]=i,e=0;e<1<<a[n];e++)d[i++]=n;for(i>>=7;n<30;n++)for(v[n]=i<<7,e=0;e<1<<a[n]-7;e++)d[256+i++]=n;for(t=0;t<=15;t++)u[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,u[8]++;for(;e<=255;)c[2*e+1]=9,e++,u[9]++;for(;e<=279;)c[2*e+1]=7,e++,u[7]++;for(;e<=287;)c[2*e+1]=8,e++,u[8]++;for($(c,287,u),e=0;e<30;e++)l[2*e+1]=5,l[2*e]=T(e,5);p=new m(c,o,257,286,15),g=new m(l,a,0,30,15),y=new m(new Array(0),s,0,19,7)}(),D=!0),e.l_desc=new _(e.dyn_ltree,p),e.d_desc=new _(e.dyn_dtree,g),e.bl_desc=new _(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,w(e)},t._tr_stored_block=L,t._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),P(e,e.l_desc),P(e,e.d_desc),a=function(e){var t;for(R(e,e.dyn_ltree,e.l_desc.max_code),R(e,e.dyn_dtree,e.d_desc.max_code),P(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*u[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?L(e,t,r,n):4===e.strategy||o===i?(E(e,2+(n?1:0),3),O(e,c,l)):(E(e,4+(n?1:0),3),function(e,t,r,n){var i;for(E(e,t-257,5),E(e,r-1,5),E(e,n-4,4),i=0;i<n;i++)E(e,e.bl_tree[2*u[i]+1],3);x(e,e.dyn_ltree,t-1),x(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),O(e,e.dyn_ltree,e.dyn_dtree)),w(e),n&&C(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(f[r]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){var t;E(e,2,3),S(e,256,c),16===(t=e).bi_valid?(A(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},function(e,t,r){var n=r(39),i=r(0),o=r(7),a=r(9),s=r(2),u=r(8),c=r(42),l=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);if(this.header=new c,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[r])}function f(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}d.prototype.push=function(e,t){var r,s,u,c,d,f=this.strm,h=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===l.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(h),f.next_out=0,f.avail_out=h),(r=n.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&p&&(r=n.inflateSetDictionary(this.strm,p)),r===a.Z_BUF_ERROR&&!0===g&&(r=a.Z_OK,g=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&r!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(u=o.utf8border(f.output,f.next_out),c=f.next_out-u,d=o.buf2string(f.output,u),f.next_out=c,f.avail_out=h-c,c&&i.arraySet(f.output,f.output,u,c,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((f.avail_in>0||0===f.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),f.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=f,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.ungzip=f},function(e,t,r){var n=r(0),i=r(5),o=r(6),a=r(40),s=r(41);function u(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function l(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,l(e)):-2}function f(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))):-2}function h(e,t){var r,n;return e?(n=new c,e.state=n,n.window=null,0!==(r=f(e,t))&&(e.state=null),r):-2}var p,g,y=!0;function v(e){if(y){var t;for(p=new n.Buf32(512),g=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=p,e.lenbits=9,e.distcode=g,e.distbits=5}function m(e,t,r,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),n.arraySet(a.window,t,r-i,o,a.wnext),(i-=o)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=d,t.inflateReset2=f,t.inflateResetKeep=l,t.inflateInit=function(e){return h(e,15)},t.inflateInit2=h,t.inflate=function(e,t){var r,c,l,d,f,h,p,g,y,_,b,A,E,S,T,$,w,C,I,k,O,P,R,x,D=0,L=new n.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),f=e.next_out,l=e.output,p=e.avail_out,d=e.next_in,c=e.input,h=e.avail_in,g=r.hold,y=r.bits,_=h,b=p,P=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(2&r.wrap&&35615===g){r.check=0,L[0]=255&g,L[1]=g>>>8&255,r.check=o(r.check,L,2,0),g=0,y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(y-=4,O=8+(15&(g>>>=4)),0===r.wbits)r.wbits=O;else if(O>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<O,e.adler=r.check=1,r.mode=512&g?10:12,g=0,y=0;break;case 2:for(;y<16;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(L[0]=255&g,L[1]=g>>>8&255,r.check=o(r.check,L,2,0)),g=0,y=0,r.mode=3;case 3:for(;y<32;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.head&&(r.head.time=g),512&r.flags&&(L[0]=255&g,L[1]=g>>>8&255,L[2]=g>>>16&255,L[3]=g>>>24&255,r.check=o(r.check,L,4,0)),g=0,y=0,r.mode=4;case 4:for(;y<16;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(L[0]=255&g,L[1]=g>>>8&255,r.check=o(r.check,L,2,0)),g=0,y=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(L[0]=255&g,L[1]=g>>>8&255,r.check=o(r.check,L,2,0)),g=0,y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((A=r.length)>h&&(A=h),A&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,c,d,A,O)),512&r.flags&&(r.check=o(r.check,c,A,d)),h-=A,d+=A,r.length-=A),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===h)break e;A=0;do{O=c[d+A++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O))}while(O&&A<h);if(512&r.flags&&(r.check=o(r.check,c,A,d)),h-=A,d+=A,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===h)break e;A=0;do{O=c[d+A++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O))}while(O&&A<h);if(512&r.flags&&(r.check=o(r.check,c,A,d)),h-=A,d+=A,O)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}g=0,y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;y<32;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}e.adler=r.check=u(g),g=0,y=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}switch(r.last=1&g,y-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(v(r),r.mode=20,6===t){g>>>=2,y-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,g=0,y=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(A=r.length){if(A>h&&(A=h),A>p&&(A=p),0===A)break e;n.arraySet(l,c,d,A,f),h-=A,d+=A,p-=A,f+=A,r.length-=A;break}r.mode=12;break;case 17:for(;y<14;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(r.nlen=257+(31&g),g>>>=5,y-=5,r.ndist=1+(31&g),g>>>=5,y-=5,r.ncode=4+(15&g),g>>>=4,y-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.lens[N[r.have++]]=7&g,g>>>=3,y-=3}for(;r.have<19;)r.lens[N[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},P=s(0,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,P){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;$=(D=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,w=65535&D,!((T=D>>>24)<=y);){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(w<16)g>>>=T,y-=T,r.lens[r.have++]=w;else{if(16===w){for(x=T+2;y<x;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(g>>>=T,y-=T,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}O=r.lens[r.have-1],A=3+(3&g),g>>>=2,y-=2}else if(17===w){for(x=T+3;y<x;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}y-=T,O=0,A=3+(7&(g>>>=T)),g>>>=3,y-=3}else{for(x=T+7;y<x;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}y-=T,O=0,A=11+(127&(g>>>=T)),g>>>=7,y-=7}if(r.have+A>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;A--;)r.lens[r.have++]=O}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,R={bits:r.lenbits},P=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,P){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},P=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,P){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(h>=6&&p>=258){e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,a(e,b),f=e.next_out,l=e.output,p=e.avail_out,d=e.next_in,c=e.input,h=e.avail_in,g=r.hold,y=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;$=(D=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,w=65535&D,!((T=D>>>24)<=y);){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if($&&0==(240&$)){for(C=T,I=$,k=w;$=(D=r.lencode[k+((g&(1<<C+I)-1)>>C)])>>>16&255,w=65535&D,!(C+(T=D>>>24)<=y);){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}g>>>=C,y-=C,r.back+=C}if(g>>>=T,y-=T,r.back+=T,r.length=w,0===$){r.mode=26;break}if(32&$){r.back=-1,r.mode=12;break}if(64&$){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&$,r.mode=22;case 22:if(r.extra){for(x=r.extra;y<x;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;$=(D=r.distcode[g&(1<<r.distbits)-1])>>>16&255,w=65535&D,!((T=D>>>24)<=y);){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(0==(240&$)){for(C=T,I=$,k=w;$=(D=r.distcode[k+((g&(1<<C+I)-1)>>C)])>>>16&255,w=65535&D,!(C+(T=D>>>24)<=y);){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}g>>>=C,y-=C,r.back+=C}if(g>>>=T,y-=T,r.back+=T,64&$){e.msg="invalid distance code",r.mode=30;break}r.offset=w,r.extra=15&$,r.mode=24;case 24:if(r.extra){for(x=r.extra;y<x;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===p)break e;if(A=b-p,r.offset>A){if((A=r.offset-A)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}A>r.wnext?(A-=r.wnext,E=r.wsize-A):E=r.wnext-A,A>r.length&&(A=r.length),S=r.window}else S=l,E=f-r.offset,A=r.length;A>p&&(A=p),p-=A,r.length-=A;do{l[f++]=S[E++]}while(--A);0===r.length&&(r.mode=21);break;case 26:if(0===p)break e;l[f++]=r.length,p--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===h)break e;h--,g|=c[d++]<<y,y+=8}if(b-=p,e.total_out+=b,r.total+=b,b&&(e.adler=r.check=r.flags?o(r.check,l,b,f-b):i(r.check,l,b,f-b)),b=p,(r.flags?g:u(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}g=0,y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===h)break e;h--,g+=c[d++]<<y,y+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}g=0,y=0}r.mode=29;case 29:P=1;break e;case 30:P=-3;break e;case 31:return-4;default:return-2}return e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,(r.wsize||b!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&m(e,e.output,e.next_out,b-e.avail_out)?(r.mode=31,-4):(_-=e.avail_in,b-=e.avail_out,e.total_in+=_,e.total_out+=b,r.total+=b,r.wrap&&b&&(e.adler=r.check=r.flags?o(r.check,l,b,e.next_out-b):i(r.check,l,b,e.next_out-b)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===_&&0===b||4===t)&&0===P&&(P=-5),P)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&i(1,t,n,0)!==r.check?-3:m(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){e.exports=function(e,t){var r,n,i,o,a,s,u,c,l,d,f,h,p,g,y,v,m,_,b,A,E,S,T,$,w;r=e.state,n=e.next_in,$=e.input,i=n+(e.avail_in-5),o=e.next_out,w=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),u=r.dmax,c=r.wsize,l=r.whave,d=r.wnext,f=r.window,h=r.hold,p=r.bits,g=r.lencode,y=r.distcode,v=(1<<r.lenbits)-1,m=(1<<r.distbits)-1;e:do{p<15&&(h+=$[n++]<<p,p+=8,h+=$[n++]<<p,p+=8),_=g[h&v];t:for(;;){if(h>>>=b=_>>>24,p-=b,0==(b=_>>>16&255))w[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(h&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}A=65535&_,(b&=15)&&(p<b&&(h+=$[n++]<<p,p+=8),A+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=$[n++]<<p,p+=8,h+=$[n++]<<p,p+=8),_=y[h&m];r:for(;;){if(h>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=y[(65535&_)+(h&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(E=65535&_,p<(b&=15)&&(h+=$[n++]<<p,(p+=8)<b&&(h+=$[n++]<<p,p+=8)),(E+=h&(1<<b)-1)>u){e.msg="invalid distance too far back",r.mode=30;break e}if(h>>>=b,p-=b,E>(b=o-a)){if((b=E-b)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=0,T=f,0===d){if(S+=c-b,b<A){A-=b;do{w[o++]=f[S++]}while(--b);S=o-E,T=w}}else if(d<b){if(S+=c+d-b,(b-=d)<A){A-=b;do{w[o++]=f[S++]}while(--b);if(S=0,d<A){A-=b=d;do{w[o++]=f[S++]}while(--b);S=o-E,T=w}}}else if(S+=d-b,b<A){A-=b;do{w[o++]=f[S++]}while(--b);S=o-E,T=w}for(;A>2;)w[o++]=T[S++],w[o++]=T[S++],w[o++]=T[S++],A-=3;A&&(w[o++]=T[S++],A>1&&(w[o++]=T[S++]))}else{S=o-E;do{w[o++]=w[S++],w[o++]=w[S++],w[o++]=w[S++],A-=3}while(A>2);A&&(w[o++]=w[S++],A>1&&(w[o++]=w[S++]))}break}}break}}while(n<i&&o<s);n-=A=p>>3,h&=(1<<(p-=A<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=h,r.bits=p}},function(e,t,r){var n=r(0),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,u,c,l,d,f){var h,p,g,y,v,m,_,b,A,E=f.bits,S=0,T=0,$=0,w=0,C=0,I=0,k=0,O=0,P=0,R=0,x=null,D=0,L=new n.Buf16(16),N=new n.Buf16(16),M=null,B=0;for(S=0;S<=15;S++)L[S]=0;for(T=0;T<u;T++)L[t[r+T]]++;for(C=E,w=15;w>=1&&0===L[w];w--);if(C>w&&(C=w),0===w)return c[l++]=20971520,c[l++]=20971520,f.bits=1,0;for($=1;$<w&&0===L[$];$++);for(C<$&&(C=$),O=1,S=1;S<=15;S++)if(O<<=1,(O-=L[S])<0)return-1;if(O>0&&(0===e||1!==w))return-1;for(N[1]=0,S=1;S<15;S++)N[S+1]=N[S]+L[S];for(T=0;T<u;T++)0!==t[r+T]&&(d[N[t[r+T]]++]=T);if(0===e?(x=M=d,m=19):1===e?(x=i,D-=257,M=o,B-=257,m=256):(x=a,M=s,m=-1),R=0,T=0,S=$,v=l,I=C,k=0,g=-1,y=(P=1<<C)-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){_=S-k,d[T]<m?(b=0,A=d[T]):d[T]>m?(b=M[B+d[T]],A=x[D+d[T]]):(b=96,A=0),h=1<<S-k,$=p=1<<I;do{c[v+(R>>k)+(p-=h)]=_<<24|b<<16|A|0}while(0!==p);for(h=1<<S-1;R&h;)h>>=1;if(0!==h?(R&=h-1,R+=h):R=0,T++,0==--L[S]){if(S===w)break;S=t[r+d[T]]}if(S>C&&(R&y)!==g){for(0===k&&(k=C),v+=$,O=1<<(I=S-k);I+k<w&&!((O-=L[I+k])<=0);)I++,O<<=1;if(P+=1<<I,1===e&&P>852||2===e&&P>592)return 1;c[g=R&y]=C<<24|I<<16|v-l|0}}return 0!==R&&(c[v+R]=S-k<<24|64<<16|0),f.bits=C,0}},function(e,t,r){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeID=null,this.func=null}return n(e,[{key:"repeat",value:function(e,t){var r=this;null===this.func&&(this.func=e),this.func===e&&(this.timeID=setTimeout((function(){e(),r.repeat(e,t)}),t))}},{key:"clear",value:function(){clearTimeout(this.timeID)}}]),e}();t.default=i,e.exports=t.default},function(e,t,r){e.exports=function(){return r(45)('!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";var r,n=a(1),o=(r=n)&&r.__esModule?r:{default:r};var i=[],s=-1,u=0,d=function(e){for(var t=new o.default,a=s<0?u-1:s+1,r=null,n=s<0?0:s;n<=a;n++)if(i[n]&&e>=i[n].timeStart&&e<i[n].timeEnd){if(s=n,i[n].download){if(!i[n].frameList)break;if(i[n].currentFrame<0)for(var d=i[n].frameList,f=0,l=d.length-1;f<=l;){var c=Math.ceil(f+(l-f)*(1e3*e-d[f].dataPts)/(d[l].dataPts-d[f].dataPts));if(1e3*e>=d[c=Math.min(c,l)].dataPts){if(!(c<d.length-1)){r={svgData:d[c].dataSvgBase64};break}if(1e3*e<d[c+1].dataPts){r={svgData:d[c].dataSvgBase64};break}f=c+1}else{if(!(c>0)){r={svgData:d[c].dataSvgBase64};break}if(1e3*e>=d[c-1].dataPts){r={svgData:d[c].dataSvgBase64};break}l=c-1}}else for(var v=i[n].currentFrame;v<i[n].frameList.length-1;v++){var g=i[n].frameList[v],m=i[n].frameList[v+1];if(1e3*e>=g.dataPts&&1e3*e<m.dataPts){r={svgData:(1e3*e-g.dataPts<=m.dataPts-1e3*e?g:m).dataSvgBase64};break}}}else r={range:[i[n].dataStart,i[n].dataEnd],index:n};n+1<u&&!i[n+1].download&&(r={range:[i[n+1].dataStart,i[n+1].dataEnd],index:n+1});break}return t.resolve(r),t};onmessage=function(e){var t=this;if("searchFrame"===e.data.method){var a=e.data.args;d(a.currentTime||0).then((function(e){e&&(void 0!==e.svgData?t.postMessage({method:"searchResult",args:{svgData:e.svgData}}):e.range&&t.postMessage({method:"getData",args:{range:e.range,index:e.index}}))}))}else if("updateData"===e.data.method){var r=e.data.args;i=r.dataList,u=r.indexCount}else if("updateDataListItem"===e.data.method){var n=e.data.args;i[n.index][n.key]=n.value}else"onDanmuMaskSeeked"===e.data.method&&(s=-1,i&&i.forEach((function(e){e.currentFrame=-1})))}},function(e,t,a){"use strict";a.r(t);var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=void 0,a=void 0,r=new Promise((function(e,r){t=e,a=r}));return r.resolve=t,r.reject=a,r}return r(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}();t.default=n}]);\n//# sourceMappingURL=4fb552b0780015bcf95a.worker.js.map',"/4fb552b0780015bcf95a.worker.js")}},function(e,t,r){var n=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var r;try{(r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),r=r.getBlob()}catch(i){r=new Blob([e])}return new Worker(n.createObjectURL(r))}catch(i){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(o){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e){e.exports=JSON.parse('{"version":"0.3.6"}')}])}(dist$1);var DanmuMask=getDefaultExportFromCjs(dist$1.exports),isPC="pc"===sniffer.device,MIN_INTERVAL=300,POSITIONS$6=Plugin.POSITIONS,DanmuPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).seekCost=window.performance.now(),n.eventBus=new EventEmitter$1,n.state=new State(e.config),n.state.updateLang(n.player.lang),n.iconWrap=document.createElement("div"),helpers.addClass(n.iconWrap,"icon-warp"),n.tipsWrap=document.createElement("div"),helpers.addClass(n.tipsWrap,"tips-wrap"),n.container=new Container(n.state),n.panel=new Panel(n.state),n}return _createClass$3(r,[{key:"afterCreate",value:function(){var e;null===(e=this.player.root)||void 0===e||e.appendChild(this.container.root),this.renderIcon(),this.renderBox(),this.root.appendChild(this.iconWrap),isPC&&(this.state.getConfig().usePanel&&this.root.appendChild(this.panel.root),this.renderTips(),helpers.addClass(this.panel.root,"pc-panel"),this.root.appendChild(this.tipsWrap)),this.initEvents(),this.container.initDanmuContainer()}},{key:"afterPlayerInit",value:function(){this.initDanmuMask()}},{key:"updateLang",value:function(e){this.state.updateLang(this.player.lang),this.eventBus.emit("updateLang")}},{key:"registerIcons",value:function(){return{open:{icon:danmuActiveSVG$1,class:"xgplayer-danmu-open-svg"},close:{icon:Default,class:"xgplayer-danmu-close-svg"},reset:{icon:resetIcon,class:"xgplayer-danmu-reset-svg"}}}},{key:"initEvents",value:function(){isPC?this.bindPCEvent():this.bindMobileEvent(),this.bindPlayerEvent()}},{key:"bindPlayerEvent",value:function(){var e=this;this.once(TIME_UPDATE,(function(){e.container.start()})),this.on(PAUSE,(function(){e.container.pause()})),this.on(PLAY,(function(){e.container.play()})),this.on(SEEKING,(function(){e.seekCost=window.performance.now(),e.container.stop()})),this.on(SEEKED,debounce_1((function(){e.container.start()}),MIN_INTERVAL)),this.on([FULLSCREEN_CHANGE,CSS_FULLSCREEN_CHANGE,MINI_STATE_CHANGE],(function(){e.container.resize(),e.handleResize()})),this.on(PIP_CHANGE,this.handlePIP.bind(this))}},{key:"bindPCEvent",value:function(){var e=this;helpers.addEventListener(this.root,"click",this.onClick.bind(this)),helpers.addEventListener(this.root,"mouseenter",(function(){e.state.getConfig().active?(helpers.style(e.panel.root,{display:"block"}),helpers.style(e.tipsWrap,{display:"none"})):(helpers.style(e.panel.root,{display:"none"}),helpers.style(e.tipsWrap,{display:"block"}))})),helpers.addEventListener(this.root,"mouseleave",(function(){helpers.style(e.panel.root,{display:"none"}),helpers.style(e.tipsWrap,{display:"none"})}))}},{key:"bindMobileEvent",value:function(){var e=this;helpers.addEventListener(this.root,"click",(function(){e.state.getConfig().usePanel?e.player.panel.showPanel(e.panel.root):e.onClick()}))}},{key:"onClick",value:function(){this.toggleDanmu(),this.renderIcon()}},{key:"toggleDanmu",value:function(){var e=this.state.getConfig(),t=e.active,r=e.maskActive,n=!t;n?(this.state.updateConfig({active:n}),r&&this.initMask()):(null==this||this.container.clear(),this.destroyMask(),this.state.updateConfig({active:n})),this.player.emit(PluginEvents.DANMU_CHANGE,{active:n}),this.danmuSwitchInSettingPanel&&(this.danmuSwitchInSettingPanel.value=n,this.danmuSwitchInSettingPanel.render())}},{key:"renderIcon",value:function(){this.iconWrap.innerHTML="",this.state.getConfig().active?this.iconWrap.appendChild(this.icons.open):this.iconWrap.appendChild(this.icons.close)}},{key:"renderTips",value:function(){this.tipsWrap.innerHTML=this.state.curLangMap.openDanmu}},{key:"renderBox",value:function(){var e=this;this.panel.root.innerHTML="";var t=document.createElement("div");helpers.addClass(t,"box-header"),t.innerHTML='<div class="header-setting">'+this.state.curLangMap.danmuSetting+'</div> <div class="header-reset"></div>';var r=t.querySelector(".header-reset");r.appendChild(this.icons.reset),helpers.addEventListener(r,"click",(function(t){t.stopPropagation(),e.eventBus.emit("reset")}),{capture:!0});var n=document.createElement("span");n.innerHTML=this.state.curLangMap.reset,r.appendChild(n),this.eventBus.on("updateLang",(function(){n.innerHTML=e.state.curLangMap.reset,t.querySelector(".header-setting").innerHTML=e.state.curLangMap.danmuSetting})),this.panel.root.appendChild(t),isPC||this.renderTurnOff(),this.renderSliders(),this.renderSwitches()}},{key:"renderTurnOff",value:function(){var e=this,t={name:this.state.curLangMap.danmuSwitch,key:"active",value:this.state.getConfig().active||!1},r=new Switch(t);this.danmuSwitchInSettingPanel=r,this.panel.root.appendChild(r.root),r.onChange((function(t){e.toggleDanmu(),e.renderIcon()})),this.eventBus.on("updateLang",(function(){r.renderName(e.state.curLangMap.danmuSwitch)}))}},{key:"renderSwitches",value:function(){var e,t=this;null===(e=this.state.getConfig().external)||void 0===e||e.forEach((function(e){var r=new Switch(e);t.panel.root.appendChild(r.root),t.eventBus.on("updateLang",(function(){r.renderName(e.name)})),r.onChange((function(r){var n=t.state.getConfig().external||[];n.forEach((function(t){t.key===e.key&&(t.value=r)})),t.state.updateConfig({external:n}),t.player.emit(PluginEvents.DANMU_CHANGE,{external:n})}))}))}},{key:"renderSliders",value:function(){var e=this;this.state.sliderItemsProps.forEach((function(t,r){var n,i,o=document.createElement("div"),a=new Slider(o,t);null!=(null===(n=e.state.getConfig())||void 0===n?void 0:n[t.key])&&a.setValue(null===(i=e.state.getConfig())||void 0===i?void 0:i[t.key]);a.onChange((function(r){e.state.updateConfig(_defineProperty$3({},t.key,r)),console.log("val",e.state.getConfig()),e.player.emit(PluginEvents.DANMU_CHANGE,_defineProperty$3({},t.key,r)),e.container.setProperty(t.key,r)})),e.eventBus.on("reset",(function(){a.setValue(t.defaultValue)})),e.eventBus.on("updateLang",(function(){a.renderText(e.state.sliderItemsProps[r])})),e.panel.root.appendChild(o)}))}},{key:"sendDanmu",value:function(e){return this.container.sendDanmu(e)}},{key:"updateConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.state.updateConfig(e)}},{key:"getConfig",value:function(){return this.state.getConfig()}},{key:"initDanmuMask",value:function(){if(this.player){var e=this.state.getConfig(),t=e.maskConfig,r=e.active,n=e.maskActive;t.maskUrl&&(this.renderDanmuMaskTurnOff(),r&&n&&this.initMask())}}},{key:"renderDanmuMaskTurnOff",value:function(){var e=this,t={name:this.state.curLangMap.danmuMask,key:"maskActive",value:this.state.getConfig().maskActive||!1},r=new Switch(t);this.panel.root.appendChild(r.root),r.onChange((function(t){e.state.updateConfig({maskActive:t}),t?e.initMask():e.destroyMask(),e.renderIcon()})),this.eventBus.on("updateLang",(function(){r.renderName(e.state.curLangMap.danmuMask)}))}},{key:"initMask",value:function(){this.destroyMask();var e=this.state.getConfig(),t=e.maskConfig,r=e.maskActive,n=e.active;t.maskUrl&&r&&n&&(this.mask=new DanmuMask({player:this.player,url:t.maskUrl,originStart:t.maskOffset,interval:t.interval}),this.mask.init())}},{key:"destroyMask",value:function(){this.mask&&(this.mask.destroy(),this.mask=null)}},{key:"handleResize",value:function(){var e,t,r,n;if(this.mask){var i=this.player;this.mask.setContainerSize(null!==(e=null==i||null===(t=i.root)||void 0===t?void 0:t.offsetWidth)&&void 0!==e?e:0,null!==(r=null==i||null===(n=i.root)||void 0===n?void 0:n.offsetHeight)&&void 0!==r?r:0)}}},{key:"handlePIP",value:function(e){e?this.destroyMask():this.initMask()}},{key:"destroy",value:function(){this.destroyMask(),this.container.destroy(),this.panel.destroy()}},{key:"render",value:function(){return'<div class="xgplayer-danmu"></div>'}}],[{key:"pluginName",get:function(){return"DanmuPlugin"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$6.CONTROLS_RIGHT,index:3}}}]),r}(Plugin),ToastPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).toastNumber=0,n.toastMaps={},n}return _createClass$3(r,[{key:"beforePlayerInit",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"afterCreate",value:function(){}},{key:"destroy",value:function(){}},{key:"add",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.toastNumber+1;this.toastNumber=i;var o=this.renderToast(e,n,i);return this.root.appendChild(o),this.toastMaps[i]=o,setTimeout((function(){t.remove(i)}),r),i}},{key:"remove",value:function(e){var t=this.toastMaps[e];t&&(this.root.contains(t)&&this.root.removeChild(t),delete this.toastMaps[e])}},{key:"renderToast",value:function(e,t,r){var n=this,i=util$2.createDom("div","",void 0,"toast-container"),o=util$2.checkIsObject(e)?e:util$2.createDom("div",e,void 0,"toast-txt");if(i.appendChild(o),t){var a=util$2.createDom("span","×",void 0,"toast-close-bt");a.addEventListener("click",(function(){n.remove(r)})),i.appendChild(a)}return i}},{key:"render",value:function(){return'<xg-sdk-toast class="xgplayer-sdk-toast"></xg-sdk-toast>'}}],[{key:"pluginName",get:function(){return"sdkToastPlugin"}},{key:"defaultConfig",get:function(){return{index:5}}}]),r}(Plugin);function createSDKPreset(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=["default",getDefaultPreset(e)];return r?o.push(getMobilePreset(e,t,n,i)):o.push(getPCPreset(e,t,i)),o}function getDefaultPreset(e){var t=[UnmutePlugin,ErrorPlugin,ToastPlugin];return e&&t.push(RefreshPlugin),_createClass$3((function e(){_classCallCheck$3(this,e),this.plugins=t,this.ignores=["error"]}))}function getMobilePreset(e,t,r,n){var i=["definition","error","playbackRate"],o=["time","playnext","progress","progresspreview","replay","playbackRate","discontinue"],a=[MoreButtonPlugin,DanmuPlugin];switch(t){case"flv":r&&a.push(FlvPlugin);break;case"hls":HlsPlugin.isSupported(!0)&&r&&a.push(HlsPlugin);break;case"rtm":a.push(RtmPlugin);break;case"dash":var s,u;if(n.url)a.push(ShakaJsPlugin);else null!=DASHPlugin&&null!==(s=DASHPlugin.encryptUtils)&&void 0!==s&&null!==(u=s.isSupported)&&void 0!==u&&u.call(s)&&a.push(DASHPlugin)}return a=[].concat(_toConsumableArray$2(a),_toConsumableArray$2(getPluginByConfig(n,a))),_createClass$3((function t(){_classCallCheck$3(this,t),this.plugins=a,this.ignores=e?[].concat(o,i):[].concat(i)}))}function getPCPreset(e,t,r){var n=["cssfullscreen","definition"],i=["time","playnext","progress","progresspreview","replay","playbackRate","discontinue"],o=[MultilinePlugin,DefinitionPlugin,DanmuPlugin];switch(t){case"flv":o.push(FlvPlugin);break;case"hls":o.push(HlsPlugin);break;case"rtm":o.push(RtmPlugin);break;case"dash":r.url?o.push(ShakaJsPlugin):o.push(DASHPlugin)}return o=[].concat(_toConsumableArray$2(o),_toConsumableArray$2(getPluginByConfig(r,o))),_createClass$3((function t(){_classCallCheck$3(this,t),this.plugins=o,this.ignores=e?[].concat(i,n):[].concat(n)}))}function getPluginByConfig(e,t){var r=[];return e.EncryptHlsPlugin&&r.push(EncryptHlsPlugin),e.DASHPlugin&&!t.includes(DASHPlugin)&&r.push(DASHPlugin),e.vodLogOpts&&r.push(xgVodLogger),r.filter((function(e){var t,r,n,i,o;return"encrypthlsplugin"===(null==e||null===(t=e.pluginName)||void 0===t?void 0:t.toLowerCase())?!(null==e||null===(n=e.isSupported)||void 0===n||!n.call(e))||(console.warn("该浏览器环境中 EncryptHlsPlugin 插件不支持"),!1):"dashplugin"!==(null==e||null===(r=e.pluginName)||void 0===r?void 0:r.toLowerCase())||(!(null==e||null===(i=e.encryptUtils)||void 0===i||null===(o=i.isSupported)||void 0===o||!o.call(i))||(console.warn("该浏览器环境中 DASHPlugin 插件不支持"),!1))}))}function danmuSettingsSVG$1(){return(new DOMParser).parseFromString('<svg width="22" height="19" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" opacity=".6"><path d="M-4-4h28v28H-4z"/><path d="M1 19a1 1 0 01-1-1V1a1 1 0 011-1h17.2a1 1 0 011 1v3.75h-.001l.001 1.475a.9.9 0 11-1.8 0V1.8H1.8v15.4h8.442l-.029.019h.296a.89.89 0 01.017 1.78h7.691L18.2 19H1z" fill="#FFF" fill-rule="nonzero"/><path d="M5.507 7.698L5.33 9.279h2.511c0 2.015-.075 3.362-.2 4.042-.151.68-.792 1.054-1.934 1.124-.327 0-.653-.023-1.005-.047l-.339-1.136c.327.035.678.059 1.03.059.628 0 .98-.188 1.067-.563.088-.374.138-1.183.138-2.424H4l.352-3.679h2.122V5.132H4.113V4.09h3.654v3.608h-2.26zm3.089-2.214h1.507A8.91 8.91 0 009.16 4.03l1.193-.375c.351.469.665.96.93 1.5l-.792.328h1.733a14.68 14.68 0 00.93-1.921l1.242.41a8.956 8.956 0 01-.854 1.51H15v4.933h-2.587v.902h2.446l-1.014 1.148h-1.432v2.097h-1.28v-2.097h-2.99v-1.148h2.99v-.902H8.595V5.484zm5.249 3.912v-.913h-1.432v.913h1.432zm-2.713 0v-.913H9.764v.913h1.368zm-1.368-1.92h1.368v-.961H9.764v.96zm2.65-.961v.96h1.43v-.96h-1.43z" fill="#FFF" fill-rule="nonzero"/><path d="M17.595 9.84l2.957 1.69a1.2 1.2 0 01.605 1.041v3.358c0 .43-.23.828-.605 1.041l-2.957 1.69a1.2 1.2 0 01-1.19 0l-2.957-1.69a1.2 1.2 0 01-.605-1.041V12.57c0-.43.23-.828.605-1.041l2.957-1.69a1.2 1.2 0 011.19 0zM17 12.47c-.994 0-1.8.797-1.8 1.781a1.79 1.79 0 001.8 1.781c.994 0 1.8-.797 1.8-1.781a1.79 1.79 0 00-1.8-1.781z" fill="#FFF"/></g></svg>',"image/svg+xml").firstChild}function fullscreenActiveSVG$1(){return(new DOMParser).parseFromString('<svg width="21" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.892 2h4.445v1.778H3.892v4.444H2.114V3.778C2.114 2.796 2.91 2 3.892 2zm4.445 16v-4.444c0-.982-.796-1.778-1.778-1.778H2.114v1.778h2.944L2.264 16.35a.9.9 0 001.272 1.273l2.988-2.987a.918.918 0 00.035-.037V18h1.778zm8-6.222v4.444h-4.445V18h4.445c.981 0 1.777-.796 1.777-1.778v-4.444h-1.777zM11.892 2v4.445c0 .981.796 1.777 1.778 1.777h4.444V6.445H15.17l2.568-2.568a.9.9 0 10-1.273-1.273L13.67 5.4V2h-1.778z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function fullscreenDefaultSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.778 2h4.444v1.778H3.778v4.444H2V3.778C2 2.796 2.796 2 3.778 2zM2 11.778v4.444C2 17.204 2.796 18 3.778 18h4.444v-1.778H4.823l2.313-2.313a.9.9 0 00-1.272-1.273l-2.086 2.086v-2.944H2zm14.222 0v4.444h-4.444V18h4.444c.982 0 1.778-.796 1.778-1.778v-4.444h-1.778zM18 8.222V3.778C18 2.796 17.204 2 16.222 2h-4.444v1.778h2.945l-2.587 2.586a.9.9 0 101.273 1.273l2.813-2.813v3.398H18z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function pauseSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5.313" y="3.75" width="3.125" height="12.5" rx=".625" fill="#fff"/><rect x="11.563" y="3.75" width="3.125" height="12.5" rx=".625" fill="#fff"/></svg>',"image/svg+xml").firstChild}function playSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.121 8.299a2 2 0 010 3.402l-7.94 4.91c-1.332.825-3.051-.133-3.051-1.7V5.09c0-1.567 1.72-2.525 3.052-1.701l7.939 4.911z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function playNextSVG$1(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.03 8.312a2 2 0 010 3.376l-7.642 4.858c-1.332.847-3.073-.11-3.073-1.687V5.14c0-1.577 1.741-2.534 3.073-1.687l7.642 4.858z" fill="#fff"/><path d="M13 3.5a.5.5 0 01.5-.5h1a.5.5 0 01.5.5v13a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5v-13z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function replaySVG(){return(new DOMParser).parseFromString('<svg width="72" height="72" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><g fill="#FFF" fill-rule="evenodd"><circle fill-opacity=".3" cx="36" cy="36" r="36"/><path d="M40.167 32.667a.833.833 0 01-.834-.834v-1.666c0-.46.373-.834.834-.834h5.409a11.653 11.653 0 00-9.576-5c-6.443 0-11.667 5.224-11.667 11.667S29.557 47.667 36 47.667c5.285 0 9.749-3.514 11.183-8.333h3.445C49.112 46.014 43.138 51 36 51c-8.284 0-15-6.716-15-15 0-8.284 6.716-15 15-15 4.713 0 8.918 2.173 11.668 5.572l-.001-4.739c0-.46.373-.833.833-.833h1.667c.46 0 .833.373.833.833V31c0 .879-.68 1.598-1.542 1.662l-.125.005h-9.166z"/></g></svg>',"image/svg+xml").firstChild}function startPlaySVG(){return(new DOMParser).parseFromString('<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" rx="30" fill="#000" fill-opacity=".4"/><path d="M40.243 28.3a2 2 0 010 3.401L24.06 41.712c-1.332.825-3.052-.134-3.052-1.7V19.988c0-1.566 1.72-2.525 3.052-1.7l16.184 10.01z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function volumeLargeSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.867 2.5h.55c.44 0 .799.34.83.771l.003.062v13.334c0 .44-.34.799-.771.83l-.062.003h-.55a.833.833 0 01-.444-.128l-.064-.045-4.867-3.744a.831.831 0 01-.322-.59l-.003-.07V7.077c0-.235.099-.458.271-.615l.054-.045L9.36 2.673a.832.832 0 01.43-.17l.078-.003h.55-.55zm6.767 2.278A7.474 7.474 0 0118.75 10a7.477 7.477 0 01-2.128 5.234.4.4 0 01-.57-.004l-.587-.586a.442.442 0 01.005-.617A5.812 5.812 0 0017.083 10c0-1.557-.61-2.97-1.603-4.017a.442.442 0 01-.003-.615l.586-.586a.4.4 0 01.57-.004zM2.5 6.667c.23 0 .417.186.417.416v5.834c0 .23-.187.416-.417.416h-.833a.417.417 0 01-.417-.416V7.083c0-.23.187-.416.417-.416H2.5zm11.768.46A4.153 4.153 0 0115.417 10c0 1.12-.442 2.137-1.162 2.886a.388.388 0 01-.555-.007l-.577-.578c-.176-.176-.156-.467.009-.655A2.49 2.49 0 0013.75 10a2.49 2.49 0 00-.61-1.636c-.163-.188-.182-.477-.006-.653l.578-.578a.388.388 0 01.556-.006z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function volumeMutedSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.045 2.5h.55c.44 0 .8.34.831.771l.003.062v13.334c0 .44-.34.799-.771.83l-.063.003h-.55a.833.833 0 01-.443-.128l-.065-.045-4.866-3.744a.831.831 0 01-.323-.59l-.003-.07V7.077c0-.235.1-.458.272-.615l.054-.045 4.866-3.744a.832.832 0 01.43-.17l.078-.003h.55-.55zM2.68 6.667c.23 0 .416.186.416.416v5.834c0 .23-.186.416-.416.416h-.834a.417.417 0 01-.416-.416V7.083c0-.23.186-.416.416-.416h.834zm10.467.294a.417.417 0 01.59 0l1.767 1.768L17.27 6.96a.417.417 0 01.589 0l.59.59a.417.417 0 010 .589L16.68 9.908l1.768 1.767c.15.15.162.387.035.55l-.035.04-.589.589a.417.417 0 01-.59 0l-1.767-1.768-1.768 1.768a.417.417 0 01-.59 0l-.588-.59a.417.417 0 010-.589l1.767-1.768-1.767-1.767a.417.417 0 01-.035-.55l.035-.04.589-.589z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function volumeSmallSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.867 2.5h.55c.44 0 .799.34.83.771l.003.062v13.334c0 .44-.34.799-.771.83l-.062.003h-.55a.833.833 0 01-.444-.128l-.064-.045-4.867-3.744a.831.831 0 01-.322-.59l-.003-.07V7.077c0-.235.099-.458.271-.615l.054-.045L9.36 2.673a.832.832 0 01.43-.17l.078-.003h.55-.55zM2.5 6.667c.23 0 .417.186.417.416v5.834c0 .23-.187.416-.417.416h-.833a.417.417 0 01-.417-.416V7.083c0-.23.187-.416.417-.416H2.5zm11.768.46A4.153 4.153 0 0115.417 10c0 1.12-.442 2.137-1.162 2.886a.388.388 0 01-.555-.007l-.577-.578c-.176-.176-.156-.467.009-.655A2.49 2.49 0 0013.75 10a2.49 2.49 0 00-.61-1.636c-.163-.188-.182-.477-.006-.653l.578-.578a.388.388 0 01.556-.006z" fill="#fff"/></svg>',"image/svg+xml").firstChild}var iconsOption$1={startPlay:startPlaySVG,play:playSVG$1,pause:pauseSVG$1,fullscreen:fullscreenDefaultSVG$1,exitFullscreen:fullscreenActiveSVG$1,playNext:playNextSVG$1,replay:replaySVG,refresh:refreshSVG$1,danmuSetting:danmuSettingsSVG$1,openDanmu:Default,closeDanmu:danmuActiveSVG$1,volumeLarge:volumeLargeSVG,volumeMuted:volumeMutedSVG,volumeSmall:volumeSmallSVG},initOption$1={whitelist:[""],widescreen:!0,width:"100%",height:"100%",fitVideoSize:!1,autoplay:!0,autoplayMuted:!0,inactive:2e3,playsinline:!0,keyShortcut:"off",closeVideoClick:!0,closeVideoDblclick:!0,closePlayerBlur:!1,closeControlsBlur:!1,closePlayVideoFocus:!0,leavePlayerTime:0,mini:!1,pip:{position:"controlsRight",index:2.5,showIcon:!0},volume:{index:2.6},miniscreen:{left:window.innerWidth-360,top:window.innerHeight-450},time:{index:3},icons:_objectSpread2$1({},iconsOption$1)},liveOption$1={isLive:!0,closeVideoClick:!0,preloadTime:8,start:{isShowPause:!1,isShowEnd:!1,mode:"hide",disableAnimate:!0},retry:{count:0},flv:{retryCount:0},hls:{retryCount:0}},vodOption$1={isLive:!1,closeVideoClick:!1,defaultPlaybackRate:1,closeVideoStopPropagation:!0,playbackRate:[2,1.5,1.25,{rate:1,iconText:{zh:"倍速",en:"Speed",jp:"Speed"}},.75,.5],start:{isShowPause:!0,isShowEnd:!1,mode:"hide",disableAnimate:!0},progresspreview:{isShowCoverPreview:!0},progress:{isPauseMoving:!0}};function createPlayerOption$1(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_objectSpread2$1({},initOption$1),r=_objectSpread2$1({},e?liveOption$1:vodOption$1);return _objectSpread2$1(_objectSpread2$1({},t),r)}function danmuSVG(){return(new DOMParser).parseFromString('<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.746 12.444a1 1 0 00-.62.216L1.75 13.75V2.166c0-.23.187-.417.417-.417h11.666c.23 0 .417.187.417.417v6.687c.44.044.86.156 1.25.326V2.167c0-.92-.746-1.667-1.667-1.667H2.167C1.247.5.5 1.246.5 2.167V14.61a.833.833 0 001.35.653l1.71-1.354a1 1 0 01.621-.216h5.543a4.195 4.195 0 01-.02-1.25H3.745z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 4a.5.5 0 00-.5.5V5a.5.5 0 00.5.5h5A.5.5 0 0010 5v-.5a.5.5 0 00-.5-.5h-5zm2.333 4.167a.5.5 0 00-.5.5v.666a.5.5 0 00.5.5h4.292c.311-.266.662-.487 1.042-.653v-.513a.5.5 0 00-.5-.5H6.834zm-3 .5a.5.5 0 01.5-.5H5a.5.5 0 01.5.5v.666a.5.5 0 01-.5.5h-.667a.5.5 0 01-.5-.5v-.666z" fill="#fff"/><path d="M11 4.5a.5.5 0 01.5-.5h.5a.5.5 0 01.5.5V5a.5.5 0 01-.5.5h-.5A.5.5 0 0111 5v-.5z" fill="#fff"/><circle cx="13.833" cy="13" r="3.333" fill="#3370FF"/><path d="M15.591 12.011l-2.133 2.134-1.22-1.22" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"/></svg>',"image/svg+xml").firstChild}function danmuActiveSVG(){return(new DOMParser).parseFromString('<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.746 12.444a1 1 0 00-.62.216L1.75 13.75V2.166c0-.23.187-.417.417-.417h11.666c.23 0 .417.187.417.417v6.687c.44.044.86.156 1.25.326V2.167c0-.92-.746-1.667-1.667-1.667H2.167C1.247.5.5 1.246.5 2.167V14.61a.833.833 0 001.35.653l1.71-1.354a1 1 0 01.621-.216h5.543a4.195 4.195 0 01-.02-1.25H3.745z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 4a.5.5 0 00-.5.5V5a.5.5 0 00.5.5h5A.5.5 0 0010 5v-.5a.5.5 0 00-.5-.5h-5zm2.333 4.167a.5.5 0 00-.5.5v.666a.5.5 0 00.5.5h4.292c.311-.266.662-.487 1.042-.653v-.513a.5.5 0 00-.5-.5H6.834zm-3 .5a.5.5 0 01.5-.5H5a.5.5 0 01.5.5v.666a.5.5 0 01-.5.5h-.667a.5.5 0 01-.5-.5v-.666z" fill="#fff"/><path d="M11 4.5a.5.5 0 01.5-.5h.5a.5.5 0 01.5.5V5a.5.5 0 01-.5.5h-.5A.5.5 0 0111 5v-.5z" fill="#fff"/><circle cx="13.833" cy="13" r="2.733" stroke="#fff" stroke-width="1.2"/><path fill="#fff" d="M12.833 10.77l3.473 3.472-1.063 1.064-3.474-3.473z"/></svg>',"image/svg+xml").firstChild}function danmuSettingsSVG(){return(new DOMParser).parseFromString('<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.746 12.444a1 1 0 00-.62.216L1.75 13.75V2.166c0-.23.187-.417.417-.417h11.666c.23 0 .417.187.417.417v6.687c.44.044.86.156 1.25.326V2.167c0-.92-.746-1.667-1.667-1.667H2.167C1.247.5.5 1.246.5 2.167V14.61a.833.833 0 001.35.653l1.71-1.354a1 1 0 01.621-.216h5.543a4.195 4.195 0 01-.02-1.25H3.745z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 4a.5.5 0 00-.5.5V5a.5.5 0 00.5.5h5A.5.5 0 0010 5v-.5a.5.5 0 00-.5-.5h-5zm2.333 4.167a.5.5 0 00-.5.5v.666a.5.5 0 00.5.5h4.292c.311-.266.662-.487 1.042-.653v-.513a.5.5 0 00-.5-.5H6.834zm-3 .5a.5.5 0 01.5-.5H5a.5.5 0 01.5.5v.666a.5.5 0 01-.5.5h-.667a.5.5 0 01-.5-.5v-.666z" fill="#fff"/><path d="M11 4.5a.5.5 0 01.5-.5h.5a.5.5 0 01.5.5V5a.5.5 0 01-.5.5h-.5A.5.5 0 0111 5v-.5z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.387 10.134a1 1 0 00-1 0l-1.887 1.09a1 1 0 00-.5.865v2.179a1 1 0 00.5.866l1.887 1.09a1 1 0 001 0l1.886-1.09a1 1 0 00.5-.866v-2.179a1 1 0 00-.5-.866l-1.886-1.089zm-.5 4.711a1.667 1.667 0 100-3.333 1.667 1.667 0 000 3.333z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function fullscreenActiveSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.5 8.333h-4.167c-.92 0-1.666-.746-1.666-1.666V2.5h1.666v4.167H17.5v1.666zM2.5 6.667v1.666h4.167c.92 0 1.666-.746 1.666-1.666V2.5H6.667v4.167H2.5zM2.5 13.333h4.167V17.5h1.666v-4.167c0-.92-.746-1.666-1.666-1.666H2.5v1.666zM13.333 17.5v-4.167H17.5v-1.666h-4.167c-.92 0-1.666.746-1.666 1.666V17.5h1.666z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function fullscreenDefaultSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.125 3a.375.375 0 00-.375.375v.75c0 .207.168.375.375.375H15.5v3.375c0 .207.168.375.375.375h.75A.375.375 0 0017 7.875v-4.5A.375.375 0 0016.625 3h-4.5zm0 12.5a.375.375 0 00-.375.375v.75c0 .207.168.375.375.375h4.5a.375.375 0 00.375-.375v-4.5a.375.375 0 00-.375-.375h-.75a.375.375 0 00-.375.375V15.5h-3.375zM3 3.375C3 3.168 3.168 3 3.375 3h4.5c.207 0 .375.168.375.375v.75a.375.375 0 01-.375.375H4.5v3.375a.375.375 0 01-.375.375h-.75A.375.375 0 013 7.875v-4.5zM7.875 15.5H4.5v-3.375a.375.375 0 00-.375-.375h-.75a.375.375 0 00-.375.375v4.5c0 .207.168.375.375.375h4.5a.375.375 0 00.375-.375v-.75a.375.375 0 00-.375-.375z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function pauseSVG(){return(new DOMParser).parseFromString('<svg style="\n    height: 18px;\n    width: 18px;\n" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="7.438" y="5.25" width="4.375" height="17.5" rx=".875" fill="#fff"/><rect x="16.188" y="5.25" width="4.375" height="17.5" rx=".875" fill="#fff"/></svg>',"image/svg+xml").firstChild}function playSVG(){return(new DOMParser).parseFromString('<svg style="\n    height: 18px;\n    width: 18px;\n" width="28" height="28" fill="none" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><path d="M19.77 11.619c1.768 1.094 1.768 3.668 0 4.762L8.653 23.257c-1.865 1.154-4.273-.188-4.273-2.381V7.125c0-2.194 2.408-3.536 4.273-2.382L19.77 11.62z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function playNextSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M4.77 4.124l8.358 5.07c.38.23.486.704.238 1.056a.807.807 0 01-.238.22L4.77 15.543c-.38.231-.889.132-1.137-.221a.723.723 0 01-.134-.417V4.762c0-.421.368-.762.822-.762.159 0 .316.042.449.124z" stroke="#fff" stroke-width="1.5"/><path d="M15.5 4.5A.5.5 0 0116 4h.5a.5.5 0 01.5.5v11a.5.5 0 01-.5.5H16a.5.5 0 01-.5-.5v-11z" fill="#fff"/></svg>',"image/svg+xml").firstChild}function refreshSVG(){return(new DOMParser).parseFromString('<svg width="18" height="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h18v18H0z"/><path d="M10.875 7.5a.375.375 0 01-.375-.375v-.75c0-.207.168-.375.375-.375h2.434a5.25 5.25 0 10.723 4.5h1.55a6.75 6.75 0 11-1.332-5.743V2.626c0-.207.168-.375.375-.375h.75c.207 0 .375.168.375.375V6.75a.75.75 0 01-.694.748L15 7.5h-4.125z" fill="#FFF"/></g></svg>',"image/svg+xml").firstChild}var iconsOption={startPlay:startPlaySVG,play:playSVG,pause:pauseSVG,fullscreen:fullscreenDefaultSVG,exitFullscreen:fullscreenActiveSVG,playNext:playNextSVG,replay:replaySVG,refresh:refreshSVG,danmuSetting:danmuSettingsSVG,openDanmu:danmuSVG,closeDanmu:danmuActiveSVG,volumeLarge:volumeLargeSVG,volumeMuted:volumeMutedSVG,volumeSmall:volumeSmallSVG},isIOS=!sniffer.os.isAndroid,initOption={width:"100%",height:"100%",playsinline:!0,closeVideoClick:!0,closeVideoTouch:!0,autoplay:!0,autoplayMuted:!0,whitelist:[""],"x5-video-player-type":"h5-page","x5-video-player-fullscreen":!1,"x5-video-orientation":"landscape|portrait",enterTips:{background:"linear-gradient(90deg,#000,#49e6d3,#49e6d3,#138afc,#000)"},retainPlay:!0,start:{isShowPause:!0,isShowEnd:!0,disableAnimate:!1},fullscreen:{useCssFullscreen:isIOS},plugins:[],time:{mode:"pc",index:2.5},controls:{mode:"flex"},danmusettings:{index:"2"},danmuicon:{index:"3"},cusPlaybackRatePlugin:{needCheck:!0,needPanel:!1},icons:_objectSpread2$1({},iconsOption)},liveOption={isLive:!0,closeVideoClick:!0,start:{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"},retry:{count:0},flv:{retryCount:0},hls:{retryCount:0},longwaiting:{duration:3e4},mobile:{gestureY:!1,gestureX:!1,disableActive:!0}},vodOption={isLive:!1,closeVideoClick:!1,playbackRate:[2,1.5,1.25,{rate:1,iconText:"倍速",en:"speed",jp:"speed"},.75,.5],defaultPlaybackRate:1,closeVideoStopPropagation:!0,mobile:{gestureY:!1},start:{isShowPause:!0,isShowEnd:!1,disableAnimate:!1,mode:"hide"}};function createPlayerOption(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_objectSpread2$1({},initOption),r=_objectSpread2$1({},e?liveOption:vodOption);return _objectSpread2$1(_objectSpread2$1({},t),r)}var POSITIONS$5=Plugin.POSITIONS,extendPlugin=function(e){var t="mobile"===sniffer.device,r=e.pluginName,n=void 0===r?"ExtendPlugin".concat(Math.random().toString().slice(-5)):r,i=e.type,o=void 0===i?t?"inner":"normal":i,a=e.position,s=void 0===a?POSITIONS$5.CONTROLS_LEFT:a,u=e.icon,c=void 0===u?Default:u,l=e.index,d=void 0===l?1:l,f=e.hideAtFullScreen,h=void 0===f||f,p=e.tips,g=void 0===p?{jp:"custom",en:"custom",zh:"自定义","zh-hk":"自定义"}:p;return function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){return _classCallCheck$3(this,r),t.apply(this,arguments)}return _createClass$3(r,[{key:"afterCreate",value:function(){var e;this.appendChild(".xgplayer-icon",this.icons[n]),this.initEvents(),h&&null!==(e=this.player)&&void 0!==e&&e.fullscreen&&this.handleFullScreenChange()}},{key:"registerIcons",value:function(){return _defineProperty$3({},n,{icon:c,class:"xgplayer-extendicon-svg"})}},{key:"updateIcons",value:function(e){var t=this.find(".xgplayer-icon");t&&(t.innerHTML=e)}},{key:"registerLanguageTexts",value:function(){return _defineProperty$3({},n,g)}},{key:"initEvents",value:function(){this.handleCallback=debounce_1(this.handleCallback.bind(this),200);var e,t="mobile"===sniffer.device?"touchend":"click";(this.bind(t,this.handleCallback),this.show(),h)&&(null===(e=this.player)||void 0===e||e.on(FULLSCREEN_CHANGE,this.handleFullScreenChange.bind(this)))}},{key:"handleFullScreenChange",value:function(){var e,t=this.player;null===(e=this.player)||void 0===e||e.changePluginsIcon(n,!(null!=t&&t.fullscreen))}},{key:"handleCallback",value:function(e){var t=this.player;t&&(e.preventDefault(),e.stopPropagation(),t.emit(PluginEvents.PLAYER_EXTEND_BUTTON,n))}},{key:"destroy",value:function(){var e;(this.unbind(["touchend","click"],this.handleCallback),h)&&(null===(e=this.player)||void 0===e||e.off(FULLSCREEN_CHANGE,this.handleFullScreenChange.bind(this)))}},{key:"render",value:function(){return'\n      <xg-icon class="xgplayer-extend-icon">\n        <div class="xgplayer-icon">\n        </div>\n        <div class="xg-tips" lang-key="'.concat(n,'">').concat(this.langText[n],"</div>\n      </xg-icon>\n      ")}}],[{key:"isExtendPlugin",get:function(){return!0}},{key:"type",get:function(){return o}},{key:"textTips",get:function(){return g}},{key:"pluginName",get:function(){return n}},{key:"defaultConfig",get:function(){return{position:s,index:d}}}]),r}(Plugin)},MobilePlayerPanel=function(){function e(t){var r,n;_classCallCheck$3(this,e);var i=t.config,o=t.root,a=t.player;this.config=i,this.parent=o,this.player=a,this.mode=null!==(r=null==i?void 0:i.mode)&&void 0!==r?r:PLAYER_MODE.INNER,this.isAutoChange=null!==(n=null==i?void 0:i.isAutoChange)&&void 0!==n&&n,this.initEvents(),this.renderPanel()}var t;return _createClass$3(e,[{key:"initEvents",value:function(){var e;this.isAutoChange&&(window.addEventListener("orientationchange",this.handleOrientationChange.bind(this)),null===(e=this.player)||void 0===e||e.on(FULLSCREEN_CHANGE,this.handleOrientationChange.bind(this)))}},{key:"handleOrientationChange",value:function(){var e,t,r,n=[90,-90,"90","-90"].includes(window.orientation);null!==(e=this.player)&&void 0!==e&&e.fullscreen&&n?this.changeMode(PLAYER_MODE.FULLSCREEN):this.changeMode(null!==(t=null===(r=this.config)||void 0===r?void 0:r.mode)&&void 0!==t?t:PLAYER_MODE.INNER)}},{key:"changeConfig",value:function(e){this.config=e}},{key:"changeMode",value:function(e){this.mode=e,this.player.emit(PluginEvents.PANEL_MODE_CHANGE,{mode:e}),this.destroy(),this.renderPanel()}},{key:"renderPanel",value:function(){var e="xg-mobile-panel panel-".concat(["normal","inner","fullscreen"][this.mode]);switch(this.root=util$2.createDom("div","",{},e),this.parent&&(this.parent.appendChild(this.root),this.hide()),this.bind("click",this.handleHide.bind(this)),this.mode){case PLAYER_MODE.NORMAL:var t=util$2.createDom("div","",{},"xg-mobile-panel-content");this.root.appendChild(t),this.container=t,t.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault()}));break;case PLAYER_MODE.INNER:this.container=this.root;break;case PLAYER_MODE.FULLSCREEN:var r=util$2.createDom("div","",{},"xg-mobile-panel-content");this.root.appendChild(r),this.container=r,r.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault()}))}}},{key:"showPanel",value:(t=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(t){var r,n=this,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:"",i.length>2&&void 0!==i[2]&&i[2]&&util$2.addClass(t,"item-list-panel-content"),this.setTitle(r),!this.children){e.next=9;break}return e.next=7,this.hide();case 7:return setTimeout((function(){n.children=t,n.container&&(n.title&&n.container.appendChild(n.title),n.container.appendChild(t)),n.show()})),e.abrupt("return");case 9:this.children=t,this.container&&(this.title&&this.container.appendChild(this.title),this.container.appendChild(t)),this.show();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"updatePanel",value:function(e){this.children&&util$2.hasClass(this.children,"item-list-panel-content")&&util$2.addClass(e,"item-list-panel-content"),this.children=e,this.container&&(this.container.innerHTML="",this.title&&this.container.appendChild(this.title),this.container.appendChild(e)),this.show()}},{key:"setTitle",value:function(e){e&&this.mode!==PLAYER_MODE.INNER?this.title?this.title.innerHTML=e:this.title=this.renderTitle(e):this.title=void 0}},{key:"renderTitle",value:function(e){return util$2.createDom("div",e,{},"xg-mobile-panel-title")}},{key:"show",value:function(){util$2.removeClass(this.root,"hide"),util$2.addClass(this.root,"active")}},{key:"hide",value:function(){util$2.removeClass(this.root,"active"),util$2.addClass(this.root,"hide"),this.container&&(this.container.innerHTML="")}},{key:"handleHide",value:function(e){e.stopPropagation(),e.preventDefault(),this.hide()}},{key:"bind",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.root&&"on".concat(e)in this.root&&"function"==typeof t&&this.root.addEventListener(e,t,r)}},{key:"destroy",value:function(){var e;this.parent&&this.root&&this.parent.removeChild(this.root),window.removeEventListener("orientationchange",this.handleOrientationChange.bind(this)),null===(e=this.player)||void 0===e||e.off(FULLSCREEN_CHANGE,this.handleOrientationChange.bind(this))}}]),e}();function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},_get.apply(this,arguments)}var $$2=_export$1,fails=fails$1m,getOwnPropertyNames=objectGetOwnPropertyNamesExternal$1.f,FAILS_ON_PRIMITIVES=fails((function(){return!Object.getOwnPropertyNames(1)}));$$2({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES},{getOwnPropertyNames:getOwnPropertyNames});var $$1=_export$1,parseFloat$1=numberParseFloat$1;$$1({target:"Number",stat:!0,forced:Number.parseFloat!=parseFloat$1},{parseFloat:parseFloat$1});var $=_export$1;$({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var webm="data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4="data:video/mp4;base64, AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw",oldIOS=function(){return"undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream},nativeWakeLock=function(){return"wakeLock"in navigator},NoSleep=function(){function e(){var t=this;_classCallCheck$1(this,e),this.enabled=!1,nativeWakeLock()?(this._wakeLock=null,this.handleVisibilityChange=function(){null!==t._wakeLock&&"visible"===document.visibilityState&&t.enable()},document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("fullscreenchange",this.handleVisibilityChange)):oldIOS()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"mp4",mp4),this._addSourceToVideo(this.noSleepVideo,"webm",webm),this.noSleepVideo.addEventListener("loadedmetadata",(function(){t.noSleepVideo&&(t.noSleepVideo.duration<=1?t.noSleepVideo.setAttribute("loop",""):(t.onTimeupdate=function(){t.noSleepVideo.currentTime>.5&&(t.noSleepVideo.currentTime=Math.random())},t.noSleepVideo.addEventListener("timeupdate",t.onTimeupdate)))})))}return _createClass$1(e,[{key:"_addSourceToVideo",value:function(e,t,r){var n=document.createElement("source");n.src=r,n.type="video/".concat(t),e.appendChild(n)}},{key:"isEnabled",get:function(){return this.enabled}},{key:"enable",value:function(){var e=this;if(nativeWakeLock())return navigator.wakeLock.request("screen").then((function(t){e._wakeLock=t,e.enabled=!0,e._wakeLock.addEventListener("release",(function(){console.log("Wake Lock released.")}))})).catch((function(t){e.enabled=!1,console.error("".concat(t.name,", ").concat(t.message))}));if(oldIOS())return this.disable(),console.warn("\n        NoSleep enabled for older iOS devices. This can interrupt\n        active or long-running network requests from completing successfully.\n        See https://github.com/richtr/NoSleep.js/issues/15 for more details.\n      "),this.noSleepTimer=window.setInterval((function(){document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))}),15e3),this.enabled=!0,Promise.resolve();if(this.noSleepVideo.paused){var t=this.noSleepVideo.play();return t&&t.then((function(t){return e.enabled=!0,t})).catch((function(t){console.log("noSleep: ",t.message),e.enabled=!1}))}}},{key:"disable",value:function(){nativeWakeLock()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):oldIOS()?this.noSleepTimer&&(console.warn("\n          NoSleep now disabled for older iOS devices.\n        "),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}},{key:"toPlay",value:function(){if(this.noSleepVideo&&this.noSleepVideo.paused){var e=performance.now();this.lastTs||(this.lastTs=e),e-this.lastTs>1e4&&(this.enable(),this.lastTs=e)}}},{key:"destroy",value:function(){this.disable(),this.handleVisibilityChange&&(document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("fullscreenchange",this.handleVisibilityChange)),this.onTimeupdate&&this.noSleepVideo.removeEventListener("timeupdate",this.onTimeupdate),this.noSleepVideo=null}}]),e}(),ele;function initBgSilenceAudio(){if(!document.querySelector("#hackAudioPP")){var e=document.createElement("div");e.innerHTML="<audio id='hackAudioPP'></audio>",document.body.appendChild(e);var t=e.children.item(0);t.controls=!1,t.preload="auto",t.innerHTML="<source src=".concat("data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADgnABGiAAQBCqgCRMAAgEAH///////////////7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq//////////////////9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",' type="audio/mpeg"></source>'),t.muted=!0,t.loop=!0,t.play().catch((function(){}))}}function playSlienceAudio(){var e=ele||(ele=document.querySelector("#hackAudioPP"));e||initBgSilenceAudio(),!1===e.paused&&!1===e.muted||(e.muted=!1,e.play().catch((function(e){console.log("bgAudio: ",e.message)})))}function pauseSlienceAudio(){var e=ele||(ele=document.querySelector("#hackAudioPP"));e&&e.pause()}(function(){var e=window.Document.prototype.createElement,t=window.Document.prototype.createElementNS,r=window.Document.prototype.importNode,n=window.Document.prototype.prepend,i=window.Document.prototype.append,o=window.DocumentFragment.prototype.prepend,a=window.DocumentFragment.prototype.append,s=window.Node.prototype.cloneNode,u=window.Node.prototype.appendChild,c=window.Node.prototype.insertBefore,l=window.Node.prototype.removeChild,d=window.Node.prototype.replaceChild,f=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),h=window.Element.prototype.attachShadow,p=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),g=window.Element.prototype.getAttribute,y=window.Element.prototype.setAttribute,v=window.Element.prototype.removeAttribute,m=window.Element.prototype.getAttributeNS,_=window.Element.prototype.setAttributeNS,b=window.Element.prototype.removeAttributeNS,A=window.Element.prototype.insertAdjacentElement,E=window.Element.prototype.insertAdjacentHTML,S=window.Element.prototype.prepend,T=window.Element.prototype.append,$=window.Element.prototype.before,w=window.Element.prototype.after,C=window.Element.prototype.replaceWith,I=window.Element.prototype.remove,k=window.HTMLElement,O=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),P=window.HTMLElement.prototype.insertAdjacentElement,R=window.HTMLElement.prototype.insertAdjacentHTML,x=new Set;function D(e){var t=x.has(e);return e=/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(e),!t&&e}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(e){return x.add(e)}));var L=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function N(e){var t=e.isConnected;if(void 0!==t)return t;if(L(e))return!0;for(;e&&!(e.__CE_isImportDocument||e instanceof Document);)e=e.parentNode||(window.ShadowRoot&&e instanceof ShadowRoot?e.host:void 0);return!(!e||!(e.__CE_isImportDocument||e instanceof Document))}function M(e){var t=e.children;if(t)return Array.prototype.slice.call(t);for(t=[],e=e.firstChild;e;e=e.nextSibling)e.nodeType===Node.ELEMENT_NODE&&t.push(e);return t}function B(e,t){for(;t&&t!==e&&!t.nextSibling;)t=t.parentNode;return t&&t!==e?t.nextSibling:null}function U(e,t,r){for(var n=e;n;){if(n.nodeType===Node.ELEMENT_NODE){var i=n;t(i);var o=i.localName;if("link"===o&&"import"===i.getAttribute("rel")){if(n=i.import,void 0===r&&(r=new Set),n instanceof Node&&!r.has(n))for(r.add(n),n=n.firstChild;n;n=n.nextSibling)U(n,t,r);n=B(e,i);continue}if("template"===o){n=B(e,i);continue}if(i=i.__CE_shadowRoot)for(i=i.firstChild;i;i=i.nextSibling)U(i,t,r)}n=n.firstChild?n.firstChild:B(e,n)}}function j(e,t,r){e[t]=r}function F(e){var t=document;this.c=e,this.a=t,this.b=void 0,re(this.c,this.a),"loading"===this.a.readyState&&(this.b=new MutationObserver(this.f.bind(this)),this.b.observe(this.a,{childList:!0,subtree:!0}))}function V(e){e.b&&e.b.disconnect()}function G(){var e=this;this.b=this.a=void 0,this.c=new Promise((function(t){e.b=t,e.a&&t(e.a)}))}function H(e){if(e.a)throw Error("Already resolved.");e.a=void 0,e.b&&e.b(void 0)}function K(e){this.f=new Map,this.g=new Map,this.l=new Map,this.i=!1,this.b=e,this.j=new Map,this.c=function(e){return e()},this.a=!1,this.h=[],this.m=e.f?new F(e):void 0}function z(e,t){if(!D(t))throw new SyntaxError("The element name '"+t+"' is not valid.");if(X(e,t))throw Error("A custom element with name '"+t+"' has already been defined.");if(e.i)throw Error("A custom element is already being defined.")}function W(e,t,r){var n;e.i=!0;try{var i=function(e){var t=o[e];if(void 0!==t&&!(t instanceof Function))throw Error("The '"+e+"' callback must be a function.");return t},o=r.prototype;if(!(o instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var a=i("connectedCallback"),s=i("disconnectedCallback"),u=i("adoptedCallback"),c=(n=i("attributeChangedCallback"))&&r.observedAttributes||[]}catch(l){throw l}finally{e.i=!1}return r={localName:t,constructorFunction:r,connectedCallback:a,disconnectedCallback:s,adoptedCallback:u,attributeChangedCallback:n,observedAttributes:c,constructionStack:[]},e.g.set(t,r),e.l.set(r.constructorFunction,r),r}function Y(e){if(!1!==e.a){e.a=!1;for(var t=[],r=e.h,n=new Map,i=0;i<r.length;i++)n.set(r[i],[]);for(re(e.b,document,{upgrade:function(r){if(void 0===r.__CE_state){var i=r.localName,o=n.get(i);o?o.push(r):e.g.has(i)&&t.push(r)}}}),i=0;i<t.length;i++)ne(e.b,t[i]);for(i=0;i<r.length;i++){for(var o=r[i],a=n.get(o),s=0;s<a.length;s++)ne(e.b,a[s]);(o=e.j.get(o))&&H(o)}r.length=0}}function X(e,t){var r=e.g.get(t);if(r)return r;if(r=e.f.get(t)){e.f.delete(t);try{return W(e,t,r())}catch(n){oe(n)}}}function Z(){var e=ce&&ce.noDocumentConstructionObserver,t=ce&&ce.shadyDomFastWalk;this.b=[],this.c=[],this.a=!1,this.shadyDomFastWalk=t,this.f=!e}function q(e,t,r,n){var i=window.ShadyDOM;if(e.shadyDomFastWalk&&i&&i.inUse){if(t.nodeType===Node.ELEMENT_NODE&&r(t),t.querySelectorAll)for(e=i.nativeMethods.querySelectorAll.call(t,"*"),t=0;t<e.length;t++)r(e[t])}else U(t,r,n)}function Q(e,t){e.a&&q(e,t,(function(t){return J(e,t)}))}function J(e,t){if(e.a&&!t.__CE_patched){t.__CE_patched=!0;for(var r=0;r<e.b.length;r++)e.b[r](t);for(r=0;r<e.c.length;r++)e.c[r](t)}}function ee(e,t){var r=[];for(q(e,t,(function(e){return r.push(e)})),t=0;t<r.length;t++){var n=r[t];1===n.__CE_state?e.connectedCallback(n):ne(e,n)}}function te(e,t){var r=[];for(q(e,t,(function(e){return r.push(e)})),t=0;t<r.length;t++){var n=r[t];1===n.__CE_state&&e.disconnectedCallback(n)}}function re(e,t,r){var n=(r=void 0===r?{}:r).s,i=r.upgrade||function(t){return ne(e,t)},o=[];for(q(e,t,(function(t){if(e.a&&J(e,t),"link"===t.localName&&"import"===t.getAttribute("rel")){var r=t.import;r instanceof Node&&(r.__CE_isImportDocument=!0,r.__CE_registry=document.__CE_registry),r&&"complete"===r.readyState?r.__CE_documentLoadHandled=!0:t.addEventListener("load",(function(){var r=t.import;if(!r.__CE_documentLoadHandled){r.__CE_documentLoadHandled=!0;var o=new Set;n&&(n.forEach((function(e){return o.add(e)})),o.delete(r)),re(e,r,{s:o,upgrade:i})}}))}else o.push(t)}),n),t=0;t<o.length;t++)i(o[t])}function ne(e,t){try{var r=t.ownerDocument,n=r.__CE_registry,i=n&&(r.defaultView||r.__CE_isImportDocument)?X(n,t.localName):void 0;if(i&&void 0===t.__CE_state){i.constructionStack.push(t);try{try{if(new i.constructorFunction!==t)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{i.constructionStack.pop()}}catch(u){throw t.__CE_state=2,u}if(t.__CE_state=1,t.__CE_definition=i,i.attributeChangedCallback&&t.hasAttributes()){var o=i.observedAttributes;for(i=0;i<o.length;i++){var a=o[i],s=t.getAttribute(a);null!==s&&e.attributeChangedCallback(t,a,null,s,null)}}N(t)&&e.connectedCallback(t)}}catch(u){oe(u)}}function ie(r,n,i,o){var a=n.__CE_registry;if(a&&(null===o||"http://www.w3.org/1999/xhtml"===o)&&(a=X(a,i)))try{var s=new a.constructorFunction;if(void 0===s.__CE_state||void 0===s.__CE_definition)throw Error("Failed to construct '"+i+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==s.namespaceURI)throw Error("Failed to construct '"+i+"': The constructed element's namespace must be the HTML namespace.");if(s.hasAttributes())throw Error("Failed to construct '"+i+"': The constructed element must not have any attributes.");if(null!==s.firstChild)throw Error("Failed to construct '"+i+"': The constructed element must not have any children.");if(null!==s.parentNode)throw Error("Failed to construct '"+i+"': The constructed element must not have a parent node.");if(s.ownerDocument!==n)throw Error("Failed to construct '"+i+"': The constructed element's owner document is incorrect.");if(s.localName!==i)throw Error("Failed to construct '"+i+"': The constructed element's local name is incorrect.");return s}catch(u){return oe(u),n=null===o?e.call(n,i):t.call(n,o,i),Object.setPrototypeOf(n,HTMLUnknownElement.prototype),n.__CE_state=2,n.__CE_definition=void 0,J(r,n),n}return J(r,n=null===o?e.call(n,i):t.call(n,o,i)),n}function oe(e){var t=e.message,r=e.sourceURL||e.fileName||"",n=e.line||e.lineNumber||0,i=e.column||e.columnNumber||0,o=void 0;void 0===ErrorEvent.prototype.initErrorEvent?o=new ErrorEvent("error",{cancelable:!0,message:t,filename:r,lineno:n,colno:i,error:e}):((o=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,t,r,n),o.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===o.error&&Object.defineProperty(o,"error",{configurable:!0,enumerable:!0,get:function(){return e}}),window.dispatchEvent(o),o.defaultPrevented||console.error(e)}F.prototype.f=function(e){var t=this.a.readyState;for("interactive"!==t&&"complete"!==t||V(this),t=0;t<e.length;t++)for(var r=e[t].addedNodes,n=0;n<r.length;n++)re(this.c,r[n])},K.prototype.o=function(e,t){var r=this;if(!(t instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");z(this,e),this.f.set(e,t),this.h.push(e),this.a||(this.a=!0,this.c((function(){return Y(r)})))},K.prototype.define=function(e,t){var r=this;if(!(t instanceof Function))throw new TypeError("Custom element constructors must be functions.");z(this,e),W(this,e,t),this.h.push(e),this.a||(this.a=!0,this.c((function(){return Y(r)})))},K.prototype.upgrade=function(e){re(this.b,e)},K.prototype.get=function(e){if(e=X(this,e))return e.constructorFunction},K.prototype.whenDefined=function(e){if(!D(e))return Promise.reject(new SyntaxError("'"+e+"' is not a valid custom element name."));var t=this.j.get(e);if(t)return t.c;t=new G,this.j.set(e,t);var r=this.g.has(e)||this.f.has(e);return e=-1===this.h.indexOf(e),r&&e&&H(t),t.c},K.prototype.polyfillWrapFlushCallback=function(e){this.m&&V(this.m);var t=this.c;this.c=function(r){return e((function(){return t(r)}))}},window.CustomElementRegistry=K,K.prototype.define=K.prototype.define,K.prototype.upgrade=K.prototype.upgrade,K.prototype.get=K.prototype.get,K.prototype.whenDefined=K.prototype.whenDefined,K.prototype.polyfillDefineLazy=K.prototype.o,K.prototype.polyfillWrapFlushCallback=K.prototype.polyfillWrapFlushCallback,Z.prototype.connectedCallback=function(e){var t=e.__CE_definition;if(t.connectedCallback)try{t.connectedCallback.call(e)}catch(r){oe(r)}},Z.prototype.disconnectedCallback=function(e){var t=e.__CE_definition;if(t.disconnectedCallback)try{t.disconnectedCallback.call(e)}catch(r){oe(r)}},Z.prototype.attributeChangedCallback=function(e,t,r,n,i){var o=e.__CE_definition;if(o.attributeChangedCallback&&o.observedAttributes.indexOf(t)>-1)try{o.attributeChangedCallback.call(e,t,r,n,i)}catch(a){oe(a)}};var ae=new function(){};function se(e,t,r){function n(t){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];i=[];for(var o=[],a=0;a<n.length;a++){var s=n[a];if(s instanceof Element&&N(s)&&o.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(t.apply(this,n),n=0;n<o.length;n++)te(e,o[n]);if(N(this))for(n=0;n<i.length;n++)(o=i[n])instanceof Element&&ee(e,o)}}void 0!==r.prepend&&j(t,"prepend",n(r.prepend)),void 0!==r.append&&j(t,"append",n(r.append))}function ue(e){function r(t,r){Object.defineProperty(t,"innerHTML",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(t){var n=this,i=void 0;if(N(this)&&(i=[],q(e,this,(function(e){e!==n&&i.push(e)}))),r.set.call(this,t),i)for(var o=0;o<i.length;o++){var a=i[o];1===a.__CE_state&&e.disconnectedCallback(a)}return this.ownerDocument.__CE_registry?re(e,this):Q(e,this),t}})}function n(t,r){j(t,"insertAdjacentElement",(function(t,n){var i=N(n);return t=r.call(this,t,n),i&&te(e,n),N(t)&&ee(e,n),t}))}function i(t,r){function n(t,r){for(var n=[];t!==r;t=t.nextSibling)n.push(t);for(r=0;r<n.length;r++)re(e,n[r])}j(t,"insertAdjacentHTML",(function(e,t){if("beforebegin"===(e=e.toLowerCase())){var i=this.previousSibling;r.call(this,e,t),n(i||this.parentNode.firstChild,this)}else if("afterbegin"===e)i=this.firstChild,r.call(this,e,t),n(this.firstChild,i);else if("beforeend"===e)i=this.lastChild,r.call(this,e,t),n(i||this.firstChild,null);else{if("afterend"!==e)throw new SyntaxError("The value provided ("+String(e)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");i=this.nextSibling,r.call(this,e,t),n(this.nextSibling,i)}}))}h&&j(Element.prototype,"attachShadow",(function(t){if(t=h.call(this,t),e.a&&!t.__CE_patched){t.__CE_patched=!0;for(var r=0;r<e.b.length;r++)e.b[r](t)}return this.__CE_shadowRoot=t})),p&&p.get?r(Element.prototype,p):O&&O.get?r(HTMLElement.prototype,O):function(e,t){e.a=!0,e.c.push(t)}(e,(function(e){r(e,{enumerable:!0,configurable:!0,get:function(){return s.call(this,!0).innerHTML},set:function(e){var r="template"===this.localName,n=r?this.content:this,i=t.call(document,this.namespaceURI,this.localName);for(i.innerHTML=e;n.childNodes.length>0;)l.call(n,n.childNodes[0]);for(e=r?i.content:i;e.childNodes.length>0;)u.call(n,e.childNodes[0])}})})),j(Element.prototype,"setAttribute",(function(t,r){if(1!==this.__CE_state)return y.call(this,t,r);var n=g.call(this,t);y.call(this,t,r),r=g.call(this,t),e.attributeChangedCallback(this,t,n,r,null)})),j(Element.prototype,"setAttributeNS",(function(t,r,n){if(1!==this.__CE_state)return _.call(this,t,r,n);var i=m.call(this,t,r);_.call(this,t,r,n),n=m.call(this,t,r),e.attributeChangedCallback(this,r,i,n,t)})),j(Element.prototype,"removeAttribute",(function(t){if(1!==this.__CE_state)return v.call(this,t);var r=g.call(this,t);v.call(this,t),null!==r&&e.attributeChangedCallback(this,t,r,null,null)})),j(Element.prototype,"removeAttributeNS",(function(t,r){if(1!==this.__CE_state)return b.call(this,t,r);var n=m.call(this,t,r);b.call(this,t,r);var i=m.call(this,t,r);n!==i&&e.attributeChangedCallback(this,r,n,i,t)})),P?n(HTMLElement.prototype,P):A&&n(Element.prototype,A),R?i(HTMLElement.prototype,R):E&&i(Element.prototype,E),se(e,Element.prototype,{prepend:S,append:T}),function(e){function t(t){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];i=[];for(var o=[],a=0;a<n.length;a++){var s=n[a];if(s instanceof Element&&N(s)&&o.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(t.apply(this,n),n=0;n<o.length;n++)te(e,o[n]);if(N(this))for(n=0;n<i.length;n++)(o=i[n])instanceof Element&&ee(e,o)}}var r=Element.prototype;void 0!==$&&j(r,"before",t($)),void 0!==w&&j(r,"after",t(w)),void 0!==C&&j(r,"replaceWith",(function(t){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];n=[];for(var i=[],o=0;o<r.length;o++){var a=r[o];if(a instanceof Element&&N(a)&&i.push(a),a instanceof DocumentFragment)for(a=a.firstChild;a;a=a.nextSibling)n.push(a);else n.push(a)}for(o=N(this),C.apply(this,r),r=0;r<i.length;r++)te(e,i[r]);if(o)for(te(e,this),r=0;r<n.length;r++)(i=n[r])instanceof Element&&ee(e,i)})),void 0!==I&&j(r,"remove",(function(){var t=N(this);I.call(this),t&&te(e,this)}))}(e)}var ce=window.customElements;function le(){var t=new Z;!function(t){window.HTMLElement=function(){function r(){var r=this.constructor,n=document.__CE_registry.l.get(r);if(!n)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var i=n.constructionStack;if(0===i.length)return i=e.call(document,n.localName),Object.setPrototypeOf(i,r.prototype),i.__CE_state=1,i.__CE_definition=n,J(t,i),i;var o=i.length-1,a=i[o];if(a===ae)throw Error("Failed to construct '"+n.localName+"': This element was already constructed.");return i[o]=ae,Object.setPrototypeOf(a,r.prototype),J(t,a),a}return r.prototype=k.prototype,Object.defineProperty(r.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:r}),r}()}(t),function(e){j(Document.prototype,"createElement",(function(t){return ie(e,this,t,null)})),j(Document.prototype,"importNode",(function(t,n){return t=r.call(this,t,!!n),this.__CE_registry?re(e,t):Q(e,t),t})),j(Document.prototype,"createElementNS",(function(t,r){return ie(e,this,r,t)})),se(e,Document.prototype,{prepend:n,append:i})}(t),se(t,DocumentFragment.prototype,{prepend:o,append:a}),function(e){function t(t,r){Object.defineProperty(t,"textContent",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)r.set.call(this,t);else{var n=void 0;if(this.firstChild){var i=this.childNodes,o=i.length;if(o>0&&N(this)){n=Array(o);for(var a=0;a<o;a++)n[a]=i[a]}}if(r.set.call(this,t),n)for(t=0;t<n.length;t++)te(e,n[t])}}})}j(Node.prototype,"insertBefore",(function(t,r){if(t instanceof DocumentFragment){var n=M(t);if(t=c.call(this,t,r),N(this))for(r=0;r<n.length;r++)ee(e,n[r]);return t}return n=t instanceof Element&&N(t),r=c.call(this,t,r),n&&te(e,t),N(this)&&ee(e,t),r})),j(Node.prototype,"appendChild",(function(t){if(t instanceof DocumentFragment){var r=M(t);if(t=u.call(this,t),N(this))for(var n=0;n<r.length;n++)ee(e,r[n]);return t}return r=t instanceof Element&&N(t),n=u.call(this,t),r&&te(e,t),N(this)&&ee(e,t),n})),j(Node.prototype,"cloneNode",(function(t){return t=s.call(this,!!t),this.ownerDocument.__CE_registry?re(e,t):Q(e,t),t})),j(Node.prototype,"removeChild",(function(t){var r=t instanceof Element&&N(t),n=l.call(this,t);return r&&te(e,t),n})),j(Node.prototype,"replaceChild",(function(t,r){if(t instanceof DocumentFragment){var n=M(t);if(t=d.call(this,t,r),N(this))for(te(e,r),r=0;r<n.length;r++)ee(e,n[r]);return t}n=t instanceof Element&&N(t);var i=d.call(this,t,r),o=N(this);return o&&te(e,r),n&&te(e,t),o&&ee(e,t),i})),f&&f.get?t(Node.prototype,f):function(e,t){e.a=!0,e.b.push(t)}(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){for(var e=[],t=this.firstChild;t;t=t.nextSibling)t.nodeType!==Node.COMMENT_NODE&&e.push(t.textContent);return e.join("")},set:function(e){for(;this.firstChild;)l.call(this,this.firstChild);null!=e&&""!==e&&u.call(this,document.createTextNode(e))}})}))}(t),ue(t),t=new K(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}ce&&!ce.forcePolyfill&&"function"==typeof ce.define&&"function"==typeof ce.get||le(),window.__CE_installPolyfill=le}).call(self),function(){if(void 0!==window.Reflect&&void 0!==window.customElements&&!window.customElements.polyfillWrapFlushCallback){var e=HTMLElement,t=function(){return Reflect.construct(e,[],this.constructor)};window.HTMLElement=t,HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}}();var DevLogger=function(){function t(){var r=this;_classCallCheck$1(this,t);try{var n=/xgd=(\d)/.exec(document.cookie);this._status=!!n,this._level=n&&n[1]}catch(e){this._status=!1}["group","groupEnd","log","warn","error"].forEach((function(e){r[e]=function(t,n,i,o,a,s,u,c,l,d){var f;if(r._status){var h=t,p=[n,i,o,a,s,u,c,l,d].filter((function(e){return void 0!==e}));(f=console)[e].apply(f,["["+h+"]:"].concat(_toConsumableArray(p)))}}}))}return _createClass$1(t,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return"2"===this._level}}]),t}(),logger=new DevLogger;function debounce(e,t){var r=Date.now(),n=null,i=!0;return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var u=Date.now();i&&(r=Date.now(),i=!1,e.apply(void 0,a)),u-r>t?(r=u,e.apply(void 0,a)):(n&&window.clearTimeout(n),n=setTimeout((function(){e.apply(void 0,a)}),t))}}function getAvcc(e,t){if(e&&t){var r=new Uint8Array(e.byteLength+t.byteLength+11);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var n=6;return r.set(new Uint8Array([e.byteLength>>>8&255,255&e.byteLength]),n),n+=2,r.set(e,n),r[n+=e.byteLength]=1,n++,r.set(new Uint8Array([t.byteLength>>>8&255,255&t.byteLength]),n),n+=2,r.set(t,n),r}}var Events={AUDIO:{AUDIO_READY:"audio_ready",AUDIO_WAITING:"audio_waiting",AUDIO_SYNC_DTS:"audio_sync_dts"},VIDEO:{VIDEO_DECODER_INIT:"video_decode_init",VIDEO_READY:"video_ready",VIDEO_WAITING:"video_waiting",AUTO_RUN:"auto_run",DECODE_LOW_FPS:"decode_low_fps",UPDATE_VIDEO_FILLTYPE:"update_video_filltype",UPDATE_VIDEO_COVER_POSITION:"update_video_cover_position"},TIMELINE:{PLAY_EVENT:"play_event",SET_METADATA:"set_metadata",APPEND_CHUNKS:"append_chunks",START_RENDER:"start_render",DO_PLAY:"do_play",DO_PAUSE:"do_pause",DO_SEEK:"do_seek",SYNC_DTS:"sync_dts",RESET_BASE_DTS:"reset_base_dts",UPDATE_VOLUME:"update_volume",SINGLE_TRACK:"single_track",DESTROY:"destroy",READY:"ready",UPDATE_GL_OPTIONS:"update_gl_options",SET_VIDEO_DURATION:"set_video_duration",SET_PLAY_MODE:"set_play_mode",UPDATE_CAPABILITY_LEVEL:"update_capability_level",INNER_DEGRADE:"inner_degrade",ADJUST_SEEK_TIME:"adjust_seek_time",CHASE_FRAME:"chase_frame",END_OF_STREAM:"end_of_stream",UPDATE_SEGMENT_END:"update_segment_end"},VIDEO_EVENTS:{WAITING:"waiting",CANPLAY:"canplay",PLAY:"play",PLAYING:"playing",PAUSE:"pause",SEEKING:"seeking",SEEKED:"seeked",LOADEDDATA:"loadeddata",TIMEUPDATE:"timeupdate",DURATION_CHANGE:"durationchange",VOLUME_CHANGE:"volumechange",PROGRESS:"progress",ERROR:"error",ENDED:"ended",RESIZE:"resize",DECODE_FPS:"decodefps",LOW_DECODE:"lowdecode",LARGE_AV_GAP:"largeavgap",FIRST_FRAME:"firstframe"},DECODE_EVENTS:{INIT:"init",READY:"decoderready",REMUX:"remux",INIT_FAILED:"initfailed",DATAREADY:"dataReady",PLAY_FAILED:"playfailed",FRAGMENT_END:"fragmentEnd",APPEND_VIDEO:"appendVideo",FIRST_FRAME:"firstFrame",DECODED:"decoded",RENDE_END:"rendeEnd",CHASE_VIDEO_FRAME:"chaseVideoFrame",CHASE_VIDEO_FRAME_END:"chaseVideoFrameEnd",CHASE_AUDIO_FRAME:"chaseAudioFrame",INIT_SEGMENT:"initSegment",MEDIA_SEGMENT:"mediaSegment",FRAME_MAX_COUNY:"frameMaxCount",FRAME_MIN_COUNY:"frameMinCount"}};function _createSuper$b(e){var t=_isNativeReflectConstruct$b();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var BaseRender=function(e){_inherits(r,e);var t=_createSuper$b(r);function r(e,n){var i;return _classCallCheck$1(this,r),(i=t.call(this))._config=e,i._parent=n,i._meta=null,i._ready=!1,i._isLive=!0,i._innerDegrade=!1,i._singleTrack=-1,i}return _createClass$1(r,[{key:"isLive",get:function(){return this._isLive}},{key:"innerDegrade",get:function(){return this._innerDegrade}},{key:"noAudio",get:function(){return 1===this._singleTrack||2===this._singleTrack}},{key:"noVideo",get:function(){return 3===this._singleTrack}},{key:"_bindEvents",value:function(){var e=this;this._parent.on(Events.TIMELINE.SET_METADATA,this._setMetadata.bind(this)),this._parent.on(Events.TIMELINE.APPEND_CHUNKS,this._appendChunk.bind(this)),this._parent.on(Events.TIMELINE.RESET_BASE_DTS,this._resetDts.bind(this)),this._parent.on(Events.TIMELINE.START_RENDER,this._startRender.bind(this)),this._parent.on(Events.TIMELINE.DO_PLAY,this._doPlay.bind(this)),this._parent.on(Events.TIMELINE.DO_PAUSE,this._doPause.bind(this)),this._parent.on(Events.TIMELINE.DO_SEEK,this._doSeek.bind(this)),this._parent.on(Events.TIMELINE.DESTROY,this._destroy.bind(this)),this._parent.on(Events.TIMELINE.CHASE_FRAME,this._doChaseFrame.bind(this)),this._parent.on(Events.TIMELINE.SINGLE_TRACK,(function(t){e._singleTrack=t})),this._parent.on(Events.TIMELINE.SET_PLAY_MODE,(function(t){e._isLive="LIVE"===t})),this._parent.on(Events.TIMELINE.INNER_DEGRADE,(function(){e._innerDegrade=!0})),this._parent.on(Events.TIMELINE.SET_VIDEO_DURATION,(function(t){e._timeRange.duration=t}))}}]),r}(EventEmitter$1),TOLERANCE$1=.5,AudioTimeRange=function(){function e(t){_classCallCheck$1(this,e),this.TAG="AudioTimeRange",this._parent=t,this._buffers=[],this._duration=0,this._baseDts=0,this._lastBuffer=null}return _createClass$1(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",get:function(){var e=this;if(this.isLive)return{length:this._duration?1:0,start:function(){return 0},end:function(){return e._duration}};var t=this._mergeBufferRanges();return{length:t.length,start:function(e){var r=t[e];return r?r.start:0},end:function(e){var r=t[e];return r?r.end:1/0}}}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"dump",value:function(){for(var e=this.buffered,t=e.length,r="",n=0;n<t;n++)r+="".concat(e.start(n),"~").concat(e.end(n)," ");console.log(r)}},{key:"_transitionSamples",value:function(e){for(var t=e.numberOfChannels,r=e.length,n=512,i=0;i<t;i++){for(var o=e.getChannelData(i),a=0;a<n;a++)o[a]=o[a]*a/n;for(var s=r-n;s<r;s++)o[s]=o[s]*(r-s)/n}}},{key:"append",value:function(e,t,r,n){-1===this._baseDts&&(this._baseDts=r),this._transitionSamples(e);var i=(r-this._baseDts)/1e3,o=i+t,a={start:i,end:o,startDts:r,source:e,duration:t,delay:n};if(logger.log(this.TAG,"add new buffer range, startDts:".concat(r,", [").concat(a.start," , ").concat(a.end,"]")),!this._buffers.filter((function(e){return e.start===i})).length)return this._buffers.push(a),this.isLive&&(this._duration=o),a.start;console.error("音频重复")}},{key:"deletePassed",value:function(e){return this._buffers=this._buffers.filter((function(t){return t.start>=e})),this._buffers[0]}},{key:"canSeek",value:function(e){var t=this._buffers[this._buffers.length-1];return!!t&&!(t.start<e)}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.slice().sort((function(e,t){return e.start>t.start?1:-1})),t=e.length,r=[];if(!t)return r;for(var n={start:e[0].start,end:e[0].end},i=1;i<t;i++){var o=e[i];Math.abs(n.end-o.start)<TOLERANCE$1?n.end=o.end:(r.push(n),n={start:o.start,end:o.end})}return r.push(n),r}},{key:"getBuffer",value:function(e){if(this.isLive)return this._buffers.shift();var t=this._buffers.filter((function(t){return t.start<e+TOLERANCE$1&&t.end>e+TOLERANCE$1}))[0];return logger.log(this.TAG,"get audio buffer , currentTime:".concat(e," ,buffer:[").concat(t&&t.start," , ").concat(t&&t.end,"]")),0!==e||t?t:this._buffers[0]}},{key:"hasBuffer",value:function(){var e;return!(null===(e=this._buffers)||void 0===e||!e.length)}}]),e}(),Alaw2lpcm=[-5504,-5248,-6016,-5760,-4480,-4224,-4992,-4736,-7552,-7296,-8064,-7808,-6528,-6272,-7040,-6784,-2752,-2624,-3008,-2880,-2240,-2112,-2496,-2368,-3776,-3648,-4032,-3904,-3264,-3136,-3520,-3392,-22016,-20992,-24064,-23040,-17920,-16896,-19968,-18944,-30208,-29184,-32256,-31232,-26112,-25088,-28160,-27136,-11008,-10496,-12032,-11520,-8960,-8448,-9984,-9472,-15104,-14592,-16128,-15616,-13056,-12544,-14080,-13568,-344,-328,-376,-360,-280,-264,-312,-296,-472,-456,-504,-488,-408,-392,-440,-424,-88,-72,-120,-104,-24,-8,-56,-40,-216,-200,-248,-232,-152,-136,-184,-168,-1376,-1312,-1504,-1440,-1120,-1056,-1248,-1184,-1888,-1824,-2016,-1952,-1632,-1568,-1760,-1696,-688,-656,-752,-720,-560,-528,-624,-592,-944,-912,-1008,-976,-816,-784,-880,-848,5504,5248,6016,5760,4480,4224,4992,4736,7552,7296,8064,7808,6528,6272,7040,6784,2752,2624,3008,2880,2240,2112,2496,2368,3776,3648,4032,3904,3264,3136,3520,3392,22016,20992,24064,23040,17920,16896,19968,18944,30208,29184,32256,31232,26112,25088,28160,27136,11008,10496,12032,11520,8960,8448,9984,9472,15104,14592,16128,15616,13056,12544,14080,13568,344,328,376,360,280,264,312,296,472,456,504,488,408,392,440,424,88,72,120,104,24,8,56,40,216,200,248,232,152,136,184,168,1376,1312,1504,1440,1120,1056,1248,1184,1888,1824,2016,1952,1632,1568,1760,1696,688,656,752,720,560,528,624,592,944,912,1008,976,816,784,880,848],Ulaw2lpcm=[-32124,-31100,-30076,-29052,-28028,-27004,-25980,-24956,-23932,-22908,-21884,-20860,-19836,-18812,-17788,-16764,-15996,-15484,-14972,-14460,-13948,-13436,-12924,-12412,-11900,-11388,-10876,-10364,-9852,-9340,-8828,-8316,-7932,-7676,-7420,-7164,-6908,-6652,-6396,-6140,-5884,-5628,-5372,-5116,-4860,-4604,-4348,-4092,-3900,-3772,-3644,-3516,-3388,-3260,-3132,-3004,-2876,-2748,-2620,-2492,-2364,-2236,-2108,-1980,-1884,-1820,-1756,-1692,-1628,-1564,-1500,-1436,-1372,-1308,-1244,-1180,-1116,-1052,-988,-924,-876,-844,-812,-780,-748,-716,-684,-652,-620,-588,-556,-524,-492,-460,-428,-396,-372,-356,-340,-324,-308,-292,-276,-260,-244,-228,-212,-196,-180,-164,-148,-132,-120,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,32124,31100,30076,29052,28028,27004,25980,24956,23932,22908,21884,20860,19836,18812,17788,16764,15996,15484,14972,14460,13948,13436,12924,12412,11900,11388,10876,10364,9852,9340,8828,8316,7932,7676,7420,7164,6908,6652,6396,6140,5884,5628,5372,5116,4860,4604,4348,4092,3900,3772,3644,3516,3388,3260,3132,3004,2876,2748,2620,2492,2364,2236,2108,1980,1884,1820,1756,1692,1628,1564,1500,1436,1372,1308,1244,1180,1116,1052,988,924,876,844,812,780,748,716,684,652,620,588,556,524,492,460,428,396,372,356,340,324,308,292,276,260,244,228,212,196,180,164,148,132,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,0],silenceFrame=new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);function _doubleCheckSampleRateIndex(e,t){var r=(7&e[0])<<1|e[1]>>>7;return r!==t?r:t}function _constructAdtsHeader(e,t){var r=e.sampleRateIndex,n=e.channelCount;r=_doubleCheckSampleRateIndex(e.config,r);var i=new Uint8Array(7);i[0]=255,i[1]=240,i[1]=1|i[1],i[2]=64,i[2]=i[2]|60&r<<2,i[2]=i[2]|1&n>>2,i[3]=192&n<<6;var o=t.byteLength+7;return i[3]=i[3]|3&o>>11,i[4]=255&o>>3,i[5]=224&o<<5,i[5]=31|i[5],i[6]=252,i}function packageAACToAdts(e,t){var r=new Uint8Array(t.data.byteLength+7),n=_constructAdtsHeader(e,t.data);return r.set(n),r.set(t.data,7),r}function concatAdts(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,n=0,i=e.length;n<i;n++)t&&n%t==0||(r+=e[n].byteLength);for(var o=new Uint8Array(r),a=0,s=0,u=e.length;s<u;s++)t&&s%t==0||(o.set(e[s],a),a+=e[s].byteLength);return o}function _decodeAlaw(e){for(var t=new Uint8Array(2*e.length),r=0,n=0;r<e.length;){var i=Alaw2lpcm[e[r]];if(void 0===i)throw new Error("can not decode g711 alaw data!");t[n]=255&i,t[n+1]=i>>8,r+=1,n+=2}return t}function _decodeUlaw(e){for(var t=new Uint8Array(2*e.length),r=0,n=0;r<e.length;){var i=Ulaw2lpcm[e[r]];if(void 0===i)throw new Error("can not decode g711 ulaw data!");t[n]=255&i,t[n+1]=i>>8,r+=1,n+=2}return t}function decodeG711(e,t){if("g7110a"===t)return _decodeAlaw(e);if("g7110m"===t)return _decodeUlaw(e);throw new Error("no supported format=".concat(t," for g711"))}function _getSampleCount(e,t,r){return e/t/r}function _uint16ToFloat32(e){return e>=32768?-(65536-e)/32768:e/32767}function createAudioBufferFromPcm(e,t,r,n,i){for(var o=_getSampleCount(t.byteLength,r,i),a=e.createBuffer(r,o,n),s=new DataView(t),u=0;u<r;u++)for(var c=a.getChannelData(u),l=void 0,d=0;d<o;d++)l=s.getUint16(d*(2*r)+2*u,!0),c[d]=_uint16ToFloat32(l);return{audioBuffer:a,duration:o/n}}function checkRefillFrame(e){e.length;var t=e[0].dts,r=e.filter((function(e){return e.dts===t})).length;if(!(r<=1))for(var n=0;n<r;n++)e[n].data=silenceFrame}var AudioHelper={decodeG711:decodeG711,createAudioBufferFromPcm:createAudioBufferFromPcm,packageAACToAdts:packageAACToAdts,concatAdts:concatAdts,checkRefillFrame:checkRefillFrame};function _createSuper$a(e){var t=_isNativeReflectConstruct$a();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var AudioContext=window.AudioContext||window.webkitAudioContext,MEDIA_ERR_DECODE$1=3,ERROR_MSG={INIT_AUDIO_ERR:"create new AudioContext error",DECODE_ERR:"audio data decode error"},AudioRender=function(t){_inherits(o,t);var r,n,i=_createSuper$a(o);function o(e,t){var r;return _classCallCheck$1(this,o),_defineProperty$1(_assertThisInitialized(r=i.call(this,e,t)),"emitTimelineEvents",r._emitTimelineEvents),r.TAG="AudioRender",r._timeRange=new AudioTimeRange(_assertThisInitialized(r)),r._lastTimeLineTime=0,r._sampleQueue=[],r._source=null,r._audioCanAutoplay=!0,r._lastBuffer=null,r._inDecoding=!1,r._endOfStream=!1,r._delay=0,r._isSourceBufferEnd=-1,r._onSourceBufferEnded=r._onSourceBufferEnded.bind(_assertThisInitialized(r)),r._initAudioCtx(e.volume||.6),r._bindEvents(),r}return _createClass$1(o,[{key:"baseDts",get:function(){return this._timeRange._baseDts}},{key:"currentTime",get:function(){return this._audioCtx?this._lastTimeLineTime+this._audioCtx.currentTime:0}},{key:"duration",get:function(){return this._timeRange.duration}},{key:"preloadTime",get:function(){return this.isLive?1:0}},{key:"timescale",get:function(){return 1e3}},{key:"buffered",get:function(){return this._timeRange.buffered}},{key:"ctxState",get:function(){return this._audioCtx.state}},{key:"audioCanAutoplay",get:function(){return this._audioCanAutoplay}},{key:"resume",value:function(){if(this._audioCtx&&"suspended"===this._audioCtx.state)return this._audioCtx.resume().catch((function(e){}))}},{key:"dump",value:function(){return this._timeRange.dump()}},{key:"canSeek",value:function(e){return this._timeRange.canSeek(e)}},{key:"_assembleErr",value:function(e){var t=new Error(e);return t.code=MEDIA_ERR_DECODE$1,t}},{key:"_emitTimelineEvents",value:function(e,t,r){var n,i;null===(n=this._parent)||void 0===n||null===(i=n.emit)||void 0===i||i.call(n,e,t,r)}},{key:"_initAudioCtx",value:function(e){var t=this;return logger.log(this.TAG,"init audioCtx"),this._audioCtx=new AudioContext,this._audioCtx?(this._gainNode=this._audioCtx.createGain(),this._gainNode.gain.value=e,this._gainNode.connect(this._audioCtx.destination),this._audioCanAutoplay="running"===this._audioCtx.state,logger.log(this.TAG,"webAudio state:",this._audioCtx.state),initBgSilenceAudio(),this._bindAudioCtxEvent(),this._audioCtx.suspend()):(logger.warn(this.TAG,"create webaudio error!"),void setTimeout((function(){t._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",t._assembleErr(ERROR_MSG.INIT_AUDIO_ERR))})))}},{key:"_bindAudioCtxEvent",value:function(){var e=this;this._onStateChange=function(){e._audioCtx&&"running"===e._audioCtx.state&&e._ready&&e._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PLAYING)},this._audioCtx.addEventListener("statechange",this._onStateChange)}},{key:"_bindEvents",value:function(){var e=this;_get(_getPrototypeOf(o.prototype),"_bindEvents",this).call(this),this._parent.on(Events.DECODE_EVENTS.CHASE_AUDIO_FRAME,this._doChaseFrame.bind(this)),this._parent.on(Events.TIMELINE.UPDATE_VOLUME,(function(t){e._gainNode&&(e._gainNode.gain.value=isFinite(t)?t:1,e._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.VOLUME_CHANGE))})),this._parent.on(Events.TIMELINE.END_OF_STREAM,(function(){var t;e._endOfStream=!0,e.noAudio||null!==(t=e._timeRange)&&void 0!==t&&t.hasBuffer()||null==e||e._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.ENDED)}))}},{key:"_setMetadata",value:function(e,t){"video"!==e&&(this.noAudio||(logger.warn(this.TAG,"audio set metadata",t),this._meta=t))}},{key:"_appendChunk",value:function(e,t){if(!this.noAudio){this._meta||(this._meta=t,logger.warn(this.TAG,"audio set metadata",this._meta));var r=t.samples;if(r.length)if(this._sampleQueue=this._sampleQueue.concat(r),t.samples=[],"aac"===this._meta.codecType){if(this._inDecoding)return;this._decodeAACWrapper()}else this._decodeG711()}}},{key:"_resetDts",value:function(e,t){"video"!==t&&this._timeRange.resetDts(e)}},{key:"_doPlay",value:function(){this.noAudio||this._parent.seeking||(this._source||!this.currentTime?this.resume():this._startRender())}},{key:"_doPause",value:function(){this.noAudio||this._audioCtx.suspend()}},{key:"_reInitAudioCtx",value:function(e){var t=this;if(this._lastTimeLineTime=e,this._lastBuffer=null,this._lastAudioBufferInfo=null,this._delay=0,!this._ready||!this._audioCtx.currentTime)return Promise.resolve();var r=this._gainNode.gain.value;return this._audioCtx.close().then((function(){return t._audioCtx.removeEventListener("statechange",t._onStateChange),t._audioCtx=null,t._source&&t._source.removeEventListener("ended",t._onSourceBufferEnded),t._source=null,t._initAudioCtx(r)}))}},{key:"_doSeek",value:function(e){var t=this;this._reInitAudioCtx(e).then((function(){t._getAudioBuffer(!0)})).catch((function(e){}))}},{key:"_doChaseFrame",value:function(e){var t=this,r=e.position,n=this._timeRange.deletePassed(r);n&&(logger.log(this.TAG,"_doChaseFrame","startTime:",n.start,"buffeLength:",this.buffered.end(0)-n.start),this._reInitAudioCtx(n.start).then((function(){t._startRender(),t._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE)})).catch((function(e){})))}},{key:"_decodeAACWrapper",value:(n=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,i,o,a,s,u,c,l;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._sampleQueue.length,r=this._sampleQueue[0],n=this._sampleQueue[t-1],!((i=(n.dts-r.dts)/this.timescale)<1)){e.next=6;break}return e.abrupt("return");case 6:for(o=parseInt(i/3-1)||1,a=parseInt(t/o),s=[],u=0;u<o;u++)u<o-1?s.push(this._sampleQueue.slice(u*a,(u+1)*a)):s.push(this._sampleQueue.slice(u*a));return this._sampleQueue=[],this._inDecoding=!0,e.prev=12,e.next=15,this._decodeCycle(s);case 15:this._isLive||(c=this._timeRange._buffers,(l=c[c.length-1])&&this.emitTimelineEvents(Events.TIMELINE.UPDATE_SEGMENT_END,l.end)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e.t0&&e.t0.message)));case 21:this._inDecoding=!1;case 22:case"end":return e.stop()}}),e,this,[[12,18]])}))),function(){return n.apply(this,arguments)})},{key:"_decodeCycle",value:(r=_asyncToGenerator(regenerator.mark((function e(t){var r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.shift()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this._decodeAAC(r);case 5:return e.next=7,this._decodeCycle(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_decodeAAC",value:function(e){var t=this,r=e[0],n=0;AudioHelper.checkRefillFrame(e);var i=e.map((function(e){return AudioHelper.packageAACToAdts(t._meta,e)})),o=AudioHelper.concatAdts(i,0);return new Promise((function(e,i){var a=t._audioCtx.decodeAudioData(o.buffer,(function(i){if(t._timeRange){if(t._lastAudioBufferInfo&&t.isLive){var o=t._lastAudioBufferInfo,a=o.dts+o.duration;(n=r.dts-a)>1&&(t._timeRange._duration+=n/1e3,logger.log(t.TAG,"_decodeAAC","audio data dts is not continue, last end dts:",a,",now start Dts:",r.dts,"delay:",n))}t._lastAudioBufferInfo={duration:Math.floor(1e3*i.duration),dts:r.dts};var s=t._timeRange.append(i,i.duration,r.dts,n/1e3);if(!t._ready){var u=Math.abs(s+i.duration-t.currentTime)<.5;(t.isLive||!u)&&(t._ready=!0,logger.log(t.TAG,"_decodeAAC","set ready true start=",s),t.emit(Events.AUDIO.AUDIO_READY,s))}t._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PROGRESS),t._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.DURATION_CHANGE),e()}}),i);a.catch&&a.catch(i)}))}},{key:"_decodeG711",value:function(){var t=this._sampleQueue.length,r=this._sampleQueue[0];if(!((this._sampleQueue[t-1].dts-r.dts)/this.timescale<.5)){var n=this._sampleQueue.reduce((function(e,t){return e+=t.data.byteLength}),0),i=new Uint8Array(n),o=0,a=0;this._sampleQueue.forEach((function(e,t){0===t&&(o=e.dts),i.set(e.data,a),a+=e.data.byteLength})),this._sampleQueue=[];try{var s=this._meta,u=s.codecType,c=s.channelCount,l=s.sampleSize,d=s.sampleRate,f=AudioHelper.decodeG711(i,u),h=AudioHelper.createAudioBufferFromPcm(this._audioCtx,f.buffer,c,d,l/8),p=h.audioBuffer,g=h.duration,y=this._timeRange.append(p,g,o,0);this._ready||(this._ready=!0,logger.log(this.TAG,"_decodeG711","set ready true"),this.emit(Events.AUDIO.AUDIO_READY,y)),this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PROGRESS),this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.DURATION_CHANGE)}catch(e){this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e&&e.message)))}}}},{key:"_onSourceBufferEnded",value:function(){this._isSourceBufferEnd=!0,logger.long&&logger.log(this.TAG,"source play end! currentTime:".concat(this.currentTime," , duration:").concat(this.duration)),this._checkBufferLength(),this._startRender()}},{key:"_ajustSeekTime",value:function(e){var t=this._timeRange.getBuffer(e,0);t&&(logger.log(this.TAG,"ajust seek time to:",t.start),this._lastTimeLineTime=t.start,this._parent.emit(Events.TIMELINE.ADJUST_SEEK_TIME,t.start))}},{key:"_getAudioBuffer",value:function(e){var t=this;if(this._timeRange){var r=this._timeRange.getBuffer(this._lastBuffer?this._lastBuffer.end:this.currentTime,0);return r?e?(this._ajustSeekTime(r.start),void this.emit(Events.AUDIO.AUDIO_READY)):r:(this._endOfStream||!this._isLive)&&this.currentTime-this.duration>-.5?(this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE),void this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.ENDED)):(this._ready=!1,this._audioCtx.suspend(),this.emit(Events.AUDIO.AUDIO_WAITING),void(e&&(this._onAudioReady||(this._onAudioReady=function(e){t._ajustSeekTime(e)}),this.removeListener(Events.AUDIO.AUDIO_READY,this._onAudioReady),this.once(Events.AUDIO.AUDIO_READY,this._onAudioReady))))}}},{key:"_startRender",value:function(t){if(!this.noAudio){if("video"===t&&this.isLive&&this._ready&&!this._isSourceBufferEnd)return console.log(this.TAG,"_startRender, audio currentTime",this.currentTime,"from:",t,"_isSourceBufferEnd:",this._isSourceBufferEnd,"ready:",this._ready),void this._doPlay();var r=this._getAudioBuffer();if(r){"suspended"===this._audioCtx.state&&(this._audioCtx.resume().catch((function(e){})),playSlienceAudio()),this._lastBuffer=r,this._source=null;var n=this._audioCtx.createBufferSource();n.buffer=r.source,n.loop=!1,this._source=n,n.addEventListener("ended",this._onSourceBufferEnded),n.connect(this._gainNode),r.delay&&r.delay>.001&&(this._delay+=r.delay),this.startDts=r.startDts;try{this._isSourceBufferEnd=!1,n.start(),this._ts=performance.now()}catch(e){}r.startDts&&this._emitTimelineEvents(Events.TIMELINE.SYNC_DTS,r.startDts)}}}},{key:"_checkBufferLength",value:function(){var e=this.currentTime,t=this.buffered.end(0)-e;t>6&&(this._dropSampleGap=50),t<5&&(this._dropSampleGap=0)}},{key:"_destroy",value:function(){logger.log(this.TAG,"destroy audio..."),this._source&&this._source.removeEventListener("ended",this._onSourceBufferEnded),this._audioCtx&&"closed"!==this.ctxState&&this._audioCtx.close(),this._audioCtx=null,this._sampleQueue=null,this._timeRange=null,this._parent=null,this.removeAllListeners()}}]),o}(BaseRender),TOLERANCE=1,VideoTimeRange=function(){function e(t){_classCallCheck$1(this,e),this.TAG="VideoTimeRange",this._parent=t,this._baseDts=0,this._lastDuration=0,this._duration=0,this._bitrate=0,this._totalSize=0,this._buffers=[],this._currentFrameQueue=[],this._frameIndexInQueue=0,this._delayEstimateList=[],this._keyframeQueue=[]}return _createClass$1(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"baseDts",get:function(){return this._baseDts}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",get:function(){var e=this;if(this.isLive)return{length:this._duration?1:0,start:function(){return 0},end:function(){return e._duration}};var t=this._mergeBufferRanges();return{length:t.length,start:function(e){var r=t[e];return r?r.start:0},end:function(e){var r=t[e];return r?r.end:1/0}}}},{key:"frameLength",get:function(){return this._currentFrameQueue.length}},{key:"keyFrameLength",get:function(){return this._keyframeQueue.length}},{key:"totalSize",get:function(){return this._totalSize}},{key:"bitrate",get:function(){return this._bitrate},set:function(e){this._bitrate=e}},{key:"lastDuration",get:function(){return this._lastDuration}},{key:"frames",get:function(){return this._currentFrameQueue}},{key:"getCurrentTime",value:function(e){return this._lastDuration+(e-this._baseDts)/1e3}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.sort((function(e,t){return e.start>t.start?1:-1})),t=e.length,r=[];if(!t)return r;for(var n={start:e[0].start,end:e[0].end},i=1;i<t;i++){var o=e[i];Math.abs(n.end-o.start)<TOLERANCE?n.end=o.end:(r.push(n),n={start:o.start,end:o.end})}return r.push(n),r}},{key:"_caclBaseDts",value:function(e){-1===this._baseDts&&e&&(this._baseDts=e.dts,logger.log(this.TAG,"set baseDts: ",this._baseDts,"frame len:",this._currentFrameQueue.length))}},{key:"_updateDuration",value:function(e){for(var t=e.length,r=e[t-1],n=0;n<t;n++){var i=e[n];if(i&&i.options&&i.options.meta){var o=e[n-1]||this._currentFrameQueue[this._currentFrameQueue.length-1];o?this._lastDuration+=(o.dts-this._baseDts)/1e3:this._lastDuration=this._duration,logger.log(this.TAG,"updateBaseDts,record lastDuration:",this._lastDuration),this._baseDts=i.dts;break}}r&&(this._duration=(r.dts-this._baseDts)/1e3+this._lastDuration)}},{key:"_estimateBitRate",value:function(e){var t=e.length;if(t<=2){if(this._delayEstimateList=this._delayEstimateList.concat(e),(t=this._delayEstimateList.length)<=30)return;e=this._delayEstimateList,this._delayEstimateList=[]}for(var r=0,n=0;n<t;n++){var i=e[n];r+=i.data?i.data.length:i.units.reduce((function(e,t){return e+t.byteLength}),0)}this._totalSize+=r;var o=r/(e[t-1].dts-e[0].dts);this._bitrate=parseInt(8e3*o)}},{key:"_appendVodBufferWrapper",value:function(e){var t=this;if(e.length){for(var r=[],n=[],i=0,o=e.length;i<o;i++)e[i].keyframe&&n.length>=10&&(r.push(n),n=[]),n.push(e[i]);n.length&&r.push(n),r.forEach((function(e){return t._appendVodBuffer(e)}))}}},{key:"_appendVodBuffer",value:function(e){var t=this;if(e.length){e.forEach((function(e){e.baseDts=t._baseDts}));var r=e[0],n=e[e.length-1],i=(r.dts-this._baseDts)/1e3,o=(n.dts-this._baseDts)/1e3;logger.log(this.TAG,"add new buffer range [".concat(i," , ").concat(o,"]")),this._buffers.filter((function(e){return e.start===i})).length||this._buffers.push({start:i,end:o,duartion:o-i,frames:e.slice()}),this._buffers.sort((function(e,t){return e.start>t.start?1:-1}))}}},{key:"_recordKeyframes",value:function(e){var t=this;e.forEach((function(e){if(e.keyframe){var r=(e.dts-t._baseDts)/1e3;t._keyframeQueue.push({position:r,frame:e})}})),this.isLive&&this._keyframeQueue.length>40&&this._keyframeQueue.splice(0,20)}},{key:"toAnnexBNalu",value:function(e){e.forEach((function(e){var t=e.units;if(t){var r=t.reduce((function(e,t){return e+4+t.byteLength}),0),n=new Uint8Array(r),i=0;t.forEach((function(e){n.set([0,0,0,1],i),i+=4,n.set(e,i),i+=e.byteLength})),e.units=null,e.data=n}}))}},{key:"append",value:function(e,t,r){r&&this.toAnnexBNalu(e),this._caclBaseDts(e[0]),t&&this._updateDuration(e),this._estimateBitRate(e),this._recordKeyframes(e),this.isLive?this._currentFrameQueue=this._currentFrameQueue.concat(e):this._appendVodBufferWrapper(e)}},{key:"updateSegmentEnd",value:function(e){var t=this._buffers[this._buffers.length-1];t&&(Math.abs(t.end-e)<.5||(t.end=e,t.duartion=e-t.start,logger.log(this.TAG,"video data lack, reset end:",e)))}},{key:"getFrame",value:function(){var e;if(this.isLive)return this._currentFrameQueue.shift();if(!(e=this._currentFrameQueue[this._frameIndexInQueue])){if(!(e=this._currentFrameQueue[--this._frameIndexInQueue]))return;return this.switchBuffer((e.dts-e.baseDts)/1e3),this.getFrame()}return this._frameIndexInQueue++,e}},{key:"switchBuffer",value:function(e){var t=this._buffers.filter((function(t){return t.start<e+TOLERANCE&&t.end>e+TOLERANCE}))[0];t?(logger.log(this.TAG,"switch video buffer, time:".concat(e," , buffer:[").concat(t.start," , ").concat(t.end,"]")),this._currentFrameQueue=t.frames.slice()):this._currentFrameQueue=[],this._frameIndexInQueue=0}},{key:"getChaseFrameStartPosition",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(this._keyframeQueue.forEach((function(r){r.position<e&&(t=r)})),t)return e-t.position<r?t:void 0}},{key:"nextFrame",value:function(){return this._currentFrameQueue[0]}},{key:"deletePassed",value:function(e){this._currentFrameQueue=this._currentFrameQueue.filter((function(t){return t.dts>=e}))}},{key:"getDtsOfTime",value:function(e){var t=e-this._lastDuration;return this._baseDts+1e3*t}},{key:"clean",value:function(){this._currentFrameQueue=[]}}]),e}();function _checkClose(e){var t;(null===(t=e.buffer)||void 0===t?void 0:t.close)&&e.buffer.close()}var FrameQueue=function(){function e(t){_classCallCheck$1(this,e),this.TAG="FrameQueue",this._parent=t,this._lastGopId=0,this._frames=[]}return _createClass$1(e,[{key:"currentTimeDts",get:function(){return this._parent.preciseVideoDts}},{key:"length",get:function(){return this._frames.length}},{key:"frames",get:function(){return this._frames}},{key:"append",value:function(e){if(e.info){var t=e.info,r=t.dts,n=t.keyframe,i=t.gopId;i&&i<this._lastGopId&&r<this.currentTimeDts?_checkClose(e):(n&&(this._lastGopId=i),this._frames.push(e),this._frames.sort((function(e,t){return e.info.dts>t.info.dts?1:-1})))}else _checkClose(e)}},{key:"appendVodFrame",value:function(e){this._frames.push(e)}},{key:"nextFrame",value:function(){var e=this._frames.length;return 1===this._parent.noAudio&&e>3&&(this._frames=this._frames.slice(e-2)),this._frames[0]}},{key:"shift",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.nextFrame();if(!(r&&r.gopId&&this._lastGopId&&r.gopId<this._lastGopId))return r=this._frames.shift(),this.deletePassed(t),r;this._frames=this._frames.filter((function(t){return t.gopId>=e._lastGopId||_checkClose(t),!0}))}},{key:"deletePassed",value:function(e){this._frames=this._frames.filter((function(t){return!!(t.info&&t.info.dts>e)||(_checkClose(t),!1)}))}},{key:"empty",value:function(){this._frames.forEach((function(e){return _checkClose(e)})),this._frames=[]}},{key:"destroy",value:function(){this.empty(),this._lastGopId=0}}]),e}(),MAX_QUEUE_LENGTH=5,MAX_LOW_FPS_RECORD=30,DecodeEstimate=function(){function e(t){_classCallCheck$1(this,e),this.TAG="DecodeEstimate",this._needEstimate=!0,this._parent=t,this._lastDecodeDot=0,this._lastDecodeCost=0,this._lastFrameDts=0,this._dtsDeltas=[],this._decodeCosts=[],this._lowDecodeQueue=[],this._fps=0,this._decodeFps=0,this._gopLength=0,this._webcodec=!1}return _createClass$1(e,[{key:"fps",get:function(){return this._fps}},{key:"decodeFps",get:function(){return this._decodeFps}},{key:"decodeCost",get:function(){return this._lastDecodeCost}},{key:"gopLength",get:function(){return this._gopLength}},{key:"webcodec",set:function(e){this._webcodec=e}},{key:"updateGopCount",value:function(){this._gopLength++}},{key:"needEstimateFps",value:function(){this._needEstimate=!0}},{key:"addDecodeInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{dts:0};this._estimateDecodeFps(e),this._estimateFps(e)}},{key:"resetDecodeDot",value:function(e){this._lastDecodeDot=e||0}},{key:"reset",value:function(){this._decodeCosts=[],this._lowDecodeQueue=[]}},{key:"_estimateFps",value:function(e){if(this._needEstimate)if(this._lastFrameDts){var t=e.dts-this._lastFrameDts;if(this._lastFrameDts=e.dts,!(Math.abs(t)>200)){this._dtsDeltas.push(t);var r=this._dtsDeltas.length;r<MAX_QUEUE_LENGTH||(this._fps=Math.ceil(1e3/this._avg(this._dtsDeltas,r)),logger.log(this.TAG,"estimate fps:",this._fps),this._needEstimate=!1)}}else this._lastFrameDts=e.dts}},{key:"_estimateDecodeFps",value:function(e){if(this._lastDecodeDot){var t=performance.now(),r=t-this._lastDecodeDot;this._lastDecodeDot=t,e.cost=r,this._lastDecodeCost=r,this._decodeCosts.push(r);var n=this._decodeCosts.length;if(!(n<MAX_QUEUE_LENGTH)){var i=this._avg(this._decodeCosts,n);this._decodeFps=Math.floor(1e3/i),this._decodeCosts=[],this._lowDecodeDetect()}}else this._lastDecodeDot=performance.now()}},{key:"_avg",value:function(e,t){var r=e.reduce((function(e,t){return e+=t}),0);return Math.floor(r/t)||1}},{key:"_lowDecodeDetect",value:function(){this._decodeFps?(this._decodeFps<this._fps+(this.webcodec?0:3)?this._lowDecodeQueue.push(this._decodeFps):this._lowDecodeQueue.pop(),this._lowDecodeQueue.length>MAX_LOW_FPS_RECORD&&(this._lowDecodeQueue=[],logger.log(this.TAG,"解码效率过低,应该降级"),this._parent.emit(Events.VIDEO.DECODE_LOW_FPS))):this._parent.emit(Events.VIDEO.DECODE_LOW_FPS)}}]),e}(),shell="\n    var timer;\n\n    function initTimer (interval) {\n      destroy()\n      clearInterval(timer);\n      timer = setInterval(() => {\n          self.postMessage({type: 'NEXT_TICK'});\n      }, interval)\n    }\n\n    function destroy () {\n      clearInterval(timer);\n    }\n\n    self.onmessage = function (e) {\n      var {type,interval} = e.data;\n      switch (type) {\n          case 'START':\n            initTimer(interval);\n            break;\n          case 'DESTROY':\n            destroy();\n            break;\n      }\n    }\n",TickTimer=function(){function e(t){_classCallCheck$1(this,e),this._task=t;var r=new Blob([shell],{type:"application/javascript"});this._worker=new Worker(URL.createObjectURL(r)),this._bindEvent()}return _createClass$1(e,[{key:"_bindEvent",value:function(){var e=this;this._worker.addEventListener("message",(function(){e._task()}))}},{key:"start",value:function(e){(e=parseInt(e))<10&&(e=10),e>60?e=60:e>25&&(e=25),this._worker.postMessage({type:"START",interval:e})}},{key:"stop",value:function(){this._worker.postMessage({type:"DESTROY"})}},{key:"destroy",value:function(){this._worker&&(this._worker.postMessage({type:"DESTROY"}),this._worker.terminate(),this._worker=null)}}]),e}();function _createSuper$9(e){var t=_isNativeReflectConstruct$9();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$9(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var HAVE_NOTHING=0,HAVE_METADATA=1,HAVE_CURRENT_DATA=2,HAVE_FUTURE_DATA=3,HAVE_ENOUGH_DATA=4,MEDIA_ERR_DECODE=3,VideoBaseRender=function(e){_inherits(r,e);var t=_createSuper$9(r);function r(e,n){var i;return _classCallCheck$1(this,r),(i=t.call(this,e,n))._timeRange=new VideoTimeRange(_assertThisInitialized(i)),i._decodeEstimate=new DecodeEstimate(_assertThisInitialized(i)),i._frameQueue=new FrameQueue(_assertThisInitialized(i)),i._canvas=e.canvas||document.createElement("canvas"),i._lastTimeupdate=0,i._renderCost=0,i._canAutoPlay=!0,i._videoDecode=!1,i._frameRender=null,i._configuration=null,i._render=i._render.bind(_assertThisInitialized(i)),i._tickTimer=new TickTimer(i._render),i._initCanvas(),i._bindEvents(),i}return _createClass$1(r,[{key:"canAutoPlay",get:function(){return this._canAutoPlay}},{key:"canvas",get:function(){return this._canvas}},{key:"timescale",get:function(){return 1e3}},{key:"fps",get:function(){return this._decodeEstimate.fps||this._meta&&this._meta.fpsNum/this._meta.fpsDen||24}},{key:"decodeFps",get:function(){return this._decodeEstimate.decodeFps}},{key:"decodeCost",get:function(){return this._decodeEstimate.decodeCost}},{key:"renderCost",get:function(){return this._renderCost}},{key:"totalSize",get:function(){return this._timeRange.totalSize}},{key:"bitrate",get:function(){return this._timeRange.bitrate},set:function(e){this._timeRange.bitrate=e}},{key:"gopLength",get:function(){return this._decodeEstimate.gopLength}},{key:"is540p",get:function(){return this._canvas.height<720}},{key:"duration",get:function(){return this._timeRange.duration}},{key:"buffered",get:function(){return this._timeRange.buffered}},{key:"interval",get:function(){return Math.floor(1e3/this.fps)}},{key:"baseDts",get:function(){return this._timeRange.baseDts}},{key:"currentTime",get:function(){return this._timeRange.getCurrentTime(this.preciseVideoDts)}},{key:"timelinePosition",get:function(){return this._parent.timelinePosition}},{key:"lastTimelinePosition",get:function(){return this._lastTimelinePosition||0},set:function(e){this._lastTimelinePosition=e}},{key:"audioSyncDts",get:function(){return this._audioDts||this.baseDts},set:function(e){this._audioDts=e}},{key:"preciseVideoDts",get:function(){return this.audioSyncDts+Math.floor(1e3*(this.timelinePosition-this.lastTimelinePosition))}},{key:"readyState",get:function(){var e=this._frameQueue.length||(this.currentTime?1:0);return e?e>=8?HAVE_ENOUGH_DATA:e>=4?HAVE_FUTURE_DATA:e>=2?HAVE_CURRENT_DATA:HAVE_METADATA:HAVE_NOTHING}},{key:"isHevc",get:function(){return!("hev1.1.6.L93.B0"!==(this._meta||{}).codec)}},{key:"videoDecode",get:function(){return this._videoDecode}},{key:"decoderMode",get:function(){var e;return null===(e=this._decodeController)||void 0===e?void 0:e.decoderMode}},{key:"configuration",get:function(){var e,t;return this._configuration||(this._configuration=this._meta.configuration||getAvcc(null===(e=this._meta)||void 0===e?void 0:e.sps[0],null===(t=this._meta)||void 0===t?void 0:t.pps[0])),this._configuration},set:function(e){this._configuration=e.configuration||getAvcc(e.sps[0],e.pps[0])}},{key:"getDtsOfTime",value:function(e){return this._timeRange.getDtsOfTime(e)}},{key:"updateReady",value:function(){this._whenReady()}},{key:"forceRender",value:function(){this._render(!0)}},{key:"getChaseFrameStartPosition",value:function(e,t){return this._timeRange.getChaseFrameStartPosition(e,t)}},{key:"canSeek",value:function(){throw new Error("need override by children")}},{key:"emitResizeEvent",value:function(){null==this||this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.RESIZE)}},{key:"_assembleErr",value:function(e){var t=new Error(e);return t.code=MEDIA_ERR_DECODE,t}},{key:"_emitTimelineEvents",value:function(e,t,r){var n;null===(n=this._parent)||void 0===n||n.emit(e,t,r)}},{key:"_initCanvas",value:function(){this._canvas.style.margin="auto",this._canvas.style.position="absolute",this._canvas.style.pointerEvents="none"}},{key:"_bindEvents",value:function(){var e=this;_get(_getPrototypeOf(r.prototype),"_bindEvents",this).call(this);var t=function(t){var r=t.width,n=t.height,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=e._canvas,s=a.width,u=a.height,c=n*s/u,l=r*u/s,d=r-c,f=n-l,h=d*i+"px",p=f*o+"px";e._canvas.style.left=h,e._canvas.style.top=p,logger.warn(e.TAG,"cvsWidth=".concat(s,", cvsHeight=").concat(u,", scaleCvsWidth=").concat(c,", scaleCvsHeight=").concat(l)),logger.warn(e.TAG,"cover position: deltaX=".concat(d,", deltaY=").concat(f,", width=").concat(r,", height=").concat(n,", pX=").concat(h,", pY=").concat(p))};this._parent.on(Events.VIDEO.UPDATE_VIDEO_FILLTYPE,(function(r,n){var i=n.width,o=n.height,a=e._canvas,s=a.width,u=a.height,c=!i||i/o>s/u;if(logger.warn(e.TAG,"UPDATE_VIDEO_FILLTYPE isGapX =",c,"type =",r,s,u,i,o),e._canvas.style.maxWidth="initial",e._canvas.style.maxHeight="initial","cover"===r)return c?(e._canvas.style.left=0,e._canvas.style.top=0,e._canvas.style.height="auto",e._canvas.style.width="100%",void t({width:i,height:o},0,.5)):(e._canvas.style.left=0,e._canvas.style.top=0,e._canvas.style.width="auto",e._canvas.style.height="100%",void t({width:i,height:o},.5,0));if("fill"===r)return e._canvas.style.width="100%",void(e._canvas.style.height="100%");(e._canvas.style.top=0,e._canvas.style.bottom=0,e._canvas.style.left=0,e._canvas.style.right=0,e._canvas.style.maxWidth="100%",e._canvas.style.maxHeight="100%",e._canvas.style.width="initial",e._canvas.style.height="initial",s<i&&u<o)&&(s/i>u/o?e._canvas.style.width="100%":e._canvas.style.height="100%")})),this._parent.on(Events.VIDEO.UPDATE_VIDEO_COVER_POSITION,t),this._parent.on(Events.TIMELINE.SYNC_DTS,(function(t){var r,n=e._frameQueue.nextFrame();if(e.lastTimelinePosition=e.timelinePosition,e.noAudio){var i=e._timeRange.nextFrame();t=t||n&&n.info.dts||i&&i.dts||e.preciseVideoDts}e.audioSyncDts=t;var o=n&&n.info&&n.info.dts;if(o&&o-t>500&&e._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.LARGE_AV_GAP,{aDts:t,vDts:o,frameLength:e._frameQueue.length,currentTime:e._parent.currentTime,duration:e._parent.duration}),logger.log(e.TAG,"audio current buffer play finish, next buffer dts=",t,"currentTime:",e._parent.currentTime,"next video frame dts:",o,"frame length:",e._frameQueue.length),!(e._isLive||null!==(r=e._parent)&&void 0!==r&&r.seeking)){var a=e._timeRange.nextFrame();if(a){var s=(a.dts-a.baseDts)/1e3;e._parent.currentTime-s>1&&(logger.warn(e.TAG,"视频解码太慢,丢帧!"),e.ajustSeekTime(e._parent.currentTime))}}})),this._parent.on(Events.TIMELINE.UPDATE_GL_OPTIONS,(function(t){e._config.glCtxOptions=t})),this._parent.on(Events.TIMELINE.UPDATE_SEGMENT_END,this._updateSegmentEnd.bind(this)),this.on(Events.VIDEO.AUTO_RUN,this._startRender.bind(this))}},{key:"ajustSeekTime",value:function(){throw new Error("need override by children")}},{key:"_resetDts",value:function(e,t){"audio"!==t&&this._timeRange.resetDts(e)}},{key:"_setMetadata",value:function(e,t){if("audio"!==e){logger.warn(this.TAG,"video set metadata"),this._meta=t;var r=t&&t.frameRate&&t.frameRate.fps;r?logger.log(this.TAG,"detect fps:",r):logger.warn(this.TAG,"no detect fps,start estimate"),this._initDecoder()}}},{key:"_initDecoder",value:function(){throw new Error("need override by children")}},{key:"_whenDecoderReady",value:function(){throw new Error("need override by children")}},{key:"_appendChunk",value:function(){throw new Error("need override by children")}},{key:"_startDecode",value:function(){throw new Error("need override by children")}},{key:"_receiveFrame",value:function(e,t){if(this._parent&&this._timeRange){var r=e.info||{};if(this._decodeEstimate.addDecodeInfo(r),!this._isLive){var n=r&&void 0!==r.baseDts&&(r.dts-r.baseDts)/1e3;if(void 0!==n&&this._parent&&Math.abs(n-this._parent.currentTime)>=4)return void _checkClose(e)}this._isLive?this._frameQueue.append(e):this._frameQueue.appendVodFrame(e),t&&t(),this._ready||this.readyState>=HAVE_METADATA&&this._whenReady()}}},{key:"_startRender",value:function(){this._tickTimer.start(this.interval)}},{key:"_render",value:function(){throw new Error("need override by children")}},{key:"_updateSegmentEnd",value:function(){throw new Error("need override by children")}},{key:"_whenReady",value:function(){this._ready=!0,this.emit(Events.VIDEO.VIDEO_READY),(this.readyState===HAVE_METADATA||this.currentTime<10)&&this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.LOADEDDATA),this.noAudio&&this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PLAYING)}},{key:"_doPlay",value:function(){this._tickTimer.start()}},{key:"_doPause",value:function(){this._tickTimer.stop()}},{key:"_doSeek",value:function(){this._tickTimer.stop(),this._ready=!1,this._frameQueue.destroy()}},{key:"_doChaseFrame",value:function(){throw new Error("need override by children")}},{key:"destroy",value:function(){this._tickTimer.destroy(),this._frameQueue.destroy(),this._frameRender&&this._frameRender.destroy(),this._canvas=null,this._timeRange=null,this._decodeEstimate=null,this._parent=null,this.removeAllListeners()}}]),r}(BaseRender),YUVCanvas=function(){function t(e,r){_classCallCheck$1(this,t),this.TAG="YUVCanvas",this.configs=Object.assign({},e),this.canvas=this.configs.canvas,this.meta=Object.assign({},this.configs.meta),this.parent=r,this._initMeta(),this._initContextGL(),this.contextGL&&(this._initProgram(),this._initBuffers(),this._initTextures())}return _createClass$1(t,[{key:"_initMeta",value:function(){this.chroma=this.meta.chromaFormat,this.height=this.meta.height,this.width=this.meta.width,this.canvas.width===this.meta.width&&this.canvas.height===this.meta.height||(this.canvas.width=this.meta.width,this.canvas.height=this.meta.height,this.parent.emitResizeEvent())}},{key:"_initContextGL",value:function(){if("2d"!==this.configs.type){for(var t=this.canvas,r=null,n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=0;!r&&i<n.length;){var o=n[i];try{r=t.getContext(o,this.configs.glCtxOptions),logger.log("YUVCanvas","use=",o,this.configs.glCtxOptions);break}catch(e){r=null}r&&"function"==typeof r.getParameter||(r=null),++i}this.contextGL=r}else this.ctx=this.canvas.getContext("2d")}},{key:"_initProgram",value:function(){var e,t,r=this.contextGL;e=["attribute vec4 vertexPos;","attribute vec4 texturePos;","attribute vec4 uTexturePos;","attribute vec4 vTexturePos;","varying vec2 textureCoord;","varying vec2 uTextureCoord;","varying vec2 vTextureCoord;","void main()","{","  gl_Position = vertexPos;","  textureCoord = texturePos.xy;","  uTextureCoord = uTexturePos.xy;","  vTextureCoord = vTexturePos.xy;","}"].join("\n"),t=["precision highp float;","varying highp vec2 textureCoord;","varying highp vec2 uTextureCoord;","varying highp vec2 vTextureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","uniform mat4 YUV2RGB;","void main(void) {","  highp float y = texture2D(ySampler,  textureCoord).r;","  highp float u = texture2D(uSampler,  uTextureCoord).r;","  highp float v = texture2D(vSampler,  vTextureCoord).r;","  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n");var n=r.createShader(r.VERTEX_SHADER);r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+r.getShaderInfoLog(n));var i=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(i,t),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+r.getShaderInfoLog(i));var o=r.createProgram();r.attachShader(o,n),r.attachShader(o,i),r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS)||console.log("Program failed to compile: "+r.getProgramInfoLog(o)),r.useProgram(o);var a=r.getUniformLocation(o,"YUV2RGB");r.uniformMatrix4fv(a,!1,[1.16438,0,1.59603,-.87079,1.16438,-.39176,-.81297,.52959,1.16438,2.01723,0,-1.08139,0,0,0,1]),this.shaderProgram=o}},{key:"_initBuffers",value:function(){var e=this.contextGL,t=this.shaderProgram,r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW);var n=e.getAttribLocation(t,"vertexPos");e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var o=e.getAttribLocation(t,"texturePos");e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),this.texturePosBuffer=i;var a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var s=e.getAttribLocation(t,"uTexturePos");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),this.uTexturePosBuffer=a;var u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var c=e.getAttribLocation(t,"vTexturePos");e.enableVertexAttribArray(c),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0),this.vTexturePosBuffer=u}},{key:"_initTextures",value:function(){var e=this.contextGL,t=this.shaderProgram,r=this._initTexture(),n=e.getUniformLocation(t,"ySampler");e.uniform1i(n,0),this.yTextureRef=r;var i=this._initTexture(),o=e.getUniformLocation(t,"uSampler");e.uniform1i(o,1),this.uTextureRef=i;var a=this._initTexture(),s=e.getUniformLocation(t,"vSampler");e.uniform1i(s,2),this.vTextureRef=a,e.pixelStorei(e.UNPACK_ALIGNMENT,1)}},{key:"_initTexture",value:function(){var e=this.contextGL,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t}},{key:"_drawPictureGL",value:function(e,t,r,n,i){var o=n*r,a=i*r/2;444!==this.chroma&&422!==this.chroma||(a*=2);var s={yData:(e=new Uint8Array(e)).subarray(0,o),uData:e.subarray(o,o+a),vData:e.subarray(o+a,o+a+a)};this._drawPictureGL420(s,t,r,n,i)}},{key:"_drawPictureGL420",value:function(e,t,r,n,i){var o=this.contextGL,a=this.texturePosBuffer,s=this.uTexturePosBuffer,u=this.vTexturePosBuffer,c=this.yTextureRef,l=this.uTextureRef,d=this.vTextureRef,f=e.yData,h=e.uData,p=e.vData,g=n,y=r,v=i,m=r/2;422!==this.chroma&&444!==this.chroma||(m=r);var _=i,b=m,A=this.canvas.width/this.width,E=this.canvas.height/this.height,S=0,T=0,$=this.canvas.width,w=this.canvas.height;A<E?(w=this.height*this.canvas.width/this.width,T=parseInt((this.canvas.height-this.height*this.canvas.width/this.width)/2)):($=this.width*this.canvas.height/this.height,S=parseInt((this.canvas.width-this.width*this.canvas.height/this.height)/2)),o.viewport(S,T,$,w);var C=new Float32Array([1,0,0,0,1,1,0,1]);o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,C,o.DYNAMIC_DRAW);var I=new Float32Array([1,0,0,0,1,1,0,1]);o.bindBuffer(o.ARRAY_BUFFER,s),o.bufferData(o.ARRAY_BUFFER,I,o.DYNAMIC_DRAW);var k=new Float32Array([1,0,0,0,1,1,0,1]);o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,k,o.DYNAMIC_DRAW),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,c),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,g,y,0,o.LUMINANCE,o.UNSIGNED_BYTE,f),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,l),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,v,m,0,o.LUMINANCE,o.UNSIGNED_BYTE,h),o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,d),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,_,b,0,o.LUMINANCE,o.UNSIGNED_BYTE,p),o.drawArrays(o.TRIANGLE_STRIP,0,4)}},{key:"_drawPicture2d",value:function(e){if(e&&this.canvas){this.ctx||(this.ctx=this.canvas.getContext("2d"));var t=e.displayWidth||e.width,r=e.displayHeight||e.height;this.canvas.height===r&&this.canvas.width===t||(this.canvas.height=r,this.canvas.width=t);try{this.ctx.drawImage(e.dom||e,0,0,t,r)}catch(error){console.log(this.ctx,this.ctx.drawImage),console.error(this.TAG,"_drawPicture2d",e,e.dom,error,error.message)}}}},{key:"_resize",value:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.parent.emitResizeEvent())}},{key:"render",value:function(e,t,r,n,i){this._resize(t,r),this.contextGL?this._drawPictureGL(e,t,r,n,i):this._drawPicture2d(e)}},{key:"resetMeta",value:function(e){this.meta=Object.assign({},e),this._initMeta()}},{key:"destroy",value:function(){this.contextGL=null,this.shaderProgram=null,this.canvas=null}}]),t}();function _createSuper$8(e){var t=_isNativeReflectConstruct$8();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$8(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var DEFAULT_PLAYBACKRATE=2,CANVAS_COUNT=45,FRAME_DURATION=25,MAX_VIDEO_HEIGHT=720,MAX_FPS=30,MIN_FPS=15,VideoDecoder=function(t){_inherits(n,t);var r=_createSuper$8(n);function n(e){var t;return _classCallCheck$1(this,n),(t=r.call(this)).TAG="VideoDecoder",t._video=t._createVideo(),t._IsInDecoding=!1,t._fps=0,t._framId=null,t._screenShotNum=0,t._allPicNum=0,t._currentBlob=null,t._basePTS=0,t._totleTime=0,t._isVideoONRun=!0,t.firstEmit=!1,t.ptsArray=[],t._currentCanvasHeight=0,t._canvasList=[],t._realFrameDuration=FRAME_DURATION,t._maxVideoHeight=e.maxVideoHeight||MAX_VIDEO_HEIGHT,t._minFPSTime=0,t._maxFPSTime=0,t._playFailed=!1,t._isPhoneSafari=!1,t._createCanvasList(),t._bindEvents(),t}return _createClass$1(n,[{key:"_createCanvasList",value:function(){this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d",{alpha:!1});for(var e=0;e<CANVAS_COUNT;e++){var t=this._createCanvas(),r=t.dom,n=t.ctx;this._canvasList.push({dom:r,ctx:n})}}},{key:"_createCanvas",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return{dom:e,ctx:t}}},{key:"_createVideo",value:function(){var e=document.createElement("video");return e.setAttribute("muted",!0),e.setAttribute("autoplay",!0),e.setAttribute("controls",!0),e.setAttribute("webkit-playsinline",!0),e.setAttribute("playsinline",!0),e.setAttribute("x5-video-player-type","h5"),e.setAttribute("x5-video-player-type","h5-page"),e.style.position="absolute",e}},{key:"_initVideo",value:function(t,r){if(t.blobUrl&&void 0!==t.dts){var n=t.blobUrl;this._currentBlob=n,this._basePTS=t.dts,this._currentDuration=t.duration;try{logger.log(this.TAG,"_initVideo, basePTS:",t.dts),this._setVideoSrc(n,r),this._video.paused&&this._videoPlay("_initVideo")}catch(e){console.error(this.TAG,"_initVideo, load error",e)}}else console.error(this.TAG,"_initVideo","input info is error, blobUrl:",t.blobUrl,"dts:",t.dts)}},{key:"_setVideoSrc",value:function(t,r){try{var n=this._video;n.src=t,n.load(),n.playbackRate=DEFAULT_PLAYBACKRATE}catch(e){console.error(this.TAG,"_setVideoSrc",e)}}},{key:"_videoPlay",value:function(e){var t=this,r=this._video;if(logger.log(this.TAG,"_videoPlay, video is pause:",r.paused,e),r&&r.paused){var n=r.play();void 0!==n&&n.then((function(){t._playFailed=!1,logger.log(t.TAG,"_videoPlay success")})).catch((function(e){console.error(t.TAG,"_videoPlay failed,",e.message),t._playFailed=!0,t.emit(Events.DECODE_EVENTS.PLAY_FAILED,t.firstEmit)}))}}},{key:"_removeEvents",value:function(){var e=this._video;e.removeEventListener("playing",this._onPlaying.bind(this)),e.removeEventListener("ended",this._onEnded.bind(this)),e.removeEventListener("error",this._onError.bind(this)),e.removeEventListener("loadeddata",this._onLoadeddata.bind(this)),e.removeEventListener("timeupdate",this._onTimeUpdate.bind(this))}},{key:"_bindEvents",value:function(){var e=this,t=this._video;t?(document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this)),t.addEventListener("playing",this._onPlaying.bind(this)),t.addEventListener("ended",this._onEnded.bind(this)),t.addEventListener("error",this._onError.bind(this)),t.addEventListener("loadeddata",this._onLoadeddata.bind(this)),t.addEventListener("timeupdate",this._onTimeUpdate.bind(this)),t.addEventListener("pause",(function(){logger.log("on pause, currentTime, duration:",e._vCurrentTime,e._vDuration)})),this.on("outputresolutionchange",this._onChange.bind(this)),this.on("fpsreduce",(function(t){e._adaptFrameDuration(t)}))):console.error(this.TAG,"_bindEvents")}},{key:"_onTimeUpdate",value:function(){this._lastCurrentTime=this._vCurrentTime}},{key:"_onVisibilityChange",value:function(){this._isVideoONRun="visible"===document.visibilityState}},{key:"_onChange",value:function(e,t){this._width=e,this._height=t}},{key:"_onPlaying",value:function(){this._IsInDecoding&&(console.warn(this.TAG,"_onPlaying","last video not correct end"),this._framId&&(window.cancelAnimationFrame(this._framId),this._framId=null)),logger.log(this.TAG,"_onPlaying, video duration:",this._vDuration,"currentTime:",this._vCurrentTime,"_lastPts:",this._lastPts),this._isInDecoding=!0,this._lastCurrentTime=this._vCurrentTime,this.ptsArray=[],this.playingTime||(this.playingTime=!0),this._getFrame()}},{key:"_onEnded",value:function(e,t){logger.log(this.TAG,"_onEnded","current fmp4 duration is:",this._vDuration,"_isInDecoding:",this._isInDecoding,"_lastPts:",this._lastPts,"_realFrameDuration:",this._realFrameDuration,"from:",t),this._isInDecoding&&(this._isInDecoding=!1,this._lastMp4Duration=Math.min(this._vDuration,this._vCurrentTime),this._framId&&(logger.log(this.TAG,"_onEnded","cancelAnimationFrame"),window.cancelAnimationFrame(this._framId),this._framId=null),this._decodeFPS=parseInt(this._screenShotNum/(this._vDuration/1e3)),this.emit("fps",this._screenShotNum,this._totleTime,this._vDuration,this._metaFPS,{height:this._currentCanvasHeight,relHeight:this._video.videoHeight}),logger.log("_timePerFrame",this._totleTime/this._screenShotNum),this._timePerFrame=this._totleTime/this._screenShotNum,this._screenShotNum=0,this._allPicNum=0,this._totleTime=0,this._currentBlob&&(URL.revokeObjectURL(this._currentBlob),this._currentBlob=null,this._basePTS=0),this.emit(Events.DECODE_EVENTS.FRAGMENT_END,this._decodeFPS,this._video.duration))}},{key:"_onError",value:function(){this._isInDecoding=!1;var e=this._video;console.error("video error:",e.error.code,e.error.message),this.emit("error",e.error,this.firstEmit)}},{key:"_onLoadeddata",value:function(){var e=this,t=this._video;t.currentTime=.001,this.firstEmit||(this._playFailed?(t.style.visibility="hidden",this.emit(Events.DECODE_EVENTS.APPEND_VIDEO,t),setTimeout((function(){logger.log(e.TAG,"onloadeddata, setTimeout firstEmit:",e.firstEmit),e._getFirstFrame()}),40)):(logger.log(this.TAG,"onloadeddata, firstEmit:",this.firstEmit),this._getFirstFrame()))}},{key:"_getFirstFrame",value:function(){this.firstTime=Date.now();var e=this._vCurrentTime,t=this._basePTS+e,r=this._getImageData(t).imageData;this.firstEmit=!0,this.emit(Events.DECODE_EVENTS.FIRST_FRAME,r,t)}},{key:"_getFrame",value:function(){var t=this._video,r=t.videoWidth,n=t.videoHeight;if(this._allPicNum++,this._isInDecoding){if(r||n){var i=this._vCurrentTime,o=this._basePTS+i;if(this.ptsArray.push(o),this._lastCurrentTime&&this._lastCurrentTime===this._vDuration&&(logger.log(this.TAG,"_getFrame, video ended, lastCurrentTime",this._lastCurrentTime,"duration:",this._vDuration,"isInDecoding:",this._isInDecoding),this._onEnded(null,"getFrame")),this._lastPts&&o<=this._lastPts)return void(this._framId=window.requestAnimationFrame(this._getFrame.bind(this)));if(this._lastPts&&o-this._lastPts<this._realFrameDuration)return void(this._framId=window.requestAnimationFrame(this._getFrame.bind(this)));this._screenShotNum++;var a,s=null,u=Date.now();try{s=(a=this._getImageData(o)).imageData}catch(e){console.error(e,a,this._canvasList.length)}this._lastPts=o;var c=Date.now()-u;return this._totleTime+=c,this.emit(Events.DECODE_EVENTS.DECODED,s,o),void(this._framId=window.requestAnimationFrame(this._getFrame.bind(this)))}this._framId=window.requestAnimationFrame(this._getFrame.bind(this))}else this._framId&&(window.cancelAnimationFrame(this._framId),this._framId=null)}},{key:"_getImageData",value:function(){var t,r,n,i=this._video,o=i.videoWidth,a=i.videoHeight,s=o,u=a;if(this._width&&this._height&&(s=this._width,u=this._height),u>this._maxVideoHeight&&(u=this._maxVideoHeight,s=parseInt(u*(o/a))),(n=this._canvasList.shift())||(console.warn(this.TAG,"_getImageData, _canvansList length is 0"),n=this._createCanvas()),n.width=s,n.height=u,t=n.dom,r=n.ctx,this._currentCanvasHeight=u,!t)return{imageData:n};t.width!==s&&(t.width=s,t.height=u);try{a&&o&&s&&u&&r.drawImage(i,0,0,o,a,0,0,s,u)}catch(e){console.error(this.TAG,"_getImageData, drawImage:",e)}return{imageData:n}}},{key:"_adaptFrameDuration",value:function(e){e<MIN_FPS?this._minFPSTime++:this._minFPSTime=0,e>MAX_FPS?this._maxFPSTime++:this._maxFPSTime=0,this._minFPSTime>0&&this._decodeFPS<MIN_FPS&&(this._realFrameDuration-=this._timePerFrame,this._realFrameDuration<15&&(this._realFrameDuration=15),this._minFPSTime=0),this._maxFPSTime>0&&this._decodeFPS>MAX_FPS&&(this._realFrameDuration+=this._timePerFrame,this._maxFPSTime=0)}},{key:"_vDuration",get:function(){return parseInt(1e3*this._video.duration)}},{key:"_vCurrentTime",get:function(){return parseInt(1e3*this._video.currentTime)}},{key:"_reset",value:function(){this._isInDecoding=!1,this._lastPts=0,this._screenShotNum=0,this._allPicNum=0,this._totleTime=0}},{key:"reStartDecode",value:function(){this._video.pause(),this._reset();var e=this._currentBlob,t=this._basePTS;this._framId&&(window.cancelAnimationFrame(this._framId),this._framId=null),this._initVideo({blobUrl:e,dts:t})}},{key:"doSeek",value:function(e){if(this._isInDecoding){if(e<=0)return;var t=this._vCurrentTime/1e3+e>=this._vDuration/1e3?this._vDuration/1e3:this._vCurrentTime/1e3+1;console.error("doSeek",t),this._video.currentTime=t}}},{key:"pause",value:function(){this._isInDecoding&&this._video.pause()}},{key:"play",value:function(){if(this._isInDecoding&&this._video.paused)return logger.log("video play",this._vCurrentTime),this._video.play()}},{key:"startDecode",value:function(e,t,r){this._initVideo(e,r),this._metaFPS=t}},{key:"stopDecode",value:function(){this._video.paused||(this._video.pause(),this._reset())}},{key:"canPlayType",value:function(e){return this._video.canPlayType(e)}},{key:"destroy",value:function(){this._isInDecoding=!1,window.cancelAnimationFrame(this._framId),this._video.pause(),this._removeEvents()}},{key:"videoWidth",get:function(){return this._video?this._video.videoWidth:0}},{key:"videoHeight",get:function(){return this._video?this._video.videoHeight:0}}]),n}(EventEmitter$1);function _createSuper$7(e){var t=_isNativeReflectConstruct$7();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$7(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var MAX_FRAMESIZE=40,MIN_FRAMESIZE=25,DEFAULT_FPS=20,LEVELS=[{base:720,level:1},{base:540,level:2},{base:360,level:3},{base:280,level:4}],VideoDecoderController=function(t){_inherits(n,t);var r=_createSuper$7(n);function n(e,t){var i;return _classCallCheck$1(this,n),(i=r.call(this)).TAG="VideoDecoderController",i._decoder=new VideoDecoder(e),i._remux=new MP4Remuxer,i._bindEvents(),i._isInit=!1,i._isDataReady=!1,i._ready=!1,i._blobURLList=[],i._isInDecoding=!1,i._mediaSegmentReady=!1,i._parent=t,i._isDecodePause=!1,i._playSuccess=!0,i._isVideoOnRun=!0,i._startDts=0,i._fDuration=0,i._minFPSTime=0,i._lastPts=0,i._frameLengthPerFragment=0,i._gopBufferLength=0,i._maxGopDuration=0,i._minGopDuration=0,i._currentLevel=-1,i._endLevel=e.endLevel||2,i.currentFragmentDuration=0,i._handleKeyFrameVideo=i._handleKeyFrameVideo.bind(_assertThisInitialized(i)),i}return _createClass$1(n,[{key:"_bindEvents",value:function(){var e=this;document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this)),this._decoder.on(Events.DECODE_EVENTS.APPEND_VIDEO,this._onAppendVideo.bind(this)),this._decoder.on(Events.DECODE_EVENTS.PLAY_FAILED,this._onPlayFailed.bind(this)),this._decoder.on("error",this._onError.bind(this)),this._decoder.on(Events.DECODE_EVENTS.DECODED,this._onDecoded.bind(this)),this._decoder.on(Events.DECODE_EVENTS.FIRST_FRAME,this._onFirstFrame.bind(this)),this._decoder.on(Events.DECODE_EVENTS.FRAGMENT_END,this._onFragmentEnd.bind(this)),this._decoder.on("fps",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=[e._metaFPS].concat(r,[e._frameLengthPerFragment]);e.emit.apply(e,["fps"].concat(_toConsumableArray(i)))})),this.on("keyFrame",this._handleKeyFrameVideo)}},{key:"_onRemuxed",value:function(e){var t={blobUrl:this._createBlobURL(e),dts:this.currentFragmentDts,duration:this.currentFragmentDuration,frameDuration:Math.floor(1e3/this._metaFPS)};this._recordGopDuration(this.currentFragmentDuration),this._pushBlob(t),logger.log(this.TAG,"_onRemuxed","maxgopduration:",this._maxGopDuration,"_gopBufferLength:",this._gopBufferLength),!this._isDataReady&&this._gopBufferLength>=this._maxGopDuration&&this._checkDataReady()}},{key:"_onPlayFailed",value:function(e){this._isInDecoding=!1,this._parent.emit(Events.DECODE_EVENTS.PLAY_FAILED,e)}},{key:"_onAppendVideo",value:function(e){this._parent.emit(Events.DECODE_EVENTS.APPEND_VIDEO,e)}},{key:"_onVisibilityChange",value:function(){this._isVideoOnRun="visible"===document.visibilityState}},{key:"_onDecoded",value:function(e,t){this._frameLengthPerFragment++;var r=this._buildFrameInfo(e,t);this._parent.emit(Events.DECODE_EVENTS.DECODED,r),this._lastPts=t}},{key:"_onFirstFrame",value:function(e,t){var r=this._buildFrameInfo(e,t);this._parent.emit(Events.DECODE_EVENTS.FIRST_FRAME,r)}},{key:"_onFragmentEnd",value:function(e,t){var r=this;logger.log(this.TAG,"_onFragmentEnd ,_isDecodePause:",this._isDecodePause,"decodeFPS:",e),e&&this._reduceResolution(e),this._isInDecoding=!1,this._inDecodeId=-1,this._currentInfo=null,this._frameLengthPerFragment=0,this._getBlobLength()&&!this._isDecodePause?this.startDecode():this.loadNextHandle=setInterval((function(){r._getBlobLength()&&!r._isDecodePause&&r._isVideoOnRun&&!r._isInDecoding&&(logger.log(r.TAG,"_onFragmentEnd, setInterval start next mp4 decode"),r.startDecode(),clearInterval(r.loadNextHandle))}))}},{key:"_onError",value:function(e,t){this._isInDecoding=!1,this._parent.emit("error",e,t)}},{key:"_checkReady",value:function(){this._isDataReady&&this._isInit&&(this.ready=!0,logger.log(this.TAG,"checkReady trigger ready"),this._parent.emit(Events.DECODE_EVENTS.READY))}},{key:"_checkDataReady",value:function(){this._isDataReady=!0,this._checkReady()}},{key:"_reduceResolution",value:function(e){if(logger.log(this.TAG,"_reduceResolution","currentLevel:",this._currentLevel,"endLevel:",this._endLevel),this._videoHeight>720&&(logger.log(this.TAG,"_reduceResolution","trigger DECODE_LOW_FPS"),this._parent.emit(Events.VIDEO.DECODE_LOW_FPS)),e&&e<DEFAULT_FPS?(this._minFPSTime++,this._decoder.emit("fpsreduce",e)):this._minFPSTime=0,this._currentLevel>=this._endLevel)return logger.log(this.TAG,"_reduceResolution","trigger DECODE_LOW_FPS",this._currentLevel,this._endLevel),void this._parent.emit(Events.VIDEO.DECODE_LOW_FPS);if(this._minFPSTime>2){var t,r=this._videoWidth,n=this._videoHeight;if(t=this._findLevel(n,this._currentLevel)){if(this._currentLevel=t.level,4===this._currentLevel)return logger.log(this.TAG,"_reduceResolution","trigger DECODE_LOW_FPS, _currentLevel: ",this._currentLevel),void this._parent.emit(Events.VIDEO.DECODE_LOW_FPS);this.width=t.base*(r/n),this.height=t.base,this._decoder.emit("outputresolutionchange",this.width,this.height)}this._minFPSTime=0}}},{key:"_findLevel",value:function(e,t){return LEVELS.find((function(r){return r.base<e&&r.level>t}))}},{key:"_buildFrameInfo",value:function(t,r){try{var n=t.width,i=t.height;return{msg:"DECODED",width:n,height:i,buffer:t,yLinesize:n,uvLinesize:n/2,info:{baseDts:void 0,dts:r,gopId:0,isGop:void 0,key:!1,pts:r},type:"rgb"}}catch(e){logger.log(this.TAG,e)}}},{key:"_pushBlob",value:function(e){logger.log("push blob",e.dts,e.duration),e&&e.duration&&(this._gopBufferLength+=e.duration),this._blobURLList.push(e)}},{key:"_shiftBlob",value:function(){var e=this._blobURLList.shift();return e&&e.duration&&(this._gopBufferLength-=e.duration),e}},{key:"_filterBlob",value:function(e){var t=this;this._blobURLList=this._blobURLList.filter((function(r){return r.dts<e&&(URL.revokeObjectURL(r.blobUrl),r.duration&&(t._gopBufferLength-=r.duration)),r.dts>=e}))}},{key:"_emptyBlobList",value:function(){this._blobURLList=[],this._gopBufferLength=0}},{key:"_getBlobLength",value:function(){return this._blobURLList.length}},{key:"_handleKeyFrameVideo",value:function(t){try{var r=this._parent._timeRange.frames||[];if(this._parent._timeRange.clean(),!r.length)return;var n=r[0].dts,i=r[r.length-1].dts,o=n-this.endDts;logger.log(this.TAG,"_handleKeyFrameVideo","startDts:",n,"endDts:",i,"samples length:",r.length),this.endDts&&o>Math.floor(1e3/this._metaFPS)+1&&logger.log(this.TAG,"_handleKeyFrame, keyFrame dts:",n,"sample length:",r.length,"endDts:",i,"delay:",o);var a=i-n;if(this._fDuration||(this._fDuration=a),a<1500)return void logger.log(this.TAG,"_handleKeyFrame gopDuration :",a,"sample length:",r.length,"gopStartDts:",n,"gopEndDts:",i);if(this.firstDts||(this.firstDts=r[0].dts),this.currentFragmentDts=r[0].dts,this.currentFragmentDuration=this._getFragmentDuration(r),this.endDts=i,this.currentFragmentDts<this._startDts)return console.warn(this.TAG,"_handleKeyFrameVideo","currentFragmentDts < this._startDts",this.currentFragmentDts,this._startDts),void(r=[]);this.startRemux(r),r=[]}catch(e){console.error(this.TAG,"_handleKeyFrameVideo",e)}}},{key:"_getFragmentDuration",value:function(e){var t=0,r=0;return e[0].keyframe||console.error(this.TAG,"_getFragmentDuration","gop firstFrame is not keyframe"),e.forEach((function(n,i){n.keyframe&&i&&(t+=e[i-1].dts-e[r].dts,r=i)})),t+=e[e.length-1].dts-e[r].dts}},{key:"_createBlobURL",value:function(e){if(e){var t=new window.Blob([e.buffer],{type:"video/mp4"});return window.URL.createObjectURL(t)}}},{key:"_recordGopDuration",value:function(e){var t=e;this._minGopDuration||(this._minGopDuration=t),t>this._maxGopDuration&&(this._maxGopDuration=t),t<this._minGopDuration&&(this._minGopDuration=t)}},{key:"checkMaxFrames",value:function(e){"number"==typeof e&&(this._isDecodePause=e>MAX_FRAMESIZE,this._playSuccess&&this._isDecodePause&&this._decoder.pause())}},{key:"checkMinFrames",value:function(e){var t=this;if("number"==typeof e&&(this._isDecodePause=!(e<MIN_FRAMESIZE),!this._isDecodePause)){var r=this._decoder.play();void 0!==r?r.then((function(){t._playSuccess=!0})).catch((function(){t._playSuccess=!1})):setTimeout((function(){t._playSuccess=!0}),20)}}},{key:"frameRendend",value:function(e){if(e.dom){if(e.dom.width=0,e.dom.height=0,this._decoder._canvasList.length>MAX_FRAMESIZE)return;this._decoder._canvasList.push(e)}else logger.error(this.TAG,"_onRendend","imageObj. is error",e)}},{key:"checkValidBlob",value:function(e){this._filterBlob(e)}},{key:"chaseVideoFrame",value:function(e){logger.log(this.TAG,e,e.frame.dts,this.currentFragmentDts);var t=e.frame.dts;if(this._startDts=t,t===this.currentFragmentDts){if(logger.log(this.TAG,"_onChaseFrame","_inDecodeId:",this._inDecodeId,"currentFragmentDts:",this.currentFragmentDts),this._inDecodeId>0&&this._inDecodeId<t)return logger.log(this.TAG,"_onChaseFrame, _inDecodeId > 0 && _inDecodeId < startDts, _inDecodeId:",this._inDecodeId,"startDts:",t),this.stopDecode(),this._filterBlob(t),void this.startDecode();if(this._inDecodeId===t)return logger.log(this.TAG,"_onChaseFrame, _inDecodeId === startDts, startDts:",t),this.stopDecode(),void this.reStrartDecode(this._currentInfo);-1===this._inDecodeId&&(logger.log(this.TAG,"_onChaseFrame","_inDecodeId==-1"),this.startDecode())}t>this.currentFragmentDts&&(logger.log(this.TAG,"_onChaseFrame, startDts > currentFragmentDts, startDts:",t,"currentFragmentDts:",this.currentFragmentDts),this.stopDecode(),this._emptyBlobList()),t<this.currentFragmentDts&&(logger.log(this.TAG,"_onChaseFrame, startDts < currentFragmentDts, startDts:",t,"currentFragmentDts:",this.currentFragmentDts),t>this._inDecodeId&&(this._filterBlob(t),this.stopDecode(),this.startDecode()))}},{key:"init",value:function(e){this._isInit||(this._metaFPS=e.fpsNum/e.fpsDen||25,this._videoWidth=e.width,this._videoHeight=e.height,this._width=this._videoWidth,this._height=this._videoHeight,this._frameDuration=parseInt(1e3/this._metaFPS),this._isInit=!0,logger.log("".concat(this.TAG," has inited")),this._isInit=!0,this._checkReady())}},{key:"reStrartDecode",value:function(t){if(t)try{logger.log(this.TAG,"reStrartDecode"),this._isInDecoding=!0,this._inDecodeId=t.dts,this._currentInfo=t,this._decoder.startDecode(t,this._metaFPS,this._startTime),this._startTime=0}catch(e){console.error("load error",e)}}},{key:"stopDecode",value:function(){this._isInDecoding=!1,this._inDecodeId=-1,this._currentInfo=null,this._frameLengthPerFragment=0,this._decoder.stopDecode()}},{key:"startDecode",value:function(){if(this._isInDecoding)logger.log(this.TAG,"startDecode","this decoder is in decoding");else{var t=this._getBlobLength();if(this._decoder&&t){logger.log(this.TAG,"startDecode","blob url length:",t);var r=this._shiftBlob()||{};try{logger.log(this.TAG,"startDecode",r.dts,r.duration),this._isInDecoding=!0,this._inDecodeId=r.dts,this._currentInfo=r,this._decoder.startDecode(r,this._metaFPS)}catch(e){console.error(this.TAG,"startDecode","load error",e)}}}}},{key:"canSeek",value:function(e){var t=e.frame.dts;return!!(this.currentFragmentDts>=t&&this._isInDecoding)&&(this._inDecodeId!==t&&this._inDecodeId<t)}},{key:"startRemux",value:function(e){if(logger.log("startRemux samples length:",e.length),e.length){var t=this._parent._meta;t.samples=e;var r=this._remux.remux(t).videoSegment;this._onRemuxed(r)}else console.error("frame length is 0")}},{key:"canPlayType",value:function(t){if(this._decoder)try{return this._decoder.canPlayType('video/mp4;codecs="'+t.codec+'"')}catch(e){console.error(e)}}},{key:"destroy",value:function(){this._blobURLList=[],this._decoder.destroy()}},{key:"empty",value:function(){if(logger.log("empty"),this._decoder){var e=this._decoder._canvasList;return logger.log(this.TAG,"empty >>>>>>>>>>>>>>>>>>length:",e.length),e.forEach((function(e){e.dom&&(logger.log("clear >>>>>>>>>>>>>>>>>>"),e.dom.width=0,e.dom.height=0,e.dom=null)})),e.length}}},{key:"isIDLE",get:function(){return logger.log(this.TAG,"isIDEL","blob length:",this._getBlobLength(),"_isInDecoding:",this._isInDecoding,"isVideoOnRun:",this._isVideoOnRun,"_isDecodePause",this._isDecodePause),!this._getBlobLength()&&!this._isInDecoding&&this._isVideoOnRun}},{key:"ready",get:function(){return this._ready},set:function(e){this._ready=e}},{key:"remux",get:function(){return this._remux}},{key:"isInit",get:function(){return this._isInit}}]),n}(EventEmitter$1);function _createSuper$6(e){var t=_isNativeReflectConstruct$6();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$6(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var VideoRenderFromVideo=function(t){_inherits(n,t);var r=_createSuper$6(n);function n(e,t){var i;return _classCallCheck$1(this,n),(i=r.call(this,e,t)).TAG="VideoRenderFromVideo",i._videoDecodeController=new VideoDecoderController(e,_assertThisInitialized(i)),i._canAutoPlay=!0,i._videoDecode=e.videoDecode,i._chaseToFrame=null,i}return _createClass$1(n,[{key:"videoDecode",get:function(){return this._videoDecode},set:function(e){this._videoDecode=e}},{key:"_bindEvents",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),this.on("keyFrame",this._onKeyFrame.bind(this)),this.on(Events.DECODE_EVENTS.READY,this._onReady.bind(this)),this.on(Events.DECODE_EVENTS.DECODED,this._onDecoded.bind(this)),this.on(Events.DECODE_EVENTS.PLAY_FAILED,this._onPlayFailed.bind(this)),this.on("error",this._onError.bind(this)),this.on(Events.DECODE_EVENTS.APPEND_VIDEO,this._onAppendVideo.bind(this)),this.on(Events.DECODE_EVENTS.FIRST_FRAME,this._onFirstFrame.bind(this)),this._parent.on(Events.DECODE_EVENTS.CHASE_VIDEO_FRAME,this._onChaseVideoFrame.bind(this)),this._parent.on(Events.TIMELINE.SYNC_DTS,this._onTimeLineSyncDTS.bind(this)),window.addEventListener("unload",(function(){e._empty()}))}},{key:"_onTimeLineSyncDTS",value:function(e){this._videoDecodeController.checkValidBlob(e)}},{key:"_onChaseVideoFrame",value:function(e){this._doChaseVideoFrame(e)}},{key:"_onAppendVideo",value:function(t){try{this._parent._parent.appendChild(t)}catch(e){cosole.error(this.TAG,"onAppendVideo",e)}}},{key:"_onKeyFrame",value:function(){logger.log(this.TAG,"_onKeyFrame,  keyframe"),this._videoDecodeController.emit("keyFrame")}},{key:"_onError",value:function(e,t){console.error(this.TAG,"decoder error",e,t),t||this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",this._assembleErr(e&&e.message))}},{key:"_onReady",value:function(){if(!this._frameRender){var t=Object.assign(this._config,{meta:this._meta,canvas:this._canvas,type:"2d"});try{this._frameRender=new YUVCanvas(t,this)}catch(e){this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",this._assembleErr(e&&e.message))}}this._startDecode()}},{key:"_onFirstFrame",value:function(e){logger.log(this.TAG,"onFirstFrame"),this._receiveFrame(e),this._firstFrame=!0}},{key:"_onDecoded",value:function(e){var t=this;if(this._inChaseFrame){if(this.chaseFrameAfter++,1===this.chaseFrameAfter&&this._chaseToFrame){if(this._parent.emit(Events.DECODE_EVENTS.CHASE_VIDEO_FRAME_END,this._chaseToFrame),this._frameQueue.length)this._frameQueue.frames.forEach((function(e){t._videoDecodeController.frameRendend(e.buffer)}));this._frameQueue.empty(),this._videoDecodeController.checkMinFrames(this._frameQueue.length),this._timeRange.deletePassed(this._chaseToFrame.frame.dts),this._inChaseFrame=!1,this._chaseToFrame=null,console.warn(this.TAG,"onDecoded","_inChaseFrame end")}}else this.chaseFrameAfter=0;this._receiveFrame(e)}},{key:"_onPlayFailed",value:function(e){console.warn(this.TAG,"onPlayFailed, this._ready:",this._ready,",firstEmit:",e,",frame length:",this._frameQueue.length),this._ready||e||this._whenReady(),this._canAutoPlay=!1}},{key:"canSeek",value:function(e){return this._videoDecodeController.canSeek(e)}},{key:"_initDecoder",value:function(){this._isInit||(logger.log(this.TAG,"_initDecoder"),this._videoDecodeController.isInit||this._videoDecodeController.init(this._meta),this._isInit=!0)}},{key:"_receiveFrame",value:function(e){_get(_getPrototypeOf(n.prototype),"_receiveFrame",this).call(this,e),this._videoDecodeController.checkMaxFrames(this._frameQueue._frames.length)}},{key:"_setMetadata",value:function(e){logger.warn(this.TAG,"video set metadata",e),this._meta=e;var t=e.fpsNum/e.fpsDen;t?logger.log(this.TAG,"detect fps:",t):logger.warn(this.TAG,"no detect fps,start estimate"),this._initDecoder(e)}},{key:"_doChaseVideoFrame",value:function(e){this._inChaseFrame=!0,this._chaseToFrame=e,this._videoDecodeController.chaseVideoFrame(e)}},{key:"_appendChunk",value:function(e){this._meta||this._setMetadata(e);for(var t=e.samples.slice(),r=t.length,n=0;n<r;n++){var i=t.shift();i.keyframe&&this.emit("keyFrame"),this._timeRange.append([i],this.noAudio,!1)}}},{key:"_startDecode",value:function(){this._videoDecodeController.startDecode()}},{key:"_checkToDecode",value:function(){this._startDecode()}},{key:"_startRender",value:function(){logger.log(this.TAG,"_startRender interval",this.interval),this._tickTimer.start(this.interval)}},{key:"_render",value:function(e){var t=this,r=this._frameQueue.nextFrame(),n=this.preciseVideoDts;if(r&&this._timeRange){var i=r.info;if(!i)return this._frameQueue.shift(),void console.error("not info");this._renderDts=i.dts;var o=i.dts-n;if(o<-150){this.lastPrecise;var a=this._frameQueue.frames,s=this._getDeleteFrames(a,n),u=s.deleteFrames,c=s.useFrames;return a.splice(0),c.forEach((function(e){a.push(e)})),u.forEach((function(e){t._videoDecodeController.frameRendend(e.buffer)})),this._videoDecodeController.emit("renderDelay",o,this._frameQueue._frames.length),void this._videoDecodeController.checkMinFrames(this._frameQueue.length)}if(!(!e&&o>30&&o<6e4)){Math.abs(this._lastTimeupdate-i.dts)>250&&(this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE),this._lastTimeupdate=i.dts),logger.long&&logger.log(this.TAG,"render delay:".concat(o," , timelinePosition:").concat(n," , dts:").concat(i.dts," , cost:").concat(i.cost," , gopID:").concat(i.gopId," , rest:").concat(this._frameQueue.length,", buffer frame:").concat(this._timeRange.frameLength));var l=performance.now();this._frameRender.render(r.buffer,r.width,r.height,r.yLinesize,r.uvLinesize),this.hasFirstFrame||e||(this.hasFirstFrame=!0,this._parent.emit(Events.TIMELINE.PLAY_EVENT,"firstframe")),this._videoDecodeController.frameRendend(r.buffer),this._frameQueue.shift(),this._videoDecodeController.checkMinFrames(this._frameQueue.length),this._videoDecodeController.emit("renderDelay",o,this._frameQueue._frames.length),this._renderCost=performance.now()-l,e||(this.lastTime&&(this.lastPrecise,Date.now(),this.lastTime),this.lastFrameinfo=i.dts,this.lastPrecise=n,this.lastTime=Date.now(),this.lastAudioTime=this._parent.audioRender.currentTime)}}else{if(this._videoDecodeController.checkMinFrames(this._frameQueue._frames.length),this._parent._paused)return;if(!this._firstFrame)return void logger.log(this.TAG,"_render","not first frame return");var d=this._videoDecodeController;if(logger.log(this.TAG,",lack frame, _inDecoding:",this._videoDecodeController._isInDecoding,this._videoDecodeController._isDecodePause,",_frameQueue.length:",this._frameQueue.length),!this._frameQueue.length&&d.isIDLE){this._ready=!1;var f=this._parent.audioRender;console.warn(this.TAG,"trigger video waiting vdecode, preciseVideoDts:",n,f.currentTime,f.duration,f.buffered.end(0),f.baseDts),this.emit(Events.VIDEO.VIDEO_WAITING)}this._checkToDecode()}}},{key:"_updateSegmentEnd",value:function(){}},{key:"_destroy",value:function(e){this._empty(),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this,e),this._videoDecodeController.destroy()}},{key:"_doPause",value:function(){logger.log(this.TAG,">>>>>>>>doPause"),this._tickTimer.stop()}},{key:"_getDeleteFrames",value:function(e,t){var r=[],n=[];return e.forEach((function(e){e.info&&e.info.dts>t?n.push(e):e.info&&e.info.dts<=t&&r.push(e)})),{deleteFrames:r,useFrames:n}}},{key:"_empty",value:function(){this._videoDecodeController&&(this._videoDecodeController.empty(),this._frameQueue.frames.forEach((function(e){e.buffer&&e.buffer.dom&&(e.buffer.dom.width=0,e.buffer.dom.height=0,e.buffer.dom=null)})))}}]),n}(VideoBaseRender);function _createSuper$5(e){var t=_isNativeReflectConstruct$5();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$5(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var DecodeController=function(e){_inherits(r,e);var t=_createSuper$5(r);function r(e){var n;return _classCallCheck$1(this,r),_defineProperty$1(_assertThisInitialized(n=t.call(this)),"_parent",null),_defineProperty$1(_assertThisInitialized(n),"_decoderReady",!1),_defineProperty$1(_assertThisInitialized(n),"_inDecoding",!1),_defineProperty$1(_assertThisInitialized(n),"_id",(new Date).getMilliseconds()),_defineProperty$1(_assertThisInitialized(n),"_workerErrorCallback",null),_defineProperty$1(_assertThisInitialized(n),"_workerMessageCallback",null),_defineProperty$1(_assertThisInitialized(n),"_decoderWorkers",[]),n._parent=e,n}return _createClass$1(r,[{key:"inDecoding",get:function(){return this._inDecoding}},{key:"decoderMode",get:function(){return this._decoderMode}},{key:"workerLength",get:function(){return this._decoderWorkers.length}},{key:"decoderReady",get:function(){return this._decoderReady}},{key:"needToDecode",get:function(){return this._inDecoding?0:this._continueDecodeThreshold}},{key:"maxDecodeOnce",get:function(){return this._maxDecodeOnce}},{key:"meta",get:function(){var e;return null===(e=this._parent)||void 0===e?void 0:e._meta},set:function(e){this._parent&&(this._parent._meta=e)}},{key:"init",value:function(e,t){this._workerMessageCallback=e,this._workerErrorCallback=t,this._initWorker()}},{key:"_initWorker",value:function(){throw new Error("need override by children")}},{key:"doDecode",value:function(){var e=this,t=this._getFramesToDecode();t&&this.meta&&(logger.log(this.TAG,"doDecode ".concat(t.length," frames")),t.forEach((function(t){e._doDecodeInternal(t)})),this._inDecoding=!0,this._decoderWorkers.filter((function(e){return e.using})).forEach((function(e){e.postMessage({msg:"finish_flag"})})))}},{key:"_getFramesToDecode",value:function(){var e=this._parent,t=e._timeRange,r=e._decodeEstimate;if(this._decoderReady&&t){var n=t.frameLength;if(n&&!(n<this.maxDecodeOnce)){var i=this.maxDecodeOnce;1===n&&r.resetDecodeDot(performance.now());for(var o=[];i>0;){var a=t&&t.getFrame();if(!a)break;o.push(a),a.gopId&&a.gopId-1==0&&r.updateGopCount(),i--}return o}}}},{key:"_doDecodeInternal",value:function(e){var t=this._decoderWorkers.length,r=0;e.gopId&&(r=e.gopId-1);var n=this._decoderWorkers[r%t];n.using=1,null!=e&&e.meta&&(this.meta=e.meta,logger.warn(this.TAG,"detect metadata! flush decoder"),this._initDecoderWithConfiguration(n,e.meta)),n.postMessage({msg:"decode",data:e.data,info:{baseDts:e.baseDts,dts:e.dts,pts:e.pts||e.dts+e.cts,originDts:e.originDts,originPts:e.originPts,keyframe:e.keyframe,gopId:e.gopId,id:this._id}})}},{key:"_initDecoderWithConfiguration",value:function(){throw new Error("need override by children")}},{key:"flushDecoder",value:function(){this._decoderWorkers.forEach((function(e){e.postMessage({msg:"flush"})}))}},{key:"destroy",value:function(){throw new Error("need override by children")}}]),r}(EventEmitter$1);function decodeBase64(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),i=0,o=r.length;i<o;++i)n[i]=r.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}function createURL(e,t,r){var n=void 0===t?null:t,i=decodeBase64(e,void 0!==r&&r),o=i.indexOf("\n",10)+1,a=i.substring(o)+(n?"//# sourceMappingURL="+n:""),s=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(s)}function createBase64WorkerFactory(e,t,r){var n;return function(i){return n=n||createURL(e,t,r),new Worker(n,i)}}var WorkerFactory$3=createBase64WorkerFactory("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgdmFyIGRlY29kZXIgPSBudWxsOwoKICB2YXIgZnJhbWVRdWV1ZSA9IFtdOwoKICB2YXIgcmVjZWl2ZUZyYW1lVGltZXIgPSAwOwoKICB2YXIgaGFzUmVjZWl2ZUZyYW1lID0gZmFsc2U7CgogIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CiAgICBzd2l0Y2ggKGUuZGF0YS5tc2cpIHsKICAgICAgY2FzZSAnY29uZmlndXJhdGlvbic6CiAgICAgICAgZGVjb2RlciA9IG5ldyBzZWxmLlZpZGVvRGVjb2Rlcih7CiAgICAgICAgICBvdXRwdXQ6IGZ1bmN0aW9uIChmcmFtZSkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGVjb2RlZCEnLCBkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSwgZnJhbWVRdWV1ZS5sZW5ndGgpCgogICAgICAgICAgICBoYXNSZWNlaXZlRnJhbWUgPSB0cnVlOwoKICAgICAgICAgICAgaWYgKHJlY2VpdmVGcmFtZVRpbWVyKSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHJlY2VpdmVGcmFtZVRpbWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZiA9IGZyYW1lUXVldWUuc2hpZnQoKTsKICAgICAgICAgICAgaWYgKCFmKSB7CiAgICAgICAgICAgICAgZnJhbWUuY2xvc2UoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICdERUNPREVEJywKICAgICAgICAgICAgICAgIHdpZHRoOiBmcmFtZS5kaXNwbGF5V2lkdGgsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGZyYW1lLmRpc3BsYXlIZWlnaHQsCiAgICAgICAgICAgICAgICBpbmZvOiBmLAogICAgICAgICAgICAgICAgYnVmZmVyOiBmcmFtZQogICAgICAgICAgICAgIH0sIFtmcmFtZV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGVjb2Rlci5kZWNvZGVRdWV1ZVNpemUgPT09IGZyYW1lUXVldWUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAnQkFUQ0hfRklOSVNIX0ZMQUcnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1tXZWJjb2RlY1dvcmtlcl06JywgZSk7CiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UgPT09ICdDb2RlYyByZWNsYWltZWQgZHVlIHRvIGluYWN0aXZpdHkuJykgcmV0dXJuCiAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICdGQUlMRUQnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGUgJiYgZS5tZXNzYWdlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHNlbGYuVmlkZW9EZWNvZGVyLmlzQ29uZmlnU3VwcG9ydGVkKGUuZGF0YS5kYXRhKQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0YXR1cykgewogICAgICAgICAgICBpZiAoc3RhdHVzLnN1cHBvcnRlZCkgewogICAgICAgICAgICAgIGRlY29kZXIuY29uZmlndXJlKGUuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1dlYmNvZGVjV29ya2VyXTonLCAnaXNDb25maWdTdXBwb3J0ZWQnLCBzdGF0dXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0RFQ09ERVJfUkVBRFknIH0pOwoKICAgICAgICAgICAgLy8g5o6i5rWL6ZW/5pe26Ze05peg6Kej56CB5bin6L6T5Ye6LOmZjee6p+WIsHdhc20KICAgICAgICAgICAgcmVjZWl2ZUZyYW1lVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoaGFzUmVjZWl2ZUZyYW1lKSByZXR1cm4KICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0ZBSUxFRCcsIG1lc3NhZ2U6ICdubyBmcmFtZSBvdXRwdXQnIH0pOwogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ0ZBSUxFRCcsCiAgICAgICAgICAgICAgbWVzc2FnZTogZSAmJiBlLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIHZhciBkID0gZS5kYXRhLmRhdGE7CgogICAgICAgIHZhciBzYW1wbGVJbmZvID0gZS5kYXRhLmluZm87CgogICAgICAgIGZyYW1lUXVldWUucHVzaChzYW1wbGVJbmZvKTsKCiAgICAgICAgdmFyIGZyYW1lU2l6ZSA9IGQuYnl0ZUxlbmd0aCAtIDQ7CgogICAgICAgIHZhciBkdiA9IG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoNCkpOwoKICAgICAgICBkdi5zZXRVaW50MzIoMCwgZnJhbWVTaXplLCBmYWxzZSk7CgogICAgICAgIGQuc2V0KG5ldyBVaW50OEFycmF5KGR2LmJ1ZmZlciksIDApOwoKICAgICAgICBpZiAoc2FtcGxlSW5mby5rZXlmcmFtZSkgewogICAgICAgICAgZGVjb2Rlci5mbHVzaCgpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNodW5rID0gbmV3IHNlbGYuRW5jb2RlZFZpZGVvQ2h1bmsoewogICAgICAgICAgdHlwZTogc2FtcGxlSW5mby5rZXlmcmFtZSA/ICdrZXknIDogJ2RlbHRhJywKICAgICAgICAgIHRpbWVzdGFtcDogc2FtcGxlSW5mby5wdHMsCiAgICAgICAgICBkYXRhOiBkCiAgICAgICAgfSk7CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoY2h1bmspOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2Rlc3Ryb3knOgogICAgICAgIGlmIChkZWNvZGVyKSB7CiAgICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgICBkZWNvZGVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGNsZWFyVGltZW91dChyZWNlaXZlRnJhbWVUaW1lcik7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnY2hlY2tEZWNvZGUnOgogICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ0NIRUNLX1RPX0RFQ09ERScsCiAgICAgICAgICBkYXRhOiBNYXRoLmFicyhkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSAtIGZyYW1lUXVldWUubGVuZ3RoKSA9PT0gMAogICAgICAgIH0pOwogICAgICAgIGJyZWFrCiAgICB9CiAgfSk7Cgp9KSgpOwoK",null,!1);function _createSuper$4(e){var t=_isNativeReflectConstruct$4();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$4(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var MAX_DECODE_ONCE_DEFAULT$1=20,WebCodecDecodeController=function(e){_inherits(r,e);var t=_createSuper$4(r);function r(){var e;_classCallCheck$1(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty$1(_assertThisInitialized(e=t.call.apply(t,[this].concat(i))),"TAG","WebCodecController"),_defineProperty$1(_assertThisInitialized(e),"_decoderMode",4),_defineProperty$1(_assertThisInitialized(e),"_maxDecodeOnce",MAX_DECODE_ONCE_DEFAULT$1),_defineProperty$1(_assertThisInitialized(e),"_continueDecodeThreshold",MAX_DECODE_ONCE_DEFAULT$1/2),e}return _createClass$1(r,[{key:"webcodec",get:function(){return!0}},{key:"needToDecode",get:function(){return this._inDecoding?(this._checkToDecode(),0):this._continueDecodeThreshold}},{key:"_initWorker",value:function(){var e=this;logger.log(this.TAG,"start init webcodec worker");var t=new WorkerFactory$3;t.onMessage=function(t){var r,n;switch(t.data.type){case"DECODER_READY":logger.log(e.TAG,"webcodec worker ready "),e._decoderReady=!0,e._workerMessageCallback({type:"DECODER_READY"});break;case"DECODED":if(e._inDecoding=!0,(null===(r=t.data)||void 0===r||null===(n=r.info)||void 0===n?void 0:n.id)!==e._id)return;e._workerMessageCallback({type:"RECEIVE_FRAME",data:t.data});break;case"BATCH_FINISH_FLAG":if(e._inDecoding=!1,!e._workerMessageCallback)return;e._workerMessageCallback({type:"BATCH_FINISH"});break;case"CHECK_TO_DECODE":e._inDecoding=t.data.data;break;case"FAILED":e._whenError(t.data.message)}},t.onError=function(t){var r,n,i=null===(r=e._parent)||void 0===r||null===(n=r._parent)||void 0===n?void 0:n._parent;i&&i.removeChild(i.querySelector("canvas")),e._whenError(t.message)},t.addEventListener("message",t.onMessage),t.addEventListener("error",t.onError),this._decoderWorkers.push(t),this._initDecoderWithConfiguration(t,this._parent.configuration)}},{key:"_whenError",value:function(e){r.canUse=!1,this._workerErrorCallback(e)}},{key:"_initDecoderWithConfiguration",value:function(e,t){e.postMessage({msg:"configuration",data:{codec:this._parent._meta.codec,codedHeight:this._parent._meta.height,codedWidth:this._parent._meta.width,description:t}})}},{key:"_checkToDecode",value:function(){this._decoderWorkers.forEach((function(e){e.postMessage({msg:"checkDecode"})}))}},{key:"destroy",value:function(){this._decoderWorkers.forEach((function(e){e.removeEventListener("message",e.onMessage),e.removeEventListener("error",e.onError),e.postMessage({msg:"destroy"}),e.terminate()})),this._decoderWorkers=[]}}],[{key:"isSupported",value:function(){return!!window.VideoDecoder&&!1!==r.canUse}}]),r}(DecodeController),WorkerFactory$2=createBase64WorkerFactory("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi8KICAvLyDnm67liY3ku4XmlK/mjIF5dXY0MjAKCiAgZnVuY3Rpb24gc2hpbUltcG9ydFNjcmlwdHMgKHNyYykgewogICAgcmV0dXJuIGZldGNoKHNyYykKICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXMudGV4dCgpCiAgICAgIH0pCiAgICAgIC50aGVuKGZ1bmN0aW9uICh0ZXh0KSB7CiAgICAgICAgZXZhbCh0ZXh0KTsKICAgICAgICBzZWxmLk1vZHVsZSA9IE1vZHVsZTsKICAgICAgICBzZWxmLmFkZE9uUG9zdFJ1biA9IGFkZE9uUG9zdFJ1bjsKICAgICAgfSkKICB9CgogIHZhciBNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEggPSAxMDI0ICogMTAyNCAqIDI7CiAgdmFyIGluaXRUcyA9IDA7CgogIHZhciBEZWNvZGVyID0gZnVuY3Rpb24gKHNlbGYpIHsKICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7CiAgICB0aGlzLmluZm9JZCA9IDA7CiAgICB0aGlzLnNlbGYgPSBzZWxmOwogICAgdGhpcy5tZXRhID0gdGhpcy5zZWxmLm1ldGE7CiAgICB0aGlzLnRzID0gMDsKICAgIHRoaXMuaW5mb2xpc3QgPSBbXTsKICAgIHNlbGYucGFyX2Jyb2Fkd2F5T25Ccm9hZHdheUluaXRlZCA9IHRoaXMuYnJvYWR3YXlPbkJyb2Fkd2F5SW5pdGVkLmJpbmQodGhpcyk7CiAgICBzZWxmLnBhcl9icm9hZHdheU9uUGljdHVyZURlY29kZWQgPSB0aGlzLmJyb2Fkd2F5T25QaWN0dXJlRGVjb2RlZC5iaW5kKHRoaXMpOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLnRvVThBcnJheSA9IGZ1bmN0aW9uIChwdHIsIGxlbmd0aCkgewogICAgcmV0dXJuIE1vZHVsZS5IRUFQVTguc3ViYXJyYXkocHRyLCBwdHIgKyBsZW5ndGgpCiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgIE1vZHVsZS5fYnJvYWR3YXlJbml0KCk7CiAgICB0aGlzLm9mZnNldCA9IE1vZHVsZS5fYnJvYWR3YXlDcmVhdGVTdHJlYW0oTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5icm9hZHdheU9uUGljdHVyZURlY29kZWQgPSBmdW5jdGlvbiAoCiAgICBvZmZzZXQsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGluZm9pZCwKICAgIHNsaWNlVHlwZQogICkgewogICAgLy8gaWYgKHRoaXMuaW5mb2xpc3RbMF0gJiYgdGhpcy5pbmZvbGlzdFswXS5rZXkgJiYgc2xpY2VUeXBlICE9PSAyKSB7CiAgICAvLyAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAvLyAgICAgbXNnOiAnTE9HJywKICAgIC8vICAgICBsb2c6IGBkcm9wIHNhbXBsZWAKICAgIC8vICAgfSk7CiAgICAvLyAgIHJldHVybjsKICAgIC8vIH0KCiAgICB2YXIgaW5mbyA9IHRoaXMuaW5mb2xpc3Quc2hpZnQoKTsKICAgIHZhciB5Um93Y291bnQgPSBoZWlnaHQ7CiAgICB2YXIgdXZSb3djb3VudCA9IGhlaWdodCAvIDI7CiAgICB2YXIgeUxpbmVzaXplID0gd2lkdGg7CiAgICB2YXIgdXZMaW5lc2l6ZSA9IHdpZHRoIC8gMjsKICAgIGlmICh0aGlzLm1ldGEgJiYgKHRoaXMubWV0YS5jaHJvbWFGb3JtYXQgPT09IDQ0NCB8fCB0aGlzLm1ldGEuY2hyb21hRm9ybWF0ID09PSA0MjIpKSB7CiAgICAgIHV2Um93Y291bnQgPSBoZWlnaHQ7CiAgICB9CiAgICB2YXIgZGF0YSA9IHRoaXMudG9VOEFycmF5KG9mZnNldCwgeUxpbmVzaXplICogeVJvd2NvdW50ICsgMiAqICh1dkxpbmVzaXplICogdXZSb3djb3VudCkpOwogICAgLy8gdGhpcy5pbmZvbGlzdFtpbmZvaWRdID0gbnVsbDsKICAgIHZhciBkYXRldGVtcCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTsKICAgIGRhdGV0ZW1wLnNldChkYXRhKTsKICAgIHZhciBidWZmZXIgPSBkYXRldGVtcC5idWZmZXI7CgogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKAogICAgICB7CiAgICAgICAgbXNnOiAnREVDT0RFRCcsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIHlMaW5lc2l6ZSwKICAgICAgICB1dkxpbmVzaXplLAogICAgICAgIGluZm8sCiAgICAgICAgYnVmZmVyCiAgICAgIH0sCiAgICAgIFtidWZmZXJdCiAgICApOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZCA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLmluaXRlZCkgewogICAgICByZXR1cm4KICAgIH0KICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTsKICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgIG1zZzogJ0xPRycsCiAgICAgIGxvZzogJ2RlY29kZXIgaW5pdGVkJwogICAgfSk7CiAgICB2YXIgY29zdCA9IDA7CiAgICBpZiAoaW5pdFRzKSB7CiAgICAgIGNvc3QgPSBwZXJmb3JtYW5jZS5ub3coKSAtIGluaXRUczsKICAgIH0KICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7IG1zZzogJ0RFQ09ERVJfUkVBRFknLCBjb3N0IH0pOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvKSB7CiAgICBsZXQgdGltZSA9IHBhcnNlSW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpKTsKICAgIGxldCBpbmZvaWQgPSB0aW1lIC0gTWF0aC5mbG9vcih0aW1lIC8gMTBlOCkgKiAxMGU4OwogICAgdGhpcy5pbmZvbGlzdC5wdXNoKGluZm8pOwogICAgaWYgKGluZm8gJiYgaW5mby5rZXlmcmFtZSkgewogICAgICB0aGlzLmluZm9saXN0ID0gW2luZm9dOwogICAgICBNb2R1bGUuX2Jyb2Fkd2F5Rmx1c2hTdHJlYW0oaW5mb2lkKTsKICAgIH0KICAgIE1vZHVsZS5IRUFQVTguc2V0KGRhdGEsIHRoaXMub2Zmc2V0KTsKICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtKGRhdGEubGVuZ3RoLCB0aGlzLmluZm9JZCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5Rmx1c2hTdHJlYW0oKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUV4aXQoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS51cGRhdGVNZXRhID0gZnVuY3Rpb24gKG1ldGEpIHsKICAgIHRoaXMubWV0YSA9IG1ldGE7CiAgfTsKCiAgdmFyIGRlY29kZXI7CgogIGZ1bmN0aW9uIG9uUG9zdFJ1biAoKSB7CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgbXNnOiAnTE9HJywKICAgICAgbG9nOiAnZG8gcG9zdCBydW4nCiAgICB9KTsKICAgIGRlY29kZXIgPSBuZXcgRGVjb2Rlcih0aGlzKTsKICAgIGRlY29kZXIuaW5pdCgpOwogIH0KCiAgdmFyIFdBU01fQ0ROX1BBVEhfUFJFRklYID0gJyc7CgogIGZ1bmN0aW9uIGluaXQgKHVybCkgewogICAgV0FTTV9DRE5fUEFUSF9QUkVGSVggPSB1cmwuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpOwogICAgaW5pdFRzID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICB2YXIgaXNEZWdyYWRlID0gL2FzbS8udGVzdCh1cmwpOwogICAgaWYgKCFkZWNvZGVyKSB7CiAgICAgIHZhciB0YXNrOwoKICAgICAgaWYgKCFzZWxmLmltcG9ydFNjcmlwdHMpIHsKICAgICAgICB0YXNrID0gc2hpbUltcG9ydFNjcmlwdHModXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXNrID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaWYgKCFzZWxmLmNvbnNvbGUpIHsKICAgICAgICAgICAgc2VsZi5jb25zb2xlID0gewogICAgICAgICAgICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxmLmltcG9ydFNjcmlwdHModXJsKTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRhc2sKICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoaXNEZWdyYWRlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdXRvIGluc3RhbmNlIERlY29kZXIhJyk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CgogICAgICAgICAgaWYoc2VsZi5tKSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgICAgIC5tKHsKICAgICAgICAgICAgICBpbnN0YW50aWF0ZVdhc206IGZ1bmN0aW9uIChpbmZvLCByZWNlaXZlSW5zdGFuY2UpIHsKICAgICAgICAgICAgICAgIGZldGNoKGAke1dBU01fQ0ROX1BBVEhfUFJFRklYfS9kZWNvZGVyLndhc20uanNgKQogICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmFycmF5QnVmZmVyKCkpCiAgICAgICAgICAgICAgICAgIC50aGVuKGJ1ZmZlciA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGJ1ZmZlciwgaW5mbykKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWNlaXZlSW5zdGFuY2UocmVzdWx0Lmluc3RhbmNlKQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChNb2QpIHsKICAgICAgICAgICAgICBzZWxmLk1vZHVsZSA9IE1vZDsKICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICBhZGRPblBvc3RSdW4ob25Qb3N0UnVuLmJpbmQoc2VsZikpOwoKICAgICAgICAgICAgTW9kdWxlLm9uUnVudGltZUluaXRpYWxpemVkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIE1vZHVsZS5vbkFib3J0ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICByZWplY3QoZSAmJiBlLm1lc3NhZ2UgPyBlIDogbmV3IEVycm9yKCd3YXNtIGluaXQgZXJyb3InKSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCd3YXNtIGxvYWQgdGltZW91dCcpKTsKICAgICAgICAgICAgfSwgNjAwMCk7CiAgICAgICAgICB9KQoKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIG1zZzogJ0lOSVRfRkFJTEVEJywKICAgICAgICAgICAgbG9nOiBlLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQogIH0KCiAgc2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgdmFyIGRhdGEgPSBlLmRhdGE7CiAgICBpZiAoIWRhdGEubXNnKSB7CiAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgIG1zZzogJ0VSUk9SOmludmFsaWQgbWVzc2FnZScKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBpZiAoZGF0YS5tc2cgIT09ICdpbml0JyAmJiBkYXRhLm1zZyAhPT0gJ3ByZWxvYWQnICYmICFkZWNvZGVyKSByZXR1cm4KICAgICAgc3dpdGNoIChkYXRhLm1zZykgewogICAgICAgIGNhc2UgJ3ByZWxvYWQnOgogICAgICAgICAgaW5pdChkYXRhLnVybCk7CiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2luaXQnOgogICAgICAgICAgc2VsZi5tZXRhID0gZGF0YS5tZXRhOwogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIG1zZzogJ0xPRycsCiAgICAgICAgICAgIGxvZzogJ3dvcmtlciBpbml0ZWQnCiAgICAgICAgICB9KTsKICAgICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICd1cGRhdGVtZXRhJzoKICAgICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICAgIGRlY29kZXIudXBkYXRlTWV0YShkYXRhLm1ldGEpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdpbml0RGVjb2Rlcic6CiAgICAgICAgICBkZWNvZGVyLmRlY29kZShkYXRhLmRhdGEpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhLCBkYXRhLmluZm8pOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdmbHVzaCc6CiAgICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2ZpbmlzaF9mbGFnJzoKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdCQVRDSF9GSU5JU0hfRkxBRycKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZXN0b3J5JzoKICAgICAgICAgIGRlY29kZXIuZGVzdHJveSgpOwogICAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK",null,!1),WorkerFactory$1=createBase64WorkerFactory("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi8KICAvLyDnm67liY3ku4XmlK/mjIF5dXY0MjAKCiAgZnVuY3Rpb24gc2hpbUltcG9ydFNjcmlwdHMgKHNyYykgewogICAgcmV0dXJuIGZldGNoKHNyYykKICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXMudGV4dCgpCiAgICAgIH0pCiAgICAgIC50aGVuKGZ1bmN0aW9uICh0ZXh0KSB7CiAgICAgICAgZXZhbCh0ZXh0KTsKICAgICAgICBzZWxmLk1vZHVsZSA9IE1vZHVsZTsKICAgICAgICBzZWxmLmFkZE9uUG9zdFJ1biA9IGFkZE9uUG9zdFJ1bjsKICAgICAgfSkKICB9CgogIHZhciBNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEggPSAxMDI0ICogMTAyNCAqIDU7IC8vIOWIhumFjSA1TSDnqbrpl7TlrZjlgqjluKfmlbDmja4KICB2YXIgQkFUQ0hfREVDT0RFX1NJWkUgPSAxMDsgLy8g5LiA5qyh5aSE55CG55qE5bin5pWw6YePCiAgdmFyIGluaXRUcyA9IDA7CgogIHZhciBEZWNvZGVyID0gZnVuY3Rpb24gKHNlbGYpIHsKICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7CiAgICB0aGlzLmluZm9JZCA9IDA7CiAgICB0aGlzLnNlbGYgPSBzZWxmOwogICAgdGhpcy5tZXRhID0gc2VsZi5tZXRhOwogICAgdGhpcy50cyA9IDA7CiAgICB0aGlzLmluZm9saXN0ID0gW107CiAgICBzZWxmLnBhcl9icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQgPSB0aGlzLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZC5iaW5kKHRoaXMpOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkID0gdGhpcy5icm9hZHdheU9uUGljdHVyZURlY29kZWQuYmluZCh0aGlzKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS50b1U4QXJyYXkgPSBmdW5jdGlvbiAocHRyLCBsZW5ndGgpIHsKICAgIHJldHVybiBNb2R1bGUuSEVBUFU4LnN1YmFycmF5KHB0ciwgcHRyICsgbGVuZ3RoKQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5SW5pdCgpOwoKICAgIC8vIOWtmOWCqOW4p+aVsOaNrueahGJ1ZmZlcuW8gOWni+S9jee9rgogICAgdGhpcy5zdHJlYW1CdWZmZXJQdHIgPSBNb2R1bGUuX2Jyb2Fkd2F5Q3JlYXRlU3RyZWFtKE1BWF9TVFJFQU1fQlVGRkVSX0xFTkdUSCk7CiAgICB0aGlzLnN0cmVhbUJ1ZmZlciA9IHRoaXMudG9VOEFycmF5KHRoaXMuc3RyZWFtQnVmZmVyUHRyLCBNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEgpOwogICAgLy8g55So5p2l5a2Y5YKo5q+P5binc2l6ZeeahOaVsOaNrueahOW8gOWni+S9jee9rgogICAgdGhpcy5idWZmZXJTaXplc1B0ciA9IE1vZHVsZS5fbWFsbG9jKDQgKiBCQVRDSF9ERUNPREVfU0laRSk7CiAgICB0aGlzLmJ1ZmZlclNpemVzID0gdGhpcy50b1U4QXJyYXkodGhpcy5idWZmZXJTaXplc1B0ciwgNCAqIEJBVENIX0RFQ09ERV9TSVpFKTsKICAgIHRoaXMuc3RyZWFtQnVmZmVyT2Zmc2V0ID0gMDsKICAgIHRoaXMuZnJhbWVMZW5zT2Zmc2V0ID0gMDsKICAgIHRoaXMuZnJhbWVMZW5zQnVmZmVyID0gbmV3IFVpbnQzMkFycmF5KEJBVENIX0RFQ09ERV9TSVpFKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5icm9hZHdheU9uUGljdHVyZURlY29kZWQgPSBmdW5jdGlvbiAob2Zmc2V0LCB3aWR0aCwgaGVpZ2h0KSB7CiAgICB2YXIgaW5mbyA9IHRoaXMuaW5mb2xpc3Quc2hpZnQoKTsKICAgIHZhciB5Um93Y291bnQgPSBoZWlnaHQ7CiAgICB2YXIgdXZSb3djb3VudCA9IGhlaWdodCAvIDI7CiAgICB2YXIgeUxpbmVzaXplID0gd2lkdGg7CiAgICB2YXIgdXZMaW5lc2l6ZSA9IHdpZHRoIC8gMjsKICAgIGlmICh0aGlzLm1ldGEgJiYgKHRoaXMubWV0YS5jaHJvbWFGb3JtYXQgPT09IDQ0NCB8fCB0aGlzLm1ldGEuY2hyb21hRm9ybWF0ID09PSA0MjIpKSB7CiAgICAgIHV2Um93Y291bnQgPSBoZWlnaHQ7CiAgICB9CiAgICB2YXIgZGF0YSA9IHRoaXMudG9VOEFycmF5KG9mZnNldCwgeUxpbmVzaXplICogeVJvd2NvdW50ICsgMiAqICh1dkxpbmVzaXplICogdXZSb3djb3VudCkpOwogICAgLy8gdGhpcy5pbmZvbGlzdFtpbmZvaWRdID0gbnVsbDsKICAgIHZhciBkYXRldGVtcCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTsKICAgIGRhdGV0ZW1wLnNldChkYXRhKTsKICAgIHZhciBidWZmZXIgPSBkYXRldGVtcC5idWZmZXI7CgogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKAogICAgICB7CiAgICAgICAgbXNnOiAnREVDT0RFRCcsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIHlMaW5lc2l6ZSwKICAgICAgICB1dkxpbmVzaXplLAogICAgICAgIGluZm8sCiAgICAgICAgYnVmZmVyCiAgICAgIH0sCiAgICAgIFtidWZmZXJdCiAgICApOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZCA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLmluaXRlZCkgewogICAgICByZXR1cm4KICAgIH0KICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTsKICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgIG1zZzogJ0xPRycsCiAgICAgIGxvZzogJ2RlY29kZXIgaW5pdGVkJwogICAgfSk7CiAgICB2YXIgY29zdCA9IDA7CiAgICBpZiAoaW5pdFRzKSB7CiAgICAgIGNvc3QgPSBwZXJmb3JtYW5jZS5ub3coKSAtIGluaXRUczsKICAgIH0KICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7IG1zZzogJ0RFQ09ERVJfUkVBRFknLCBjb3N0IH0pOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLnN0b3JlQnVmZmVyID0gZnVuY3Rpb24gKGRhdGEsIGZJbmZvKSB7CiAgICBpZiAoZkluZm8gJiYgZkluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5mbHVzaCgpOwogICAgfQogICAgdGhpcy5pbmZvbGlzdC5wdXNoKGZJbmZvKTsKICAgIHRoaXMuc3RyZWFtQnVmZmVyLnNldChkYXRhLCB0aGlzLnN0cmVhbUJ1ZmZlck9mZnNldCk7CiAgICB0aGlzLmZyYW1lTGVuc0J1ZmZlclt0aGlzLmZyYW1lTGVuc09mZnNldF0gPSBkYXRhLmxlbmd0aDsKICAgIHRoaXMuc3RyZWFtQnVmZmVyT2Zmc2V0ICs9IGRhdGEubGVuZ3RoOwogICAgdGhpcy5mcmFtZUxlbnNPZmZzZXQgKz0gMTsKICAgIHRoaXMuYmF0Y2hEZWNvZGUoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5iYXRjaERlY29kZSA9IGZ1bmN0aW9uIChmbHVzaCkgewogICAgLy8g5pSSMTDluKflpITnkIbkuIDmrKEg5oiW6ICFIOW8uuWItuino+eggQogICAgdmFyIHRvZG8gPSB0aGlzLmZyYW1lTGVuc09mZnNldCA+PSBCQVRDSF9ERUNPREVfU0laRSB8fCAoZmx1c2ggJiYgdGhpcy5mcmFtZUxlbnNPZmZzZXQpOwogICAgaWYgKHRvZG8pIHsKICAgICAgdGhpcy5idWZmZXJTaXplcy5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5mcmFtZUxlbnNCdWZmZXIuYnVmZmVyKSwgMCk7CiAgICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtMSh0aGlzLmJ1ZmZlclNpemVzUHRyLCB0aGlzLmZyYW1lTGVuc09mZnNldCk7CiAgICAgIHRoaXMuZnJhbWVMZW5zT2Zmc2V0ID0gMDsKICAgICAgdGhpcy5zdHJlYW1CdWZmZXJPZmZzZXQgPSAwOwogICAgfQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICB0aGlzLnN0cmVhbUJ1ZmZlci5zZXQoZGF0YSk7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5UGxheVN0cmVhbShkYXRhLmxlbmd0aCwgMCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmJhdGNoRGVjb2RlKHRydWUpOwogICAgTW9kdWxlLl9icm9hZHdheUZsdXNoU3RyZWFtKCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIE1vZHVsZS5fYnJvYWR3YXlFeGl0KCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUudXBkYXRlTWV0YSA9IGZ1bmN0aW9uIChtZXRhKSB7CiAgICB0aGlzLm1ldGEgPSBtZXRhOwogIH07CgogIHZhciBkZWNvZGVyOwoKICBmdW5jdGlvbiBvblBvc3RSdW4gKCkgewogICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgIG1zZzogJ0xPRycsCiAgICAgIGxvZzogJ2RvIHBvc3QgcnVuJwogICAgfSk7CiAgICBkZWNvZGVyID0gbmV3IERlY29kZXIodGhpcyk7CiAgICBkZWNvZGVyLmluaXQoKTsKICB9CgogIHZhciBXQVNNX0NETl9QQVRIX1BSRUZJWCA9ICcnOwoKICBmdW5jdGlvbiBpbml0ICh1cmwpIHsKICAgIFdBU01fQ0ROX1BBVEhfUFJFRklYID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTsKICAgIGluaXRUcyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgaWYgKCFkZWNvZGVyKSB7CiAgICAgIHZhciB0YXNrOwoKICAgICAgaWYgKCFzZWxmLmltcG9ydFNjcmlwdHMpIHsKICAgICAgICB0YXNrID0gc2hpbUltcG9ydFNjcmlwdHModXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXNrID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaWYgKCFzZWxmLmNvbnNvbGUpIHsKICAgICAgICAgICAgc2VsZi5jb25zb2xlID0gewogICAgICAgICAgICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxmLmltcG9ydFNjcmlwdHModXJsKTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRhc2sKICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZmV0Y2goV0FTTV9DRE5fUEFUSF9QUkVGSVggKyAnL2RlY29kZXIud29ya2VyLmpzJykKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIHJldHVybiByZXMuYmxvYigpCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChibG9iKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHNlbGYubSh7CiAgICAgICAgICAgICAgICBsb2NhdGVGaWxlOiBmdW5jdGlvbiAoc3VmZml4KSB7CiAgICAgICAgICAgICAgICAgIGlmICgvXC53b3JrZXJcLmpzJC8udGVzdChzdWZmaXgpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoL1wud2FzbSQvLnRlc3Qoc3VmZml4KSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBXQVNNX0NETl9QQVRIX1BSRUZJWCArICcvZGVjb2Rlci53YXNtJwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmICgvXC5tZW0kLy50ZXN0KHN1ZmZpeCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gV0FTTV9DRE5fUEFUSF9QUkVGSVggKyAnL2RlY29kZXIuanMubWVtJwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbWFpblNjcmlwdFVybE9yQmxvYjogV0FTTV9DRE5fUEFUSF9QUkVGSVggKyAnL2RlY29kZXIuanMnCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKE1vZCkgewogICAgICAgICAgICAgIHNlbGYuTW9kdWxlID0gTW9kOwogICAgICAgICAgICAgIG9uUG9zdFJ1bi5jYWxsKHNlbGYpOwogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgbXNnOiAnSU5JVF9GQUlMRUQnLAogICAgICAgICAgICBsb2c6IGUubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgZGF0YSA9IGUuZGF0YTsKICAgIGlmICghZGF0YS5tc2cpIHsKICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgbXNnOiAnRVJST1I6aW52YWxpZCBtZXNzYWdlJwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChkYXRhLm1zZyAhPT0gJ2luaXQnICYmIGRhdGEubXNnICE9PSAncHJlbG9hZCcgJiYgIWRlY29kZXIpIHJldHVybgogICAgICBzd2l0Y2ggKGRhdGEubXNnKSB7CiAgICAgICAgY2FzZSAncHJlbG9hZCc6CiAgICAgICAgICBpbml0KGRhdGEudXJsKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnaW5pdCc6CiAgICAgICAgICBzZWxmLm1ldGEgPSBkYXRhLm1ldGE7CiAgICAgICAgICBCQVRDSF9ERUNPREVfU0laRSA9IGRhdGEuYmF0Y2hEZWNvZGVDb3VudDsKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdMT0cnLAogICAgICAgICAgICBsb2c6ICd3b3JrZXIgaW5pdGVkJwogICAgICAgICAgfSk7CiAgICAgICAgICBpbml0KGRhdGEudXJsKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAndXBkYXRlbWV0YSc6CiAgICAgICAgICBzZWxmLm1ldGEgPSBkYXRhLm1ldGE7CiAgICAgICAgICBkZWNvZGVyLnVwZGF0ZU1ldGEoZGF0YS5tZXRhKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnaW5pdERlY29kZXInOgogICAgICAgICAgaWYgKGRlY29kZXIuZnJhbWVMZW5zT2Zmc2V0KSB7CiAgICAgICAgICAgIGRlY29kZXIuYmF0Y2hEZWNvZGUodHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgICBkZWNvZGVyLmRlY29kZShkYXRhLmRhdGEpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgICAgZGVjb2Rlci5zdG9yZUJ1ZmZlcihkYXRhLmRhdGEsIGRhdGEuaW5mbyk7CiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2ZpbmlzaF9mbGFnJzoKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdCQVRDSF9GSU5JU0hfRkxBRycKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZXN0b3J5JzoKICAgICAgICAgIGRlY29kZXIuZGVzdHJveSgpOwogICAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK",null,!1),WorkerFactory=createBase64WorkerFactory("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi8KCiAgZnVuY3Rpb24gc2hpbUltcG9ydFNjcmlwdHMgKHNyYykgewogICAgcmV0dXJuIGZldGNoKHNyYykKICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXMudGV4dCgpCiAgICAgIH0pCiAgICAgIC50aGVuKGZ1bmN0aW9uICh0ZXh0KSB7CiAgICAgICAgZXZhbCh0ZXh0KTsKICAgICAgICBzZWxmLk1vZHVsZSA9IE1vZHVsZTsKICAgICAgICBzZWxmLmFkZE9uUG9zdFJ1biA9IGFkZE9uUG9zdFJ1bjsKICAgICAgfSkKICB9CgogIHZhciBNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEggPSAxMDI0ICogMTAyNDsKICB2YXIgaW5pdFRzID0gMDsKCiAgdmFyIERlY29kZXIgPSBmdW5jdGlvbiAoc2VsZikgewogICAgdGhpcy5pbml0ZWQgPSBmYWxzZTsKICAgIHRoaXMuc2VsZiA9IHNlbGY7CiAgICB0aGlzLm1ldGEgPSBzZWxmLm1ldGE7CiAgICB0aGlzLmluZm9saXN0ID0gW107CiAgICBzZWxmLnBhcl9icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQgPSB0aGlzLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZC5iaW5kKHRoaXMpOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkID0gdGhpcy5icm9hZHdheU9uUGljdHVyZURlY29kZWQuYmluZCh0aGlzKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS50b1U4QXJyYXkgPSBmdW5jdGlvbiAocHRyLCBsZW5ndGgpIHsKICAgIHJldHVybiBNb2R1bGUuSEVBUFU4LnN1YmFycmF5KHB0ciwgcHRyICsgbGVuZ3RoKQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5SW5pdCgpOwogICAgdGhpcy5zdHJlYW1CdWZmZXIgPSB0aGlzLnRvVThBcnJheSgKICAgICAgTW9kdWxlLl9icm9hZHdheUNyZWF0ZVN0cmVhbShNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEgsIDApLCAvLyAwOiDlhbPpl60gZmZtcGVnIGxvZywKICAgICAgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RICiAgICApOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25QaWN0dXJlRGVjb2RlZCA9IGZ1bmN0aW9uICgKICAgIG9mZnNldCwKICAgIHdpZHRoLAogICAgaGVpZ2h0LAogICAgeUxpbmVzaXplLAogICAgdXZMaW5lc2l6ZSwKICAgIGluZm9pZCwKICAgIGtleUZyYW1lCiAgKSB7CiAgICBsZXQgZmlyc3RGcmFtZSA9IHRoaXMuaW5mb2xpc3RbMF07CiAgICBpZiAoZmlyc3RGcmFtZSAmJiBmaXJzdEZyYW1lLmtleWZyYW1lICYmICFrZXlGcmFtZSkgcmV0dXJuCgogICAgbGV0IGluZm8gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmluZm9saXN0LnNoaWZ0KCkpOwogICAgbGV0IHlSb3djb3VudCA9IGhlaWdodDsKICAgIGxldCB1dlJvd2NvdW50ID0gaGVpZ2h0IC8gMjsKICAgIGlmICgKICAgICAgdGhpcy5tZXRhICYmCiAgICAgICh0aGlzLm1ldGEuY2hyb21hRm9ybWF0ID09PSA0NDQgfHwgdGhpcy5tZXRhLmNocm9tYUZvcm1hdCA9PT0gNDIyKQogICAgKSB7CiAgICAgIHV2Um93Y291bnQgPSBoZWlnaHQ7CiAgICB9CiAgICB2YXIgZGF0YSA9IHRoaXMudG9VOEFycmF5KG9mZnNldCwgeUxpbmVzaXplICogeVJvd2NvdW50ICsgMiAqICh1dkxpbmVzaXplICogdXZSb3djb3VudCkpOwogICAgdmFyIGRhdGV0ZW1wID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGgpOwogICAgZGF0ZXRlbXAuc2V0KGRhdGEpOwogICAgdmFyIGJ1ZmZlciA9IGRhdGV0ZW1wLmJ1ZmZlcjsKCiAgICB0aGlzLnNlbGYucG9zdE1lc3NhZ2UoCiAgICAgIHsKICAgICAgICBtc2c6ICdERUNPREVEJywKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQsCiAgICAgICAgeUxpbmVzaXplLAogICAgICAgIHV2TGluZXNpemUsCiAgICAgICAgaW5mbywKICAgICAgICBidWZmZXIKICAgICAgfSwKICAgICAgW2J1ZmZlcl0KICAgICk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuYnJvYWR3YXlPbkJyb2Fkd2F5SW5pdGVkID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5pbml0ZWQgPSB0cnVlOwogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgbXNnOiAnTE9HJywKICAgICAgbG9nOiAnZGVjb2RlciBpbml0ZWQnCiAgICB9KTsKICAgIHZhciBjb3N0ID0gMDsKICAgIGlmIChpbml0VHMpIHsKICAgICAgY29zdCA9IHBlcmZvcm1hbmNlLm5vdygpIC0gaW5pdFRzOwogICAgfQogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKHsgbXNnOiAnREVDT0RFUl9SRUFEWScsIGNvc3QgfSk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlID0gZnVuY3Rpb24gKGRhdGEsIGluZm8pIHsKICAgIGlmIChpbmZvKSB7CiAgICAgIHRoaXMuaW5mb2xpc3QucHVzaChpbmZvKTsKICAgIH0KICAgIGlmIChpbmZvICYmIGluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5pbmZvbGlzdCA9IFtpbmZvXTsKICAgIH0KICAgIHRoaXMuc3RyZWFtQnVmZmVyLnNldChkYXRhKTsKICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtKGRhdGEubGVuZ3RoLCAwKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUV4aXQoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS51cGRhdGVNZXRhID0gZnVuY3Rpb24gKG1ldGEpIHsKICAgIHRoaXMubWV0YSA9IG1ldGE7CiAgfTsKCiAgdmFyIGRlY29kZXI7CgogIGZ1bmN0aW9uIG9uUG9zdFJ1biAoKSB7CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgbXNnOiAnTE9HJywKICAgICAgbG9nOiAnZG8gcG9zdCBydW4nCiAgICB9KTsKCiAgICBkZWNvZGVyID0gbmV3IERlY29kZXIodGhpcyk7CiAgICBkZWNvZGVyLmluaXQoKTsKICB9CgogIHZhciBXQVNNX0NETl9QQVRIX1BSRUZJWCA9ICcnOwoKICBmdW5jdGlvbiBpbml0ICh1cmwpIHsKICAgIFdBU01fQ0ROX1BBVEhfUFJFRklYID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTsKICAgIGluaXRUcyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgdmFyIGlzRGVncmFkZSA9IC9hc20vLnRlc3QodXJsKTsKICAgIGlmICghZGVjb2RlcikgewogICAgICB2YXIgdGFzazsKICAgICAgaWYgKCFzZWxmLmltcG9ydFNjcmlwdHMpIHsKICAgICAgICB0YXNrID0gc2hpbUltcG9ydFNjcmlwdHModXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXNrID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaWYgKCFzZWxmLmNvbnNvbGUpIHsKICAgICAgICAgICAgc2VsZi5jb25zb2xlID0gewogICAgICAgICAgICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxmLmltcG9ydFNjcmlwdHModXJsKTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRhc2sKICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoaXNEZWdyYWRlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdXRvIGluc3RhbmNlIERlY29kZXIhJyk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICAgICAgLm0oewogICAgICAgICAgICAgIGluc3RhbnRpYXRlV2FzbTogZnVuY3Rpb24gKGluZm8sIHJlY2VpdmVJbnN0YW5jZSkgewogICAgICAgICAgICAgICAgZmV0Y2goYCR7V0FTTV9DRE5fUEFUSF9QUkVGSVh9L2RlY29kZXIud2FzbS5qc2ApCiAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSkKICAgICAgICAgICAgICAgICAgLnRoZW4oYnVmZmVyID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUoYnVmZmVyLCBpbmZvKQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVJbnN0YW5jZShyZXN1bHQuaW5zdGFuY2UpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKE1vZCkgewogICAgICAgICAgICAgIHNlbGYuTW9kdWxlID0gTW9kOwogICAgICAgICAgICAgIG9uUG9zdFJ1bi5jYWxsKHNlbGYpOwogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgbXNnOiAnSU5JVF9GQUlMRUQnLAogICAgICAgICAgICBsb2c6IGUubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgZGF0YSA9IGUuZGF0YTsKICAgIGlmICghZGF0YS5tc2cpIHsKICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgbXNnOiAnRVJST1I6aW52YWxpZCBtZXNzYWdlJwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGlmICgoZGF0YS5tc2cgIT09ICdpbml0JyAmJiBkYXRhLm1zZyAhPT0gJ3ByZWxvYWQnKSAmJiAhZGVjb2RlcikgcmV0dXJuCiAgICAgIHN3aXRjaCAoZGF0YS5tc2cpIHsKICAgICAgICBjYXNlICdwcmVsb2FkJzoKICAgICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdpbml0JzoKICAgICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdMT0cnLAogICAgICAgICAgICBsb2c6ICd3b3JrZXIgaW5pdGVkJwogICAgICAgICAgfSk7CiAgICAgICAgICBpbml0KGRhdGEudXJsKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAndXBkYXRlbWV0YSc6CiAgICAgICAgICBzZWxmLm1ldGEgPSBkYXRhLm1ldGE7CiAgICAgICAgICBkZWNvZGVyLnVwZGF0ZU1ldGEoZGF0YS5tZXRhKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnaW5pdERlY29kZXInOgogICAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnZGVjb2RlJzoKICAgICAgICAgIGRlY29kZXIuZGVjb2RlKGRhdGEuZGF0YSwgZGF0YS5pbmZvKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnZmluaXNoX2ZsYWcnOgogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIG1zZzogJ0JBVENIX0ZJTklTSF9GTEFHJwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2Rlc3RvcnknOgogICAgICAgICAgZGVjb2Rlci5kZXN0cm95KCk7CiAgICAgICAgICBicmVhawogICAgICB9CiAgICB9CiAgfTsKCn0pKCk7Cgo=",null,!1),EleName="live-video";function getDecoderUrls(){var e=customElements.get(EleName);return e?{H264_DECODER_URL:e.h264Url,ASM_H264_DECODER_URL:e.h264AsmUrl,H265_DECODER_URL:e.h265Url,H265_THREAD_DECODER_URL:e.h265ThreadUrl,ASM_H265_DECODER_URL:e.h265AsmUrl}:{}}function threadSupported(){var e=customElements.get(EleName);return!!window.SharedArrayBuffer&&(null==e?void 0:e.h265ThreadUrl)}function preloadWorker(){var e;return(null===(e=customElements.get(EleName))||void 0===e?void 0:e.preloadWorker)||!1}function _createSuper$3(e){var t=_isNativeReflectConstruct$3();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$3(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var CAN_USE_HEVC_THREAD_DECODE=threadSupported(),MAX_DECODE_ONCE_FAST=80,MAX_DECODE_ONCE_DEFAULT=12,workerCached=[],WasmDecodeController=function(e){_inherits(r,e);var t=_createSuper$3(r);function r(e){var n;return _classCallCheck$1(this,r),_defineProperty$1(_assertThisInitialized(n=t.call(this,e)),"TAG","WasmController"),_defineProperty$1(_assertThisInitialized(n),"_avccpushed",!1),_defineProperty$1(_assertThisInitialized(n),"_maxDecodeOnce",MAX_DECODE_ONCE_DEFAULT),_defineProperty$1(_assertThisInitialized(n),"_continueDecodeThreshold",MAX_DECODE_ONCE_DEFAULT/2),_defineProperty$1(_assertThisInitialized(n),"_wasmInitCost",0),_defineProperty$1(_assertThisInitialized(n),"_decoderMode",window.WebAssembly?2:3),n._preload=n._parent.preloadWasmWorker,n._preloadWorker(),n}return _createClass$1(r,[{key:"wasmInitCost",get:function(){return this._decoderWorkers.length?this._decoderWorkers[0]._wasmInitCost:0}},{key:"isHevc",get:function(){var e;return this._preload?"h265"===this._preload:null===(e=this._parent)||void 0===e?void 0:e.isHevc}},{key:"_preloadWorker",value:function(){if(this._preload&&!workerCached.length){logger.log(this.TAG,"preload worker");var e=this._selectDecodeWorker()||{},t=e.decoder,r=e.url;t&&(this._avccpushed=!1,this._bindWorkerEvent(t),t.postMessage({msg:"preload",batchDecodeCount:10,url:r}),this._decoderWorkers.push(t))}}},{key:"_selectDecodeWorker",value:function(){var e,t=getDecoderUrls(),r=t.H264_DECODER_URL,n=t.H265_DECODER_URL,i=t.H265_THREAD_DECODER_URL,o=t.ASM_H264_DECODER_URL,a=t.ASM_H265_DECODER_URL;return logger.log(this.TAG,"start init wasm worker:",performance.now(),"hevc:",this.isHevc,"decoderMode:",this._decoderMode),this.isHevc?(e=3===this._decoderMode?a:1===this._decoderMode?i:n)?{decoder:1===this._decoderMode?new WorkerFactory$1:new WorkerFactory$2,url:e}:void this._workerErrorCallback("no found decoder url, decodeMode:".concat(this._decoderMode)):(e=3===this._decoderMode?o:r)?{decoder:new WorkerFactory,url:e}:void this._workerErrorCallback("no found decoder url, decodeMode:".concat(this._decoderMode))}},{key:"_initWorker",value:function(){var e=this;this._decoderReady&&this._workerMessageCallback({type:"DECODER_READY"}),CAN_USE_HEVC_THREAD_DECODE&&this.isHevc&&(this._decoderMode=1),this._decoderWorkers.length?this._decoderReady&&this._decoderWorkers.forEach((function(t){e._initDecoderWithConfiguration(t,e.meta)})):this._initDecodeWorkerInternal()}},{key:"_initDecodeWorkerInternal",value:function(e){var t=this._selectDecodeWorkerFromCache().decoder;if(t)return logger.warn(this.TAG,"select decoder from cache"),this._avccpushed=!1,this._bindWorkerEvent(t),this._decoderReady=!0,e||this._decoderWorkers.push(t),this._initDecoderWithConfiguration(t,this.meta),void this._workerMessageCallback({type:"DECODER_READY",data:t});var r=this._selectDecodeWorker()||{},n=r.decoder,i=r.url;n&&(this._avccpushed=!1,this._bindWorkerEvent(n),n.postMessage({msg:"init",meta:this.meta,batchDecodeCount:10,url:i}),e||this._decoderWorkers.push(n))}},{key:"_selectDecodeWorkerFromCache",value:function(){return{decoder:workerCached.pop()}}},{key:"_bindWorkerEvent",value:function(e){var t=this,r=function(r,n){if(3===t._decoderMode)t._workerErrorCallback(r);else{if(logger.log(t.TAG,"use asm: ",r,n),t._decoderMode=1===t._decoderMode?2:3,t._destroyWorker(e),!t.meta)return;t._initDecodeWorkerInternal()}};e.onMessage=function(n){var i,o;switch(n.data.msg){case"DECODER_READY":if(logger.log(t.TAG,"wasm worker ready ",performance.now(),"cost:",n.data.cost),t._decoderReady=!0,e._wasmInitCost=parseInt(n.data.cost),!t.meta)return;t._avccpushed||t._initDecoderWithConfiguration(e,t.meta),t.emit(Events.VIDEO.VIDEO_DECODER_INIT,e),t._workerMessageCallback({type:"DECODER_READY",data:e});break;case"DECODED":if(t._inDecoding=!0,(null===(i=n.data)||void 0===i||null===(o=i.info)||void 0===o?void 0:o.id)!==t._id)return;t._workerMessageCallback({type:"RECEIVE_FRAME",data:n.data});break;case"BATCH_FINISH_FLAG":if(e.using=0,t._inDecoding=!1,!t._workerMessageCallback)return;t._workerMessageCallback({type:"BATCH_FINISH"});break;case"INIT_FAILED":r(n.data.log,1)}},e.onError=function(e){r(e.message,2)},e.addEventListener("message",e.onMessage),e.addEventListener("error",e.onError)}},{key:"addDecodeWorker",value:function(){var e=this;this._initDecodeWorkerInternal(!0);var t=this._parent,r=t._timeRange,n=t._decodeEstimate,i=t.gopLength;return new Promise((function(t){e.once(Events.VIDEO.VIDEO_DECODER_INIT,(function(o){if(console.log("多worker 开始!"),!(e._decoderWorkers.length>=2)){var a=r.nextFrame();((a?a.gopId:0)-1)%2?e._decoderWorkers.unshift(o):e._decoderWorkers.push(o);var s=Math.max(Math.min(2*i,120),MAX_DECODE_ONCE_FAST);e._maxDecodeOnce=s,e._continueDecodeThreshold=parseInt(s/2),logger.log(e.TAG,"maxDecodeOnce = ".concat(s)),n.reset(),t()}}))}))}},{key:"_initDecoderWithConfiguration",value:function(e,t){logger.log(this.TAG,"init decoder with configuration"),this._avccpushed=!0,e.postMessage({msg:"updatemeta",meta:t});var r=t.rawVps||t.vps[0],n=t.rawSps||t.sps[0],i=t.rawPps||t.pps[0];if(r){var o=new Uint8Array(r.byteLength+4);o.set([0,0,0,1]),o.set(r,4),e.postMessage({msg:"initDecoder",data:o})}var a=new Uint8Array(n.byteLength+4);a.set([0,0,0,1]),a.set(n,4),e.postMessage({msg:"initDecoder",data:a}),(a=new Uint8Array(i.byteLength+4)).set([0,0,0,1]),a.set(i,4),e.postMessage({msg:"initDecoder",data:a})}},{key:"destroy",value:function(e){if(e&&!workerCached.length&&!this.isHevc&&1===this._decoderWorkers.length){var t=this._decoderWorkers.pop();return t._timer&&clearTimeout(t._timer),t.removeEventListener("message",t.onMessage),t.removeEventListener("error",t.onError),void workerCached.push(t)}this._destroyWorker()}},{key:"_destroyInternal",value:function(e){e._timer&&clearTimeout(e._timer),e.removeEventListener("message",e.onMessage),e.removeEventListener("error",e.onError),e.postMessage({msg:"destroy"}),e.terminate(),this._decoderWorkers=this._decoderWorkers.filter((function(t){return t!==e}))}},{key:"_destroyWorker",value:function(e){var t=this;logger.log(this.TAG,"destroy worker..."),e?this._destroyInternal(e):(this._decoderWorkers.forEach((function(e){t._destroyInternal(e)})),this._decoderWorkers=[])}}]),r}(DecodeController);function _createSuper$2(e){var t=_isNativeReflectConstruct$2();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$2(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var VideoRenderWithDecoder=function(t){_inherits(n,t);var r=_createSuper$2(n);function n(t,i){var o;return _classCallCheck$1(this,n),_defineProperty$1(_assertThisInitialized(o=r.call(this,t,i)),"preloadWasmWorker",preloadWorker()),_defineProperty$1(_assertThisInitialized(o),"_decoderErrorCallback",(function(e){o._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",o._assembleErr(e))})),_defineProperty$1(_assertThisInitialized(o),"_decoderMessageCallback",(function(t){var r,n,i=t.type,a=t.data;switch(i){case"DECODER_READY":if(!o._frameRender){var s=Object.assign(o._config,{meta:o._meta,canvas:o._canvas,type:o._decodeController.webcodec?"2d":""});try{o._frameRender=new YUVCanvas(s,_assertThisInitialized(o)),logger.log(o.TAG,"create frameRender with config",s)}catch(e){o._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,"error",o._assembleErr(e&&e.message))}}o._startDecode();break;case"RECEIVE_FRAME":if(o._inChaseFrame&&(null===(r=o._decodeController)||void 0===r||!r.webcodec))return;o._receiveFrame(a);break;case"BATCH_FINISH":null===(n=_assertThisInitialized(o))||void 0===n||n._decodeEstimate.resetDecodeDot(),o._inChaseFrame&&(o._inChaseFrame=!1,o._frameQueue.empty())}})),o.TAG="VideoRenderWithDecoder",o._recentMeta=null,o.preloadWasmWorker&&(o._decodeController=new WasmDecodeController(_assertThisInitialized(o))),o}return _createClass$1(n,[{key:"wasmInitCost",get:function(){var e;return null===(e=this._decodeController)||void 0===e?void 0:e.wasmInitCost}},{key:"hevcThread",get:function(){return 1===this.decodeMode}},{key:"lowlatency",get:function(){return this._parent.lowlatency}},{key:"switchToMultiWorker",value:function(){var e;null===(e=this._decodeController)||void 0===e||e.addDecodeWorker()}},{key:"ajustSeekTime",value:function(e){var t;logger.log(this.TAG,"ajust seek time: ",e),null===(t=this._decodeController)||void 0===t||t.flushDecoder(),this._switchVideoBuffer(e)}},{key:"canSeek",value:function(){return!0}},{key:"_bindEvents",value:function(){var e,t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),this.on(Events.VIDEO.VIDEO_WAITING,(function(){if(0!==t.bitrate){clearInterval(e);var r=1;e=setInterval((function(){logger.log(t.TAG,"卡顿",r),console.log(t.TAG,"卡顿",r),r++,t.bitrate=t.bitrate/r,t.bitrate<4e4&&(t.bitrate=0,clearInterval(e))}),1e3)}})),this._parent.on(Events.TIMELINE.START_RENDER,(function(){clearInterval(e)})),this._parent.on(Events.TIMELINE.DESTROY,(function(){clearInterval(e)}))}},{key:"_appendChunk",value:function(e){var t;if(!this.noVideo&&this._timeRange){if(this._meta){if(this._recentMeta.width!==e.width||this._recentMeta.height!==e.height){logger.warn(this.TAG,"metadata changed! width: ".concat(this._recentMeta.width," -> ").concat(e.width,", height: ").concat(this._recentMeta.height," -> ").concat(e.height));var r=e.samples[0];r&&(this._recentMeta=r.meta=Object.assign({},e,{samples:null}))}}else{this._recentMeta=this._meta=Object.assign({},e,{samples:null}),logger.warn(this.TAG,"video set metadata",this._meta,"configuration:",this.configuration);var n=e.fpsNum/e.fpsDen;n?logger.log(this.TAG,"detect fps:",n):logger.warn(this.TAG,"no detect fps,start estimate"),this._selectDecoder(),this._initDecoder()}var i;if(this._timeRange.append(e.samples,this._isLive&&this.noAudio,!this.videoDecode),e.samples=[],e.samples=[],this.isLive||this._timeRange.frameLength||this._switchVideoBuffer(this._parent.currentTime),!this._ready&&null!==(t=this._decodeController)&&void 0!==t&&t.decoderReady)!this.noAudio&&null!==(i=this._decodeController)&&void 0!==i&&i.inDecoding||this._startDecode();this.noAudio&&this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.DURATION_CHANGE)}}},{key:"_selectDecoder",value:function(){if(!this.preloadWasmWorker)return!this.isHevc&&WebCodecDecodeController.isSupported()?(this._decodeController=new WebCodecDecodeController(this),void(this._decodeEstimate.webcodec=!0)):void(this._decodeController=new WasmDecodeController(this))}},{key:"_initDecoder",value:function(){var e;null===(e=this._decodeController)||void 0===e||e.init(this._decoderMessageCallback,this._decoderErrorCallback)}},{key:"_startDecode",value:function(){var e;null===(e=this._decodeController)||void 0===e||e.doDecode()}},{key:"_switchVideoBuffer",value:function(e){this._timeRange.switchBuffer(e),this._startDecode()}},{key:"_checkToDecode",value:function(){var e,t,r;(null!==(e=this._decodeController)&&void 0!==e&&e.webcodec?this._frameQueue.length<=(null===(t=this._decodeController)||void 0===t?void 0:t.needToDecode):this._frameQueue.length<(null===(r=this._decodeController)||void 0===r?void 0:r.needToDecode))&&this._startDecode()}},{key:"_render",value:function(e){var t;if(!this.noVideo){var r=this._frameQueue&&this._frameQueue.nextFrame();if(r){var n=r.info;if(!n)return this._frameQueue.shift(),void console.error("not info");this._renderDts=n.dts;var i=n.dts-this.preciseVideoDts;if(!(!e&&i>0&&i<1e3)){this._frameQueue.shift(this.preciseVideoDts),Math.abs(this._lastTimeupdate-n.dts)>250&&(this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE,{pts:n.originPts/90}),this._lastTimeupdate=n.dts),logger.long&&logger.log(this.TAG,"render delay:".concat(i," , timelinePosition:").concat(this.preciseVideoDts," , dts:").concat(n.dts," , cost:").concat(n.cost," , gopID:").concat(n.gopId," , rest:").concat(this._frameQueue.length,", buffer frame:").concat(this._timeRange.frameLength));var o=performance.now();this._frameRender.render(r.buffer,r.width,r.height,r.yLinesize,r.uvLinesize),null!==(t=this._decodeController)&&void 0!==t&&t.webcodec&&r.buffer.close(),this._renderCost=performance.now()-o,this._checkToDecode()}}else{var a;if(logger.log(this.TAG,"lack frame",null===(a=this._decodeController)||void 0===a?void 0:a.inDecoding),this._checkToDecode(),this.noAudio){if(!this.isLive&&Math.abs(this.currentTime-this.duration)<.5)return null==this||this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE),void(null==this||this._emitTimelineEvents(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.ENDED));this._timeRange.frameLength||(this._ready=!1,this.emit(Events.VIDEO.VIDEO_WAITING))}}}}},{key:"_updateSegmentEnd",value:function(e){var t;null===(t=this._timeRange)||void 0===t||t.updateSegmentEnd(e)}},{key:"_doChaseFrame",value:function(e){var t=e.frame;this._inChaseFrame=!0,this._timeRange.deletePassed(t.dts),this._frameQueue.empty()}},{key:"_destroy",value:function(e){var t;logger.log(this.TAG,"destroy video decoder"),_get(_getPrototypeOf(n.prototype),"destroy",this).call(this),null===(t=this._decodeController)||void 0===t||t.destroy(e),this._decodeController=null}}]),n}(VideoBaseRender);function _createSuper$1(e){var t=_isNativeReflectConstruct$1();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct$1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var TimeLine=function(e){_inherits(r,e);var t=_createSuper$1(r);function r(e,n){var i;return _classCallCheck$1(this,r),(i=t.call(this)).TAG="TimeLine",i._parent=n,i._seeking=!1,i.audioRender=new AudioRender(e,_assertThisInitialized(i)),i.videoRender=i._getController(n.videoDecode,e),i._readyStatus={audio:!1,video:!1},i._paused=!0,i._switchToMultiWorker=!1,i._lowdecodeEmited=!1,i._lastSeekTime=0,i._singleTrack=-1,i._bindEvent(),i._parent.updateCanplayStatus(i.currentAudioCanAutoplay),i._decodeVideo=e.video,i}return _createClass$1(r,[{key:"ready",get:function(){return this._readyStatus.video&&this._readyStatus.audio}},{key:"played",get:function(){var e=this;return{length:this.currentTime?1:0,start:function(){return 0},end:function(){return e.currentTime}}}},{key:"noAudio",get:function(){return 1===this._singleTrack||2===this._singleTrack}},{key:"seeking",get:function(){return this._seeking}},{key:"decodeFps",get:function(){return this.videoRender.decodeFps}},{key:"decodeCost",get:function(){return this.videoRender.decodeCost}},{key:"renderCost",get:function(){return this.videoRender.renderCost}},{key:"wasmInitCost",get:function(){return this.videoRender.wasmInitCost}},{key:"fps",get:function(){return this.videoRender.fps}},{key:"totalSize",get:function(){return this.videoRender.totalSize}},{key:"bitrate",get:function(){return this.videoRender.bitrate}},{key:"gopLength",get:function(){return this.videoRender.gopLength}},{key:"currentTime",get:function(){return this.noAudio?this.videoRender.currentTime:this.audioRender.currentTime}},{key:"timelinePosition",get:function(){return this.noAudio?performance.now()/1e3:this.audioRender.currentTime}},{key:"canvas",get:function(){return this.videoRender.canvas}},{key:"readyState",get:function(){return this.videoRender.readyState}},{key:"buffered",get:function(){return this.noAudio?this.videoRender.buffered:this.audioRender.buffered}},{key:"duration",get:function(){return this.noAudio?this.videoRender.duration:this.audioRender.duration}},{key:"paused",get:function(){return this._paused},set:function(e){this._paused=e}},{key:"lowlatency",get:function(){return this._parent.lowlatency}},{key:"decoderMode",get:function(){return this.videoRender.decoderMode}},{key:"audioCanAutoplay",get:function(){return this._parent._audioCanAutoplay}},{key:"currentAudioCanAutoplay",get:function(){return this.audioRender.audioCanAutoplay}},{key:"_getController",value:function(e,t){return e?new VideoRenderFromVideo(t,this):new VideoRenderWithDecoder(t,this)}},{key:"_resetReadyStatus",value:function(){this._readyStatus.audio=!1,this._readyStatus.video=!1}},{key:"_bindEvent",value:function(){var e=this;this.on(Events.DECODE_EVENTS.REMUX,(function(t){e.videoRender.setRemux(t)})),this.on(Events.DECODE_EVENTS.CHASE_VIDEO_FRAME_END,(function(t){e.emit(Events.DECODE_EVENTS.CHASE_AUDIO_FRAME,t)})),this.audioRender.on(Events.AUDIO.AUDIO_READY,(function(){logger.log(e.TAG,"audio ready!"),e._readyStatus.video&&e._startRender(),e._readyStatus.audio=!0})),this.audioRender.on(Events.AUDIO.AUDIO_WAITING,(function(){e.noAudio||(logger.warn(e.TAG,"lack data, audio waiting,currentTime:",e.currentTime),e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE),e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.WAITING),e.emit(Events.TIMELINE.DO_PAUSE),e._readyStatus.audio=!1)})),this.videoRender.on(Events.VIDEO.VIDEO_WAITING,(function(){logger.warn(e.TAG,"lack data, video waiting"),e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.WAITING),e.emit(Events.TIMELINE.DO_PAUSE),e._readyStatus.video=!1})),this.videoRender.on(Events.VIDEO.VIDEO_READY,(function(){logger.log(e.TAG,"video ready!"),e._readyStatus.audio&&e._startRender("video"),e._readyStatus.video=!0})),this.videoRender.on(Events.VIDEO.DECODE_LOW_FPS,(function(){e.currentTime<2||e._lowdecodeEmited||(e._lowdecodeEmited=!0,e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.LOW_DECODE))})),this.on(Events.TIMELINE.ADJUST_SEEK_TIME,(function(t){e.videoRender.ajustSeekTime(t)})),this.on(Events.TIMELINE.SINGLE_TRACK,(function(t){e._singleTrack=t,1!==t&&2!==t||(e._readyStatus.audio=!0),3===t&&(e._readyStatus.video=!0),e.emit(Events.TIMELINE.SYNC_DTS,0)})),this.on(Events.TIMELINE.DESTROY,(function(){e.removeAllListeners(),e.videoRender=null,e.audioRender=null})),this.on(Events.TIMELINE.DO_PLAY,(function(t){e._parent.startPlayed||(e._parent.startPlayed=!0,e.emit(Events.TIMELINE.START_RENDER)),e._paused=!1}))}},{key:"_startRender",value:function(e){if(!this._parent.error&&this.videoRender){if(this.noAudio&&this.emit(Events.TIMELINE.SYNC_DTS,0),logger.warn(this.TAG,"startRender: time=",this.currentTime,"paused:",this.paused,"seeking:",this.seeking),this.videoRender.forceRender(),!this._parent.live&&this._paused&&this.seeking)return this._seeking=!1,void this.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.SEEKED);this.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.CANPLAY),this._parent.startPlayed||this.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.FIRST_FRAME),(this._parent.autoplay||this._parent.startPlayed)&&(this._parent.startPlayed=!0,this.emit(Events.TIMELINE.START_RENDER,e)),this.emit(Events.TIMELINE.READY),this._seeking&&(this.currentAudioCanAutoplay||this.pause(),this._seeking=!1,this.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.SEEKED),logger.groupEnd())}}},{key:"_checkHlsTracks",value:function(e,t){if(!(null==e?void 0:e.samples[0])){if(!this.buffered.length){var r=new Error("lack video sample");r.code=3,this.emit(Events.TIMELINE.PLAY_EVENT,"error",r)}return!1}return!0}},{key:"appendBuffer",value:function(e,t){if(!this._parent.live&&!this._checkHlsTracks(e,t))return;this.emit(Events.TIMELINE.APPEND_CHUNKS,e,t)}},{key:"play",value:function(){var e=this;return new Promise((function(t,r){var n=e.currentAudioCanAutoplay;e._parent.startPlayed||(e.emit(Events.TIMELINE.START_RENDER),e._parent.startPlayed=!0),e.noAudio?n=!0:e.audioRender&&e.audioRender.resume().then((function(){logger.log(e.TAG,"audioCtx start play"),e._paused?e.emit(Events.TIMELINE.DO_PAUSE):n=!0})),setTimeout((function(){return e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.TIMEUPDATE),n?e.videoRender&&!e.videoRender.canAutoPlay?(console.warn("video render an't autoplay"),e.pause(),void r({name:"NotAllowedError"})):(e._paused=!1,void t()):(logger.log(e.TAG,"audioCtx can't autoplay"),void(e._parent.firstWebAudio?(e._paused=!0,e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PAUSE),r({name:"NotAllowedError"})):(e.pause(),t())))}),50)}))}},{key:"pause",value:function(){var e=this;this._paused||!this.ready&&!this._seeking||(this.emit(Events.TIMELINE.DO_PAUSE),setTimeout((function(){e._paused=!0,e.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.PAUSE)})))}},{key:"seek",value:function(e){var t=this;if(this._seeking&&logger.groupEnd(),this.noAudio)this.emit(Events.TIMELINE.SYNC_DTS,this.videoRender.getDtsOfTime(e));else if(this._parent.live){if(this.currentTime<.1||!this.audioCanAutoplay||this.paused)return;var r=this.videoRender.getChaseFrameStartPosition(e,this._parent.preloadTime+1);if(r){var n=this.audioRender.canSeek(r.position),i=this.videoRender.canSeek(r);if(!n||!i)return void logger.log(this.TAG,"seek, !!!!!!!!!can not seek, audioCanSeek:",n,"videoCanSeek:",i);logger.warn(this.TAG,"seek, chase frame to time: ",r.position,"duration:",this.duration),this.videoRender.videoDecode?(this.audioRender._doPause(),r.position=r.position-1.5,this.emit(Events.DECODE_EVENTS.CHASE_VIDEO_FRAME,r)):this.emit(Events.TIMELINE.CHASE_FRAME,r)}}else this._lastSeekTime!==e&&(this._lastSeekTime=e,e>=this.duration&&(e=this.duration-1),e<0&&(e=0),logger.group(this.TAG,"start seek to:",e),this._seeking=!0,this._resetReadyStatus(),this.emit(Events.TIMELINE.DO_SEEK,e),new Promise((function(e){t.emit(Events.TIMELINE.PLAY_EVENT,Events.VIDEO_EVENTS.SEEKING),e()})))}},{key:"dump",value:function(){return this.audioRender.dump()}}]),r}(EventEmitter$1);function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var VIDEO_DECODE_MODE_VALUE="7",SINGLE_TRACK_TYPE={LOW_LATENCY:1,NO_AUDIO:2,NO_VIDEO:3},MVideo=function(t){_inherits(n,t);var r=_createSuper(n);function n(){var e;return _classCallCheck$1(this,n),(e=r.call(this)).TAG="MVideo",e._proxyProps(),e._isLive=!0,e._vMeta=null,e._aMeta=null,e._degradeVideo=document.createElement("video"),e._eventsBackup=[],e._audioCanAutoplay=!0,e._startPlayed=!1,e._endOfStream=!1,e._debounceSeek=debounce(e._seek.bind(_assertThisInitialized(e)),600),e._onTouchEnd=e._onTouchEnd.bind(_assertThisInitialized(e)),e}return _createClass$1(n,[{key:"_proxyProps",value:function(){var t=this;Object.getOwnPropertyNames(n.prototype).forEach((function(r){if(/^__/.test(r)){var n=r.replace("__","");Object.defineProperty(t,n,{get:function(){try{return this[r]}catch(e){}return 0},set:function(t){try{this[r]=t}catch(e){}}})}}))}},{key:"addEventListener",value:function(e,t,r){_get(_getPrototypeOf(n.prototype),"addEventListener",this).call(this,e,t,r),this._eventsBackup.push([e,t,r])}},{key:"removeEventListener",value:function(e,t,r){_get(_getPrototypeOf(n.prototype),"removeEventListener",this).call(this,e,t,r),this._eventsBackup=this._eventsBackup.filter((function(n){return!(n.eventName===e&&n.handler===t&&n.capture===r)}))}},{key:"setAttribute",value:function(e,t){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,e,t),"src"!==e&&this._degradeVideo.setAttribute(e,t)}},{key:"_init",value:function(){this.timeline=new TimeLine({volume:this.volume,canvas:this.querySelector("canvas"),videoContext:this.videoContext,videoDecode:this.videoDecode,maxVideoHeight:this.getAttribute("maxVideoHeight"),endLevel:parseInt(this.getAttribute("endLevel"))},this),this._firstWebAudio=!1,this._noSleep=new NoSleep,this._logFirstFrame=!1,this._playRequest=null,this._degradeVideoUserGestured=!1,this._bindEvents(),this._vMeta&&!this.videoDecode&&this.setVideoMeta(this._vMeta),this._glCtxOptions&&(this.glCtxOptions=this._glCtxOptions),this.timeline&&(this.innerDegrade&&this.timeline.emit(Events.TIMELINE.INNER_DEGRADE),this.timeline.emit(Events.TIMELINE.SET_PLAY_MODE,this._isLive?"LIVE":"VOD"),this.muted=this.muted)}},{key:"_bindEvents",value:function(){var e=this;this.timeline.on(Events.TIMELINE.PLAY_EVENT,(function(t,r){if("canplay"===t&&(e.querySelector("canvas")||(logger.log(e.TAG,"_bindEvents, appendChild canvas"),e.appendChild(e.canvas))),"loadeddata"!==t&&"resize"!==t||Promise.resolve().then((function(){e.updateVideoPostion()})),"error"===t){if(logger.warn(e.TAG,"detect error:",null==r?void 0:r.message),e.pause(),e._disabled(!0),e.innerDegrade||4===e.decoderMode)return e.degradeInfo={decodeFps:e.decodeFps,bitrate:e.bitrate,wasmInitCost:e.wasmInitCost,fps:e.fps,url:e.src,msg:null==r?void 0:r.message,decoderMode:e.decoderMode},void e._innerDispatchEvent("lowdecode");e._err=r}if("lowdecode"===t)return e._disabled(),e.degradeInfo={decodeFps:e.decodeFps,bitrate:e.bitrate,wasmInitCost:e.wasmInitCost,fps:e.fps,url:e.src,decoderMode:e.decoderMode},void e._innerDispatchEvent(t,e.degradeInfo);if("largeavgap"===t&&(e.unsyncInfo=r),"ended"===t){if(e.paused)return;e.pause()}"progress"===t&&e._noSleep.toPlay(),e._innerDispatchEvent(t,r)}))}},{key:"_disabled",value:function(e){!this.videoDecode&&this.innerDegrade&&(e||!this.decodeFps||this.decodeFps/this.fps<=.8&&this.bitrate<2e6?localStorage.setItem("mvideo_dis265",1):localStorage.getItem("mvideo_dis265")||(localStorage.setItem("mvideo_dis265",2),localStorage.setItem("mvideo_disTime",(new Date).getTime())))}},{key:"degrade",value:function(e){var t=this;!!this.querySelector("canvas")?this.replaceChild(this._degradeVideo,this.canvas):this.appendChild(this._degradeVideo),this.destroy(),this._eventsBackup.forEach((function(e){var r=_slicedToArray(e,3),i=r[0],o=r[1],a=r[2];_get(_getPrototypeOf(n.prototype),"removeEventListener",t).call(t,i,o,a),t._degradeVideo.addEventListener(i,o,a)})),this._eventsBackup=[],e&&(this._degradeVideo.muted=!1,this._degradeVideo.src=e,this._degradeVideo.load())}},{key:"disconnectedCallback",value:function(){logger.log(this.TAG,"video disconnected"),document.removeEventListener("touchend",this._onTouchEnd,!0),this.destroy()}},{key:"connectedCallback",value:function(){logger.log(this.TAG,"video connected to document",performance.now()),this.timeline||(this._init(),this._firstWebAudio=!0),this.style.width="100%",this.style.height="100%",this.style.position="absolute",this.style.left="0px",this.style.top="0px",document.addEventListener("touchend",this._onTouchEnd,!0)}},{key:"_onTouchEnd",value:function(){playSlienceAudio(),this._degradeVideoInteract(),this._noSleep&&this._noSleep.enable()}},{key:"handleMediaInfo",value:function(){this._logFirstFrame=!1}},{key:"_degradeVideoInteract",value:function(){var e=this;if(this._degradeVideo&&(1===this.innerDegrade||3===this.innerDegrade)){if(this._degradeVideoUserGestured)return;var t=this._degradeVideo.play();t&&t.then((function(){e._degradeVideo.pause(),e._degradeVideoUserGestured=!0})).catch((function(e){console.log("degrade video: ",e.message)}))}}},{key:"play",value:function(e){var t=this;if(logger.log(this.TAG,"mvideo called play(),ready:".concat(this.timeline.ready,", paused:").concat(this.timeline.paused,", force:").concat(e)),this._endOfStream=!1,this._degradeVideoInteract(),this.timeline.ready&&this.timeline.paused||e){if(e=e||this._isLive,this._playRequest=null,!e)return this.timeline.emit(Events.TIMELINE.DO_PLAY),this._innerDispatchEvent("play"),Promise.resolve();this.destroy(!0),this._init(),this._innerDispatchEvent("waiting")}return this._playRequest||!this.timeline.ready||this.timeline.paused?(this._playRequest=this._playRequest||new Promise((function(e,r){t.timeline._paused=!1,t._innerDispatchEvent("timeupdate"),t._innerDispatchEvent("play"),t._noSleep.enable(),t.timeline.once("ready",(function(){logger.log(t.TAG,"timeline emit ready"),t.timeline.play().then(e).catch(r).then((function(){t._playRequest=null}))}))})),this._playRequest):Promise.resolve()}},{key:"pause",value:function(){this._playRequest=null,this.timeline&&this.timeline.pause();try{this._noSleep.disable(),pauseSlienceAudio()}catch(e){}}},{key:"load",value:function(){}},{key:"appendBuffer",value:function(e,t){if(this.timeline){if(!this._logFirstFrame){var r=e&&e.samples[0],n=t&&t.samples[0];if(!r&&!n)return;if(r||n){var i=(null==e?void 0:e.duration)/((null==e?void 0:e.formatTimescale)||1/0),o=(null==t?void 0:t.duration)/((null==t?void 0:t.formatTimescale)||1/0);logger.warn(this.TAG,"video firstDts:".concat(r&&r.dts," , audio firstDts:").concat(n&&n.dts," videoTrack.duration=").concat(i,", audioTrack.duration=").concat(o)),this._logFirstFrame=!0,(i||o)&&(this.setPlayMode("VOD"),this.timeline.emit(Events.TIMELINE.SET_PLAY_MODE,this._isLive?"LIVE":"VOD"),this.duration=Math.max(i,o))}this.lowlatency&&(logger.warn(this.TAG,"single track! type=",SINGLE_TRACK_TYPE.LOW_LATENCY),this.timeline.emit(Events.TIMELINE.SINGLE_TRACK,SINGLE_TRACK_TYPE.LOW_LATENCY)),n||t.exist()||(logger.warn(this.TAG,"single track! type=",SINGLE_TRACK_TYPE.NO_AUDIO),this.timeline.emit(Events.TIMELINE.SINGLE_TRACK,SINGLE_TRACK_TYPE.NO_AUDIO)),r||e.exist()||(logger.warn(this.TAG,"single track! type=",SINGLE_TRACK_TYPE.NO_VIDEO),this.timeline.emit(Events.TIMELINE.SINGLE_TRACK,SINGLE_TRACK_TYPE.NO_VIDEO)),window.firstFrameTime=Date.now()}e.formatTimescale&&e.samples.forEach((function(t){t.dts=t.dts/e.formatTimescale*1e3,t.pts=t.pts/e.formatTimescale*1e3})),t.formatTimescale&&t.samples.forEach((function(e){e.dts=e.dts/t.formatTimescale*1e3,e.pts=e.pts/t.formatTimescale*1e3})),this.timeline.appendBuffer(e,t)}}},{key:"setAudioMeta",value:function(e){this._aMeta=e,this.timeline.emit(Events.TIMELINE.SET_METADATA,"audio",e)}},{key:"setVideoMeta",value:function(e){!this._isLive&&this._vMeta||(this.timeline.emit(Events.TIMELINE.SET_METADATA,"video",e),this._vMeta=e)}},{key:"setDecodeMode",value:function(e){this.setAttribute("decodeMode",e)}},{key:"setPlayMode",value:function(e){this._isLive="LIVE"===e}},{key:"endOfStream",value:function(){var e;this.currentTime&&(this._endOfStream=!0,null===(e=this.timeline)||void 0===e||e.emit(Events.TIMELINE.END_OF_STREAM))}},{key:"updateVideoPostion",value:function(){var e;null===(e=this.timeline)||void 0===e||e.emit(Events.VIDEO.UPDATE_VIDEO_FILLTYPE,this.xgfillType,this.containerLayout)}},{key:"_innerDispatchEvent",value:function(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))}},{key:"destroy",value:function(e){this.timeline&&(this._noSleep.destroy(),logger.log(this.TAG,"call destroy"),this.timeline.emit(Events.TIMELINE.DESTROY,e),this.querySelector("video")&&this.removeChild(this.querySelector("video")),this.timeline=null,this._err=null,this._noSleep=null)}},{key:"updateCanplayStatus",value:function(e){if(!e){var t=navigator.userAgent;/Chrome/.test(t)||(this._audioCanAutoplay=e)}}},{key:"updateObjectPosition",value:function(e,t){this.timeline.emit(Events.VIDEO.UPDATE_VIDEO_COVER_POSITION,this.containerLayout,e,t),this._degradeVideo&&(this._degradeVideo.style.objectPosition="".concat(100*e,"% ").concat(100*t,"%"))}},{key:"dump",value:function(){return this.timeline.dump()}},{key:"setVideoDecode",value:function(){logger.log(this.TAG,"set videoDecode",this.videoDecode),this.videoDecode&&this.timeline&&this.timeline.videoRender&&(this.timeline.videoRender.videoDecode=this.videoDecode)}},{key:"startPlayed",get:function(){return this._startPlayed},set:function(e){this._startPlayed=e}},{key:"live",get:function(){return this._isLive}},{key:"firstWebAudio",get:function(){return this._firstWebAudio}},{key:"lowlatency",get:function(){return"true"===this.getAttribute("lowlatency")},set:function(e){this.setAttribute("lowlatency",e)}},{key:"autoplay",get:function(){return"true"===this.getAttribute("autoplay")},set:function(e){this.setAttribute("autoplay",e)}},{key:"__canvas",get:function(){return this.timeline.canvas}},{key:"__ended",get:function(){return!!this._endOfStream&&Math.abs(this.currentTime-this.duration)<.5}},{key:"__width",get:function(){return this.getAttribute("width")||this.videoWidth},set:function(e){var t="number"==typeof e?"".concat(e,"px"):e;this.setAttribute("width",t),this.canvas.width=e}},{key:"__height",get:function(){return this.getAttribute("height")},set:function(e){var t="number"==typeof e?"".concat(e,"px"):e;this.setAttribute("height",t),this.canvas.height=e}},{key:"__videoWidth",get:function(){return this.canvas.width}},{key:"__videoHeight",get:function(){return this.canvas.height}},{key:"__volume",get:function(){return Number(this.getAttribute("volume"))},set:function(e){e<=0&&(e=0),e>=1&&(e=1),this.setAttribute("volume",e),this.muted||this.timeline.emit(Events.TIMELINE.UPDATE_VOLUME,e)}},{key:"__muted",get:function(){return"true"===this.getAttribute("muted")},set:function(e){this.setAttribute("muted",e),this._degradeVideoInteract(),this._noSleep.enable(),this.timeline.emit(Events.TIMELINE.UPDATE_VOLUME,e?0:this.volume)}},{key:"__currentTime",get:function(){if(!this.timeline)return 0;var e=this.timeline.currentTime,t=this.timeline.duration;return Math.min(e,t)},set:function(e){this._debounceSeek(e)}},{key:"_seek",value:function(e){this.timeline&&(this.buffered.length||this.play(),this.timeline.seek(Number(e)))}},{key:"__duration",get:function(){return this._isLive?1/0:this.timeline.duration},set:function(e){this.timeline.emit(Events.TIMELINE.SET_VIDEO_DURATION,e),this._innerDispatchEvent("durationchange")}},{key:"__seeking",get:function(){return this.timeline.seeking}},{key:"__paused",get:function(){return this.timeline.paused}},{key:"__fps",get:function(){return this.timeline.fps}},{key:"__decodeFps",get:function(){return this.timeline.decodeFps}},{key:"__decodeCost",get:function(){return parseInt(this.timeline.decodeCost)}},{key:"__renderCost",get:function(){return this.timeline.renderCost}},{key:"__wasmInitCost",get:function(){return this.timeline.wasmInitCost}},{key:"__totalSize",get:function(){return this.timeline.totalSize}},{key:"__bitrate",get:function(){return this.timeline.bitrate}},{key:"__gopLength",get:function(){return this.timeline.gopLength}},{key:"__readyState",get:function(){return this.timeline.readyState}},{key:"__buffered",get:function(){return this.timeline.buffered}},{key:"__decoderMode",get:function(){return this.timeline.decoderMode}},{key:"src",get:function(){return this.getAttribute("src")},set:function(e){this.src&&this.buffered.length&&(this._vMeta=null,this.startPlayed=!1),this.setAttribute("src",e)}},{key:"currentSrc",get:function(){return this.getAttribute("src")}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"networkState",get:function(){return 0}},{key:"preloadTime",get:function(){var e=this.getAttribute("preloadtime");if(e){var t=Number.parseFloat(e);if(t>0&&!Number.isNaN(t))return t}return 1/0},set:function(e){e&&Number(e)>0&&this.setAttribute("preloadtime",e)}},{key:"innerDegrade",get:function(){var e=this.getAttribute("innerdegrade");return parseInt(e)}},{key:"__glCtxOptions",set:function(e){this._glCtxOptions=e,this.timeline.emit(Events.TIMELINE.UPDATE_GL_OPTIONS,e)}},{key:"__error",get:function(){return this._err},set:function(e){this.timeline.emit(Events.TIMELINE.PLAY_EVENT,"error",e)}},{key:"degradeVideo",get:function(){return this._degradeVideo}},{key:"degradeInfo",get:function(){return this._deradeInfo},set:function(e){this._deradeInfo=e}},{key:"unsyncInfo",get:function(){return this._unsyncInfo},set:function(e){this._unsyncInfo=e}},{key:"xgfillType",get:function(){return this.parentNode.getAttribute("data-xgfill")}},{key:"containerLayout",get:function(){var e=this.parentNode;return{width:e.clientWidth,height:e.clientHeight}}},{key:"videoDecode",get:function(){return this.getAttribute("decodeMode")===VIDEO_DECODE_MODE_VALUE}}],[{key:"version",get:function(){return"3.0.0-next.6-6"}},{key:"init",value:function(e){var t=e.h264Url,r=e.h264AsmUrl,n=e.h265AsmUrl,i=e.h265Url,o=e.h265ThreadUrl,a=customElements.get(EleName);a&&(a.h264Url=t,a.h265Url=i,a.h265AsmUrl=n,a.h264AsmUrl=r,a.h265ThreadUrl=o)}},{key:"isSupported",value:function(){var e=localStorage.getItem("mvideo_dis265");if(!e)return!0;if("1"===e)return!1;if("2"===e){var t=localStorage.getItem("mvideo_disTime")||0;if(t=Number(t),((new Date).getTime()-t)/1e3<86400)return!1;localStorage.removeItem("mvideo_disTime"),localStorage.removeItem("mvideo_dis265")}return!0}},{key:"preloadWorker",get:function(){return n._preloadWorker||""},set:function(e){n._preloadWorker=e}}]),n}(_wrapNativeSuper(HTMLElement));customElements.get(EleName)||customElements.define(EleName,MVideo);var H264_DECODER_URL="https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h264/decoder.js",ASM_H264_DECODER_URL="https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h264/decoder_asm.js",H265_DECODER_URL="https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h265/decoder_1596185762157.js",H265_THREAD_DECODER_URL="https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.0/h265thread/decoder.js",ASM_H265_DECODER_URL="https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h265/decoder_asm_1594191692633.js";MVideo.init({h264Url:H264_DECODER_URL,h264AsmUrl:ASM_H264_DECODER_URL,h265Url:H265_DECODER_URL,h265AsmUrl:ASM_H265_DECODER_URL,h265ThreadUrl:H265_THREAD_DECODER_URL});var index_min="";function DefinitionIconSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16 3.8001H4C3.55817 3.8001 3.2 4.15827 3.2 4.6001V12.6001C3.2 13.0419 3.55817 13.4001 4 13.4001H16C16.4418 13.4001 16.8 13.0419 16.8 12.6001V4.6001C16.8 4.15827 16.4418 3.8001 16 3.8001ZM4 2.6001C2.89543 2.6001 2 3.49553 2 4.6001V12.6001C2 13.7047 2.89543 14.6001 4 14.6001H16C17.1046 14.6001 18 13.7047 18 12.6001V4.6001C18 3.49553 17.1046 2.6001 16 2.6001H4ZM5.0249 6.24509V11.6001H5.9024V9.23009H8.6174V11.6001H9.4949V6.24509H8.6174V8.48009H5.9024V6.24509H5.0249ZM10.5474 6.24509V11.6001H12.5049C13.3749 11.6001 14.0274 11.3601 14.4774 10.8801C14.9049 10.4226 15.1224 9.77009 15.1224 8.92259C15.1224 8.06759 14.9049 7.41509 14.4774 6.96509C14.0274 6.48509 13.3749 6.24509 12.5049 6.24509H10.5474ZM11.4249 6.99509H12.3399C13.0074 6.99509 13.4949 7.14509 13.8024 7.45259C14.1024 7.75259 14.2524 8.24759 14.2524 8.92259C14.2524 9.58259 14.1024 10.0701 13.8024 10.3851C13.4949 10.6926 13.0074 10.8501 12.3399 10.8501H11.4249V6.99509ZM4.15 16.1001C3.79101 16.1001 3.5 16.3911 3.5 16.7501C3.5 17.1091 3.79101 17.4001 4.15 17.4001H15.85C16.209 17.4001 16.5 17.1091 16.5 16.7501C16.5 16.3911 16.209 16.1001 15.85 16.1001H4.15Z" fill="#ffffff"/>\n</svg>',"image/svg+xml").firstChild}var POSITIONS$4=Plugin.POSITIONS,DefinitionMobilePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.playerData=e.player.config.playerData,n.dataMonitoring(),n}return _createClass$3(r,[{key:"dataMonitoring",value:function(){var e=this;this.playerData&&MyProxy$1.subscribeProperty(this.playerData.current,"definition",(function(t,r){if(t!==r&&e.player){var n=e.playerData.getCurrentUrl();e.player.changeDefinition({definition:r,url:n}),e.updatePanel(),e.player.emit(PluginEvents.INNER_DEFINITION_CHANGE,{from:t,to:r,url:n}),e.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:n,from:PluginEvents.INNER_DEFINITION_CHANGE}),setTimeout((function(){e.player.paused&&e.player.play()}),1e3)}}))}},{key:"registerIcons",value:function(){return{definition:{icon:DefinitionIconSVG,class:"xgplayer-definition-svg"}}}},{key:"registerLanguageTexts",value:function(){return{definition:{jp:"明快さ",en:"Definition",zh:"清晰度","zh-hk":"清晰度"},definitionSelect:{jp:"クラリティセレクション",en:"Definition Choose",zh:"清晰度选择","zh-hk":"清晰度選擇"},switching:{jp:"に切り替える",en:"Switching to",zh:"正在切换至","zh-hk":"正在切換至"}}}},{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.definition),this.initEvents()}},{key:"afterPlayerInit",value:function(){}},{key:"initEvents",value:function(){this.bind(["click"],this.handleButtonChange.bind(this))}},{key:"handleButtonChange",value:function(){var e=this.renderItemList();this.renderPanel(e)}},{key:"renderItemList",value:function(){var e=this,t=this.playerData.current.lineId,r=this.playerData.getDefinitionListByLineId(t),n=util$2.createDom("div","",{},"definition-panel-content");return r.forEach((function(t){var r=e.renderItem(t);n.appendChild(r)})),n}},{key:"renderItem",value:function(e){var t=this,r=this.playerData.current.definition,n=util$2.createDom("div","",{},"panel-Item ".concat(r===e.definition?"select-in":""));return n.innerHTML=this.getShowText(this.i18n,e),n.addEventListener("click",(function(r){r.stopPropagation(),r.preventDefault(),t.showToast(e),t.playerData.current.definition=e.definition})),n}},{key:"getShowText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return e[t.definitionTextKey]||t.definitionTextKey||t.definition}},{key:"showToast",value:function(e){var t,r=null===(t=this.player)||void 0===t?void 0:t.getPlugin("sdkToastPlugin");if(r){var n=this.getShowText(this.i18n,e);r.add("".concat(this.langText.switching).concat(n,"..."),2e3,!0)}}},{key:"renderPanel",value:function(e){var t,r;null===(t=this.player)||void 0===t||null===(r=t.panel)||void 0===r||r.showPanel(e,this.langText.definitionSelect,!0)}},{key:"updatePanel",value:function(){var e,t,r=this.renderItemList();null===(e=this.player)||void 0===e||null===(t=e.panel)||void 0===t||t.updatePanel(r)}},{key:"destroy",value:function(){this.unbind(["click"],this.handleButtonChange.bind(this))}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-mobile-definition">\n      <div class="xgplayer-icon">\n      </div>\n    </xg-icon>\n    '}}],[{key:"pluginName",get:function(){return"DefinitionMobilePlugin"}},{key:"textTips",get:function(){return{jp:"明快さ",en:"Definition",zh:"清晰度","zh-hk":"清晰度"}}},{key:"defaultConfig",get:function(){return{position:POSITIONS$4.CONTROLS_RIGHT,index:2.7}}}]),r}(Plugin);function LineIconSVG(){return(new DOMParser).parseFromString('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7123 1C11.85 1 11.1173 1.55472 10.8516 2.32675L4.94973 2.32675C3.16413 2.32675 1.71662 3.77427 1.71662 5.55987C1.71662 7.34547 3.16413 8.79298 4.94973 8.79298L11.0483 8.79298L11.1134 8.79418C11.9936 8.82748 12.697 9.55166 12.697 10.44C12.697 11.3497 11.9596 12.0871 11.05 12.0871H5.01323C4.67882 11.4781 4.03143 11.0654 3.28763 11.0654C2.20111 11.0654 1.32031 11.9462 1.32031 13.0327C1.32031 14.1192 2.20111 15 3.28763 15C4.14992 15 4.88264 14.4452 5.14834 13.6732H11.05C12.8356 13.6732 14.2831 12.2256 14.2831 10.44C14.2831 8.65444 12.8356 7.20693 11.05 7.20693L4.94973 7.20693C4.04009 7.20693 3.30267 6.46951 3.30267 5.55987C3.30267 4.65022 4.04009 3.91281 4.94973 3.91281L10.9866 3.91281C11.321 4.52183 11.9685 4.93464 12.7123 4.93464C13.7988 4.93464 14.6796 4.05384 14.6796 2.96732C14.6796 1.8808 13.7988 1 12.7123 1ZM12.7123 2.18954C12.2827 2.18954 11.9345 2.53777 11.9345 2.96732C11.9345 3.39688 12.2827 3.7451 12.7123 3.7451C13.1418 3.7451 13.4901 3.39688 13.4901 2.96732C13.4901 2.53777 13.1418 2.18954 12.7123 2.18954ZM2.50986 13.0327C2.50986 12.6031 2.85808 12.2549 3.28763 12.2549C3.71719 12.2549 4.06541 12.6031 4.06541 13.0327C4.06541 13.4622 3.71719 13.8105 3.28763 13.8105C2.85808 13.8105 2.50986 13.4622 2.50986 13.0327Z" fill="#FFFFFF"/>\n</svg>',"image/svg+xml").firstChild}var POSITIONS$3=Plugin.POSITIONS,LineMobilePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.playerData=e.player.config.playerData,n.dataMonitoring(),n}return _createClass$3(r,[{key:"dataMonitoring",value:function(){var e=this;this.playerData&&MyProxy$1.subscribeProperty(this.playerData.current,"definition",(function(t,r){if(t!==r&&e.player){var n=e.playerData.getCurrentUrl();console.log(n),e.player.changeDefinition({definition:r,url:n}),e.updatePanel(),setTimeout((function(){e.player.paused&&e.player.play()}),1e3)}}))}},{key:"registerIcons",value:function(){return{line:{icon:LineIconSVG,class:"xgplayer-line-svg"}}}},{key:"registerLanguageTexts",value:function(){return{line:{jp:"ライン",en:"Line",zh:"线路","zh-hk":"線路"},lineSelect:{jp:"ライン選ぶ",en:"Line Choose",zh:"线路选择","zh-hk":"線路選擇"}}}},{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.line),this.initEvents()}},{key:"afterPlayerInit",value:function(){}},{key:"initEvents",value:function(){this.bind(["click"],this.handleButtonChange.bind(this))}},{key:"handleButtonChange",value:function(){var e=this.renderItemList();this.renderPanel(e)}},{key:"renderItemList",value:function(){var e=this,t=this.playerData.getLineList(),r=util$2.createDom("div","",{},"line-panel-content");return t.forEach((function(t){var n=e.renderItem(t);r.appendChild(n)})),r}},{key:"renderItem",value:function(e){var t=this,r=this.playerData.current.lineId,n=util$2.createDom("div","",{},"panel-Item ".concat(r===e.lineId?"select-in":""));return n.innerHTML=this.i18n[e.lineTextKey]||e.lineTextKey,n.addEventListener("click",(function(r){r.stopPropagation(),r.preventDefault(),t.player.emit(PluginEvents.LINE_CHANGE,{from:t.playerData.current.lineId,to:e.lineId}),t.playerData.current.lineId=e.lineId,t.player.emit(SDKEvents.PLAYER_REBUILD)})),n}},{key:"renderPanel",value:function(e){var t,r;null===(t=this.player)||void 0===t||null===(r=t.panel)||void 0===r||r.showPanel(e,this.langText.lineSelect,!0)}},{key:"updatePanel",value:function(){var e,t=this.renderItemList();null===(e=this.player)||void 0===e||e.panel.updatePanel(t)}},{key:"destroy",value:function(){this.unbind(["click"],this.handleButtonChange.bind(this))}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-mobile-line">\n      <div class="xgplayer-icon">\n      </div>\n    </xg-icon>\n    '}}],[{key:"pluginName",get:function(){return"LineMobilePlugin"}},{key:"textTips",get:function(){return{jp:"ライン",en:"Line",zh:"线路","zh-hk":"線路"}}},{key:"defaultConfig",get:function(){return{position:POSITIONS$3.CONTROLS_RIGHT,index:2.8}}}]),r}(Plugin);function RateIconSVG(){return(new DOMParser).parseFromString('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.6879 3.64579C14.7387 3.60575 14.7387 3.52868 14.6879 3.48864L13.3089 2.40296C13.2433 2.35132 13.147 2.39805 13.147 2.48153V4.6529C13.147 4.73639 13.2433 4.78312 13.3089 4.73147L14.6879 3.64579ZM4 2.61914H11.3001V3.91914H4C3.6134 3.91914 3.3 4.23254 3.3 4.61914V15.6191C3.3 16.0057 3.6134 16.3191 4 16.3191H16C16.3866 16.3191 16.7 16.0057 16.7 15.6191V6.75253H18V15.6191C18 16.7237 17.1046 17.6191 16 17.6191H4C2.89543 17.6191 2 16.7237 2 15.6191V4.61914C2 3.51457 2.89543 2.61914 4 2.61914ZM17.7879 3.48864C17.8388 3.52868 17.8388 3.60575 17.7879 3.64579L16.4089 4.73147C16.3433 4.78312 16.2471 4.73639 16.2471 4.6529V2.48153C16.2471 2.39805 16.3433 2.35132 16.4089 2.40296L17.7879 3.48864ZM6.82584 7.37256C6.26886 7.37256 5.82039 7.56063 5.48042 7.93677C5.14768 8.29121 4.98131 8.75415 4.97408 9.33282H5.82039C5.83485 8.92775 5.92166 8.61671 6.08079 8.41418C6.23993 8.19717 6.47863 8.08867 6.7969 8.08867C7.09347 8.08867 7.31771 8.15377 7.46961 8.29121C7.61428 8.42864 7.69385 8.63841 7.69385 8.92052C7.69385 9.20986 7.57811 9.48473 7.35388 9.7379C7.20921 9.8898 6.97774 10.0851 6.645 10.3166C6.04462 10.7289 5.64679 11.0471 5.45872 11.2642C5.11151 11.6548 4.94514 12.1105 4.94514 12.6385H8.54739V11.8935H6.00122C6.11696 11.6331 6.43523 11.3293 6.96327 10.982C7.46961 10.6421 7.83128 10.3672 8.03382 10.1502C8.36656 9.7813 8.54016 9.37622 8.54016 8.92775C8.54016 8.46481 8.38102 8.09591 8.06275 7.80657C7.73725 7.51723 7.32494 7.37256 6.82584 7.37256ZM9.90445 11.5463C9.74532 11.5463 9.60788 11.5969 9.50661 11.7126C9.39088 11.8211 9.34025 11.9586 9.34025 12.1177C9.34025 12.2768 9.39088 12.407 9.50661 12.5228C9.60788 12.624 9.74532 12.6819 9.90445 12.6819C10.0636 12.6819 10.1938 12.624 10.3095 12.5228C10.418 12.407 10.4759 12.2768 10.4759 12.1177C10.4759 11.9586 10.418 11.8211 10.3095 11.7126C10.1938 11.5969 10.0636 11.5463 9.90445 11.5463ZM11.665 8.12484C11.9977 7.6185 12.4679 7.37256 13.0755 7.37256C13.6759 7.37256 14.1461 7.6185 14.486 8.12484C14.8043 8.60225 14.9635 9.24602 14.9635 10.0562C14.9635 10.8663 14.8043 11.5101 14.486 11.9875C14.1461 12.4866 13.6759 12.7398 13.0755 12.7398C12.4679 12.7398 11.9977 12.4866 11.665 11.9875C11.3467 11.5101 11.1876 10.8663 11.1876 10.0562C11.1876 9.24602 11.3467 8.60225 11.665 8.12484ZM13.9435 8.77585C13.7699 8.31291 13.4806 8.08867 13.0755 8.08867C12.6632 8.08867 12.3739 8.31291 12.2075 8.77585C12.0918 9.08689 12.0339 9.51366 12.0339 10.0562C12.0339 10.5914 12.0918 11.0182 12.2075 11.3365C12.3739 11.7922 12.6632 12.0237 13.0755 12.0237C13.4806 12.0237 13.7699 11.7922 13.9435 11.3365C14.0593 11.0182 14.1171 10.5914 14.1171 10.0562C14.1171 9.51366 14.0593 9.08689 13.9435 8.77585Z" fill="#ffffff"/>\n</svg>',"image/svg+xml").firstChild}var POSITIONS$2=Plugin.POSITIONS,PlaybackRateMobilePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).playerData=null,n.state={currentRate:1,isSupport:!0},n.playerData=e.player.config.playerData,n}return _createClass$3(r,[{key:"registerIcons",value:function(){return{playbackRate:{icon:RateIconSVG,class:"xgplayer-rate-svg"}}}},{key:"registerLanguageTexts",value:function(){return{rate:{jp:"倍速",en:"PlaybackRate",zh:"倍速","zh-hk":"倍速"},rateSelect:{jp:"倍速選ぶ",en:"PlaybackRate",zh:"倍速选择","zh-hk":"倍速選擇"}}}},{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.playbackRate),this.initEvents()}},{key:"afterPlayerInit",value:function(){}},{key:"initEvents",value:function(){this.bind(["click"],this.handleButtonChange.bind(this))}},{key:"handleButtonChange",value:function(){var e=this.renderItemList();this.renderPanel(e)}},{key:"renderItemList",value:function(){var e=this,t=util$2.createDom("div","",{},"playbackRate-panel-content");return this.config.list.forEach((function(r){var n=e.renderItem(r);t.appendChild(n)})),t}},{key:"renderItem",value:function(e){var t=this,r=lodash.exports.isObject(e)?e:{textKey:e+"X",value:e},n=util$2.createDom("div","",{},"panel-Item ".concat(this.state.currentRate===r.value?"select-in":""));return n.innerHTML=this.i18n[r.textKey]||r.textKey,n.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),t.emit(RATE_CHANGE,{from:t.player.playbackRate,to:r.value}),t.state.currentRate=r.value,t.player.playbackRate=r.value,t.updatePanel()})),n}},{key:"renderPanel",value:function(e){var t,r;null===(t=this.player)||void 0===t||null===(r=t.panel)||void 0===r||r.showPanel(e,this.langText.rateSelect,!0)}},{key:"updatePanel",value:function(){var e,t=this.renderItemList();null===(e=this.player)||void 0===e||e.panel.updatePanel(t)}},{key:"destroy",value:function(){this.unbind(["click"],this.handleButtonChange.bind(this))}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-mobile-playBackRate">\n      <div class="xgplayer-icon">\n      </div>\n    </xg-icon>\n    '}}],[{key:"pluginName",get:function(){return"PlaybackRateMobilePlugin"}},{key:"textTips",get:function(){return{jp:"倍速",en:"PlaybackRate",zh:"倍速","zh-hk":"倍速"}}},{key:"defaultConfig",get:function(){return{position:POSITIONS$2.CONTROLS_RIGHT,index:2.9,list:[2,1.5,1.25,1,.75,.5],default:1}}}]),r}(Plugin),SdkPlugin=function(){function e(t){_classCallCheck$3(this,e),this.__args=null,this.sdk=null,this.playerData=null,this.player=null,this._emitter=null,this.beforeCreate&&"function"==typeof this.beforeCreate&&this.beforeCreate(),this.__args=t,this.pluginName="",this.__init(t)}return _createClass$3(e,[{key:"beforeCreate",value:function(){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerCreate",value:function(){}},{key:"afterPlayerCreate",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(t){var r=this;e.defineGetterOrSetter(this,{sdk:{get:function(){return t.sdk},configurable:!0},player:{get:function(){return t.sdk.getPlayerInstance()},configurable:!0},playerData:{get:function(){return t.sdk.playerData},configurable:!0},pluginName:{get:function(){return t.pluginName?t.pluginName.toLowerCase():r.constructor.pluginName.toLowerCase()},configurable:!0},_emitter:{get:function(){return t.sdk._emitter},configurable:!0}})}},{key:"__destroy",value:function(){var e=this,t=this.sdk,r=this.pluginName;this.destroy&&"function"==typeof this.destroy&&this.destroy(),["sdk","player","playerData","pluginName","_emitter"].map((function(t){Object.defineProperty(e,t,{writable:!0})})),Object.keys(this).map((function(t){e[t]=null,delete e[t]})),Object.setPrototypeOf&&Object.setPrototypeOf(this,null),t.unRegister(r)}}],[{key:"defineGetterOrSetter",value:function(e,t){for(var r in t)Object.defineProperty(e,r,t[r])}},{key:"pluginName",get:function(){return"pluginName"}}]),e}(),dist=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof$3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,r){var n=r(12)("wks"),i=r(13),o=r(0).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,r){var n=r(4);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)};e.exports=function(e){return"object"===(void 0===e?"undefined":n(e))?null!==e:"function"==typeof e}},function(e,t,r){var n=r(6);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){e.exports=!r(15)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,r){var n=r(3),i=r(26),o=r(27),a=Object.defineProperty;t.f=r(7)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(s){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){e.exports=!1},function(e,t,r){var n=r(8),i=r(1)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(2),i=r(0),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(10)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,r){var n=r(9),i=r(28);e.exports=r(7)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,r){var n=r(4),i=r(0).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(0),i=r(14),o=r(18),a=r(13)("src"),s=r(29),u=(""+s).split("toString");r(2).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(c&&(o(r,a)||i(r,a,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,r){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,r){e.exports={}},function(e,t,r){var n,i,o,a=r(5),s=r(38),u=r(39),c=r(16),l=r(0),d=l.process,f=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,g=l.Dispatch,y=0,v={},m=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},_=function(e){m.call(e.data)};f&&h||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++y]=function(){s("function"==typeof e?e:Function(e),t)},n(y),y},h=function(e){delete v[e]},"process"==r(8)(d)?n=function(e){d.nextTick(a(m,e,1))}:g&&g.now?n=function(e){g.now(a(m,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",_,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,r){var n=r(6);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t,r){e.exports=r(23)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),r(24);var n,i=(n=r(48))&&n.__esModule?n:{default:n};t.default={url:i.default},e.exports=t.default},function(e,t,r){var n,i,o,a,s=r(10),u=r(0),c=r(5),l=r(11),d=r(25),f=r(4),h=r(6),p=r(30),g=r(31),y=r(37),v=r(20).set,m=r(40)(),_=r(21),b=r(41),A=r(42),E=r(43),S=u.TypeError,T=u.process,$=T&&T.versions,w=$&&$.v8||"",C=u.Promise,I="process"==l(T),k=function(){},O=i=_.f,P=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(1)("species")]=function(e){e(k,k)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==w.indexOf("6.6")&&-1===A.indexOf("Chrome/66")}catch(n){}}(),R=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},x=function(e,t){if(!e._n){e._n=!0;var r=e._c;m((function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&N(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(S("Promise-chain cycle")):(o=R(r))?o.call(r,u,c):u(r)):c(n)}catch(d){l&&!a&&l.exit(),c(d)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){v.call(u,(function(){var t,r,n,i=e._v,o=L(e);if(o&&(t=b((function(){I?T.emit("unhandledRejection",i,e):(r=u.onunhandledrejection)?r({promise:e,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=I||L(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){v.call(u,(function(){var t;I?T.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},M=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},B=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(r=R(t))?m((function(){var i={_w:n,_d:!1};try{r.call(t,c(e,i,1),c(M,i,1))}catch(o){M.call(i,o)}})):(n._v=t,n._s=1,x(n,!1))}catch(i){M.call({_w:n,_d:!1},i)}}};P||(C=function(e){p(this,C,"Promise","_h"),h(e),n.call(this);try{e(c(B,this,1),c(M,this,1))}catch(t){M.call(this,t)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(C.prototype,{then:function(e,t){var r=O(y(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=I?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&x(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=c(B,e,1),this.reject=c(M,e,1)},_.f=O=function(e){return e===C||e===a?new o(e):i(e)}),d(d.G+d.W+d.F*!P,{Promise:C}),r(45)(C,"Promise"),r(46)("Promise"),a=r(2).Promise,d(d.S+d.F*!P,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!P),"Promise",{resolve:function(e){return E(s&&this===a?C:this,e)}}),d(d.S+d.F*!(P&&r(47)((function(e){C.all(e).catch(k)}))),"Promise",{all:function(e){var t=this,r=O(t),n=r.resolve,i=r.reject,o=b((function(){var r=[],o=0,a=1;g(e,!1,(function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,r[s]=e,--a||n(r))}),i)})),--a||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=O(t),n=r.reject,i=b((function(){g(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},function(e,t,r){var n=r(0),i=r(2),o=r(14),a=r(17),s=r(5),u=function e(t,r,u){var c,l,d,f,h=t&e.F,p=t&e.G,g=t&e.P,y=t&e.B,v=p?n:t&e.S?n[r]||(n[r]={}):(n[r]||{}).prototype,m=p?i:i[r]||(i[r]={}),_=m.prototype||(m.prototype={});for(c in p&&(u=r),u)d=((l=!h&&v&&void 0!==v[c])?v:u)[c],f=y&&l?s(d,n):g&&"function"==typeof d?s(Function.call,d):d,v&&a(v,c,d,t&e.U),m[c]!=d&&o(m,c,f),g&&_[c]!=d&&(_[c]=d)};n.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,r){e.exports=!r(7)&&!r(15)((function(){return 7!=Object.defineProperty(r(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(4);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){e.exports=r(12)("native-function-to-string",Function.toString)},function(e,t,r){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(5),i=r(32),o=r(33),a=r(3),s=r(34),u=r(36),c={},l={},d=e.exports=function(e,t,r,d,f){var h,p,g,y,v=f?function(){return e}:u(e),m=n(r,d,t?2:1),_=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(h=s(e.length);h>_;_++)if((y=t?m(a(p=e[_])[0],p[1]):m(e[_]))===c||y===l)return y}else for(g=v.call(e);!(p=g.next()).done;)if((y=i(g,m,p.value,t))===c||y===l)return y};d.BREAK=c,d.RETURN=l},function(e,t,r){var n=r(3);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(a){var o=e.return;throw void 0!==o&&n(o.call(e)),a}}},function(e,t,r){var n=r(19),i=r(1)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(35),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,r){var n=r(11),i=r(1)("iterator"),o=r(19);e.exports=r(2).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(3),i=r(6),o=r(1)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[o])?t:i(r)}},function(e,t,r){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(0).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(0),i=r(20).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,u="process"==r(8)(a);e.exports=function(){var e,t,r,c=function(){var n,i;for(u&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(o){throw e?r():t=void 0,o}}t=void 0,n&&n.enter()};if(u)r=function(){a.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);r=function(){l.then(c)}}else r=function(){i.call(n,c)};else{var d=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),r=function(){f.data=d=!d}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){e.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},function(e,t,r){var n=r(0).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){var n=r(3),i=r(4),o=r(21);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){var n=r(17);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(9).f,i=r(18),o=r(1)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(0),i=r(9),o=r(7),a=r(1)("species");e.exports=function(e){var t=n[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(1)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(s){}return r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==_typeof$3(Symbol.iterator)?function(e){return _typeof$3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof$3(e)};t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e){try{e=JSON.parse(i.default.base64decode(e))}catch(c){return Promise.reject("base64 decode error")}var a=[];for(var s in r)a.push(s+"="+r[s]);var u="//"+t+"?"+e.GetPlayInfoToken+"&ssl=true";return a.length>0&&(u+="&"+a.join("&")),new o.default({type:"json",method:"GET",url:u}).then((function(e){return e&&e.response?"string"==typeof e.response?JSON.parse(e.response).Result:"object"===n(e.response)?e.response.Result:e.response:e}))}return Promise.reject("vid, host and token can't be empty")};var i=a(r(49)),o=a(r(50));function a(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n={base64decode:function(e){var t,r,n,i,o,a,s,u=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(a=e.length,o=0,s="";o<a;){do{t=u[255&e.charCodeAt(o++)]}while(o<a&&-1===t);if(-1===t)break;do{r=u[255&e.charCodeAt(o++)]}while(o<a&&-1===r);if(-1===r)break;s+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(o++)))return s;n=u[n]}while(o<a&&-1===n);if(-1===n)break;s+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(i=255&e.charCodeAt(o++)))return s;i=u[i]}while(o<a&&-1===i);if(-1===i)break;s+=String.fromCharCode((3&n)<<6|i)}return s}};t.default=n,e.exports=t.default},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,i=t.method,o=void 0===i?"GET":i,a=(t.type,t.data),s=void 0===a?{}:a,u=t.headers,c=void 0===u?{}:u;return n(this,e),new Promise((function(e,t){var n=new window.XMLHttpRequest,i=o.toUpperCase(),a=[];for(var u in s)a.push(u+"="+s[u]);if("GET"!==i)throw new Error("xhr "+i+" is not supported");for(var l in n.open(i,""+r,!0),n.responseType="",c)n.setRequestHeader(l,""+c[l]);n.send(),n.onload=function(){200===n.status||206===n.status?e(n):t(n)},n.onerror=function(){t(n)}}))},e.exports=t.default}]),TOB_PLAY_DOMAIN="//vod.volcengineapi.com",TOC_PLAY_DOMAIN="//vod.bytedanceapi.com",LICENSE_URL="https://webmedia.zijieapi.com/video/drm/v1/play_licenses",AuthToken=function(e){_inherits$2(o,e);var t,r,n,i=_createSuper$r(o);function o(e){var t;return _classCallCheck$3(this,o),(t=i.call(this,e)).isPlayByToken=!1,t.config=null,t.init(),t}return _createClass$3(o,[{key:"beforePlayerCreate",value:(n=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPlayByToken){e.next=3;break}return e.next=3,this.getConfig();case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getConfig",value:(r=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){var t,r,n,i,o,a,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getPlayInfoByAuthToken(this.config);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:t=e.t0,r=t.playList,n=t.poster,i=t.vid,o=t.dashOpts,r&&(this.isPlayByToken=!0,this.playerData.playList=r,this.playerData.initCurrent(r[0]),this.playerData.options.poster=n,this.playerData.options.vid=i,("dash"===this.playerData.getCurrentStreamType()||this.playerData.options.DASHPlugin)&&(a=_objectSpread2$1({},this.playerData.options.DASHPlugin||{}),this.playerData.options.DASHPlugin=_objectSpread2$1({getLicenseUrl:LICENSE_URL,playInfoType:"TOP",vid:i,dashOpts:o,defaultFormat:"dash"},a))),e.next=18;break;case 14:e.prev=14,e.t1=e.catch(0),null===(s=this._emitter)||void 0===s||s.emit(PluginEvents.GET_PLAY_URL_ERR),console.error(e.t1);case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(){return r.apply(this,arguments)})},{key:"init",value:function(){var e=this.playerData.configs,t=e.getVideoByToken,r=void 0===t?{}:t;this.initConfig(r,e)}},{key:"initConfig",value:function(e,t){this.isPlayByToken=!!e.playAuthToken,this.isPlayByToken&&(!Object.keys(e).includes("isInternal")&&Object.keys(t).includes("isInternal")&&(e.isInternal=t.isInternal),this.config=e)}},{key:"afterPlayerCreate",value:function(){this.dataMonitoring()}},{key:"dataMonitoring",value:function(){var e=this;("dash"===this.playerData.getCurrentStreamType()||this.playerData.options.DASHPlugin)&&this.player.on(PluginEvents.MEDIA_EXPIRED,(function(){e.getPlayInfoByAuthToken(e.config).then((function(t){var r=(t||{}).dashOpts;e.player.config.DASHPlugin.dashOpts=r,e.player.plugins.dashplugin.next(e.player.currentTime,PluginEvents.MEDIA_EXPIRED,e.player.player.config.DASHPlugin)}))}))}},{key:"switchAuthToken",value:function(e){var t=this.playerData.configs;this.initConfig(e,t),this.player.emit(SDKEvents.PLAYER_REBUILD)}},{key:"getPlayInfoByAuthToken",value:(t=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f,h,p,g,y,v,m,_,b,A,E;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.playAuthToken,n=t.isInternal,i=void 0!==n&&n,o=t.playDomain,a=t.reqParams,s=void 0===a?{}:a,u=t.definitionMap,!r){e.next=14;break}return l=i?TOC_PLAY_DOMAIN:TOB_PLAY_DOMAIN,d=o||l,e.next=6,dist.url(r,d,s);case 6:if(f=e.sent,h=i?f.Data:f,p=h.Status,g=h.PlayInfoList,y=void 0===g?[]:g,v=h.PosterUrl,m=h.CoverUrl,_=h.VideoID,b=h.Vid,A=h.Duration,p!==VIDEO_STATUS_TYPE.VALID||null===(c=y[0])||void 0===c||!c.MainPlayUrl){e.next=13;break}return E=y.map((function(e){return _objectSpread2$1(_objectSpread2$1({lineId:1,lineName:"线路1",url:e.MainPlayUrl,streamType:e.Format,backUrlList:[e.BackupPlayUrl]},e),getDefinitionInfo(e,u))})).filter((function(e){return e.definition})),e.abrupt("return",{playList:E,poster:i?m:v,vid:i?_:b,duration:A,dashOpts:i?f:{Data:f}});case 13:console.warn("视频不可用，请检查视频发布状态");case 14:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"pluginName",get:function(){return"AuthToken"}}]),o}(SdkPlugin),sdkPluginManager={init:function(e){e&&(e.isLive?e.sdkPlugins=[]:e.sdkPlugins=[AuthToken],e._sdkPlugins={})},registerPlugin:function(e,t){if(e&&t){var r=null,n=null;e.plugin&&"function"==typeof e.plugin?(r=e.plugin,n=e.options):(r=e,n={}),n.sdk=t;var i=n.pluginName||r.pluginName;if(!i)throw new Error("The property pluginName is necessary");var o=t._sdkPlugins;try{o[i.toLowerCase()]&&this.unRegister(i);var a=new r(n);return o[i.toLowerCase()]=a,o[i.toLowerCase()].func=r,a&&"function"==typeof a.afterCreate&&a.afterCreate(),a}catch(s){console.error(s)}}},unRegister:function(e,t){if(e&&t){e=e.toLowerCase();try{var r=t._sdkPlugins[e];r&&(r.pluginName&&r.__destroy(),delete this.playerData._sdkPlugins[e])}catch(n){console.error(n)}}},beforePlayerCreate:function(t){if(t){t._sdkPlugins||this.init(t);for(var r=t._sdkPlugins,n=[],i=0,o=Object.keys(r);i<o.length;i++){var a=o[i];if(r[a]&&r[a].beforePlayerCreate)try{var s=r[a].beforePlayerCreate();n.push(retPromise(s))}catch(e){throw n.push(retPromise(null)),e}}return new Promise((function(e){Promise.all([].concat(n)).then((function(){e(null)})).catch((function(t){console.error(t),e(null)}))}))}},afterPlayerCreate:function(t){if(t)for(var r=t._sdkPlugins,n=0,i=Object.keys(r);n<i.length;n++){var o=i[n];if(r[o]&&r[o].beforePlayerCreate)try{r[o].afterPlayerCreate()}catch(e){throw e}}},destroy:function(e){if(e){for(var t=e._sdkPlugins,r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];this.unRegister(i,e)}delete e._sdkPlugins}}},VePlayer=function(){function e(t){return _classCallCheck$3(this,e),this.player=null,this.mountingDom=null,this.playerContainer=null,this.mobilePanel=null,this._isFirstCreated=!0,this.sdkPlugins=[],this._sdkPlugins={},this._init(t),new Proxy(this,{get:function(e,t,r){var n;return"string"==typeof t&&["playerData","player","mountingDom","playerContainer","mobilePanel","_emitter","isFirstCreated"].includes(t)?Reflect.get(e,t,r):null!==(n=Reflect.get(e,t,r))&&void 0!==n?n:Reflect.get(e.getPlayerInstance(),t,r)}})}var t,r,n,i;return _createClass$3(e,[{key:"_init",value:function(e){this.playerData=new PlayerData(e),this._emitter=new EventEmitter$1,this._initSdkPlugins(),this.renderDom(),this.createPlayer(),this.dataMonitoring(),this._initI18N(this.playerData.languageData)}},{key:"_initSdkPlugins",value:function(){var e=this;sdkPluginManager.init(this),_toConsumableArray$2(this.sdkPlugins).map((function(t){return sdkPluginManager.registerPlugin(t,e)}))}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"emit",value:function(e,t){this._emitter.emit(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"dataMonitoring",value:function(){}},{key:"renderDom",value:function(){var e=this.playerData,t=e.id,r=e.root,n=document.createElement("div");this.playerContainer=n;var i=r||document.querySelector("#".concat(t));i&&(i.appendChild(n),this.mountingDom=i)}},{key:"renderPoster",value:function(){if(this.playerContainer){var e=this.playerData.options,t=e.poster,r=void 0===t?"":t,n=e.width,i=e.height;r&&(this.playerContainer.style.cssText='background: url("'.concat(r,'");\n    background-size: cover;\n    width:').concat(n?n+"px":"100%",";\n    height:").concat(i?i+"px":"100%",";\n    "))}}},{key:"createPlayer",value:(i=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){var t,r,n,i,o,a,s,u,c,l,d,f,h,p,g,y,v,m,_,b,A,E,S,T;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._destroyPlayer();case 2:return e.next=4,this.beforePlayerCreate();case 4:if(i=this.playerData,o=i.isLive,a=i.options,s=i.plugins,u=i.isMobile,c=i.openSoftDecoding,l=i.configs,d=this.playerData.getCurrentUrl(),f=this.playerData.getCurrentStreamType(),null!=l&&l.EncryptHlsPlugin||d&&f){e.next=11;break}return console.log("无必要条件: url:".concat(d,", streamType").concat(f)),this.renderPoster(),e.abrupt("return");case 11:return p=createSDKPreset(o,f,u,h=c&&o,l),g=u?createPlayerOption(o):createPlayerOption$1(o),y=this.getSoftDecodingOption(h),v=this._analyzeExtendPlugins(),m=v.basicPlugins,_=void 0===m?[]:m,b=v.iconPlugins,A=void 0===b?[]:b,E=_objectSpread2$1(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},g),a),y),{},{icons:_objectSpread2$1(_objectSpread2$1({},g.icons),null!==(t=null==a?void 0:a.icons)&&void 0!==t?t:{}),MoreButtonPlugin:{iconPlugins:[].concat(_toConsumableArray$2(null!==(r=null===(n=a.MoreButtonPlugin)||void 0===n?void 0:n.iconPlugins)&&void 0!==r?r:[]),_toConsumableArray$2(A),[LineMobilePlugin,DefinitionMobilePlugin,PlaybackRateMobilePlugin])},playerData:this.playerData}),this.setDefaultConfigOptions(E),S=[].concat(_toConsumableArray$2(_),_toConsumableArray$2(s)),this._isFirstCreated?this._isFirstCreated=!1:(E.autoplayMuted=!1,E.ignores=[].concat(_toConsumableArray$2(null!==(T=null==E?void 0:E.ignores)&&void 0!==T?T:[]),["sdkUnmutePlugin"])),this.player=new PresetPlayer(_objectSpread2$1(_objectSpread2$1({el:this.playerContainer,presets:p,url:d,isLive:o},E),{},{plugins:_toConsumableArray$2(S)})),this.player.playerData=this.playerData,this._emitter.emit(SDKEvents.PLAYER_CREATED_FINISH),this.afterPlayerCreate(),e.abrupt("return",this.player);case 25:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setDefaultConfigOptions",value:function(e){if(this._isFirstCreated){var t=this.playerData,r=t.defaultConfig,n=t.isHitDefault;if(r){var i=null!=r?r:{},o=i.volume,a=i.startTime,s=i.DanmuPlugin,u=i.LiveSubtitlesIconPlugin;if(o&&(e.volume=e.volume?_objectSpread2$1(_objectSpread2$1({},e.volume),{},{default:o}):o),n){var c,l;if(a&&(e.startTime=a),s)e.DanmuPlugin=_objectSpread2$1(_objectSpread2$1({},null!==(c=e.DanmuPlugin)&&void 0!==c?c:{}),s);if(u)e.LiveSubtitlesIconPlugin=_objectSpread2$1(_objectSpread2$1({},null!==(l=e.LiveSubtitlesIconPlugin)&&void 0!==l?l:{}),u)}}}}},{key:"getCurrentPlayerConfig",value:function(){var e,t,r=this.playerData,n=r.isLive,i=r.current,o=i.lineId,a={type:n?"live":"vod",isLive:n,definition:i.definition,lineId:o,volume:null!==(e=this.player.volume)&&void 0!==e?e:.6};n||(a.startTime=null!==(t=this.player.video.currentTime)&&void 0!==t?t:0);return _objectSpread2$1({},a)}},{key:"_analyzeExtendPlugins",value:function(){var e,t=this.playerData.options,r=t.extendPlugin||[],n=null!==(e=null==t?void 0:t.ignore)&&void 0!==e?e:[],i=[],o=[];return r.forEach((function(e){var t=extendPlugin(e);"inner"!==t.type||n[e.pluginName]?i.push(t):o.push(t)})),{basicPlugins:i,iconPlugins:o}}},{key:"beforePlayerCreate",value:(n=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sdkPluginManager.beforePlayerCreate(this);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"afterPlayerCreate",value:function(){var e=this.playerData.isMobile;this._mountingPlayerPanel(e),this._mountingExtendMethods(),this._bindSdkEvents(),this._bindPlayerEvents(),sdkPluginManager.afterPlayerCreate(this)}},{key:"_mountingPlayerPanel",value:function(e){var t,r=this.playerData.options;this.player&&e&&(this.mobilePanel=new MobilePlayerPanel({config:null!==(t=r.panel)&&void 0!==t?t:{mode:PLAYER_MODE.INNER,isAutoChange:!0},root:this.player.root,player:this.player}),this.player.panel=this.mobilePanel)}},{key:"_bindPlayerEvents",value:function(){this.player&&this.player.on(SDKEvents.PLAYER_REBUILD,this.createPlayer.bind(this))}},{key:"_bindSdkEvents",value:function(){var e=this;[].concat(_toConsumableArray$2(Object.values(PluginEvents)),_toConsumableArray$2(Object.values(SDKEvents)),_toConsumableArray$2(Object.values(Events$1))).forEach((function(t){"string"==typeof t&&e.player.on(t,(function(r){e._emitter.emit(t,r)}))}))}},{key:"_mountingExtendMethods",value:function(){this.player&&(this.player.changePluginsIcon=this.changePluginsIcon.bind(this))}},{key:"_offPlayerEvents",value:function(){this.player&&this.player.off(SDKEvents.PLAYER_REBUILD,this.createPlayer.bind(this))}},{key:"changePluginsIcon",value:function(e,t){var r;if(this.player){var n=this.player.getPlugin(e);if(n&&null!=n&&n.root){var i=util$2.hasClass(null==n?void 0:n.parent,"panel-icon-svg")?null==n||null===(r=n.parent)||void 0===r?void 0:r.parentNode:null==n?void 0:n.root;i&&(t?util$2.show(i,"block"):util$2.hide(i))}}}},{key:"getSdkPlugin",value:function(e){var t=this._sdkPlugins[e.toLowerCase()];return t&&t.pluginName?t:null}},{key:"switchAuthToken",value:function(e){var t=this.getSdkPlugin("AuthToken");t&&t.switchAuthToken(e)}},{key:"_destroyPlayer",value:(r=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){var t,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._offPlayerEvents(),e.next=3,null===(t=this.mobilePanel)||void 0===t?void 0:t.destroy();case 3:return e.next=5,null===(r=this.player)||void 0===r?void 0:r.destroy();case 5:this.player=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getPlayerInstance",value:function(){return this.player}},{key:"getSoftDecodingOption",value:function(e){var t,r=(null==HlsPlugin?void 0:HlsPlugin.isSupported(!0))||(null==FlvPlugin?void 0:FlvPlugin.isSupported(!0))||(null==DASHPlugin||null===(t=DASHPlugin.encryptUtils)||void 0===t?void 0:t.isSupported());return r||console.log("软解不支持"),e&&window.customElements&&r?(window.customElements.get("live-video").preloadWorker="h264",{mediaType:"live-video",innerDegrade:1}):{}}},{key:"_initI18N",value:function(e){var t=e.extraLangList,r=e.extendLangList;null==t||t.forEach((function(e){I18N.use(e)})),r&&I18N.extend(r)}},{key:"destroy",value:(t=_asyncToGenerator$1(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._destroyPlayer();case 2:this.mountingDom&&this.mountingDom.removeChild(this.playerContainer),this._emitter.removeAllListeners(),this._emitter=null,sdkPluginManager.destroy(this);case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function getI18N(){return I18N}var index$1="",aisub="",aisubIcon="",index="";function OpenIcon(){return(new DOMParser).parseFromString('<svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2 0.5C0.895431 0.5 0 1.39543 0 2.5V13.5C0 14.6046 0.89543 15.5 2 15.5H16C17.1046 15.5 18 14.6046 18 13.5V2.5C18 1.39543 17.1046 0.5 16 0.5H2ZM7.49634 11.0454C8.00741 10.606 8.29061 10.0037 8.34595 9.23877H6.8811C6.84855 9.67171 6.71997 9.99235 6.49536 10.2007C6.27401 10.4058 5.93709 10.5083 5.48462 10.5083C4.98332 10.5083 4.61548 10.3309 4.3811 9.97607C4.14998 9.62126 4.03442 9.05973 4.03442 8.2915V7.75439C4.04093 7.01872 4.16463 6.47673 4.40552 6.12842C4.64966 5.77686 5.01587 5.60107 5.50415 5.60107C5.95337 5.60107 6.28703 5.70524 6.50513 5.91357C6.72648 6.11865 6.85506 6.45068 6.89087 6.90967H8.35571C8.27759 6.1154 7.98787 5.49854 7.48657 5.05908C6.98527 4.61963 6.32446 4.3999 5.50415 4.3999C4.9117 4.3999 4.39087 4.53988 3.94165 4.81982C3.49569 5.09652 3.15226 5.49528 2.91138 6.01611C2.67049 6.53695 2.55005 7.13916 2.55005 7.82275V8.25732C2.55005 9.32829 2.81047 10.1714 3.3313 10.7866C3.85539 11.3986 4.57316 11.7046 5.48462 11.7046C6.31795 11.7046 6.98853 11.4849 7.49634 11.0454ZM14.5393 11.0454C15.0504 10.606 15.3336 10.0037 15.3889 9.23877H13.9241C13.8915 9.67171 13.7629 9.99235 13.5383 10.2007C13.317 10.4058 12.9801 10.5083 12.5276 10.5083C12.0263 10.5083 11.6584 10.3309 11.4241 9.97607C11.193 9.62126 11.0774 9.05973 11.0774 8.2915V7.75439C11.0839 7.01872 11.2076 6.47673 11.4485 6.12842C11.6926 5.77686 12.0588 5.60107 12.5471 5.60107C12.9963 5.60107 13.33 5.70524 13.5481 5.91357C13.7695 6.11865 13.898 6.45068 13.9338 6.90967H15.3987C15.3206 6.1154 15.0308 5.49854 14.5295 5.05908C14.0282 4.61963 13.3674 4.3999 12.5471 4.3999C11.9547 4.3999 11.4338 4.53988 10.9846 4.81982C10.5387 5.09652 10.1952 5.49528 9.95435 6.01611C9.71346 6.53695 9.59302 7.13916 9.59302 7.82275V8.25732C9.59302 9.32829 9.85343 10.1714 10.3743 10.7866C10.8984 11.3986 11.6161 11.7046 12.5276 11.7046C13.3609 11.7046 14.0315 11.4849 14.5393 11.0454Z" fill="white"/>\n</svg>',"image/svg+xml").firstChild}function CloseIcon(){return(new DOMParser).parseFromString('<svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.49609 11.0454C8.00716 10.606 8.29037 10.0037 8.3457 9.23877H6.88086C6.84831 9.67171 6.71973 9.99235 6.49512 10.2007C6.27376 10.4058 5.93685 10.5083 5.48438 10.5083C4.98307 10.5083 4.61523 10.3309 4.38086 9.97607C4.14974 9.62126 4.03418 9.05973 4.03418 8.2915V7.75439C4.04069 7.01872 4.16439 6.47673 4.40527 6.12842C4.64941 5.77686 5.01562 5.60107 5.50391 5.60107C5.95312 5.60107 6.28678 5.70524 6.50488 5.91357C6.72624 6.11865 6.85482 6.45068 6.89062 6.90967H8.35547C8.27734 6.1154 7.98763 5.49854 7.48633 5.05908C6.98503 4.61963 6.32422 4.3999 5.50391 4.3999C4.91146 4.3999 4.39062 4.53988 3.94141 4.81982C3.49544 5.09652 3.15202 5.49528 2.91113 6.01611C2.67025 6.53695 2.5498 7.13916 2.5498 7.82275V8.25732C2.5498 9.32829 2.81022 10.1714 3.33105 10.7866C3.85514 11.3986 4.57292 11.7046 5.48438 11.7046C6.31771 11.7046 6.98828 11.4849 7.49609 11.0454Z" fill="white"/>\n<path d="M14.5391 11.0454C15.0501 10.606 15.3333 10.0037 15.3887 9.23877H13.9238C13.8913 9.67171 13.7627 9.99235 13.5381 10.2007C13.3167 10.4058 12.9798 10.5083 12.5273 10.5083C12.026 10.5083 11.6582 10.3309 11.4238 9.97607C11.1927 9.62126 11.0771 9.05973 11.0771 8.2915V7.75439C11.0837 7.01872 11.2074 6.47673 11.4482 6.12842C11.6924 5.77686 12.0586 5.60107 12.5469 5.60107C12.9961 5.60107 13.3298 5.70524 13.5479 5.91357C13.7692 6.11865 13.8978 6.45068 13.9336 6.90967H15.3984C15.3203 6.1154 15.0306 5.49854 14.5293 5.05908C14.028 4.61963 13.3672 4.3999 12.5469 4.3999C11.9544 4.3999 11.4336 4.53988 10.9844 4.81982C10.5384 5.09652 10.195 5.49528 9.9541 6.01611C9.71322 6.53695 9.59277 7.13916 9.59277 7.82275V8.25732C9.59277 9.32829 9.85319 10.1714 10.374 10.7866C10.8981 11.3986 11.6159 11.7046 12.5273 11.7046C13.3607 11.7046 14.0312 11.4849 14.5391 11.0454Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M0 2.5C0 1.39543 0.895431 0.5 2 0.5H16C17.1046 0.5 18 1.39543 18 2.5V13.5C18 14.6046 17.1046 15.5 16 15.5H2C0.89543 15.5 0 14.6046 0 13.5V2.5ZM2 2.3H16C16.1105 2.3 16.2 2.38954 16.2 2.5V13.5C16.2 13.6105 16.1105 13.7 16 13.7H2C1.88954 13.7 1.8 13.6105 1.8 13.5V2.5C1.8 2.38954 1.88954 2.3 2 2.3Z" fill="white"/>\n</svg>\n',"image/svg+xml").firstChild}function Uint8ArrayToString(e){var t=String.fromCharCode.apply(null,e);return t.slice(t.indexOf("{"),t.lastIndexOf("}")+1)}var LiveSubTitlesPlugin=function(t){_inherits$2(n,t);var r=_createSuper$r(n);function n(e){var t;return _classCallCheck$3(this,n),(t=r.call(this,e)).state={showLang:"",subTitleList:[],rtmpDtsGap:0,dtsBase:0,showingSubtitle:"",currentSub:null},t.clearLineTimer=null,t.showTimer=null,t.state.showLang=e.showLang,t}return _createClass$3(n,[{key:"beforePlayerInit",value:function(){var e=this;this.on(TIME_UPDATE,this.handleVideoTimeupdate.bind(this)),this.on(PAUSE,this.onPause.bind(this)),this.on(PLAY,this.onPlay.bind(this)),this.on(DESTROY,this.destroy.bind(this)),this.on(URL_CHANGE,this.clearRtmpDtsGap.bind(this)),this.on(SEI_PARSED,this.handleSEIParsed.bind(this)),this.on("core_event",(function(t){"core.sei"===t.eventName&&e.handleSEIParsed(t.sei,t.originPts)}))}},{key:"onPause",value:function(){this.clearSubTitle(!1)}},{key:"onPlay",value:function(){this.clearSubTitle(!0)}},{key:"destroy",value:function(){this.clearSubTitle(!0),this.off(TIME_UPDATE,this.handleVideoTimeupdate.bind(this)),this.off(SEI_PARSED,this.handleSEIParsed.bind(this)),this.off(PAUSE,this.onPause.bind(this)),this.off(PLAY,this.onPlay.bind(this)),this.off(DESTROY,this.destroy.bind(this)),this.off(URL_CHANGE,this.clearRtmpDtsGap.bind(this))}},{key:"clearRtmpDtsGap",value:function(){this.state.rtmpDtsGap=0,this.state.dtsBase=0,this.clearSubTitle(!0)}},{key:"clearSubTitle",value:function(e){if(this.state.subTitleList=[],this.state.showingSubtitle="",this.state.currentSub=null,clearTimeout(this.showTimer),clearTimeout(this.clearLineTimer),e){var t=this.find(".xgplayer-subtitles-inner");t&&this.resetDom(t)}}},{key:"getIsSoft",value:function(){var e;return"LIVE-VIDEO"===(null!==(e=this.player.video)&&void 0!==e?e:{}).tagName}},{key:"handleVideoTimeupdate",value:function(e){var t,r,n=this.player.video.currentTime,i=this.getIsSoft(),o=(null==e||null===(t=e.detail)||void 0===t?void 0:t.pts)/1e3,a=i?o:n;if(this.state.showLang&&a&&this.player.isPlaying){var s=this.findSubTitleByTime(a);s&&s.text!==this.state.showingSubtitle&&null!==(r=s.wordpiece)&&void 0!==r&&r.length&&(this.renderSubtitle(s),this.player.emit(PluginEvents.AI_SUBTITLE_MATCH,{subTitle:s,lang:this.state.showLang}),this.state.subTitleList.length>1e3&&(this.state.subTitleList=this.state.subTitleList.filter((function(e){return e.timestamp+e.duration/1e3>=a}))))}}},{key:"renderSubtitle",value:function(e){var t=this,r=this.root,n=this.find(".xgplayer-subtitles-inner"),i=this.find(".xgplayer-subtitles-helper");if(n){this.clearLineTimer&&clearTimeout(this.clearLineTimer),this.showTimer&&(clearTimeout(this.showTimer),this.showSurplus());var o=this.createNewDom(n);this.state.showingSubtitle=e.text,this.state.currentSub={subObj:e,dom:o,index:0};var a=Date.now(),s="",u=0;!function c(){var l,d=e.wordpiece,f=void 0===d?[]:d,h=e.delimiter;if(u===f.length)return s="",t.showTimer=null,void(t.clearLineTimer=setTimeout((function(){t.resetDom(n),t.clearLineTimer=null}),1e3));var p=f[u].duration-(Date.now()-a-f[u].OffsetMs);if(p<0)for(;p<0&&u<f.length-1;)s=s+h+f[u+=1].text,p=f[u].duration-(Date.now()-a-f[u].OffsetMs);else s=s+h+f[u].text;i.textContent=s;var g=null!==(l=null==r?void 0:r.offsetWidth)&&void 0!==l?l:300;i.offsetWidth>g&&(o=t.createNewDom(n),t.state.currentSub.dom=o,s=f[u].text),o.textContent=s,t.showTimer=setTimeout(c,p),u+=1,t.state.currentSub.index=u}()}}},{key:"handleSEIParsed",value:function(t,r){var n=t.dts;if(5===t.code)try{var i="string"==typeof t.content?t.content:Uint8ArrayToString(t.content),o=JSON.parse(i).rtmp_dts;if(o&&n){var a=r||n;this.state.rtmpDtsGap=o-a}}catch(e){}}},{key:"insertSubTitle",value:function(){for(var e,t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach((function(e){e.timestamp=t.adjustSubTitleTime(e.timestamp)})),(e=this.state.subTitleList).push.apply(e,n)}},{key:"setCurrentLang",value:function(e){this.state.showLang=e,this.player.emit(PluginEvents.AI_SUBTITLE_LANG_CHANGE,e)}},{key:"adjustSubTitleTime",value:function(e){var t,r,n,i,o,a,s,u;if(this.getIsSoft())return(e-this.state.rtmpDtsGap)/1e3;var c=(null===(t=this.player)||void 0===t||null===(r=t.plugins)||void 0===r?void 0:r.flvlive)||(null===(n=this.player)||void 0===n||null===(i=n.plugins)||void 0===i?void 0:i.hlslive);if(c){var l,d,f,h,p,g,y,v=null!==(l=null==c||null===(d=c._context)||void 0===d||null===(f=d.getInstance("COMPATIBILITY"))||void 0===f?void 0:f._videoLargeGap)&&void 0!==l?l:0,m=null==c||null===(h=c._context)||void 0===h?void 0:h.getInstance("MP4_REMUXER"),_=null!==(p=null!==(g=null===(y=m.remuxer)||void 0===y?void 0:y.videoDtsBase)&&void 0!==g?g:null==m?void 0:m.videoDtsBase)&&void 0!==p?p:0;return this.state.dtsBase=_-v,(e+v-_-this.state.rtmpDtsGap)/1e3}var b=(null===(o=this.player)||void 0===o||null===(a=o.plugins)||void 0===a?void 0:a.flv)||(null===(s=this.player)||void 0===s||null===(u=s.plugins)||void 0===u?void 0:u.hls);if(b){var A,E,S,T=null===(A=b.core._bufferService)||void 0===A||null===(E=A._demuxer)||void 0===E||null===(S=E._fixer)||void 0===S?void 0:S._baseDts;return this.state.dtsBase=T,(e-T-this.state.rtmpDtsGap)/1e3}return(e-this.state.rtmpDtsGap)/1e3}},{key:"findSubTitleByTime",value:function(e){var t=this,r=this.state.subTitleList,n=r.findIndex((function(r){var n=t.player,i=r.lang===t.state.showLang,o=((null==n?void 0:n.__curUrl)||n.config.url)===r.url,a=r.timestamp;return a+r.duration/1e3>=e&&a<=e&&o&&i}));if(!(n<0)){var i=r.splice(0,n+1),o=i[i.length-1];return this.splitSubTitle(o)}}},{key:"splitSubTitle",value:function(e){var t="en"===e.lang?" ":"",r=e.text.split(t);if(!e.wordpiece){var n=e.duration/r.length,i=r.map((function(e,t){return{text:e,OffsetMs:n*t,duration:n}}));return _objectSpread2$1(_objectSpread2$1({},e),{},{delimiter:t,textArr:r,wordpiece:i})}return _objectSpread2$1(_objectSpread2$1({},e),{},{delimiter:t,textArr:r})}},{key:"showSurplus",value:function(){var e,t=this;if(this.state.currentSub){var r=this.state.currentSub,n=r.index,i=r.subObj,o=r.dom,a=null!=i?i:{},s=a.wordpiece,u=a.delimiter;if(!(n>=s.length)){var c=this.find(".xgplayer-subtitles-helper"),l=this.find(".xgplayer-subtitles-inner"),d=this.root,f=null!==(e=null==d?void 0:d.offsetWidth)&&void 0!==e?e:300,h=s.length,p=o.textContent;s.slice(n,h).forEach((function(e){p=p+u+e.text,c.textContent=p,c.offsetWidth>f&&(t.state.currentSub.dom=t.createNewDom(l),p=e.text),t.state.currentSub.dom.textContent=p}))}}}},{key:"createNewDom",value:function(e){if(e){e.children.length>2&&e.firstElementChild&&e.removeChild(e.firstElementChild);var t=document.createElement("span");if(e.appendChild(t),e.children.length>2){var r=e.classList.contains("scroll-1"),n=e.classList.contains("scroll-2");r&&e.classList.replace("scroll-1","scroll-2"),n&&e.classList.replace("scroll-2","scroll-1"),r||n||e.classList.add("scroll-1")}return t}}},{key:"test",value:function(){var e=this,t=this.splitSubTitle({duration:1e4,lang:"zh",text:"你呼吸 已改变 停滞于某段流年 离别的你我 才明白挥霍有期限,逝去的人不曾走远 像 突如其来温暖我的晴天 像 倾盆大雨我躲避的屋檐",timestamp:0,url:"xxx"});this.renderSubtitle(t),setTimeout((function(){e.test()}),1e4)}},{key:"getPlayTime",value:function(){var e=this,t=this.getIsSoft();this.on(TIME_UPDATE,(function(r){if(t){var n,i={pts:null==r||null===(n=r.detail)||void 0===n?void 0:n.pts,rtmpDtsGap:e.state.rtmpDtsGap};i.timestamp=i.pts+i.rtmpDtsGap,console.log("直播当前时间戳：",i.timestamp,i)}else{var o={currentTime:1e3*e.player.video.currentTime,dtsBase:e.state.dtsBase,rtmpDtsGap:e.state.rtmpDtsGap};o.timestamp=o.currentTime+o.dtsBase+o.rtmpDtsGap,console.log("直播当前时间戳：",o.timestamp,o)}}))}},{key:"resetDom",value:function(e){e&&(this.state.currentSub=null,e&&(e.innerHTML="",e.classList.remove("scroll-1","scroll-2")))}},{key:"render",value:function(){return'<xg-subtitles class="xgplayer-subtitles"><xg-subtitles-inner class="xgplayer-subtitles-inner"></xg-subtitles-inner><xg-subtitles-helper class="xgplayer-subtitles-helper"></xg-helper></xg-subtitles>'}}],[{key:"pluginName",get:function(){return"LiveSubtitlesPlugin"}},{key:"defaultConfig",get:function(){return{position:Plugin.POSITIONS.ROOT,showLang:""}}}]),n}(Plugin),POSITIONS$1=Plugin.POSITIONS,LiveSubtitlesIconPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).isMobile="mobile"===sniffer.device,n.isOpenState=!0,n.optionList=null,n.currentLang="",n}return _createClass$3(r,[{key:"afterCreate",value:function(){this.appendChild(".xgplayer-icon",this.icons.aiSubOpen),this.appendChild(".xgplayer-icon",this.icons.aiSubClose),this.renderOptionList(),this.initEvents(),this.currentLang=this.config.default,this.config.defaultOpen?this.open(!0):this.close()}},{key:"afterPlayerInit",value:function(){this.config.defaultOpen&&this.changeSubTitleLang(this.config.default,!0)}},{key:"registerIcons",value:function(){return{aiSubOpen:{icon:OpenIcon,class:"xgplayer-aisub-open-svg"},aiSubClose:{icon:CloseIcon,class:"xgplayer-aisub-close-svg"}}}},{key:"registerLanguageTexts",value:function(){return{sub:{jp:"AI 字幕",en:"AI Subtitles",zh:"AI 字幕","zh-hk":"AI 字幕"},subOpen:{jp:"字幕をオンにする",en:"Show subtitles",zh:"开启字幕","zh-hk":"開啟字幕"},subClose:{jp:"クローズドキャプション",en:"Hide subtitles",zh:"关闭字幕","zh-hk":"關閉字幕"}}}},{key:"children",value:function(){return{LiveSubTitlesPlugin:{plugin:LiveSubTitlesPlugin,options:{root:this.player.root,showLang:this.currentLang}}}}},{key:"initEvents",value:function(){this.bind(["click"],this.handleButtonChange.bind(this)),this.bind(["mouseenter"],this.showPanel.bind(this)),this.bind(["mouseleave"],this.hidePanel.bind(this))}},{key:"handleButtonChange",value:function(){(this.close=this.close.bind(this),this.open=this.open.bind(this),this.isMobile)?this.showMobilePanel():(this.isOpenState?this.close:this.open)()}},{key:"showMobilePanel",value:function(){var e,t=this.renderItemList();null===(e=this.player.panel)||void 0===e||e.showPanel(t,this.langText.sub,!0)}},{key:"renderItemList",value:function(){var e=this,t=_toConsumableArray$2(this.config.list),r=util$2.createDom("div","",{},"ai-panel-content");return t.push({key:"",showText:this.langText.subClose}),t.forEach((function(t){var n=e.renderItem(t);r.appendChild(n)})),r}},{key:"renderItem",value:function(e){var t=this,r=""===e.key&&!this.isOpenState||this.currentLang===e.key&&this.isOpenState,n=util$2.createDom("div","",{},"panel-Item ".concat(r?"select-in":""));return n.innerHTML=e.showText,n.addEventListener("click",(function(r){r.stopPropagation(),r.preventDefault(),t.changeSubTitleLang(e.key),t.updatePanel()})),n}},{key:"updatePanel",value:function(){var e,t=this.renderItemList();null===(e=this.player.panel)||void 0===e||e.updatePanel(t)}},{key:"showPanel",value:function(){var e;!this.isMobile&&this.isOpenState&&(null===(e=this.optionList)||void 0===e||e.show())}},{key:"hidePanel",value:function(){var e;!this.isMobile&&this.isOpenState&&(null===(e=this.optionList)||void 0===e||e.hide())}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpenState=!0,util$2.removeClass(this.root,"isClose"),util$2.addClass(this.root,"isOpen"),!e&&this.showPanel(),this.toggleSubTitle()}},{key:"close",value:function(){var e;this.isOpenState=!1,util$2.removeClass(this.root,"isOpen"),util$2.addClass(this.root,"isClose"),null===(e=this.optionList)||void 0===e||e.hide(),this.toggleSubTitle()}},{key:"renderOptionList",value:function(){var e,t=this;if(!((null===(e=this.config.list)||void 0===e?void 0:e.length)<2||this.isMobile)){var r={config:{data:this.config.list.map((function(e){return e.key===t.config.default&&(e.isCurrent=!0,e.selected=!0),e})),className:"",onItemClick:function(e,r){var n;e.stopPropagation(),e.preventDefault(),t.changeSubTitleLang(null===(n=r.to)||void 0===n?void 0:n.key)}},root:this.root};this.optionList=new OptionList(r)}}},{key:"changeSubTitleLang",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentLang=e,e?this.open(t):this.close()}},{key:"toggleSubTitle",value:function(){var e;null===(e=this.player.getPlugin("LiveSubtitlesPlugin"))||void 0===e||e.setCurrentLang(this.isOpenState?this.currentLang:"")}},{key:"destroy",value:function(){var e;this.unbind(["click"],this.handleButtonChange.bind(this)),this.unbind(["mouseenter"],this.showPanel.bind(this)),this.unbind(["mouseleave"],this.hidePanel.bind(this)),null===(e=this.optionList)||void 0===e||e.destroy()}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-aisub">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="subOpen">'.concat(this.langText.subOpen,"</div>\n    </xg-icon>\n    ")}}],[{key:"pluginName",get:function(){return"LiveSubtitlesIconPlugin"}},{key:"defaultConfig",get:function(){return{position:POSITIONS$1.CONTROLS_RIGHT,index:2.7,defaultOpen:!0,default:"en",list:[{key:"zh",showText:"中文"},{key:"en",showText:"En"}]}}}]),r}(Plugin),DefinitionDemotePlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(e){var n;return _classCallCheck$3(this,r),(n=t.call(this,e)).waitings=[],n.longWaitingEmitTime=0,n.waitingStartTime=0,n.playerData=null,n.isNeedShowTips=!0,n.playerData=n.playerConfig.playerData,n}return _createClass$3(r,[{key:"registerLanguageTexts",value:function(){return{definition_demote_txt:{jp:"現在のネットワークは不安定です。に切り替えることをお勧めします",en:"The current network is unstable, it is recommended to switch to ",zh:"当前网络不稳定，建议切换到","zh-hk":"當前網絡不穩定，建議切換到"}}}},{key:"afterCreate",value:function(){this.bindCtx(),this.bindEvents()}},{key:"bindCtx",value:function(){this._count=this._count.bind(this),this._time=this._time.bind(this),this._waiting=this._waiting.bind(this),this._clearTime=this._clearTime.bind(this)}},{key:"bindEvents",value:function(){var e=this;this.on(WAITING,this._waiting),this.on(PLAYING,this._clearTime),this.on(PAUSE,this._clearTime),this.on(TIME_UPDATE,this._clearTime),this.on(PLAY,this._clearTime),this.on(CANPLAY,(function(){e.isNeedShowTips=!0})),this.config.isNeedAutoDemote&&this.player.on(PluginEvents.LONG_WAITING,this.demote.bind(this))}},{key:"_waiting",value:function(){this._count(),this._time()}},{key:"_count",value:function(){var e=Date.now();if(this.waitings.push(e),this.waitings.length===this.config.oftenWaitingCount){var t=this.waitings.shift();t&&e-t<=this.config.oftenWaitingTime&&(this.player.emit(PluginEvents.OFTEN_WAITING),this.clearState())}}},{key:"_time",value:function(){var e=this;if(this.timer)console.log("连续触发了waiting,距离上次waiting时间:",Date.now()-this.waitingStartTime);else{this.waitingStartTime=Date.now();var t=this.player.currentTime;this.timer=setTimeout((function(){e.player&&e.player.currentTime<=t+.1&&(console.log("waiting持续时间超过 ".concat(e.config.longWaitingTime," 秒")),e.player.emit(PluginEvents.LONG_WAITING),e.clearState())}),this.config.longWaitingTime)}}},{key:"_clearTime",value:function(){this.waitingStartTime&&console.log("waiting持续时长:",Date.now()-this.waitingStartTime),this.clearState()}},{key:"clearState",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.waitings.length>0&&(this.waitings=[]),this.waitingStartTime&&(this.waitingStartTime=0)}},{key:"demote",value:function(){if(this.playerData){var e=this.playerData.getNextDefinition(!0,this.config.demotePriority),t=null==e?void 0:e[0];if(t){var r=t.definition;if(r){var n=this.playerData.current.definition;if(this.player.emit(PluginEvents.DEFINITION_DEMOTE,{currentDef:n,willChangeDef:r,next:t}),"auto"===n){var i=t.url;this.changeUrl(i)}else r!==n&&this.showToast(t)}}}}},{key:"changeUrl",value:function(e){this.player&&e&&(this.player.config.url=e,this.player.switchURL(e,!1),this.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:e,from:"definition_demote"}))}},{key:"showToast",value:function(e){var t,r=this,n=null===(t=this.player)||void 0===t?void 0:t.getPlugin("sdkToastPlugin");if(n&&this.isNeedShowTips){var i=this.i18n[e.definitionTextKey]||e.definitionTextKey||e.definition,o=util$2.createDom("div",this.langText.definition_demote_txt,void 0,"toast-txt"),a=util$2.createDom("span",i,void 0,"toast-txt-bt");o.appendChild(a);var s=n.add(o,5e3,!0);a.addEventListener("click",(function(){r.playerData&&(r.playerData.current.definition=e.definition,n.remove(s))})),this.isNeedShowTips=!1,setTimeout((function(){r.isNeedShowTips=!0}),3e4)}}},{key:"destroy",value:function(){this.clearState()}}],[{key:"pluginName",get:function(){return"DefinitionDemotePlugin"}},{key:"defaultConfig",get:function(){return{oftenWaitingCount:3,oftenWaitingTime:5e3,longWaitingTime:5e3,isNeedAutoDemote:!1,demotePriority:[]}}}]),r}(Plugin),formatTime=function(e){var t=Math.floor(e/3600),r=e%3600,n=Math.floor(r/60),i=Math.round(r%60);return t>0?(n<10&&(n="0"+n),i<10&&(i="0"+i),"".concat(t,":").concat(n,":").concat(i)):(i<10&&(i="0"+i),"".concat(n,":").concat(i))},POSITIONS=Plugin.POSITIONS,UpperLimit=28800,TimeShiftPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){var e;return _classCallCheck$3(this,r),(e=t.apply(this,arguments)).isMobile="mobile"===sniffer.device,e.playedBar=null,e.cachedBar=null,e.innerBar=null,e.progressBtn=null,e.progressPoint=null,e.backLiveBt=null,e.cardDomList=[],e.initTime=0,e.liveGap=0,e.timeGap=0,e.shiftTimeGap=0,e.isProgressMoving=!1,e.isPlayTimeShift=!1,e.onBodyClick=function(e){e.preventDefault(),e.stopPropagation(),util$2.event(e)},e}return _createClass$3(r,[{key:"duration",get:function(){var e,t=this.liveGap+Math.floor(Date.now()/1e3-this.initTime),r=(null!==(e=this.config)&&void 0!==e?e:{}).maxMoveTime;return r&&t>r?r:t>UpperLimit?UpperLimit:t}},{key:"registerLanguageTexts",value:function(){return{backLive:{jp:"ライブに戻る",en:"Back to live",zh:"返回直播","zh-hk":"返回直播"}}}},{key:"updateLang",value:function(){this.backLiveBt&&(this.backLiveBt.innerHTML=this.langText.backLive)}},{key:"afterCreate",value:function(){this.playedBar=this.find(".xgplayer-progress-played"),this.cachedBar=this.find(".xgplayer-progress-cache"),this.progressBtn=this.find(".xgplayer-progress-btn"),this.progressPoint=this.find(".xgplayer-shift-progress-point"),this.innerBar=this.find(".xgplayer-progress-inner"),this.createBackLiveBtDom(),this.clacTime(),this.initEvents(),this.bindDomEvents(),this.isMobile||this.createTimeShiftCard()}},{key:"clacTime",value:function(){var e,t=null!==(e=this.config)&&void 0!==e?e:{},r=t.livingStartTime,n=t.currentTime;this.initTime=Math.floor(Date.now()/1e3),this.liveGap=Math.floor(n-r),this.timeGap=Math.floor(Date.now()/1e3-n)}},{key:"initEvents",value:function(){this.on(TIME_UPDATE,this.handleTimeUpdate.bind(this))}},{key:"bindDomEvents",value:function(){if(this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.tipsUpdate=this.tipsUpdate.bind(this),this.isMobile){this.bind("touchstart",this.handleMouseDown);var e=this.player.controls;e&&(e.root&&e.root.addEventListener("touchmove",util$2.stopPropagation),e.center&&e.center.addEventListener("touchend",util$2.stopPropagation))}else this.bind("mousedown",this.handleMouseDown),this.bind("mouseenter",this.handleMouseEnter)}},{key:"handleTimeUpdate",value:function(){this.isProgressMoving||this.progressUpdate()}},{key:"handleMouseDown",value:function(e){if(e.target!==this.backLiveBt){this.onBodyClick(e),this.focus(),util$2.addClass(this.progressBtn,"active");var t=this.computeTime(e);this.updateShiftTime(t.percent),this.isProgressMoving=!0,this.isMobile?(this.bind("touchmove",this.handleMouseMove),this.bind("touchend",this.handleMouseUp)):(document.addEventListener("mousemove",this.handleMouseMove,!1),document.addEventListener("mouseup",this.handleMouseUp,!1))}}},{key:"handleMouseMove",value:function(e){this.onBodyClick(e);var t=this.computeTime(e);this.updateShiftTime(t.percent)}},{key:"handleMouseUp",value:function(e){this.onBodyClick(e),this.isProgressMoving=!1,util$2.removeClass(this.progressBtn,"active"),this.changeTimeUrl(),this.isMobile?(this.unbind("touchmove",this.handleMouseMove),this.unbind("touchend",this.handleMouseUp)):(document.removeEventListener("mousemove",this.handleMouseMove,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1))}},{key:"handleMouseEnter",value:function(e){this.bind("mouseleave",this.handleMouseLeave),this.bind("mousemove",this.tipsUpdate),this.tipsUpdate(e),this.focus()}},{key:"handleMouseLeave",value:function(){this.unbind("mouseleave",this.handleMouseLeave),this.unbind("mousemove",this.tipsUpdate),this.blur()}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),util$2.addClass(this.root,"active")}},{key:"blur",value:function(){this.player.controls.recoverAutoHide(),util$2.removeClass(this.root,"active")}},{key:"computeTime",value:function(e){var t,r,n,i=this.player,o=this.root.getBoundingClientRect(),a=o.width,s=o.height,u=o.top,c=o.left,l=util$2.getEventPos(e,i.zoom);90===i.rotateDeg?(t=s,r=u,n=l.clientY):(t=a,r=c,n=l.clientX);var d=n-r,f=(d=d>t?t:d<0?0:d)/t;return{percent:f=f<0?0:f>1?1:f,offset:d,width:t,left:r,e:e}}},{key:"tipsUpdate",value:function(e){var t=this.computeTime(e),r=Math.floor(this.duration*(1-t.percent));this.progressPoint.style.left="".concat(100*t.percent,"%"),this.progressPoint.innerHTML="-".concat(formatTime(r))}},{key:"updateShiftTime",value:function(e){this.shiftTimeGap=Math.floor(this.duration*(1-e)),this.progressUpdate()}},{key:"getCurrentProgress",value:function(){return Math.floor(this.duration-this.shiftTimeGap)}},{key:"progressUpdate",value:function(){var e=this.getCurrentProgress()/this.duration;this.progressBtn.style.left="".concat(100*e,"%"),this.playedBar.style.width="".concat(100*e,"%"),this.cardProcessUpdate()}},{key:"changeTimeShift",value:function(e){var t=this.calcCardProcess(e);t<0||(this.updateShiftTime(t),this.changeTimeUrl())}},{key:"changeTimeUrl",value:function(){var e=this.config.timeShiftUrl;if(e){this.isPlayTimeShift=!0,this.toggleBackButton();var t=e.replace("{}",this.shiftTimeGap<6?6:this.shiftTimeGap);this.player.src=t,this.player.config.url=t,this.player.emit(PluginEvents.TIME_SHIFT_CHANGE,!0),this.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:t,from:PluginEvents.TIME_SHIFT_CHANGE})}}},{key:"createBackLiveBtDom",value:function(){var e,t=this;if(this.backLiveBt)return this.backLiveBt;this.backLiveBt=util$2.createDom("xg-back-live-bt",this.langText.backLive,void 0,"xgplayer-back-live-bt"),this.backLiveBt.addEventListener("click",(function(e){t.onBodyClick(e),t.backLive()})),null===(e=this.player.root)||void 0===e||e.appendChild(this.backLiveBt)}},{key:"backLive",value:function(){var e=this.config.liveUrl;e&&(this.player.src=e,this.player.config.url=e,this.shiftTimeGap=0,this.isPlayTimeShift=!1,this.toggleBackButton(),this.player.emit(PluginEvents.TIME_SHIFT_CHANGE,!1),this.player.emit(PluginEvents.PlAY_URL_CHANGE,{url:e,from:PluginEvents.TIME_SHIFT_CHANGE}))}},{key:"toggleBackButton",value:function(){this.backLiveBt&&(this.backLiveBt.style.display=this.isPlayTimeShift?"flex":"none")}},{key:"updateCardList",value:function(e){this.config.cardList=_toConsumableArray$2(e),this.clearCardDom(),this.createTimeShiftCard()}},{key:"clearCardDom",value:function(){var e=this;this.cardDomList.forEach((function(t){t.dom&&e.innerBar.contains(t.dom)&&e.innerBar.removeChild(t.dom)})),this.cardDomList=[]}},{key:"createTimeShiftCard",value:function(){var e,t=this;(null===(e=this.config.cardList)||void 0===e?void 0:e.length)<=0||this.config.cardList.forEach((function(e){t.renderCard(e)}))}},{key:"renderCard",value:function(e){if(e.img){var t=util$2.createDom("xg-card","",void 0,"xgplayer-shift-progress-card"),r=util$2.createDom("img","",{src:e.img},"xgplayer-shift-progress-card-img"),n=util$2.createDom("div","",void 0,"xgplayer-shift-progress-card-point");t.appendChild(r),t.appendChild(n),this.cardDomList.push(_objectSpread2$1(_objectSpread2$1({},e),{},{dom:t}))}}},{key:"cardProcessUpdate",value:function(){var e=this;0!==this.cardDomList.length&&this.cardDomList.forEach((function(t){if(t.dom){var r=e.calcCardProcess(t.timestamp);if(!(r>1)){var n=e.innerBar.contains(t.dom);r<0?n&&e.innerBar.removeChild(t.dom):(n||e.innerBar.appendChild(t.dom),t.dom.style.left="".concat(100*r,"%"))}}}))}},{key:"calcCardProcess",value:function(e){var t,r=null!==(t=this.config)&&void 0!==t?t:{},n=r.maxMoveTime,i=r.livingStartTime,o=this.liveGap+Math.floor(Date.now()/1e3-this.initTime);return n&&o>n&&(i=o-n),e<i?-1:(e-i)/this.duration}},{key:"destroy",value:function(){if(this.off(TIME_UPDATE,this.handleTimeUpdate.bind(this)),this.isMobile){this.unbind("touchstart",this.handleMouseDown);var e=this.player.controls;e&&(e.root&&e.root.removerEventListener("touchmove",util$2.stopPropagation),e.center&&e.center.removerEventListener("touchend",util$2.stopPropagation))}else this.unbind("mousedown",this.handleMouseDown),this.unbind("mouseenter",this.handleMouseEnter);var t;this.backLiveBt&&(null===(t=this.player.root)||void 0===t||t.removeChild(this.backLiveBt),this.backLiveBt=null)}},{key:"render",value:function(){if(this.config.disable)return"";var e=this.player.controls?this.player.controls.config.mode:"";return'\n      <xg-progress class="xgplayer-progress '.concat("bottom"===e?"xgplayer-progress-bottom":"",' xgplayer-shift">\n        <xg-outer class="xgplayer-progress-outer">\n          <xg-inners class="progress-list">\n            <xg-inner class="xgplayer-progress-inner" style="flex: 1">\n              <xg-cache class="xgplayer-progress-cache" style="width: 100%;"></xg-cache>\n              <xg-played class="xgplayer-progress-played" style="width: 100%;"></xg-played>\n            </xg-inner>\n          </xg-inners>\n          <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>\n          <xg-point class="xgplayer-shift-progress-point">00:00</xg-point>\n        </xg-outer>\n      </xg-progress>\n    ')}}],[{key:"pluginName",get:function(){return"TimeShiftPlugin"}},{key:"defaultConfig",get:function(){return{position:POSITIONS.CONTROLS_CENTER,livingStartTime:0,maxMoveTime:0,currentTime:0,timeShiftUrl:"",liveUrl:"",cardList:[]}}}]),r}(Plugin),debug$1="object"===("undefined"==typeof process?"undefined":_typeof$3(process))&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).error.apply(e,["SEMVER"].concat(r))}:function(){},debug_1=debug$1,SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,constants={SEMVER_SPEC_VERSION:SEMVER_SPEC_VERSION,MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,MAX_SAFE_COMPONENT_LENGTH:MAX_SAFE_COMPONENT_LENGTH},re$1={exports:{}};!function(e,t){var r=constants.MAX_SAFE_COMPONENT_LENGTH,n=debug_1,i=(t=e.exports={}).re=[],o=t.src=[],a=t.t={},s=0,u=function(e,t,r){var u=s++;n(e,u,t),a[e]=u,o[u]=t,i[u]=new RegExp(t,r?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION","(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")")),u("MAINVERSIONLOOSE","(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")")),u("PRERELEASEIDENTIFIER","(?:".concat(o[a.NUMERICIDENTIFIER],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[a.NUMERICIDENTIFIERLOOSE],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASE","(?:-(".concat(o[a.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIER],")*))")),u("PRERELEASELOOSE","(?:-?(".concat(o[a.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIERLOOSE],")*))")),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD","(?:\\+(".concat(o[a.BUILDIDENTIFIER],"(?:\\.").concat(o[a.BUILDIDENTIFIER],")*))")),u("FULLPLAIN","v?".concat(o[a.MAINVERSION]).concat(o[a.PRERELEASE],"?").concat(o[a.BUILD],"?")),u("FULL","^".concat(o[a.FULLPLAIN],"$")),u("LOOSEPLAIN","[v=\\s]*".concat(o[a.MAINVERSIONLOOSE]).concat(o[a.PRERELEASELOOSE],"?").concat(o[a.BUILD],"?")),u("LOOSE","^".concat(o[a.LOOSEPLAIN],"$")),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE","".concat(o[a.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),u("XRANGEIDENTIFIER","".concat(o[a.NUMERICIDENTIFIER],"|x|X|\\*")),u("XRANGEPLAIN","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:".concat(o[a.PRERELEASE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[a.PRERELEASELOOSE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAIN],"$")),u("XRANGELOOSE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAINLOOSE],"$")),u("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM","(\\s*)".concat(o[a.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",u("TILDE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAIN],"$")),u("TILDELOOSE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("LONECARET","(?:\\^)"),u("CARETTRIM","(\\s*)".concat(o[a.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",u("CARET","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAIN],"$")),u("CARETLOOSE","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("COMPARATORLOOSE","^".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],")$|^$")),u("COMPARATOR","^".concat(o[a.GTLT],"\\s*(").concat(o[a.FULLPLAIN],")$|^$")),u("COMPARATORTRIM","(\\s*)".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],"|").concat(o[a.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE","^\\s*(".concat(o[a.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAIN],")")+"\\s*$"),u("HYPHENRANGELOOSE","^\\s*(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s*$"),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(re$1,re$1.exports);var opts=["includePrerelease","loose","rtl"],parseOptions$1=function(e){return e?"object"!==_typeof$3(e)?{loose:!0}:opts.filter((function(t){return e[t]})).reduce((function(e,t){return e[t]=!0,e}),{}):{}},parseOptions_1=parseOptions$1,numeric=/^[0-9]+$/,compareIdentifiers$1=function(e,t){var r=numeric.test(e),n=numeric.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},rcompareIdentifiers=function(e,t){return compareIdentifiers$1(t,e)},identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers:rcompareIdentifiers},debug=debug_1,MAX_LENGTH=constants.MAX_LENGTH,MAX_SAFE_INTEGER=constants.MAX_SAFE_INTEGER,re=re$1.exports.re,t=re$1.exports.t,parseOptions=parseOptions_1,compareIdentifiers=identifiers.compareIdentifiers,SemVer$1=function(){function e(r,n){if(_classCallCheck$3(this,e),n=parseOptions(n),r instanceof e){if(r.loose===!!n.loose&&r.includePrerelease===!!n.includePrerelease)return r;r=r.version}else if("string"!=typeof r)throw new TypeError("Invalid Version: ".concat(r));if(r.length>MAX_LENGTH)throw new TypeError("version is longer than ".concat(MAX_LENGTH," characters"));debug("SemVer",r,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=r.trim().match(n.loose?re[t.LOOSE]:re[t.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(r));if(this.raw=r,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<MAX_SAFE_INTEGER)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}return _createClass$3(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(debug("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),compareIdentifiers(this.major,t.major)||compareIdentifiers(this.minor,t.minor)||compareIdentifiers(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var r=0;do{var n=this.prerelease[r],i=t.prerelease[r];if(debug("prerelease compare",r,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return compareIdentifiers(n,i)}while(++r)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var r=0;do{var n=this.build[r],i=t.build[r];if(debug("prerelease compare",r,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return compareIdentifiers(n,i)}while(++r)}},{key:"inc",value:function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(0===compareIdentifiers(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}]),e}(),semver=SemVer$1,SemVer=semver,compare$1=function(e,t,r){return new SemVer(e,r).compare(new SemVer(t,r))},compare_1=compare$1,compare=compare_1,gte=function(e,t,r){return compare(e,t,r)>=0},gte_1=gte,TO_NATIVE_API_NAME={v1:"byteview_live_bridge",v2:"lark_vc_live_bridge"},TO_WEB_API_NAME={v1:"byteview_live_event",v2:"lark_vc_live_bridge"},IsInLark=window.navigator.userAgent.indexOf("Lark")>-1,GapLarkVersion="5.1.0";function getLarkVersion(){var e,t,r;if(IsInLark){var n=null===(e=window)||void 0===e||null===(t=e.navigator)||void 0===t||null===(r=t.userAgent)||void 0===r?void 0:r.match(/ Lark\/(\d+\.\d+\.\d+)/i);if(n)return n[1]}}var EventName=function(e){return e.UNKNOWN_NATIVE_EVENT="UNKNOWN_NATIVE_EVENT",e.SWITCH_NORMAL_WINDOW="SWITCH_NORMAL_WINDOW",e.SWITCH_MINI_WINDOW="SWITCH_MINI_WINDOW",e}(EventName||{}),CallNativeEvent=function(e){return e[e.Unknown=0]="Unknown",e[e.LiveReady=1]="LiveReady",e[e.LiveStart=2]="LiveStart",e[e.LivePause=3]="LivePause",e[e.LiveEnd=4]="LiveEnd",e[e.LiveError=5]="LiveError",e[e.LiveMuted=6]="LiveMuted",e[e.LiveStreamChange=7]="LiveStreamChange",e[e.DanmakuChange=8]="DanmakuChange",e[e.JsReady=9]="JsReady",e}(CallNativeEvent||{}),CallWebEvent=function(e){return e[e.Unknown=0]="Unknown",e[e.SwitchNormalMode=1]="SwitchNormalMode",e[e.SwitchMiniMode=2]="SwitchMiniMode",e[e.ContainerModeChange=3]="ContainerModeChange",e}(CallWebEvent||{}),ContainerMode=function(e){return e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Mini=2]="Mini",e}(ContainerMode||{}),LarkJsBridge=function(){function e(){var t=this;_classCallCheck$3(this,e),this.emitter=new eventemitter3.exports.EventEmitter,this.currentHost="",this.currentLarkVersion="",this.currentLiveId="",this.isInAndroid=!1,this.isInIOS=!1,this.isInLark=!1,this.isInitialized=!1,this.useV2=!1,this.handleContainerModeChange=function(e,r){var n,i;switch(e){case CallWebEvent.SwitchMiniMode:i=EventName.SWITCH_MINI_WINDOW;break;case CallWebEvent.SwitchNormalMode:i=EventName.SWITCH_NORMAL_WINDOW;break;case CallWebEvent.ContainerModeChange:i=(null==r||null===(n=r.params)||void 0===n?void 0:n.mode)===ContainerMode.Normal?EventName.SWITCH_NORMAL_WINDOW:EventName.SWITCH_MINI_WINDOW;break;default:i=EventName.SWITCH_NORMAL_WINDOW}window.addEventListener("resize",(function e(){t.emitter.emit(i,r),window.removeEventListener("resize",e)}))},this.init()}return _createClass$3(e,[{key:"init",value:function(e){this.initVariables(e),this.initNativeCallWebCallback()}},{key:"initVariables",value:function(e){if(console.log(IsInLark),IsInLark){var t,r=null!==(t=null==e?void 0:e.liveId)&&void 0!==t?t:"";if(this.isInitialized)return void(this.currentLiveId=r);var n=getLarkVersion();this.currentLiveId=r,this.currentHost="https://".concat(window.location.host),this.currentLarkVersion=null!=n?n:"0.0.0",this.isInAndroid=!!sniffer.os.isAndroid,this.isInIOS=!!sniffer.os.isIos,this.isInLark=IsInLark&&"mobile"===sniffer.device,this.useV2=gte_1(this.currentLarkVersion,GapLarkVersion)}}},{key:"initNativeCallWebCallback",value:function(){var e=this;this.isInLark&&(this.isInitialized||(this.isInitialized=!0,window.LarkWebViewJavaScriptBridge=window.LarkWebViewJavaScriptBridge||{nativeCallBack:function(t){var r=t.callbackID,n=void 0===r?"":r,i=t.data,o=void 0===i?{}:i;if([TO_WEB_API_NAME.v1,TO_WEB_API_NAME.v2].includes(n)){var a=o.live_event,s=void 0===a?CallWebEvent.Unknown:a;s&&e.callWebHandler(s,o)}}}))}},{key:"callWebHandler",value:function(e,t){switch(e){case CallWebEvent.SwitchNormalMode:case CallWebEvent.SwitchMiniMode:case CallWebEvent.ContainerModeChange:this.handleContainerModeChange(e,t)}}},{key:"genTransferNativeData",value:function(e,t){return this.useV2?this.generateCallNativeDataV2(e,t):this.generateCallNativeDataV1(e,t)}},{key:"generateCallNativeDataV1",value:function(e,t){if(this.currentLiveId)return{apiName:TO_NATIVE_API_NAME.v1,data:{live_host:this.currentHost,live_id:this.currentLiveId,stream_link:t.stream_link,live_action:e,muted:t.muted,danmaku_active:t.danmaku_active}}}},{key:"generateCallNativeDataV2",value:function(e,t){return{apiName:TO_NATIVE_API_NAME.v2,callbackID:TO_NATIVE_API_NAME.v2,data:{live_event:e,version:this.currentLarkVersion,params:_objectSpread2$1({live_host:this.currentHost},t)},extra:"v2"}}},{key:"postMessage",value:function(e,t){if(this.isInLark&&(this.isInAndroid||this.isInIOS)){var r=this.genTransferNativeData(e,t);if(r){var n,i,o,a,s,u,c;if(this.isInIOS)null===(n=window)||void 0===n||null===(i=n.webkit)||void 0===i||null===(o=i.messageHandlers)||void 0===o||null===(a=o.invokeNative)||void 0===a||a.postMessage(r);if(this.isInAndroid)null===(s=window)||void 0===s||null===(u=s.Lark_Bridge)||void 0===u||null===(c=u.invokeNative)||void 0===c||c.call(u,JSON.stringify(r))}}}},{key:"addEventListener",value:function(e,t){this.emitter.addListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.emitter.removeListener(e,t)}},{key:"destroy",value:function(){this.emitter.removeAllListeners()}}]),e}(),NativeWindowPlugin=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){var e;return _classCallCheck$3(this,r),(e=t.apply(this,arguments)).isFirstLoad=!0,e.larkJsBridge=new LarkJsBridge,e.handleReady=function(){e.postMessage(CallNativeEvent.LiveReady)},e.handlePlay=function(){e.postMessage(CallNativeEvent.LiveStart)},e.handlePause=function(){e.postMessage(CallNativeEvent.LivePause)},e.handleError=function(){e.postMessage(CallNativeEvent.LiveError)},e.handleMuted=function(){e.postMessage(CallNativeEvent.LiveMuted)},e.handleDanmakuChange=function(){e.postMessage(CallNativeEvent.DanmakuChange)},e.handleLoadedData=function(){e.isFirstLoad?e.isFirstLoad=!1:e.postMessage(CallNativeEvent.LiveStreamChange)},e.handleMiniMode=function(){e.player&&(e.handleDanmaku(!1),e.player.root&&util$2.addClass(e.player.root,"xgplayer-mini-mode"),e.player.emit(PluginEvents.LARKWINDOW_CHANGE,!0))},e.handleNormalMode=function(){e.player&&(e.handleDanmaku(!0),e.player.root&&util$2.removeClass(e.player.root,"xgplayer-mini-mode"),e.player.emit(PluginEvents.LARKWINDOW_CHANGE,!1))},e}return _createClass$3(r,[{key:"afterCreate",value:function(){var e,t,r;null===(e=this.larkJsBridge)||void 0===e||e.postMessage(CallNativeEvent.JsReady,{}),this.player&&(this.player.on("ready",this.handleReady),this.player.on("play",this.handlePlay),this.player.on("pause",this.handlePause),this.player.on("error",this.handleError),this.player.on("volumechange",this.handleMuted),this.player.on("danmaku_click",this.handleDanmakuChange),this.player.on("loadeddata",this.handleLoadedData),null===(t=this.larkJsBridge)||void 0===t||t.addEventListener(EventName.SWITCH_MINI_WINDOW,this.handleMiniMode),null===(r=this.larkJsBridge)||void 0===r||r.addEventListener(EventName.SWITCH_NORMAL_WINDOW,this.handleNormalMode))}},{key:"destroy",value:function(){var e,t,r,n;this.player.off("ready",this.handleReady),this.player.off("play",this.handlePlay),this.player.off("pause",this.handlePause),this.player.off("error",this.handleError),this.player.off("volumechange",this.handleMuted),this.player.off("danmaku_click",this.handleDanmakuChange),this.player.off("loadeddata",this.handleLoadedData),null===(e=this.larkJsBridge)||void 0===e||e.postMessage(CallNativeEvent.LiveEnd,{}),null===(t=this.larkJsBridge)||void 0===t||t.removeEventListener(EventName.SWITCH_MINI_WINDOW,this.handleMiniMode),null===(r=this.larkJsBridge)||void 0===r||r.removeEventListener(EventName.SWITCH_NORMAL_WINDOW,this.handleNormalMode),null===(n=this.larkJsBridge)||void 0===n||n.destroy()}},{key:"postMessage",value:function(e,t){if(this.larkJsBridge){var r,n,i,o,a=this.player.config.url||"",s={stream_link:null!=a&&a.startsWith("https:")?a:"https:".concat(a),muted:this.player.muted,danmaku_active:null!==(r=null===(n=this.player)||void 0===n||null===(i=n.plugins)||void 0===i||null===(o=i.danmu)||void 0===o?void 0:o.isOpen)&&void 0!==r&&r};this.larkJsBridge.postMessage(e,_objectSpread2$1(_objectSpread2$1({},s),t))}}},{key:"handleDanmaku",value:function(e){var t=this;this.player&&this.player.danmu&&e&&setTimeout((function(){var e,r;null===(e=(r=t.player.danmu).resize)||void 0===e||e.call(r)}),300)}}],[{key:"pluginName",get:function(){return"nativeWindowPlugin"}}]),r}(BasePlugin),VePlayerUmd=function(e){_inherits$2(r,e);var t=_createSuper$r(r);function r(){return _classCallCheck$3(this,r),t.apply(this,arguments)}return _createClass$3(r)}(VePlayer);return VePlayerUmd.LiveSubtitlesIconPlugin=LiveSubtitlesIconPlugin,VePlayerUmd.LiveSubtitlesPlugin=LiveSubTitlesPlugin,VePlayerUmd.DefinitionDemotePlugin=DefinitionDemotePlugin,VePlayerUmd.TimeShiftPlugin=TimeShiftPlugin,VePlayerUmd.LarkWindowPlugin=NativeWindowPlugin,VePlayerUmd.Service=dist,VePlayerUmd.Event=Event$1,VePlayerUmd.getI18N=getI18N,VePlayerUmd}));
//# sourceMappingURL=index.min.js.map
